{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . mkdocs getting-started Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Home"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org . mkdocs getting-started","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"heimajava/","text":"\u9ed1\u9a6cJava\u9762\u8bd52023 \u65b0\u7248Java\u9762\u8bd5\u4e13\u9898\u89c6\u9891\u6559\u7a0b\uff0cjava\u516b\u80a1\u6587\u9762\u8bd5\u5168\u5957\u771f\u9898+\u6df1\u5ea6\u8be6\u89e3 02-Redis\u7bc7 03-\u6570\u636e\u5e93\u7bc7 04-\u6846\u67b6\u7bc7 05-\u5fae\u670d\u52a1 06-\u6d88\u606f\u4e2d\u95f4\u4ef6\u7bc7 07-\u5e38\u89c1\u96c6\u5408\u7bc7 08-\u5e76\u53d1\u7f16\u7a0b\u7bc7 09-JVM\u865a\u62df\u673a\u7bc7 10-\u4f01\u4e1a\u573a\u666f\u7bc7","title":"\u9ed1\u9a6cJava\u9762\u8bd52023"},{"location":"heimajava/#java2023","text":"\u65b0\u7248Java\u9762\u8bd5\u4e13\u9898\u89c6\u9891\u6559\u7a0b\uff0cjava\u516b\u80a1\u6587\u9762\u8bd5\u5168\u5957\u771f\u9898+\u6df1\u5ea6\u8be6\u89e3 02-Redis\u7bc7 03-\u6570\u636e\u5e93\u7bc7 04-\u6846\u67b6\u7bc7 05-\u5fae\u670d\u52a1 06-\u6d88\u606f\u4e2d\u95f4\u4ef6\u7bc7 07-\u5e38\u89c1\u96c6\u5408\u7bc7 08-\u5e76\u53d1\u7f16\u7a0b\u7bc7 09-JVM\u865a\u62df\u673a\u7bc7 10-\u4f01\u4e1a\u573a\u666f\u7bc7","title":"\u9ed1\u9a6cJava\u9762\u8bd52023"},{"location":"heimajava/02-Redis%E7%AF%87/Redis%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/","text":"Redis\u76f8\u5173\u9762\u8bd5\u9898 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u7a7f\u900f ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u6211\u60f3\u4e00\u4e0b \u7f13\u5b58\u7a7f\u900f\u662f\u6307\u67e5\u8be2\u4e00\u4e2a\u4e00\u5b9a \u4e0d\u5b58\u5728 \u7684\u6570\u636e\uff0c\u5982\u679c\u4ece\u5b58\u50a8\u5c42\u67e5\u4e0d\u5230\u6570\u636e\u5219\u4e0d\u5199\u5165\u7f13\u5b58\uff0c\u8fd9\u5c06\u5bfc\u81f4\u8fd9\u4e2a\u4e0d\u5b58\u5728\u7684\u6570\u636e\u6bcf\u6b21\u8bf7\u6c42\u90fd\u8981\u5230 DB \u53bb\u67e5\u8be2\uff0c\u53ef\u80fd\u5bfc\u81f4 DB \u6302\u6389\u3002\u8fd9\u79cd\u60c5\u51b5\u5927\u6982\u7387\u662f\u906d\u5230\u4e86\u653b\u51fb\u3002 \u89e3\u51b3\u65b9\u6848\u7684\u8bdd\uff0c\u6211\u4eec\u901a\u5e38\u90fd\u4f1a\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\u6765\u89e3\u51b3\u5b83 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u4ecb\u7ecd\u4e00\u4e0b\u5e03\u9686\u8fc7\u6ee4\u5668\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837~ \u5e03\u9686\u8fc7\u6ee4\u5668\u4e3b\u8981\u662f\u7528\u4e8e\u68c0\u7d22\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002\u6211\u4eec\u5f53\u65f6\u4f7f\u7528\u7684\u662fredisson\u5b9e\u73b0\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u3002 \u5b83\u7684\u5e95\u5c42\u4e3b\u8981\u662f\u5148\u53bb\u521d\u59cb\u5316\u4e00\u4e2a\u6bd4\u8f83\u5927\u6570\u7ec4\uff0c\u91cc\u9762\u5b58\u653e\u7684\u4e8c\u8fdb\u52360\u62161\u3002\u5728\u4e00\u5f00\u59cb\u90fd\u662f0\uff0c\u5f53\u4e00\u4e2akey\u6765\u4e86\u4e4b\u540e\u7ecf\u8fc73\u6b21hash\u8ba1\u7b97\uff0c\u6a21\u4e8e\u6570\u7ec4\u957f\u5ea6\u627e\u5230\u6570\u636e\u7684\u4e0b\u6807\u7136\u540e\u628a\u6570\u7ec4\u4e2d\u539f\u6765\u76840\u6539\u4e3a1\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u4e09\u4e2a\u6570\u7ec4\u7684\u4f4d\u7f6e\u5c31\u80fd\u6807\u660e\u4e00\u4e2akey\u7684\u5b58\u5728\u3002\u67e5\u627e\u7684\u8fc7\u7a0b\u4e5f\u662f\u4e00\u6837\u7684\u3002 \u5f53\u7136\u662f\u6709\u7f3a\u70b9\u7684\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u6709\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e00\u5b9a\u7684\u8bef\u5224\uff0c\u6211\u4eec\u4e00\u822c\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u8bef\u5224\u7387\uff0c\u5927\u6982\u4e0d\u4f1a\u8d85\u8fc75%\uff0c\u5176\u5b9e\u8fd9\u4e2a\u8bef\u5224\u662f\u5fc5\u7136\u5b58\u5728\u7684\uff0c\u8981\u4e0d\u5c31\u5f97\u589e\u52a0\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5176\u5b9e\u5df2\u7ecf\u7b97\u662f\u5f88\u5212\u5206\u4e86\uff0c5%\u4ee5\u5185\u7684\u8bef\u5224\u7387\u4e00\u822c\u7684\u9879\u76ee\u4e5f\u80fd\u63a5\u53d7\uff0c\u4e0d\u81f3\u4e8e\u9ad8\u5e76\u53d1\u4e0b\u538b\u5012\u6570\u636e\u5e93\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u51fb\u7a7f ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u7f13\u5b58\u51fb\u7a7f\u7684\u610f\u601d\u662f\u5bf9\u4e8e\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684key\uff0c\u7f13\u5b58\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u8fc7\u671f\u7684\u65f6\u5019\uff0c\u6070\u597d\u8fd9\u65f6\u95f4\u70b9\u5bf9\u8fd9\u4e2aKey\u6709\u5927\u91cf\u7684\u5e76\u53d1\u8bf7\u6c42\u8fc7\u6765\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u53d1\u73b0\u7f13\u5b58\u8fc7\u671f\u4e00\u822c\u90fd\u4f1a\u4ece\u540e\u7aef DB \u52a0\u8f7d\u6570\u636e\u5e76\u56de\u8bbe\u5230\u7f13\u5b58\uff0c\u8fd9\u4e2a\u65f6\u5019\u5927\u5e76\u53d1\u7684\u8bf7\u6c42\u53ef\u80fd\u4f1a\u77ac\u95f4\u628a DB \u538b\u57ae\u3002 \u89e3\u51b3\u65b9\u6848\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u7b2c\u4e00\u53ef\u4ee5\u4f7f\u7528\u4e92\u65a5\u9501\uff1a\u5f53\u7f13\u5b58\u5931\u6548\u65f6\uff0c\u4e0d\u7acb\u5373\u53bbload db\uff0c\u5148\u4f7f\u7528\u5982 Redis \u7684 setnx \u53bb\u8bbe\u7f6e\u4e00\u4e2a\u4e92\u65a5\u9501\uff0c\u5f53\u64cd\u4f5c\u6210\u529f\u8fd4\u56de\u65f6\u518d\u8fdb\u884c load db\u7684\u64cd\u4f5c\u5e76\u56de\u8bbe\u7f13\u5b58\uff0c\u5426\u5219\u91cd\u8bd5get\u7f13\u5b58\u7684\u65b9\u6cd5 \u7b2c\u4e8c\u79cd\u65b9\u6848\u53ef\u4ee5\u8bbe\u7f6e\u5f53\u524dkey\u903b\u8f91\u8fc7\u671f\uff0c\u5927\u6982\u662f\u601d\u8def\u5982\u4e0b\uff1a \u2460\uff1a\u5728\u8bbe\u7f6ekey\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u8fc7\u671f\u65f6\u95f4\u5b57\u6bb5\u4e00\u5757\u5b58\u5165\u7f13\u5b58\u4e2d\uff0c\u4e0d\u7ed9\u5f53\u524dkey\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4 \u2461\uff1a\u5f53\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4eceredis\u53d6\u51fa\u6570\u636e\u540e\u5224\u65ad\u65f6\u95f4\u662f\u5426\u8fc7\u671f \u2462\uff1a\u5982\u679c\u8fc7\u671f\u5219\u5f00\u901a\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u6570\u636e\u540c\u6b65\uff0c\u5f53\u524d\u7ebf\u7a0b\u6b63\u5e38\u8fd4\u56de\u6570\u636e\uff0c\u8fd9\u4e2a\u6570\u636e\u4e0d\u662f\u6700\u65b0 \u5f53\u7136\u4e24\u79cd\u65b9\u6848\u5404\u6709\u5229\u5f0a\uff1a \u5982\u679c\u9009\u62e9\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u5efa\u8bae\u4f7f\u7528\u5206\u5e03\u5f0f\u9501\u7684\u65b9\u6848\uff0c\u6027\u80fd\u4e0a\u53ef\u80fd\u6ca1\u90a3\u4e48\u9ad8\uff0c\u9501\u9700\u8981\u7b49\uff0c\u4e5f\u6709\u53ef\u80fd\u4ea7\u751f\u6b7b\u9501\u7684\u95ee\u9898 \u5982\u679c\u9009\u62e9key\u7684\u903b\u8f91\u5220\u9664\uff0c\u5219\u4f18\u5148\u8003\u8651\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6027\u80fd\u6bd4\u8f83\u9ad8\uff0c\u4f46\u662f\u6570\u636e\u540c\u6b65\u8fd9\u5757\u505a\u4e0d\u5230\u5f3a\u4e00\u81f4\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u96ea\u5d29 ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u7f13\u5b58\u96ea\u5d29\u610f\u601d\u662f\u8bbe\u7f6e\u7f13\u5b58\u65f6\u91c7\u7528\u4e86\u76f8\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u5bfc\u81f4\u7f13\u5b58\u5728\u67d0\u4e00\u65f6\u523b\u540c\u65f6\u5931\u6548\uff0c\u8bf7\u6c42\u5168\u90e8\u8f6c\u53d1\u5230DB\uff0cDB \u77ac\u65f6\u538b\u529b\u8fc7\u91cd\u96ea\u5d29\u3002\u4e0e\u7f13\u5b58\u51fb\u7a7f\u7684\u533a\u522b\uff1a\u96ea\u5d29\u662f\u5f88\u591akey\uff0c\u51fb\u7a7f\u662f\u67d0\u4e00\u4e2akey\u7f13\u5b58\u3002 \u89e3\u51b3\u65b9\u6848\u4e3b\u8981\u662f\u53ef\u4ee5\u5c06\u7f13\u5b58\u5931\u6548\u65f6\u95f4\u5206\u6563\u5f00\uff0c\u6bd4\u5982\u53ef\u4ee5\u5728\u539f\u6709\u7684\u5931\u6548\u65f6\u95f4\u57fa\u7840\u4e0a\u589e\u52a0\u4e00\u4e2a\u968f\u673a\u503c\uff0c\u6bd4\u59821-5\u5206\u949f\u968f\u673a\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u7f13\u5b58\u7684\u8fc7\u671f\u65f6\u95f4\u7684\u91cd\u590d\u7387\u5c31\u4f1a\u964d\u4f4e\uff0c\u5c31\u5f88\u96be\u5f15\u53d1\u96c6\u4f53\u5931\u6548\u7684\u4e8b\u4ef6\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0cmysql\u7684\u6570\u636e\u5982\u4f55\u4e0eredis\u8fdb\u884c\u540c\u6b65\u5462\uff1f\uff08\u53cc\u5199\u4e00\u81f4\u6027\uff09 \u5019\u9009\u4eba \uff1a\u55ef\uff01\u5c31\u8bf4\u6211\u6700\u8fd1\u505a\u7684\u8fd9\u4e2a\u9879\u76ee\uff0c\u91cc\u9762\u6709xxxx\uff08 \u6839\u636e\u81ea\u5df1\u7684\u7b80\u5386\u4e0a\u5199 \uff09\u7684\u529f\u80fd\uff0c\u9700\u8981\u8ba9\u6570\u636e\u5e93\u4e0eredis\u9ad8\u5ea6\u4fdd\u6301\u4e00\u81f4\uff0c\u56e0\u4e3a\u8981\u6c42\u65f6\u6548\u6027\u6bd4\u8f83\u9ad8\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u8bfb\u5199\u9501\u4fdd\u8bc1\u7684\u5f3a\u4e00\u81f4\u6027\u3002 \u6211\u4eec\u91c7\u7528\u7684\u662fredisson\u5b9e\u73b0\u7684\u8bfb\u5199\u9501\uff0c\u5728\u8bfb\u7684\u65f6\u5019\u6dfb\u52a0\u5171\u4eab\u9501\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u8bfb\u8bfb\u4e0d\u4e92\u65a5\uff0c\u8bfb\u5199\u4e92\u65a5\u3002\u5f53\u6211\u4eec\u66f4\u65b0\u6570\u636e\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u6392\u4ed6\u9501\uff0c\u5b83\u662f\u8bfb\u5199\uff0c\u8bfb\u8bfb\u90fd\u4e92\u65a5\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u5728\u5199\u6570\u636e\u7684\u540c\u65f6\u662f\u4e0d\u4f1a\u8ba9\u5176\u4ed6\u7ebf\u7a0b\u8bfb\u6570\u636e\u7684\uff0c\u907f\u514d\u4e86\u810f\u6570\u636e\u3002\u8fd9\u91cc\u9762\u9700\u8981\u6ce8\u610f\u7684\u662f\u8bfb\u65b9\u6cd5\u548c\u5199\u65b9\u6cd5\u4e0a\u9700\u8981\u4f7f\u7528\u540c\u4e00\u628a\u9501\u624d\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u8fd9\u4e2a\u6392\u4ed6\u9501\u662f\u5982\u4f55\u4fdd\u8bc1\u8bfb\u5199\u3001\u8bfb\u8bfb\u4e92\u65a5\u7684\u5462\uff1f \u5019\u9009\u4eba \uff1a\u5176\u5b9e\u6392\u4ed6\u9501\u5e95\u5c42\u4f7f\u7528\u4e5f\u662fsetnx\uff0c\u4fdd\u8bc1\u4e86\u540c\u65f6\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u64cd\u4f5c\u9501\u4f4f\u7684\u65b9\u6cd5 \u9762\u8bd5\u5b98 \uff1a\u4f60\u542c\u8bf4\u8fc7\u5ef6\u65f6\u53cc\u5220\u5417\uff1f\u4e3a\u4ec0\u4e48\u4e0d\u7528\u5b83\u5462\uff1f \u5019\u9009\u4eba \uff1a\u5ef6\u8fdf\u53cc\u5220\uff0c\u5982\u679c\u662f\u5199\u64cd\u4f5c\uff0c\u6211\u4eec\u5148\u628a\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u5220\u9664\uff0c\u7136\u540e\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u6700\u540e\u518d\u5ef6\u65f6\u5220\u9664\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u5176\u4e2d\u8fd9\u4e2a\u5ef6\u65f6\u591a\u4e45\u4e0d\u592a\u597d\u786e\u5b9a\uff0c\u5728\u5ef6\u65f6\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0\u810f\u6570\u636e\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\uff0c\u6240\u4ee5\u6ca1\u6709\u91c7\u7528\u5b83\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0cmysql\u7684\u6570\u636e\u5982\u4f55\u4e0eredis\u8fdb\u884c\u540c\u6b65\u5462\uff1f\uff08\u53cc\u5199\u4e00\u81f4\u6027\uff09 \u5019\u9009\u4eba \uff1a\u55ef\uff01\u5c31\u8bf4\u6211\u6700\u8fd1\u505a\u7684\u8fd9\u4e2a\u9879\u76ee\uff0c\u91cc\u9762\u6709xxxx\uff08 \u6839\u636e\u81ea\u5df1\u7684\u7b80\u5386\u4e0a\u5199 \uff09\u7684\u529f\u80fd\uff0c\u6570\u636e\u540c\u6b65\u53ef\u4ee5\u6709\u4e00\u5b9a\u7684\u5ef6\u65f6\uff08\u7b26\u5408\u5927\u90e8\u5206\u4e1a\u52a1\uff09 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u963f\u91cc\u7684canal\u7ec4\u4ef6\u5b9e\u73b0\u6570\u636e\u540c\u6b65\uff1a\u4e0d\u9700\u8981\u66f4\u6539\u4e1a\u52a1\u4ee3\u7801\uff0c\u90e8\u7f72\u4e00\u4e2acanal\u670d\u52a1\u3002canal\u670d\u52a1\u628a\u81ea\u5df1\u4f2a\u88c5\u6210mysql\u7684\u4e00\u4e2a\u4ece\u8282\u70b9\uff0c\u5f53mysql\u6570\u636e\u66f4\u65b0\u4ee5\u540e\uff0ccanal\u4f1a\u8bfb\u53d6binlog\u6570\u636e\uff0c\u7136\u540e\u5728\u901a\u8fc7canal\u7684\u5ba2\u6237\u7aef\u83b7\u53d6\u5230\u6570\u636e\uff0c\u66f4\u65b0\u7f13\u5b58\u5373\u53ef\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0c\u6570\u636e\u7684\u6301\u4e45\u5316\u662f\u600e\u4e48\u505a\u7684\uff1f \u5019\u9009\u4eba \uff1a\u5728Redis\u4e2d\u63d0\u4f9b\u4e86\u4e24\u79cd\u6570\u636e\u6301\u4e45\u5316\u7684\u65b9\u5f0f\uff1a1\u3001RDB 2\u3001AOF \u9762\u8bd5\u5b98 \uff1a\u8fd9\u4e24\u79cd\u6301\u4e45\u5316\u65b9\u5f0f\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f \u5019\u9009\u4eba \uff1aRDB\u662f\u4e00\u4e2a\u5feb\u7167\u6587\u4ef6\uff0c\u5b83\u662f\u628aredis\u5185\u5b58\u5b58\u50a8\u7684\u6570\u636e\u5199\u5230\u78c1\u76d8\u4e0a\uff0c\u5f53redis\u5b9e\u4f8b\u5b95\u673a\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u65b9\u4fbf\u4eceRDB\u7684\u5feb\u7167\u6587\u4ef6\u4e2d\u6062\u590d\u6570\u636e\u3002 AOF\u7684\u542b\u4e49\u662f\u8ffd\u52a0\u6587\u4ef6\uff0c\u5f53redis\u64cd\u4f5c\u5199\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5f53redis\u5b9e\u4f8b\u5b95\u673a\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u518d\u6b21\u6267\u884c\u4e00\u904d\u547d\u4ee4\u6765\u6062\u590d\u6570\u636e \u9762\u8bd5\u5b98 \uff1a\u8fd9\u4e24\u79cd\u65b9\u5f0f\uff0c\u54ea\u79cd\u6062\u590d\u7684\u6bd4\u8f83\u5feb\u5462\uff1f \u5019\u9009\u4eba \uff1aRDB\u56e0\u4e3a\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5728\u4fdd\u5b58\u7684\u65f6\u5019\u4f53\u79ef\u4e5f\u662f\u6bd4\u8f83\u5c0f\u7684\uff0c\u5b83\u6062\u590d\u7684\u6bd4\u8f83\u5feb\uff0c\u4f46\u662f\u5b83\u6709\u53ef\u80fd\u4f1a\u4e22\u6570\u636e\uff0c\u6211\u4eec\u901a\u5e38\u5728\u9879\u76ee\u4e2d\u4e5f\u4f1a\u4f7f\u7528AOF\u6765\u6062\u590d\u6570\u636e\uff0c\u867d\u7136AOF\u6062\u590d\u7684\u901f\u5ea6\u6162\u4e00\u4e9b\uff0c\u4f46\u662f\u5b83\u4e22\u6570\u636e\u7684\u98ce\u9669\u8981\u5c0f\u5f88\u591a\uff0c\u5728AOF\u6587\u4ef6\u4e2d\u53ef\u4ee5\u8bbe\u7f6e\u5237\u76d8\u7b56\u7565\uff0c\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u7684\u5c31\u662f\u6bcf\u79d2\u6279\u91cf\u5199\u5165\u4e00\u6b21\u547d\u4ee4 \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u6570\u636e\u8fc7\u671f\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u4e24\u79cd\u6570\u636e\u8fc7\u671f\u5220\u9664\u7b56\u7565 \u7b2c\u4e00\u79cd\u662f\u60f0\u6027\u5220\u9664\uff0c\u5728\u8bbe\u7f6e\u8be5key\u8fc7\u671f\u65f6\u95f4\u540e\uff0c\u6211\u4eec\u4e0d\u53bb\u7ba1\u5b83\uff0c\u5f53\u9700\u8981\u8be5key\u65f6\uff0c\u6211\u4eec\u5728\u68c0\u67e5\u5176\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\uff0c\u6211\u4eec\u5c31\u5220\u6389\u5b83\uff0c\u53cd\u4e4b\u8fd4\u56de\u8be5key\u3002 \u7b2c\u4e8c\u79cd\u662f \u5b9a\u671f\u5220\u9664\uff0c\u5c31\u662f\u8bf4\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u6211\u4eec\u5c31\u5bf9\u4e00\u4e9bkey\u8fdb\u884c\u68c0\u67e5\uff0c\u5220\u9664\u91cc\u9762\u8fc7\u671f\u7684key \u5b9a\u671f\u6e05\u7406\u7684\u4e24\u79cd\u6a21\u5f0f\uff1a SLOW\u6a21\u5f0f\u662f\u5b9a\u65f6\u4efb\u52a1\uff0c\u6267\u884c\u9891\u7387\u9ed8\u8ba4\u4e3a10hz\uff0c\u6bcf\u6b21\u4e0d\u8d85\u8fc725ms\uff0c\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6587\u4ef6redis.conf \u7684 hz \u9009\u9879\u6765\u8c03\u6574\u8fd9\u4e2a\u6b21\u6570 FAST\u6a21\u5f0f\u6267\u884c\u9891\u7387\u4e0d\u56fa\u5b9a\uff0c\u6bcf\u6b21\u4e8b\u4ef6\u5faa\u73af\u4f1a\u5c1d\u8bd5\u6267\u884c\uff0c\u4f46\u4e24\u6b21\u95f4\u9694\u4e0d\u4f4e\u4e8e2ms\uff0c\u6bcf\u6b21\u8017\u65f6\u4e0d\u8d85\u8fc71ms Redis\u7684\u8fc7\u671f\u5220\u9664\u7b56\u7565\uff1a \u60f0\u6027\u5220\u9664 + \u5b9a\u671f\u5220\u9664 \u4e24\u79cd\u7b56\u7565\u8fdb\u884c\u914d\u5408\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u6570\u636e\u6dd8\u6c70\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u79cd\uff0c\u9ed8\u8ba4\u662fnoeviction\uff0c\u4e0d\u5220\u9664\u4efb\u4f55\u6570\u636e\uff0c\u5185\u90e8\u4e0d\u8db3\u76f4\u63a5\u62a5\u9519 \u662f\u53ef\u4ee5\u5728redis\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u7684\uff0c\u91cc\u9762\u6709\u4e24\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u4e00\u4e2a\u662fLRU\uff0c\u53e6\u5916\u4e00\u4e2a\u662fLFU LRU\u7684\u610f\u601d\u5c31\u662f\u6700\u5c11\u6700\u8fd1\u4f7f\u7528\uff0c\u7528\u5f53\u524d\u65f6\u95f4\u51cf\u53bb\u6700\u540e\u4e00\u6b21\u8bbf\u95ee\u65f6\u95f4\uff0c\u8fd9\u4e2a\u503c\u8d8a\u5927\u5219\u6dd8\u6c70\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002 LFU\u7684\u610f\u601d\u662f\u6700\u5c11\u9891\u7387\u4f7f\u7528\u3002\u4f1a\u7edf\u8ba1\u6bcf\u4e2akey\u7684\u8bbf\u95ee\u9891\u7387\uff0c\u503c\u8d8a\u5c0f\u6dd8\u6c70\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u6211\u4eec\u5728\u9879\u76ee\u8bbe\u7f6e\u7684allkeys-lru\uff0c\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff0c\u628a\u4e00\u4e9b\u7ecf\u5e38\u8bbf\u95ee\u7684key\u7559\u5728redis\u4e2d \u9762\u8bd5\u5b98 \uff1a\u6570\u636e\u5e93\u67091000\u4e07\u6570\u636e ,Redis\u53ea\u80fd\u7f13\u5b5820w\u6570\u636e, \u5982\u4f55\u4fdd\u8bc1Redis\u4e2d\u7684\u6570\u636e\u90fd\u662f\u70ed\u70b9\u6570\u636e ? \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u4e00\u4e0b~~ \u53ef\u4ee5\u4f7f\u7528 allkeys-lru \uff08\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff09\u6dd8\u6c70\u7b56\u7565\uff0c\u90a3\u7559\u4e0b\u6765\u7684\u90fd\u662f\u7ecf\u5e38\u8bbf\u95ee\u7684\u70ed\u70b9\u6570\u636e \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u5185\u5b58\u7528\u5b8c\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u8fd9\u4e2a\u8981\u770bredis\u7684\u6570\u636e\u6dd8\u6c70\u7b56\u7565\u662f\u4ec0\u4e48\uff0c\u5982\u679c\u662f\u9ed8\u8ba4\u7684\u914d\u7f6e\uff0credis\u5185\u5b58\u7528\u5b8c\u4ee5\u540e\u5219\u76f4\u63a5\u62a5\u9519\u3002\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u7684 allkeys-lru \u7b56\u7565\u3002\u628a\u6700\u8fd1\u6700\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u7559\u5728\u7f13\u5b58\u4e2d\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u5206\u5e03\u5f0f\u9501\u5982\u4f55\u5b9e\u73b0 ? \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u547d\u4ee4setnx(SET if not exists) \u7531\u4e8eredis\u7684\u5355\u7ebf\u7a0b\u7684\uff0c\u7528\u4e86\u547d\u4ee4\u4e4b\u540e\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u5bf9\u67d0\u4e00\u4e2akey\u8bbe\u7f6e\u503c\uff0c\u5728\u6ca1\u6709\u8fc7\u671f\u6216\u5220\u9664key\u7684\u65f6\u5019\u662f\u5176\u4ed6\u5ba2\u6237\u7aef\u662f\u4e0d\u80fd\u8bbe\u7f6e\u8fd9\u4e2akey\u7684 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u4f60\u5982\u4f55\u63a7\u5236Redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u6709\u6548\u65f6\u957f\u5462\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u7684\u786e\uff0credis\u7684setnx\u6307\u4ee4\u4e0d\u597d\u63a7\u5236\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684redis\u7684\u4e00\u4e2a\u6846\u67b6redisson\u5b9e\u73b0\u7684\u3002 \u5728redisson\u4e2d\u9700\u8981\u624b\u52a8\u52a0\u9501\uff0c\u5e76\u4e14\u53ef\u4ee5\u63a7\u5236\u9501\u7684\u5931\u6548\u65f6\u95f4\u548c\u7b49\u5f85\u65f6\u95f4\uff0c\u5f53\u9501\u4f4f\u7684\u4e00\u4e2a\u4e1a\u52a1\u8fd8\u6ca1\u6709\u6267\u884c\u5b8c\u6210\u7684\u65f6\u5019\uff0c\u5728redisson\u4e2d\u5f15\u5165\u4e86\u4e00\u4e2a\u770b\u95e8\u72d7\u673a\u5236\uff0c\u5c31\u662f\u8bf4\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u68c0\u67e5\u5f53\u524d\u4e1a\u52a1\u662f\u5426\u8fd8\u6301\u6709\u9501\uff0c\u5982\u679c\u6301\u6709\u5c31\u589e\u52a0\u52a0\u9501\u7684\u6301\u6709\u65f6\u95f4\uff0c\u5f53\u4e1a\u52a1\u6267\u884c\u5b8c\u6210\u4e4b\u540e\u9700\u8981\u4f7f\u7528\u91ca\u653e\u9501\u5c31\u53ef\u4ee5\u4e86 \u8fd8\u6709\u4e00\u4e2a\u597d\u5904\u5c31\u662f\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u4e00\u4e2a\u4e1a\u52a1\u6709\u53ef\u80fd\u4f1a\u6267\u884c\u5f88\u5feb\uff0c\u5148\u5ba2\u62371\u6301\u6709\u9501\u7684\u65f6\u5019\uff0c\u5ba2\u62372\u6765\u4e86\u4ee5\u540e\u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u62d2\u7edd\uff0c\u5b83\u4f1a\u81ea\u65cb\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u9501\uff0c\u5982\u679c\u5ba2\u62371\u91ca\u653e\u4e4b\u540e\uff0c\u5ba2\u62372\u5c31\u53ef\u4ee5\u9a6c\u4e0a\u6301\u6709\u9501\uff0c\u6027\u80fd\u4e5f\u5f97\u5230\u4e86\u63d0\u5347\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0credisson\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\u662f\u53ef\u91cd\u5165\u7684\u5417\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u53ef\u4ee5\u91cd\u5165\u7684\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u907f\u514d\u6b7b\u9501\u7684\u4ea7\u751f\u3002\u8fd9\u4e2a\u91cd\u5165\u5176\u5b9e\u5728\u5185\u90e8\u5c31\u662f\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\u7684\u9501\uff0c\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\u7684\u9501\u5c31\u4f1a\u8ba1\u6570\uff0c\u5982\u679c\u91ca\u653e\u9501\u5c31\u4f1a\u5728\u8ba1\u7b97\u4e0a\u51cf\u4e00\u3002\u5728\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u91c7\u7528\u7684hash\u7ed3\u6784\uff0c\u5927key\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u4e1a\u52a1\u8fdb\u884c\u5b9a\u5236\uff0c\u5176\u4e2d\u5c0fkey\u662f\u5f53\u524d\u7ebf\u7a0b\u7684\u552f\u4e00\u6807\u8bc6\uff0cvalue\u662f\u5f53\u524d\u7ebf\u7a0b\u91cd\u5165\u7684\u6b21\u6570 \u9762\u8bd5\u5b98 \uff1aredisson\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\u80fd\u89e3\u51b3\u4e3b\u4ece\u4e00\u81f4\u6027\u7684\u95ee\u9898\u5417 \u5019\u9009\u4eba \uff1a\u8fd9\u4e2a\u662f\u4e0d\u80fd\u7684\uff0c\u6bd4\u5982\uff0c\u5f53\u7ebf\u7a0b1\u52a0\u9501\u6210\u529f\u540e\uff0cmaster\u8282\u70b9\u6570\u636e\u4f1a\u5f02\u6b65\u590d\u5236\u5230slave\u8282\u70b9\uff0c\u6b64\u65f6\u5f53\u524d\u6301\u6709Redis\u9501\u7684master\u8282\u70b9\u5b95\u673a\uff0cslave\u8282\u70b9\u88ab\u63d0\u5347\u4e3a\u65b0\u7684master\u8282\u70b9\uff0c\u5047\u5982\u73b0\u5728\u6765\u4e86\u4e00\u4e2a\u7ebf\u7a0b2\uff0c\u518d\u6b21\u52a0\u9501\uff0c\u4f1a\u5728\u65b0\u7684master\u8282\u70b9\u4e0a\u52a0\u9501\u6210\u529f\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u4e24\u4e2a\u8282\u70b9\u540c\u65f6\u6301\u6709\u4e00\u628a\u9501\u7684\u95ee\u9898\u3002 \u6211\u4eec\u53ef\u4ee5\u5229\u7528redisson\u63d0\u4f9b\u7684\u7ea2\u9501\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5b83\u7684\u4e3b\u8981\u4f5c\u7528\u662f\uff0c\u4e0d\u80fd\u53ea\u5728\u4e00\u4e2aredis\u5b9e\u4f8b\u4e0a\u521b\u5efa\u9501\uff0c\u5e94\u8be5\u662f\u5728\u591a\u4e2aredis\u5b9e\u4f8b\u4e0a\u521b\u5efa\u9501\uff0c\u5e76\u4e14\u8981\u6c42\u5728\u5927\u591a\u6570redis\u8282\u70b9\u4e0a\u90fd\u6210\u529f\u521b\u5efa\u9501\uff0c\u7ea2\u9501\u4e2d\u8981\u6c42\u662fredis\u7684\u8282\u70b9\u6570\u91cf\u8981\u8fc7\u534a\u3002\u8fd9\u6837\u5c31\u80fd\u907f\u514d\u7ebf\u7a0b1\u52a0\u9501\u6210\u529f\u540emaster\u8282\u70b9\u5b95\u673a\u5bfc\u81f4\u7ebf\u7a0b2\u6210\u529f\u52a0\u9501\u5230\u65b0\u7684master\u8282\u70b9\u4e0a\u7684\u95ee\u9898\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u7ea2\u9501\uff0c\u56e0\u4e3a\u9700\u8981\u540c\u65f6\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u90fd\u6dfb\u52a0\u9501\uff0c\u6027\u80fd\u5c31\u53d8\u7684\u5f88\u4f4e\u4e86\uff0c\u5e76\u4e14\u8fd0\u7ef4\u7ef4\u62a4\u6210\u672c\u4e5f\u975e\u5e38\u9ad8\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u5728\u9879\u76ee\u4e2d\u4e5f\u4e0d\u4f1a\u76f4\u63a5\u4f7f\u7528\u7ea2\u9501\uff0c\u5e76\u4e14\u5b98\u65b9\u4e5f\u6682\u65f6\u5e9f\u5f03\u4e86\u8fd9\u4e2a\u7ea2\u9501 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u5982\u679c\u4e1a\u52a1\u975e\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u8fd9\u4e2a\u8be5\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba\uff1a \u55ef~\uff0credis\u672c\u8eab\u5c31\u662f\u652f\u6301\u9ad8\u53ef\u7528\u7684\uff0c\u505a\u5230\u5f3a\u4e00\u81f4\u6027\uff0c\u5c31\u975e\u5e38\u5f71\u54cd\u6027\u80fd\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u6709\u5f3a\u4e00\u81f4\u6027\u8981\u6c42\u9ad8\u7684\u4e1a\u52a1\uff0c\u5efa\u8bae\u4f7f\u7528zookeeper\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\uff0c\u5b83\u662f\u53ef\u4ee5\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\u7684\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u96c6\u7fa4\u6709\u54ea\u4e9b\u65b9\u6848, \u77e5\u9053\u561b ? \u5019\u9009\u4eba \uff1a\u55ef~~\uff0c\u5728Redis\u4e2d\u63d0\u4f9b\u7684\u96c6\u7fa4\u65b9\u6848\u603b\u5171\u6709\u4e09\u79cd\uff1a\u4e3b\u4ece\u590d\u5236\u3001\u54e8\u5175\u6a21\u5f0f\u3001Redis\u5206\u7247\u96c6\u7fa4 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u6765\u4ecb\u7ecd\u4e00\u4e0b\u4e3b\u4ece\u540c\u6b65 \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u5355\u8282\u70b9Redis\u7684\u5e76\u53d1\u80fd\u529b\u662f\u6709\u4e0a\u9650\u7684\uff0c\u8981\u8fdb\u4e00\u6b65\u63d0\u9ad8Redis\u7684\u5e76\u53d1\u80fd\u529b\uff0c\u53ef\u4ee5\u642d\u5efa\u4e3b\u4ece\u96c6\u7fa4\uff0c\u5b9e\u73b0\u8bfb\u5199\u5206\u79bb\u3002\u4e00\u822c\u90fd\u662f\u4e00\u4e3b\u591a\u4ece\uff0c\u4e3b\u8282\u70b9\u8d1f\u8d23\u5199\u6570\u636e\uff0c\u4ece\u8282\u70b9\u8d1f\u8d23\u8bfb\u6570\u636e\uff0c\u4e3b\u8282\u70b9\u5199\u5165\u6570\u636e\u4e4b\u540e\uff0c\u9700\u8981\u628a\u6570\u636e\u540c\u6b65\u5230\u4ece\u8282\u70b9\u4e2d \u9762\u8bd5\u5b98 \uff1a\u80fd\u8bf4\u4e00\u4e0b\uff0c\u4e3b\u4ece\u540c\u6b65\u6570\u636e\u7684\u6d41\u7a0b \u5019\u9009\u4eba \uff1a\u55ef~~\uff0c\u597d\uff01\u4e3b\u4ece\u540c\u6b65\u5206\u4e3a\u4e86\u4e24\u4e2a\u9636\u6bb5\uff0c\u4e00\u4e2a\u662f\u5168\u91cf\u540c\u6b65\uff0c\u4e00\u4e2a\u662f\u589e\u91cf\u540c\u6b65 \u5168\u91cf\u540c\u6b65\u662f\u6307\u4ece\u8282\u70b9\u7b2c\u4e00\u6b21\u4e0e\u4e3b\u8282\u70b9\u5efa\u7acb\u8fde\u63a5\u7684\u65f6\u5019\u4f7f\u7528\u5168\u91cf\u540c\u6b65\uff0c\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a \u7b2c\u4e00\uff1a\u4ece\u8282\u70b9\u8bf7\u6c42\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\uff0c\u5176\u4e2d\u4ece\u8282\u70b9\u4f1a\u643a\u5e26\u81ea\u5df1\u7684replication id\u548coffset\u504f\u79fb\u91cf\u3002 \u7b2c\u4e8c\uff1a\u4e3b\u8282\u70b9\u5224\u65ad\u662f\u5426\u662f\u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e3b\u8981\u5224\u65ad\u7684\u4f9d\u636e\u5c31\u662f\uff0c\u4e3b\u8282\u70b9\u4e0e\u4ece\u8282\u70b9\u662f\u5426\u662f\u540c\u4e00\u4e2areplication id\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5c31\u8bf4\u660e\u662f\u7b2c\u4e00\u6b21\u540c\u6b65\uff0c\u90a3\u4e3b\u8282\u70b9\u5c31\u4f1a\u628a\u81ea\u5df1\u7684replication id\u548coffset\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\uff0c\u8ba9\u4ece\u8282\u70b9\u4e0e\u4e3b\u8282\u70b9\u7684\u4fe1\u606f\u4fdd\u6301\u4e00\u81f4\u3002 \u7b2c\u4e09\uff1a\u5728\u540c\u65f6\u4e3b\u8282\u70b9\u4f1a\u6267\u884cbgsave\uff0c\u751f\u6210rdb\u6587\u4ef6\u540e\uff0c\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\u53bb\u6267\u884c\uff0c\u4ece\u8282\u70b9\u5148\u628a\u81ea\u5df1\u7684\u6570\u636e\u6e05\u7a7a\uff0c\u7136\u540e\u6267\u884c\u4e3b\u8282\u70b9\u53d1\u9001\u8fc7\u6765\u7684rdb\u6587\u4ef6\uff0c\u8fd9\u6837\u5c31\u4fdd\u6301\u4e86\u4e00\u81f4 \u5f53\u7136\uff0c\u5982\u679c\u5728rdb\u751f\u6210\u6267\u884c\u671f\u95f4\uff0c\u4f9d\u7136\u6709\u8bf7\u6c42\u5230\u4e86\u4e3b\u8282\u70b9\uff0c\u800c\u4e3b\u8282\u70b9\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\u8bb0\u5f55\u5230\u7f13\u51b2\u533a\uff0c\u7f13\u51b2\u533a\u662f\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u6700\u540e\u628a\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u4e3b\u8282\u70b9\u4e0e\u4ece\u8282\u70b9\u5b8c\u5168\u4e00\u81f4\u4e86\uff0c\u540e\u671f\u518d\u540c\u6b65\u6570\u636e\u7684\u65f6\u5019\uff0c\u90fd\u662f\u4f9d\u8d56\u4e8e\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u8fd9\u4e2a\u5c31\u662f\u5168\u91cf\u540c\u6b65 \u589e\u91cf\u540c\u6b65\u6307\u7684\u662f\uff0c\u5f53\u4ece\u8282\u70b9\u670d\u52a1\u91cd\u542f\u4e4b\u540e\uff0c\u6570\u636e\u5c31\u4e0d\u4e00\u81f4\u4e86\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\uff0c\u4ece\u8282\u70b9\u4f1a\u8bf7\u6c42\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\uff0c\u4e3b\u8282\u70b9\u8fd8\u662f\u5224\u65ad\u4e0d\u662f\u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e0d\u662f\u7b2c\u4e00\u6b21\u5c31\u83b7\u53d6\u4ece\u8282\u70b9\u7684offset\u503c\uff0c\u7136\u540e\u4e3b\u8282\u70b9\u4ece\u547d\u4ee4\u65e5\u5fd7\u4e2d\u83b7\u53d6offset\u503c\u4e4b\u540e\u7684\u6570\u636e\uff0c\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\u8fdb\u884c\u6570\u636e\u540c\u6b65 \u9762\u8bd5\u5b98 \uff1a\u600e\u4e48\u4fdd\u8bc1Redis\u7684\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528 \u5019\u9009\u4eba \uff1a\u9996\u5148\u53ef\u4ee5\u642d\u5efa\u4e3b\u4ece\u96c6\u7fa4\uff0c\u518d\u52a0\u4e0a\u4f7f\u7528redis\u4e2d\u7684\u54e8\u5175\u6a21\u5f0f\uff0c\u54e8\u5175\u6a21\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u4e3b\u4ece\u96c6\u7fa4\u7684\u81ea\u52a8\u6545\u969c\u6062\u590d\uff0c\u91cc\u9762\u5c31\u5305\u542b\u4e86\u5bf9\u4e3b\u4ece\u670d\u52a1\u7684\u76d1\u63a7\u3001\u81ea\u52a8\u6545\u969c\u6062\u590d\u3001\u901a\u77e5\uff1b\u5982\u679cmaster\u6545\u969c\uff0cSentinel\u4f1a\u5c06\u4e00\u4e2aslave\u63d0\u5347\u4e3amaster\u3002\u5f53\u6545\u969c\u5b9e\u4f8b\u6062\u590d\u540e\u4e5f\u4ee5\u65b0\u7684master\u4e3a\u4e3b\uff1b\u540c\u65f6Sentinel\u4e5f\u5145\u5f53Redis\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u53d1\u73b0\u6765\u6e90\uff0c\u5f53\u96c6\u7fa4\u53d1\u751f\u6545\u969c\u8f6c\u79fb\u65f6\uff0c\u4f1a\u5c06\u6700\u65b0\u4fe1\u606f\u63a8\u9001\u7ed9Redis\u7684\u5ba2\u6237\u7aef\uff0c\u6240\u4ee5\u4e00\u822c\u9879\u76ee\u90fd\u4f1a\u91c7\u7528\u54e8\u5175\u7684\u6a21\u5f0f\u6765\u4fdd\u8bc1redis\u7684\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528 \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u4f7f\u7528redis\u662f\u5355\u70b9\u8fd8\u662f\u96c6\u7fa4\uff0c\u54ea\u79cd\u96c6\u7fa4 \u5019\u9009\u4eba \uff1a\u55ef\uff01\uff0c\u6211\u4eec\u5f53\u65f6\u4f7f\u7528\u7684\u662f\u4e3b\u4ece\uff081\u4e3b1\u4ece\uff09\u52a0\u54e8\u5175\u3002\u4e00\u822c\u5355\u8282\u70b9\u4e0d\u8d85\u8fc710G\u5185\u5b58\uff0c\u5982\u679cRedis\u5185\u5b58\u4e0d\u8db3\u5219\u53ef\u4ee5\u7ed9\u4e0d\u540c\u670d\u52a1\u5206\u914d\u72ec\u7acb\u7684Redis\u4e3b\u4ece\u8282\u70b9\u3002\u5c3d\u91cf\u4e0d\u505a\u5206\u7247\u96c6\u7fa4\u3002\u56e0\u4e3a\u96c6\u7fa4\u7ef4\u62a4\u8d77\u6765\u6bd4\u8f83\u9ebb\u70e6\uff0c\u5e76\u4e14\u96c6\u7fa4\u4e4b\u95f4\u7684\u5fc3\u8df3\u68c0\u6d4b\u548c\u6570\u636e\u901a\u4fe1\u4f1a\u6d88\u8017\u5927\u91cf\u7684\u7f51\u7edc\u5e26\u5bbd\uff0c\u4e5f\u6ca1\u6709\u529e\u6cd5\u4f7f\u7528lua\u811a\u672c\u548c\u4e8b\u52a1 \u9762\u8bd5\u5b98 \uff1aredis\u96c6\u7fa4\u8111\u88c2\uff0c\u8be5\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff01 \u8fd9\u4e2a\u5728\u9879\u76ee\u5f88\u5c11\u89c1\uff0c\u4e0d\u8fc7\u8111\u88c2\u7684\u95ee\u9898\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u73b0\u5728\u7528\u7684\u662fredis\u7684\u54e8\u5175\u6a21\u5f0f\u96c6\u7fa4\u7684 \u6709\u7684\u65f6\u5019\u7531\u4e8e\u7f51\u7edc\u7b49\u539f\u56e0\u53ef\u80fd\u4f1a\u51fa\u73b0\u8111\u88c2\u7684\u60c5\u51b5\uff0c\u5c31\u662f\u8bf4\uff0c\u7531\u4e8eredis master\u8282\u70b9\u548credis salve\u8282\u70b9\u548csentinel\u5904\u4e8e\u4e0d\u540c\u7684\u7f51\u7edc\u5206\u533a\uff0c\u4f7f\u5f97sentinel\u6ca1\u6709\u80fd\u591f\u5fc3\u8df3\u611f\u77e5\u5230master\uff0c\u6240\u4ee5\u901a\u8fc7\u9009\u4e3e\u7684\u65b9\u5f0f\u63d0\u5347\u4e86\u4e00\u4e2asalve\u4e3amaster\uff0c\u8fd9\u6837\u5c31\u5b58\u5728\u4e86\u4e24\u4e2amaster\uff0c\u5c31\u50cf\u5927\u8111\u5206\u88c2\u4e86\u4e00\u6837\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u5ba2\u6237\u7aef\u8fd8\u5728old master\u90a3\u91cc\u5199\u5165\u6570\u636e\uff0c\u65b0\u8282\u70b9\u65e0\u6cd5\u540c\u6b65\u6570\u636e\uff0c\u5f53\u7f51\u7edc\u6062\u590d\u540e\uff0csentinel\u4f1a\u5c06old master\u964d\u4e3asalve\uff0c\u8fd9\u65f6\u518d\u4ece\u65b0master\u540c\u6b65\u6570\u636e\uff0c\u8fd9\u4f1a\u5bfc\u81f4old master\u4e2d\u7684\u5927\u91cf\u6570\u636e\u4e22\u5931\u3002 \u5173\u4e8e\u89e3\u51b3\u7684\u8bdd\uff0c\u6211\u8bb0\u5f97\u5728redis\u7684\u914d\u7f6e\u4e2d\u53ef\u4ee5\u8bbe\u7f6e\uff1a\u7b2c\u4e00\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5c11\u7684salve\u8282\u70b9\u4e2a\u6570\uff0c\u6bd4\u5982\u8bbe\u7f6e\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u4ece\u8282\u70b9\u624d\u80fd\u540c\u6b65\u6570\u636e\uff0c\u7b2c\u4e8c\u4e2a\u53ef\u4ee5\u8bbe\u7f6e\u4e3b\u4ece\u6570\u636e\u590d\u5236\u548c\u540c\u6b65\u7684\u5ef6\u8fdf\u65f6\u95f4\uff0c\u8fbe\u4e0d\u5230\u8981\u6c42\u5c31\u62d2\u7edd\u8bf7\u6c42\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u5927\u91cf\u7684\u6570\u636e\u4e22\u5931 \u9762\u8bd5\u5b98 \uff1aredis\u7684\u5206\u7247\u96c6\u7fa4\u6709\u4ec0\u4e48\u4f5c\u7528 \u5019\u9009\u4eba \uff1a\u5206\u7247\u96c6\u7fa4\u4e3b\u8981\u89e3\u51b3\u7684\u662f\uff0c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u96c6\u7fa4\u4e2d\u6709\u591a\u4e2amaster\uff0c\u6bcf\u4e2amaster\u4fdd\u5b58\u4e0d\u540c\u6570\u636e\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u7ed9\u6bcf\u4e2amaster\u8bbe\u7f6e\u591a\u4e2aslave\u8282\u70b9\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u589e\u5927\u96c6\u7fa4\u7684\u9ad8\u5e76\u53d1\u80fd\u529b\u3002\u540c\u65f6\u6bcf\u4e2amaster\u4e4b\u95f4\u901a\u8fc7ping\u76d1\u6d4b\u5f7c\u6b64\u5065\u5eb7\u72b6\u6001\uff0c\u5c31\u7c7b\u4f3c\u4e8e\u54e8\u5175\u6a21\u5f0f\u4e86\u3002\u5f53\u5ba2\u6237\u7aef\u8bf7\u6c42\u53ef\u4ee5\u8bbf\u95ee\u96c6\u7fa4\u4efb\u610f\u8282\u70b9\uff0c\u6700\u7ec8\u90fd\u4f1a\u88ab\u8f6c\u53d1\u5230\u6b63\u786e\u8282\u70b9 \u9762\u8bd5\u5b98 \uff1aRedis\u5206\u7247\u96c6\u7fa4\u4e2d\u6570\u636e\u662f\u600e\u4e48\u5b58\u50a8\u548c\u8bfb\u53d6\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5728redis\u96c6\u7fa4\u4e2d\u662f\u8fd9\u6837\u7684 Redis \u96c6\u7fa4\u5f15\u5165\u4e86\u54c8\u5e0c\u69fd\u7684\u6982\u5ff5\uff0c\u6709 16384 \u4e2a\u54c8\u5e0c\u69fd\uff0c\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u4e3b\u8282\u70b9\u7ed1\u5b9a\u4e86\u4e00\u5b9a\u8303\u56f4\u7684\u54c8\u5e0c\u69fd\u8303\u56f4\uff0c key\u901a\u8fc7 CRC16 \u6821\u9a8c\u540e\u5bf9 16384 \u53d6\u6a21\u6765\u51b3\u5b9a\u653e\u7f6e\u54ea\u4e2a\u69fd\uff0c\u901a\u8fc7\u69fd\u627e\u5230\u5bf9\u5e94\u7684\u8282\u70b9\u8fdb\u884c\u5b58\u50a8\u3002 \u53d6\u503c\u7684\u903b\u8f91\u662f\u4e00\u6837\u7684 \u9762\u8bd5\u5b98 \uff1aRedis\u662f\u5355\u7ebf\u7a0b\u7684\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u8fd8\u90a3\u4e48\u5feb\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u6709\u51e0\u4e2a\u539f\u56e0\u5427~~~ 1\u3001\u5b8c\u5168\u57fa\u4e8e\u5185\u5b58\u7684\uff0cC\u8bed\u8a00\u7f16\u5199 2\u3001\u91c7\u7528\u5355\u7ebf\u7a0b\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4e0a\u4e0b\u6587\u5207\u6362\u53ef\u7ade\u4e89\u6761\u4ef6 3\u3001\u4f7f\u7528\u591a\u8defI/O\u590d\u7528\u6a21\u578b\uff0c\u975e\u963b\u585eIO \u4f8b\u5982\uff1abgsave \u548c bgrewriteaof \u90fd\u662f\u5728 \u540e\u53f0 \u6267\u884c\u64cd\u4f5c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u7ebf\u7a0b\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u4e0d\u4f1a\u4ea7\u751f\u963b\u585e \u9762\u8bd5\u5b98 \uff1a\u80fd\u89e3\u91ca\u4e00\u4e0bI/O\u591a\u8def\u590d\u7528\u6a21\u578b\uff1f \u5019\u9009\u4eba \uff1a\u55ef~~\uff0cI/O\u591a\u8def\u590d\u7528\u662f\u6307\u5229\u7528\u5355\u4e2a\u7ebf\u7a0b\u6765\u540c\u65f6\u76d1\u542c\u591a\u4e2aSocket \uff0c\u5e76\u5728\u67d0\u4e2aSocket\u53ef\u8bfb\u3001\u53ef\u5199\u65f6\u5f97\u5230\u901a\u77e5\uff0c\u4ece\u800c\u907f\u514d\u65e0\u6548\u7684\u7b49\u5f85\uff0c\u5145\u5206\u5229\u7528CPU\u8d44\u6e90\u3002\u76ee\u524d\u7684I/O\u591a\u8def\u590d\u7528\u90fd\u662f\u91c7\u7528\u7684epoll\u6a21\u5f0f\u5b9e\u73b0\uff0c\u5b83\u4f1a\u5728\u901a\u77e5\u7528\u6237\u8fdb\u7a0bSocket\u5c31\u7eea\u7684\u540c\u65f6\uff0c\u628a\u5df2\u5c31\u7eea\u7684Socket\u5199\u5165\u7528\u6237\u7a7a\u95f4\uff0c\u4e0d\u9700\u8981\u6328\u4e2a\u904d\u5386Socket\u6765\u5224\u65ad\u662f\u5426\u5c31\u7eea\uff0c\u63d0\u5347\u4e86\u6027\u80fd\u3002 \u5176\u4e2dRedis\u7684\u7f51\u7edc\u6a21\u578b\u5c31\u662f\u4f7f\u7528I/O\u591a\u8def\u590d\u7528\u7ed3\u5408\u4e8b\u4ef6\u7684\u5904\u7406\u5668\u6765\u5e94\u5bf9\u591a\u4e2aSocket\u8bf7\u6c42\uff0c\u6bd4\u5982\uff0c\u63d0\u4f9b\u4e86\u8fde\u63a5\u5e94\u7b54\u5904\u7406\u5668\u3001\u547d\u4ee4\u56de\u590d\u5904\u7406\u5668\uff0c\u547d\u4ee4\u8bf7\u6c42\u5904\u7406\u5668\uff1b \u5728Redis6.0\u4e4b\u540e\uff0c\u4e3a\u4e86\u63d0\u5347\u66f4\u597d\u7684\u6027\u80fd\uff0c\u5728\u547d\u4ee4\u56de\u590d\u5904\u7406\u5668\u4f7f\u7528\u4e86\u591a\u7ebf\u7a0b\u6765\u5904\u7406\u56de\u590d\u4e8b\u4ef6\uff0c\u5728\u547d\u4ee4\u8bf7\u6c42\u5904\u7406\u5668\u4e2d\uff0c\u5c06\u547d\u4ee4\u7684\u8f6c\u6362\u4f7f\u7528\u4e86\u591a\u7ebf\u7a0b\uff0c\u589e\u52a0\u547d\u4ee4\u8f6c\u6362\u901f\u5ea6\uff0c\u5728\u547d\u4ee4\u6267\u884c\u7684\u65f6\u5019\uff0c\u4f9d\u7136\u662f\u5355\u7ebf\u7a0b","title":"Redis\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/02-Redis%E7%AF%87/Redis%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#redis","text":"\u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u7a7f\u900f ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u6211\u60f3\u4e00\u4e0b \u7f13\u5b58\u7a7f\u900f\u662f\u6307\u67e5\u8be2\u4e00\u4e2a\u4e00\u5b9a \u4e0d\u5b58\u5728 \u7684\u6570\u636e\uff0c\u5982\u679c\u4ece\u5b58\u50a8\u5c42\u67e5\u4e0d\u5230\u6570\u636e\u5219\u4e0d\u5199\u5165\u7f13\u5b58\uff0c\u8fd9\u5c06\u5bfc\u81f4\u8fd9\u4e2a\u4e0d\u5b58\u5728\u7684\u6570\u636e\u6bcf\u6b21\u8bf7\u6c42\u90fd\u8981\u5230 DB \u53bb\u67e5\u8be2\uff0c\u53ef\u80fd\u5bfc\u81f4 DB \u6302\u6389\u3002\u8fd9\u79cd\u60c5\u51b5\u5927\u6982\u7387\u662f\u906d\u5230\u4e86\u653b\u51fb\u3002 \u89e3\u51b3\u65b9\u6848\u7684\u8bdd\uff0c\u6211\u4eec\u901a\u5e38\u90fd\u4f1a\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\u6765\u89e3\u51b3\u5b83 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u4ecb\u7ecd\u4e00\u4e0b\u5e03\u9686\u8fc7\u6ee4\u5668\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837~ \u5e03\u9686\u8fc7\u6ee4\u5668\u4e3b\u8981\u662f\u7528\u4e8e\u68c0\u7d22\u4e00\u4e2a\u5143\u7d20\u662f\u5426\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002\u6211\u4eec\u5f53\u65f6\u4f7f\u7528\u7684\u662fredisson\u5b9e\u73b0\u7684\u5e03\u9686\u8fc7\u6ee4\u5668\u3002 \u5b83\u7684\u5e95\u5c42\u4e3b\u8981\u662f\u5148\u53bb\u521d\u59cb\u5316\u4e00\u4e2a\u6bd4\u8f83\u5927\u6570\u7ec4\uff0c\u91cc\u9762\u5b58\u653e\u7684\u4e8c\u8fdb\u52360\u62161\u3002\u5728\u4e00\u5f00\u59cb\u90fd\u662f0\uff0c\u5f53\u4e00\u4e2akey\u6765\u4e86\u4e4b\u540e\u7ecf\u8fc73\u6b21hash\u8ba1\u7b97\uff0c\u6a21\u4e8e\u6570\u7ec4\u957f\u5ea6\u627e\u5230\u6570\u636e\u7684\u4e0b\u6807\u7136\u540e\u628a\u6570\u7ec4\u4e2d\u539f\u6765\u76840\u6539\u4e3a1\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u4e09\u4e2a\u6570\u7ec4\u7684\u4f4d\u7f6e\u5c31\u80fd\u6807\u660e\u4e00\u4e2akey\u7684\u5b58\u5728\u3002\u67e5\u627e\u7684\u8fc7\u7a0b\u4e5f\u662f\u4e00\u6837\u7684\u3002 \u5f53\u7136\u662f\u6709\u7f3a\u70b9\u7684\uff0c\u5e03\u9686\u8fc7\u6ee4\u5668\u6709\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e00\u5b9a\u7684\u8bef\u5224\uff0c\u6211\u4eec\u4e00\u822c\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u8bef\u5224\u7387\uff0c\u5927\u6982\u4e0d\u4f1a\u8d85\u8fc75%\uff0c\u5176\u5b9e\u8fd9\u4e2a\u8bef\u5224\u662f\u5fc5\u7136\u5b58\u5728\u7684\uff0c\u8981\u4e0d\u5c31\u5f97\u589e\u52a0\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5176\u5b9e\u5df2\u7ecf\u7b97\u662f\u5f88\u5212\u5206\u4e86\uff0c5%\u4ee5\u5185\u7684\u8bef\u5224\u7387\u4e00\u822c\u7684\u9879\u76ee\u4e5f\u80fd\u63a5\u53d7\uff0c\u4e0d\u81f3\u4e8e\u9ad8\u5e76\u53d1\u4e0b\u538b\u5012\u6570\u636e\u5e93\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u51fb\u7a7f ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u7f13\u5b58\u51fb\u7a7f\u7684\u610f\u601d\u662f\u5bf9\u4e8e\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684key\uff0c\u7f13\u5b58\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u8fc7\u671f\u7684\u65f6\u5019\uff0c\u6070\u597d\u8fd9\u65f6\u95f4\u70b9\u5bf9\u8fd9\u4e2aKey\u6709\u5927\u91cf\u7684\u5e76\u53d1\u8bf7\u6c42\u8fc7\u6765\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u53d1\u73b0\u7f13\u5b58\u8fc7\u671f\u4e00\u822c\u90fd\u4f1a\u4ece\u540e\u7aef DB \u52a0\u8f7d\u6570\u636e\u5e76\u56de\u8bbe\u5230\u7f13\u5b58\uff0c\u8fd9\u4e2a\u65f6\u5019\u5927\u5e76\u53d1\u7684\u8bf7\u6c42\u53ef\u80fd\u4f1a\u77ac\u95f4\u628a DB \u538b\u57ae\u3002 \u89e3\u51b3\u65b9\u6848\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a \u7b2c\u4e00\u53ef\u4ee5\u4f7f\u7528\u4e92\u65a5\u9501\uff1a\u5f53\u7f13\u5b58\u5931\u6548\u65f6\uff0c\u4e0d\u7acb\u5373\u53bbload db\uff0c\u5148\u4f7f\u7528\u5982 Redis \u7684 setnx \u53bb\u8bbe\u7f6e\u4e00\u4e2a\u4e92\u65a5\u9501\uff0c\u5f53\u64cd\u4f5c\u6210\u529f\u8fd4\u56de\u65f6\u518d\u8fdb\u884c load db\u7684\u64cd\u4f5c\u5e76\u56de\u8bbe\u7f13\u5b58\uff0c\u5426\u5219\u91cd\u8bd5get\u7f13\u5b58\u7684\u65b9\u6cd5 \u7b2c\u4e8c\u79cd\u65b9\u6848\u53ef\u4ee5\u8bbe\u7f6e\u5f53\u524dkey\u903b\u8f91\u8fc7\u671f\uff0c\u5927\u6982\u662f\u601d\u8def\u5982\u4e0b\uff1a \u2460\uff1a\u5728\u8bbe\u7f6ekey\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u8fc7\u671f\u65f6\u95f4\u5b57\u6bb5\u4e00\u5757\u5b58\u5165\u7f13\u5b58\u4e2d\uff0c\u4e0d\u7ed9\u5f53\u524dkey\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4 \u2461\uff1a\u5f53\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4eceredis\u53d6\u51fa\u6570\u636e\u540e\u5224\u65ad\u65f6\u95f4\u662f\u5426\u8fc7\u671f \u2462\uff1a\u5982\u679c\u8fc7\u671f\u5219\u5f00\u901a\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u6570\u636e\u540c\u6b65\uff0c\u5f53\u524d\u7ebf\u7a0b\u6b63\u5e38\u8fd4\u56de\u6570\u636e\uff0c\u8fd9\u4e2a\u6570\u636e\u4e0d\u662f\u6700\u65b0 \u5f53\u7136\u4e24\u79cd\u65b9\u6848\u5404\u6709\u5229\u5f0a\uff1a \u5982\u679c\u9009\u62e9\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u5efa\u8bae\u4f7f\u7528\u5206\u5e03\u5f0f\u9501\u7684\u65b9\u6848\uff0c\u6027\u80fd\u4e0a\u53ef\u80fd\u6ca1\u90a3\u4e48\u9ad8\uff0c\u9501\u9700\u8981\u7b49\uff0c\u4e5f\u6709\u53ef\u80fd\u4ea7\u751f\u6b7b\u9501\u7684\u95ee\u9898 \u5982\u679c\u9009\u62e9key\u7684\u903b\u8f91\u5220\u9664\uff0c\u5219\u4f18\u5148\u8003\u8651\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6027\u80fd\u6bd4\u8f83\u9ad8\uff0c\u4f46\u662f\u6570\u636e\u540c\u6b65\u8fd9\u5757\u505a\u4e0d\u5230\u5f3a\u4e00\u81f4\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7f13\u5b58\u96ea\u5d29 ? \u600e\u4e48\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u7f13\u5b58\u96ea\u5d29\u610f\u601d\u662f\u8bbe\u7f6e\u7f13\u5b58\u65f6\u91c7\u7528\u4e86\u76f8\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u5bfc\u81f4\u7f13\u5b58\u5728\u67d0\u4e00\u65f6\u523b\u540c\u65f6\u5931\u6548\uff0c\u8bf7\u6c42\u5168\u90e8\u8f6c\u53d1\u5230DB\uff0cDB \u77ac\u65f6\u538b\u529b\u8fc7\u91cd\u96ea\u5d29\u3002\u4e0e\u7f13\u5b58\u51fb\u7a7f\u7684\u533a\u522b\uff1a\u96ea\u5d29\u662f\u5f88\u591akey\uff0c\u51fb\u7a7f\u662f\u67d0\u4e00\u4e2akey\u7f13\u5b58\u3002 \u89e3\u51b3\u65b9\u6848\u4e3b\u8981\u662f\u53ef\u4ee5\u5c06\u7f13\u5b58\u5931\u6548\u65f6\u95f4\u5206\u6563\u5f00\uff0c\u6bd4\u5982\u53ef\u4ee5\u5728\u539f\u6709\u7684\u5931\u6548\u65f6\u95f4\u57fa\u7840\u4e0a\u589e\u52a0\u4e00\u4e2a\u968f\u673a\u503c\uff0c\u6bd4\u59821-5\u5206\u949f\u968f\u673a\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u7f13\u5b58\u7684\u8fc7\u671f\u65f6\u95f4\u7684\u91cd\u590d\u7387\u5c31\u4f1a\u964d\u4f4e\uff0c\u5c31\u5f88\u96be\u5f15\u53d1\u96c6\u4f53\u5931\u6548\u7684\u4e8b\u4ef6\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0cmysql\u7684\u6570\u636e\u5982\u4f55\u4e0eredis\u8fdb\u884c\u540c\u6b65\u5462\uff1f\uff08\u53cc\u5199\u4e00\u81f4\u6027\uff09 \u5019\u9009\u4eba \uff1a\u55ef\uff01\u5c31\u8bf4\u6211\u6700\u8fd1\u505a\u7684\u8fd9\u4e2a\u9879\u76ee\uff0c\u91cc\u9762\u6709xxxx\uff08 \u6839\u636e\u81ea\u5df1\u7684\u7b80\u5386\u4e0a\u5199 \uff09\u7684\u529f\u80fd\uff0c\u9700\u8981\u8ba9\u6570\u636e\u5e93\u4e0eredis\u9ad8\u5ea6\u4fdd\u6301\u4e00\u81f4\uff0c\u56e0\u4e3a\u8981\u6c42\u65f6\u6548\u6027\u6bd4\u8f83\u9ad8\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u8bfb\u5199\u9501\u4fdd\u8bc1\u7684\u5f3a\u4e00\u81f4\u6027\u3002 \u6211\u4eec\u91c7\u7528\u7684\u662fredisson\u5b9e\u73b0\u7684\u8bfb\u5199\u9501\uff0c\u5728\u8bfb\u7684\u65f6\u5019\u6dfb\u52a0\u5171\u4eab\u9501\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u8bfb\u8bfb\u4e0d\u4e92\u65a5\uff0c\u8bfb\u5199\u4e92\u65a5\u3002\u5f53\u6211\u4eec\u66f4\u65b0\u6570\u636e\u7684\u65f6\u5019\uff0c\u6dfb\u52a0\u6392\u4ed6\u9501\uff0c\u5b83\u662f\u8bfb\u5199\uff0c\u8bfb\u8bfb\u90fd\u4e92\u65a5\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u5728\u5199\u6570\u636e\u7684\u540c\u65f6\u662f\u4e0d\u4f1a\u8ba9\u5176\u4ed6\u7ebf\u7a0b\u8bfb\u6570\u636e\u7684\uff0c\u907f\u514d\u4e86\u810f\u6570\u636e\u3002\u8fd9\u91cc\u9762\u9700\u8981\u6ce8\u610f\u7684\u662f\u8bfb\u65b9\u6cd5\u548c\u5199\u65b9\u6cd5\u4e0a\u9700\u8981\u4f7f\u7528\u540c\u4e00\u628a\u9501\u624d\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u8fd9\u4e2a\u6392\u4ed6\u9501\u662f\u5982\u4f55\u4fdd\u8bc1\u8bfb\u5199\u3001\u8bfb\u8bfb\u4e92\u65a5\u7684\u5462\uff1f \u5019\u9009\u4eba \uff1a\u5176\u5b9e\u6392\u4ed6\u9501\u5e95\u5c42\u4f7f\u7528\u4e5f\u662fsetnx\uff0c\u4fdd\u8bc1\u4e86\u540c\u65f6\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u64cd\u4f5c\u9501\u4f4f\u7684\u65b9\u6cd5 \u9762\u8bd5\u5b98 \uff1a\u4f60\u542c\u8bf4\u8fc7\u5ef6\u65f6\u53cc\u5220\u5417\uff1f\u4e3a\u4ec0\u4e48\u4e0d\u7528\u5b83\u5462\uff1f \u5019\u9009\u4eba \uff1a\u5ef6\u8fdf\u53cc\u5220\uff0c\u5982\u679c\u662f\u5199\u64cd\u4f5c\uff0c\u6211\u4eec\u5148\u628a\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u5220\u9664\uff0c\u7136\u540e\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u6700\u540e\u518d\u5ef6\u65f6\u5220\u9664\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u5176\u4e2d\u8fd9\u4e2a\u5ef6\u65f6\u591a\u4e45\u4e0d\u592a\u597d\u786e\u5b9a\uff0c\u5728\u5ef6\u65f6\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0\u810f\u6570\u636e\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\uff0c\u6240\u4ee5\u6ca1\u6709\u91c7\u7528\u5b83\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0cmysql\u7684\u6570\u636e\u5982\u4f55\u4e0eredis\u8fdb\u884c\u540c\u6b65\u5462\uff1f\uff08\u53cc\u5199\u4e00\u81f4\u6027\uff09 \u5019\u9009\u4eba \uff1a\u55ef\uff01\u5c31\u8bf4\u6211\u6700\u8fd1\u505a\u7684\u8fd9\u4e2a\u9879\u76ee\uff0c\u91cc\u9762\u6709xxxx\uff08 \u6839\u636e\u81ea\u5df1\u7684\u7b80\u5386\u4e0a\u5199 \uff09\u7684\u529f\u80fd\uff0c\u6570\u636e\u540c\u6b65\u53ef\u4ee5\u6709\u4e00\u5b9a\u7684\u5ef6\u65f6\uff08\u7b26\u5408\u5927\u90e8\u5206\u4e1a\u52a1\uff09 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u963f\u91cc\u7684canal\u7ec4\u4ef6\u5b9e\u73b0\u6570\u636e\u540c\u6b65\uff1a\u4e0d\u9700\u8981\u66f4\u6539\u4e1a\u52a1\u4ee3\u7801\uff0c\u90e8\u7f72\u4e00\u4e2acanal\u670d\u52a1\u3002canal\u670d\u52a1\u628a\u81ea\u5df1\u4f2a\u88c5\u6210mysql\u7684\u4e00\u4e2a\u4ece\u8282\u70b9\uff0c\u5f53mysql\u6570\u636e\u66f4\u65b0\u4ee5\u540e\uff0ccanal\u4f1a\u8bfb\u53d6binlog\u6570\u636e\uff0c\u7136\u540e\u5728\u901a\u8fc7canal\u7684\u5ba2\u6237\u7aef\u83b7\u53d6\u5230\u6570\u636e\uff0c\u66f4\u65b0\u7f13\u5b58\u5373\u53ef\u3002 \u9762\u8bd5\u5b98 \uff1aredis\u505a\u4e3a\u7f13\u5b58\uff0c\u6570\u636e\u7684\u6301\u4e45\u5316\u662f\u600e\u4e48\u505a\u7684\uff1f \u5019\u9009\u4eba \uff1a\u5728Redis\u4e2d\u63d0\u4f9b\u4e86\u4e24\u79cd\u6570\u636e\u6301\u4e45\u5316\u7684\u65b9\u5f0f\uff1a1\u3001RDB 2\u3001AOF \u9762\u8bd5\u5b98 \uff1a\u8fd9\u4e24\u79cd\u6301\u4e45\u5316\u65b9\u5f0f\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f \u5019\u9009\u4eba \uff1aRDB\u662f\u4e00\u4e2a\u5feb\u7167\u6587\u4ef6\uff0c\u5b83\u662f\u628aredis\u5185\u5b58\u5b58\u50a8\u7684\u6570\u636e\u5199\u5230\u78c1\u76d8\u4e0a\uff0c\u5f53redis\u5b9e\u4f8b\u5b95\u673a\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u65b9\u4fbf\u4eceRDB\u7684\u5feb\u7167\u6587\u4ef6\u4e2d\u6062\u590d\u6570\u636e\u3002 AOF\u7684\u542b\u4e49\u662f\u8ffd\u52a0\u6587\u4ef6\uff0c\u5f53redis\u64cd\u4f5c\u5199\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5f53redis\u5b9e\u4f8b\u5b95\u673a\u6062\u590d\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u518d\u6b21\u6267\u884c\u4e00\u904d\u547d\u4ee4\u6765\u6062\u590d\u6570\u636e \u9762\u8bd5\u5b98 \uff1a\u8fd9\u4e24\u79cd\u65b9\u5f0f\uff0c\u54ea\u79cd\u6062\u590d\u7684\u6bd4\u8f83\u5feb\u5462\uff1f \u5019\u9009\u4eba \uff1aRDB\u56e0\u4e3a\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5728\u4fdd\u5b58\u7684\u65f6\u5019\u4f53\u79ef\u4e5f\u662f\u6bd4\u8f83\u5c0f\u7684\uff0c\u5b83\u6062\u590d\u7684\u6bd4\u8f83\u5feb\uff0c\u4f46\u662f\u5b83\u6709\u53ef\u80fd\u4f1a\u4e22\u6570\u636e\uff0c\u6211\u4eec\u901a\u5e38\u5728\u9879\u76ee\u4e2d\u4e5f\u4f1a\u4f7f\u7528AOF\u6765\u6062\u590d\u6570\u636e\uff0c\u867d\u7136AOF\u6062\u590d\u7684\u901f\u5ea6\u6162\u4e00\u4e9b\uff0c\u4f46\u662f\u5b83\u4e22\u6570\u636e\u7684\u98ce\u9669\u8981\u5c0f\u5f88\u591a\uff0c\u5728AOF\u6587\u4ef6\u4e2d\u53ef\u4ee5\u8bbe\u7f6e\u5237\u76d8\u7b56\u7565\uff0c\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u7684\u5c31\u662f\u6bcf\u79d2\u6279\u91cf\u5199\u5165\u4e00\u6b21\u547d\u4ee4 \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u6570\u636e\u8fc7\u671f\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u4e24\u79cd\u6570\u636e\u8fc7\u671f\u5220\u9664\u7b56\u7565 \u7b2c\u4e00\u79cd\u662f\u60f0\u6027\u5220\u9664\uff0c\u5728\u8bbe\u7f6e\u8be5key\u8fc7\u671f\u65f6\u95f4\u540e\uff0c\u6211\u4eec\u4e0d\u53bb\u7ba1\u5b83\uff0c\u5f53\u9700\u8981\u8be5key\u65f6\uff0c\u6211\u4eec\u5728\u68c0\u67e5\u5176\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\uff0c\u6211\u4eec\u5c31\u5220\u6389\u5b83\uff0c\u53cd\u4e4b\u8fd4\u56de\u8be5key\u3002 \u7b2c\u4e8c\u79cd\u662f \u5b9a\u671f\u5220\u9664\uff0c\u5c31\u662f\u8bf4\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u6211\u4eec\u5c31\u5bf9\u4e00\u4e9bkey\u8fdb\u884c\u68c0\u67e5\uff0c\u5220\u9664\u91cc\u9762\u8fc7\u671f\u7684key \u5b9a\u671f\u6e05\u7406\u7684\u4e24\u79cd\u6a21\u5f0f\uff1a SLOW\u6a21\u5f0f\u662f\u5b9a\u65f6\u4efb\u52a1\uff0c\u6267\u884c\u9891\u7387\u9ed8\u8ba4\u4e3a10hz\uff0c\u6bcf\u6b21\u4e0d\u8d85\u8fc725ms\uff0c\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6587\u4ef6redis.conf \u7684 hz \u9009\u9879\u6765\u8c03\u6574\u8fd9\u4e2a\u6b21\u6570 FAST\u6a21\u5f0f\u6267\u884c\u9891\u7387\u4e0d\u56fa\u5b9a\uff0c\u6bcf\u6b21\u4e8b\u4ef6\u5faa\u73af\u4f1a\u5c1d\u8bd5\u6267\u884c\uff0c\u4f46\u4e24\u6b21\u95f4\u9694\u4e0d\u4f4e\u4e8e2ms\uff0c\u6bcf\u6b21\u8017\u65f6\u4e0d\u8d85\u8fc71ms Redis\u7684\u8fc7\u671f\u5220\u9664\u7b56\u7565\uff1a \u60f0\u6027\u5220\u9664 + \u5b9a\u671f\u5220\u9664 \u4e24\u79cd\u7b56\u7565\u8fdb\u884c\u914d\u5408\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u6570\u636e\u6dd8\u6c70\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u79cd\uff0c\u9ed8\u8ba4\u662fnoeviction\uff0c\u4e0d\u5220\u9664\u4efb\u4f55\u6570\u636e\uff0c\u5185\u90e8\u4e0d\u8db3\u76f4\u63a5\u62a5\u9519 \u662f\u53ef\u4ee5\u5728redis\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u7684\uff0c\u91cc\u9762\u6709\u4e24\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u4e00\u4e2a\u662fLRU\uff0c\u53e6\u5916\u4e00\u4e2a\u662fLFU LRU\u7684\u610f\u601d\u5c31\u662f\u6700\u5c11\u6700\u8fd1\u4f7f\u7528\uff0c\u7528\u5f53\u524d\u65f6\u95f4\u51cf\u53bb\u6700\u540e\u4e00\u6b21\u8bbf\u95ee\u65f6\u95f4\uff0c\u8fd9\u4e2a\u503c\u8d8a\u5927\u5219\u6dd8\u6c70\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002 LFU\u7684\u610f\u601d\u662f\u6700\u5c11\u9891\u7387\u4f7f\u7528\u3002\u4f1a\u7edf\u8ba1\u6bcf\u4e2akey\u7684\u8bbf\u95ee\u9891\u7387\uff0c\u503c\u8d8a\u5c0f\u6dd8\u6c70\u4f18\u5148\u7ea7\u8d8a\u9ad8 \u6211\u4eec\u5728\u9879\u76ee\u8bbe\u7f6e\u7684allkeys-lru\uff0c\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff0c\u628a\u4e00\u4e9b\u7ecf\u5e38\u8bbf\u95ee\u7684key\u7559\u5728redis\u4e2d \u9762\u8bd5\u5b98 \uff1a\u6570\u636e\u5e93\u67091000\u4e07\u6570\u636e ,Redis\u53ea\u80fd\u7f13\u5b5820w\u6570\u636e, \u5982\u4f55\u4fdd\u8bc1Redis\u4e2d\u7684\u6570\u636e\u90fd\u662f\u70ed\u70b9\u6570\u636e ? \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u4e00\u4e0b~~ \u53ef\u4ee5\u4f7f\u7528 allkeys-lru \uff08\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70\uff09\u6dd8\u6c70\u7b56\u7565\uff0c\u90a3\u7559\u4e0b\u6765\u7684\u90fd\u662f\u7ecf\u5e38\u8bbf\u95ee\u7684\u70ed\u70b9\u6570\u636e \u9762\u8bd5\u5b98 \uff1aRedis\u7684\u5185\u5b58\u7528\u5b8c\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u8fd9\u4e2a\u8981\u770bredis\u7684\u6570\u636e\u6dd8\u6c70\u7b56\u7565\u662f\u4ec0\u4e48\uff0c\u5982\u679c\u662f\u9ed8\u8ba4\u7684\u914d\u7f6e\uff0credis\u5185\u5b58\u7528\u5b8c\u4ee5\u540e\u5219\u76f4\u63a5\u62a5\u9519\u3002\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u7684 allkeys-lru \u7b56\u7565\u3002\u628a\u6700\u8fd1\u6700\u5e38\u8bbf\u95ee\u7684\u6570\u636e\u7559\u5728\u7f13\u5b58\u4e2d\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u5206\u5e03\u5f0f\u9501\u5982\u4f55\u5b9e\u73b0 ? \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u5728redis\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u547d\u4ee4setnx(SET if not exists) \u7531\u4e8eredis\u7684\u5355\u7ebf\u7a0b\u7684\uff0c\u7528\u4e86\u547d\u4ee4\u4e4b\u540e\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u5bf9\u67d0\u4e00\u4e2akey\u8bbe\u7f6e\u503c\uff0c\u5728\u6ca1\u6709\u8fc7\u671f\u6216\u5220\u9664key\u7684\u65f6\u5019\u662f\u5176\u4ed6\u5ba2\u6237\u7aef\u662f\u4e0d\u80fd\u8bbe\u7f6e\u8fd9\u4e2akey\u7684 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u4f60\u5982\u4f55\u63a7\u5236Redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u6709\u6548\u65f6\u957f\u5462\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u7684\u786e\uff0credis\u7684setnx\u6307\u4ee4\u4e0d\u597d\u63a7\u5236\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684redis\u7684\u4e00\u4e2a\u6846\u67b6redisson\u5b9e\u73b0\u7684\u3002 \u5728redisson\u4e2d\u9700\u8981\u624b\u52a8\u52a0\u9501\uff0c\u5e76\u4e14\u53ef\u4ee5\u63a7\u5236\u9501\u7684\u5931\u6548\u65f6\u95f4\u548c\u7b49\u5f85\u65f6\u95f4\uff0c\u5f53\u9501\u4f4f\u7684\u4e00\u4e2a\u4e1a\u52a1\u8fd8\u6ca1\u6709\u6267\u884c\u5b8c\u6210\u7684\u65f6\u5019\uff0c\u5728redisson\u4e2d\u5f15\u5165\u4e86\u4e00\u4e2a\u770b\u95e8\u72d7\u673a\u5236\uff0c\u5c31\u662f\u8bf4\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u68c0\u67e5\u5f53\u524d\u4e1a\u52a1\u662f\u5426\u8fd8\u6301\u6709\u9501\uff0c\u5982\u679c\u6301\u6709\u5c31\u589e\u52a0\u52a0\u9501\u7684\u6301\u6709\u65f6\u95f4\uff0c\u5f53\u4e1a\u52a1\u6267\u884c\u5b8c\u6210\u4e4b\u540e\u9700\u8981\u4f7f\u7528\u91ca\u653e\u9501\u5c31\u53ef\u4ee5\u4e86 \u8fd8\u6709\u4e00\u4e2a\u597d\u5904\u5c31\u662f\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u4e00\u4e2a\u4e1a\u52a1\u6709\u53ef\u80fd\u4f1a\u6267\u884c\u5f88\u5feb\uff0c\u5148\u5ba2\u62371\u6301\u6709\u9501\u7684\u65f6\u5019\uff0c\u5ba2\u62372\u6765\u4e86\u4ee5\u540e\u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u62d2\u7edd\uff0c\u5b83\u4f1a\u81ea\u65cb\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u9501\uff0c\u5982\u679c\u5ba2\u62371\u91ca\u653e\u4e4b\u540e\uff0c\u5ba2\u62372\u5c31\u53ef\u4ee5\u9a6c\u4e0a\u6301\u6709\u9501\uff0c\u6027\u80fd\u4e5f\u5f97\u5230\u4e86\u63d0\u5347\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0credisson\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\u662f\u53ef\u91cd\u5165\u7684\u5417\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u53ef\u4ee5\u91cd\u5165\u7684\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u907f\u514d\u6b7b\u9501\u7684\u4ea7\u751f\u3002\u8fd9\u4e2a\u91cd\u5165\u5176\u5b9e\u5728\u5185\u90e8\u5c31\u662f\u5224\u65ad\u662f\u5426\u662f\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\u7684\u9501\uff0c\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\u7684\u9501\u5c31\u4f1a\u8ba1\u6570\uff0c\u5982\u679c\u91ca\u653e\u9501\u5c31\u4f1a\u5728\u8ba1\u7b97\u4e0a\u51cf\u4e00\u3002\u5728\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u91c7\u7528\u7684hash\u7ed3\u6784\uff0c\u5927key\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u4e1a\u52a1\u8fdb\u884c\u5b9a\u5236\uff0c\u5176\u4e2d\u5c0fkey\u662f\u5f53\u524d\u7ebf\u7a0b\u7684\u552f\u4e00\u6807\u8bc6\uff0cvalue\u662f\u5f53\u524d\u7ebf\u7a0b\u91cd\u5165\u7684\u6b21\u6570 \u9762\u8bd5\u5b98 \uff1aredisson\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\u80fd\u89e3\u51b3\u4e3b\u4ece\u4e00\u81f4\u6027\u7684\u95ee\u9898\u5417 \u5019\u9009\u4eba \uff1a\u8fd9\u4e2a\u662f\u4e0d\u80fd\u7684\uff0c\u6bd4\u5982\uff0c\u5f53\u7ebf\u7a0b1\u52a0\u9501\u6210\u529f\u540e\uff0cmaster\u8282\u70b9\u6570\u636e\u4f1a\u5f02\u6b65\u590d\u5236\u5230slave\u8282\u70b9\uff0c\u6b64\u65f6\u5f53\u524d\u6301\u6709Redis\u9501\u7684master\u8282\u70b9\u5b95\u673a\uff0cslave\u8282\u70b9\u88ab\u63d0\u5347\u4e3a\u65b0\u7684master\u8282\u70b9\uff0c\u5047\u5982\u73b0\u5728\u6765\u4e86\u4e00\u4e2a\u7ebf\u7a0b2\uff0c\u518d\u6b21\u52a0\u9501\uff0c\u4f1a\u5728\u65b0\u7684master\u8282\u70b9\u4e0a\u52a0\u9501\u6210\u529f\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u4e24\u4e2a\u8282\u70b9\u540c\u65f6\u6301\u6709\u4e00\u628a\u9501\u7684\u95ee\u9898\u3002 \u6211\u4eec\u53ef\u4ee5\u5229\u7528redisson\u63d0\u4f9b\u7684\u7ea2\u9501\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5b83\u7684\u4e3b\u8981\u4f5c\u7528\u662f\uff0c\u4e0d\u80fd\u53ea\u5728\u4e00\u4e2aredis\u5b9e\u4f8b\u4e0a\u521b\u5efa\u9501\uff0c\u5e94\u8be5\u662f\u5728\u591a\u4e2aredis\u5b9e\u4f8b\u4e0a\u521b\u5efa\u9501\uff0c\u5e76\u4e14\u8981\u6c42\u5728\u5927\u591a\u6570redis\u8282\u70b9\u4e0a\u90fd\u6210\u529f\u521b\u5efa\u9501\uff0c\u7ea2\u9501\u4e2d\u8981\u6c42\u662fredis\u7684\u8282\u70b9\u6570\u91cf\u8981\u8fc7\u534a\u3002\u8fd9\u6837\u5c31\u80fd\u907f\u514d\u7ebf\u7a0b1\u52a0\u9501\u6210\u529f\u540emaster\u8282\u70b9\u5b95\u673a\u5bfc\u81f4\u7ebf\u7a0b2\u6210\u529f\u52a0\u9501\u5230\u65b0\u7684master\u8282\u70b9\u4e0a\u7684\u95ee\u9898\u4e86\u3002 \u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u7ea2\u9501\uff0c\u56e0\u4e3a\u9700\u8981\u540c\u65f6\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u90fd\u6dfb\u52a0\u9501\uff0c\u6027\u80fd\u5c31\u53d8\u7684\u5f88\u4f4e\u4e86\uff0c\u5e76\u4e14\u8fd0\u7ef4\u7ef4\u62a4\u6210\u672c\u4e5f\u975e\u5e38\u9ad8\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u5728\u9879\u76ee\u4e2d\u4e5f\u4e0d\u4f1a\u76f4\u63a5\u4f7f\u7528\u7ea2\u9501\uff0c\u5e76\u4e14\u5b98\u65b9\u4e5f\u6682\u65f6\u5e9f\u5f03\u4e86\u8fd9\u4e2a\u7ea2\u9501 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u5982\u679c\u4e1a\u52a1\u975e\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\uff0c\u8fd9\u4e2a\u8be5\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba\uff1a \u55ef~\uff0credis\u672c\u8eab\u5c31\u662f\u652f\u6301\u9ad8\u53ef\u7528\u7684\uff0c\u505a\u5230\u5f3a\u4e00\u81f4\u6027\uff0c\u5c31\u975e\u5e38\u5f71\u54cd\u6027\u80fd\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u6709\u5f3a\u4e00\u81f4\u6027\u8981\u6c42\u9ad8\u7684\u4e1a\u52a1\uff0c\u5efa\u8bae\u4f7f\u7528zookeeper\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u9501\uff0c\u5b83\u662f\u53ef\u4ee5\u4fdd\u8bc1\u5f3a\u4e00\u81f4\u6027\u7684\u3002 \u9762\u8bd5\u5b98 \uff1aRedis\u96c6\u7fa4\u6709\u54ea\u4e9b\u65b9\u6848, \u77e5\u9053\u561b ? \u5019\u9009\u4eba \uff1a\u55ef~~\uff0c\u5728Redis\u4e2d\u63d0\u4f9b\u7684\u96c6\u7fa4\u65b9\u6848\u603b\u5171\u6709\u4e09\u79cd\uff1a\u4e3b\u4ece\u590d\u5236\u3001\u54e8\u5175\u6a21\u5f0f\u3001Redis\u5206\u7247\u96c6\u7fa4 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u6765\u4ecb\u7ecd\u4e00\u4e0b\u4e3b\u4ece\u540c\u6b65 \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u5355\u8282\u70b9Redis\u7684\u5e76\u53d1\u80fd\u529b\u662f\u6709\u4e0a\u9650\u7684\uff0c\u8981\u8fdb\u4e00\u6b65\u63d0\u9ad8Redis\u7684\u5e76\u53d1\u80fd\u529b\uff0c\u53ef\u4ee5\u642d\u5efa\u4e3b\u4ece\u96c6\u7fa4\uff0c\u5b9e\u73b0\u8bfb\u5199\u5206\u79bb\u3002\u4e00\u822c\u90fd\u662f\u4e00\u4e3b\u591a\u4ece\uff0c\u4e3b\u8282\u70b9\u8d1f\u8d23\u5199\u6570\u636e\uff0c\u4ece\u8282\u70b9\u8d1f\u8d23\u8bfb\u6570\u636e\uff0c\u4e3b\u8282\u70b9\u5199\u5165\u6570\u636e\u4e4b\u540e\uff0c\u9700\u8981\u628a\u6570\u636e\u540c\u6b65\u5230\u4ece\u8282\u70b9\u4e2d \u9762\u8bd5\u5b98 \uff1a\u80fd\u8bf4\u4e00\u4e0b\uff0c\u4e3b\u4ece\u540c\u6b65\u6570\u636e\u7684\u6d41\u7a0b \u5019\u9009\u4eba \uff1a\u55ef~~\uff0c\u597d\uff01\u4e3b\u4ece\u540c\u6b65\u5206\u4e3a\u4e86\u4e24\u4e2a\u9636\u6bb5\uff0c\u4e00\u4e2a\u662f\u5168\u91cf\u540c\u6b65\uff0c\u4e00\u4e2a\u662f\u589e\u91cf\u540c\u6b65 \u5168\u91cf\u540c\u6b65\u662f\u6307\u4ece\u8282\u70b9\u7b2c\u4e00\u6b21\u4e0e\u4e3b\u8282\u70b9\u5efa\u7acb\u8fde\u63a5\u7684\u65f6\u5019\u4f7f\u7528\u5168\u91cf\u540c\u6b65\uff0c\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a \u7b2c\u4e00\uff1a\u4ece\u8282\u70b9\u8bf7\u6c42\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\uff0c\u5176\u4e2d\u4ece\u8282\u70b9\u4f1a\u643a\u5e26\u81ea\u5df1\u7684replication id\u548coffset\u504f\u79fb\u91cf\u3002 \u7b2c\u4e8c\uff1a\u4e3b\u8282\u70b9\u5224\u65ad\u662f\u5426\u662f\u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e3b\u8981\u5224\u65ad\u7684\u4f9d\u636e\u5c31\u662f\uff0c\u4e3b\u8282\u70b9\u4e0e\u4ece\u8282\u70b9\u662f\u5426\u662f\u540c\u4e00\u4e2areplication id\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5c31\u8bf4\u660e\u662f\u7b2c\u4e00\u6b21\u540c\u6b65\uff0c\u90a3\u4e3b\u8282\u70b9\u5c31\u4f1a\u628a\u81ea\u5df1\u7684replication id\u548coffset\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\uff0c\u8ba9\u4ece\u8282\u70b9\u4e0e\u4e3b\u8282\u70b9\u7684\u4fe1\u606f\u4fdd\u6301\u4e00\u81f4\u3002 \u7b2c\u4e09\uff1a\u5728\u540c\u65f6\u4e3b\u8282\u70b9\u4f1a\u6267\u884cbgsave\uff0c\u751f\u6210rdb\u6587\u4ef6\u540e\uff0c\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\u53bb\u6267\u884c\uff0c\u4ece\u8282\u70b9\u5148\u628a\u81ea\u5df1\u7684\u6570\u636e\u6e05\u7a7a\uff0c\u7136\u540e\u6267\u884c\u4e3b\u8282\u70b9\u53d1\u9001\u8fc7\u6765\u7684rdb\u6587\u4ef6\uff0c\u8fd9\u6837\u5c31\u4fdd\u6301\u4e86\u4e00\u81f4 \u5f53\u7136\uff0c\u5982\u679c\u5728rdb\u751f\u6210\u6267\u884c\u671f\u95f4\uff0c\u4f9d\u7136\u6709\u8bf7\u6c42\u5230\u4e86\u4e3b\u8282\u70b9\uff0c\u800c\u4e3b\u8282\u70b9\u4f1a\u4ee5\u547d\u4ee4\u7684\u65b9\u5f0f\u8bb0\u5f55\u5230\u7f13\u51b2\u533a\uff0c\u7f13\u51b2\u533a\u662f\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u6700\u540e\u628a\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u4e3b\u8282\u70b9\u4e0e\u4ece\u8282\u70b9\u5b8c\u5168\u4e00\u81f4\u4e86\uff0c\u540e\u671f\u518d\u540c\u6b65\u6570\u636e\u7684\u65f6\u5019\uff0c\u90fd\u662f\u4f9d\u8d56\u4e8e\u8fd9\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u8fd9\u4e2a\u5c31\u662f\u5168\u91cf\u540c\u6b65 \u589e\u91cf\u540c\u6b65\u6307\u7684\u662f\uff0c\u5f53\u4ece\u8282\u70b9\u670d\u52a1\u91cd\u542f\u4e4b\u540e\uff0c\u6570\u636e\u5c31\u4e0d\u4e00\u81f4\u4e86\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\uff0c\u4ece\u8282\u70b9\u4f1a\u8bf7\u6c42\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\uff0c\u4e3b\u8282\u70b9\u8fd8\u662f\u5224\u65ad\u4e0d\u662f\u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e0d\u662f\u7b2c\u4e00\u6b21\u5c31\u83b7\u53d6\u4ece\u8282\u70b9\u7684offset\u503c\uff0c\u7136\u540e\u4e3b\u8282\u70b9\u4ece\u547d\u4ee4\u65e5\u5fd7\u4e2d\u83b7\u53d6offset\u503c\u4e4b\u540e\u7684\u6570\u636e\uff0c\u53d1\u9001\u7ed9\u4ece\u8282\u70b9\u8fdb\u884c\u6570\u636e\u540c\u6b65 \u9762\u8bd5\u5b98 \uff1a\u600e\u4e48\u4fdd\u8bc1Redis\u7684\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528 \u5019\u9009\u4eba \uff1a\u9996\u5148\u53ef\u4ee5\u642d\u5efa\u4e3b\u4ece\u96c6\u7fa4\uff0c\u518d\u52a0\u4e0a\u4f7f\u7528redis\u4e2d\u7684\u54e8\u5175\u6a21\u5f0f\uff0c\u54e8\u5175\u6a21\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u4e3b\u4ece\u96c6\u7fa4\u7684\u81ea\u52a8\u6545\u969c\u6062\u590d\uff0c\u91cc\u9762\u5c31\u5305\u542b\u4e86\u5bf9\u4e3b\u4ece\u670d\u52a1\u7684\u76d1\u63a7\u3001\u81ea\u52a8\u6545\u969c\u6062\u590d\u3001\u901a\u77e5\uff1b\u5982\u679cmaster\u6545\u969c\uff0cSentinel\u4f1a\u5c06\u4e00\u4e2aslave\u63d0\u5347\u4e3amaster\u3002\u5f53\u6545\u969c\u5b9e\u4f8b\u6062\u590d\u540e\u4e5f\u4ee5\u65b0\u7684master\u4e3a\u4e3b\uff1b\u540c\u65f6Sentinel\u4e5f\u5145\u5f53Redis\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u53d1\u73b0\u6765\u6e90\uff0c\u5f53\u96c6\u7fa4\u53d1\u751f\u6545\u969c\u8f6c\u79fb\u65f6\uff0c\u4f1a\u5c06\u6700\u65b0\u4fe1\u606f\u63a8\u9001\u7ed9Redis\u7684\u5ba2\u6237\u7aef\uff0c\u6240\u4ee5\u4e00\u822c\u9879\u76ee\u90fd\u4f1a\u91c7\u7528\u54e8\u5175\u7684\u6a21\u5f0f\u6765\u4fdd\u8bc1redis\u7684\u9ad8\u5e76\u53d1\u9ad8\u53ef\u7528 \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u4f7f\u7528redis\u662f\u5355\u70b9\u8fd8\u662f\u96c6\u7fa4\uff0c\u54ea\u79cd\u96c6\u7fa4 \u5019\u9009\u4eba \uff1a\u55ef\uff01\uff0c\u6211\u4eec\u5f53\u65f6\u4f7f\u7528\u7684\u662f\u4e3b\u4ece\uff081\u4e3b1\u4ece\uff09\u52a0\u54e8\u5175\u3002\u4e00\u822c\u5355\u8282\u70b9\u4e0d\u8d85\u8fc710G\u5185\u5b58\uff0c\u5982\u679cRedis\u5185\u5b58\u4e0d\u8db3\u5219\u53ef\u4ee5\u7ed9\u4e0d\u540c\u670d\u52a1\u5206\u914d\u72ec\u7acb\u7684Redis\u4e3b\u4ece\u8282\u70b9\u3002\u5c3d\u91cf\u4e0d\u505a\u5206\u7247\u96c6\u7fa4\u3002\u56e0\u4e3a\u96c6\u7fa4\u7ef4\u62a4\u8d77\u6765\u6bd4\u8f83\u9ebb\u70e6\uff0c\u5e76\u4e14\u96c6\u7fa4\u4e4b\u95f4\u7684\u5fc3\u8df3\u68c0\u6d4b\u548c\u6570\u636e\u901a\u4fe1\u4f1a\u6d88\u8017\u5927\u91cf\u7684\u7f51\u7edc\u5e26\u5bbd\uff0c\u4e5f\u6ca1\u6709\u529e\u6cd5\u4f7f\u7528lua\u811a\u672c\u548c\u4e8b\u52a1 \u9762\u8bd5\u5b98 \uff1aredis\u96c6\u7fa4\u8111\u88c2\uff0c\u8be5\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff01 \u8fd9\u4e2a\u5728\u9879\u76ee\u5f88\u5c11\u89c1\uff0c\u4e0d\u8fc7\u8111\u88c2\u7684\u95ee\u9898\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u73b0\u5728\u7528\u7684\u662fredis\u7684\u54e8\u5175\u6a21\u5f0f\u96c6\u7fa4\u7684 \u6709\u7684\u65f6\u5019\u7531\u4e8e\u7f51\u7edc\u7b49\u539f\u56e0\u53ef\u80fd\u4f1a\u51fa\u73b0\u8111\u88c2\u7684\u60c5\u51b5\uff0c\u5c31\u662f\u8bf4\uff0c\u7531\u4e8eredis master\u8282\u70b9\u548credis salve\u8282\u70b9\u548csentinel\u5904\u4e8e\u4e0d\u540c\u7684\u7f51\u7edc\u5206\u533a\uff0c\u4f7f\u5f97sentinel\u6ca1\u6709\u80fd\u591f\u5fc3\u8df3\u611f\u77e5\u5230master\uff0c\u6240\u4ee5\u901a\u8fc7\u9009\u4e3e\u7684\u65b9\u5f0f\u63d0\u5347\u4e86\u4e00\u4e2asalve\u4e3amaster\uff0c\u8fd9\u6837\u5c31\u5b58\u5728\u4e86\u4e24\u4e2amaster\uff0c\u5c31\u50cf\u5927\u8111\u5206\u88c2\u4e86\u4e00\u6837\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u5ba2\u6237\u7aef\u8fd8\u5728old master\u90a3\u91cc\u5199\u5165\u6570\u636e\uff0c\u65b0\u8282\u70b9\u65e0\u6cd5\u540c\u6b65\u6570\u636e\uff0c\u5f53\u7f51\u7edc\u6062\u590d\u540e\uff0csentinel\u4f1a\u5c06old master\u964d\u4e3asalve\uff0c\u8fd9\u65f6\u518d\u4ece\u65b0master\u540c\u6b65\u6570\u636e\uff0c\u8fd9\u4f1a\u5bfc\u81f4old master\u4e2d\u7684\u5927\u91cf\u6570\u636e\u4e22\u5931\u3002 \u5173\u4e8e\u89e3\u51b3\u7684\u8bdd\uff0c\u6211\u8bb0\u5f97\u5728redis\u7684\u914d\u7f6e\u4e2d\u53ef\u4ee5\u8bbe\u7f6e\uff1a\u7b2c\u4e00\u53ef\u4ee5\u8bbe\u7f6e\u6700\u5c11\u7684salve\u8282\u70b9\u4e2a\u6570\uff0c\u6bd4\u5982\u8bbe\u7f6e\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u4ece\u8282\u70b9\u624d\u80fd\u540c\u6b65\u6570\u636e\uff0c\u7b2c\u4e8c\u4e2a\u53ef\u4ee5\u8bbe\u7f6e\u4e3b\u4ece\u6570\u636e\u590d\u5236\u548c\u540c\u6b65\u7684\u5ef6\u8fdf\u65f6\u95f4\uff0c\u8fbe\u4e0d\u5230\u8981\u6c42\u5c31\u62d2\u7edd\u8bf7\u6c42\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u5927\u91cf\u7684\u6570\u636e\u4e22\u5931 \u9762\u8bd5\u5b98 \uff1aredis\u7684\u5206\u7247\u96c6\u7fa4\u6709\u4ec0\u4e48\u4f5c\u7528 \u5019\u9009\u4eba \uff1a\u5206\u7247\u96c6\u7fa4\u4e3b\u8981\u89e3\u51b3\u7684\u662f\uff0c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u96c6\u7fa4\u4e2d\u6709\u591a\u4e2amaster\uff0c\u6bcf\u4e2amaster\u4fdd\u5b58\u4e0d\u540c\u6570\u636e\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u7ed9\u6bcf\u4e2amaster\u8bbe\u7f6e\u591a\u4e2aslave\u8282\u70b9\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u589e\u5927\u96c6\u7fa4\u7684\u9ad8\u5e76\u53d1\u80fd\u529b\u3002\u540c\u65f6\u6bcf\u4e2amaster\u4e4b\u95f4\u901a\u8fc7ping\u76d1\u6d4b\u5f7c\u6b64\u5065\u5eb7\u72b6\u6001\uff0c\u5c31\u7c7b\u4f3c\u4e8e\u54e8\u5175\u6a21\u5f0f\u4e86\u3002\u5f53\u5ba2\u6237\u7aef\u8bf7\u6c42\u53ef\u4ee5\u8bbf\u95ee\u96c6\u7fa4\u4efb\u610f\u8282\u70b9\uff0c\u6700\u7ec8\u90fd\u4f1a\u88ab\u8f6c\u53d1\u5230\u6b63\u786e\u8282\u70b9 \u9762\u8bd5\u5b98 \uff1aRedis\u5206\u7247\u96c6\u7fa4\u4e2d\u6570\u636e\u662f\u600e\u4e48\u5b58\u50a8\u548c\u8bfb\u53d6\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5728redis\u96c6\u7fa4\u4e2d\u662f\u8fd9\u6837\u7684 Redis \u96c6\u7fa4\u5f15\u5165\u4e86\u54c8\u5e0c\u69fd\u7684\u6982\u5ff5\uff0c\u6709 16384 \u4e2a\u54c8\u5e0c\u69fd\uff0c\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u4e3b\u8282\u70b9\u7ed1\u5b9a\u4e86\u4e00\u5b9a\u8303\u56f4\u7684\u54c8\u5e0c\u69fd\u8303\u56f4\uff0c key\u901a\u8fc7 CRC16 \u6821\u9a8c\u540e\u5bf9 16384 \u53d6\u6a21\u6765\u51b3\u5b9a\u653e\u7f6e\u54ea\u4e2a\u69fd\uff0c\u901a\u8fc7\u69fd\u627e\u5230\u5bf9\u5e94\u7684\u8282\u70b9\u8fdb\u884c\u5b58\u50a8\u3002 \u53d6\u503c\u7684\u903b\u8f91\u662f\u4e00\u6837\u7684 \u9762\u8bd5\u5b98 \uff1aRedis\u662f\u5355\u7ebf\u7a0b\u7684\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u8fd8\u90a3\u4e48\u5feb\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u6709\u51e0\u4e2a\u539f\u56e0\u5427~~~ 1\u3001\u5b8c\u5168\u57fa\u4e8e\u5185\u5b58\u7684\uff0cC\u8bed\u8a00\u7f16\u5199 2\u3001\u91c7\u7528\u5355\u7ebf\u7a0b\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4e0a\u4e0b\u6587\u5207\u6362\u53ef\u7ade\u4e89\u6761\u4ef6 3\u3001\u4f7f\u7528\u591a\u8defI/O\u590d\u7528\u6a21\u578b\uff0c\u975e\u963b\u585eIO \u4f8b\u5982\uff1abgsave \u548c bgrewriteaof \u90fd\u662f\u5728 \u540e\u53f0 \u6267\u884c\u64cd\u4f5c\uff0c\u4e0d\u5f71\u54cd\u4e3b\u7ebf\u7a0b\u7684\u6b63\u5e38\u4f7f\u7528\uff0c\u4e0d\u4f1a\u4ea7\u751f\u963b\u585e \u9762\u8bd5\u5b98 \uff1a\u80fd\u89e3\u91ca\u4e00\u4e0bI/O\u591a\u8def\u590d\u7528\u6a21\u578b\uff1f \u5019\u9009\u4eba \uff1a\u55ef~~\uff0cI/O\u591a\u8def\u590d\u7528\u662f\u6307\u5229\u7528\u5355\u4e2a\u7ebf\u7a0b\u6765\u540c\u65f6\u76d1\u542c\u591a\u4e2aSocket \uff0c\u5e76\u5728\u67d0\u4e2aSocket\u53ef\u8bfb\u3001\u53ef\u5199\u65f6\u5f97\u5230\u901a\u77e5\uff0c\u4ece\u800c\u907f\u514d\u65e0\u6548\u7684\u7b49\u5f85\uff0c\u5145\u5206\u5229\u7528CPU\u8d44\u6e90\u3002\u76ee\u524d\u7684I/O\u591a\u8def\u590d\u7528\u90fd\u662f\u91c7\u7528\u7684epoll\u6a21\u5f0f\u5b9e\u73b0\uff0c\u5b83\u4f1a\u5728\u901a\u77e5\u7528\u6237\u8fdb\u7a0bSocket\u5c31\u7eea\u7684\u540c\u65f6\uff0c\u628a\u5df2\u5c31\u7eea\u7684Socket\u5199\u5165\u7528\u6237\u7a7a\u95f4\uff0c\u4e0d\u9700\u8981\u6328\u4e2a\u904d\u5386Socket\u6765\u5224\u65ad\u662f\u5426\u5c31\u7eea\uff0c\u63d0\u5347\u4e86\u6027\u80fd\u3002 \u5176\u4e2dRedis\u7684\u7f51\u7edc\u6a21\u578b\u5c31\u662f\u4f7f\u7528I/O\u591a\u8def\u590d\u7528\u7ed3\u5408\u4e8b\u4ef6\u7684\u5904\u7406\u5668\u6765\u5e94\u5bf9\u591a\u4e2aSocket\u8bf7\u6c42\uff0c\u6bd4\u5982\uff0c\u63d0\u4f9b\u4e86\u8fde\u63a5\u5e94\u7b54\u5904\u7406\u5668\u3001\u547d\u4ee4\u56de\u590d\u5904\u7406\u5668\uff0c\u547d\u4ee4\u8bf7\u6c42\u5904\u7406\u5668\uff1b \u5728Redis6.0\u4e4b\u540e\uff0c\u4e3a\u4e86\u63d0\u5347\u66f4\u597d\u7684\u6027\u80fd\uff0c\u5728\u547d\u4ee4\u56de\u590d\u5904\u7406\u5668\u4f7f\u7528\u4e86\u591a\u7ebf\u7a0b\u6765\u5904\u7406\u56de\u590d\u4e8b\u4ef6\uff0c\u5728\u547d\u4ee4\u8bf7\u6c42\u5904\u7406\u5668\u4e2d\uff0c\u5c06\u547d\u4ee4\u7684\u8f6c\u6362\u4f7f\u7528\u4e86\u591a\u7ebf\u7a0b\uff0c\u589e\u52a0\u547d\u4ee4\u8f6c\u6362\u901f\u5ea6\uff0c\u5728\u547d\u4ee4\u6267\u884c\u7684\u65f6\u5019\uff0c\u4f9d\u7136\u662f\u5355\u7ebf\u7a0b","title":"Redis\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/03-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AF%87/MySQL%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/","text":"MySQL\u9762\u8bd5\u9898-\u6587\u7a3f \u9762\u8bd5\u5b98\uff1a MySQL\u4e2d\uff0c\u5982\u4f55\u5b9a\u4f4d\u6162\u67e5\u8be2? \u5019\u9009\u4eba\uff1a \u55ef~\uff0c\u6211\u4eec\u5f53\u65f6\u505a\u538b\u6d4b\u7684\u65f6\u5019\u6709\u7684\u63a5\u53e3\u975e\u5e38\u7684\u6162\uff0c\u63a5\u53e3\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc7\u4e862\u79d2\u4ee5\u4e0a\uff0c\u56e0\u4e3a\u6211\u4eec\u5f53\u65f6\u7684\u7cfb\u7edf\u90e8\u7f72\u4e86\u8fd0\u7ef4\u7684\u76d1\u63a7\u7cfb\u7edfSkywalking \uff0c\u5728\u5c55\u793a\u7684\u62a5\u8868\u4e2d\u53ef\u4ee5\u770b\u5230\u662f\u54ea\u4e00\u4e2a\u63a5\u53e3\u6bd4\u8f83\u6162\uff0c\u5e76\u4e14\u53ef\u4ee5\u5206\u6790\u8fd9\u4e2a\u63a5\u53e3\u54ea\u90e8\u5206\u6bd4\u8f83\u6162\uff0c\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230SQL\u7684\u5177\u4f53\u7684\u6267\u884c\u65f6\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u5b9a\u4f4d\u662f\u54ea\u4e2asql\u51fa\u4e86\u95ee\u9898 \u5982\u679c\uff0c\u9879\u76ee\u4e2d\u6ca1\u6709\u8fd9\u79cd\u8fd0\u7ef4\u7684\u76d1\u63a7\u7cfb\u7edf\uff0c\u5176\u5b9e\u5728MySQL\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u6162\u65e5\u5fd7\u67e5\u8be2\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5728MySQL\u7684\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u8fd9\u4e2a\u6162\u65e5\u5fd7\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u8bbe\u7f6eSQL\u6267\u884c\u8d85\u8fc7\u591a\u5c11\u65f6\u95f4\u6765\u8bb0\u5f55\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u6211\u8bb0\u5f97\u4e0a\u4e00\u4e2a\u9879\u76ee\u914d\u7f6e\u7684\u662f2\u79d2\uff0c\u53ea\u8981SQL\u6267\u884c\u7684\u65f6\u95f4\u8d85\u8fc7\u4e862\u79d2\u5c31\u4f1a\u8bb0\u5f55\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u65e5\u5fd7\u6587\u4ef6\u627e\u5230\u6267\u884c\u6bd4\u8f83\u6162\u7684SQL\u4e86\u3002 \u9762\u8bd5\u5b98\uff1a \u90a3\u8fd9\u4e2aSQL\u8bed\u53e5\u6267\u884c\u5f88\u6162, \u5982\u4f55\u5206\u6790\u5462\uff1f \u5019\u9009\u4eba\uff1a \u5982\u679c\u4e00\u6761sql\u6267\u884c\u5f88\u6162\u7684\u8bdd\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u4f7f\u7528mysql\u81ea\u52a8\u7684\u6267\u884c\u8ba1\u5212explain\u6765\u53bb\u67e5\u770b\u8fd9\u6761sql\u7684\u6267\u884c\u60c5\u51b5\uff0c\u6bd4\u5982\u5728\u8fd9\u91cc\u9762\u53ef\u4ee5\u901a\u8fc7key\u548ckey_len\u68c0\u67e5\u662f\u5426\u547d\u4e2d\u4e86\u7d22\u5f15\uff0c\u5982\u679c\u672c\u8eab\u5df2\u7ecf\u6dfb\u52a0\u4e86\u7d22\u5f15\uff0c\u4e5f\u53ef\u4ee5\u5224\u65ad\u7d22\u5f15\u662f\u5426\u6709\u5931\u6548\u7684\u60c5\u51b5\uff0c\u7b2c\u4e8c\u4e2a\uff0c\u53ef\u4ee5\u901a\u8fc7type\u5b57\u6bb5\u67e5\u770bsql\u662f\u5426\u6709\u8fdb\u4e00\u6b65\u7684\u4f18\u5316\u7a7a\u95f4\uff0c\u662f\u5426\u5b58\u5728\u5168\u7d22\u5f15\u626b\u63cf\u6216\u5168\u76d8\u626b\u63cf\uff0c\u7b2c\u4e09\u4e2a\u53ef\u4ee5\u901a\u8fc7extra\u5efa\u8bae\u6765\u5224\u65ad\uff0c\u662f\u5426\u51fa\u73b0\u4e86\u56de\u8868\u7684\u60c5\u51b5\uff0c\u5982\u679c\u51fa\u73b0\u4e86\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u6dfb\u52a0\u7d22\u5f15\u6216\u4fee\u6539\u8fd4\u56de\u5b57\u6bb5\u6765\u4fee\u590d \u9762\u8bd5\u5b98\uff1a \u4e86\u89e3\u8fc7\u7d22\u5f15\u5417\uff1f\uff08\u4ec0\u4e48\u662f\u7d22\u5f15\uff09 \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u7d22\u5f15\u5728\u9879\u76ee\u4e2d\u8fd8\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u5b83\u662f\u5e2e\u52a9MySQL\u9ad8\u6548\u83b7\u53d6\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e3b\u8981\u662f\u7528\u6765\u63d0\u9ad8\u6570\u636e\u68c0\u7d22\u7684\u6548\u7387\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u7684IO\u6210\u672c\uff0c\u540c\u65f6\u901a\u8fc7\u7d22\u5f15\u5217\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u964d\u4f4e\u6570\u636e\u6392\u5e8f\u7684\u6210\u672c\uff0c\u4e5f\u80fd\u964d\u4f4e\u4e86CPU\u7684\u6d88\u8017 \u9762\u8bd5\u5b98\uff1a \u7d22\u5f15\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u4e86\u89e3\u8fc7\u561b ? \u5019\u9009\u4eba\uff1a MySQL\u7684\u9ed8\u8ba4\u7684\u5b58\u50a8\u5f15\u64ceInnoDB\u91c7\u7528\u7684B+\u6811\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u50a8\u7d22\u5f15\uff0c\u9009\u62e9B+\u6811\u7684\u4e3b\u8981\u7684\u539f\u56e0\u662f\uff1a\u7b2c\u4e00\u9636\u6570\u66f4\u591a\uff0c\u8def\u5f84\u66f4\u77ed\uff0c\u7b2c\u4e8c\u4e2a\u78c1\u76d8\u8bfb\u5199\u4ee3\u4ef7B+\u6811\u66f4\u4f4e\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u53ea\u5b58\u50a8\u6307\u9488\uff0c\u53f6\u5b50\u9636\u6bb5\u5b58\u50a8\u6570\u636e\uff0c\u7b2c\u4e09\u662fB+\u6811\u4fbf\u4e8e\u626b\u5e93\u548c\u533a\u95f4\u67e5\u8be2\uff0c\u53f6\u5b50\u8282\u70b9\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868 \u9762\u8bd5\u5b98\uff1a B\u6811\u548cB+\u6811\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5462\uff1f \u5019\u9009\u4eba \uff1a\u7b2c\u4e00\uff1a\u5728B\u6811\u4e2d\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u548c\u53f6\u5b50\u8282\u70b9\u90fd\u4f1a\u5b58\u653e\u6570\u636e\uff0c\u800cB+\u6811\u7684\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u51fa\u73b0\u5728\u53f6\u5b50\u8282\u70b9\uff0c\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0cB+\u6811\u67e5\u627e\u6548\u7387\u66f4\u52a0\u7a33\u5b9a \u7b2c\u4e8c\uff1a\u5728\u8fdb\u884c\u8303\u56f4\u67e5\u8be2\u7684\u65f6\u5019\uff0cB+\u6811\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3aB+\u6811\u90fd\u5728\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\uff0c\u5e76\u4e14\u53f6\u5b50\u8282\u70b9\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u662f\u805a\u7c07\u7d22\u5f15\u4ec0\u4e48\u662f\u975e\u805a\u7c07\u7d22\u5f15 ? \u5019\u9009\u4eba\uff1a \u597d\u7684~\uff0c\u805a\u7c07\u7d22\u5f15\u4e3b\u8981\u662f\u6307\u6570\u636e\u4e0e\u7d22\u5f15\u653e\u5230\u4e00\u5757\uff0cB+\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58\u4e86\u6574\u884c\u6570\u636e\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3b\u952e\u5728\u4f5c\u4e3a\u805a\u7c07\u7d22\u5f15\u7684 \u975e\u805a\u7c07\u7d22\u5f15\u503c\u7684\u662f\u6570\u636e\u4e0e\u7d22\u5f15\u5206\u5f00\u5b58\u50a8\uff0cB+\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58\u5bf9\u5e94\u7684\u4e3b\u952e\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u4e00\u822c\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684\u7d22\u5f15\u90fd\u662f\u975e\u805a\u7c07\u7d22\u5f15 \u9762\u8bd5\u5b98\uff1a \u77e5\u9053\u4ec0\u4e48\u662f\u56de\u8868\u67e5\u8be2\u561b ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u5176\u5b9e\u8ddf\u521a\u624d\u4ecb\u7ecd\u7684\u805a\u7c07\u7d22\u5f15\u548c\u975e\u805a\u7c07\u7d22\u5f15\u662f\u6709\u5173\u7cfb\u7684\uff0c\u56de\u8868\u7684\u610f\u601d\u5c31\u662f\u901a\u8fc7\u4e8c\u7ea7\u7d22\u5f15\u627e\u5230\u5bf9\u5e94\u7684\u4e3b\u952e\u503c\uff0c\u7136\u540e\u518d\u901a\u8fc7\u4e3b\u952e\u503c\u627e\u5230\u805a\u96c6\u7d22\u5f15\u4e2d\u6240\u5bf9\u5e94\u7684\u6574\u884c\u6570\u636e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u56de\u8868 \u3010 \u5907\u6ce8 \uff1a\u5982\u679c\u9762\u8bd5\u5b98\u76f4\u63a5\u95ee\u56de\u8868\uff0c\u5219\u9700\u8981\u5148\u4ecb\u7ecd\u805a\u7c07\u7d22\u5f15\u548c\u975e\u805a\u7c07\u7d22\u5f15\u3011 \u9762\u8bd5\u5b98\uff1a \u77e5\u9053\u4ec0\u4e48\u53eb\u8986\u76d6\u7d22\u5f15\u561b ? \u5019\u9009\u4eba\uff1a \u55ef~\uff0c\u6e05\u695a\u7684 \u8986\u76d6\u7d22\u5f15\u662f\u6307select\u67e5\u8be2\u8bed\u53e5\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u5728\u8fd4\u56de\u7684\u5217\uff0c\u5fc5\u987b\u5728\u7d22\u5f15\u4e2d\u5168\u90e8\u80fd\u591f\u627e\u5230\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528id\u67e5\u8be2\uff0c\u5b83\u4f1a\u76f4\u63a5\u8d70\u805a\u96c6\u7d22\u5f15\u67e5\u8be2\uff0c\u4e00\u6b21\u7d22\u5f15\u626b\u63cf\uff0c\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff0c\u6027\u80fd\u9ad8\u3002 \u5982\u679c\u6309\u7167\u4e8c\u7ea7\u7d22\u5f15\u67e5\u8be2\u6570\u636e\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u5217\u4e2d\u6ca1\u6709\u521b\u5efa\u7d22\u5f15\uff0c\u6709\u53ef\u80fd\u4f1a\u89e6\u53d1\u56de\u8868\u67e5\u8be2\uff0c\u5c3d\u91cf\u907f\u514d\u4f7f\u7528select *\uff0c\u5c3d\u91cf\u5728\u8fd4\u56de\u7684\u5217\u4e2d\u90fd\u5305\u542b\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5 \u9762\u8bd5\u5b98\uff1a MYSQL\u8d85\u5927\u5206\u9875\u600e\u4e48\u5904\u7406 ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8d85\u5927\u5206\u9875\u4e00\u822c\u90fd\u662f\u5728\u6570\u636e\u91cf\u6bd4\u8f83\u5927\u65f6\uff0c\u6211\u4eec\u4f7f\u7528\u4e86limit\u5206\u9875\u67e5\u8be2\uff0c\u5e76\u4e14\u9700\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u4e2a\u65f6\u5019\u6548\u7387\u5c31\u5f88\u4f4e\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u8986\u76d6\u7d22\u5f15\u548c\u5b50\u67e5\u8be2\u6765\u89e3\u51b3 \u5148\u5206\u9875\u67e5\u8be2\u6570\u636e\u7684id\u5b57\u6bb5\uff0c\u786e\u5b9a\u4e86id\u4e4b\u540e\uff0c\u518d\u7528\u5b50\u67e5\u8be2\u6765\u8fc7\u6ee4\uff0c\u53ea\u67e5\u8be2\u8fd9\u4e2aid\u5217\u8868\u4e2d\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u4e86 \u56e0\u4e3a\u67e5\u8be2id\u7684\u65f6\u5019\uff0c\u8d70\u7684\u8986\u76d6\u7d22\u5f15\uff0c\u6240\u4ee5\u6548\u7387\u53ef\u4ee5\u63d0\u5347\u5f88\u591a \u9762\u8bd5\u5b98\uff1a \u7d22\u5f15\u521b\u5efa\u539f\u5219\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u60c5\u51b5\u6709\u5f88\u591a\uff0c\u4e0d\u8fc7\u90fd\u6709\u4e00\u4e2a\u5927\u524d\u63d0\uff0c\u5c31\u662f\u8868\u4e2d\u7684\u6570\u636e\u8981\u8d85\u8fc710\u4e07\u4ee5\u4e0a\uff0c\u6211\u4eec\u624d\u4f1a\u521b\u5efa\u7d22\u5f15\uff0c\u5e76\u4e14\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5\u662f\u67e5\u8be2\u6bd4\u8f83\u9891\u7e41\u7684\u5b57\u6bb5\uff0c\u4e00\u822c\u4e5f\u662f\u50cf\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\uff0c\u6392\u5e8f\u5b57\u6bb5\u6216\u5206\u7ec4\u7684\u5b57\u6bb5\u8fd9\u4e9b\u3002 \u8fd8\u6709\u5c31\u662f\uff0c\u6211\u4eec\u901a\u5e38\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\u90fd\u662f\u4f7f\u7528\u590d\u5408\u7d22\u5f15\u6765\u521b\u5efa\uff0c\u4e00\u6761sql\u7684\u8fd4\u56de\u503c\uff0c\u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff0c\u5982\u679c\u5b57\u6bb5\u7684\u533a\u5206\u5ea6\u4e0d\u9ad8\u7684\u8bdd\uff0c\u6211\u4eec\u4e5f\u4f1a\u628a\u5b83\u653e\u5728\u7ec4\u5408\u7d22\u5f15\u540e\u9762\u7684\u5b57\u6bb5\u3002 \u5982\u679c\u67d0\u4e00\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u8f83\u957f\uff0c\u6211\u4eec\u4f1a\u8003\u8651\u4f7f\u7528\u524d\u7f00\u7d22\u5f15\u6765\u4f7f\u7528\uff0c\u5f53\u7136\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5b57\u6bb5\u90fd\u8981\u6dfb\u52a0\u7d22\u5f15\uff0c\u8fd9\u4e2a\u7d22\u5f15\u7684\u6570\u91cf\u4e5f\u8981\u63a7\u5236\uff0c\u56e0\u4e3a\u6dfb\u52a0\u7d22\u5f15\u4e5f\u4f1a\u5bfc\u81f4\u65b0\u589e\u6539\u7684\u901f\u5ea6\u53d8\u6162\u3002 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u60c5\u51b5\u4e0b\u7d22\u5f15\u4f1a\u5931\u6548 ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u60c5\u51b5\u6bd4\u8f83\u591a\uff0c\u6211\u8bf4\u4e00\u4e9b\u81ea\u5df1\u7684\u7ecf\u9a8c\uff0c\u4ee5\u524d\u9047\u5230\u8fc7\u7684 \u6bd4\u5982\uff0c\u7d22\u5f15\u5728\u4f7f\u7528\u7684\u65f6\u5019\u6ca1\u6709\u9075\u5faa\u6700\u5de6\u5339\u914d\u6cd5\u5219\uff0c\u7b2c\u4e8c\u4e2a\u662f\uff0c\u6a21\u7cca\u67e5\u8be2\uff0c\u5982\u679c%\u53f7\u5728\u524d\u9762\u4e5f\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u3002\u5982\u679c\u5728\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5\u4e0a\u8fdb\u884c\u4e86\u8fd0\u7b97\u64cd\u4f5c\u6216\u8005\u7c7b\u578b\u8f6c\u6362\u4e5f\u90fd\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u3002 \u6211\u4eec\u4e4b\u524d\u8fd8\u9047\u5230\u8fc7\u4e00\u4e2a\u5c31\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u590d\u5408\u7d22\u5f15\uff0c\u4e2d\u95f4\u4f7f\u7528\u4e86\u8303\u56f4\u67e5\u8be2\uff0c\u53f3\u8fb9\u7684\u6761\u4ef6\u7d22\u5f15\u4e5f\u4f1a\u5931\u6548 \u6240\u4ee5\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u60f3\u8981\u5224\u65ad\u51fa\u8fd9\u6761sql\u662f\u5426\u6709\u7d22\u5f15\u5931\u6548\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528explain\u6267\u884c\u8ba1\u5212\u6765\u5206\u6790 \u9762\u8bd5\u5b98\uff1a sql\u7684\u4f18\u5316\u7684\u7ecf\u9a8c \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u5728\u9879\u76ee\u8fd8\u662f\u633a\u5e38\u89c1\u7684\uff0c\u5f53\u7136\u5982\u679c\u76f4\u8bf4sql\u4f18\u5316\u7684\u8bdd\uff0c\u6211\u4eec\u4f1a\u4ece\u8fd9\u51e0\u65b9\u9762\u8003\u8651\uff0c\u6bd4\u5982 \u5efa\u8868\u7684\u65f6\u5019\u3001\u4f7f\u7528\u7d22\u5f15\u3001sql\u8bed\u53e5\u7684\u7f16\u5199\u3001\u4e3b\u4ece\u590d\u5236\uff0c\u8bfb\u5199\u5206\u79bb\uff0c\u8fd8\u6709\u4e00\u4e2a\u662f\u5982\u679c\u91cf\u6bd4\u8f83\u5927\u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u5206\u5e93\u5206\u8868 \u9762\u8bd5\u5b98\uff1a \u521b\u5efa\u8868\u7684\u65f6\u5019\uff0c\u4f60\u4eec\u662f\u5982\u4f55\u4f18\u5316\u7684\u5462\uff1f \u5019\u9009\u4eba\uff1a \u8fd9\u4e2a\u6211\u4eec\u4e3b\u8981\u53c2\u8003\u7684\u963f\u91cc\u51fa\u7684\u90a3\u4e2a\u5f00\u53d1\u624b\u518c\u300a\u5d69\u5c71\u7248\u300b\uff0c\u5c31\u6bd4\u5982\uff0c\u5728\u5b9a\u4e49\u5b57\u6bb5\u7684\u65f6\u5019\u9700\u8981\u7ed3\u5408\u5b57\u6bb5\u7684\u5185\u5bb9\u6765\u9009\u62e9\u5408\u9002\u7684\u7c7b\u578b\uff0c\u5982\u679c\u662f\u6570\u503c\u7684\u8bdd\uff0c\u50cftinyint\u3001int \u3001bigint\u8fd9\u4e9b\u7c7b\u578b\uff0c\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u62e9\u3002\u5982\u679c\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u4e5f\u662f\u7ed3\u5408\u5b58\u50a8\u7684\u5185\u5bb9\u6765\u9009\u62e9char\u548cvarchar\u6216\u8005text\u7c7b\u578b \u9762\u8bd5\u5b98\uff1a \u90a3\u5728\u4f7f\u7528\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u662f\u5982\u4f55\u4f18\u5316\u5462\uff1f \u5019\u9009\u4eba\uff1a \u3010\u53c2\u8003\u7d22\u5f15\u521b\u5efa\u539f\u5219 \u8fdb\u884c\u63cf\u8ff0\u3011 \u9762\u8bd5\u5b98\uff1a \u4f60\u5e73\u65f6\u5bf9sql\u8bed\u53e5\u505a\u4e86\u54ea\u4e9b\u4f18\u5316\u5462\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u6709\u5f88\u591a\uff0c\u6bd4\u5982SELECT\u8bed\u53e5\u52a1\u5fc5\u6307\u660e\u5b57\u6bb5\u540d\u79f0\uff0c\u4e0d\u8981\u76f4\u63a5\u4f7f\u7528select * \uff0c\u8fd8\u6709\u5c31\u662f\u8981\u6ce8\u610fSQL\u8bed\u53e5\u907f\u514d\u9020\u6210\u7d22\u5f15\u5931\u6548\u7684\u5199\u6cd5\uff1b\u5982\u679c\u662f\u805a\u5408\u67e5\u8be2\uff0c\u5c3d\u91cf\u7528union all\u4ee3\u66ffunion \uff0cunion\u4f1a\u591a\u4e00\u6b21\u8fc7\u6ee4\uff0c\u6548\u7387\u6bd4\u8f83\u4f4e\uff1b\u5982\u679c\u662f\u8868\u5173\u8054\u7684\u8bdd\uff0c\u5c3d\u91cf\u4f7f\u7528innerjoin \uff0c\u4e0d\u8981\u4f7f\u7528\u7528left join right join\uff0c\u5982\u5fc5\u987b\u4f7f\u7528 \u4e00\u5b9a\u8981\u4ee5\u5c0f\u8868\u4e3a\u9a71\u52a8 \u9762\u8bd5\u5b98\uff1a \u4e8b\u52a1\u7684\u7279\u6027\u662f\u4ec0\u4e48\uff1f\u53ef\u4ee5\u8be6\u7ec6\u8bf4\u4e00\u4e0b\u5417\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u6e05\u695a\uff0cACID\uff0c\u5206\u522b\u6307\u7684\u662f\uff1a\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u3001\u9694\u79bb\u6027\u3001\u6301\u4e45\u6027\uff1b\u6211\u4e3e\u4e2a\u4f8b\u5b50\uff1a A\u5411B\u8f6c\u8d26500\uff0c\u8f6c\u8d26\u6210\u529f\uff0cA\u6263\u9664500\u5143\uff0cB\u589e\u52a0500\u5143\uff0c\u539f\u5b50\u64cd\u4f5c\u4f53\u73b0\u5728\u8981\u4e48\u90fd\u6210\u529f\uff0c\u8981\u4e48\u90fd\u5931\u8d25 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6570\u636e\u8981\u4e00\u81f4\uff0cA\u6263\u9664\u4e86500\uff0cB\u5fc5\u987b\u589e\u52a0500 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9694\u79bb\u6027\u4f53\u73b0\u5728A\u50cfB\u8f6c\u8d26\uff0c\u4e0d\u80fd\u53d7\u5176\u4ed6\u4e8b\u52a1\u5e72\u6270 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6301\u4e45\u6027\u4f53\u73b0\u5728\u4e8b\u52a1\u63d0\u4ea4\u540e\uff0c\u8981\u628a\u6570\u636e\u6301\u4e45\u5316\uff08\u53ef\u4ee5\u8bf4\u662f\u843d\u76d8\u64cd\u4f5c\uff09 \u9762\u8bd5\u5b98 \uff1a\u5e76\u53d1\u4e8b\u52a1\u5e26\u6765\u54ea\u4e9b\u95ee\u9898\uff1f \u5019\u9009\u4eba \uff1a \u6211\u4eec\u5728\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u8fdb\u884c\u662f\u7ecf\u5e38\u53d1\u751f\u7684\uff0c\u5e76\u53d1\u4e5f\u662f\u5fc5\u7136\u7684\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898 \u7b2c\u4e00\u662f\u810f\u8bfb\uff0c \u5f53\u4e00\u4e2a\u4e8b\u52a1\u6b63\u5728\u8bbf\u95ee\u6570\u636e\u5e76\u4e14\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u65f6\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6570\u636e\u662f\u8fd8\u6ca1\u6709\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u90a3\u4e48\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u5230\u7684\u8fd9\u4e2a\u6570\u636e\u662f\u201c\u810f\u6570\u636e\u201d\uff0c\u4f9d\u636e\u201c\u810f\u6570\u636e\u201d\u6240\u505a\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u4e0d\u6b63\u786e\u7684\u3002 \u7b2c\u4e8c\u662f\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u6bd4\u5982\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u591a\u6b21\u8bfb\u540c\u4e00\u6570\u636e\u3002\u5728\u8fd9\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u6709\u7ed3\u675f\u65f6\uff0c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u8be5\u6570\u636e\u3002\u90a3\u4e48\uff0c\u5728\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u4e24\u6b21\u8bfb\u6570\u636e\u4e4b\u95f4\uff0c\u7531\u4e8e\u7b2c\u4e8c\u4e2a\u4e8b\u52a1\u7684\u4fee\u6539\u5bfc\u81f4\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u4e24\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u592a\u4e00\u6837\u3002\u8fd9\u5c31\u53d1\u751f\u4e86\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u4e24\u6b21\u8bfb\u5230\u7684\u6570\u636e\u662f\u4e0d\u4e00\u6837\u7684\u60c5\u51b5\uff0c\u56e0\u6b64\u79f0\u4e3a\u4e0d\u53ef\u91cd\u590d\u8bfb\u3002 \u7b2c\u4e09\u662f\u5e7b\u8bfb\uff08Phantom read\uff09\uff1a\u5e7b\u8bfb\u4e0e\u4e0d\u53ef\u91cd\u590d\u8bfb\u7c7b\u4f3c\u3002\u5b83\u53d1\u751f\u5728\u4e00\u4e2a\u4e8b\u52a1\uff08T1\uff09\u8bfb\u53d6\u4e86\u51e0\u884c\u6570\u636e\uff0c\u63a5\u7740\u53e6\u4e00\u4e2a\u5e76\u53d1\u4e8b\u52a1\uff08T2\uff09\u63d2\u5165\u4e86\u4e00\u4e9b\u6570\u636e\u65f6\u3002\u5728\u968f\u540e\u7684\u67e5\u8be2\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u4e8b\u52a1\uff08T1\uff09\u5c31\u4f1a\u53d1\u73b0\u591a\u4e86\u4e00\u4e9b\u539f\u672c\u4e0d\u5b58\u5728\u7684\u8bb0\u5f55\uff0c\u5c31\u597d\u50cf\u53d1\u751f\u4e86\u5e7b\u89c9\u4e00\u6837\uff0c\u6240\u4ee5\u79f0\u4e3a\u5e7b\u8bfb\u3002 \u9762\u8bd5\u5b98 \uff1a\u600e\u4e48\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u5462\uff1fMySQL\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u662f\uff1f \u5019\u9009\u4eba \uff1a\u89e3\u51b3\u65b9\u6848\u662f\u5bf9\u4e8b\u52a1\u8fdb\u884c\u9694\u79bb MySQL\u652f\u6301\u56db\u79cd\u9694\u79bb\u7ea7\u522b\uff0c\u5206\u522b\u6709\uff1a \u7b2c\u4e00\u4e2a\u662f\uff0c\u672a\u63d0\u4ea4\u8bfb\uff08read uncommitted\uff09\u5b83\u89e3\u51b3\u4e0d\u4e86\u521a\u624d\u63d0\u51fa\u7684\u6240\u6709\u95ee\u9898\uff0c\u4e00\u822c\u9879\u76ee\u4e2d\u4e5f\u4e0d\u7528\u8fd9\u4e2a\u3002\u7b2c\u4e8c\u4e2a\u662f\u8bfb\u5df2\u63d0\u4ea4\uff08read committed\uff09\u5b83\u80fd\u89e3\u51b3\u810f\u8bfb\u7684\u95ee\u9898\u7684\uff0c\u4f46\u662f\u89e3\u51b3\u4e0d\u4e86\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u3002\u7b2c\u4e09\u4e2a\u662f\u53ef\u91cd\u590d\u8bfb\uff08repeatable read\uff09\u5b83\u80fd\u89e3\u51b3\u810f\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u4f46\u662f\u89e3\u51b3\u4e0d\u4e86\u5e7b\u8bfb\uff0c\u8fd9\u4e2a\u4e5f\u662fmysql\u9ed8\u8ba4\u7684\u9694\u79bb\u7ea7\u522b\u3002\u7b2c\u56db\u4e2a\u662f\u4e32\u884c\u5316\uff08serializable\uff09\u5b83\u53ef\u4ee5\u89e3\u51b3\u521a\u624d\u63d0\u51fa\u6765\u7684\u6240\u6709\u95ee\u9898\uff0c\u4f46\u662f\u7531\u4e8e\u8ba9\u662f\u4e8b\u52a1\u4e32\u884c\u6267\u884c\u7684\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u7684\u90fd\u662fmysql\u9ed8\u8ba4\u7684\u9694\u79bb\u7ea7\u522b:\u53ef\u91cd\u590d\u8bfb \u9762\u8bd5\u5b98 \uff1aundo log\u548credo log\u7684\u533a\u522b \u5019\u9009\u4eba \uff1a\u597d\u7684\uff0c\u5176\u4e2dredo log\u65e5\u5fd7\u8bb0\u5f55\u7684\u662f\u6570\u636e\u9875\u7684\u7269\u7406\u53d8\u5316\uff0c\u670d\u52a1\u5b95\u673a\u53ef\u7528\u6765\u540c\u6b65\u6570\u636e\uff0c\u800cundo log \u4e0d\u540c\uff0c\u5b83\u4e3b\u8981\u8bb0\u5f55\u7684\u662f\u903b\u8f91\u65e5\u5fd7\uff0c\u5f53\u4e8b\u52a1\u56de\u6eda\u65f6\uff0c\u901a\u8fc7\u9006\u64cd\u4f5c\u6062\u590d\u539f\u6765\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6211\u4eec\u5220\u9664\u4e00\u6761\u6570\u636e\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5728undo log\u65e5\u5fd7\u6587\u4ef6\u4e2d\u65b0\u589e\u4e00\u6761delete\u8bed\u53e5\uff0c\u5982\u679c\u53d1\u751f\u56de\u6eda\u5c31\u6267\u884c\u9006\u64cd\u4f5c\uff1b redo log\u4fdd\u8bc1\u4e86\u4e8b\u52a1\u7684\u6301\u4e45\u6027\uff0cundo log\u4fdd\u8bc1\u4e86\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u548c\u4e00\u81f4\u6027 \u9762\u8bd5\u5b98 \uff1a\u4e8b\u52a1\u4e2d\u7684\u9694\u79bb\u6027\u662f\u5982\u4f55\u4fdd\u8bc1\u7684\u5462\uff1f(\u4f60\u89e3\u91ca\u4e00\u4e0bMVCC) \u5019\u9009\u4eba \uff1a\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u662f\u7531\u9501\u548cmvcc\u5b9e\u73b0\u7684\u3002 \u5176\u4e2dmvcc\u7684\u610f\u601d\u662f\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\u3002\u6307\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u7684\u591a\u4e2a\u7248\u672c\uff0c\u4f7f\u5f97\u8bfb\u5199\u64cd\u4f5c\u6ca1\u6709\u51b2\u7a81\uff0c\u5b83\u7684\u5e95\u5c42\u5b9e\u73b0\u4e3b\u8981\u662f\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff0c\u7b2c\u4e00\u4e2a\u662f\u9690\u85cf\u5b57\u6bb5\uff0c\u7b2c\u4e8c\u4e2a\u662fundo log\u65e5\u5fd7\uff0c\u7b2c\u4e09\u4e2a\u662freadView\u8bfb\u89c6\u56fe \u9690\u85cf\u5b57\u6bb5\u662f\u6307\uff1a\u5728mysql\u4e2d\u7ed9\u6bcf\u4e2a\u8868\u90fd\u8bbe\u7f6e\u4e86\u9690\u85cf\u5b57\u6bb5\uff0c\u6709\u4e00\u4e2a\u662ftrx_id(\u4e8b\u52a1id)\uff0c\u8bb0\u5f55\u6bcf\u4e00\u6b21\u64cd\u4f5c\u7684\u4e8b\u52a1id\uff0c\u662f\u81ea\u589e\u7684\uff1b\u53e6\u4e00\u4e2a\u5b57\u6bb5\u662froll_pointer(\u56de\u6eda\u6307\u9488)\uff0c\u6307\u5411\u4e0a\u4e00\u4e2a\u7248\u672c\u7684\u4e8b\u52a1\u7248\u672c\u8bb0\u5f55\u5730\u5740 undo log\u4e3b\u8981\u7684\u4f5c\u7528\u662f\u8bb0\u5f55\u56de\u6eda\u65e5\u5fd7\uff0c\u5b58\u50a8\u8001\u7248\u672c\u6570\u636e\uff0c\u5728\u5185\u90e8\u4f1a\u5f62\u6210\u4e00\u4e2a\u7248\u672c\u94fe\uff0c\u5728\u591a\u4e2a\u4e8b\u52a1\u5e76\u884c\u64cd\u4f5c\u67d0\u4e00\u884c\u8bb0\u5f55\uff0c\u8bb0\u5f55\u4e0d\u540c\u4e8b\u52a1\u4fee\u6539\u6570\u636e\u7684\u7248\u672c\uff0c\u901a\u8fc7roll_pointer\u6307\u9488\u5f62\u6210\u4e00\u4e2a\u94fe\u8868 readView\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u4e8b\u52a1\u67e5\u8be2\u9009\u62e9\u7248\u672c\u7684\u95ee\u9898\uff0c\u5728\u5185\u90e8\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5339\u914d\u89c4\u5219\u548c\u5f53\u524d\u7684\u4e00\u4e9b\u4e8b\u52a1id\u5224\u65ad\u8be5\u8bbf\u95ee\u90a3\u4e2a\u7248\u672c\u7684\u6570\u636e\uff0c\u4e0d\u540c\u7684\u9694\u79bb\u7ea7\u522b\u5feb\u7167\u8bfb\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6700\u7ec8\u7684\u8bbf\u95ee\u7684\u7ed3\u679c\u4e0d\u4e00\u6837\u3002\u5982\u679c\u662frc\u9694\u79bb\u7ea7\u522b\uff0c\u6bcf\u4e00\u6b21\u6267\u884c\u5feb\u7167\u8bfb\u65f6\u751f\u6210ReadView\uff0c\u5982\u679c\u662frr\u9694\u79bb\u7ea7\u522b\u4ec5\u5728\u4e8b\u52a1\u4e2d\u7b2c\u4e00\u6b21\u6267\u884c\u5feb\u7167\u8bfb\u65f6\u751f\u6210ReadView\uff0c\u540e\u7eed\u590d\u7528 \u9762\u8bd5\u5b98 \uff1aMySQL\u4e3b\u4ece\u540c\u6b65\u539f\u7406 \u5019\u9009\u4eba \uff1aMySQL\u4e3b\u4ece\u590d\u5236\u7684\u6838\u5fc3\u5c31\u662f\u4e8c\u8fdb\u5236\u65e5\u5fd7(DDL\uff08\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff09\u8bed\u53e5\u548c DML\uff08\u6570\u636e\u64cd\u7eb5\u8bed\u8a00\uff09\u8bed\u53e5)\uff0c\u5b83\u7684\u6b65\u9aa4\u662f\u8fd9\u6837\u7684\uff1a \u7b2c\u4e00\uff1a\u4e3b\u5e93\u5728\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4f1a\u628a\u6570\u636e\u53d8\u66f4\u8bb0\u5f55\u5728\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6 Binlog \u4e2d\u3002 \u7b2c\u4e8c\uff1a\u4ece\u5e93\u8bfb\u53d6\u4e3b\u5e93\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6 Binlog \uff0c\u5199\u5165\u5230\u4ece\u5e93\u7684\u4e2d\u7ee7\u65e5\u5fd7 Relay Log \u3002 \u7b2c\u4e09\uff1a\u4ece\u5e93\u91cd\u505a\u4e2d\u7ee7\u65e5\u5fd7\u4e2d\u7684\u4e8b\u4ef6\uff0c\u5c06\u6539\u53d8\u53cd\u6620\u5b83\u81ea\u5df1\u7684\u6570\u636e \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u9879\u76ee\u7528\u8fc7MySQL\u7684\u5206\u5e93\u5206\u8868\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u56e0\u4e3a\u6211\u4eec\u90fd\u662f\u5fae\u670d\u52a1\u5f00\u53d1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u5bf9\u5e94\u4e86\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u662f\u6839\u636e\u4e1a\u52a1\u8fdb\u884c\u62c6\u5206\u7684\uff0c\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f\u5782\u76f4\u62c6\u5206\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u4e4b\u524d\u4f7f\u7528\u8fc7\u6c34\u5e73\u5206\u5e93\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u662f\u4f7f\u7528\u8fc7\u7684\uff0c\u6211\u4eec\u5f53\u65f6\u7684\u4e1a\u52a1\u662f(xxx)\uff0c\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u4e5f\u662f\u5355\u5e93\uff0c\u540e\u6765\u8fd9\u4e2a\u4e1a\u52a1\u9010\u6e10\u53d1\u5c55\uff0c\u4e1a\u52a1\u91cf\u4e0a\u6765\u7684\u5f88\u8fc5\u901f\uff0c\u5176\u4e2d(xx)\u8868\u5df2\u7ecf\u5b58\u653e\u4e86\u8d85\u8fc71000\u4e07\u7684\u6570\u636e\uff0c\u6211\u4eec\u505a\u4e86\u5f88\u591a\u4f18\u5316\u4e5f\u4e0d\u597d\u4f7f\uff0c\u6027\u80fd\u4f9d\u7136\u5f88\u6162\uff0c\u6240\u4ee5\u5f53\u65f6\u5c31\u4f7f\u7528\u4e86\u6c34\u5e73\u5206\u5e93\u3002 \u6211\u4eec\u4e00\u5f00\u59cb\u5148\u505a\u4e863\u53f0\u670d\u52a1\u5668\u5bf9\u5e94\u4e863\u4e2a\u6570\u636e\u5e93\uff0c\u7531\u4e8e\u5e93\u591a\u4e86\uff0c\u9700\u8981\u5206\u7247\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684mycat\u6765\u4f5c\u4e3a\u6570\u636e\u5e93\u7684\u4e2d\u95f4\u4ef6\u3002\u6570\u636e\u90fd\u662f\u6309\u7167id\uff08\u81ea\u589e\uff09\u53d6\u6a21\u7684\u65b9\u5f0f\u6765\u5b58\u53d6\u7684\u3002 \u5f53\u7136\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u90a3\u4e9b\u65e7\u6570\u636e\uff0c\u6211\u4eec\u505a\u4e86\u4e00\u4e9b\u6e05\u6d17\u7684\u5de5\u4f5c\uff0c\u6211\u4eec\u4e5f\u662f\u6309\u7167id\u53d6\u6a21\u89c4\u5219\u5206\u522b\u5b58\u50a8\u5230\u4e86\u5404\u4e2a\u6570\u636e\u5e93\u4e2d\uff0c\u597d\u5904\u5c31\u662f\u53ef\u4ee5\u8ba9\u5404\u4e2a\u6570\u636e\u5e93\u5206\u644a\u5b58\u50a8\u548c\u8bfb\u53d6\u7684\u538b\u529b\uff0c\u89e3\u51b3\u4e86\u6211\u4eec\u5f53\u65f6\u6027\u80fd\u7684\u95ee\u9898","title":"MySQL\u9762\u8bd5\u9898 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/03-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AF%87/MySQL%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#mysql-","text":"\u9762\u8bd5\u5b98\uff1a MySQL\u4e2d\uff0c\u5982\u4f55\u5b9a\u4f4d\u6162\u67e5\u8be2? \u5019\u9009\u4eba\uff1a \u55ef~\uff0c\u6211\u4eec\u5f53\u65f6\u505a\u538b\u6d4b\u7684\u65f6\u5019\u6709\u7684\u63a5\u53e3\u975e\u5e38\u7684\u6162\uff0c\u63a5\u53e3\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc7\u4e862\u79d2\u4ee5\u4e0a\uff0c\u56e0\u4e3a\u6211\u4eec\u5f53\u65f6\u7684\u7cfb\u7edf\u90e8\u7f72\u4e86\u8fd0\u7ef4\u7684\u76d1\u63a7\u7cfb\u7edfSkywalking \uff0c\u5728\u5c55\u793a\u7684\u62a5\u8868\u4e2d\u53ef\u4ee5\u770b\u5230\u662f\u54ea\u4e00\u4e2a\u63a5\u53e3\u6bd4\u8f83\u6162\uff0c\u5e76\u4e14\u53ef\u4ee5\u5206\u6790\u8fd9\u4e2a\u63a5\u53e3\u54ea\u90e8\u5206\u6bd4\u8f83\u6162\uff0c\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230SQL\u7684\u5177\u4f53\u7684\u6267\u884c\u65f6\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u5b9a\u4f4d\u662f\u54ea\u4e2asql\u51fa\u4e86\u95ee\u9898 \u5982\u679c\uff0c\u9879\u76ee\u4e2d\u6ca1\u6709\u8fd9\u79cd\u8fd0\u7ef4\u7684\u76d1\u63a7\u7cfb\u7edf\uff0c\u5176\u5b9e\u5728MySQL\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u6162\u65e5\u5fd7\u67e5\u8be2\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5728MySQL\u7684\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u8fd9\u4e2a\u6162\u65e5\u5fd7\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u8bbe\u7f6eSQL\u6267\u884c\u8d85\u8fc7\u591a\u5c11\u65f6\u95f4\u6765\u8bb0\u5f55\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u6211\u8bb0\u5f97\u4e0a\u4e00\u4e2a\u9879\u76ee\u914d\u7f6e\u7684\u662f2\u79d2\uff0c\u53ea\u8981SQL\u6267\u884c\u7684\u65f6\u95f4\u8d85\u8fc7\u4e862\u79d2\u5c31\u4f1a\u8bb0\u5f55\u5230\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u65e5\u5fd7\u6587\u4ef6\u627e\u5230\u6267\u884c\u6bd4\u8f83\u6162\u7684SQL\u4e86\u3002 \u9762\u8bd5\u5b98\uff1a \u90a3\u8fd9\u4e2aSQL\u8bed\u53e5\u6267\u884c\u5f88\u6162, \u5982\u4f55\u5206\u6790\u5462\uff1f \u5019\u9009\u4eba\uff1a \u5982\u679c\u4e00\u6761sql\u6267\u884c\u5f88\u6162\u7684\u8bdd\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u4f7f\u7528mysql\u81ea\u52a8\u7684\u6267\u884c\u8ba1\u5212explain\u6765\u53bb\u67e5\u770b\u8fd9\u6761sql\u7684\u6267\u884c\u60c5\u51b5\uff0c\u6bd4\u5982\u5728\u8fd9\u91cc\u9762\u53ef\u4ee5\u901a\u8fc7key\u548ckey_len\u68c0\u67e5\u662f\u5426\u547d\u4e2d\u4e86\u7d22\u5f15\uff0c\u5982\u679c\u672c\u8eab\u5df2\u7ecf\u6dfb\u52a0\u4e86\u7d22\u5f15\uff0c\u4e5f\u53ef\u4ee5\u5224\u65ad\u7d22\u5f15\u662f\u5426\u6709\u5931\u6548\u7684\u60c5\u51b5\uff0c\u7b2c\u4e8c\u4e2a\uff0c\u53ef\u4ee5\u901a\u8fc7type\u5b57\u6bb5\u67e5\u770bsql\u662f\u5426\u6709\u8fdb\u4e00\u6b65\u7684\u4f18\u5316\u7a7a\u95f4\uff0c\u662f\u5426\u5b58\u5728\u5168\u7d22\u5f15\u626b\u63cf\u6216\u5168\u76d8\u626b\u63cf\uff0c\u7b2c\u4e09\u4e2a\u53ef\u4ee5\u901a\u8fc7extra\u5efa\u8bae\u6765\u5224\u65ad\uff0c\u662f\u5426\u51fa\u73b0\u4e86\u56de\u8868\u7684\u60c5\u51b5\uff0c\u5982\u679c\u51fa\u73b0\u4e86\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u6dfb\u52a0\u7d22\u5f15\u6216\u4fee\u6539\u8fd4\u56de\u5b57\u6bb5\u6765\u4fee\u590d \u9762\u8bd5\u5b98\uff1a \u4e86\u89e3\u8fc7\u7d22\u5f15\u5417\uff1f\uff08\u4ec0\u4e48\u662f\u7d22\u5f15\uff09 \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u7d22\u5f15\u5728\u9879\u76ee\u4e2d\u8fd8\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\uff0c\u5b83\u662f\u5e2e\u52a9MySQL\u9ad8\u6548\u83b7\u53d6\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e3b\u8981\u662f\u7528\u6765\u63d0\u9ad8\u6570\u636e\u68c0\u7d22\u7684\u6548\u7387\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u7684IO\u6210\u672c\uff0c\u540c\u65f6\u901a\u8fc7\u7d22\u5f15\u5217\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u964d\u4f4e\u6570\u636e\u6392\u5e8f\u7684\u6210\u672c\uff0c\u4e5f\u80fd\u964d\u4f4e\u4e86CPU\u7684\u6d88\u8017 \u9762\u8bd5\u5b98\uff1a \u7d22\u5f15\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u4e86\u89e3\u8fc7\u561b ? \u5019\u9009\u4eba\uff1a MySQL\u7684\u9ed8\u8ba4\u7684\u5b58\u50a8\u5f15\u64ceInnoDB\u91c7\u7528\u7684B+\u6811\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u50a8\u7d22\u5f15\uff0c\u9009\u62e9B+\u6811\u7684\u4e3b\u8981\u7684\u539f\u56e0\u662f\uff1a\u7b2c\u4e00\u9636\u6570\u66f4\u591a\uff0c\u8def\u5f84\u66f4\u77ed\uff0c\u7b2c\u4e8c\u4e2a\u78c1\u76d8\u8bfb\u5199\u4ee3\u4ef7B+\u6811\u66f4\u4f4e\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u53ea\u5b58\u50a8\u6307\u9488\uff0c\u53f6\u5b50\u9636\u6bb5\u5b58\u50a8\u6570\u636e\uff0c\u7b2c\u4e09\u662fB+\u6811\u4fbf\u4e8e\u626b\u5e93\u548c\u533a\u95f4\u67e5\u8be2\uff0c\u53f6\u5b50\u8282\u70b9\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868 \u9762\u8bd5\u5b98\uff1a B\u6811\u548cB+\u6811\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5462\uff1f \u5019\u9009\u4eba \uff1a\u7b2c\u4e00\uff1a\u5728B\u6811\u4e2d\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u548c\u53f6\u5b50\u8282\u70b9\u90fd\u4f1a\u5b58\u653e\u6570\u636e\uff0c\u800cB+\u6811\u7684\u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u51fa\u73b0\u5728\u53f6\u5b50\u8282\u70b9\uff0c\u5728\u67e5\u8be2\u7684\u65f6\u5019\uff0cB+\u6811\u67e5\u627e\u6548\u7387\u66f4\u52a0\u7a33\u5b9a \u7b2c\u4e8c\uff1a\u5728\u8fdb\u884c\u8303\u56f4\u67e5\u8be2\u7684\u65f6\u5019\uff0cB+\u6811\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3aB+\u6811\u90fd\u5728\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\uff0c\u5e76\u4e14\u53f6\u5b50\u8282\u70b9\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u662f\u805a\u7c07\u7d22\u5f15\u4ec0\u4e48\u662f\u975e\u805a\u7c07\u7d22\u5f15 ? \u5019\u9009\u4eba\uff1a \u597d\u7684~\uff0c\u805a\u7c07\u7d22\u5f15\u4e3b\u8981\u662f\u6307\u6570\u636e\u4e0e\u7d22\u5f15\u653e\u5230\u4e00\u5757\uff0cB+\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58\u4e86\u6574\u884c\u6570\u636e\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3b\u952e\u5728\u4f5c\u4e3a\u805a\u7c07\u7d22\u5f15\u7684 \u975e\u805a\u7c07\u7d22\u5f15\u503c\u7684\u662f\u6570\u636e\u4e0e\u7d22\u5f15\u5206\u5f00\u5b58\u50a8\uff0cB+\u6811\u7684\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58\u5bf9\u5e94\u7684\u4e3b\u952e\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u4e00\u822c\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684\u7d22\u5f15\u90fd\u662f\u975e\u805a\u7c07\u7d22\u5f15 \u9762\u8bd5\u5b98\uff1a \u77e5\u9053\u4ec0\u4e48\u662f\u56de\u8868\u67e5\u8be2\u561b ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u5176\u5b9e\u8ddf\u521a\u624d\u4ecb\u7ecd\u7684\u805a\u7c07\u7d22\u5f15\u548c\u975e\u805a\u7c07\u7d22\u5f15\u662f\u6709\u5173\u7cfb\u7684\uff0c\u56de\u8868\u7684\u610f\u601d\u5c31\u662f\u901a\u8fc7\u4e8c\u7ea7\u7d22\u5f15\u627e\u5230\u5bf9\u5e94\u7684\u4e3b\u952e\u503c\uff0c\u7136\u540e\u518d\u901a\u8fc7\u4e3b\u952e\u503c\u627e\u5230\u805a\u96c6\u7d22\u5f15\u4e2d\u6240\u5bf9\u5e94\u7684\u6574\u884c\u6570\u636e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u56de\u8868 \u3010 \u5907\u6ce8 \uff1a\u5982\u679c\u9762\u8bd5\u5b98\u76f4\u63a5\u95ee\u56de\u8868\uff0c\u5219\u9700\u8981\u5148\u4ecb\u7ecd\u805a\u7c07\u7d22\u5f15\u548c\u975e\u805a\u7c07\u7d22\u5f15\u3011 \u9762\u8bd5\u5b98\uff1a \u77e5\u9053\u4ec0\u4e48\u53eb\u8986\u76d6\u7d22\u5f15\u561b ? \u5019\u9009\u4eba\uff1a \u55ef~\uff0c\u6e05\u695a\u7684 \u8986\u76d6\u7d22\u5f15\u662f\u6307select\u67e5\u8be2\u8bed\u53e5\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u5728\u8fd4\u56de\u7684\u5217\uff0c\u5fc5\u987b\u5728\u7d22\u5f15\u4e2d\u5168\u90e8\u80fd\u591f\u627e\u5230\uff0c\u5982\u679c\u6211\u4eec\u4f7f\u7528id\u67e5\u8be2\uff0c\u5b83\u4f1a\u76f4\u63a5\u8d70\u805a\u96c6\u7d22\u5f15\u67e5\u8be2\uff0c\u4e00\u6b21\u7d22\u5f15\u626b\u63cf\uff0c\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff0c\u6027\u80fd\u9ad8\u3002 \u5982\u679c\u6309\u7167\u4e8c\u7ea7\u7d22\u5f15\u67e5\u8be2\u6570\u636e\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u5217\u4e2d\u6ca1\u6709\u521b\u5efa\u7d22\u5f15\uff0c\u6709\u53ef\u80fd\u4f1a\u89e6\u53d1\u56de\u8868\u67e5\u8be2\uff0c\u5c3d\u91cf\u907f\u514d\u4f7f\u7528select *\uff0c\u5c3d\u91cf\u5728\u8fd4\u56de\u7684\u5217\u4e2d\u90fd\u5305\u542b\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5 \u9762\u8bd5\u5b98\uff1a MYSQL\u8d85\u5927\u5206\u9875\u600e\u4e48\u5904\u7406 ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8d85\u5927\u5206\u9875\u4e00\u822c\u90fd\u662f\u5728\u6570\u636e\u91cf\u6bd4\u8f83\u5927\u65f6\uff0c\u6211\u4eec\u4f7f\u7528\u4e86limit\u5206\u9875\u67e5\u8be2\uff0c\u5e76\u4e14\u9700\u8981\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u4e2a\u65f6\u5019\u6548\u7387\u5c31\u5f88\u4f4e\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u8986\u76d6\u7d22\u5f15\u548c\u5b50\u67e5\u8be2\u6765\u89e3\u51b3 \u5148\u5206\u9875\u67e5\u8be2\u6570\u636e\u7684id\u5b57\u6bb5\uff0c\u786e\u5b9a\u4e86id\u4e4b\u540e\uff0c\u518d\u7528\u5b50\u67e5\u8be2\u6765\u8fc7\u6ee4\uff0c\u53ea\u67e5\u8be2\u8fd9\u4e2aid\u5217\u8868\u4e2d\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u4e86 \u56e0\u4e3a\u67e5\u8be2id\u7684\u65f6\u5019\uff0c\u8d70\u7684\u8986\u76d6\u7d22\u5f15\uff0c\u6240\u4ee5\u6548\u7387\u53ef\u4ee5\u63d0\u5347\u5f88\u591a \u9762\u8bd5\u5b98\uff1a \u7d22\u5f15\u521b\u5efa\u539f\u5219\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u60c5\u51b5\u6709\u5f88\u591a\uff0c\u4e0d\u8fc7\u90fd\u6709\u4e00\u4e2a\u5927\u524d\u63d0\uff0c\u5c31\u662f\u8868\u4e2d\u7684\u6570\u636e\u8981\u8d85\u8fc710\u4e07\u4ee5\u4e0a\uff0c\u6211\u4eec\u624d\u4f1a\u521b\u5efa\u7d22\u5f15\uff0c\u5e76\u4e14\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5\u662f\u67e5\u8be2\u6bd4\u8f83\u9891\u7e41\u7684\u5b57\u6bb5\uff0c\u4e00\u822c\u4e5f\u662f\u50cf\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\uff0c\u6392\u5e8f\u5b57\u6bb5\u6216\u5206\u7ec4\u7684\u5b57\u6bb5\u8fd9\u4e9b\u3002 \u8fd8\u6709\u5c31\u662f\uff0c\u6211\u4eec\u901a\u5e38\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\u90fd\u662f\u4f7f\u7528\u590d\u5408\u7d22\u5f15\u6765\u521b\u5efa\uff0c\u4e00\u6761sql\u7684\u8fd4\u56de\u503c\uff0c\u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff0c\u5982\u679c\u5b57\u6bb5\u7684\u533a\u5206\u5ea6\u4e0d\u9ad8\u7684\u8bdd\uff0c\u6211\u4eec\u4e5f\u4f1a\u628a\u5b83\u653e\u5728\u7ec4\u5408\u7d22\u5f15\u540e\u9762\u7684\u5b57\u6bb5\u3002 \u5982\u679c\u67d0\u4e00\u4e2a\u5b57\u6bb5\u7684\u5185\u5bb9\u8f83\u957f\uff0c\u6211\u4eec\u4f1a\u8003\u8651\u4f7f\u7528\u524d\u7f00\u7d22\u5f15\u6765\u4f7f\u7528\uff0c\u5f53\u7136\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5b57\u6bb5\u90fd\u8981\u6dfb\u52a0\u7d22\u5f15\uff0c\u8fd9\u4e2a\u7d22\u5f15\u7684\u6570\u91cf\u4e5f\u8981\u63a7\u5236\uff0c\u56e0\u4e3a\u6dfb\u52a0\u7d22\u5f15\u4e5f\u4f1a\u5bfc\u81f4\u65b0\u589e\u6539\u7684\u901f\u5ea6\u53d8\u6162\u3002 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u60c5\u51b5\u4e0b\u7d22\u5f15\u4f1a\u5931\u6548 ? \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u60c5\u51b5\u6bd4\u8f83\u591a\uff0c\u6211\u8bf4\u4e00\u4e9b\u81ea\u5df1\u7684\u7ecf\u9a8c\uff0c\u4ee5\u524d\u9047\u5230\u8fc7\u7684 \u6bd4\u5982\uff0c\u7d22\u5f15\u5728\u4f7f\u7528\u7684\u65f6\u5019\u6ca1\u6709\u9075\u5faa\u6700\u5de6\u5339\u914d\u6cd5\u5219\uff0c\u7b2c\u4e8c\u4e2a\u662f\uff0c\u6a21\u7cca\u67e5\u8be2\uff0c\u5982\u679c%\u53f7\u5728\u524d\u9762\u4e5f\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u3002\u5982\u679c\u5728\u6dfb\u52a0\u7d22\u5f15\u7684\u5b57\u6bb5\u4e0a\u8fdb\u884c\u4e86\u8fd0\u7b97\u64cd\u4f5c\u6216\u8005\u7c7b\u578b\u8f6c\u6362\u4e5f\u90fd\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u3002 \u6211\u4eec\u4e4b\u524d\u8fd8\u9047\u5230\u8fc7\u4e00\u4e2a\u5c31\u662f\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u590d\u5408\u7d22\u5f15\uff0c\u4e2d\u95f4\u4f7f\u7528\u4e86\u8303\u56f4\u67e5\u8be2\uff0c\u53f3\u8fb9\u7684\u6761\u4ef6\u7d22\u5f15\u4e5f\u4f1a\u5931\u6548 \u6240\u4ee5\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u60f3\u8981\u5224\u65ad\u51fa\u8fd9\u6761sql\u662f\u5426\u6709\u7d22\u5f15\u5931\u6548\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528explain\u6267\u884c\u8ba1\u5212\u6765\u5206\u6790 \u9762\u8bd5\u5b98\uff1a sql\u7684\u4f18\u5316\u7684\u7ecf\u9a8c \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u5728\u9879\u76ee\u8fd8\u662f\u633a\u5e38\u89c1\u7684\uff0c\u5f53\u7136\u5982\u679c\u76f4\u8bf4sql\u4f18\u5316\u7684\u8bdd\uff0c\u6211\u4eec\u4f1a\u4ece\u8fd9\u51e0\u65b9\u9762\u8003\u8651\uff0c\u6bd4\u5982 \u5efa\u8868\u7684\u65f6\u5019\u3001\u4f7f\u7528\u7d22\u5f15\u3001sql\u8bed\u53e5\u7684\u7f16\u5199\u3001\u4e3b\u4ece\u590d\u5236\uff0c\u8bfb\u5199\u5206\u79bb\uff0c\u8fd8\u6709\u4e00\u4e2a\u662f\u5982\u679c\u91cf\u6bd4\u8f83\u5927\u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u5206\u5e93\u5206\u8868 \u9762\u8bd5\u5b98\uff1a \u521b\u5efa\u8868\u7684\u65f6\u5019\uff0c\u4f60\u4eec\u662f\u5982\u4f55\u4f18\u5316\u7684\u5462\uff1f \u5019\u9009\u4eba\uff1a \u8fd9\u4e2a\u6211\u4eec\u4e3b\u8981\u53c2\u8003\u7684\u963f\u91cc\u51fa\u7684\u90a3\u4e2a\u5f00\u53d1\u624b\u518c\u300a\u5d69\u5c71\u7248\u300b\uff0c\u5c31\u6bd4\u5982\uff0c\u5728\u5b9a\u4e49\u5b57\u6bb5\u7684\u65f6\u5019\u9700\u8981\u7ed3\u5408\u5b57\u6bb5\u7684\u5185\u5bb9\u6765\u9009\u62e9\u5408\u9002\u7684\u7c7b\u578b\uff0c\u5982\u679c\u662f\u6570\u503c\u7684\u8bdd\uff0c\u50cftinyint\u3001int \u3001bigint\u8fd9\u4e9b\u7c7b\u578b\uff0c\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u62e9\u3002\u5982\u679c\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u4e5f\u662f\u7ed3\u5408\u5b58\u50a8\u7684\u5185\u5bb9\u6765\u9009\u62e9char\u548cvarchar\u6216\u8005text\u7c7b\u578b \u9762\u8bd5\u5b98\uff1a \u90a3\u5728\u4f7f\u7528\u7d22\u5f15\u7684\u65f6\u5019\uff0c\u662f\u5982\u4f55\u4f18\u5316\u5462\uff1f \u5019\u9009\u4eba\uff1a \u3010\u53c2\u8003\u7d22\u5f15\u521b\u5efa\u539f\u5219 \u8fdb\u884c\u63cf\u8ff0\u3011 \u9762\u8bd5\u5b98\uff1a \u4f60\u5e73\u65f6\u5bf9sql\u8bed\u53e5\u505a\u4e86\u54ea\u4e9b\u4f18\u5316\u5462\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u6709\u5f88\u591a\uff0c\u6bd4\u5982SELECT\u8bed\u53e5\u52a1\u5fc5\u6307\u660e\u5b57\u6bb5\u540d\u79f0\uff0c\u4e0d\u8981\u76f4\u63a5\u4f7f\u7528select * \uff0c\u8fd8\u6709\u5c31\u662f\u8981\u6ce8\u610fSQL\u8bed\u53e5\u907f\u514d\u9020\u6210\u7d22\u5f15\u5931\u6548\u7684\u5199\u6cd5\uff1b\u5982\u679c\u662f\u805a\u5408\u67e5\u8be2\uff0c\u5c3d\u91cf\u7528union all\u4ee3\u66ffunion \uff0cunion\u4f1a\u591a\u4e00\u6b21\u8fc7\u6ee4\uff0c\u6548\u7387\u6bd4\u8f83\u4f4e\uff1b\u5982\u679c\u662f\u8868\u5173\u8054\u7684\u8bdd\uff0c\u5c3d\u91cf\u4f7f\u7528innerjoin \uff0c\u4e0d\u8981\u4f7f\u7528\u7528left join right join\uff0c\u5982\u5fc5\u987b\u4f7f\u7528 \u4e00\u5b9a\u8981\u4ee5\u5c0f\u8868\u4e3a\u9a71\u52a8 \u9762\u8bd5\u5b98\uff1a \u4e8b\u52a1\u7684\u7279\u6027\u662f\u4ec0\u4e48\uff1f\u53ef\u4ee5\u8be6\u7ec6\u8bf4\u4e00\u4e0b\u5417\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u6e05\u695a\uff0cACID\uff0c\u5206\u522b\u6307\u7684\u662f\uff1a\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u3001\u9694\u79bb\u6027\u3001\u6301\u4e45\u6027\uff1b\u6211\u4e3e\u4e2a\u4f8b\u5b50\uff1a A\u5411B\u8f6c\u8d26500\uff0c\u8f6c\u8d26\u6210\u529f\uff0cA\u6263\u9664500\u5143\uff0cB\u589e\u52a0500\u5143\uff0c\u539f\u5b50\u64cd\u4f5c\u4f53\u73b0\u5728\u8981\u4e48\u90fd\u6210\u529f\uff0c\u8981\u4e48\u90fd\u5931\u8d25 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6570\u636e\u8981\u4e00\u81f4\uff0cA\u6263\u9664\u4e86500\uff0cB\u5fc5\u987b\u589e\u52a0500 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9694\u79bb\u6027\u4f53\u73b0\u5728A\u50cfB\u8f6c\u8d26\uff0c\u4e0d\u80fd\u53d7\u5176\u4ed6\u4e8b\u52a1\u5e72\u6270 \u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6301\u4e45\u6027\u4f53\u73b0\u5728\u4e8b\u52a1\u63d0\u4ea4\u540e\uff0c\u8981\u628a\u6570\u636e\u6301\u4e45\u5316\uff08\u53ef\u4ee5\u8bf4\u662f\u843d\u76d8\u64cd\u4f5c\uff09 \u9762\u8bd5\u5b98 \uff1a\u5e76\u53d1\u4e8b\u52a1\u5e26\u6765\u54ea\u4e9b\u95ee\u9898\uff1f \u5019\u9009\u4eba \uff1a \u6211\u4eec\u5728\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u8fdb\u884c\u662f\u7ecf\u5e38\u53d1\u751f\u7684\uff0c\u5e76\u53d1\u4e5f\u662f\u5fc5\u7136\u7684\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u4e00\u4e9b\u95ee\u9898 \u7b2c\u4e00\u662f\u810f\u8bfb\uff0c \u5f53\u4e00\u4e2a\u4e8b\u52a1\u6b63\u5728\u8bbf\u95ee\u6570\u636e\u5e76\u4e14\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u65f6\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6570\u636e\u662f\u8fd8\u6ca1\u6709\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u90a3\u4e48\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u5230\u7684\u8fd9\u4e2a\u6570\u636e\u662f\u201c\u810f\u6570\u636e\u201d\uff0c\u4f9d\u636e\u201c\u810f\u6570\u636e\u201d\u6240\u505a\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u4e0d\u6b63\u786e\u7684\u3002 \u7b2c\u4e8c\u662f\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u6bd4\u5982\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u591a\u6b21\u8bfb\u540c\u4e00\u6570\u636e\u3002\u5728\u8fd9\u4e2a\u4e8b\u52a1\u8fd8\u6ca1\u6709\u7ed3\u675f\u65f6\uff0c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u8be5\u6570\u636e\u3002\u90a3\u4e48\uff0c\u5728\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u4e24\u6b21\u8bfb\u6570\u636e\u4e4b\u95f4\uff0c\u7531\u4e8e\u7b2c\u4e8c\u4e2a\u4e8b\u52a1\u7684\u4fee\u6539\u5bfc\u81f4\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u4e24\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u592a\u4e00\u6837\u3002\u8fd9\u5c31\u53d1\u751f\u4e86\u5728\u4e00\u4e2a\u4e8b\u52a1\u5185\u4e24\u6b21\u8bfb\u5230\u7684\u6570\u636e\u662f\u4e0d\u4e00\u6837\u7684\u60c5\u51b5\uff0c\u56e0\u6b64\u79f0\u4e3a\u4e0d\u53ef\u91cd\u590d\u8bfb\u3002 \u7b2c\u4e09\u662f\u5e7b\u8bfb\uff08Phantom read\uff09\uff1a\u5e7b\u8bfb\u4e0e\u4e0d\u53ef\u91cd\u590d\u8bfb\u7c7b\u4f3c\u3002\u5b83\u53d1\u751f\u5728\u4e00\u4e2a\u4e8b\u52a1\uff08T1\uff09\u8bfb\u53d6\u4e86\u51e0\u884c\u6570\u636e\uff0c\u63a5\u7740\u53e6\u4e00\u4e2a\u5e76\u53d1\u4e8b\u52a1\uff08T2\uff09\u63d2\u5165\u4e86\u4e00\u4e9b\u6570\u636e\u65f6\u3002\u5728\u968f\u540e\u7684\u67e5\u8be2\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u4e8b\u52a1\uff08T1\uff09\u5c31\u4f1a\u53d1\u73b0\u591a\u4e86\u4e00\u4e9b\u539f\u672c\u4e0d\u5b58\u5728\u7684\u8bb0\u5f55\uff0c\u5c31\u597d\u50cf\u53d1\u751f\u4e86\u5e7b\u89c9\u4e00\u6837\uff0c\u6240\u4ee5\u79f0\u4e3a\u5e7b\u8bfb\u3002 \u9762\u8bd5\u5b98 \uff1a\u600e\u4e48\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u5462\uff1fMySQL\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u662f\uff1f \u5019\u9009\u4eba \uff1a\u89e3\u51b3\u65b9\u6848\u662f\u5bf9\u4e8b\u52a1\u8fdb\u884c\u9694\u79bb MySQL\u652f\u6301\u56db\u79cd\u9694\u79bb\u7ea7\u522b\uff0c\u5206\u522b\u6709\uff1a \u7b2c\u4e00\u4e2a\u662f\uff0c\u672a\u63d0\u4ea4\u8bfb\uff08read uncommitted\uff09\u5b83\u89e3\u51b3\u4e0d\u4e86\u521a\u624d\u63d0\u51fa\u7684\u6240\u6709\u95ee\u9898\uff0c\u4e00\u822c\u9879\u76ee\u4e2d\u4e5f\u4e0d\u7528\u8fd9\u4e2a\u3002\u7b2c\u4e8c\u4e2a\u662f\u8bfb\u5df2\u63d0\u4ea4\uff08read committed\uff09\u5b83\u80fd\u89e3\u51b3\u810f\u8bfb\u7684\u95ee\u9898\u7684\uff0c\u4f46\u662f\u89e3\u51b3\u4e0d\u4e86\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u3002\u7b2c\u4e09\u4e2a\u662f\u53ef\u91cd\u590d\u8bfb\uff08repeatable read\uff09\u5b83\u80fd\u89e3\u51b3\u810f\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u4f46\u662f\u89e3\u51b3\u4e0d\u4e86\u5e7b\u8bfb\uff0c\u8fd9\u4e2a\u4e5f\u662fmysql\u9ed8\u8ba4\u7684\u9694\u79bb\u7ea7\u522b\u3002\u7b2c\u56db\u4e2a\u662f\u4e32\u884c\u5316\uff08serializable\uff09\u5b83\u53ef\u4ee5\u89e3\u51b3\u521a\u624d\u63d0\u51fa\u6765\u7684\u6240\u6709\u95ee\u9898\uff0c\u4f46\u662f\u7531\u4e8e\u8ba9\u662f\u4e8b\u52a1\u4e32\u884c\u6267\u884c\u7684\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u7684\u90fd\u662fmysql\u9ed8\u8ba4\u7684\u9694\u79bb\u7ea7\u522b:\u53ef\u91cd\u590d\u8bfb \u9762\u8bd5\u5b98 \uff1aundo log\u548credo log\u7684\u533a\u522b \u5019\u9009\u4eba \uff1a\u597d\u7684\uff0c\u5176\u4e2dredo log\u65e5\u5fd7\u8bb0\u5f55\u7684\u662f\u6570\u636e\u9875\u7684\u7269\u7406\u53d8\u5316\uff0c\u670d\u52a1\u5b95\u673a\u53ef\u7528\u6765\u540c\u6b65\u6570\u636e\uff0c\u800cundo log \u4e0d\u540c\uff0c\u5b83\u4e3b\u8981\u8bb0\u5f55\u7684\u662f\u903b\u8f91\u65e5\u5fd7\uff0c\u5f53\u4e8b\u52a1\u56de\u6eda\u65f6\uff0c\u901a\u8fc7\u9006\u64cd\u4f5c\u6062\u590d\u539f\u6765\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6211\u4eec\u5220\u9664\u4e00\u6761\u6570\u636e\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5728undo log\u65e5\u5fd7\u6587\u4ef6\u4e2d\u65b0\u589e\u4e00\u6761delete\u8bed\u53e5\uff0c\u5982\u679c\u53d1\u751f\u56de\u6eda\u5c31\u6267\u884c\u9006\u64cd\u4f5c\uff1b redo log\u4fdd\u8bc1\u4e86\u4e8b\u52a1\u7684\u6301\u4e45\u6027\uff0cundo log\u4fdd\u8bc1\u4e86\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u548c\u4e00\u81f4\u6027 \u9762\u8bd5\u5b98 \uff1a\u4e8b\u52a1\u4e2d\u7684\u9694\u79bb\u6027\u662f\u5982\u4f55\u4fdd\u8bc1\u7684\u5462\uff1f(\u4f60\u89e3\u91ca\u4e00\u4e0bMVCC) \u5019\u9009\u4eba \uff1a\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u662f\u7531\u9501\u548cmvcc\u5b9e\u73b0\u7684\u3002 \u5176\u4e2dmvcc\u7684\u610f\u601d\u662f\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\u3002\u6307\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u7684\u591a\u4e2a\u7248\u672c\uff0c\u4f7f\u5f97\u8bfb\u5199\u64cd\u4f5c\u6ca1\u6709\u51b2\u7a81\uff0c\u5b83\u7684\u5e95\u5c42\u5b9e\u73b0\u4e3b\u8981\u662f\u5206\u4e3a\u4e86\u4e09\u4e2a\u90e8\u5206\uff0c\u7b2c\u4e00\u4e2a\u662f\u9690\u85cf\u5b57\u6bb5\uff0c\u7b2c\u4e8c\u4e2a\u662fundo log\u65e5\u5fd7\uff0c\u7b2c\u4e09\u4e2a\u662freadView\u8bfb\u89c6\u56fe \u9690\u85cf\u5b57\u6bb5\u662f\u6307\uff1a\u5728mysql\u4e2d\u7ed9\u6bcf\u4e2a\u8868\u90fd\u8bbe\u7f6e\u4e86\u9690\u85cf\u5b57\u6bb5\uff0c\u6709\u4e00\u4e2a\u662ftrx_id(\u4e8b\u52a1id)\uff0c\u8bb0\u5f55\u6bcf\u4e00\u6b21\u64cd\u4f5c\u7684\u4e8b\u52a1id\uff0c\u662f\u81ea\u589e\u7684\uff1b\u53e6\u4e00\u4e2a\u5b57\u6bb5\u662froll_pointer(\u56de\u6eda\u6307\u9488)\uff0c\u6307\u5411\u4e0a\u4e00\u4e2a\u7248\u672c\u7684\u4e8b\u52a1\u7248\u672c\u8bb0\u5f55\u5730\u5740 undo log\u4e3b\u8981\u7684\u4f5c\u7528\u662f\u8bb0\u5f55\u56de\u6eda\u65e5\u5fd7\uff0c\u5b58\u50a8\u8001\u7248\u672c\u6570\u636e\uff0c\u5728\u5185\u90e8\u4f1a\u5f62\u6210\u4e00\u4e2a\u7248\u672c\u94fe\uff0c\u5728\u591a\u4e2a\u4e8b\u52a1\u5e76\u884c\u64cd\u4f5c\u67d0\u4e00\u884c\u8bb0\u5f55\uff0c\u8bb0\u5f55\u4e0d\u540c\u4e8b\u52a1\u4fee\u6539\u6570\u636e\u7684\u7248\u672c\uff0c\u901a\u8fc7roll_pointer\u6307\u9488\u5f62\u6210\u4e00\u4e2a\u94fe\u8868 readView\u89e3\u51b3\u7684\u662f\u4e00\u4e2a\u4e8b\u52a1\u67e5\u8be2\u9009\u62e9\u7248\u672c\u7684\u95ee\u9898\uff0c\u5728\u5185\u90e8\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5339\u914d\u89c4\u5219\u548c\u5f53\u524d\u7684\u4e00\u4e9b\u4e8b\u52a1id\u5224\u65ad\u8be5\u8bbf\u95ee\u90a3\u4e2a\u7248\u672c\u7684\u6570\u636e\uff0c\u4e0d\u540c\u7684\u9694\u79bb\u7ea7\u522b\u5feb\u7167\u8bfb\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6700\u7ec8\u7684\u8bbf\u95ee\u7684\u7ed3\u679c\u4e0d\u4e00\u6837\u3002\u5982\u679c\u662frc\u9694\u79bb\u7ea7\u522b\uff0c\u6bcf\u4e00\u6b21\u6267\u884c\u5feb\u7167\u8bfb\u65f6\u751f\u6210ReadView\uff0c\u5982\u679c\u662frr\u9694\u79bb\u7ea7\u522b\u4ec5\u5728\u4e8b\u52a1\u4e2d\u7b2c\u4e00\u6b21\u6267\u884c\u5feb\u7167\u8bfb\u65f6\u751f\u6210ReadView\uff0c\u540e\u7eed\u590d\u7528 \u9762\u8bd5\u5b98 \uff1aMySQL\u4e3b\u4ece\u540c\u6b65\u539f\u7406 \u5019\u9009\u4eba \uff1aMySQL\u4e3b\u4ece\u590d\u5236\u7684\u6838\u5fc3\u5c31\u662f\u4e8c\u8fdb\u5236\u65e5\u5fd7(DDL\uff08\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff09\u8bed\u53e5\u548c DML\uff08\u6570\u636e\u64cd\u7eb5\u8bed\u8a00\uff09\u8bed\u53e5)\uff0c\u5b83\u7684\u6b65\u9aa4\u662f\u8fd9\u6837\u7684\uff1a \u7b2c\u4e00\uff1a\u4e3b\u5e93\u5728\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4f1a\u628a\u6570\u636e\u53d8\u66f4\u8bb0\u5f55\u5728\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6 Binlog \u4e2d\u3002 \u7b2c\u4e8c\uff1a\u4ece\u5e93\u8bfb\u53d6\u4e3b\u5e93\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6 Binlog \uff0c\u5199\u5165\u5230\u4ece\u5e93\u7684\u4e2d\u7ee7\u65e5\u5fd7 Relay Log \u3002 \u7b2c\u4e09\uff1a\u4ece\u5e93\u91cd\u505a\u4e2d\u7ee7\u65e5\u5fd7\u4e2d\u7684\u4e8b\u4ef6\uff0c\u5c06\u6539\u53d8\u53cd\u6620\u5b83\u81ea\u5df1\u7684\u6570\u636e \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u9879\u76ee\u7528\u8fc7MySQL\u7684\u5206\u5e93\u5206\u8868\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u56e0\u4e3a\u6211\u4eec\u90fd\u662f\u5fae\u670d\u52a1\u5f00\u53d1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u5bf9\u5e94\u4e86\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u662f\u6839\u636e\u4e1a\u52a1\u8fdb\u884c\u62c6\u5206\u7684\uff0c\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f\u5782\u76f4\u62c6\u5206\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u4e4b\u524d\u4f7f\u7528\u8fc7\u6c34\u5e73\u5206\u5e93\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u662f\u4f7f\u7528\u8fc7\u7684\uff0c\u6211\u4eec\u5f53\u65f6\u7684\u4e1a\u52a1\u662f(xxx)\uff0c\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u4e5f\u662f\u5355\u5e93\uff0c\u540e\u6765\u8fd9\u4e2a\u4e1a\u52a1\u9010\u6e10\u53d1\u5c55\uff0c\u4e1a\u52a1\u91cf\u4e0a\u6765\u7684\u5f88\u8fc5\u901f\uff0c\u5176\u4e2d(xx)\u8868\u5df2\u7ecf\u5b58\u653e\u4e86\u8d85\u8fc71000\u4e07\u7684\u6570\u636e\uff0c\u6211\u4eec\u505a\u4e86\u5f88\u591a\u4f18\u5316\u4e5f\u4e0d\u597d\u4f7f\uff0c\u6027\u80fd\u4f9d\u7136\u5f88\u6162\uff0c\u6240\u4ee5\u5f53\u65f6\u5c31\u4f7f\u7528\u4e86\u6c34\u5e73\u5206\u5e93\u3002 \u6211\u4eec\u4e00\u5f00\u59cb\u5148\u505a\u4e863\u53f0\u670d\u52a1\u5668\u5bf9\u5e94\u4e863\u4e2a\u6570\u636e\u5e93\uff0c\u7531\u4e8e\u5e93\u591a\u4e86\uff0c\u9700\u8981\u5206\u7247\uff0c\u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684mycat\u6765\u4f5c\u4e3a\u6570\u636e\u5e93\u7684\u4e2d\u95f4\u4ef6\u3002\u6570\u636e\u90fd\u662f\u6309\u7167id\uff08\u81ea\u589e\uff09\u53d6\u6a21\u7684\u65b9\u5f0f\u6765\u5b58\u53d6\u7684\u3002 \u5f53\u7136\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u90a3\u4e9b\u65e7\u6570\u636e\uff0c\u6211\u4eec\u505a\u4e86\u4e00\u4e9b\u6e05\u6d17\u7684\u5de5\u4f5c\uff0c\u6211\u4eec\u4e5f\u662f\u6309\u7167id\u53d6\u6a21\u89c4\u5219\u5206\u522b\u5b58\u50a8\u5230\u4e86\u5404\u4e2a\u6570\u636e\u5e93\u4e2d\uff0c\u597d\u5904\u5c31\u662f\u53ef\u4ee5\u8ba9\u5404\u4e2a\u6570\u636e\u5e93\u5206\u644a\u5b58\u50a8\u548c\u8bfb\u53d6\u7684\u538b\u529b\uff0c\u89e3\u51b3\u4e86\u6211\u4eec\u5f53\u65f6\u6027\u80fd\u7684\u95ee\u9898","title":"MySQL\u9762\u8bd5\u9898-\u6587\u7a3f"},{"location":"heimajava/04-%E6%A1%86%E6%9E%B6%E7%AF%87/%E6%A1%86%E6%9E%B6%E7%AF%87%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/","text":"\u6846\u67b6\u7bc7\u9762\u8bd5\u9898-\u53c2\u8003\u56de\u7b54 \u9762\u8bd5\u5b98 \uff1aSpring\u6846\u67b6\u4e2d\u7684\u5355\u4f8bbean\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff01 \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u662f\u8fd9\u6837\u7684 \u5f53\u591a\u7528\u6237\u540c\u65f6\u8bf7\u6c42\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u5bb9\u5668\u4f1a\u7ed9\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u8fd9\u662f\u591a\u4e2a\u7ebf\u7a0b\u4f1a\u5e76\u53d1\u6267\u884c\u8be5\u8bf7\u6c42\u5bf9\u5e94\u7684\u4e1a\u52a1\u903b\u8f91\uff08\u6210\u5458\u65b9\u6cd5\uff09\uff0c\u5982\u679c\u8be5\u5904\u7406\u903b\u8f91\u4e2d\u6709\u5bf9\u8be5\u5355\u5217\u72b6\u6001\u7684\u4fee\u6539\uff08\u4f53\u73b0\u4e3a\u8be5\u5355\u4f8b\u7684\u6210\u5458\u5c5e\u6027\uff09\uff0c\u5219\u5fc5\u987b\u8003\u8651\u7ebf\u7a0b\u540c\u6b65\u95ee\u9898\u3002 Spring\u6846\u67b6\u5e76\u6ca1\u6709\u5bf9\u5355\u4f8bbean\u8fdb\u884c\u4efb\u4f55\u591a\u7ebf\u7a0b\u7684\u5c01\u88c5\u5904\u7406\u3002\u5173\u4e8e\u5355\u4f8bbean\u7684\u7ebf\u7a0b\u5b89\u5168\u548c\u5e76\u53d1\u95ee\u9898\u9700\u8981\u5f00\u53d1\u8005\u81ea\u884c\u53bb\u641e\u5b9a\u3002 \u6bd4\u5982\uff1a\u6211\u4eec\u901a\u5e38\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u7684Spring bean\u90fd\u662f\u4e0d\u53ef\u53ef\u53d8\u7684\u72b6\u6001(\u6bd4\u5982Service\u7c7b\u548cDAO\u7c7b)\uff0c\u6240\u4ee5\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u8bf4Spring\u7684\u5355\u4f8bbean\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002 \u5982\u679c\u4f60\u7684bean\u6709\u591a\u79cd\u72b6\u6001\u7684\u8bdd\uff08\u6bd4\u5982 View Model\u5bf9\u8c61\uff09\uff0c\u5c31\u9700\u8981\u81ea\u884c\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u3002\u6700\u6d45\u663e\u7684\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5c06\u591a\u6001bean\u7684\u4f5c\u7528\u7531\u201c singleton \u201d\u53d8\u66f4\u4e3a\u201c prototype \u201d\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fAOP \u5019\u9009\u4eba \uff1a aop\u662f\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff0c\u5728spring\u4e2d\u7528\u4e8e\u5c06\u90a3\u4e9b\u4e0e\u4e1a\u52a1\u65e0\u5173\uff0c\u4f46\u5374\u5bf9\u591a\u4e2a\u5bf9\u8c61\u4ea7\u751f\u5f71\u54cd\u7684\u516c\u5171\u884c\u4e3a\u548c\u903b\u8f91\uff0c\u62bd\u53d6\u516c\u5171\u6a21\u5757\u590d\u7528\uff0c\u964d\u4f4e\u8026\u5408\uff0c\u4e00\u822c\u6bd4\u5982\u53ef\u4ee5\u505a\u4e3a\u516c\u5171\u65e5\u5fd7\u4fdd\u5b58\uff0c\u4e8b\u52a1\u5904\u7406\u7b49 \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u9879\u76ee\u4e2d\u6709\u6ca1\u6709\u4f7f\u7528\u5230AOP \u5019\u9009\u4eba \uff1a \u6211\u4eec\u5f53\u65f6\u5728\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0c\u5c31\u662f\u4f7f\u7528aop\u6765\u8bb0\u5f55\u4e86\u7cfb\u7edf\u7684\u64cd\u4f5c\u65e5\u5fd7 \u4e3b\u8981\u601d\u8def\u662f\u8fd9\u6837\u7684\uff0c\u4f7f\u7528aop\u4e2d\u7684\u73af\u7ed5\u901a\u77e5+\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5c31\u662f\u8981\u627e\u5230\u8981\u8bb0\u5f55\u65e5\u5fd7\u7684\u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7\u73af\u7ed5\u901a\u77e5\u7684\u53c2\u6570\u83b7\u53d6\u8bf7\u6c42\u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u6bd4\u5982\u7c7b\u4fe1\u606f\u3001\u65b9\u6cd5\u4fe1\u606f\u3001\u6ce8\u89e3\u3001\u8bf7\u6c42\u65b9\u5f0f\u7b49\uff0c\u83b7\u53d6\u5230\u8fd9\u4e9b\u53c2\u6570\u4ee5\u540e\uff0c\u4fdd\u5b58\u5230\u6570\u636e\u5e93 \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u7684\u4e8b\u52a1\u662f\u5982\u4f55\u5b9e\u73b0\u7684 \u5019\u9009\u4eba \uff1a spring\u5b9e\u73b0\u7684\u4e8b\u52a1\u672c\u8d28\u5c31\u662faop\u5b8c\u6210\uff0c\u5bf9\u65b9\u6cd5\u524d\u540e\u8fdb\u884c\u62e6\u622a\uff0c\u5728\u6267\u884c\u65b9\u6cd5\u4e4b\u524d\u5f00\u542f\u4e8b\u52a1\uff0c\u5728\u6267\u884c\u5b8c\u76ee\u6807\u65b9\u6cd5\u4e4b\u540e\u6839\u636e\u6267\u884c\u60c5\u51b5\u63d0\u4ea4\u6216\u8005\u56de\u6eda\u4e8b\u52a1\u3002 \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u4e8b\u52a1\u5931\u6548\u7684\u573a\u666f\u6709\u54ea\u4e9b \u5019\u9009\u4eba \uff1a \u55ef\uff01\u8fd9\u4e2a\u5728\u9879\u76ee\u4e2d\u4e4b\u524d\u9047\u5230\u8fc7\uff0c\u6211\u60f3\u60f3\u554a \u7b2c\u4e00\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u4e0a\u5f02\u5e38\u6355\u83b7\u5904\u7406\uff0c\u81ea\u5df1\u5904\u7406\u4e86\u5f02\u5e38\uff0c\u6ca1\u6709\u629b\u51fa\uff0c\u5c31\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548\uff0c\u6240\u4ee5\u4e00\u822c\u5904\u7406\u4e86\u5f02\u5e38\u4ee5\u540e\uff0c\u522b\u5fd8\u4e86\u8dd1\u51fa\u53bb\u5c31\u884c\u4e86 \u7b2c\u4e8c\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u629b\u51fa\u68c0\u67e5\u5f02\u5e38\uff0c\u5982\u679c\u62a5\u9519\u4e5f\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548\uff0c\u6700\u540e\u5728spring\u4e8b\u52a1\u7684\u6ce8\u89e3\u4e0a\uff0c\u5c31\u662f@Transactional\u4e0a\u914d\u7f6erollbackFor\u5c5e\u6027\u4e3aException\uff0c\u8fd9\u6837\u522b\u7ba1\u662f\u4ec0\u4e48\u5f02\u5e38\uff0c\u90fd\u4f1a\u56de\u6eda\u4e8b\u52a1 \u7b2c\u4e09\uff0c\u6211\u4e4b\u524d\u8fd8\u9047\u5230\u8fc7\u4e00\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u4e0a\u4e0d\u662fpublic\u4fee\u9970\u7684\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548 \u55ef\uff0c\u5c31\u80fd\u60f3\u8d77\u6765\u90a3\u4e48\u591a \u9762\u8bd5\u5b98 \uff1aSpring\u7684bean\u7684\u751f\u547d\u5468\u671f \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u8fd8\u662f\u633a\u591a\u7684\uff0c\u6211\u4e4b\u524d\u770b\u8fc7\u4e00\u4e9b\u6e90\u7801\uff0c\u5b83\u5927\u6982\u6d41\u7a0b\u662f\u8fd9\u6837\u7684 \u9996\u5148\u4f1a\u901a\u8fc7\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u7c7b\uff0c\u53eb\u505aBeanDefinition\u83b7\u53d6bean\u7684\u5b9a\u4e49\u4fe1\u606f\uff0c\u8fd9\u91cc\u9762\u5c31\u5c01\u88c5\u4e86bean\u7684\u6240\u6709\u4fe1\u606f\uff0c\u6bd4\u5982\uff0c\u7c7b\u7684\u5168\u8def\u5f84\uff0c\u662f\u5426\u662f\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u662f\u5426\u662f\u5355\u4f8b\u7b49\u7b49\u8fd9\u4e9b\u4fe1\u606f \u5728\u521b\u5efabean\u7684\u65f6\u5019\uff0c\u7b2c\u4e00\u6b65\u662f\u8c03\u7528\u6784\u9020\u51fd\u6570\u5b9e\u4f8b\u5316bean \u7b2c\u4e8c\u6b65\u662fbean\u7684\u4f9d\u8d56\u6ce8\u5165\uff0c\u6bd4\u5982\u4e00\u4e9bset\u65b9\u6cd5\u6ce8\u5165\uff0c\u50cf\u5e73\u65f6\u5f00\u53d1\u7528\u7684@Autowire\u90fd\u662f\u8fd9\u4e00\u6b65\u5b8c\u6210 \u7b2c\u4e09\u6b65\u662f\u5904\u7406Aware\u63a5\u53e3\uff0c\u5982\u679c\u67d0\u4e00\u4e2abean\u5b9e\u73b0\u4e86Aware\u63a5\u53e3\u5c31\u4f1a\u91cd\u5199\u65b9\u6cd5\u6267\u884c \u7b2c\u56db\u6b65\u662fbean\u7684\u540e\u7f6e\u5904\u7406\u5668BeanPostProcessor\uff0c\u8fd9\u4e2a\u662f\u524d\u7f6e\u5904\u7406\u5668 \u7b2c\u4e94\u6b65\u662f\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u6bd4\u5982\u5b9e\u73b0\u4e86\u63a5\u53e3InitializingBean\u6216\u8005\u81ea\u5b9a\u4e49\u4e86\u65b9\u6cd5init-method\u6807\u7b7e\u6216@PostContruct \u7b2c\u516d\u6b65\u662f\u6267\u884c\u4e86bean\u7684\u540e\u7f6e\u5904\u7406\u5668BeanPostProcessor\uff0c\u4e3b\u8981\u662f\u5bf9bean\u8fdb\u884c\u589e\u5f3a\uff0c\u6709\u53ef\u80fd\u5728\u8fd9\u91cc\u4ea7\u751f\u4ee3\u7406\u5bf9\u8c61 \u6700\u540e\u4e00\u6b65\u662f\u9500\u6bc1bean \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u7684\u5faa\u73af\u5f15\u7528 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\uff0c\u6211\u6765\u89e3\u91ca\u4e00\u4e0b \u5faa\u73af\u4f9d\u8d56\uff1a\u5faa\u73af\u4f9d\u8d56\u5176\u5b9e\u5c31\u662f\u5faa\u73af\u5f15\u7528,\u4e5f\u5c31\u662f\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684bean\u4e92\u76f8\u6301\u6709\u5bf9\u65b9,\u6700\u7ec8\u5f62\u6210\u95ed\u73af\u3002\u6bd4\u5982A\u4f9d\u8d56\u4e8eB,B\u4f9d\u8d56\u4e8eA \u5faa\u73af\u4f9d\u8d56\u5728spring\u4e2d\u662f\u5141\u8bb8\u5b58\u5728\uff0cspring\u6846\u67b6\u4f9d\u636e\u4e09\u7ea7\u7f13\u5b58\u5df2\u7ecf\u89e3\u51b3\u4e86\u5927\u90e8\u5206\u7684\u5faa\u73af\u4f9d\u8d56 \u2460\u4e00\u7ea7\u7f13\u5b58\uff1a\u5355\u4f8b\u6c60\uff0c\u7f13\u5b58\u5df2\u7ecf\u7ecf\u5386\u4e86\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\uff0c\u5df2\u7ecf\u521d\u59cb\u5316\u5b8c\u6210\u7684bean\u5bf9\u8c61 \u2461\u4e8c\u7ea7\u7f13\u5b58\uff1a\u7f13\u5b58\u65e9\u671f\u7684bean\u5bf9\u8c61\uff08\u751f\u547d\u5468\u671f\u8fd8\u6ca1\u8d70\u5b8c\uff09 \u2462\u4e09\u7ea7\u7f13\u5b58\uff1a\u7f13\u5b58\u7684\u662fObjectFactory\uff0c\u8868\u793a\u5bf9\u8c61\u5de5\u5382\uff0c\u7528\u6765\u521b\u5efa\u67d0\u4e2a\u5bf9\u8c61\u7684 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5177\u4f53\u89e3\u51b3\u6d41\u7a0b\u6e05\u695a\u5417\uff1f \u5019\u9009\u4eba \uff1a \u7b2c\u4e00\uff0c\u5148\u5b9e\u4f8bA\u5bf9\u8c61\uff0c\u540c\u65f6\u4f1a\u521b\u5efaObjectFactory\u5bf9\u8c61\u5b58\u5165\u4e09\u7ea7\u7f13\u5b58singletonFactories \u7b2c\u4e8c\uff0cA\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981B\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u8d70B\u7684\u521b\u5efa\u7684\u903b\u8f91 \u7b2c\u4e09\uff0cB\u5b9e\u4f8b\u5316\u5b8c\u6210\uff0c\u4e5f\u4f1a\u521b\u5efaObjectFactory\u5bf9\u8c61\u5b58\u5165\u4e09\u7ea7\u7f13\u5b58singletonFactories \u7b2c\u56db\uff0cB\u9700\u8981\u6ce8\u5165A\uff0c\u901a\u8fc7\u4e09\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6ObjectFactory\u6765\u751f\u6210\u4e00\u4e2aA\u7684\u5bf9\u8c61\u540c\u65f6\u5b58\u5165\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd9\u4e2a\u662f\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u4e00\u4e2a\u662f\u53ef\u80fd\u662fA\u7684\u666e\u901a\u5bf9\u8c61\uff0c\u53e6\u5916\u4e00\u4e2a\u662fA\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u90fd\u53ef\u4ee5\u8ba9ObjectFactory\u6765\u751f\u4ea7\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e5f\u662f\u4e09\u7ea7\u7f13\u5b58\u7684\u5173\u952e \u7b2c\u4e94\uff0cB\u901a\u8fc7\u4ece\u901a\u8fc7\u4e8c\u7ea7\u7f13\u5b58earlySingletonObjects \u83b7\u5f97\u5230A\u7684\u5bf9\u8c61\u540e\u53ef\u4ee5\u6b63\u5e38\u6ce8\u5165\uff0cB\u521b\u5efa\u6210\u529f\uff0c\u5b58\u5165\u4e00\u7ea7\u7f13\u5b58singletonObjects \u7b2c\u516d\uff0c\u56de\u5230A\u5bf9\u8c61\u521d\u59cb\u5316\uff0c\u56e0\u4e3aB\u5bf9\u8c61\u5df2\u7ecf\u521b\u5efa\u5b8c\u6210\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165B\uff0cA\u521b\u5efa\u6210\u529f\u5b58\u5165\u4e00\u6b21\u7f13\u5b58singletonObjects \u7b2c\u4e03\uff0c\u4e8c\u7ea7\u7f13\u5b58\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61A\u6e05\u9664 \u9762\u8bd5\u5b98 \uff1a\u6784\u9020\u65b9\u6cd5\u51fa\u73b0\u4e86\u5faa\u73af\u4f9d\u8d56\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba \uff1a \u7531\u4e8ebean\u7684\u751f\u547d\u5468\u671f\u4e2d\u6784\u9020\u51fd\u6570\u662f\u7b2c\u4e00\u4e2a\u6267\u884c\u7684\uff0cspring\u6846\u67b6\u5e76\u4e0d\u80fd\u89e3\u51b3\u6784\u9020\u51fd\u6570\u7684\u7684\u4f9d\u8d56\u6ce8\u5165\uff0c\u53ef\u4ee5\u4f7f\u7528@Lazy\u61d2\u52a0\u8f7d\uff0c\u4ec0\u4e48\u65f6\u5019\u9700\u8981\u5bf9\u8c61\u518d\u8fdb\u884cbean\u5bf9\u8c61\u7684\u521b\u5efa \u9762\u8bd5\u5b98 \uff1aSpringMVC\u7684\u6267\u884c\u6d41\u7a0b\u77e5\u9053\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u77e5\u9053\u7684\uff0c\u5b83\u5206\u4e86\u597d\u591a\u6b65\u9aa4 1\u3001\u7528\u6237\u53d1\u9001\u51fa\u8bf7\u6c42\u5230\u524d\u7aef\u63a7\u5236\u5668DispatcherServlet\uff0c\u8fd9\u662f\u4e00\u4e2a\u8c03\u5ea6\u4e2d\u5fc3 2\u3001DispatcherServlet\u6536\u5230\u8bf7\u6c42\u8c03\u7528HandlerMapping\uff08\u5904\u7406\u5668\u6620\u5c04\u5668\uff09\u3002 3\u3001HandlerMapping\u627e\u5230\u5177\u4f53\u7684\u5904\u7406\u5668(\u53ef\u67e5\u627exml\u914d\u7f6e\u6216\u6ce8\u89e3\u914d\u7f6e)\uff0c\u751f\u6210\u5904\u7406\u5668\u5bf9\u8c61\u53ca\u5904\u7406\u5668\u62e6\u622a\u5668(\u5982\u679c\u6709)\uff0c\u518d\u4e00\u8d77\u8fd4\u56de\u7ed9DispatcherServlet\u3002 4\u3001DispatcherServlet\u8c03\u7528HandlerAdapter\uff08\u5904\u7406\u5668\u9002\u914d\u5668\uff09\u3002 5\u3001HandlerAdapter\u7ecf\u8fc7\u9002\u914d\u8c03\u7528\u5177\u4f53\u7684\u5904\u7406\u5668\uff08Handler/Controller\uff09\u3002 6\u3001Controller\u6267\u884c\u5b8c\u6210\u8fd4\u56deModelAndView\u5bf9\u8c61\u3002 7\u3001HandlerAdapter\u5c06Controller\u6267\u884c\u7ed3\u679cModelAndView\u8fd4\u56de\u7ed9DispatcherServlet\u3002 8\u3001DispatcherServlet\u5c06ModelAndView\u4f20\u7ed9ViewReslover\uff08\u89c6\u56fe\u89e3\u6790\u5668\uff09\u3002 9\u3001ViewReslover\u89e3\u6790\u540e\u8fd4\u56de\u5177\u4f53View\uff08\u89c6\u56fe\uff09\u3002 10\u3001DispatcherServlet\u6839\u636eView\u8fdb\u884c\u6e32\u67d3\u89c6\u56fe\uff08\u5373\u5c06\u6a21\u578b\u6570\u636e\u586b\u5145\u81f3\u89c6\u56fe\u4e2d\uff09\u3002 11\u3001DispatcherServlet\u54cd\u5e94\u7528\u6237\u3002 \u5f53\u7136\u73b0\u5728\u7684\u5f00\u53d1\uff0c\u57fa\u672c\u90fd\u662f\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u7684\uff0c\u5e76\u6ca1\u6709\u89c6\u56fe\u8fd9\u4e9b\uff0c\u4e00\u822c\u90fd\u662fhandler\u4e2d\u4f7f\u7528Response\u76f4\u63a5\u7ed3\u679c\u8fd4\u56de \u9762\u8bd5\u5b98 \uff1aSpringboot\u81ea\u52a8\u914d\u7f6e\u539f\u7406 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\uff0c\u5b83\u662f\u8fd9\u6837\u7684\u3002 \u5728Spring Boot\u9879\u76ee\u4e2d\u7684\u5f15\u5bfc\u7c7b\u4e0a\u6709\u4e00\u4e2a\u6ce8\u89e3@SpringBootApplication\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u662f\u5bf9\u4e09\u4e2a\u6ce8\u89e3\u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5206\u522b\u662f\uff1a @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan \u5176\u4e2d @EnableAutoConfiguration \u662f\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6e\u7684\u6838\u5fc3\u6ce8\u89e3\u3002 \u8be5\u6ce8\u89e3\u901a\u8fc7 @Import \u6ce8\u89e3\u5bfc\u5165\u5bf9\u5e94\u7684\u914d\u7f6e\u9009\u62e9\u5668\u3002\u5173\u952e\u7684\u662f\u5185\u90e8\u5c31\u662f\u8bfb\u53d6\u4e86\u8be5\u9879\u76ee\u548c\u8be5\u9879\u76ee\u5f15\u7528\u7684Jar\u5305\u7684\u7684classpath\u8def\u5f84\u4e0b META-INF/spring.factories \u6587\u4ef6\u4e2d\u7684\u6240\u914d\u7f6e\u7684\u7c7b\u7684\u5168\u7c7b\u540d\u3002 \u5728\u8fd9\u4e9b\u914d\u7f6e\u7c7b\u4e2d\u6240\u5b9a\u4e49\u7684Bean\u4f1a\u6839\u636e\u6761\u4ef6\u6ce8\u89e3\u6240 \u6307\u5b9a\u7684\u6761\u4ef6\u6765\u51b3\u5b9a \u662f\u5426\u9700\u8981\u5c06\u5176\u5bfc\u5165\u5230Spring\u5bb9\u5668\u4e2d\u3002 \u4e00\u822c\u6761\u4ef6\u5224\u65ad\u4f1a\u6709\u50cf @ConditionalOnClass \u8fd9\u6837\u7684\u6ce8\u89e3\uff0c\u5224\u65ad\u662f\u5426\u6709\u5bf9\u5e94\u7684class\u6587\u4ef6\uff0c\u5982\u679c\u6709\u5219\u52a0\u8f7d\u8be5\u7c7b\uff0c\u628a\u8fd9\u4e2a\u914d\u7f6e\u7c7b\u7684\u6240\u6709\u7684Bean\u653e\u5165spring\u5bb9\u5668\u4e2d\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1aSpring \u7684\u5e38\u89c1\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u5c31\u5f88\u591a\u4e86 \u7b2c\u4e00\u7c7b\u662f\uff1a\u58f0\u660ebean\uff0c\u6709@Component\u3001@Service\u3001@Repository\u3001@Controller \u7b2c\u4e8c\u7c7b\u662f\uff1a\u4f9d\u8d56\u6ce8\u5165\u76f8\u5173\u7684\uff0c\u6709@Autowired\u3001@Qualifier\u3001@Resourse \u7b2c\u4e09\u7c7b\u662f\uff1a\u8bbe\u7f6e\u4f5c\u7528\u57df @Scope \u7b2c\u56db\u7c7b\u662f\uff1aspring\u914d\u7f6e\u76f8\u5173\u7684\uff0c\u6bd4\u5982@Configuration\uff0c@ComponentScan \u548c @Bean \u7b2c\u4e94\u7c7b\u662f\uff1a\u8ddfaop\u76f8\u5173\u505a\u589e\u5f3a\u7684\u6ce8\u89e3 @Aspect\uff0c@Before\uff0c@After\uff0c@Around\uff0c@Pointcut \u9762\u8bd5\u5b98 \uff1aSpringMVC\u5e38\u89c1\u7684\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u5f88\u591a\u7684 \u6709@RequestMapping\uff1a\u7528\u4e8e\u6620\u5c04\u8bf7\u6c42\u8def\u5f84\uff1b @RequestBody\uff1a\u6ce8\u89e3\u5b9e\u73b0\u63a5\u6536http\u8bf7\u6c42\u7684json\u6570\u636e\uff0c\u5c06json\u8f6c\u6362\u4e3ajava\u5bf9\u8c61\uff1b @RequestParam\uff1a\u6307\u5b9a\u8bf7\u6c42\u53c2\u6570\u7684\u540d\u79f0\uff1b @PathViriable\uff1a\u4ece\u8bf7\u6c42\u8def\u5f84\u4e0b\u4e2d\u83b7\u53d6\u8bf7\u6c42\u53c2\u6570(/user/{id})\uff0c\u4f20\u9012\u7ed9\u65b9\u6cd5\u7684\u5f62\u5f0f\u53c2\u6570\uff1b@ResponseBody\uff1a\u6ce8\u89e3\u5b9e\u73b0\u5c06controller\u65b9\u6cd5\u8fd4\u56de\u5bf9\u8c61\u8f6c\u5316\u4e3ajson\u5bf9\u8c61\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u3002@RequestHeader\uff1a\u83b7\u53d6\u6307\u5b9a\u7684\u8bf7\u6c42\u5934\u6570\u636e\uff0c\u8fd8\u6709\u50cf@PostMapping\u3001@GetMapping\u8fd9\u4e9b\u3002 \u9762\u8bd5\u5b98 \uff1aSpringboot\u5e38\u89c1\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~ Spring Boot\u7684\u6838\u5fc3\u6ce8\u89e3\u662f@SpringBootApplication , \u4ed6\u7531\u51e0\u4e2a\u6ce8\u89e3\u7ec4\u6210 : @SpringBootConfiguration\uff1a \u7ec4\u5408\u4e86- @Configuration\u6ce8\u89e3\uff0c\u5b9e\u73b0\u914d\u7f6e\u6587\u4ef6\u7684\u529f\u80fd\uff1b @EnableAutoConfiguration\uff1a\u6253\u5f00\u81ea\u52a8\u914d\u7f6e\u7684\u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u5173\u95ed\u67d0\u4e2a\u81ea\u52a8\u914d\u7f6e\u7684\u9009\u9879 @ComponentScan\uff1aSpring\u7ec4\u4ef6\u626b\u63cf \u9762\u8bd5\u5b98 \uff1aMyBatis\u6267\u884c\u6d41\u7a0b \u5019\u9009\u4eba \uff1a \u597d\uff0c\u8fd9\u4e2a\u77e5\u9053\u7684\uff0c\u4e0d\u8fc7\u6b65\u9aa4\u4e5f\u5f88\u591a \u2460\u8bfb\u53d6MyBatis\u914d\u7f6e\u6587\u4ef6\uff1amybatis-config.xml\u52a0\u8f7d\u8fd0\u884c\u73af\u5883\u548c\u6620\u5c04\u6587\u4ef6 \u2461\u6784\u9020\u4f1a\u8bdd\u5de5\u5382SqlSessionFactory\uff0c\u4e00\u4e2a\u9879\u76ee\u53ea\u9700\u8981\u4e00\u4e2a\uff0c\u5355\u4f8b\u7684\uff0c\u4e00\u822c\u7531spring\u8fdb\u884c\u7ba1\u7406 \u2462\u4f1a\u8bdd\u5de5\u5382\u521b\u5efaSqlSession\u5bf9\u8c61\uff0c\u8fd9\u91cc\u9762\u5c31\u542b\u4e86\u6267\u884cSQL\u8bed\u53e5\u7684\u6240\u6709\u65b9\u6cd5 \u2463\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u63a5\u53e3\uff0cExecutor\u6267\u884c\u5668\uff0c\u540c\u65f6\u8d1f\u8d23\u67e5\u8be2\u7f13\u5b58\u7684\u7ef4\u62a4 \u2464Executor\u63a5\u53e3\u7684\u6267\u884c\u65b9\u6cd5\u4e2d\u6709\u4e00\u4e2aMappedStatement\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5c01\u88c5\u4e86\u6620\u5c04\u4fe1\u606f \u2465\u8f93\u5165\u53c2\u6570\u6620\u5c04 \u2466\u8f93\u51fa\u7ed3\u679c\u6620\u5c04 \u9762\u8bd5\u5b98 \uff1aMybatis\u662f\u5426\u652f\u6301\u5ef6\u8fdf\u52a0\u8f7d\uff1f \u5019\u9009\u4eba \uff1a \u662f\u652f\u6301\u7684~ \u5ef6\u8fdf\u52a0\u8f7d\u7684\u610f\u601d\u662f\uff1a\u5c31\u662f\u5728\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u624d\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u5c31\u4e0d\u52a0\u8f7d\u6570\u636e\u3002 Mybatis\u652f\u6301\u4e00\u5bf9\u4e00\u5173\u8054\u5bf9\u8c61\u548c\u4e00\u5bf9\u591a\u5173\u8054\u96c6\u5408\u5bf9\u8c61\u7684\u5ef6\u8fdf\u52a0\u8f7d \u5728Mybatis\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u914d\u7f6e\u662f\u5426\u542f\u7528\u5ef6\u8fdf\u52a0\u8f7dlazyLoadingEnabled=true|false\uff0c\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u9762\u8bd5\u5b98 \uff1a\u5ef6\u8fdf\u52a0\u8f7d\u7684\u5e95\u5c42\u539f\u7406\u77e5\u9053\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u60f3\u554a \u5ef6\u8fdf\u52a0\u8f7d\u5728\u5e95\u5c42\u4e3b\u8981\u4f7f\u7528\u7684CGLIB\u52a8\u6001\u4ee3\u7406\u5b8c\u6210\u7684 \u7b2c\u4e00\u662f\uff0c\u4f7f\u7528CGLIB\u521b\u5efa\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u8fd9\u91cc\u7684\u76ee\u6807\u5bf9\u8c61\u5c31\u662f\u5f00\u542f\u4e86\u5ef6\u8fdf\u52a0\u8f7d\u7684mapper \u7b2c\u4e8c\u4e2a\u662f\u5f53\u8c03\u7528\u76ee\u6807\u65b9\u6cd5\u65f6\uff0c\u8fdb\u5165\u62e6\u622a\u5668invoke\u65b9\u6cd5\uff0c\u53d1\u73b0\u76ee\u6807\u65b9\u6cd5\u662fnull\u503c\uff0c\u518d\u6267\u884csql\u67e5\u8be2 \u7b2c\u4e09\u4e2a\u662f\u83b7\u53d6\u6570\u636e\u4ee5\u540e\uff0c\u8c03\u7528set\u65b9\u6cd5\u8bbe\u7f6e\u5c5e\u6027\u503c\uff0c\u518d\u7ee7\u7eed\u67e5\u8be2\u76ee\u6807\u65b9\u6cd5\uff0c\u5c31\u6709\u503c\u4e86 \u9762\u8bd5\u5b98 \uff1aMybatis\u7684\u4e00\u7ea7\u3001\u4e8c\u7ea7\u7f13\u5b58\u7528\u8fc7\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u7528\u8fc7\u7684~ mybatis\u7684\u4e00\u7ea7\u7f13\u5b58: \u57fa\u4e8e PerpetualCache \u7684 HashMap \u672c\u5730\u7f13\u5b58\uff0c\u5176\u5b58\u50a8\u4f5c\u7528\u57df\u4e3a Session\uff0c\u5f53Session\u8fdb\u884cflush\u6216close\u4e4b\u540e\uff0c\u8be5Session\u4e2d\u7684\u6240\u6709Cache\u5c31\u5c06\u6e05\u7a7a\uff0c\u9ed8\u8ba4\u6253\u5f00\u4e00\u7ea7\u7f13\u5b58 \u5173\u4e8e\u4e8c\u7ea7\u7f13\u5b58\u9700\u8981\u5355\u72ec\u5f00\u542f \u4e8c\u7ea7\u7f13\u5b58\u662f\u57fa\u4e8enamespace\u548cmapper\u7684\u4f5c\u7528\u57df\u8d77\u4f5c\u7528\u7684\uff0c\u4e0d\u662f\u4f9d\u8d56\u4e8eSQL session\uff0c\u9ed8\u8ba4\u4e5f\u662f\u91c7\u7528 PerpetualCache\uff0cHashMap \u5b58\u50a8\u3002 \u5982\u679c\u60f3\u8981\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\u9700\u8981\u5728\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\u548c\u6620\u5c04\u6587\u4ef6\u4e2d\u5f00\u542f\u914d\u7f6e\u624d\u884c\u3002 \u9762\u8bd5\u5b98 \uff1aMybatis\u7684\u4e8c\u7ea7\u7f13\u5b58\u4ec0\u4e48\u65f6\u5019\u4f1a\u6e05\u7406\u7f13\u5b58\u4e2d\u7684\u6570\u636e \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u5f53\u67d0\u4e00\u4e2a\u4f5c\u7528\u57df(\u4e00\u7ea7\u7f13\u5b58 Session/\u4e8c\u7ea7\u7f13\u5b58Namespaces)\u7684\u8fdb\u884c\u4e86\u65b0\u589e\u3001\u4fee\u6539\u3001\u5220\u9664\u64cd\u4f5c\u540e\uff0c\u9ed8\u8ba4\u8be5\u4f5c\u7528\u57df\u4e0b\u6240\u6709 select \u4e2d\u7684\u7f13\u5b58\u5c06\u88ab clear\u3002","title":"\u6846\u67b6\u7bc7\u9762\u8bd5\u9898 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/04-%E6%A1%86%E6%9E%B6%E7%AF%87/%E6%A1%86%E6%9E%B6%E7%AF%87%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#-","text":"","title":"\u6846\u67b6\u7bc7\u9762\u8bd5\u9898-\u53c2\u8003\u56de\u7b54"},{"location":"heimajava/04-%E6%A1%86%E6%9E%B6%E7%AF%87/%E6%A1%86%E6%9E%B6%E7%AF%87%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#springbean","text":"\u5019\u9009\u4eba \uff1a \u55ef\uff01 \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u662f\u8fd9\u6837\u7684 \u5f53\u591a\u7528\u6237\u540c\u65f6\u8bf7\u6c42\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u5bb9\u5668\u4f1a\u7ed9\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u8fd9\u662f\u591a\u4e2a\u7ebf\u7a0b\u4f1a\u5e76\u53d1\u6267\u884c\u8be5\u8bf7\u6c42\u5bf9\u5e94\u7684\u4e1a\u52a1\u903b\u8f91\uff08\u6210\u5458\u65b9\u6cd5\uff09\uff0c\u5982\u679c\u8be5\u5904\u7406\u903b\u8f91\u4e2d\u6709\u5bf9\u8be5\u5355\u5217\u72b6\u6001\u7684\u4fee\u6539\uff08\u4f53\u73b0\u4e3a\u8be5\u5355\u4f8b\u7684\u6210\u5458\u5c5e\u6027\uff09\uff0c\u5219\u5fc5\u987b\u8003\u8651\u7ebf\u7a0b\u540c\u6b65\u95ee\u9898\u3002 Spring\u6846\u67b6\u5e76\u6ca1\u6709\u5bf9\u5355\u4f8bbean\u8fdb\u884c\u4efb\u4f55\u591a\u7ebf\u7a0b\u7684\u5c01\u88c5\u5904\u7406\u3002\u5173\u4e8e\u5355\u4f8bbean\u7684\u7ebf\u7a0b\u5b89\u5168\u548c\u5e76\u53d1\u95ee\u9898\u9700\u8981\u5f00\u53d1\u8005\u81ea\u884c\u53bb\u641e\u5b9a\u3002 \u6bd4\u5982\uff1a\u6211\u4eec\u901a\u5e38\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u7684Spring bean\u90fd\u662f\u4e0d\u53ef\u53ef\u53d8\u7684\u72b6\u6001(\u6bd4\u5982Service\u7c7b\u548cDAO\u7c7b)\uff0c\u6240\u4ee5\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u8bf4Spring\u7684\u5355\u4f8bbean\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002 \u5982\u679c\u4f60\u7684bean\u6709\u591a\u79cd\u72b6\u6001\u7684\u8bdd\uff08\u6bd4\u5982 View Model\u5bf9\u8c61\uff09\uff0c\u5c31\u9700\u8981\u81ea\u884c\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u3002\u6700\u6d45\u663e\u7684\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5c06\u591a\u6001bean\u7684\u4f5c\u7528\u7531\u201c singleton \u201d\u53d8\u66f4\u4e3a\u201c prototype \u201d\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fAOP \u5019\u9009\u4eba \uff1a aop\u662f\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff0c\u5728spring\u4e2d\u7528\u4e8e\u5c06\u90a3\u4e9b\u4e0e\u4e1a\u52a1\u65e0\u5173\uff0c\u4f46\u5374\u5bf9\u591a\u4e2a\u5bf9\u8c61\u4ea7\u751f\u5f71\u54cd\u7684\u516c\u5171\u884c\u4e3a\u548c\u903b\u8f91\uff0c\u62bd\u53d6\u516c\u5171\u6a21\u5757\u590d\u7528\uff0c\u964d\u4f4e\u8026\u5408\uff0c\u4e00\u822c\u6bd4\u5982\u53ef\u4ee5\u505a\u4e3a\u516c\u5171\u65e5\u5fd7\u4fdd\u5b58\uff0c\u4e8b\u52a1\u5904\u7406\u7b49 \u9762\u8bd5\u5b98 \uff1a\u4f60\u4eec\u9879\u76ee\u4e2d\u6709\u6ca1\u6709\u4f7f\u7528\u5230AOP \u5019\u9009\u4eba \uff1a \u6211\u4eec\u5f53\u65f6\u5728\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0c\u5c31\u662f\u4f7f\u7528aop\u6765\u8bb0\u5f55\u4e86\u7cfb\u7edf\u7684\u64cd\u4f5c\u65e5\u5fd7 \u4e3b\u8981\u601d\u8def\u662f\u8fd9\u6837\u7684\uff0c\u4f7f\u7528aop\u4e2d\u7684\u73af\u7ed5\u901a\u77e5+\u5207\u70b9\u8868\u8fbe\u5f0f\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5c31\u662f\u8981\u627e\u5230\u8981\u8bb0\u5f55\u65e5\u5fd7\u7684\u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7\u73af\u7ed5\u901a\u77e5\u7684\u53c2\u6570\u83b7\u53d6\u8bf7\u6c42\u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u6bd4\u5982\u7c7b\u4fe1\u606f\u3001\u65b9\u6cd5\u4fe1\u606f\u3001\u6ce8\u89e3\u3001\u8bf7\u6c42\u65b9\u5f0f\u7b49\uff0c\u83b7\u53d6\u5230\u8fd9\u4e9b\u53c2\u6570\u4ee5\u540e\uff0c\u4fdd\u5b58\u5230\u6570\u636e\u5e93 \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u7684\u4e8b\u52a1\u662f\u5982\u4f55\u5b9e\u73b0\u7684 \u5019\u9009\u4eba \uff1a spring\u5b9e\u73b0\u7684\u4e8b\u52a1\u672c\u8d28\u5c31\u662faop\u5b8c\u6210\uff0c\u5bf9\u65b9\u6cd5\u524d\u540e\u8fdb\u884c\u62e6\u622a\uff0c\u5728\u6267\u884c\u65b9\u6cd5\u4e4b\u524d\u5f00\u542f\u4e8b\u52a1\uff0c\u5728\u6267\u884c\u5b8c\u76ee\u6807\u65b9\u6cd5\u4e4b\u540e\u6839\u636e\u6267\u884c\u60c5\u51b5\u63d0\u4ea4\u6216\u8005\u56de\u6eda\u4e8b\u52a1\u3002 \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u4e8b\u52a1\u5931\u6548\u7684\u573a\u666f\u6709\u54ea\u4e9b \u5019\u9009\u4eba \uff1a \u55ef\uff01\u8fd9\u4e2a\u5728\u9879\u76ee\u4e2d\u4e4b\u524d\u9047\u5230\u8fc7\uff0c\u6211\u60f3\u60f3\u554a \u7b2c\u4e00\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u4e0a\u5f02\u5e38\u6355\u83b7\u5904\u7406\uff0c\u81ea\u5df1\u5904\u7406\u4e86\u5f02\u5e38\uff0c\u6ca1\u6709\u629b\u51fa\uff0c\u5c31\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548\uff0c\u6240\u4ee5\u4e00\u822c\u5904\u7406\u4e86\u5f02\u5e38\u4ee5\u540e\uff0c\u522b\u5fd8\u4e86\u8dd1\u51fa\u53bb\u5c31\u884c\u4e86 \u7b2c\u4e8c\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u629b\u51fa\u68c0\u67e5\u5f02\u5e38\uff0c\u5982\u679c\u62a5\u9519\u4e5f\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548\uff0c\u6700\u540e\u5728spring\u4e8b\u52a1\u7684\u6ce8\u89e3\u4e0a\uff0c\u5c31\u662f@Transactional\u4e0a\u914d\u7f6erollbackFor\u5c5e\u6027\u4e3aException\uff0c\u8fd9\u6837\u522b\u7ba1\u662f\u4ec0\u4e48\u5f02\u5e38\uff0c\u90fd\u4f1a\u56de\u6eda\u4e8b\u52a1 \u7b2c\u4e09\uff0c\u6211\u4e4b\u524d\u8fd8\u9047\u5230\u8fc7\u4e00\u4e2a\uff0c\u5982\u679c\u65b9\u6cd5\u4e0a\u4e0d\u662fpublic\u4fee\u9970\u7684\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u4e8b\u52a1\u5931\u6548 \u55ef\uff0c\u5c31\u80fd\u60f3\u8d77\u6765\u90a3\u4e48\u591a \u9762\u8bd5\u5b98 \uff1aSpring\u7684bean\u7684\u751f\u547d\u5468\u671f \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u8fd8\u662f\u633a\u591a\u7684\uff0c\u6211\u4e4b\u524d\u770b\u8fc7\u4e00\u4e9b\u6e90\u7801\uff0c\u5b83\u5927\u6982\u6d41\u7a0b\u662f\u8fd9\u6837\u7684 \u9996\u5148\u4f1a\u901a\u8fc7\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u7c7b\uff0c\u53eb\u505aBeanDefinition\u83b7\u53d6bean\u7684\u5b9a\u4e49\u4fe1\u606f\uff0c\u8fd9\u91cc\u9762\u5c31\u5c01\u88c5\u4e86bean\u7684\u6240\u6709\u4fe1\u606f\uff0c\u6bd4\u5982\uff0c\u7c7b\u7684\u5168\u8def\u5f84\uff0c\u662f\u5426\u662f\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u662f\u5426\u662f\u5355\u4f8b\u7b49\u7b49\u8fd9\u4e9b\u4fe1\u606f \u5728\u521b\u5efabean\u7684\u65f6\u5019\uff0c\u7b2c\u4e00\u6b65\u662f\u8c03\u7528\u6784\u9020\u51fd\u6570\u5b9e\u4f8b\u5316bean \u7b2c\u4e8c\u6b65\u662fbean\u7684\u4f9d\u8d56\u6ce8\u5165\uff0c\u6bd4\u5982\u4e00\u4e9bset\u65b9\u6cd5\u6ce8\u5165\uff0c\u50cf\u5e73\u65f6\u5f00\u53d1\u7528\u7684@Autowire\u90fd\u662f\u8fd9\u4e00\u6b65\u5b8c\u6210 \u7b2c\u4e09\u6b65\u662f\u5904\u7406Aware\u63a5\u53e3\uff0c\u5982\u679c\u67d0\u4e00\u4e2abean\u5b9e\u73b0\u4e86Aware\u63a5\u53e3\u5c31\u4f1a\u91cd\u5199\u65b9\u6cd5\u6267\u884c \u7b2c\u56db\u6b65\u662fbean\u7684\u540e\u7f6e\u5904\u7406\u5668BeanPostProcessor\uff0c\u8fd9\u4e2a\u662f\u524d\u7f6e\u5904\u7406\u5668 \u7b2c\u4e94\u6b65\u662f\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u6bd4\u5982\u5b9e\u73b0\u4e86\u63a5\u53e3InitializingBean\u6216\u8005\u81ea\u5b9a\u4e49\u4e86\u65b9\u6cd5init-method\u6807\u7b7e\u6216@PostContruct \u7b2c\u516d\u6b65\u662f\u6267\u884c\u4e86bean\u7684\u540e\u7f6e\u5904\u7406\u5668BeanPostProcessor\uff0c\u4e3b\u8981\u662f\u5bf9bean\u8fdb\u884c\u589e\u5f3a\uff0c\u6709\u53ef\u80fd\u5728\u8fd9\u91cc\u4ea7\u751f\u4ee3\u7406\u5bf9\u8c61 \u6700\u540e\u4e00\u6b65\u662f\u9500\u6bc1bean \u9762\u8bd5\u5b98 \uff1aSpring\u4e2d\u7684\u5faa\u73af\u5f15\u7528 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\uff0c\u6211\u6765\u89e3\u91ca\u4e00\u4e0b \u5faa\u73af\u4f9d\u8d56\uff1a\u5faa\u73af\u4f9d\u8d56\u5176\u5b9e\u5c31\u662f\u5faa\u73af\u5f15\u7528,\u4e5f\u5c31\u662f\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684bean\u4e92\u76f8\u6301\u6709\u5bf9\u65b9,\u6700\u7ec8\u5f62\u6210\u95ed\u73af\u3002\u6bd4\u5982A\u4f9d\u8d56\u4e8eB,B\u4f9d\u8d56\u4e8eA \u5faa\u73af\u4f9d\u8d56\u5728spring\u4e2d\u662f\u5141\u8bb8\u5b58\u5728\uff0cspring\u6846\u67b6\u4f9d\u636e\u4e09\u7ea7\u7f13\u5b58\u5df2\u7ecf\u89e3\u51b3\u4e86\u5927\u90e8\u5206\u7684\u5faa\u73af\u4f9d\u8d56 \u2460\u4e00\u7ea7\u7f13\u5b58\uff1a\u5355\u4f8b\u6c60\uff0c\u7f13\u5b58\u5df2\u7ecf\u7ecf\u5386\u4e86\u5b8c\u6574\u7684\u751f\u547d\u5468\u671f\uff0c\u5df2\u7ecf\u521d\u59cb\u5316\u5b8c\u6210\u7684bean\u5bf9\u8c61 \u2461\u4e8c\u7ea7\u7f13\u5b58\uff1a\u7f13\u5b58\u65e9\u671f\u7684bean\u5bf9\u8c61\uff08\u751f\u547d\u5468\u671f\u8fd8\u6ca1\u8d70\u5b8c\uff09 \u2462\u4e09\u7ea7\u7f13\u5b58\uff1a\u7f13\u5b58\u7684\u662fObjectFactory\uff0c\u8868\u793a\u5bf9\u8c61\u5de5\u5382\uff0c\u7528\u6765\u521b\u5efa\u67d0\u4e2a\u5bf9\u8c61\u7684 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5177\u4f53\u89e3\u51b3\u6d41\u7a0b\u6e05\u695a\u5417\uff1f \u5019\u9009\u4eba \uff1a \u7b2c\u4e00\uff0c\u5148\u5b9e\u4f8bA\u5bf9\u8c61\uff0c\u540c\u65f6\u4f1a\u521b\u5efaObjectFactory\u5bf9\u8c61\u5b58\u5165\u4e09\u7ea7\u7f13\u5b58singletonFactories \u7b2c\u4e8c\uff0cA\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981B\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u8d70B\u7684\u521b\u5efa\u7684\u903b\u8f91 \u7b2c\u4e09\uff0cB\u5b9e\u4f8b\u5316\u5b8c\u6210\uff0c\u4e5f\u4f1a\u521b\u5efaObjectFactory\u5bf9\u8c61\u5b58\u5165\u4e09\u7ea7\u7f13\u5b58singletonFactories \u7b2c\u56db\uff0cB\u9700\u8981\u6ce8\u5165A\uff0c\u901a\u8fc7\u4e09\u7ea7\u7f13\u5b58\u4e2d\u83b7\u53d6ObjectFactory\u6765\u751f\u6210\u4e00\u4e2aA\u7684\u5bf9\u8c61\u540c\u65f6\u5b58\u5165\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd9\u4e2a\u662f\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u4e00\u4e2a\u662f\u53ef\u80fd\u662fA\u7684\u666e\u901a\u5bf9\u8c61\uff0c\u53e6\u5916\u4e00\u4e2a\u662fA\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u90fd\u53ef\u4ee5\u8ba9ObjectFactory\u6765\u751f\u4ea7\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e5f\u662f\u4e09\u7ea7\u7f13\u5b58\u7684\u5173\u952e \u7b2c\u4e94\uff0cB\u901a\u8fc7\u4ece\u901a\u8fc7\u4e8c\u7ea7\u7f13\u5b58earlySingletonObjects \u83b7\u5f97\u5230A\u7684\u5bf9\u8c61\u540e\u53ef\u4ee5\u6b63\u5e38\u6ce8\u5165\uff0cB\u521b\u5efa\u6210\u529f\uff0c\u5b58\u5165\u4e00\u7ea7\u7f13\u5b58singletonObjects \u7b2c\u516d\uff0c\u56de\u5230A\u5bf9\u8c61\u521d\u59cb\u5316\uff0c\u56e0\u4e3aB\u5bf9\u8c61\u5df2\u7ecf\u521b\u5efa\u5b8c\u6210\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165B\uff0cA\u521b\u5efa\u6210\u529f\u5b58\u5165\u4e00\u6b21\u7f13\u5b58singletonObjects \u7b2c\u4e03\uff0c\u4e8c\u7ea7\u7f13\u5b58\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61A\u6e05\u9664 \u9762\u8bd5\u5b98 \uff1a\u6784\u9020\u65b9\u6cd5\u51fa\u73b0\u4e86\u5faa\u73af\u4f9d\u8d56\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba \uff1a \u7531\u4e8ebean\u7684\u751f\u547d\u5468\u671f\u4e2d\u6784\u9020\u51fd\u6570\u662f\u7b2c\u4e00\u4e2a\u6267\u884c\u7684\uff0cspring\u6846\u67b6\u5e76\u4e0d\u80fd\u89e3\u51b3\u6784\u9020\u51fd\u6570\u7684\u7684\u4f9d\u8d56\u6ce8\u5165\uff0c\u53ef\u4ee5\u4f7f\u7528@Lazy\u61d2\u52a0\u8f7d\uff0c\u4ec0\u4e48\u65f6\u5019\u9700\u8981\u5bf9\u8c61\u518d\u8fdb\u884cbean\u5bf9\u8c61\u7684\u521b\u5efa \u9762\u8bd5\u5b98 \uff1aSpringMVC\u7684\u6267\u884c\u6d41\u7a0b\u77e5\u9053\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u77e5\u9053\u7684\uff0c\u5b83\u5206\u4e86\u597d\u591a\u6b65\u9aa4 1\u3001\u7528\u6237\u53d1\u9001\u51fa\u8bf7\u6c42\u5230\u524d\u7aef\u63a7\u5236\u5668DispatcherServlet\uff0c\u8fd9\u662f\u4e00\u4e2a\u8c03\u5ea6\u4e2d\u5fc3 2\u3001DispatcherServlet\u6536\u5230\u8bf7\u6c42\u8c03\u7528HandlerMapping\uff08\u5904\u7406\u5668\u6620\u5c04\u5668\uff09\u3002 3\u3001HandlerMapping\u627e\u5230\u5177\u4f53\u7684\u5904\u7406\u5668(\u53ef\u67e5\u627exml\u914d\u7f6e\u6216\u6ce8\u89e3\u914d\u7f6e)\uff0c\u751f\u6210\u5904\u7406\u5668\u5bf9\u8c61\u53ca\u5904\u7406\u5668\u62e6\u622a\u5668(\u5982\u679c\u6709)\uff0c\u518d\u4e00\u8d77\u8fd4\u56de\u7ed9DispatcherServlet\u3002 4\u3001DispatcherServlet\u8c03\u7528HandlerAdapter\uff08\u5904\u7406\u5668\u9002\u914d\u5668\uff09\u3002 5\u3001HandlerAdapter\u7ecf\u8fc7\u9002\u914d\u8c03\u7528\u5177\u4f53\u7684\u5904\u7406\u5668\uff08Handler/Controller\uff09\u3002 6\u3001Controller\u6267\u884c\u5b8c\u6210\u8fd4\u56deModelAndView\u5bf9\u8c61\u3002 7\u3001HandlerAdapter\u5c06Controller\u6267\u884c\u7ed3\u679cModelAndView\u8fd4\u56de\u7ed9DispatcherServlet\u3002 8\u3001DispatcherServlet\u5c06ModelAndView\u4f20\u7ed9ViewReslover\uff08\u89c6\u56fe\u89e3\u6790\u5668\uff09\u3002 9\u3001ViewReslover\u89e3\u6790\u540e\u8fd4\u56de\u5177\u4f53View\uff08\u89c6\u56fe\uff09\u3002 10\u3001DispatcherServlet\u6839\u636eView\u8fdb\u884c\u6e32\u67d3\u89c6\u56fe\uff08\u5373\u5c06\u6a21\u578b\u6570\u636e\u586b\u5145\u81f3\u89c6\u56fe\u4e2d\uff09\u3002 11\u3001DispatcherServlet\u54cd\u5e94\u7528\u6237\u3002 \u5f53\u7136\u73b0\u5728\u7684\u5f00\u53d1\uff0c\u57fa\u672c\u90fd\u662f\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u7684\uff0c\u5e76\u6ca1\u6709\u89c6\u56fe\u8fd9\u4e9b\uff0c\u4e00\u822c\u90fd\u662fhandler\u4e2d\u4f7f\u7528Response\u76f4\u63a5\u7ed3\u679c\u8fd4\u56de \u9762\u8bd5\u5b98 \uff1aSpringboot\u81ea\u52a8\u914d\u7f6e\u539f\u7406 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\uff0c\u5b83\u662f\u8fd9\u6837\u7684\u3002 \u5728Spring Boot\u9879\u76ee\u4e2d\u7684\u5f15\u5bfc\u7c7b\u4e0a\u6709\u4e00\u4e2a\u6ce8\u89e3@SpringBootApplication\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u662f\u5bf9\u4e09\u4e2a\u6ce8\u89e3\u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5206\u522b\u662f\uff1a @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan \u5176\u4e2d @EnableAutoConfiguration \u662f\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6e\u7684\u6838\u5fc3\u6ce8\u89e3\u3002 \u8be5\u6ce8\u89e3\u901a\u8fc7 @Import \u6ce8\u89e3\u5bfc\u5165\u5bf9\u5e94\u7684\u914d\u7f6e\u9009\u62e9\u5668\u3002\u5173\u952e\u7684\u662f\u5185\u90e8\u5c31\u662f\u8bfb\u53d6\u4e86\u8be5\u9879\u76ee\u548c\u8be5\u9879\u76ee\u5f15\u7528\u7684Jar\u5305\u7684\u7684classpath\u8def\u5f84\u4e0b META-INF/spring.factories \u6587\u4ef6\u4e2d\u7684\u6240\u914d\u7f6e\u7684\u7c7b\u7684\u5168\u7c7b\u540d\u3002 \u5728\u8fd9\u4e9b\u914d\u7f6e\u7c7b\u4e2d\u6240\u5b9a\u4e49\u7684Bean\u4f1a\u6839\u636e\u6761\u4ef6\u6ce8\u89e3\u6240 \u6307\u5b9a\u7684\u6761\u4ef6\u6765\u51b3\u5b9a \u662f\u5426\u9700\u8981\u5c06\u5176\u5bfc\u5165\u5230Spring\u5bb9\u5668\u4e2d\u3002 \u4e00\u822c\u6761\u4ef6\u5224\u65ad\u4f1a\u6709\u50cf @ConditionalOnClass \u8fd9\u6837\u7684\u6ce8\u89e3\uff0c\u5224\u65ad\u662f\u5426\u6709\u5bf9\u5e94\u7684class\u6587\u4ef6\uff0c\u5982\u679c\u6709\u5219\u52a0\u8f7d\u8be5\u7c7b\uff0c\u628a\u8fd9\u4e2a\u914d\u7f6e\u7c7b\u7684\u6240\u6709\u7684Bean\u653e\u5165spring\u5bb9\u5668\u4e2d\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1aSpring \u7684\u5e38\u89c1\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u5c31\u5f88\u591a\u4e86 \u7b2c\u4e00\u7c7b\u662f\uff1a\u58f0\u660ebean\uff0c\u6709@Component\u3001@Service\u3001@Repository\u3001@Controller \u7b2c\u4e8c\u7c7b\u662f\uff1a\u4f9d\u8d56\u6ce8\u5165\u76f8\u5173\u7684\uff0c\u6709@Autowired\u3001@Qualifier\u3001@Resourse \u7b2c\u4e09\u7c7b\u662f\uff1a\u8bbe\u7f6e\u4f5c\u7528\u57df @Scope \u7b2c\u56db\u7c7b\u662f\uff1aspring\u914d\u7f6e\u76f8\u5173\u7684\uff0c\u6bd4\u5982@Configuration\uff0c@ComponentScan \u548c @Bean \u7b2c\u4e94\u7c7b\u662f\uff1a\u8ddfaop\u76f8\u5173\u505a\u589e\u5f3a\u7684\u6ce8\u89e3 @Aspect\uff0c@Before\uff0c@After\uff0c@Around\uff0c@Pointcut \u9762\u8bd5\u5b98 \uff1aSpringMVC\u5e38\u89c1\u7684\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u5f88\u591a\u7684 \u6709@RequestMapping\uff1a\u7528\u4e8e\u6620\u5c04\u8bf7\u6c42\u8def\u5f84\uff1b @RequestBody\uff1a\u6ce8\u89e3\u5b9e\u73b0\u63a5\u6536http\u8bf7\u6c42\u7684json\u6570\u636e\uff0c\u5c06json\u8f6c\u6362\u4e3ajava\u5bf9\u8c61\uff1b @RequestParam\uff1a\u6307\u5b9a\u8bf7\u6c42\u53c2\u6570\u7684\u540d\u79f0\uff1b @PathViriable\uff1a\u4ece\u8bf7\u6c42\u8def\u5f84\u4e0b\u4e2d\u83b7\u53d6\u8bf7\u6c42\u53c2\u6570(/user/{id})\uff0c\u4f20\u9012\u7ed9\u65b9\u6cd5\u7684\u5f62\u5f0f\u53c2\u6570\uff1b@ResponseBody\uff1a\u6ce8\u89e3\u5b9e\u73b0\u5c06controller\u65b9\u6cd5\u8fd4\u56de\u5bf9\u8c61\u8f6c\u5316\u4e3ajson\u5bf9\u8c61\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u3002@RequestHeader\uff1a\u83b7\u53d6\u6307\u5b9a\u7684\u8bf7\u6c42\u5934\u6570\u636e\uff0c\u8fd8\u6709\u50cf@PostMapping\u3001@GetMapping\u8fd9\u4e9b\u3002 \u9762\u8bd5\u5b98 \uff1aSpringboot\u5e38\u89c1\u6ce8\u89e3\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~ Spring Boot\u7684\u6838\u5fc3\u6ce8\u89e3\u662f@SpringBootApplication , \u4ed6\u7531\u51e0\u4e2a\u6ce8\u89e3\u7ec4\u6210 : @SpringBootConfiguration\uff1a \u7ec4\u5408\u4e86- @Configuration\u6ce8\u89e3\uff0c\u5b9e\u73b0\u914d\u7f6e\u6587\u4ef6\u7684\u529f\u80fd\uff1b @EnableAutoConfiguration\uff1a\u6253\u5f00\u81ea\u52a8\u914d\u7f6e\u7684\u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u5173\u95ed\u67d0\u4e2a\u81ea\u52a8\u914d\u7f6e\u7684\u9009\u9879 @ComponentScan\uff1aSpring\u7ec4\u4ef6\u626b\u63cf \u9762\u8bd5\u5b98 \uff1aMyBatis\u6267\u884c\u6d41\u7a0b \u5019\u9009\u4eba \uff1a \u597d\uff0c\u8fd9\u4e2a\u77e5\u9053\u7684\uff0c\u4e0d\u8fc7\u6b65\u9aa4\u4e5f\u5f88\u591a \u2460\u8bfb\u53d6MyBatis\u914d\u7f6e\u6587\u4ef6\uff1amybatis-config.xml\u52a0\u8f7d\u8fd0\u884c\u73af\u5883\u548c\u6620\u5c04\u6587\u4ef6 \u2461\u6784\u9020\u4f1a\u8bdd\u5de5\u5382SqlSessionFactory\uff0c\u4e00\u4e2a\u9879\u76ee\u53ea\u9700\u8981\u4e00\u4e2a\uff0c\u5355\u4f8b\u7684\uff0c\u4e00\u822c\u7531spring\u8fdb\u884c\u7ba1\u7406 \u2462\u4f1a\u8bdd\u5de5\u5382\u521b\u5efaSqlSession\u5bf9\u8c61\uff0c\u8fd9\u91cc\u9762\u5c31\u542b\u4e86\u6267\u884cSQL\u8bed\u53e5\u7684\u6240\u6709\u65b9\u6cd5 \u2463\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u63a5\u53e3\uff0cExecutor\u6267\u884c\u5668\uff0c\u540c\u65f6\u8d1f\u8d23\u67e5\u8be2\u7f13\u5b58\u7684\u7ef4\u62a4 \u2464Executor\u63a5\u53e3\u7684\u6267\u884c\u65b9\u6cd5\u4e2d\u6709\u4e00\u4e2aMappedStatement\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5c01\u88c5\u4e86\u6620\u5c04\u4fe1\u606f \u2465\u8f93\u5165\u53c2\u6570\u6620\u5c04 \u2466\u8f93\u51fa\u7ed3\u679c\u6620\u5c04 \u9762\u8bd5\u5b98 \uff1aMybatis\u662f\u5426\u652f\u6301\u5ef6\u8fdf\u52a0\u8f7d\uff1f \u5019\u9009\u4eba \uff1a \u662f\u652f\u6301\u7684~ \u5ef6\u8fdf\u52a0\u8f7d\u7684\u610f\u601d\u662f\uff1a\u5c31\u662f\u5728\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u624d\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u7528\u5230\u6570\u636e\u65f6\u5c31\u4e0d\u52a0\u8f7d\u6570\u636e\u3002 Mybatis\u652f\u6301\u4e00\u5bf9\u4e00\u5173\u8054\u5bf9\u8c61\u548c\u4e00\u5bf9\u591a\u5173\u8054\u96c6\u5408\u5bf9\u8c61\u7684\u5ef6\u8fdf\u52a0\u8f7d \u5728Mybatis\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u914d\u7f6e\u662f\u5426\u542f\u7528\u5ef6\u8fdf\u52a0\u8f7dlazyLoadingEnabled=true|false\uff0c\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u9762\u8bd5\u5b98 \uff1a\u5ef6\u8fdf\u52a0\u8f7d\u7684\u5e95\u5c42\u539f\u7406\u77e5\u9053\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u60f3\u554a \u5ef6\u8fdf\u52a0\u8f7d\u5728\u5e95\u5c42\u4e3b\u8981\u4f7f\u7528\u7684CGLIB\u52a8\u6001\u4ee3\u7406\u5b8c\u6210\u7684 \u7b2c\u4e00\u662f\uff0c\u4f7f\u7528CGLIB\u521b\u5efa\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u8fd9\u91cc\u7684\u76ee\u6807\u5bf9\u8c61\u5c31\u662f\u5f00\u542f\u4e86\u5ef6\u8fdf\u52a0\u8f7d\u7684mapper \u7b2c\u4e8c\u4e2a\u662f\u5f53\u8c03\u7528\u76ee\u6807\u65b9\u6cd5\u65f6\uff0c\u8fdb\u5165\u62e6\u622a\u5668invoke\u65b9\u6cd5\uff0c\u53d1\u73b0\u76ee\u6807\u65b9\u6cd5\u662fnull\u503c\uff0c\u518d\u6267\u884csql\u67e5\u8be2 \u7b2c\u4e09\u4e2a\u662f\u83b7\u53d6\u6570\u636e\u4ee5\u540e\uff0c\u8c03\u7528set\u65b9\u6cd5\u8bbe\u7f6e\u5c5e\u6027\u503c\uff0c\u518d\u7ee7\u7eed\u67e5\u8be2\u76ee\u6807\u65b9\u6cd5\uff0c\u5c31\u6709\u503c\u4e86 \u9762\u8bd5\u5b98 \uff1aMybatis\u7684\u4e00\u7ea7\u3001\u4e8c\u7ea7\u7f13\u5b58\u7528\u8fc7\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u7528\u8fc7\u7684~ mybatis\u7684\u4e00\u7ea7\u7f13\u5b58: \u57fa\u4e8e PerpetualCache \u7684 HashMap \u672c\u5730\u7f13\u5b58\uff0c\u5176\u5b58\u50a8\u4f5c\u7528\u57df\u4e3a Session\uff0c\u5f53Session\u8fdb\u884cflush\u6216close\u4e4b\u540e\uff0c\u8be5Session\u4e2d\u7684\u6240\u6709Cache\u5c31\u5c06\u6e05\u7a7a\uff0c\u9ed8\u8ba4\u6253\u5f00\u4e00\u7ea7\u7f13\u5b58 \u5173\u4e8e\u4e8c\u7ea7\u7f13\u5b58\u9700\u8981\u5355\u72ec\u5f00\u542f \u4e8c\u7ea7\u7f13\u5b58\u662f\u57fa\u4e8enamespace\u548cmapper\u7684\u4f5c\u7528\u57df\u8d77\u4f5c\u7528\u7684\uff0c\u4e0d\u662f\u4f9d\u8d56\u4e8eSQL session\uff0c\u9ed8\u8ba4\u4e5f\u662f\u91c7\u7528 PerpetualCache\uff0cHashMap \u5b58\u50a8\u3002 \u5982\u679c\u60f3\u8981\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\u9700\u8981\u5728\u5168\u5c40\u914d\u7f6e\u6587\u4ef6\u548c\u6620\u5c04\u6587\u4ef6\u4e2d\u5f00\u542f\u914d\u7f6e\u624d\u884c\u3002 \u9762\u8bd5\u5b98 \uff1aMybatis\u7684\u4e8c\u7ea7\u7f13\u5b58\u4ec0\u4e48\u65f6\u5019\u4f1a\u6e05\u7406\u7f13\u5b58\u4e2d\u7684\u6570\u636e \u5019\u9009\u4eba \uff1a \u55ef\uff01\uff01 \u5f53\u67d0\u4e00\u4e2a\u4f5c\u7528\u57df(\u4e00\u7ea7\u7f13\u5b58 Session/\u4e8c\u7ea7\u7f13\u5b58Namespaces)\u7684\u8fdb\u884c\u4e86\u65b0\u589e\u3001\u4fee\u6539\u3001\u5220\u9664\u64cd\u4f5c\u540e\uff0c\u9ed8\u8ba4\u8be5\u4f5c\u7528\u57df\u4e0b\u6240\u6709 select \u4e2d\u7684\u7f13\u5b58\u5c06\u88ab clear\u3002","title":"\u9762\u8bd5\u5b98\uff1aSpring\u6846\u67b6\u4e2d\u7684\u5355\u4f8bbean\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/","text":"\u5fae\u670d\u52a1\u9762\u8bd5\u9898 \u9762\u8bd5\u5b98\uff1a Spring Cloud 5\u5927\u7ec4\u4ef6\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a \u65e9\u671f\u6211\u4eec\u4e00\u822c\u8ba4\u4e3a\u7684Spring Cloud\u4e94\u5927\u7ec4\u4ef6\u662f Eureka : \u6ce8\u518c\u4e2d\u5fc3 Ribbon : \u8d1f\u8f7d\u5747\u8861 Feign : \u8fdc\u7a0b\u8c03\u7528 Hystrix : \u670d\u52a1\u7194\u65ad Zuul/Gateway : \u7f51\u5173 \u968f\u7740SpringCloudAlibba\u5728\u56fd\u5185\u5174\u8d77 , \u6211\u4eec\u9879\u76ee\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e9b\u963f\u91cc\u5df4\u5df4\u7684\u7ec4\u4ef6 \u6ce8\u518c\u4e2d\u5fc3/\u914d\u7f6e\u4e2d\u5fc3 Nacos \u8d1f\u8f7d\u5747\u8861 Ribbon \u670d\u52a1\u8c03\u7528 Feign \u670d\u52a1\u4fdd\u62a4 sentinel \u670d\u52a1\u7f51\u5173 Gateway \u9762\u8bd5\u5b98\uff1a \u670d\u52a1\u6ce8\u518c\u548c\u53d1\u73b0\u662f\u4ec0\u4e48\u610f\u601d\uff1fSpring Cloud \u5982\u4f55\u5b9e\u73b0\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\uff1f \u5019\u9009\u4eba\uff1a \u6211\u7406\u89e3\u7684\u662f\u4e3b\u8981\u4e09\u5757\u5927\u529f\u80fd\uff0c\u5206\u522b\u662f\u670d\u52a1\u6ce8\u518c \u3001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u72b6\u6001\u76d1\u63a7 \u6211\u4eec\u5f53\u65f6\u9879\u76ee\u91c7\u7528\u7684eureka\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8fd9\u4e2a\u4e5f\u662fspring cloud\u4f53\u7cfb\u4e2d\u7684\u4e00\u4e2a\u6838\u5fc3\u7ec4\u4ef6 \u670d\u52a1\u6ce8\u518c \uff1a\u670d\u52a1\u63d0\u4f9b\u8005\u9700\u8981\u628a\u81ea\u5df1\u7684\u4fe1\u606f\u6ce8\u518c\u5230eureka\uff0c\u7531eureka\u6765\u4fdd\u5b58\u8fd9\u4e9b\u4fe1\u606f\uff0c\u6bd4\u5982\u670d\u52a1\u540d\u79f0\u3001ip\u3001\u7aef\u53e3\u7b49\u7b49 \u670d\u52a1\u53d1\u73b0 \uff1a\u6d88\u8d39\u8005\u5411eureka\u62c9\u53d6\u670d\u52a1\u5217\u8868\u4fe1\u606f\uff0c\u5982\u679c\u670d\u52a1\u63d0\u4f9b\u8005\u6709\u96c6\u7fa4\uff0c\u5219\u6d88\u8d39\u8005\u4f1a\u5229\u7528\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u9009\u62e9\u4e00\u4e2a\u53d1\u8d77\u8c03\u7528 \u670d\u52a1\u76d1\u63a7 \uff1a\u670d\u52a1\u63d0\u4f9b\u8005\u4f1a\u6bcf\u969430\u79d2\u5411eureka\u53d1\u9001\u5fc3\u8df3\uff0c\u62a5\u544a\u5065\u5eb7\u72b6\u6001\uff0c\u5982\u679ceureka\u670d\u52a190\u79d2\u6ca1\u63a5\u6536\u5230\u5fc3\u8df3\uff0c\u4eceeureka\u4e2d\u5254\u9664 \u9762\u8bd5\u5b98\uff1a \u6211\u770b\u4f60\u4e4b\u524d\u4e5f\u7528\u8fc7nacos\u3001\u4f60\u80fd\u8bf4\u4e0bnacos\u4e0eeureka\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u5f53\u65f6xx\u9879\u76ee\u5c31\u662f\u91c7\u7528\u7684nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u9009\u62e9nacos\u8fd8\u8981\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u5c31\u662f\u5b83\u652f\u6301\u914d\u7f6e\u4e2d\u5fc3\uff0c\u4e0d\u8fc7nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u4e5f\u6bd4eureka\u8981\u65b9\u4fbf\u597d\u7528\u4e00\u4e9b\uff0c\u4e3b\u8981\u76f8\u540c\u4e0d\u540c\u70b9\u5728\u4e8e\u51e0\u70b9\uff1a \u5171\u540c\u70b9 Nacos\u4e0eeureka\u90fd\u652f\u6301\u670d\u52a1\u6ce8\u518c\u548c\u670d\u52a1\u62c9\u53d6\uff0c\u90fd\u652f\u6301\u670d\u52a1\u63d0\u4f9b\u8005\u5fc3\u8df3\u65b9\u5f0f\u505a\u5065\u5eb7\u68c0\u6d4b Nacos\u4e0eEureka\u7684\u533a\u522b \u2460Nacos\u652f\u6301\u670d\u52a1\u7aef\u4e3b\u52a8\u68c0\u6d4b\u63d0\u4f9b\u8005\u72b6\u6001\uff1a\u4e34\u65f6\u5b9e\u4f8b\u91c7\u7528\u5fc3\u8df3\u6a21\u5f0f\uff0c\u975e\u4e34\u65f6\u5b9e\u4f8b\u91c7\u7528\u4e3b\u52a8\u68c0\u6d4b\u6a21\u5f0f \u2461\u4e34\u65f6\u5b9e\u4f8b\u5fc3\u8df3\u4e0d\u6b63\u5e38\u4f1a\u88ab\u5254\u9664\uff0c\u975e\u4e34\u65f6\u5b9e\u4f8b\u5219\u4e0d\u4f1a\u88ab\u5254\u9664 \u2462Nacos\u652f\u6301\u670d\u52a1\u5217\u8868\u53d8\u66f4\u7684\u6d88\u606f\u63a8\u9001\u6a21\u5f0f\uff0c\u670d\u52a1\u5217\u8868\u66f4\u65b0\u66f4\u53ca\u65f6 \u2463Nacos\u96c6\u7fa4\u9ed8\u8ba4\u91c7\u7528AP\u65b9\u5f0f\uff0c\u5f53\u96c6\u7fa4\u4e2d\u5b58\u5728\u975e\u4e34\u65f6\u5b9e\u4f8b\u65f6\uff0c\u91c7\u7528CP\u6a21\u5f0f\uff1bEureka\u91c7\u7528AP\u65b9\u5f0f \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u9879\u76ee\u8d1f\u8f7d\u5747\u8861\u5982\u4f55\u5b9e\u73b0\u7684 ? \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837~~ \u5728\u670d\u52a1\u8c03\u7528\u8fc7\u7a0b\u4e2d\u7684\u8d1f\u8f7d\u5747\u8861\u4e00\u822c\u4f7f\u7528SpringCloud\u7684Ribbon \u7ec4\u4ef6\u5b9e\u73b0 , Feign\u7684\u5e95\u5c42\u5df2\u7ecf\u81ea\u52a8\u96c6\u6210\u4e86Ribbon , \u4f7f\u7528\u8d77\u6765\u975e\u5e38\u7b80\u5355 \u5f53\u53d1\u8d77\u8fdc\u7a0b\u8c03\u7528\u65f6\uff0cribbon\u5148\u4ece\u6ce8\u518c\u4e2d\u5fc3\u62c9\u53d6\u670d\u52a1\u5730\u5740\u5217\u8868\uff0c\u7136\u540e\u6309\u7167\u4e00\u5b9a\u7684\u8def\u7531\u7b56\u7565\u9009\u62e9\u4e00\u4e2a\u53d1\u8d77\u8fdc\u7a0b\u8c03\u7528\uff0c\u4e00\u822c\u7684\u8c03\u7528\u7b56\u7565\u662f\u8f6e\u8be2 \u9762\u8bd5\u5b98\uff1a Ribbon\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba\uff1a \u6211\u60f3\u60f3\u554a\uff0c\u6709\u5f88\u591a\u79cd\uff0c\u6211\u8bb0\u5f97\u51e0\u4e2a\uff1a RoundRobinRule\uff1a\u7b80\u5355\u8f6e\u8be2\u670d\u52a1\u5217\u8868\u6765\u9009\u62e9\u670d\u52a1\u5668 WeightedResponseTimeRule\uff1a\u6309\u7167\u6743\u91cd\u6765\u9009\u62e9\u670d\u52a1\u5668\uff0c\u54cd\u5e94\u65f6\u95f4\u8d8a\u957f\uff0c\u6743\u91cd\u8d8a\u5c0f RandomRule\uff1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u53ef\u7528\u7684\u670d\u52a1\u5668 ZoneAvoidanceRule\uff1a\u533a\u57df\u654f\u611f\u7b56\u7565\uff0c\u4ee5\u533a\u57df\u53ef\u7528\u7684\u670d\u52a1\u5668\u4e3a\u57fa\u7840\u8fdb\u884c\u670d\u52a1\u5668\u7684\u9009\u62e9\u3002\u4f7f\u7528Zone\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u5206\u7c7b\uff0c\u8fd9\u4e2aZone\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u673a\u623f\u3001\u4e00\u4e2a\u673a\u67b6\u7b49\u3002\u800c\u540e\u518d\u5bf9Zone\u5185\u7684\u591a\u4e2a\u670d\u52a1\u505a\u8f6e\u8be2(\u9ed8\u8ba4) \u9762\u8bd5\u5b98\uff1a \u5982\u679c\u60f3\u81ea\u5b9a\u4e49\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u5982\u4f55\u5b9e\u73b0 ? \u5019\u9009\u4eba\uff1a \u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a 1\uff0c\u521b\u5efa\u7c7b\u5b9e\u73b0IRule\u63a5\u53e3\uff0c\u53ef\u4ee5\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u8fd9\u4e2a\u662f\u5168\u5c40\u7684\uff0c\u5bf9\u6240\u6709\u7684\u8fdc\u7a0b\u8c03\u7528\u90fd\u8d77\u4f5c\u7528 2\uff0c\u5728\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u914d\u7f6e\u67d0\u4e00\u4e2a\u670d\u52a1\u8c03\u7528\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ea\u662f\u5bf9\u914d\u7f6e\u7684\u8fd9\u4e2a\u670d\u52a1\u751f\u6548\u8fdc\u7a0b\u8c03\u7528 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u662f\u670d\u52a1\u96ea\u5d29\uff0c\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1f \u5019\u9009\u4eba\uff1a \u670d\u52a1\u96ea\u5d29\u662f\u6307\u4e00\u4e2a\u670d\u52a1\u5931\u8d25\uff0c\u5bfc\u81f4\u6574\u6761\u94fe\u8def\u7684\u670d\u52a1\u90fd\u5931\u8d25\u7684\u60c5\u5f62\uff0c\u4e00\u822c\u6211\u4eec\u5728\u9879\u76ee\u89e3\u51b3\u7684\u8bdd\u5c31\u662f\u4e24\u79cd\u65b9\u6848\uff0c\u7b2c\u4e00\u4e2a\u662f\u670d\u52a1\u964d\u7ea7\uff0c\u7b2c\u4e8c\u4e2a\u662f\u670d\u52a1\u7194\u65ad\uff0c\u5982\u679c\u6d41\u91cf\u592a\u5927\u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u9650\u6d41 \u670d\u52a1\u964d\u7ea7\uff1a\u670d\u52a1\u81ea\u6211\u4fdd\u62a4\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u6216\u8005\u4fdd\u62a4\u4e0b\u6e38\u670d\u52a1\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u7528\u4e8e\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u53d7\u8bf7\u6c42\u7a81\u589e\u5f71\u54cd\u53d8\u5f97\u4e0d\u53ef\u7528\uff0c\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u5d29\u6e83\uff0c\u4e00\u822c\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u4e0efeign\u63a5\u53e3\u6574\u5408\uff0c\u7f16\u5199\u964d\u7ea7\u903b\u8f91 \u670d\u52a1\u7194\u65ad\uff1a\u9ed8\u8ba4\u5173\u95ed\uff0c\u9700\u8981\u624b\u52a8\u6253\u5f00\uff0c\u5982\u679c\u68c0\u6d4b\u5230 10 \u79d2\u5185\u8bf7\u6c42\u7684\u5931\u8d25\u7387\u8d85\u8fc7 50%\uff0c\u5c31\u89e6\u53d1\u7194\u65ad\u673a\u5236\u3002\u4e4b\u540e\u6bcf\u9694 5 \u79d2\u91cd\u65b0\u5c1d\u8bd5\u8bf7\u6c42\u5fae\u670d\u52a1\uff0c\u5982\u679c\u5fae\u670d\u52a1\u4e0d\u80fd\u54cd\u5e94\uff0c\u7ee7\u7eed\u8d70\u7194\u65ad\u673a\u5236\u3002\u5982\u679c\u5fae\u670d\u52a1\u53ef\u8fbe\uff0c\u5219\u5173\u95ed\u7194\u65ad\u673a\u5236\uff0c\u6062\u590d\u6b63\u5e38\u8bf7\u6c42 \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u7684\u5fae\u670d\u52a1\u662f\u600e\u4e48\u76d1\u63a7\u7684\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u9879\u76ee\u4e2d\u91c7\u7528\u7684skywalking\u8fdb\u884c\u76d1\u63a7\u7684 1\uff0cskywalking\u4e3b\u8981\u53ef\u4ee5\u76d1\u63a7\u63a5\u53e3\u3001\u670d\u52a1\u3001\u7269\u7406\u5b9e\u4f8b\u7684\u4e00\u4e9b\u72b6\u6001\u3002\u7279\u522b\u662f\u5728\u538b\u6d4b\u7684\u65f6\u5019\u53ef\u4ee5\u770b\u5230\u4f17\u591a\u670d\u52a1\u4e2d\u54ea\u4e9b\u670d\u52a1\u548c\u63a5\u53e3\u6bd4\u8f83\u6162\uff0c\u6211\u4eec\u53ef\u4ee5\u9488\u5bf9\u6027\u7684\u5206\u6790\u548c\u4f18\u5316\u3002 2\uff0c\u6211\u4eec\u8fd8\u5728skywalking\u8bbe\u7f6e\u4e86\u544a\u8b66\u89c4\u5219\uff0c\u7279\u522b\u662f\u5728\u9879\u76ee\u4e0a\u7ebf\u4ee5\u540e\uff0c\u5982\u679c\u62a5\u9519\uff0c\u6211\u4eec\u5206\u522b\u8bbe\u7f6e\u4e86\u53ef\u4ee5\u7ed9\u76f8\u5173\u8d1f\u8d23\u4eba\u53d1\u77ed\u4fe1\u548c\u53d1\u90ae\u4ef6\uff0c\u7b2c\u4e00\u65f6\u95f4\u77e5\u9053\u9879\u76ee\u7684bug\u60c5\u51b5\uff0c\u7b2c\u4e00\u65f6\u95f4\u4fee\u590d \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u9879\u76ee\u4e2d\u6709\u6ca1\u6709\u505a\u8fc7\u9650\u6d41 ? \u600e\u4e48\u505a\u7684 ? \u5019\u9009\u4eba\uff1a \u6211\u5f53\u65f6\u505a\u7684xx\u9879\u76ee\uff0c\u91c7\u7528\u5c31\u662f\u5fae\u670d\u52a1\u7684\u67b6\u6784\uff0c\u56e0\u4e3axx\u56e0\u4e3a\uff0c\u5e94\u8be5\u4f1a\u6709\u7a81\u53d1\u6d41\u91cf\uff0c\u6700\u5927QPS\u53ef\u4ee5\u8fbe\u52302000\uff0c\u4f46\u662f\u670d\u52a1\u652f\u6491\u4e0d\u4f4f\uff0c\u6211\u4eec\u9879\u76ee\u90fd\u901a\u8fc7\u538b\u6d4b\u6700\u591a\u53ef\u4ee5\u652f\u64911200QPS\u3002\u56e0\u4e3a\u6211\u4eec\u5e73\u65f6\u7684QPS\u4e5f\u5c31\u4e0d\u5230100\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u7a81\u53d1\u6d41\u91cf\uff0c\u6240\u4ee5\u91c7\u7528\u4e86\u9650\u6d41\u3002 \u3010\u7248\u672c1\u3011 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684nginx\u9650\u6d41\u64cd\u4f5c\uff0cnginx\u4f7f\u7528\u7684\u6f0f\u6876\u7b97\u6cd5\u6765\u5b9e\u73b0\u8fc7\u6ee4\uff0c\u8ba9\u8bf7\u6c42\u4ee5\u56fa\u5b9a\u7684\u901f\u7387\u5904\u7406\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5e94\u5bf9\u7a81\u53d1\u6d41\u91cf\uff0c\u6211\u4eec\u63a7\u5236\u7684\u901f\u7387\u662f\u6309\u7167ip\u8fdb\u884c\u9650\u6d41\uff0c\u9650\u5236\u7684\u6d41\u91cf\u662f\u6bcf\u79d220 \u3010\u7248\u672c2\u3011 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u662fspring cloud gateway\u4e2d\u652f\u6301\u5c40\u90e8\u8fc7\u6ee4\u5668RequestRateLimiter\u6765\u505a\u9650\u6d41\uff0c\u4f7f\u7528\u7684\u662f\u4ee4\u724c\u6876\u7b97\u6cd5\uff0c\u53ef\u4ee5\u6839\u636eip\u6216\u8def\u5f84\u8fdb\u884c\u9650\u6d41\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6bcf\u79d2\u586b\u5145\u5e73\u5747\u901f\u7387\uff0c\u548c\u4ee4\u724c\u6876\u603b\u5bb9\u91cf \u9762\u8bd5\u5b98\uff1a \u9650\u6d41\u5e38\u89c1\u7684\u7b97\u6cd5\u6709\u54ea\u4e9b\u5462\uff1f \u5019\u9009\u4eba\uff1a \u6bd4\u8f83\u5e38\u89c1\u7684\u9650\u6d41\u7b97\u6cd5\u6709\u6f0f\u6876\u7b97\u6cd5\u548c\u4ee4\u724c\u6876\u7b97\u6cd5 \u6f0f\u6876\u7b97\u6cd5\u662f\u628a\u8bf7\u6c42\u5b58\u5165\u5230\u6876\u4e2d\uff0c\u4ee5\u56fa\u5b9a\u901f\u7387\u4ece\u6876\u4e2d\u6d41\u51fa\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u7684\u670d\u52a1\u505a\u5230\u7edd\u5bf9\u7684\u5e73\u5747\uff0c\u8d77\u5230\u5f88\u597d\u7684\u9650\u6d41\u6548\u679c \u4ee4\u724c\u6876\u7b97\u6cd5\u5728\u6876\u4e2d\u5b58\u50a8\u7684\u662f\u4ee4\u724c\uff0c\u6309\u7167\u4e00\u5b9a\u7684\u901f\u7387\u751f\u6210\u4ee4\u724c\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u8981\u5148\u7533\u8bf7\u4ee4\u724c\uff0c\u7533\u8bf7\u5230\u4ee4\u724c\u4ee5\u540e\u624d\u80fd\u6b63\u5e38\u8bf7\u6c42\uff0c\u4e5f\u53ef\u4ee5\u8d77\u5230\u5f88\u597d\u7684\u9650\u6d41\u4f5c\u7528 \u5b83\u4eec\u7684\u533a\u522b\u662f\uff0c\u6f0f\u6876\u548c\u4ee4\u724c\u6876\u90fd\u53ef\u4ee5\u5904\u7406\u7a81\u53d1\u6d41\u91cf\uff0c\u5176\u4e2d\u6f0f\u6876\u53ef\u4ee5\u505a\u5230\u7edd\u5bf9\u7684\u5e73\u6ed1\uff0c\u4ee4\u724c\u6876\u6709\u53ef\u80fd\u4f1a\u4ea7\u751f\u7a81\u53d1\u5927\u91cf\u8bf7\u6c42\u7684\u60c5\u51b5\uff0c\u4e00\u822cnginx\u9650\u6d41\u91c7\u7528\u7684\u6f0f\u6876\uff0cspring cloud gateway\u4e2d\u53ef\u4ee5\u652f\u6301\u4ee4\u724c\u6876\u7b97\u6cd5 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fCAP\u7406\u8bba\uff1f \u5019\u9009\u4eba \uff1a CAP\u4e3b\u8981\u662f\u5728\u5206\u5e03\u5f0f\u9879\u76ee\u4e0b\u7684\u4e00\u4e2a\u7406\u8bba\u3002\u5305\u542b\u4e86\u4e09\u9879\uff0c\u4e00\u81f4\u6027\u3001\u53ef\u7528\u6027\u3001\u5206\u533a\u5bb9\u9519\u6027 \u4e00\u81f4\u6027(Consistency)\u662f\u6307\u66f4\u65b0\u64cd\u4f5c\u6210\u529f\u5e76\u8fd4\u56de\u5ba2\u6237\u7aef\u5b8c\u6210\u540e\uff0c\u6240\u6709\u8282\u70b9\u5728\u540c\u4e00\u65f6\u95f4\u7684\u6570\u636e\u5b8c\u5168\u4e00\u81f4(\u5f3a\u4e00\u81f4\u6027)\uff0c\u4e0d\u80fd\u5b58\u5728\u4e2d\u95f4\u72b6\u6001\u3002 \u53ef\u7528\u6027(Availability) \u662f\u6307\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u5fc5\u987b\u4e00\u76f4\u5904\u4e8e\u53ef\u7528\u7684\u72b6\u6001\uff0c\u5bf9\u4e8e\u7528\u6237\u7684\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u8bf7\u6c42\u603b\u662f\u80fd\u591f\u5728\u6709\u9650\u7684\u65f6\u95f4\u5185\u8fd4\u56de\u7ed3\u679c\u3002 \u5206\u533a\u5bb9\u9519\u6027(Partition tolerance) \u662f\u6307\u5206\u5e03\u5f0f\u7cfb\u7edf\u5728\u9047\u5230\u4efb\u4f55\u7f51\u7edc\u5206\u533a\u6545\u969c\u65f6\uff0c\u4ecd\u7136\u9700\u8981\u80fd\u591f\u4fdd\u8bc1\u5bf9\u5916\u63d0\u4f9b\u6ee1\u8db3\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\u7684\u670d\u52a1\uff0c\u9664\u975e\u662f\u6574\u4e2a\u7f51\u7edc\u73af\u5883\u90fd\u53d1\u751f\u4e86\u6545\u969c\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4ec0\u4e48\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u65e0\u6cd5\u540c\u65f6\u4fdd\u8bc1\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684~~ \u9996\u5148\u4e00\u4e2a\u524d\u63d0\uff0c\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u800c\u8a00\uff0c\u5206\u533a\u5bb9\u9519\u6027\u662f\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u8981\u6c42\uff0c\u56e0\u6b64\u57fa\u672c\u4e0a\u6211\u4eec\u5728\u8bbe\u8ba1\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u65f6\u5019\u53ea\u80fd\u4ece\u4e00\u81f4\u6027\uff08C\uff09\u548c\u53ef\u7528\u6027\uff08A\uff09\u4e4b\u95f4\u8fdb\u884c\u53d6\u820d\u3002 \u5982\u679c\u4fdd\u8bc1\u4e86\u4e00\u81f4\u6027\uff08C\uff09\uff1a\u5bf9\u4e8e\u8282\u70b9N1\u548cN2\uff0c\u5f53\u5f80N1\u91cc\u5199\u6570\u636e\u65f6\uff0cN2\u4e0a\u7684\u64cd\u4f5c\u5fc5\u987b\u88ab\u6682\u505c\uff0c\u53ea\u6709\u5f53N1\u540c\u6b65\u6570\u636e\u5230N2\u65f6\u624d\u80fd\u5bf9N2\u8fdb\u884c\u8bfb\u5199\u8bf7\u6c42\uff0c\u5728N2\u88ab\u6682\u505c\u64cd\u4f5c\u671f\u95f4\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u8bf7\u6c42\u4f1a\u6536\u5230\u5931\u8d25\u6216\u8d85\u65f6\u3002\u663e\u7136\uff0c\u8fd9\u4e0e\u53ef\u7528\u6027\u662f\u76f8\u6096\u7684\u3002 \u5982\u679c\u4fdd\u8bc1\u4e86\u53ef\u7528\u6027\uff08A\uff09\uff1a\u90a3\u5c31\u4e0d\u80fd\u6682\u505cN2\u7684\u8bfb\u5199\u64cd\u4f5c\uff0c\u4f46\u540c\u65f6N1\u5728\u5199\u6570\u636e\u7684\u8bdd\uff0c\u8fd9\u5c31\u8fdd\u80cc\u4e86\u4e00\u81f4\u6027\u7684\u8981\u6c42\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fBASE\u7406\u8bba\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u662fCAP\u5206\u5e03\u5f0f\u7cfb\u7edf\u8bbe\u8ba1\u7406\u8bba BASE\u662fCAP\u7406\u8bba\u4e2dAP\u65b9\u6848\u7684\u5ef6\u4f38\uff0c\u6838\u5fc3\u601d\u60f3\u662f\u5373\u4f7f\u65e0\u6cd5\u505a\u5230\u5f3a\u4e00\u81f4\u6027\uff08StrongConsistency\uff0cCAP\u7684\u4e00\u81f4\u6027\u5c31\u662f\u5f3a\u4e00\u81f4\u6027\uff09\uff0c\u4f46\u5e94\u7528\u53ef\u4ee5\u91c7\u7528\u9002\u5408\u7684\u65b9\u5f0f\u8fbe\u5230\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual Consitency\uff09\u3002\u5b83\u7684\u601d\u60f3\u5305\u542b\u4e09\u65b9\u9762\uff1a 1\u3001Basically Available\uff08\u57fa\u672c\u53ef\u7528\uff09\uff1a\u57fa\u672c\u53ef\u7528\u662f\u6307\u5206\u5e03\u5f0f\u7cfb\u7edf\u5728\u51fa\u73b0\u4e0d\u53ef\u9884\u77e5\u7684\u6545\u969c\u7684\u65f6\u5019\uff0c\u5141\u8bb8\u635f\u5931\u90e8\u5206\u53ef\u7528\u6027\uff0c\u4f46\u4e0d\u7b49\u4e8e\u7cfb\u7edf\u4e0d\u53ef\u7528\u3002 2\u3001Soft state\uff08\u8f6f\u72b6\u6001\uff09\uff1a\u5373\u662f\u6307\u5141\u8bb8\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u5b58\u5728\u4e2d\u95f4\u72b6\u6001\uff0c\u5e76\u8ba4\u4e3a\u8be5\u4e2d\u95f4\u72b6\u6001\u7684\u5b58\u5728\u4e0d\u4f1a\u5f71\u54cd\u7cfb\u7edf\u7684\u6574\u4f53\u53ef\u7528\u6027\uff0c\u5373\u5141\u8bb8\u7cfb\u7edf\u5728\u4e0d\u540c\u8282\u70b9\u7684\u6570\u636e\u526f\u672c\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u540c\u6b65\u7684\u8fc7\u7a0b\u5b58\u5728\u5ef6\u65f6\u3002 3\u3001Eventually consistent\uff08\u6700\u7ec8\u4e00\u81f4\u6027\uff09\uff1a\u5f3a\u8c03\u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u6570\u636e\u526f\u672c\uff0c\u5728\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u540c\u6b65\u540e\uff0c\u6700\u7ec8\u80fd\u591f\u8fbe\u5230\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001\u3002\u5176\u672c\u8d28\u662f\u9700\u8981\u7cfb\u7edf\u4fdd\u8bc1\u6700\u7ec8\u6570\u636e\u80fd\u591f\u8fbe\u5230\u4e00\u81f4\uff0c\u800c\u4e0d\u9700\u8981\u5b9e\u65f6\u4fdd\u8bc1\u7cfb\u7edf\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\u3002 \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u91c7\u7528\u54ea\u79cd\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u5f53\u65f6\u662fxx\u9879\u76ee\uff0c\u4e3b\u8981\u4f7f\u7528\u5230\u7684seata\u7684at\u6a21\u5f0f\u89e3\u51b3\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1 seata\u7684AT\u6a21\u578b\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff1a 1\u3001\u9636\u6bb5\u4e00RM\u7684\u5de5\u4f5c\uff1a\u2460 \u6ce8\u518c\u5206\u652f\u4e8b\u52a1 \u2461 \u8bb0\u5f55undo-log\uff08\u6570\u636e\u5feb\u7167\uff09\u2462 \u6267\u884c\u4e1a\u52a1sql\u5e76\u63d0\u4ea4 \u2463\u62a5\u544a\u4e8b\u52a1\u72b6\u6001 2\u3001\u9636\u6bb5\u4e8c\u63d0\u4ea4\u65f6RM\u7684\u5de5\u4f5c\uff1a\u5220\u9664undo-log\u5373\u53ef 3\u3001\u9636\u6bb5\u4e8c\u56de\u6eda\u65f6RM\u7684\u5de5\u4f5c\uff1a\u6839\u636eundo-log\u6062\u590d\u6570\u636e\u5230\u66f4\u65b0\u524d at\u6a21\u5f0f\u727a\u7272\u4e86\u4e00\u81f4\u6027\uff0c\u4fdd\u8bc1\u4e86\u53ef\u7528\u6027\uff0c\u4e0d\u8fc7\uff0c\u5b83\u4fdd\u8bc1\u7684\u662f\u6700\u7ec8\u4e00\u81f4\u6027 \u9762\u8bd5\u5b98\uff1a \u5206\u5e03\u5f0f\u670d\u52a1\u7684\u63a5\u53e3\u5e42\u7b49\u6027\u5982\u4f55\u8bbe\u8ba1\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u6211\u4eec\u5f53\u65f6\u6709\u4e00\u4e2axx\u9879\u76ee\u7684\u4e0b\u5355\u64cd\u4f5c\uff0c\u91c7\u7528\u7684token+redis\u5b9e\u73b0\u7684\uff0c\u6d41\u7a0b\u662f\u8fd9\u6837\u7684 \u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u7528\u6237\u6253\u5f00\u4e86\u5546\u54c1\u8be6\u60c5\u9875\u9762\uff0c\u6211\u4eec\u4f1a\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5728\u540e\u53f0\u751f\u6210\u4e00\u4e2a\u552f\u4e00token\u5b58\u5165redis\uff0ckey\u5c31\u662f\u7528\u6237\u7684id\uff0cvalue\u5c31\u662f\u8fd9\u4e2atoken\uff0c\u540c\u65f6\u628a\u8fd9\u4e2atoken\u8fd4\u56de\u524d\u7aef \u7b2c\u4e8c\u6b21\u8bf7\u6c42\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u4e86\u4e0b\u5355\u64cd\u4f5c\u4f1a\u540e\uff0c\u4f1a\u643a\u5e26\u4e4b\u524d\u7684token\uff0c\u540e\u53f0\u5148\u5230redis\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5982\u679c\u5b58\u5728token\uff0c\u53ef\u4ee5\u6267\u884c\u4e1a\u52a1\uff0c\u540c\u65f6\u5220\u9664token\uff1b\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u4e0d\u5904\u7406\u4e1a\u52a1\uff0c\u5c31\u4fdd\u8bc1\u4e86\u540c\u4e00\u4e2atoken\u53ea\u5904\u7406\u4e00\u6b21\u4e1a\u52a1\uff0c\u5c31\u4fdd\u8bc1\u4e86\u5e42\u7b49\u6027 \u9762\u8bd5\u5b98\uff1a xxl-job\u8def\u7531\u7b56\u7565\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a xxl-job\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u8def\u7531\u7b56\u7565\uff0c\u6211\u4eec\u5e73\u65f6\u7528\u7684\u8f83\u591a\u5c31\u662f\uff1a\u8f6e\u8be2\u3001\u6545\u969c\u8f6c\u79fb\u3001\u5206\u7247\u5e7f\u64ad\u2026 \u9762\u8bd5\u5b98\uff1a xxl-job\u4efb\u52a1\u6267\u884c\u5931\u8d25\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba\uff1a \u6709\u8fd9\u4e48\u51e0\u4e2a\u64cd\u4f5c \u7b2c\u4e00\uff1a\u8def\u7531\u7b56\u7565\u9009\u62e9\u6545\u969c\u8f6c\u79fb\uff0c\u4f18\u5148\u4f7f\u7528\u5065\u5eb7\u7684\u5b9e\u4f8b\u6765\u6267\u884c\u4efb\u52a1 \u7b2c\u4e8c\uff0c\u5982\u679c\u8fd8\u6709\u5931\u8d25\u7684\uff0c\u6211\u4eec\u5728\u521b\u5efa\u4efb\u52a1\u65f6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u91cd\u8bd5\u6b21\u6570 \u7b2c\u4e09\uff0c\u5982\u679c\u8fd8\u6709\u5931\u8d25\u7684\uff0c\u5c31\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6216\u8005\u914d\u7f6e\u90ae\u4ef6\u544a\u8b66\u6765\u901a\u77e5\u76f8\u5173\u8d1f\u8d23\u4eba\u89e3\u51b3 \u9762\u8bd5\u5b98\uff1a \u5982\u679c\u6709\u5927\u6570\u636e\u91cf\u7684\u4efb\u52a1\u540c\u65f6\u90fd\u9700\u8981\u6267\u884c\uff0c\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u4f1a\u8ba9\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5171\u540c\u53bb\u6267\u884c\u8fd9\u4e9b\u6279\u91cf\u7684\u4efb\u52a1\uff0c\u5176\u4e2d\u4efb\u52a1\u7684\u8def\u7531\u7b56\u7565\u662f\u5206\u7247\u5e7f\u64ad \u5728\u4efb\u52a1\u6267\u884c\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5206\u7247\u603b\u6570\u548c\u5f53\u524d\u5206\u7247\uff0c\u6309\u7167\u53d6\u6a21\u7684\u65b9\u5f0f\u5206\u644a\u5230\u5404\u4e2a\u5b9e\u4f8b\u6267\u884c\u5c31\u53ef\u4ee5\u4e86","title":"\u5fae\u670d\u52a1\u9762\u8bd5\u9898 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#_1","text":"\u9762\u8bd5\u5b98\uff1a Spring Cloud 5\u5927\u7ec4\u4ef6\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a \u65e9\u671f\u6211\u4eec\u4e00\u822c\u8ba4\u4e3a\u7684Spring Cloud\u4e94\u5927\u7ec4\u4ef6\u662f Eureka : \u6ce8\u518c\u4e2d\u5fc3 Ribbon : \u8d1f\u8f7d\u5747\u8861 Feign : \u8fdc\u7a0b\u8c03\u7528 Hystrix : \u670d\u52a1\u7194\u65ad Zuul/Gateway : \u7f51\u5173 \u968f\u7740SpringCloudAlibba\u5728\u56fd\u5185\u5174\u8d77 , \u6211\u4eec\u9879\u76ee\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e9b\u963f\u91cc\u5df4\u5df4\u7684\u7ec4\u4ef6 \u6ce8\u518c\u4e2d\u5fc3/\u914d\u7f6e\u4e2d\u5fc3 Nacos \u8d1f\u8f7d\u5747\u8861 Ribbon \u670d\u52a1\u8c03\u7528 Feign \u670d\u52a1\u4fdd\u62a4 sentinel \u670d\u52a1\u7f51\u5173 Gateway \u9762\u8bd5\u5b98\uff1a \u670d\u52a1\u6ce8\u518c\u548c\u53d1\u73b0\u662f\u4ec0\u4e48\u610f\u601d\uff1fSpring Cloud \u5982\u4f55\u5b9e\u73b0\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\uff1f \u5019\u9009\u4eba\uff1a \u6211\u7406\u89e3\u7684\u662f\u4e3b\u8981\u4e09\u5757\u5927\u529f\u80fd\uff0c\u5206\u522b\u662f\u670d\u52a1\u6ce8\u518c \u3001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u72b6\u6001\u76d1\u63a7 \u6211\u4eec\u5f53\u65f6\u9879\u76ee\u91c7\u7528\u7684eureka\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8fd9\u4e2a\u4e5f\u662fspring cloud\u4f53\u7cfb\u4e2d\u7684\u4e00\u4e2a\u6838\u5fc3\u7ec4\u4ef6 \u670d\u52a1\u6ce8\u518c \uff1a\u670d\u52a1\u63d0\u4f9b\u8005\u9700\u8981\u628a\u81ea\u5df1\u7684\u4fe1\u606f\u6ce8\u518c\u5230eureka\uff0c\u7531eureka\u6765\u4fdd\u5b58\u8fd9\u4e9b\u4fe1\u606f\uff0c\u6bd4\u5982\u670d\u52a1\u540d\u79f0\u3001ip\u3001\u7aef\u53e3\u7b49\u7b49 \u670d\u52a1\u53d1\u73b0 \uff1a\u6d88\u8d39\u8005\u5411eureka\u62c9\u53d6\u670d\u52a1\u5217\u8868\u4fe1\u606f\uff0c\u5982\u679c\u670d\u52a1\u63d0\u4f9b\u8005\u6709\u96c6\u7fa4\uff0c\u5219\u6d88\u8d39\u8005\u4f1a\u5229\u7528\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u9009\u62e9\u4e00\u4e2a\u53d1\u8d77\u8c03\u7528 \u670d\u52a1\u76d1\u63a7 \uff1a\u670d\u52a1\u63d0\u4f9b\u8005\u4f1a\u6bcf\u969430\u79d2\u5411eureka\u53d1\u9001\u5fc3\u8df3\uff0c\u62a5\u544a\u5065\u5eb7\u72b6\u6001\uff0c\u5982\u679ceureka\u670d\u52a190\u79d2\u6ca1\u63a5\u6536\u5230\u5fc3\u8df3\uff0c\u4eceeureka\u4e2d\u5254\u9664 \u9762\u8bd5\u5b98\uff1a \u6211\u770b\u4f60\u4e4b\u524d\u4e5f\u7528\u8fc7nacos\u3001\u4f60\u80fd\u8bf4\u4e0bnacos\u4e0eeureka\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u5f53\u65f6xx\u9879\u76ee\u5c31\u662f\u91c7\u7528\u7684nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u9009\u62e9nacos\u8fd8\u8981\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u5c31\u662f\u5b83\u652f\u6301\u914d\u7f6e\u4e2d\u5fc3\uff0c\u4e0d\u8fc7nacos\u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u4e5f\u6bd4eureka\u8981\u65b9\u4fbf\u597d\u7528\u4e00\u4e9b\uff0c\u4e3b\u8981\u76f8\u540c\u4e0d\u540c\u70b9\u5728\u4e8e\u51e0\u70b9\uff1a \u5171\u540c\u70b9 Nacos\u4e0eeureka\u90fd\u652f\u6301\u670d\u52a1\u6ce8\u518c\u548c\u670d\u52a1\u62c9\u53d6\uff0c\u90fd\u652f\u6301\u670d\u52a1\u63d0\u4f9b\u8005\u5fc3\u8df3\u65b9\u5f0f\u505a\u5065\u5eb7\u68c0\u6d4b Nacos\u4e0eEureka\u7684\u533a\u522b \u2460Nacos\u652f\u6301\u670d\u52a1\u7aef\u4e3b\u52a8\u68c0\u6d4b\u63d0\u4f9b\u8005\u72b6\u6001\uff1a\u4e34\u65f6\u5b9e\u4f8b\u91c7\u7528\u5fc3\u8df3\u6a21\u5f0f\uff0c\u975e\u4e34\u65f6\u5b9e\u4f8b\u91c7\u7528\u4e3b\u52a8\u68c0\u6d4b\u6a21\u5f0f \u2461\u4e34\u65f6\u5b9e\u4f8b\u5fc3\u8df3\u4e0d\u6b63\u5e38\u4f1a\u88ab\u5254\u9664\uff0c\u975e\u4e34\u65f6\u5b9e\u4f8b\u5219\u4e0d\u4f1a\u88ab\u5254\u9664 \u2462Nacos\u652f\u6301\u670d\u52a1\u5217\u8868\u53d8\u66f4\u7684\u6d88\u606f\u63a8\u9001\u6a21\u5f0f\uff0c\u670d\u52a1\u5217\u8868\u66f4\u65b0\u66f4\u53ca\u65f6 \u2463Nacos\u96c6\u7fa4\u9ed8\u8ba4\u91c7\u7528AP\u65b9\u5f0f\uff0c\u5f53\u96c6\u7fa4\u4e2d\u5b58\u5728\u975e\u4e34\u65f6\u5b9e\u4f8b\u65f6\uff0c\u91c7\u7528CP\u6a21\u5f0f\uff1bEureka\u91c7\u7528AP\u65b9\u5f0f \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u9879\u76ee\u8d1f\u8f7d\u5747\u8861\u5982\u4f55\u5b9e\u73b0\u7684 ? \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837~~ \u5728\u670d\u52a1\u8c03\u7528\u8fc7\u7a0b\u4e2d\u7684\u8d1f\u8f7d\u5747\u8861\u4e00\u822c\u4f7f\u7528SpringCloud\u7684Ribbon \u7ec4\u4ef6\u5b9e\u73b0 , Feign\u7684\u5e95\u5c42\u5df2\u7ecf\u81ea\u52a8\u96c6\u6210\u4e86Ribbon , \u4f7f\u7528\u8d77\u6765\u975e\u5e38\u7b80\u5355 \u5f53\u53d1\u8d77\u8fdc\u7a0b\u8c03\u7528\u65f6\uff0cribbon\u5148\u4ece\u6ce8\u518c\u4e2d\u5fc3\u62c9\u53d6\u670d\u52a1\u5730\u5740\u5217\u8868\uff0c\u7136\u540e\u6309\u7167\u4e00\u5b9a\u7684\u8def\u7531\u7b56\u7565\u9009\u62e9\u4e00\u4e2a\u53d1\u8d77\u8fdc\u7a0b\u8c03\u7528\uff0c\u4e00\u822c\u7684\u8c03\u7528\u7b56\u7565\u662f\u8f6e\u8be2 \u9762\u8bd5\u5b98\uff1a Ribbon\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u6709\u54ea\u4e9b ? \u5019\u9009\u4eba\uff1a \u6211\u60f3\u60f3\u554a\uff0c\u6709\u5f88\u591a\u79cd\uff0c\u6211\u8bb0\u5f97\u51e0\u4e2a\uff1a RoundRobinRule\uff1a\u7b80\u5355\u8f6e\u8be2\u670d\u52a1\u5217\u8868\u6765\u9009\u62e9\u670d\u52a1\u5668 WeightedResponseTimeRule\uff1a\u6309\u7167\u6743\u91cd\u6765\u9009\u62e9\u670d\u52a1\u5668\uff0c\u54cd\u5e94\u65f6\u95f4\u8d8a\u957f\uff0c\u6743\u91cd\u8d8a\u5c0f RandomRule\uff1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u53ef\u7528\u7684\u670d\u52a1\u5668 ZoneAvoidanceRule\uff1a\u533a\u57df\u654f\u611f\u7b56\u7565\uff0c\u4ee5\u533a\u57df\u53ef\u7528\u7684\u670d\u52a1\u5668\u4e3a\u57fa\u7840\u8fdb\u884c\u670d\u52a1\u5668\u7684\u9009\u62e9\u3002\u4f7f\u7528Zone\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u5206\u7c7b\uff0c\u8fd9\u4e2aZone\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u673a\u623f\u3001\u4e00\u4e2a\u673a\u67b6\u7b49\u3002\u800c\u540e\u518d\u5bf9Zone\u5185\u7684\u591a\u4e2a\u670d\u52a1\u505a\u8f6e\u8be2(\u9ed8\u8ba4) \u9762\u8bd5\u5b98\uff1a \u5982\u679c\u60f3\u81ea\u5b9a\u4e49\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u5982\u4f55\u5b9e\u73b0 ? \u5019\u9009\u4eba\uff1a \u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\uff1a 1\uff0c\u521b\u5efa\u7c7b\u5b9e\u73b0IRule\u63a5\u53e3\uff0c\u53ef\u4ee5\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u8fd9\u4e2a\u662f\u5168\u5c40\u7684\uff0c\u5bf9\u6240\u6709\u7684\u8fdc\u7a0b\u8c03\u7528\u90fd\u8d77\u4f5c\u7528 2\uff0c\u5728\u5ba2\u6237\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u914d\u7f6e\u67d0\u4e00\u4e2a\u670d\u52a1\u8c03\u7528\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ea\u662f\u5bf9\u914d\u7f6e\u7684\u8fd9\u4e2a\u670d\u52a1\u751f\u6548\u8fdc\u7a0b\u8c03\u7528 \u9762\u8bd5\u5b98\uff1a \u4ec0\u4e48\u662f\u670d\u52a1\u96ea\u5d29\uff0c\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1f \u5019\u9009\u4eba\uff1a \u670d\u52a1\u96ea\u5d29\u662f\u6307\u4e00\u4e2a\u670d\u52a1\u5931\u8d25\uff0c\u5bfc\u81f4\u6574\u6761\u94fe\u8def\u7684\u670d\u52a1\u90fd\u5931\u8d25\u7684\u60c5\u5f62\uff0c\u4e00\u822c\u6211\u4eec\u5728\u9879\u76ee\u89e3\u51b3\u7684\u8bdd\u5c31\u662f\u4e24\u79cd\u65b9\u6848\uff0c\u7b2c\u4e00\u4e2a\u662f\u670d\u52a1\u964d\u7ea7\uff0c\u7b2c\u4e8c\u4e2a\u662f\u670d\u52a1\u7194\u65ad\uff0c\u5982\u679c\u6d41\u91cf\u592a\u5927\u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u9650\u6d41 \u670d\u52a1\u964d\u7ea7\uff1a\u670d\u52a1\u81ea\u6211\u4fdd\u62a4\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u6216\u8005\u4fdd\u62a4\u4e0b\u6e38\u670d\u52a1\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u7528\u4e8e\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u53d7\u8bf7\u6c42\u7a81\u589e\u5f71\u54cd\u53d8\u5f97\u4e0d\u53ef\u7528\uff0c\u786e\u4fdd\u670d\u52a1\u4e0d\u4f1a\u5d29\u6e83\uff0c\u4e00\u822c\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u4e0efeign\u63a5\u53e3\u6574\u5408\uff0c\u7f16\u5199\u964d\u7ea7\u903b\u8f91 \u670d\u52a1\u7194\u65ad\uff1a\u9ed8\u8ba4\u5173\u95ed\uff0c\u9700\u8981\u624b\u52a8\u6253\u5f00\uff0c\u5982\u679c\u68c0\u6d4b\u5230 10 \u79d2\u5185\u8bf7\u6c42\u7684\u5931\u8d25\u7387\u8d85\u8fc7 50%\uff0c\u5c31\u89e6\u53d1\u7194\u65ad\u673a\u5236\u3002\u4e4b\u540e\u6bcf\u9694 5 \u79d2\u91cd\u65b0\u5c1d\u8bd5\u8bf7\u6c42\u5fae\u670d\u52a1\uff0c\u5982\u679c\u5fae\u670d\u52a1\u4e0d\u80fd\u54cd\u5e94\uff0c\u7ee7\u7eed\u8d70\u7194\u65ad\u673a\u5236\u3002\u5982\u679c\u5fae\u670d\u52a1\u53ef\u8fbe\uff0c\u5219\u5173\u95ed\u7194\u65ad\u673a\u5236\uff0c\u6062\u590d\u6b63\u5e38\u8bf7\u6c42 \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u7684\u5fae\u670d\u52a1\u662f\u600e\u4e48\u76d1\u63a7\u7684\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u9879\u76ee\u4e2d\u91c7\u7528\u7684skywalking\u8fdb\u884c\u76d1\u63a7\u7684 1\uff0cskywalking\u4e3b\u8981\u53ef\u4ee5\u76d1\u63a7\u63a5\u53e3\u3001\u670d\u52a1\u3001\u7269\u7406\u5b9e\u4f8b\u7684\u4e00\u4e9b\u72b6\u6001\u3002\u7279\u522b\u662f\u5728\u538b\u6d4b\u7684\u65f6\u5019\u53ef\u4ee5\u770b\u5230\u4f17\u591a\u670d\u52a1\u4e2d\u54ea\u4e9b\u670d\u52a1\u548c\u63a5\u53e3\u6bd4\u8f83\u6162\uff0c\u6211\u4eec\u53ef\u4ee5\u9488\u5bf9\u6027\u7684\u5206\u6790\u548c\u4f18\u5316\u3002 2\uff0c\u6211\u4eec\u8fd8\u5728skywalking\u8bbe\u7f6e\u4e86\u544a\u8b66\u89c4\u5219\uff0c\u7279\u522b\u662f\u5728\u9879\u76ee\u4e0a\u7ebf\u4ee5\u540e\uff0c\u5982\u679c\u62a5\u9519\uff0c\u6211\u4eec\u5206\u522b\u8bbe\u7f6e\u4e86\u53ef\u4ee5\u7ed9\u76f8\u5173\u8d1f\u8d23\u4eba\u53d1\u77ed\u4fe1\u548c\u53d1\u90ae\u4ef6\uff0c\u7b2c\u4e00\u65f6\u95f4\u77e5\u9053\u9879\u76ee\u7684bug\u60c5\u51b5\uff0c\u7b2c\u4e00\u65f6\u95f4\u4fee\u590d \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u9879\u76ee\u4e2d\u6709\u6ca1\u6709\u505a\u8fc7\u9650\u6d41 ? \u600e\u4e48\u505a\u7684 ? \u5019\u9009\u4eba\uff1a \u6211\u5f53\u65f6\u505a\u7684xx\u9879\u76ee\uff0c\u91c7\u7528\u5c31\u662f\u5fae\u670d\u52a1\u7684\u67b6\u6784\uff0c\u56e0\u4e3axx\u56e0\u4e3a\uff0c\u5e94\u8be5\u4f1a\u6709\u7a81\u53d1\u6d41\u91cf\uff0c\u6700\u5927QPS\u53ef\u4ee5\u8fbe\u52302000\uff0c\u4f46\u662f\u670d\u52a1\u652f\u6491\u4e0d\u4f4f\uff0c\u6211\u4eec\u9879\u76ee\u90fd\u901a\u8fc7\u538b\u6d4b\u6700\u591a\u53ef\u4ee5\u652f\u64911200QPS\u3002\u56e0\u4e3a\u6211\u4eec\u5e73\u65f6\u7684QPS\u4e5f\u5c31\u4e0d\u5230100\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u7a81\u53d1\u6d41\u91cf\uff0c\u6240\u4ee5\u91c7\u7528\u4e86\u9650\u6d41\u3002 \u3010\u7248\u672c1\u3011 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684nginx\u9650\u6d41\u64cd\u4f5c\uff0cnginx\u4f7f\u7528\u7684\u6f0f\u6876\u7b97\u6cd5\u6765\u5b9e\u73b0\u8fc7\u6ee4\uff0c\u8ba9\u8bf7\u6c42\u4ee5\u56fa\u5b9a\u7684\u901f\u7387\u5904\u7406\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5e94\u5bf9\u7a81\u53d1\u6d41\u91cf\uff0c\u6211\u4eec\u63a7\u5236\u7684\u901f\u7387\u662f\u6309\u7167ip\u8fdb\u884c\u9650\u6d41\uff0c\u9650\u5236\u7684\u6d41\u91cf\u662f\u6bcf\u79d220 \u3010\u7248\u672c2\u3011 \u6211\u4eec\u5f53\u65f6\u91c7\u7528\u7684\u662fspring cloud gateway\u4e2d\u652f\u6301\u5c40\u90e8\u8fc7\u6ee4\u5668RequestRateLimiter\u6765\u505a\u9650\u6d41\uff0c\u4f7f\u7528\u7684\u662f\u4ee4\u724c\u6876\u7b97\u6cd5\uff0c\u53ef\u4ee5\u6839\u636eip\u6216\u8def\u5f84\u8fdb\u884c\u9650\u6d41\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6bcf\u79d2\u586b\u5145\u5e73\u5747\u901f\u7387\uff0c\u548c\u4ee4\u724c\u6876\u603b\u5bb9\u91cf \u9762\u8bd5\u5b98\uff1a \u9650\u6d41\u5e38\u89c1\u7684\u7b97\u6cd5\u6709\u54ea\u4e9b\u5462\uff1f \u5019\u9009\u4eba\uff1a \u6bd4\u8f83\u5e38\u89c1\u7684\u9650\u6d41\u7b97\u6cd5\u6709\u6f0f\u6876\u7b97\u6cd5\u548c\u4ee4\u724c\u6876\u7b97\u6cd5 \u6f0f\u6876\u7b97\u6cd5\u662f\u628a\u8bf7\u6c42\u5b58\u5165\u5230\u6876\u4e2d\uff0c\u4ee5\u56fa\u5b9a\u901f\u7387\u4ece\u6876\u4e2d\u6d41\u51fa\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u7684\u670d\u52a1\u505a\u5230\u7edd\u5bf9\u7684\u5e73\u5747\uff0c\u8d77\u5230\u5f88\u597d\u7684\u9650\u6d41\u6548\u679c \u4ee4\u724c\u6876\u7b97\u6cd5\u5728\u6876\u4e2d\u5b58\u50a8\u7684\u662f\u4ee4\u724c\uff0c\u6309\u7167\u4e00\u5b9a\u7684\u901f\u7387\u751f\u6210\u4ee4\u724c\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u8981\u5148\u7533\u8bf7\u4ee4\u724c\uff0c\u7533\u8bf7\u5230\u4ee4\u724c\u4ee5\u540e\u624d\u80fd\u6b63\u5e38\u8bf7\u6c42\uff0c\u4e5f\u53ef\u4ee5\u8d77\u5230\u5f88\u597d\u7684\u9650\u6d41\u4f5c\u7528 \u5b83\u4eec\u7684\u533a\u522b\u662f\uff0c\u6f0f\u6876\u548c\u4ee4\u724c\u6876\u90fd\u53ef\u4ee5\u5904\u7406\u7a81\u53d1\u6d41\u91cf\uff0c\u5176\u4e2d\u6f0f\u6876\u53ef\u4ee5\u505a\u5230\u7edd\u5bf9\u7684\u5e73\u6ed1\uff0c\u4ee4\u724c\u6876\u6709\u53ef\u80fd\u4f1a\u4ea7\u751f\u7a81\u53d1\u5927\u91cf\u8bf7\u6c42\u7684\u60c5\u51b5\uff0c\u4e00\u822cnginx\u9650\u6d41\u91c7\u7528\u7684\u6f0f\u6876\uff0cspring cloud gateway\u4e2d\u53ef\u4ee5\u652f\u6301\u4ee4\u724c\u6876\u7b97\u6cd5 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fCAP\u7406\u8bba\uff1f \u5019\u9009\u4eba \uff1a CAP\u4e3b\u8981\u662f\u5728\u5206\u5e03\u5f0f\u9879\u76ee\u4e0b\u7684\u4e00\u4e2a\u7406\u8bba\u3002\u5305\u542b\u4e86\u4e09\u9879\uff0c\u4e00\u81f4\u6027\u3001\u53ef\u7528\u6027\u3001\u5206\u533a\u5bb9\u9519\u6027 \u4e00\u81f4\u6027(Consistency)\u662f\u6307\u66f4\u65b0\u64cd\u4f5c\u6210\u529f\u5e76\u8fd4\u56de\u5ba2\u6237\u7aef\u5b8c\u6210\u540e\uff0c\u6240\u6709\u8282\u70b9\u5728\u540c\u4e00\u65f6\u95f4\u7684\u6570\u636e\u5b8c\u5168\u4e00\u81f4(\u5f3a\u4e00\u81f4\u6027)\uff0c\u4e0d\u80fd\u5b58\u5728\u4e2d\u95f4\u72b6\u6001\u3002 \u53ef\u7528\u6027(Availability) \u662f\u6307\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\u5fc5\u987b\u4e00\u76f4\u5904\u4e8e\u53ef\u7528\u7684\u72b6\u6001\uff0c\u5bf9\u4e8e\u7528\u6237\u7684\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u8bf7\u6c42\u603b\u662f\u80fd\u591f\u5728\u6709\u9650\u7684\u65f6\u95f4\u5185\u8fd4\u56de\u7ed3\u679c\u3002 \u5206\u533a\u5bb9\u9519\u6027(Partition tolerance) \u662f\u6307\u5206\u5e03\u5f0f\u7cfb\u7edf\u5728\u9047\u5230\u4efb\u4f55\u7f51\u7edc\u5206\u533a\u6545\u969c\u65f6\uff0c\u4ecd\u7136\u9700\u8981\u80fd\u591f\u4fdd\u8bc1\u5bf9\u5916\u63d0\u4f9b\u6ee1\u8db3\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\u7684\u670d\u52a1\uff0c\u9664\u975e\u662f\u6574\u4e2a\u7f51\u7edc\u73af\u5883\u90fd\u53d1\u751f\u4e86\u6545\u969c\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4ec0\u4e48\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u65e0\u6cd5\u540c\u65f6\u4fdd\u8bc1\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684~~ \u9996\u5148\u4e00\u4e2a\u524d\u63d0\uff0c\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u800c\u8a00\uff0c\u5206\u533a\u5bb9\u9519\u6027\u662f\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u8981\u6c42\uff0c\u56e0\u6b64\u57fa\u672c\u4e0a\u6211\u4eec\u5728\u8bbe\u8ba1\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u65f6\u5019\u53ea\u80fd\u4ece\u4e00\u81f4\u6027\uff08C\uff09\u548c\u53ef\u7528\u6027\uff08A\uff09\u4e4b\u95f4\u8fdb\u884c\u53d6\u820d\u3002 \u5982\u679c\u4fdd\u8bc1\u4e86\u4e00\u81f4\u6027\uff08C\uff09\uff1a\u5bf9\u4e8e\u8282\u70b9N1\u548cN2\uff0c\u5f53\u5f80N1\u91cc\u5199\u6570\u636e\u65f6\uff0cN2\u4e0a\u7684\u64cd\u4f5c\u5fc5\u987b\u88ab\u6682\u505c\uff0c\u53ea\u6709\u5f53N1\u540c\u6b65\u6570\u636e\u5230N2\u65f6\u624d\u80fd\u5bf9N2\u8fdb\u884c\u8bfb\u5199\u8bf7\u6c42\uff0c\u5728N2\u88ab\u6682\u505c\u64cd\u4f5c\u671f\u95f4\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u8bf7\u6c42\u4f1a\u6536\u5230\u5931\u8d25\u6216\u8d85\u65f6\u3002\u663e\u7136\uff0c\u8fd9\u4e0e\u53ef\u7528\u6027\u662f\u76f8\u6096\u7684\u3002 \u5982\u679c\u4fdd\u8bc1\u4e86\u53ef\u7528\u6027\uff08A\uff09\uff1a\u90a3\u5c31\u4e0d\u80fd\u6682\u505cN2\u7684\u8bfb\u5199\u64cd\u4f5c\uff0c\u4f46\u540c\u65f6N1\u5728\u5199\u6570\u636e\u7684\u8bdd\uff0c\u8fd9\u5c31\u8fdd\u80cc\u4e86\u4e00\u81f4\u6027\u7684\u8981\u6c42\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662fBASE\u7406\u8bba\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4e5f\u662fCAP\u5206\u5e03\u5f0f\u7cfb\u7edf\u8bbe\u8ba1\u7406\u8bba BASE\u662fCAP\u7406\u8bba\u4e2dAP\u65b9\u6848\u7684\u5ef6\u4f38\uff0c\u6838\u5fc3\u601d\u60f3\u662f\u5373\u4f7f\u65e0\u6cd5\u505a\u5230\u5f3a\u4e00\u81f4\u6027\uff08StrongConsistency\uff0cCAP\u7684\u4e00\u81f4\u6027\u5c31\u662f\u5f3a\u4e00\u81f4\u6027\uff09\uff0c\u4f46\u5e94\u7528\u53ef\u4ee5\u91c7\u7528\u9002\u5408\u7684\u65b9\u5f0f\u8fbe\u5230\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual Consitency\uff09\u3002\u5b83\u7684\u601d\u60f3\u5305\u542b\u4e09\u65b9\u9762\uff1a 1\u3001Basically Available\uff08\u57fa\u672c\u53ef\u7528\uff09\uff1a\u57fa\u672c\u53ef\u7528\u662f\u6307\u5206\u5e03\u5f0f\u7cfb\u7edf\u5728\u51fa\u73b0\u4e0d\u53ef\u9884\u77e5\u7684\u6545\u969c\u7684\u65f6\u5019\uff0c\u5141\u8bb8\u635f\u5931\u90e8\u5206\u53ef\u7528\u6027\uff0c\u4f46\u4e0d\u7b49\u4e8e\u7cfb\u7edf\u4e0d\u53ef\u7528\u3002 2\u3001Soft state\uff08\u8f6f\u72b6\u6001\uff09\uff1a\u5373\u662f\u6307\u5141\u8bb8\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u5b58\u5728\u4e2d\u95f4\u72b6\u6001\uff0c\u5e76\u8ba4\u4e3a\u8be5\u4e2d\u95f4\u72b6\u6001\u7684\u5b58\u5728\u4e0d\u4f1a\u5f71\u54cd\u7cfb\u7edf\u7684\u6574\u4f53\u53ef\u7528\u6027\uff0c\u5373\u5141\u8bb8\u7cfb\u7edf\u5728\u4e0d\u540c\u8282\u70b9\u7684\u6570\u636e\u526f\u672c\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u540c\u6b65\u7684\u8fc7\u7a0b\u5b58\u5728\u5ef6\u65f6\u3002 3\u3001Eventually consistent\uff08\u6700\u7ec8\u4e00\u81f4\u6027\uff09\uff1a\u5f3a\u8c03\u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u6570\u636e\u526f\u672c\uff0c\u5728\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u540c\u6b65\u540e\uff0c\u6700\u7ec8\u80fd\u591f\u8fbe\u5230\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001\u3002\u5176\u672c\u8d28\u662f\u9700\u8981\u7cfb\u7edf\u4fdd\u8bc1\u6700\u7ec8\u6570\u636e\u80fd\u591f\u8fbe\u5230\u4e00\u81f4\uff0c\u800c\u4e0d\u9700\u8981\u5b9e\u65f6\u4fdd\u8bc1\u7cfb\u7edf\u6570\u636e\u7684\u5f3a\u4e00\u81f4\u6027\u3002 \u9762\u8bd5\u5b98\uff1a \u4f60\u4eec\u91c7\u7528\u54ea\u79cd\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u5f53\u65f6\u662fxx\u9879\u76ee\uff0c\u4e3b\u8981\u4f7f\u7528\u5230\u7684seata\u7684at\u6a21\u5f0f\u89e3\u51b3\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1 seata\u7684AT\u6a21\u578b\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff1a 1\u3001\u9636\u6bb5\u4e00RM\u7684\u5de5\u4f5c\uff1a\u2460 \u6ce8\u518c\u5206\u652f\u4e8b\u52a1 \u2461 \u8bb0\u5f55undo-log\uff08\u6570\u636e\u5feb\u7167\uff09\u2462 \u6267\u884c\u4e1a\u52a1sql\u5e76\u63d0\u4ea4 \u2463\u62a5\u544a\u4e8b\u52a1\u72b6\u6001 2\u3001\u9636\u6bb5\u4e8c\u63d0\u4ea4\u65f6RM\u7684\u5de5\u4f5c\uff1a\u5220\u9664undo-log\u5373\u53ef 3\u3001\u9636\u6bb5\u4e8c\u56de\u6eda\u65f6RM\u7684\u5de5\u4f5c\uff1a\u6839\u636eundo-log\u6062\u590d\u6570\u636e\u5230\u66f4\u65b0\u524d at\u6a21\u5f0f\u727a\u7272\u4e86\u4e00\u81f4\u6027\uff0c\u4fdd\u8bc1\u4e86\u53ef\u7528\u6027\uff0c\u4e0d\u8fc7\uff0c\u5b83\u4fdd\u8bc1\u7684\u662f\u6700\u7ec8\u4e00\u81f4\u6027 \u9762\u8bd5\u5b98\uff1a \u5206\u5e03\u5f0f\u670d\u52a1\u7684\u63a5\u53e3\u5e42\u7b49\u6027\u5982\u4f55\u8bbe\u8ba1\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u6211\u4eec\u5f53\u65f6\u6709\u4e00\u4e2axx\u9879\u76ee\u7684\u4e0b\u5355\u64cd\u4f5c\uff0c\u91c7\u7528\u7684token+redis\u5b9e\u73b0\u7684\uff0c\u6d41\u7a0b\u662f\u8fd9\u6837\u7684 \u7b2c\u4e00\u6b21\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u7528\u6237\u6253\u5f00\u4e86\u5546\u54c1\u8be6\u60c5\u9875\u9762\uff0c\u6211\u4eec\u4f1a\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5728\u540e\u53f0\u751f\u6210\u4e00\u4e2a\u552f\u4e00token\u5b58\u5165redis\uff0ckey\u5c31\u662f\u7528\u6237\u7684id\uff0cvalue\u5c31\u662f\u8fd9\u4e2atoken\uff0c\u540c\u65f6\u628a\u8fd9\u4e2atoken\u8fd4\u56de\u524d\u7aef \u7b2c\u4e8c\u6b21\u8bf7\u6c42\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u4e86\u4e0b\u5355\u64cd\u4f5c\u4f1a\u540e\uff0c\u4f1a\u643a\u5e26\u4e4b\u524d\u7684token\uff0c\u540e\u53f0\u5148\u5230redis\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5982\u679c\u5b58\u5728token\uff0c\u53ef\u4ee5\u6267\u884c\u4e1a\u52a1\uff0c\u540c\u65f6\u5220\u9664token\uff1b\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u4e0d\u5904\u7406\u4e1a\u52a1\uff0c\u5c31\u4fdd\u8bc1\u4e86\u540c\u4e00\u4e2atoken\u53ea\u5904\u7406\u4e00\u6b21\u4e1a\u52a1\uff0c\u5c31\u4fdd\u8bc1\u4e86\u5e42\u7b49\u6027 \u9762\u8bd5\u5b98\uff1a xxl-job\u8def\u7531\u7b56\u7565\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba\uff1a xxl-job\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u8def\u7531\u7b56\u7565\uff0c\u6211\u4eec\u5e73\u65f6\u7528\u7684\u8f83\u591a\u5c31\u662f\uff1a\u8f6e\u8be2\u3001\u6545\u969c\u8f6c\u79fb\u3001\u5206\u7247\u5e7f\u64ad\u2026 \u9762\u8bd5\u5b98\uff1a xxl-job\u4efb\u52a1\u6267\u884c\u5931\u8d25\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba\uff1a \u6709\u8fd9\u4e48\u51e0\u4e2a\u64cd\u4f5c \u7b2c\u4e00\uff1a\u8def\u7531\u7b56\u7565\u9009\u62e9\u6545\u969c\u8f6c\u79fb\uff0c\u4f18\u5148\u4f7f\u7528\u5065\u5eb7\u7684\u5b9e\u4f8b\u6765\u6267\u884c\u4efb\u52a1 \u7b2c\u4e8c\uff0c\u5982\u679c\u8fd8\u6709\u5931\u8d25\u7684\uff0c\u6211\u4eec\u5728\u521b\u5efa\u4efb\u52a1\u65f6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u91cd\u8bd5\u6b21\u6570 \u7b2c\u4e09\uff0c\u5982\u679c\u8fd8\u6709\u5931\u8d25\u7684\uff0c\u5c31\u53ef\u4ee5\u67e5\u770b\u65e5\u5fd7\u6216\u8005\u914d\u7f6e\u90ae\u4ef6\u544a\u8b66\u6765\u901a\u77e5\u76f8\u5173\u8d1f\u8d23\u4eba\u89e3\u51b3 \u9762\u8bd5\u5b98\uff1a \u5982\u679c\u6709\u5927\u6570\u636e\u91cf\u7684\u4efb\u52a1\u540c\u65f6\u90fd\u9700\u8981\u6267\u884c\uff0c\u600e\u4e48\u89e3\u51b3\uff1f \u5019\u9009\u4eba\uff1a \u6211\u4eec\u4f1a\u8ba9\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5171\u540c\u53bb\u6267\u884c\u8fd9\u4e9b\u6279\u91cf\u7684\u4efb\u52a1\uff0c\u5176\u4e2d\u4efb\u52a1\u7684\u8def\u7531\u7b56\u7565\u662f\u5206\u7247\u5e7f\u64ad \u5728\u4efb\u52a1\u6267\u884c\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5206\u7247\u603b\u6570\u548c\u5f53\u524d\u5206\u7247\uff0c\u6309\u7167\u53d6\u6a21\u7684\u65b9\u5f0f\u5206\u644a\u5230\u5404\u4e2a\u5b9e\u4f8b\u6267\u884c\u5c31\u53ef\u4ee5\u4e86","title":"\u5fae\u670d\u52a1\u9762\u8bd5\u9898"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/","text":"\u9879\u76ee\u94fe\u8def\u8ffd\u8e2a 1.\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u6982\u8ff0 \u968f\u7740\u7cfb\u7edf\u8bbe\u8ba1\u53d8\u5f97\u65e5\u8d8b\u590d\u6742\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u7ec4\u4ef6\u5f00\u59cb\u8d70\u5411\u5206\u5e03\u5f0f\u5316\uff0c\u5982\u5fae\u670d\u52a1\u3001\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3001\u5206\u5e03\u5f0f\u7f13\u5b58\u7b49\uff0c\u4f7f\u5f97\u540e\u53f0\u670d\u52a1\u6784\u6210\u4e86\u4e00\u79cd\u590d\u6742\u7684\u5206\u5e03\u5f0f\u7f51\u7edc\u3002\u5f80\u5f80\u524d\u7aef\u7684\u4e00\u4e2a\u8bf7\u6c42\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u5fae\u670d\u52a1\u3001\u8de8\u8d8a\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u624d\u80fd\u6700\u7ec8\u83b7\u53d6\u5230\u7ed3\u679c\uff0c\u5982\u4e0b\u56fe \u5e76\u4e14\u968f\u7740\u4e1a\u52a1\u7684\u4e0d\u65ad\u6269\u5f20\uff0c\u670d\u52a1\u4e4b\u95f4\u4e92\u76f8\u8c03\u7528\u4f1a\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u8fd9\u4e2a\u5e9e\u5927\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u8c03\u7528\u7f51\u7edc\u53ef\u80fd\u4f1a\u53d8\u7684\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u90a3\u968f\u4e4b\u800c\u6765\u7684\u5c31\u662f\u6211\u4eec\u5c06\u4f1a\u9762\u4e34\u7684\u8bf8\u591a\u56f0\u6270\uff1a \u95ee\u9898\u5b9a\u4f4d\uff1a\u5f53\u67d0\u4e00\u4e2a\u670d\u52a1\u8282\u70b9\u51fa\u73b0\u95ee\u9898\u5bfc\u81f4\u6574\u4e2a\u8c03\u7528\u5931\u8d25\uff0c\u65e0\u6cd5\u5feb\u901f\u6e05\u6670\u5730\u5b9a\u4f4d\u95ee\u9898\u670d\u52a1\u3002 \u6027\u80fd\u5206\u6790\uff1a\u670d\u52a1\u5b58\u5728\u76f8\u4e92\u4f9d\u8d56\u8c03\u7528\u7684\u5173\u7cfb\uff0c\u5f53\u67d0\u4e00\u4e2a\u670d\u52a1\u63a5\u53e3\u8017\u65f6\u8fc7\u957f\uff0c\u4f1a\u5bfc\u81f4\u6574\u4e2a\u63a5\u53e3\u8c03\u7528\u53d8\u7684\u5f88\u6162\uff0c\u6211\u4eec\u65e0\u6cd5\u660e\u786e\u6bcf\u4e00\u4e2a\u63a5\u53e3\u7684\u8017\u65f6\u3002 \u670d\u52a1\u62d3\u6251\u56fe\uff1a\u968f\u7740\u9700\u6c42\u8fed\u4ee3\uff0c\u7cfb\u7edf\u4e4b\u95f4\u8c03\u7528\u5173\u7cfb\u53d8\u5316\u9891\u7e41\uff0c\u9760\u4eba\u5de5\u5f88\u96be\u68b3\u7406\u6e05\u695a\u7cfb\u7edf\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u3002 \u670d\u52a1\u544a\u8b66\uff1a\u5f53\u670d\u52a1\u51fa\u73b0\u95ee\u9898\uff0c\u6211\u4eec\u65e0\u6cd5\u505a\u5230\u7531\u7cfb\u7edf\u81ea\u52a8\u901a\u77e5\u76f8\u5173\u4eba\u5458\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u5e94\u8fd0\u800c\u751f\u3002\u5b83\u4f1a\u5c06\u4e00\u6b21\u5206\u5e03\u5f0f\u8bf7\u6c42\u8fd8\u539f\u6210\u8c03\u7528\u94fe\u8def\uff0c\u5c06\u4e00\u6b21\u5206\u5e03\u5f0f\u8bf7\u6c42\u7684\u8c03\u7528\u60c5\u51b5\u96c6\u4e2d\u5c55\u793a\uff0c\u6bd4\u5982\u5404\u4e2a\u670d\u52a1\u8282\u70b9\u4e0a\u7684\u8017\u65f6\u3001\u8bf7\u6c42\u5177\u4f53\u5230\u8fbe\u54ea\u53f0\u673a\u5668\u4e0a\u3001\u6bcf\u4e2a\u670d\u52a1\u8282\u70b9\u7684\u8bf7\u6c42\u72b6\u6001\u3001\u751f\u6210\u670d\u52a1\u8c03\u7528\u62d3\u6251\u56fe\u7b49\u7b49\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u8981\u8bbe\u8ba1\u5e76\u5f00\u53d1\u4e00\u4e9b\u5206\u5e03\u5f0f\u8ffd\u8e2a\u7cfb\u7edf\u6765\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898 2.java\u63a2\u9488\u6280\u672f-javaAgent 4.1.javaAgent\u6982\u8ff0 Java Agent\u8fd9\u4e2a\u6280\u672f\u5bf9\u5927\u591a\u6570\u4eba\u6765\u8bf4\u90fd\u6bd4\u8f83\u964c\u751f\uff0c\u4f46\u662f\u5927\u5bb6\u90fd\u90fd\u591a\u591a\u5c11\u5c11\u63a5\u89e6\u8fc7\u4e00\u4e9b\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e73\u65f6\u7528\u8fc7\u7684\u5f88\u591a\u5de5\u5177\u90fd\u662f\u57fa\u4e8ejava Agent\u6765\u5b9e\u73b0\u7684\uff0c\u4f8b\u5982\uff1a\u70ed\u90e8\u7f72\u5de5\u5177JRebel\uff0cspringboot\u7684\u70ed\u90e8\u7f72\u63d2\u4ef6\uff0c\u5404\u79cd\u7ebf\u4e0a\u8bca\u65ad\u5de5\u5177\uff08btrace, greys\uff09\uff0c\u963f\u91cc\u5f00\u6e90\u7684arthas\u7b49\u7b49\u3002 \u5176\u5b9ejava Agent\u5728JDK1.5\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528agent\u6280\u672f\u6784\u5efa\u4e00\u4e2a\u72ec\u7acb\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7406\u7a0b\u5e8f\uff08\u5373Agent\uff09\uff0c\u7528\u6765\u534f\u52a9\u76d1\u6d4b\u3001\u8fd0\u884c\u751a\u81f3\u66ff\u6362\u5176\u4ed6JVM\u4e0a\u7684\u7a0b\u5e8f\u3002\u4f7f\u7528\u5b83\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u673a\u7ea7\u522b\u7684AOP\u529f\u80fd\uff0c\u5e76\u4e14\u8fd9\u79cd\u65b9\u5f0f\u4e00\u4e2a\u5178\u578b\u7684\u4f18\u52bf\u5c31\u662f\u65e0\u4ee3\u7801\u4fb5\u5165\u3002 Agent\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u5728\u4e3b\u7a0b\u5e8f\u4e4b\u524d\u8fd0\u884c\u7684Agent\uff0c\u4e00\u79cd\u662f\u5728\u4e3b\u7a0b\u5e8f\u4e4b\u540e\u8fd0\u884c\u7684Agent\uff08\u524d\u8005\u7684\u5347\u7ea7\u7248\uff0c1.6\u4ee5\u540e\u63d0\u4f9b\uff09\u3002 3.skyWalking 3.1.skyWalking\u6982\u8ff0 2015\u5e74\u7531\u4e2a\u4eba\u5434\u665f\uff08\u534e\u4e3a\u5f00\u53d1\u8005\uff09\u4e3b\u5bfc\u5f00\u6e90\uff0c\u4f5c\u8005\u662f\u534e\u4e3a\u5f00\u53d1\u4e91\u76d1\u63a7\u4ea7\u54c1\u7ecf\u7406\uff0c\u4e3b\u5bfc\u76d1\u63a7\u4ea7\u54c1\u7684\u89c4\u5212\u3001\u6280\u672f\u8def\u7ebf\u53ca\u76f8\u5173\u7814\u53d1\u5de5\u4f5c\uff0c\u4e5f\u662fOpenTracing\u5206\u5e03\u5f0f\u8ffd\u8e2a\u6807\u51c6\u7ec4\u7ec7\u6210\u5458 \uff0c\u8be5\u9879\u76ee 2017\u5e74\u52a0\u5165Apache\u5b75\u5316\u5668\uff0c\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff08APM\uff09\uff0c\u4e13\u4e3a\u5fae\u670d\u52a1\u3001\u4e91\u539f\u751f\u67b6\u6784\u548c\u57fa\u4e8e\u5bb9\u5668\uff08Docker\u3001K8s\u3001Mesos\uff09\u67b6\u6784\u800c\u8bbe\u8ba1\u3002 \u5b98\u65b9\u7ad9\u70b9\uff1a http://skywalking.apache.org/ GitHub\u9879\u76ee\u5730\u5740\uff1a https://github.com/apache/skywalking \u5176\u6838\u5fc3\u529f\u80fd\u8981\u70b9\u5982\u4e0b\uff1a \u6307\u6807\u5206\u6790 \uff1a\u670d\u52a1\uff0c\u5b9e\u4f8b\uff0c\u7aef\u70b9\u6307\u6807\u5206\u6790 \u95ee\u9898\u5206\u6790 \uff1a\u5728\u8fd0\u884c\u65f6\u5206\u6790\u4ee3\u7801\uff0c\u627e\u5230\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0 \u670d\u52a1\u62d3\u6251 \uff1a\u63d0\u4f9b\u670d\u52a1\u7684\u62d3\u6251\u56fe\u5206\u6790 \u4f9d\u8d56\u5206\u6790 \uff1a\u670d\u52a1\u5b9e\u4f8b\u548c\u7aef\u70b9\u4f9d\u8d56\u6027\u5206\u6790 \u670d\u52a1\u68c0\u6d4b \uff1a\u68c0\u6d4b\u6162\u901f\u7684\u670d\u52a1\u548c\u7aef\u70b9 \u6027\u80fd\u4f18\u5316 \uff1a\u6839\u636e\u670d\u52a1\u76d1\u63a7\u7684\u7ed3\u679c\u63d0\u4f9b\u6027\u80fd\u4f18\u5316\u7684\u601d\u8def \u94fe\u8def\u8ffd\u8e2a \uff1a\u5206\u5e03\u5f0f\u8ddf\u8e2a\u548c\u4e0a\u4e0b\u6587\u4f20\u64ad \u6570\u636e\u5e93\u76d1\u63a7 \uff1a\u6570\u636e\u5e93\u8bbf\u95ee\u6307\u6807\u76d1\u63a7\u7edf\u8ba1\uff0c\u68c0\u6d4b\u6162\u901f\u6570\u636e\u5e93\u8bbf\u95ee\u8bed\u53e5\uff08\u5305\u62ecSQL\u8bed\u53e5\uff09 \u670d\u52a1\u544a\u8b66 \uff1a\u670d\u52a1\u544a\u8b66\u529f\u80fd \u540d\u8bcd\u89e3\u91ca\uff1a \u670d\u52a1\uff08service\uff09\uff1a\u4e1a\u52a1\u8d44\u6e90\u5e94\u7528\u7cfb\u7edf \u7aef\u70b9\uff08endpoint\uff09\uff1a\u5e94\u7528\u7cfb\u7edf\u5bf9\u5916\u66b4\u9732\u7684\u529f\u80fd\u63a5\u53e3 \u5b9e\u4f8b\uff08instance\uff09\uff1a\u7269\u7406\u673a 3.2.skyWalking\u67b6\u6784\u8bbe\u8ba1 skyWalking\u7684\u6574\u4f53\u67b6\u6784\u8bbe\u8ba1\u5982\u4e0b\u56fe\u6240\u793a\uff1a skyWalking\u6574\u4f53\u53ef\u5206\u4e3a\uff1a\u5ba2\u6237\u7aef\uff0c\u670d\u52a1\u7aef \u5ba2\u6237\u7aef\uff1aagent\u7ec4\u4ef6 \u200b \u57fa\u4e8e\u63a2\u9488\u6280\u672f\u91c7\u96c6\u670d\u52a1\u76f8\u5173\u4fe1\u606f\uff08\u5305\u62ec\u8ddf\u8e2a\u6570\u636e\u548c\u7edf\u8ba1\u6570\u636e\uff09\uff0c\u7136\u540e\u5c06\u91c7\u96c6\u5230\u7684\u6570\u636e\u4e0a\u62a5\u7ed9skywalking\u7684\u6570\u636e\u6536\u96c6\u5668 \u670d\u52a1\u7aef\uff1a\u53c8\u5206\u4e3aOAP\uff0cStorage\uff0cWebUI OAP\uff1aobservability analysis platform\u53ef\u89c2\u6d4b\u6027\u5206\u6790\u5e73\u53f0\uff0c\u8d1f\u8d23\u63a5\u6536\u5ba2\u6237\u7aef\u4e0a\u62a5\u7684\u6570\u636e\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u6790\uff0c\u805a\u5408\uff0c\u8ba1\u7b97\u540e\u5c06\u6570\u636e\u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u4e14\u8fd8\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u67e5\u8be2API\u8fdb\u884c\u6570\u636e\u7684\u67e5\u8be2\uff0c\u8fd9\u4e2a\u6a21\u5757\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf\u7684Collector\u6536\u96c6\u5668 Storage\uff1askyWalking\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u9ed8\u8ba4\u662f\u91c7\u7528H2\uff0c\u540c\u65f6\u652f\u6301\u8bb8\u591a\u5176\u4ed6\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u6bd4\u5982\uff1aElastaticSearch\uff0cmysql\u7b49 WebUI\uff1a\u63d0\u4f9b\u4e00\u4e9b\u56fe\u5f62\u5316\u754c\u9762\u5c55\u793a\u5bf9\u5e94\u7684\u8ddf\u8e2a\u6570\u636e\uff0c\u6307\u6807\u6570\u636e\u7b49\u7b49 3.3.skyWalking\u73af\u5883\u642d\u5efa 3.3.1.skyWalking\u4e0b\u8f7d skyWalking\u53ef\u4ece\u5b98\u65b9\u7ad9\u70b9\u4e0b\u8f7d\uff1ahttp://skywalking.apache.org/downloads/\uff0c\u672c\u6587\u4e2d\u4f7f\u75288.2.0\u7248\u672c 3.3.3.docker\u90e8\u7f72skyWalking (1)\u5b89\u88c5OAP docker\u62c9\u53d6\u955c\u50cf\uff0c\u53ef\u4ee5\u4f7f\u7528\u8d44\u6599\u4e2d\u63d0\u4f9b\u597d\u7684\u6587\u4ef6\u52a0\u8f7d\u4e3a\u955c\u50cf docker pull apache/skywalking-oap-server \u521b\u5efa\u5bb9\u5668 docker run --name skywalking -d -p 1234:1234 -p 11800:11800 -p 12800:12800 --restart always apache/skywalking-oap-server skyWalking\u9ed8\u8ba4\u4f7f\u7528H2\u8fdb\u884c\u4fe1\u606f\u5b58\u50a8\uff0c\u4f46H2\u4e00\u65e6\u91cd\u542f\u6570\u636e\u5c31\u4f1a\u4e22\u5931\uff0c\u56e0\u6b64\u91c7\u7528ES\u66ff\u6362H2\u5bf9skyWalking\u4e2d\u6570\u636e\u4fe1\u606f\u5b58\u50a8\uff0c\u9879\u76ee\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86elasticsearch\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u9700\u8981\u6307\u5b9aelasticsearch\u7684\u5730\u5740 oap\u5bb9\u5668\u521b\u5efa\u5b8c\u6210\u4ee5\u540e\uff0c\u8fdb\u5165\u5bb9\u5668\u4e2d docker exec -it fe372cdaece2 /bin/bash \u4fee\u6539\u6587\u4ef6\uff1a /config/application.yml\uff0c\u5982\u4e0b\u6548\u679c \u91cd\u542f\u5bb9\u5668\uff0c\u4fdd\u8bc1130\u8fd9\u53f0\u670d\u52a1\u5668\u4e0a\u7684elasticsearch\u5df2\u7ecf\u542f\u52a8 (2)\u5b89\u88c5UI \u62c9\u53d6\u955c\u50cf\uff0c\u53ef\u4ee5\u4f7f\u7528\u8d44\u6599\u4e2d\u63d0\u4f9b\u597d\u7684\u6587\u4ef6\u52a0\u8f7d\u4e3a\u955c\u50cf docker pull apache/skywalking-ui \u521b\u5efa\u5bb9\u5668 docker run --name skywalking-ui -d -p 8686:8080 --link skywalking:skywalking -e SW_OAP_ADDRESS=skywalking:12800 --restart always apache/skywalking-ui \u542f\u52a8\u6210\u529f\u540e\u8bbf\u95eeskywalking\u7684webui\u9875\u9762\uff1a http://192.168.200.100:8686/ 3.4.\u5e94\u7528\u7a0b\u5e8f\u63a5\u5165skyWalking \u5e94\u7528\u7a0b\u5e8f\u63a5\u5165skywalking\u975e\u5e38\u7684\u7b80\u5355\uff0c\u53ea\u9700\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\u901a\u8fc7 -javaagent \u6765\u6307\u5b9askyWalking\u7684agent\u7684\u7ec4\u4ef6 \u9996\u5148\u5728\u4e0b\u8f7d\u597d\u7684skyWalking\u4e2d\u627e\u5230agent\u7ec4\u4ef6\uff1a \u8fdb\u5165\u5230agent\u76ee\u5f55\uff1a \u901a\u8fc7 -javaagent \u6765\u6307\u5b9askywalking\u7684agent\u7ec4\u4ef6\u7684skywalking-agent.jar\u5373\u53ef \u53e6\u5916\uff1aagent\u8d1f\u8d23\u91c7\u96c6\u6570\u636e\u7136\u540e\u5c06\u6570\u636e\u63d0\u4ea4\u5230OAP\uff08collector\uff09\u4e2d\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5728agent\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9aOAP\u7684\u5730\u5740\uff0c\u5f53\u7136\u9ed8\u8ba4\u662f\u672c\u5730127.0.0.1 \u8fdb\u5165\u5230config\u76ee\u5f55\uff0c\u627e\u5230\uff1aagent.config\u914d\u7f6e\u6587\u4ef6 \u672a\u4fee\u6539\u524d\u5982\u4e0b\uff1a \u4fee\u6539\u540e\u5982\u4e0b\uff1a \u5f53\u524dagent\u5bf9\u4e8espring cloud gateway\u652f\u6301\u7684\u4e0d\u597d\uff0c\u9700\u8981\u624b\u52a8\u4fee\u6539\u51e0\u4e2a\u63d2\u4ef6\uff0c\u4eceagent\u5305\u4e0b\u7684optional-plugins\u5305\u4e0b\u7684\u4e24\u4e2ajar\u5305\uff0c\u62f7\u8d1d\u5230agent/plugins\u5305\u4e0b\u5373\u53ef apm-spring-cloud-gateway-2.1.x-plugin-8.2.0.jar apm-spring-webflux-5.x-plugin-8.2.0.jar \u63a5\u4e0b\u6765\u6211\u4eec\u4f9d\u6b21\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\uff0c\u4ee5\u9ed1\u9a6c\u5934\u6761heima-leadnews-user\u4e2d\u7684heima-leadnews-app-gateway\uff0cheima-leadnews-article\u4e3a\u4f8b\u6765\u542f\u52a8\uff0c\u6211\u4eec\u53ea\u9700\u4fee\u6539\u542f\u52a8\u53c2\u6570\u5373\u53ef\uff0c \u6211\u4eec\u9700\u8981\u5c06\u542f\u52a8\u53c2\u6570\u4fee\u6539\u5982\u4e0b(\u6ce8\u610f\uff1a\u8981\u6307\u5411\u81ea\u5df1\u7535\u8111\u4e2d\u7684agent\u5b58\u653e\u7684\u4f4d\u7f6e) -javaagent:D:\\develop\\agent\\skywalking-agent.jar -Dskywalking.agent.service_name=heima-leadnews-user \u6ce8\u610f\uff1a\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u4f5c\u591a\u8282\u70b9\u90e8\u7f72\uff0c\u4fdd\u8bc1\u670d\u52a1\u540d\u79f0\u4e0d\u4e00\u6837 \u56fe\u793a\u5982\u4e0b\uff1a \u4e09\u4e2a\u670d\u52a1\u90fd\u8981\u4fee\u6539\u542f\u52a8\u53c2\u6570\uff0c\u7136\u540e\u542f\u52a8\u9879\u76ee \u8bbf\u95ee\uff1ahttp://192.168.200.100:8686\u67e5\u770bskywalking\u7684ui UI\u76d1\u63a7\u89c6\u89d2\u4e0e\u6307\u6807\u4ecb\u7ecd \u6211\u4eec\u89e3\u8bfb\u4e00\u4e0b\u6bd4\u8f83\u964c\u751f\u7684\u4e00\u4e9b\u6307\u6807\uff1a \u7528\u6237\u6ee1\u610f\u5ea6Apdex Score Apdex\u662f\u57fa\u4e8e\u8bbe\u7f6e\u7684\u9608\u503c\u7684\u54cd\u5e94\u65f6\u95f4\u7684\u5ea6\u91cf\u3002\u5b83\u6d4b\u91cf\u4e86\u6ee1\u610f\u7684\u54cd\u5e94\u65f6\u95f4\u4e0e\u4e0d\u6ee1\u610f\u7684\u54cd\u5e94\u65f6\u95f4\u4e4b\u6bd4\u3002\u4ece\u8d44\u4ea7\u8bf7\u6c42\u5230\u5b8c\u6210\u4ea4\u4ed8\u56de\u8bf7\u6c42\u8005\u7684\u54cd\u5e94\u65f6\u95f4\u3002 \u7ba1\u7406\u5458\uff0c\u6240\u6709\u8005\u6216\u9644\u52a0\u7ec4\u4ef6\u7ba1\u7406\u5668\u5b9a\u4e49\u54cd\u5e94\u65f6\u95f4\u9608\u503c T \u3002\u5728 T \u77ed\u65f6\u95f4\u5185\u5904\u7406\u7684\u6240\u6709\u54cd\u5e94\u90fd\u80fd\u4f7f\u7528\u6237\u6ee1\u610f\u3002 \u4f8b\u5982\uff0c\u5982\u679c T \u4e3a1.2\u79d2\uff0c\u5e76\u4e14\u54cd\u5e94\u57280.5\u79d2\u5185\u5b8c\u6210\uff0c\u5219\u7528\u6237\u4f1a\u611f\u5230\u6ee1\u610f\u3002\u6240\u6709\u5927\u4e8e1.2\u79d2\u7684\u54cd\u5e94\u90fd\u4f7f\u7528\u6237\u4e0d\u6ee1\u610f\u3002\u5927\u4e8e4.8\u79d2\u7684\u54cd\u5e94\u4f7f\u7528\u6237\u611f\u5230\u6cae\u4e27\u3002 cpm \u6bcf\u5206\u949f\u8bf7\u6c42\u6570 cpm \u5168\u79f0 call per minutes\uff0c\u662f\u541e\u5410\u91cf(Throughput)\u6307\u6807\u3002 \u4e0b\u56fe\u662f\u62fc\u63a5\u7684\u5168\u5c40\u3001\u670d\u52a1\u3001\u5b9e\u4f8b\u548c\u63a5\u53e3\u7684\u541e\u5410\u91cf\u53ca\u5e73\u5747\u541e\u5410\u91cf\u3002 185cpm=185/60=3.08\u4e2a\u8bf7\u6c42/\u79d2 SLA \u670d\u52a1\u7b49\u7ea7\u534f\u8bae \u670d\u52a1\u7b49\u7ea7\u534f\u8bae\u7528\u6765\u8868\u793a\u63d0\u4f9b\u670d\u52a1\u7684\u6c34\u5e73\uff0c\u53ef\u4ee5\u8861\u91cf\u5e73\u53f0\u7684\u53ef\u7528\u6027\uff0c\u4e0b\u9762\u662fN\u4e2a9\u7684\u8ba1\u7b97 1\u5e74 = 365\u5929 = 8760\u5c0f\u65f6 99 = 8760 * 1% => 3.65\u5929----------------\u300b\u76f8\u5f53\u4e8e\u5168\u5e74\u67093.65\u5929\u4e0d\u53ef\u7528\uff0c2\u4e2a9\u5c31\u57fa\u672c\u4e0d\u53ef\u7528\u4e86 99.9 = 8760 * 0.1% => 8.76\u5c0f\u65f6--------------\u300b\u76f8\u5f53\u4e8e\u5168\u5e74\u67098.76\u5c0f\u65f6\u4e0d\u53ef\u7528 99.99 = 8760 * 0.01% => 52.6\u5206\u949f 99.999 = 8760 * 0.001% => 5.26\u5206\u949f \u56e0\u6b64\uff0c\u5168\u5e74\u53ea\u8981\u53d1\u751f\u4e00\u6b21\u8f83\u5927\u89c4\u6a21\u5b95\u673a\u4e8b\u6545\uff0c4\u4e2a9\u80af\u5b9a\u6ca1\u620f\uff0c\u4e00\u822c\u5e73\u53f03\u4e2a9\u5dee\u4e0d\u591a\u3002 Percent Response \u767e\u5206\u4f4d\u6570\u7edf\u8ba1 Skywalking \u6709 \u201cp50\u3001p75\u3001p90\u3001p95\u3001p99\u201d \u4e00\u4e9b\u5217\u503c\uff0c\u56fe\u4e2d\u7684 \u201cp99:390\u201d \u8868\u793a 99% \u8bf7\u6c42\u7684\u54cd\u5e94\u65f6\u95f4\u5728390ms\u4ee5\u5185\u3002 Heatmap \u70ed\u529b\u56fe Heapmap \u53ef\u8bd1\u4e3a\u70ed\u529b\u56fe\u3001\u70ed\u5ea6\u56fe\u90fd\u53ef\u4ee5\uff0c\u56fe\u4e2d\u989c\u8272\u8d8a\u6df1\uff0c\u8868\u793a\u8bf7\u6c42\u6570\u8d8a\u591a\uff0c\u8fd9\u548cGitHub Contributions\u5f88\u50cf\uff0ccommit\u8d8a\u591a\uff0c\u989c\u8272\u8d8a\u6df1\u3002 \u7eb5\u5750\u6807\u662f\u54cd\u5e94\u65f6\u95f4\uff0c\u9f20\u6807\u653e\u4e0a\u53bb\uff0c\u53ef\u4ee5\u770b\u5230\u5177\u4f53\u7684\u6570\u91cf\u3002 \u901a\u8fc7\u70ed\u529b\u56fe\uff0c\u4e00\u65b9\u9762\u53ef\u4ee5\u76f4\u89c2\u611f\u53d7\u5e73\u53f0\u7684\u6574\u4f53\u6d41\u91cf\uff0c\u53e6\u4e00\u65b9\u9762\u4e5f\u53ef\u4ee5\u611f\u53d7\u6574\u4f53\u6027\u80fd\u3002 3.5.skyWalking\u914d\u7f6e\u5e94\u7528\u544a\u8b66 SkyWalking \u544a\u8b66\u529f\u80fd\u662f\u57286.x\u7248\u672c\u65b0\u589e\u7684\uff0c\u5176\u6838\u5fc3\u7531\u4e00\u7ec4\u89c4\u5219\u9a71\u52a8\uff0c\u8fd9\u4e9b\u89c4\u5219\u5b9a\u4e49\u5728 config/alarm-settings.yml \u6587\u4ef6\u4e2d\u3002 \u544a\u8b66\u7684\u5b9a\u4e49\u5206\u4e3a\u4e24\u90e8\u5206\uff1a \u544a\u8b66\u89c4\u5219 \uff1a\u5b83\u4eec\u5b9a\u4e49\u4e86\u5e94\u8be5\u5982\u4f55\u89e6\u53d1\u5ea6\u91cf\u8b66\u62a5\uff0c\u5e94\u8be5\u8003\u8651\u4ec0\u4e48\u6761\u4ef6\u3002 Webhook\uff08\u7f51\u7edc\u94a9\u5b50\uff09 \uff1a\u5b9a\u4e49\u5f53\u8b66\u544a\u89e6\u53d1\u65f6\uff0c\u54ea\u4e9b\u670d\u52a1\u7ec8\u7aef\u9700\u8981\u88ab\u544a\u77e5 3.5.1.\u544a\u8b66\u89c4\u5219 SkyWalking \u7684\u53d1\u884c\u7248\u90fd\u4f1a\u9ed8\u8ba4\u63d0\u4f9b config/alarm-settings.yml \u6587\u4ef6\uff0c\u91cc\u9762\u9884\u5148\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u544a\u8b66\u89c4\u5219\u3002\u5982\u4e0b\uff1a # Licensed to the Apache Software Foundation (ASF) under one # or more contributor license agreements. See the NOTICE file # distributed with this work for additional information # regarding copyright ownership. The ASF licenses this file # to you under the Apache License, Version 2.0 (the # \"License\"); you may not use this file except in compliance # with the License. You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an \"AS IS\" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # Sample alarm rules. rules: # Rule unique name, must be ended with `_rule`. service_resp_time_rule: metrics-name: service_resp_time op: \">\" threshold: 1000 period: 10 count: 3 silence-period: 5 message: Response time of service {name} is more than 1000ms in 3 minutes of last 10 minutes. service_sla_rule: # Metrics value need to be long, double or int metrics-name: service_sla op: \"<\" threshold: 8000 # The length of time to evaluate the metrics period: 10 # How many times after the metrics match the condition, will trigger alarm count: 2 # How many times of checks, the alarm keeps silence after alarm triggered, default as same as period. silence-period: 3 message: Successful rate of service {name} is lower than 80% in 2 minutes of last 10 minutes service_resp_time_percentile_rule: # Metrics value need to be long, double or int metrics-name: service_percentile op: \">\" threshold: 1000,1000,1000,1000,1000 period: 10 count: 3 silence-period: 5 message: Percentile response time of service {name} alarm in 3 minutes of last 10 minutes, due to more than one condition of p50 > 1000, p75 > 1000, p90 > 1000, p95 > 1000, p99 > 1000 service_instance_resp_time_rule: metrics-name: service_instance_resp_time op: \">\" threshold: 1000 period: 10 count: 2 silence-period: 5 message: Response time of service instance {name} is more than 1000ms in 2 minutes of last 10 minutes # Active endpoint related metrics alarm will cost more memory than service and service instance metrics alarm. # Because the number of endpoint is much more than service and instance. # # endpoint_avg_rule: # metrics-name: endpoint_avg # op: \">\" # threshold: 1000 # period: 10 # count: 2 # silence-period: 5 # message: Response time of endpoint {name} is more than 1000ms in 2 minutes of last 10 minutes webhooks: # - http://127.0.0.1/notify/ # - http://127.0.0.1/go-wechat/ \u544a\u8b66\u89c4\u5219\u914d\u7f6e\u9879\u7684\u8bf4\u660e\uff1a Rule name\uff1a \u89c4\u5219\u540d\u79f0\uff0c\u4e5f\u662f\u5728\u544a\u8b66\u4fe1\u606f\u4e2d\u663e\u793a\u7684\u552f\u4e00\u540d\u79f0\u3002\u5fc5\u987b\u4ee5 _rule \u7ed3\u5c3e\uff0c\u524d\u7f00\u53ef\u81ea\u5b9a\u4e49 Metrics name\uff1a \u5ea6\u91cf\u540d\u79f0\uff0c\u53d6\u503c\u4e3aoal\u811a\u672c\u4e2d\u7684\u5ea6\u91cf\u540d\uff0c\u76ee\u524d\u53ea\u652f\u6301 long \u3001 double \u548c int \u7c7b\u578b\u3002 Include names\uff1a \u8be5\u89c4\u5219\u4f5c\u7528\u4e8e\u54ea\u4e9b\u5b9e\u4f53\u540d\u79f0\uff0c\u6bd4\u5982\u670d\u52a1\u540d\uff0c\u7ec8\u7aef\u540d\uff08\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a\u5168\u90e8\uff09 Exclude names\uff1a \u8be5\u89c4\u5219\u4f5c\u4e0d\u7528\u4e8e\u54ea\u4e9b\u5b9e\u4f53\u540d\u79f0\uff0c\u6bd4\u5982\u670d\u52a1\u540d\uff0c\u7ec8\u7aef\u540d\uff08\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\uff09 Threshold\uff1a \u9608\u503c OP\uff1a \u64cd\u4f5c\u7b26\uff0c\u76ee\u524d\u652f\u6301 > \u3001 < \u3001 = Period\uff1a \u591a\u4e45\u544a\u8b66\u89c4\u5219\u9700\u8981\u88ab\u6838\u5b9e\u4e00\u4e0b\u3002\u8fd9\u662f\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\uff0c\u4e0e\u540e\u7aef\u90e8\u7f72\u73af\u5883\u65f6\u95f4\u76f8\u5339\u914d Count\uff1a \u5728\u4e00\u4e2aPeriod\u7a97\u53e3\u4e2d\uff0c\u5982\u679cvalues\u8d85\u8fc7Threshold\u503c\uff08\u6309op\uff09\uff0c\u8fbe\u5230Count\u503c\uff0c\u9700\u8981\u53d1\u9001\u8b66\u62a5 Silence period\uff1a \u5728\u65f6\u95f4N\u4e2d\u89e6\u53d1\u62a5\u8b66\u540e\uff0c\u5728TN -> TN + period\u8fd9\u4e2a\u9636\u6bb5\u4e0d\u544a\u8b66\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u548cPeriod\u4e00\u6837\uff0c\u8fd9\u610f\u5473\u7740\u76f8\u540c\u7684\u544a\u8b66\uff08\u5728\u540c\u4e00\u4e2aMetrics name\u62e5\u6709\u76f8\u540c\u7684Id\uff09\u5728\u540c\u4e00\u4e2aPeriod\u5185\u53ea\u4f1a\u89e6\u53d1\u4e00\u6b21 message\uff1a \u544a\u8b66\u6d88\u606f \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u9884\u5148\u5b9a\u4e49\u7684\u544a\u8b66\u89c4\u5219\u603b\u7ed3\u5982\u4e0b\uff1a \u5728\u8fc7\u53bb10\u5206\u949f\u76843\u5206\u949f\u5185\u670d\u52a1\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe3\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a1\u6210\u529f\u7387\u4f4e\u4e8e80%\u8fbe2\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a190%\u54cd\u5e94\u65f6\u95f4\u4f4e\u4e8e1\u79d2\u8fbe3\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a1\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe2\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u7aef\u70b9\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe2\u6b21 3.5.2.Webhook\uff08\u7f51\u7edc\u94a9\u5b50\uff09 Webhook\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u662f\u4e00\u79cdWeb\u5c42\u9762\u7684\u56de\u8c03\u673a\u5236\uff0c\u901a\u5e38\u7531\u4e00\u4e9b\u4e8b\u4ef6\u89e6\u53d1\uff0c\u4e0e\u4ee3\u7801\u4e2d\u7684\u4e8b\u4ef6\u56de\u8c03\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u662fWeb\u5c42\u9762\u7684\u3002\u7531\u4e8e\u662fWeb\u5c42\u9762\u7684\uff0c\u6240\u4ee5\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u56de\u8c03\u7684\u4e0d\u518d\u662f\u4ee3\u7801\u4e2d\u7684\u65b9\u6cd5\u6216\u51fd\u6570\uff0c\u800c\u662f\u670d\u52a1\u63a5\u53e3\u3002\u4f8b\u5982\uff0c\u5728\u544a\u8b66\u8fd9\u4e2a\u573a\u666f\uff0c\u544a\u8b66\u5c31\u662f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u5f53\u8be5\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0cSkyWalking\u5c31\u4f1a\u4e3b\u52a8\u53bb\u8c03\u7528\u4e00\u4e2a\u914d\u7f6e\u597d\u7684\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u5c31\u662f\u6240\u8c13\u7684Webhook\u3002 3.5.3.\u90ae\u4ef6\u544a\u8b66\u5b9e\u8df5 \u6839\u636e\u4ee5\u4e0a\u4e24\u4e2a\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u5f97\u77e5\uff1aSkyWalking\u662f\u4e0d\u652f\u6301\u76f4\u63a5\u5411\u90ae\u7bb1\u3001\u77ed\u4fe1\u7b49\u670d\u52a1\u53d1\u9001\u544a\u8b66\u4fe1\u606f\u7684\uff0cSkyWalking\u53ea\u4f1a\u5728\u53d1\u751f\u544a\u8b66\u65f6\u5c06\u544a\u8b66\u4fe1\u606f\u53d1\u9001\u81f3\u914d\u7f6e\u597d\u7684Webhook\u63a5\u53e3\u3002 \u4f46\u6211\u4eec\u603b\u4e0d\u80fd\u4eba\u5de5\u76ef\u7740\u8be5\u63a5\u53e3\u7684\u65e5\u5fd7\u4fe1\u606f\u6765\u5f97\u77e5\u670d\u52a1\u662f\u5426\u53d1\u751f\u4e86\u544a\u8b66\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5728\u8be5\u63a5\u53e3\u91cc\u6765\u5b9e\u73b0\u53d1\u9001\u90ae\u4ef6\u6216\u77ed\u4fe1\u7b49\u529f\u80fd\uff0c\u4ece\u800c\u8fbe\u5230\u4e2a\u6027\u5316\u7684\u544a\u8b66\u901a\u77e5\u3002 1\uff1a\u9996\u5148\u9700\u8981\u914d\u7f6ewebhook\u63a5\u53e3\uff0c\u5728 config/alarm-settings.yml \u6587\u4ef6\u914d\u7f6e\u5982\u4e0b\uff1a \u6ce8\uff1a\u5728192.168.200.100\u7684OAP\u5bb9\u5668\u4e2d\u914d\u7f6e \u53e6\u5916\uff1aWebhook\u63a5\u53e3\u4e0d\u9700\u8981\u914d\u7f6e\u5230\u6240\u6709\u670d\u52a1\u4e0a\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u4e00\u4e2a\u670d\u52a1\u6dfb\u52a0\u8be5\u63a5\u53e3\u5373\u53ef\uff0c\u5e76\u4e14\u627e\u7684\u8fd9\u4e2a\u670d\u52a1\u5c3d\u53ef\u80fd\u7684\u662f\u90a3\u79cd\u6bd4\u8f83\u201c\u6e05\u95f2\u201d\u7684\u670d\u52a1\u3002 2\uff1a\u65b0\u5efa\u6a21\u5757\uff1aheima-leadnews-alarm pom\u6587\u4ef6\uff1a <?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <parent> <artifactId>heima-leadnews-service</artifactId> <groupId>com.heima</groupId> <version>1.0-SNAPSHOT</version> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>heima-leadnews-alarm</artifactId> <properties> <maven.compiler.source>8</maven.compiler.source> <maven.compiler.target>8</maven.compiler.target> </properties> <dependencies> <!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-mail --> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-mail</artifactId> <version>2.1.3.RELEASE</version> </dependency> </dependencies> </project> 3\uff1a\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff1abootstrap.yml\uff0c\u6dfb\u52a0\u90ae\u4ef6\u53d1\u9001\u76f8\u5173\u9700\u8981\u7684\u8d26\u53f7\u7b49\u4fe1\u606f server: port: 9010 spring: application: name: leadnews-alarm cloud: nacos: discovery: server-addr: 192.168.200.130:8848 config: server-addr: 192.168.200.130:8848 file-extension: yml nacos\u914d\u7f6e spring: mail: #\u53d1\u4ef6\u670d\u52a1\u5668\u5730\u5740 host: smtp.163.com #\u53d1\u4ef6\u8d26\u53f7 username: itheim@163.com #\u5bf9\u5e94\u8d26\u53f7\u7684\u6388\u6743\u7801 password: xxxxxxxxxxxxxx protocol: smtp port: 25 default-encoding: utf-8 properties.mail.smtp.auth: true properties.mail.smtp.starttls.enable: true properties.mail.smtp.starttls.required: true properties.mail.smtp.ssl.enable: false properties.mail.smtp.timeout: 25000 #\u914d\u7f6e\u90ae\u4ef6\u63a5\u6536\u4eba skywalking: alarm: # \u53d1\u9001\u90ae\u4ef6\u7684\u5730\u5740\uff0c\u548c\u4e0a\u9762username\u4e00\u81f4 from: itheim@163.com receiveEmails: - xx@itcast.cn \u5f15\u5bfc\u7c7b\uff1a \u540c\u65f6\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u7c7b\u52a0\u8f7d\u90ae\u4ef6\u63a5\u6536\u4eba\u7684\u914d\u7f6e\uff1acom.itheima.skywalking.alarm.AlarmEmailProperties package com.heima.alarm.config; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.boot.context.properties.EnableConfigurationProperties; import org.springframework.context.annotation.Configuration; import java.util.List; /** * Created by \u4f20\u667a\u64ad\u5ba2*\u9ed1\u9a6c\u7a0b\u5e8f\u5458. */ @Data @Configuration @EnableConfigurationProperties @ConfigurationProperties(\"skywalking.alarm\") public class AlarmEmailProperties { private String from; private List<String> receiveEmails; } 4\uff1askyWalking\u5728\u544a\u8b66\u4e8b\u4ef6\u53d1\u751f\u540e\u9700\u8981\u8c03\u7528\u914d\u7f6e\u597d\u7684webhook\u63a5\u53e3\uff08POST\uff09\uff0c\u540c\u65f6\u4f1a\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\uff0c\u662fapplication/json\u683c\u5f0f\u7684\uff0c\u5982\u4e0b\uff1a [{ \"scopeId\": 1, \"scope\": \"SERVICE\", \"name\": \"serviceA\", \"id0\": 12, \"id1\": 0, \"ruleName\": \"service_resp_time_rule\", \"alarmMessage\": \"alarmMessage xxxx\", \"startTime\": 1560524171000 }, { \"scopeId\": 1, \"scope\": \"SERVICE\", \"name\": \"serviceB\", \"id0\": 23, \"id1\": 0, \"ruleName\": \"service_resp_time_rule\", \"alarmMessage\": \"alarmMessage yyy\", \"startTime\": 1560524171000 }] \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728service1\u4e2d\u5b9a\u4e49\u4e00\u4e2aDTO\u6765\u63a5\u6536\u6570\u636e\uff1acom.itheima.skywalking.dto.AlarmDTO package com.heima.alarm.model; import lombok.Data; /** * Created by \u4f20\u667a\u64ad\u5ba2*\u9ed1\u9a6c\u7a0b\u5e8f\u5458. */ @Data public class AlarmDTO { private Integer scopeId; private String scope; private String name; private String id0; private String id1; private String ruleName; private String alarmMessage; private Long startTime; } 5\uff1a\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\uff0c\u63a5\u6536SkyWalking\u7684\u544a\u8b66\u901a\u77e5\uff0c\u5e76\u5c06\u6570\u636e\u53d1\u9001\u81f3\u7cfb\u7edf\u8d1f\u8d23\u4eba\u7684\u76f8\u5173\u90ae\u7bb1\uff1acom.itheima.skywalking.controller.AlarmController package com.heima.alarm.controller; import com.heima.alarm.config.AlarmEmailProperties; import com.heima.alarm.model.AlarmDTO; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.mail.SimpleMailMessage; import org.springframework.mail.javamail.JavaMailSender; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestBody; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import java.util.List; @RestController @RequestMapping(\"/alarm\") @Slf4j public class AlarmController { @Autowired private JavaMailSender javaMailSender; @Autowired private AlarmEmailProperties alarmEamilProperties; @PostMapping(\"/emailNotify\") public void emailAlarm(@RequestBody List<AlarmDTO> alarmDTOList){ SimpleMailMessage mailMessage = new SimpleMailMessage(); //\u4ece\u54ea\u4e2a\u90ae\u7bb1\u53d1\u51fa mailMessage.setFrom(alarmEamilProperties.getFrom()); //\u53d1\u9001\u90ae\u4ef6 mailMessage.setTo(alarmEamilProperties.getReceiveEmails().toArray(new String [] {})); //\u4e3b\u9898 mailMessage.setSubject(\"skywalking\u544a\u8b66\u90ae\u4ef6\"); //\u90ae\u4ef6\u5185\u5bb9 mailMessage.setText(alarmDTOList.toString()); javaMailSender.send(mailMessage); log.info(\"\u544a\u8b66\u90ae\u4ef6\u5df2\u53d1\u9001\"); } } 6\uff1a\u56e0\u4e3askywalking\u9ed8\u8ba4\u6709\u4e00\u4e2a\u544a\u8b66\u89c4\u5219\uff1a10\u5206\u949f\u5185\u670d\u52a1\u6210\u529f\u7387\u4f4e\u4e8e80%\u8d85\u8fc72\u6b21\uff0c","title":"\u9879\u76ee\u94fe\u8def\u8ffd\u8e2a"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#_1","text":"","title":"\u9879\u76ee\u94fe\u8def\u8ffd\u8e2a"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#1","text":"\u968f\u7740\u7cfb\u7edf\u8bbe\u8ba1\u53d8\u5f97\u65e5\u8d8b\u590d\u6742\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u7ec4\u4ef6\u5f00\u59cb\u8d70\u5411\u5206\u5e03\u5f0f\u5316\uff0c\u5982\u5fae\u670d\u52a1\u3001\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3001\u5206\u5e03\u5f0f\u7f13\u5b58\u7b49\uff0c\u4f7f\u5f97\u540e\u53f0\u670d\u52a1\u6784\u6210\u4e86\u4e00\u79cd\u590d\u6742\u7684\u5206\u5e03\u5f0f\u7f51\u7edc\u3002\u5f80\u5f80\u524d\u7aef\u7684\u4e00\u4e2a\u8bf7\u6c42\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u5fae\u670d\u52a1\u3001\u8de8\u8d8a\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u624d\u80fd\u6700\u7ec8\u83b7\u53d6\u5230\u7ed3\u679c\uff0c\u5982\u4e0b\u56fe \u5e76\u4e14\u968f\u7740\u4e1a\u52a1\u7684\u4e0d\u65ad\u6269\u5f20\uff0c\u670d\u52a1\u4e4b\u95f4\u4e92\u76f8\u8c03\u7528\u4f1a\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u8fd9\u4e2a\u5e9e\u5927\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u8c03\u7528\u7f51\u7edc\u53ef\u80fd\u4f1a\u53d8\u7684\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u90a3\u968f\u4e4b\u800c\u6765\u7684\u5c31\u662f\u6211\u4eec\u5c06\u4f1a\u9762\u4e34\u7684\u8bf8\u591a\u56f0\u6270\uff1a \u95ee\u9898\u5b9a\u4f4d\uff1a\u5f53\u67d0\u4e00\u4e2a\u670d\u52a1\u8282\u70b9\u51fa\u73b0\u95ee\u9898\u5bfc\u81f4\u6574\u4e2a\u8c03\u7528\u5931\u8d25\uff0c\u65e0\u6cd5\u5feb\u901f\u6e05\u6670\u5730\u5b9a\u4f4d\u95ee\u9898\u670d\u52a1\u3002 \u6027\u80fd\u5206\u6790\uff1a\u670d\u52a1\u5b58\u5728\u76f8\u4e92\u4f9d\u8d56\u8c03\u7528\u7684\u5173\u7cfb\uff0c\u5f53\u67d0\u4e00\u4e2a\u670d\u52a1\u63a5\u53e3\u8017\u65f6\u8fc7\u957f\uff0c\u4f1a\u5bfc\u81f4\u6574\u4e2a\u63a5\u53e3\u8c03\u7528\u53d8\u7684\u5f88\u6162\uff0c\u6211\u4eec\u65e0\u6cd5\u660e\u786e\u6bcf\u4e00\u4e2a\u63a5\u53e3\u7684\u8017\u65f6\u3002 \u670d\u52a1\u62d3\u6251\u56fe\uff1a\u968f\u7740\u9700\u6c42\u8fed\u4ee3\uff0c\u7cfb\u7edf\u4e4b\u95f4\u8c03\u7528\u5173\u7cfb\u53d8\u5316\u9891\u7e41\uff0c\u9760\u4eba\u5de5\u5f88\u96be\u68b3\u7406\u6e05\u695a\u7cfb\u7edf\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u3002 \u670d\u52a1\u544a\u8b66\uff1a\u5f53\u670d\u52a1\u51fa\u73b0\u95ee\u9898\uff0c\u6211\u4eec\u65e0\u6cd5\u505a\u5230\u7531\u7cfb\u7edf\u81ea\u52a8\u901a\u77e5\u76f8\u5173\u4eba\u5458\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u5e94\u8fd0\u800c\u751f\u3002\u5b83\u4f1a\u5c06\u4e00\u6b21\u5206\u5e03\u5f0f\u8bf7\u6c42\u8fd8\u539f\u6210\u8c03\u7528\u94fe\u8def\uff0c\u5c06\u4e00\u6b21\u5206\u5e03\u5f0f\u8bf7\u6c42\u7684\u8c03\u7528\u60c5\u51b5\u96c6\u4e2d\u5c55\u793a\uff0c\u6bd4\u5982\u5404\u4e2a\u670d\u52a1\u8282\u70b9\u4e0a\u7684\u8017\u65f6\u3001\u8bf7\u6c42\u5177\u4f53\u5230\u8fbe\u54ea\u53f0\u673a\u5668\u4e0a\u3001\u6bcf\u4e2a\u670d\u52a1\u8282\u70b9\u7684\u8bf7\u6c42\u72b6\u6001\u3001\u751f\u6210\u670d\u52a1\u8c03\u7528\u62d3\u6251\u56fe\u7b49\u7b49\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u8981\u8bbe\u8ba1\u5e76\u5f00\u53d1\u4e00\u4e9b\u5206\u5e03\u5f0f\u8ffd\u8e2a\u7cfb\u7edf\u6765\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898","title":"1.\u5206\u5e03\u5f0f\u94fe\u8def\u8ffd\u8e2a\u6982\u8ff0"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#2java-javaagent","text":"","title":"2.java\u63a2\u9488\u6280\u672f-javaAgent"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#41javaagent","text":"Java Agent\u8fd9\u4e2a\u6280\u672f\u5bf9\u5927\u591a\u6570\u4eba\u6765\u8bf4\u90fd\u6bd4\u8f83\u964c\u751f\uff0c\u4f46\u662f\u5927\u5bb6\u90fd\u90fd\u591a\u591a\u5c11\u5c11\u63a5\u89e6\u8fc7\u4e00\u4e9b\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e73\u65f6\u7528\u8fc7\u7684\u5f88\u591a\u5de5\u5177\u90fd\u662f\u57fa\u4e8ejava Agent\u6765\u5b9e\u73b0\u7684\uff0c\u4f8b\u5982\uff1a\u70ed\u90e8\u7f72\u5de5\u5177JRebel\uff0cspringboot\u7684\u70ed\u90e8\u7f72\u63d2\u4ef6\uff0c\u5404\u79cd\u7ebf\u4e0a\u8bca\u65ad\u5de5\u5177\uff08btrace, greys\uff09\uff0c\u963f\u91cc\u5f00\u6e90\u7684arthas\u7b49\u7b49\u3002 \u5176\u5b9ejava Agent\u5728JDK1.5\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528agent\u6280\u672f\u6784\u5efa\u4e00\u4e2a\u72ec\u7acb\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7406\u7a0b\u5e8f\uff08\u5373Agent\uff09\uff0c\u7528\u6765\u534f\u52a9\u76d1\u6d4b\u3001\u8fd0\u884c\u751a\u81f3\u66ff\u6362\u5176\u4ed6JVM\u4e0a\u7684\u7a0b\u5e8f\u3002\u4f7f\u7528\u5b83\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u673a\u7ea7\u522b\u7684AOP\u529f\u80fd\uff0c\u5e76\u4e14\u8fd9\u79cd\u65b9\u5f0f\u4e00\u4e2a\u5178\u578b\u7684\u4f18\u52bf\u5c31\u662f\u65e0\u4ee3\u7801\u4fb5\u5165\u3002 Agent\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u5728\u4e3b\u7a0b\u5e8f\u4e4b\u524d\u8fd0\u884c\u7684Agent\uff0c\u4e00\u79cd\u662f\u5728\u4e3b\u7a0b\u5e8f\u4e4b\u540e\u8fd0\u884c\u7684Agent\uff08\u524d\u8005\u7684\u5347\u7ea7\u7248\uff0c1.6\u4ee5\u540e\u63d0\u4f9b\uff09\u3002","title":"4.1.javaAgent\u6982\u8ff0"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#3skywalking","text":"","title":"3.skyWalking"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#31skywalking","text":"2015\u5e74\u7531\u4e2a\u4eba\u5434\u665f\uff08\u534e\u4e3a\u5f00\u53d1\u8005\uff09\u4e3b\u5bfc\u5f00\u6e90\uff0c\u4f5c\u8005\u662f\u534e\u4e3a\u5f00\u53d1\u4e91\u76d1\u63a7\u4ea7\u54c1\u7ecf\u7406\uff0c\u4e3b\u5bfc\u76d1\u63a7\u4ea7\u54c1\u7684\u89c4\u5212\u3001\u6280\u672f\u8def\u7ebf\u53ca\u76f8\u5173\u7814\u53d1\u5de5\u4f5c\uff0c\u4e5f\u662fOpenTracing\u5206\u5e03\u5f0f\u8ffd\u8e2a\u6807\u51c6\u7ec4\u7ec7\u6210\u5458 \uff0c\u8be5\u9879\u76ee 2017\u5e74\u52a0\u5165Apache\u5b75\u5316\u5668\uff0c\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff08APM\uff09\uff0c\u4e13\u4e3a\u5fae\u670d\u52a1\u3001\u4e91\u539f\u751f\u67b6\u6784\u548c\u57fa\u4e8e\u5bb9\u5668\uff08Docker\u3001K8s\u3001Mesos\uff09\u67b6\u6784\u800c\u8bbe\u8ba1\u3002 \u5b98\u65b9\u7ad9\u70b9\uff1a http://skywalking.apache.org/ GitHub\u9879\u76ee\u5730\u5740\uff1a https://github.com/apache/skywalking \u5176\u6838\u5fc3\u529f\u80fd\u8981\u70b9\u5982\u4e0b\uff1a \u6307\u6807\u5206\u6790 \uff1a\u670d\u52a1\uff0c\u5b9e\u4f8b\uff0c\u7aef\u70b9\u6307\u6807\u5206\u6790 \u95ee\u9898\u5206\u6790 \uff1a\u5728\u8fd0\u884c\u65f6\u5206\u6790\u4ee3\u7801\uff0c\u627e\u5230\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0 \u670d\u52a1\u62d3\u6251 \uff1a\u63d0\u4f9b\u670d\u52a1\u7684\u62d3\u6251\u56fe\u5206\u6790 \u4f9d\u8d56\u5206\u6790 \uff1a\u670d\u52a1\u5b9e\u4f8b\u548c\u7aef\u70b9\u4f9d\u8d56\u6027\u5206\u6790 \u670d\u52a1\u68c0\u6d4b \uff1a\u68c0\u6d4b\u6162\u901f\u7684\u670d\u52a1\u548c\u7aef\u70b9 \u6027\u80fd\u4f18\u5316 \uff1a\u6839\u636e\u670d\u52a1\u76d1\u63a7\u7684\u7ed3\u679c\u63d0\u4f9b\u6027\u80fd\u4f18\u5316\u7684\u601d\u8def \u94fe\u8def\u8ffd\u8e2a \uff1a\u5206\u5e03\u5f0f\u8ddf\u8e2a\u548c\u4e0a\u4e0b\u6587\u4f20\u64ad \u6570\u636e\u5e93\u76d1\u63a7 \uff1a\u6570\u636e\u5e93\u8bbf\u95ee\u6307\u6807\u76d1\u63a7\u7edf\u8ba1\uff0c\u68c0\u6d4b\u6162\u901f\u6570\u636e\u5e93\u8bbf\u95ee\u8bed\u53e5\uff08\u5305\u62ecSQL\u8bed\u53e5\uff09 \u670d\u52a1\u544a\u8b66 \uff1a\u670d\u52a1\u544a\u8b66\u529f\u80fd \u540d\u8bcd\u89e3\u91ca\uff1a \u670d\u52a1\uff08service\uff09\uff1a\u4e1a\u52a1\u8d44\u6e90\u5e94\u7528\u7cfb\u7edf \u7aef\u70b9\uff08endpoint\uff09\uff1a\u5e94\u7528\u7cfb\u7edf\u5bf9\u5916\u66b4\u9732\u7684\u529f\u80fd\u63a5\u53e3 \u5b9e\u4f8b\uff08instance\uff09\uff1a\u7269\u7406\u673a","title":"3.1.skyWalking\u6982\u8ff0"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#32skywalking","text":"skyWalking\u7684\u6574\u4f53\u67b6\u6784\u8bbe\u8ba1\u5982\u4e0b\u56fe\u6240\u793a\uff1a skyWalking\u6574\u4f53\u53ef\u5206\u4e3a\uff1a\u5ba2\u6237\u7aef\uff0c\u670d\u52a1\u7aef \u5ba2\u6237\u7aef\uff1aagent\u7ec4\u4ef6 \u200b \u57fa\u4e8e\u63a2\u9488\u6280\u672f\u91c7\u96c6\u670d\u52a1\u76f8\u5173\u4fe1\u606f\uff08\u5305\u62ec\u8ddf\u8e2a\u6570\u636e\u548c\u7edf\u8ba1\u6570\u636e\uff09\uff0c\u7136\u540e\u5c06\u91c7\u96c6\u5230\u7684\u6570\u636e\u4e0a\u62a5\u7ed9skywalking\u7684\u6570\u636e\u6536\u96c6\u5668 \u670d\u52a1\u7aef\uff1a\u53c8\u5206\u4e3aOAP\uff0cStorage\uff0cWebUI OAP\uff1aobservability analysis platform\u53ef\u89c2\u6d4b\u6027\u5206\u6790\u5e73\u53f0\uff0c\u8d1f\u8d23\u63a5\u6536\u5ba2\u6237\u7aef\u4e0a\u62a5\u7684\u6570\u636e\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u6790\uff0c\u805a\u5408\uff0c\u8ba1\u7b97\u540e\u5c06\u6570\u636e\u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u4e14\u8fd8\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u67e5\u8be2API\u8fdb\u884c\u6570\u636e\u7684\u67e5\u8be2\uff0c\u8fd9\u4e2a\u6a21\u5757\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u94fe\u8def\u8ffd\u8e2a\u7cfb\u7edf\u7684Collector\u6536\u96c6\u5668 Storage\uff1askyWalking\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u9ed8\u8ba4\u662f\u91c7\u7528H2\uff0c\u540c\u65f6\u652f\u6301\u8bb8\u591a\u5176\u4ed6\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u6bd4\u5982\uff1aElastaticSearch\uff0cmysql\u7b49 WebUI\uff1a\u63d0\u4f9b\u4e00\u4e9b\u56fe\u5f62\u5316\u754c\u9762\u5c55\u793a\u5bf9\u5e94\u7684\u8ddf\u8e2a\u6570\u636e\uff0c\u6307\u6807\u6570\u636e\u7b49\u7b49","title":"3.2.skyWalking\u67b6\u6784\u8bbe\u8ba1"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#33skywalking","text":"","title":"3.3.skyWalking\u73af\u5883\u642d\u5efa"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#331skywalking","text":"skyWalking\u53ef\u4ece\u5b98\u65b9\u7ad9\u70b9\u4e0b\u8f7d\uff1ahttp://skywalking.apache.org/downloads/\uff0c\u672c\u6587\u4e2d\u4f7f\u75288.2.0\u7248\u672c","title":"3.3.1.skyWalking\u4e0b\u8f7d"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#333dockerskywalking","text":"(1)\u5b89\u88c5OAP docker\u62c9\u53d6\u955c\u50cf\uff0c\u53ef\u4ee5\u4f7f\u7528\u8d44\u6599\u4e2d\u63d0\u4f9b\u597d\u7684\u6587\u4ef6\u52a0\u8f7d\u4e3a\u955c\u50cf docker pull apache/skywalking-oap-server \u521b\u5efa\u5bb9\u5668 docker run --name skywalking -d -p 1234:1234 -p 11800:11800 -p 12800:12800 --restart always apache/skywalking-oap-server skyWalking\u9ed8\u8ba4\u4f7f\u7528H2\u8fdb\u884c\u4fe1\u606f\u5b58\u50a8\uff0c\u4f46H2\u4e00\u65e6\u91cd\u542f\u6570\u636e\u5c31\u4f1a\u4e22\u5931\uff0c\u56e0\u6b64\u91c7\u7528ES\u66ff\u6362H2\u5bf9skyWalking\u4e2d\u6570\u636e\u4fe1\u606f\u5b58\u50a8\uff0c\u9879\u76ee\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86elasticsearch\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u9700\u8981\u6307\u5b9aelasticsearch\u7684\u5730\u5740 oap\u5bb9\u5668\u521b\u5efa\u5b8c\u6210\u4ee5\u540e\uff0c\u8fdb\u5165\u5bb9\u5668\u4e2d docker exec -it fe372cdaece2 /bin/bash \u4fee\u6539\u6587\u4ef6\uff1a /config/application.yml\uff0c\u5982\u4e0b\u6548\u679c \u91cd\u542f\u5bb9\u5668\uff0c\u4fdd\u8bc1130\u8fd9\u53f0\u670d\u52a1\u5668\u4e0a\u7684elasticsearch\u5df2\u7ecf\u542f\u52a8 (2)\u5b89\u88c5UI \u62c9\u53d6\u955c\u50cf\uff0c\u53ef\u4ee5\u4f7f\u7528\u8d44\u6599\u4e2d\u63d0\u4f9b\u597d\u7684\u6587\u4ef6\u52a0\u8f7d\u4e3a\u955c\u50cf docker pull apache/skywalking-ui \u521b\u5efa\u5bb9\u5668 docker run --name skywalking-ui -d -p 8686:8080 --link skywalking:skywalking -e SW_OAP_ADDRESS=skywalking:12800 --restart always apache/skywalking-ui \u542f\u52a8\u6210\u529f\u540e\u8bbf\u95eeskywalking\u7684webui\u9875\u9762\uff1a http://192.168.200.100:8686/","title":"3.3.3.docker\u90e8\u7f72skyWalking"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#34skywalking","text":"\u5e94\u7528\u7a0b\u5e8f\u63a5\u5165skywalking\u975e\u5e38\u7684\u7b80\u5355\uff0c\u53ea\u9700\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\u901a\u8fc7 -javaagent \u6765\u6307\u5b9askyWalking\u7684agent\u7684\u7ec4\u4ef6 \u9996\u5148\u5728\u4e0b\u8f7d\u597d\u7684skyWalking\u4e2d\u627e\u5230agent\u7ec4\u4ef6\uff1a \u8fdb\u5165\u5230agent\u76ee\u5f55\uff1a \u901a\u8fc7 -javaagent \u6765\u6307\u5b9askywalking\u7684agent\u7ec4\u4ef6\u7684skywalking-agent.jar\u5373\u53ef \u53e6\u5916\uff1aagent\u8d1f\u8d23\u91c7\u96c6\u6570\u636e\u7136\u540e\u5c06\u6570\u636e\u63d0\u4ea4\u5230OAP\uff08collector\uff09\u4e2d\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5728agent\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9aOAP\u7684\u5730\u5740\uff0c\u5f53\u7136\u9ed8\u8ba4\u662f\u672c\u5730127.0.0.1 \u8fdb\u5165\u5230config\u76ee\u5f55\uff0c\u627e\u5230\uff1aagent.config\u914d\u7f6e\u6587\u4ef6 \u672a\u4fee\u6539\u524d\u5982\u4e0b\uff1a \u4fee\u6539\u540e\u5982\u4e0b\uff1a \u5f53\u524dagent\u5bf9\u4e8espring cloud gateway\u652f\u6301\u7684\u4e0d\u597d\uff0c\u9700\u8981\u624b\u52a8\u4fee\u6539\u51e0\u4e2a\u63d2\u4ef6\uff0c\u4eceagent\u5305\u4e0b\u7684optional-plugins\u5305\u4e0b\u7684\u4e24\u4e2ajar\u5305\uff0c\u62f7\u8d1d\u5230agent/plugins\u5305\u4e0b\u5373\u53ef apm-spring-cloud-gateway-2.1.x-plugin-8.2.0.jar apm-spring-webflux-5.x-plugin-8.2.0.jar \u63a5\u4e0b\u6765\u6211\u4eec\u4f9d\u6b21\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\uff0c\u4ee5\u9ed1\u9a6c\u5934\u6761heima-leadnews-user\u4e2d\u7684heima-leadnews-app-gateway\uff0cheima-leadnews-article\u4e3a\u4f8b\u6765\u542f\u52a8\uff0c\u6211\u4eec\u53ea\u9700\u4fee\u6539\u542f\u52a8\u53c2\u6570\u5373\u53ef\uff0c \u6211\u4eec\u9700\u8981\u5c06\u542f\u52a8\u53c2\u6570\u4fee\u6539\u5982\u4e0b(\u6ce8\u610f\uff1a\u8981\u6307\u5411\u81ea\u5df1\u7535\u8111\u4e2d\u7684agent\u5b58\u653e\u7684\u4f4d\u7f6e) -javaagent:D:\\develop\\agent\\skywalking-agent.jar -Dskywalking.agent.service_name=heima-leadnews-user \u6ce8\u610f\uff1a\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u4f5c\u591a\u8282\u70b9\u90e8\u7f72\uff0c\u4fdd\u8bc1\u670d\u52a1\u540d\u79f0\u4e0d\u4e00\u6837 \u56fe\u793a\u5982\u4e0b\uff1a \u4e09\u4e2a\u670d\u52a1\u90fd\u8981\u4fee\u6539\u542f\u52a8\u53c2\u6570\uff0c\u7136\u540e\u542f\u52a8\u9879\u76ee \u8bbf\u95ee\uff1ahttp://192.168.200.100:8686\u67e5\u770bskywalking\u7684ui UI\u76d1\u63a7\u89c6\u89d2\u4e0e\u6307\u6807\u4ecb\u7ecd \u6211\u4eec\u89e3\u8bfb\u4e00\u4e0b\u6bd4\u8f83\u964c\u751f\u7684\u4e00\u4e9b\u6307\u6807\uff1a \u7528\u6237\u6ee1\u610f\u5ea6Apdex Score Apdex\u662f\u57fa\u4e8e\u8bbe\u7f6e\u7684\u9608\u503c\u7684\u54cd\u5e94\u65f6\u95f4\u7684\u5ea6\u91cf\u3002\u5b83\u6d4b\u91cf\u4e86\u6ee1\u610f\u7684\u54cd\u5e94\u65f6\u95f4\u4e0e\u4e0d\u6ee1\u610f\u7684\u54cd\u5e94\u65f6\u95f4\u4e4b\u6bd4\u3002\u4ece\u8d44\u4ea7\u8bf7\u6c42\u5230\u5b8c\u6210\u4ea4\u4ed8\u56de\u8bf7\u6c42\u8005\u7684\u54cd\u5e94\u65f6\u95f4\u3002 \u7ba1\u7406\u5458\uff0c\u6240\u6709\u8005\u6216\u9644\u52a0\u7ec4\u4ef6\u7ba1\u7406\u5668\u5b9a\u4e49\u54cd\u5e94\u65f6\u95f4\u9608\u503c T \u3002\u5728 T \u77ed\u65f6\u95f4\u5185\u5904\u7406\u7684\u6240\u6709\u54cd\u5e94\u90fd\u80fd\u4f7f\u7528\u6237\u6ee1\u610f\u3002 \u4f8b\u5982\uff0c\u5982\u679c T \u4e3a1.2\u79d2\uff0c\u5e76\u4e14\u54cd\u5e94\u57280.5\u79d2\u5185\u5b8c\u6210\uff0c\u5219\u7528\u6237\u4f1a\u611f\u5230\u6ee1\u610f\u3002\u6240\u6709\u5927\u4e8e1.2\u79d2\u7684\u54cd\u5e94\u90fd\u4f7f\u7528\u6237\u4e0d\u6ee1\u610f\u3002\u5927\u4e8e4.8\u79d2\u7684\u54cd\u5e94\u4f7f\u7528\u6237\u611f\u5230\u6cae\u4e27\u3002 cpm \u6bcf\u5206\u949f\u8bf7\u6c42\u6570 cpm \u5168\u79f0 call per minutes\uff0c\u662f\u541e\u5410\u91cf(Throughput)\u6307\u6807\u3002 \u4e0b\u56fe\u662f\u62fc\u63a5\u7684\u5168\u5c40\u3001\u670d\u52a1\u3001\u5b9e\u4f8b\u548c\u63a5\u53e3\u7684\u541e\u5410\u91cf\u53ca\u5e73\u5747\u541e\u5410\u91cf\u3002 185cpm=185/60=3.08\u4e2a\u8bf7\u6c42/\u79d2 SLA \u670d\u52a1\u7b49\u7ea7\u534f\u8bae \u670d\u52a1\u7b49\u7ea7\u534f\u8bae\u7528\u6765\u8868\u793a\u63d0\u4f9b\u670d\u52a1\u7684\u6c34\u5e73\uff0c\u53ef\u4ee5\u8861\u91cf\u5e73\u53f0\u7684\u53ef\u7528\u6027\uff0c\u4e0b\u9762\u662fN\u4e2a9\u7684\u8ba1\u7b97 1\u5e74 = 365\u5929 = 8760\u5c0f\u65f6 99 = 8760 * 1% => 3.65\u5929----------------\u300b\u76f8\u5f53\u4e8e\u5168\u5e74\u67093.65\u5929\u4e0d\u53ef\u7528\uff0c2\u4e2a9\u5c31\u57fa\u672c\u4e0d\u53ef\u7528\u4e86 99.9 = 8760 * 0.1% => 8.76\u5c0f\u65f6--------------\u300b\u76f8\u5f53\u4e8e\u5168\u5e74\u67098.76\u5c0f\u65f6\u4e0d\u53ef\u7528 99.99 = 8760 * 0.01% => 52.6\u5206\u949f 99.999 = 8760 * 0.001% => 5.26\u5206\u949f \u56e0\u6b64\uff0c\u5168\u5e74\u53ea\u8981\u53d1\u751f\u4e00\u6b21\u8f83\u5927\u89c4\u6a21\u5b95\u673a\u4e8b\u6545\uff0c4\u4e2a9\u80af\u5b9a\u6ca1\u620f\uff0c\u4e00\u822c\u5e73\u53f03\u4e2a9\u5dee\u4e0d\u591a\u3002 Percent Response \u767e\u5206\u4f4d\u6570\u7edf\u8ba1 Skywalking \u6709 \u201cp50\u3001p75\u3001p90\u3001p95\u3001p99\u201d \u4e00\u4e9b\u5217\u503c\uff0c\u56fe\u4e2d\u7684 \u201cp99:390\u201d \u8868\u793a 99% \u8bf7\u6c42\u7684\u54cd\u5e94\u65f6\u95f4\u5728390ms\u4ee5\u5185\u3002 Heatmap \u70ed\u529b\u56fe Heapmap \u53ef\u8bd1\u4e3a\u70ed\u529b\u56fe\u3001\u70ed\u5ea6\u56fe\u90fd\u53ef\u4ee5\uff0c\u56fe\u4e2d\u989c\u8272\u8d8a\u6df1\uff0c\u8868\u793a\u8bf7\u6c42\u6570\u8d8a\u591a\uff0c\u8fd9\u548cGitHub Contributions\u5f88\u50cf\uff0ccommit\u8d8a\u591a\uff0c\u989c\u8272\u8d8a\u6df1\u3002 \u7eb5\u5750\u6807\u662f\u54cd\u5e94\u65f6\u95f4\uff0c\u9f20\u6807\u653e\u4e0a\u53bb\uff0c\u53ef\u4ee5\u770b\u5230\u5177\u4f53\u7684\u6570\u91cf\u3002 \u901a\u8fc7\u70ed\u529b\u56fe\uff0c\u4e00\u65b9\u9762\u53ef\u4ee5\u76f4\u89c2\u611f\u53d7\u5e73\u53f0\u7684\u6574\u4f53\u6d41\u91cf\uff0c\u53e6\u4e00\u65b9\u9762\u4e5f\u53ef\u4ee5\u611f\u53d7\u6574\u4f53\u6027\u80fd\u3002","title":"3.4.\u5e94\u7528\u7a0b\u5e8f\u63a5\u5165skyWalking"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#35skywalking","text":"SkyWalking \u544a\u8b66\u529f\u80fd\u662f\u57286.x\u7248\u672c\u65b0\u589e\u7684\uff0c\u5176\u6838\u5fc3\u7531\u4e00\u7ec4\u89c4\u5219\u9a71\u52a8\uff0c\u8fd9\u4e9b\u89c4\u5219\u5b9a\u4e49\u5728 config/alarm-settings.yml \u6587\u4ef6\u4e2d\u3002 \u544a\u8b66\u7684\u5b9a\u4e49\u5206\u4e3a\u4e24\u90e8\u5206\uff1a \u544a\u8b66\u89c4\u5219 \uff1a\u5b83\u4eec\u5b9a\u4e49\u4e86\u5e94\u8be5\u5982\u4f55\u89e6\u53d1\u5ea6\u91cf\u8b66\u62a5\uff0c\u5e94\u8be5\u8003\u8651\u4ec0\u4e48\u6761\u4ef6\u3002 Webhook\uff08\u7f51\u7edc\u94a9\u5b50\uff09 \uff1a\u5b9a\u4e49\u5f53\u8b66\u544a\u89e6\u53d1\u65f6\uff0c\u54ea\u4e9b\u670d\u52a1\u7ec8\u7aef\u9700\u8981\u88ab\u544a\u77e5","title":"3.5.skyWalking\u914d\u7f6e\u5e94\u7528\u544a\u8b66"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#351","text":"SkyWalking \u7684\u53d1\u884c\u7248\u90fd\u4f1a\u9ed8\u8ba4\u63d0\u4f9b config/alarm-settings.yml \u6587\u4ef6\uff0c\u91cc\u9762\u9884\u5148\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u544a\u8b66\u89c4\u5219\u3002\u5982\u4e0b\uff1a # Licensed to the Apache Software Foundation (ASF) under one # or more contributor license agreements. See the NOTICE file # distributed with this work for additional information # regarding copyright ownership. The ASF licenses this file # to you under the Apache License, Version 2.0 (the # \"License\"); you may not use this file except in compliance # with the License. You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an \"AS IS\" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # Sample alarm rules. rules: # Rule unique name, must be ended with `_rule`. service_resp_time_rule: metrics-name: service_resp_time op: \">\" threshold: 1000 period: 10 count: 3 silence-period: 5 message: Response time of service {name} is more than 1000ms in 3 minutes of last 10 minutes. service_sla_rule: # Metrics value need to be long, double or int metrics-name: service_sla op: \"<\" threshold: 8000 # The length of time to evaluate the metrics period: 10 # How many times after the metrics match the condition, will trigger alarm count: 2 # How many times of checks, the alarm keeps silence after alarm triggered, default as same as period. silence-period: 3 message: Successful rate of service {name} is lower than 80% in 2 minutes of last 10 minutes service_resp_time_percentile_rule: # Metrics value need to be long, double or int metrics-name: service_percentile op: \">\" threshold: 1000,1000,1000,1000,1000 period: 10 count: 3 silence-period: 5 message: Percentile response time of service {name} alarm in 3 minutes of last 10 minutes, due to more than one condition of p50 > 1000, p75 > 1000, p90 > 1000, p95 > 1000, p99 > 1000 service_instance_resp_time_rule: metrics-name: service_instance_resp_time op: \">\" threshold: 1000 period: 10 count: 2 silence-period: 5 message: Response time of service instance {name} is more than 1000ms in 2 minutes of last 10 minutes # Active endpoint related metrics alarm will cost more memory than service and service instance metrics alarm. # Because the number of endpoint is much more than service and instance. # # endpoint_avg_rule: # metrics-name: endpoint_avg # op: \">\" # threshold: 1000 # period: 10 # count: 2 # silence-period: 5 # message: Response time of endpoint {name} is more than 1000ms in 2 minutes of last 10 minutes webhooks: # - http://127.0.0.1/notify/ # - http://127.0.0.1/go-wechat/ \u544a\u8b66\u89c4\u5219\u914d\u7f6e\u9879\u7684\u8bf4\u660e\uff1a Rule name\uff1a \u89c4\u5219\u540d\u79f0\uff0c\u4e5f\u662f\u5728\u544a\u8b66\u4fe1\u606f\u4e2d\u663e\u793a\u7684\u552f\u4e00\u540d\u79f0\u3002\u5fc5\u987b\u4ee5 _rule \u7ed3\u5c3e\uff0c\u524d\u7f00\u53ef\u81ea\u5b9a\u4e49 Metrics name\uff1a \u5ea6\u91cf\u540d\u79f0\uff0c\u53d6\u503c\u4e3aoal\u811a\u672c\u4e2d\u7684\u5ea6\u91cf\u540d\uff0c\u76ee\u524d\u53ea\u652f\u6301 long \u3001 double \u548c int \u7c7b\u578b\u3002 Include names\uff1a \u8be5\u89c4\u5219\u4f5c\u7528\u4e8e\u54ea\u4e9b\u5b9e\u4f53\u540d\u79f0\uff0c\u6bd4\u5982\u670d\u52a1\u540d\uff0c\u7ec8\u7aef\u540d\uff08\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a\u5168\u90e8\uff09 Exclude names\uff1a \u8be5\u89c4\u5219\u4f5c\u4e0d\u7528\u4e8e\u54ea\u4e9b\u5b9e\u4f53\u540d\u79f0\uff0c\u6bd4\u5982\u670d\u52a1\u540d\uff0c\u7ec8\u7aef\u540d\uff08\u53ef\u9009\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\uff09 Threshold\uff1a \u9608\u503c OP\uff1a \u64cd\u4f5c\u7b26\uff0c\u76ee\u524d\u652f\u6301 > \u3001 < \u3001 = Period\uff1a \u591a\u4e45\u544a\u8b66\u89c4\u5219\u9700\u8981\u88ab\u6838\u5b9e\u4e00\u4e0b\u3002\u8fd9\u662f\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\uff0c\u4e0e\u540e\u7aef\u90e8\u7f72\u73af\u5883\u65f6\u95f4\u76f8\u5339\u914d Count\uff1a \u5728\u4e00\u4e2aPeriod\u7a97\u53e3\u4e2d\uff0c\u5982\u679cvalues\u8d85\u8fc7Threshold\u503c\uff08\u6309op\uff09\uff0c\u8fbe\u5230Count\u503c\uff0c\u9700\u8981\u53d1\u9001\u8b66\u62a5 Silence period\uff1a \u5728\u65f6\u95f4N\u4e2d\u89e6\u53d1\u62a5\u8b66\u540e\uff0c\u5728TN -> TN + period\u8fd9\u4e2a\u9636\u6bb5\u4e0d\u544a\u8b66\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u548cPeriod\u4e00\u6837\uff0c\u8fd9\u610f\u5473\u7740\u76f8\u540c\u7684\u544a\u8b66\uff08\u5728\u540c\u4e00\u4e2aMetrics name\u62e5\u6709\u76f8\u540c\u7684Id\uff09\u5728\u540c\u4e00\u4e2aPeriod\u5185\u53ea\u4f1a\u89e6\u53d1\u4e00\u6b21 message\uff1a \u544a\u8b66\u6d88\u606f \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u9884\u5148\u5b9a\u4e49\u7684\u544a\u8b66\u89c4\u5219\u603b\u7ed3\u5982\u4e0b\uff1a \u5728\u8fc7\u53bb10\u5206\u949f\u76843\u5206\u949f\u5185\u670d\u52a1\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe3\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a1\u6210\u529f\u7387\u4f4e\u4e8e80%\u8fbe2\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a190%\u54cd\u5e94\u65f6\u95f4\u4f4e\u4e8e1\u79d2\u8fbe3\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u670d\u52a1\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe2\u6b21 \u5728\u8fc7\u53bb10\u5206\u949f\u5185\u7aef\u70b9\u7684\u54cd\u5e94\u65f6\u95f4\u8d85\u8fc71\u79d2\u8fbe2\u6b21","title":"3.5.1.\u544a\u8b66\u89c4\u5219"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#352webhook","text":"Webhook\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u662f\u4e00\u79cdWeb\u5c42\u9762\u7684\u56de\u8c03\u673a\u5236\uff0c\u901a\u5e38\u7531\u4e00\u4e9b\u4e8b\u4ef6\u89e6\u53d1\uff0c\u4e0e\u4ee3\u7801\u4e2d\u7684\u4e8b\u4ef6\u56de\u8c03\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u662fWeb\u5c42\u9762\u7684\u3002\u7531\u4e8e\u662fWeb\u5c42\u9762\u7684\uff0c\u6240\u4ee5\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u56de\u8c03\u7684\u4e0d\u518d\u662f\u4ee3\u7801\u4e2d\u7684\u65b9\u6cd5\u6216\u51fd\u6570\uff0c\u800c\u662f\u670d\u52a1\u63a5\u53e3\u3002\u4f8b\u5982\uff0c\u5728\u544a\u8b66\u8fd9\u4e2a\u573a\u666f\uff0c\u544a\u8b66\u5c31\u662f\u4e00\u4e2a\u4e8b\u4ef6\u3002\u5f53\u8be5\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0cSkyWalking\u5c31\u4f1a\u4e3b\u52a8\u53bb\u8c03\u7528\u4e00\u4e2a\u914d\u7f6e\u597d\u7684\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u5c31\u662f\u6240\u8c13\u7684Webhook\u3002","title":"3.5.2.Webhook\uff08\u7f51\u7edc\u94a9\u5b50\uff09"},{"location":"heimajava/05-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A1%B9%E7%9B%AE%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/#353","text":"\u6839\u636e\u4ee5\u4e0a\u4e24\u4e2a\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u5f97\u77e5\uff1aSkyWalking\u662f\u4e0d\u652f\u6301\u76f4\u63a5\u5411\u90ae\u7bb1\u3001\u77ed\u4fe1\u7b49\u670d\u52a1\u53d1\u9001\u544a\u8b66\u4fe1\u606f\u7684\uff0cSkyWalking\u53ea\u4f1a\u5728\u53d1\u751f\u544a\u8b66\u65f6\u5c06\u544a\u8b66\u4fe1\u606f\u53d1\u9001\u81f3\u914d\u7f6e\u597d\u7684Webhook\u63a5\u53e3\u3002 \u4f46\u6211\u4eec\u603b\u4e0d\u80fd\u4eba\u5de5\u76ef\u7740\u8be5\u63a5\u53e3\u7684\u65e5\u5fd7\u4fe1\u606f\u6765\u5f97\u77e5\u670d\u52a1\u662f\u5426\u53d1\u751f\u4e86\u544a\u8b66\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5728\u8be5\u63a5\u53e3\u91cc\u6765\u5b9e\u73b0\u53d1\u9001\u90ae\u4ef6\u6216\u77ed\u4fe1\u7b49\u529f\u80fd\uff0c\u4ece\u800c\u8fbe\u5230\u4e2a\u6027\u5316\u7684\u544a\u8b66\u901a\u77e5\u3002 1\uff1a\u9996\u5148\u9700\u8981\u914d\u7f6ewebhook\u63a5\u53e3\uff0c\u5728 config/alarm-settings.yml \u6587\u4ef6\u914d\u7f6e\u5982\u4e0b\uff1a \u6ce8\uff1a\u5728192.168.200.100\u7684OAP\u5bb9\u5668\u4e2d\u914d\u7f6e \u53e6\u5916\uff1aWebhook\u63a5\u53e3\u4e0d\u9700\u8981\u914d\u7f6e\u5230\u6240\u6709\u670d\u52a1\u4e0a\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u4e00\u4e2a\u670d\u52a1\u6dfb\u52a0\u8be5\u63a5\u53e3\u5373\u53ef\uff0c\u5e76\u4e14\u627e\u7684\u8fd9\u4e2a\u670d\u52a1\u5c3d\u53ef\u80fd\u7684\u662f\u90a3\u79cd\u6bd4\u8f83\u201c\u6e05\u95f2\u201d\u7684\u670d\u52a1\u3002 2\uff1a\u65b0\u5efa\u6a21\u5757\uff1aheima-leadnews-alarm pom\u6587\u4ef6\uff1a <?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"> <parent> <artifactId>heima-leadnews-service</artifactId> <groupId>com.heima</groupId> <version>1.0-SNAPSHOT</version> </parent> <modelVersion>4.0.0</modelVersion> <artifactId>heima-leadnews-alarm</artifactId> <properties> <maven.compiler.source>8</maven.compiler.source> <maven.compiler.target>8</maven.compiler.target> </properties> <dependencies> <!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-mail --> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-mail</artifactId> <version>2.1.3.RELEASE</version> </dependency> </dependencies> </project> 3\uff1a\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff1abootstrap.yml\uff0c\u6dfb\u52a0\u90ae\u4ef6\u53d1\u9001\u76f8\u5173\u9700\u8981\u7684\u8d26\u53f7\u7b49\u4fe1\u606f server: port: 9010 spring: application: name: leadnews-alarm cloud: nacos: discovery: server-addr: 192.168.200.130:8848 config: server-addr: 192.168.200.130:8848 file-extension: yml nacos\u914d\u7f6e spring: mail: #\u53d1\u4ef6\u670d\u52a1\u5668\u5730\u5740 host: smtp.163.com #\u53d1\u4ef6\u8d26\u53f7 username: itheim@163.com #\u5bf9\u5e94\u8d26\u53f7\u7684\u6388\u6743\u7801 password: xxxxxxxxxxxxxx protocol: smtp port: 25 default-encoding: utf-8 properties.mail.smtp.auth: true properties.mail.smtp.starttls.enable: true properties.mail.smtp.starttls.required: true properties.mail.smtp.ssl.enable: false properties.mail.smtp.timeout: 25000 #\u914d\u7f6e\u90ae\u4ef6\u63a5\u6536\u4eba skywalking: alarm: # \u53d1\u9001\u90ae\u4ef6\u7684\u5730\u5740\uff0c\u548c\u4e0a\u9762username\u4e00\u81f4 from: itheim@163.com receiveEmails: - xx@itcast.cn \u5f15\u5bfc\u7c7b\uff1a \u540c\u65f6\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u7c7b\u52a0\u8f7d\u90ae\u4ef6\u63a5\u6536\u4eba\u7684\u914d\u7f6e\uff1acom.itheima.skywalking.alarm.AlarmEmailProperties package com.heima.alarm.config; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.boot.context.properties.EnableConfigurationProperties; import org.springframework.context.annotation.Configuration; import java.util.List; /** * Created by \u4f20\u667a\u64ad\u5ba2*\u9ed1\u9a6c\u7a0b\u5e8f\u5458. */ @Data @Configuration @EnableConfigurationProperties @ConfigurationProperties(\"skywalking.alarm\") public class AlarmEmailProperties { private String from; private List<String> receiveEmails; } 4\uff1askyWalking\u5728\u544a\u8b66\u4e8b\u4ef6\u53d1\u751f\u540e\u9700\u8981\u8c03\u7528\u914d\u7f6e\u597d\u7684webhook\u63a5\u53e3\uff08POST\uff09\uff0c\u540c\u65f6\u4f1a\u4f20\u9012\u4e00\u4e9b\u53c2\u6570\uff0c\u662fapplication/json\u683c\u5f0f\u7684\uff0c\u5982\u4e0b\uff1a [{ \"scopeId\": 1, \"scope\": \"SERVICE\", \"name\": \"serviceA\", \"id0\": 12, \"id1\": 0, \"ruleName\": \"service_resp_time_rule\", \"alarmMessage\": \"alarmMessage xxxx\", \"startTime\": 1560524171000 }, { \"scopeId\": 1, \"scope\": \"SERVICE\", \"name\": \"serviceB\", \"id0\": 23, \"id1\": 0, \"ruleName\": \"service_resp_time_rule\", \"alarmMessage\": \"alarmMessage yyy\", \"startTime\": 1560524171000 }] \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728service1\u4e2d\u5b9a\u4e49\u4e00\u4e2aDTO\u6765\u63a5\u6536\u6570\u636e\uff1acom.itheima.skywalking.dto.AlarmDTO package com.heima.alarm.model; import lombok.Data; /** * Created by \u4f20\u667a\u64ad\u5ba2*\u9ed1\u9a6c\u7a0b\u5e8f\u5458. */ @Data public class AlarmDTO { private Integer scopeId; private String scope; private String name; private String id0; private String id1; private String ruleName; private String alarmMessage; private Long startTime; } 5\uff1a\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\uff0c\u63a5\u6536SkyWalking\u7684\u544a\u8b66\u901a\u77e5\uff0c\u5e76\u5c06\u6570\u636e\u53d1\u9001\u81f3\u7cfb\u7edf\u8d1f\u8d23\u4eba\u7684\u76f8\u5173\u90ae\u7bb1\uff1acom.itheima.skywalking.controller.AlarmController package com.heima.alarm.controller; import com.heima.alarm.config.AlarmEmailProperties; import com.heima.alarm.model.AlarmDTO; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.mail.SimpleMailMessage; import org.springframework.mail.javamail.JavaMailSender; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestBody; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import java.util.List; @RestController @RequestMapping(\"/alarm\") @Slf4j public class AlarmController { @Autowired private JavaMailSender javaMailSender; @Autowired private AlarmEmailProperties alarmEamilProperties; @PostMapping(\"/emailNotify\") public void emailAlarm(@RequestBody List<AlarmDTO> alarmDTOList){ SimpleMailMessage mailMessage = new SimpleMailMessage(); //\u4ece\u54ea\u4e2a\u90ae\u7bb1\u53d1\u51fa mailMessage.setFrom(alarmEamilProperties.getFrom()); //\u53d1\u9001\u90ae\u4ef6 mailMessage.setTo(alarmEamilProperties.getReceiveEmails().toArray(new String [] {})); //\u4e3b\u9898 mailMessage.setSubject(\"skywalking\u544a\u8b66\u90ae\u4ef6\"); //\u90ae\u4ef6\u5185\u5bb9 mailMessage.setText(alarmDTOList.toString()); javaMailSender.send(mailMessage); log.info(\"\u544a\u8b66\u90ae\u4ef6\u5df2\u53d1\u9001\"); } } 6\uff1a\u56e0\u4e3askywalking\u9ed8\u8ba4\u6709\u4e00\u4e2a\u544a\u8b66\u89c4\u5219\uff1a10\u5206\u949f\u5185\u670d\u52a1\u6210\u529f\u7387\u4f4e\u4e8e80%\u8d85\u8fc72\u6b21\uff0c","title":"3.5.3.\u90ae\u4ef6\u544a\u8b66\u5b9e\u8df5"},{"location":"heimajava/06-%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%AF%87/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/","text":"\u6d88\u606f\u4e2d\u95f4\u4ef6\u9762\u8bd5\u9898-\u53c2\u8003\u56de\u7b54 \u9762\u8bd5\u5b98 \uff1aRabbitMQ-\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u4e0d\u4e22\u5931 \u5019\u9009\u4eba \uff1a \u55ef\uff01\u6211\u4eec\u5f53\u65f6MYSQL\u548cRedis\u7684\u6570\u636e\u53cc\u5199\u4e00\u81f4\u6027\u5c31\u662f\u91c7\u7528RabbitMQ\u5b9e\u73b0\u540c\u6b65\u7684\uff0c\u8fd9\u91cc\u9762\u5c31\u8981\u6c42\u4e86\u6d88\u606f\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u6d88\u606f\u7684\u4e0d\u4e22\u5931\u3002\u4e3b\u8981\u4ece\u4e09\u4e2a\u5c42\u9762\u8003\u8651 \u7b2c\u4e00\u4e2a\u662f\u5f00\u542f\u751f\u4ea7\u8005\u786e\u8ba4\u673a\u5236\uff0c\u786e\u4fdd\u751f\u4ea7\u8005\u7684\u6d88\u606f\u80fd\u5230\u8fbe\u961f\u5217\uff0c\u5982\u679c\u62a5\u9519\u53ef\u4ee5\u5148\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\uff0c\u518d\u53bb\u4fee\u590d\u6570\u636e \u7b2c\u4e8c\u4e2a\u662f\u5f00\u542f\u6301\u4e45\u5316\u529f\u80fd\uff0c\u786e\u4fdd\u6d88\u606f\u672a\u6d88\u8d39\u524d\u5728\u961f\u5217\u4e2d\u4e0d\u4f1a\u4e22\u5931\uff0c\u5176\u4e2d\u7684\u4ea4\u6362\u673a\u3001\u961f\u5217\u3001\u548c\u6d88\u606f\u90fd\u8981\u505a\u6301\u4e45\u5316 \u7b2c\u4e09\u4e2a\u662f\u5f00\u542f\u6d88\u8d39\u8005\u786e\u8ba4\u673a\u5236\u4e3aauto\uff0c\u7531spring\u786e\u8ba4\u6d88\u606f\u5904\u7406\u6210\u529f\u540e\u5b8c\u6210ack\uff0c\u5f53\u7136\u4e5f\u9700\u8981\u8bbe\u7f6e\u4e00\u5b9a\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u4e863\u6b21\uff0c\u5982\u679c\u91cd\u8bd53\u6b21\u8fd8\u6ca1\u6709\u6536\u5230\u6d88\u606f\uff0c\u5c31\u5c06\u5931\u8d25\u540e\u7684\u6d88\u606f\u6295\u9012\u5230\u5f02\u5e38\u4ea4\u6362\u673a\uff0c\u4ea4\u7531\u4eba\u5de5\u5904\u7406 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u6d88\u606f\u7684\u91cd\u590d\u6d88\u8d39\u95ee\u9898\u5982\u4f55\u89e3\u51b3\u7684 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u6211\u4eec\u8fd8\u771f\u9047\u5230\u8fc7\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u5f53\u65f6\u6d88\u8d39\u8005\u662f\u8bbe\u7f6e\u4e86\u81ea\u52a8\u786e\u8ba4\u673a\u5236\uff0c\u5f53\u670d\u52a1\u8fd8\u6ca1\u6765\u5f97\u53ca\u7ed9MQ\u786e\u8ba4\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5b95\u673a\u4e86\uff0c\u5bfc\u81f4\u670d\u52a1\u91cd\u542f\u4e4b\u540e\uff0c\u53c8\u6d88\u8d39\u4e86\u4e00\u6b21\u6d88\u606f\u3002\u8fd9\u6837\u5c31\u91cd\u590d\u6d88\u8d39\u4e86 \u56e0\u4e3a\u6211\u4eec\u5f53\u65f6\u5904\u7406\u7684\u652f\u4ed8\uff08\u8ba2\u5355|\u4e1a\u52a1\u552f\u4e00\u6807\u8bc6\uff09\uff0c\u5b83\u6709\u4e00\u4e2a\u4e1a\u52a1\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u6211\u4eec\u518d\u5904\u7406\u6d88\u606f\u65f6\uff0c\u5148\u5230\u6570\u636e\u5e93\u67e5\u8be2\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u6570\u636e\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u8bf4\u660e\u6ca1\u6709\u5904\u7406\u8fc7\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u6b63\u5e38\u5904\u7406\u8fd9\u4e2a\u6d88\u606f\u4e86\u3002\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u8fd9\u4e2a\u6570\u636e\u4e86\uff0c\u5c31\u8bf4\u660e\u6d88\u606f\u91cd\u590d\u6d88\u8d39\u4e86\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u518d\u6d88\u8d39\u4e86 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u8fd8\u77e5\u9053\u5176\u4ed6\u7684\u89e3\u51b3\u65b9\u6848\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u60f3~ \u5176\u5b9e\u8fd9\u4e2a\u5c31\u662f\u5178\u578b\u7684\u5e42\u7b49\u7684\u95ee\u9898\uff0c\u6bd4\u5982\uff0credis\u5206\u5e03\u5f0f\u9501\u3001\u6570\u636e\u5e93\u7684\u9501\u90fd\u662f\u53ef\u4ee5\u7684 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u4e2d\u6b7b\u4fe1\u4ea4\u6362\u673a ? \uff08RabbitMQ\u5ef6\u8fdf\u961f\u5217\u6709\u4e86\u89e3\u8fc7\u561b\uff09 \u5019\u9009\u4eba \uff1a \u55ef\uff01\u4e86\u89e3\u8fc7\uff01 \u6211\u4eec\u5f53\u65f6\u7684xx\u9879\u76ee\u6709\u4e00\u4e2axx\u4e1a\u52a1\uff0c\u9700\u8981\u7528\u5230\u5ef6\u8fdf\u961f\u5217\uff0c\u5176\u4e2d\u5c31\u662f\u4f7f\u7528RabbitMQ\u6765\u5b9e\u73b0\u7684\u3002 \u5ef6\u8fdf\u961f\u5217\u5c31\u662f\u7528\u5230\u4e86\u6b7b\u4fe1\u4ea4\u6362\u673a\u548cTTL\uff08\u6d88\u606f\u5b58\u6d3b\u65f6\u95f4\uff09\u5b9e\u73b0\u7684\u3002 \u5982\u679c\u6d88\u606f\u8d85\u65f6\u672a\u6d88\u8d39\u5c31\u4f1a\u53d8\u6210\u6b7b\u4fe1\uff0c\u5728RabbitMQ\u4e2d\u5982\u679c\u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\uff0c\u961f\u5217\u53ef\u4ee5\u7ed1\u5b9a\u4e00\u4e2a\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u5728\u6b7b\u4fe1\u4ea4\u6362\u673a\u4e0a\u53ef\u4ee5\u7ed1\u5b9a\u5176\u4ed6\u961f\u5217\uff0c\u5728\u6211\u4eec\u53d1\u6d88\u606f\u7684\u65f6\u5019\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u6307\u5b9aTTL\u7684\u65f6\u95f4\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u5ef6\u8fdf\u961f\u5217\u7684\u529f\u80fd\u4e86\u3002 \u6211\u8bb0\u5f97RabbitMQ\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\uff0c\u5728RabbitMQ\u4e2d\u5b89\u88c5\u4e00\u4e2a\u6b7b\u4fe1\u63d2\u4ef6\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\u4e00\u4e9b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u58f0\u660e\u4ea4\u4e92\u673a\u7684\u65f6\u5019\uff0c\u6307\u5b9a\u8fd9\u4e2a\u5c31\u662f\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u7136\u540e\u5728\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\u76f4\u63a5\u6307\u5b9a\u8d85\u65f6\u65f6\u95f4\u5c31\u884c\u4e86\uff0c\u76f8\u5bf9\u4e8e\u6b7b\u4fe1\u4ea4\u6362\u673a+TTL\u8981\u7701\u7565\u4e86\u4e00\u4e9b\u6b65\u9aa4 \u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u6709100\u4e07\u6d88\u606f\u5806\u79ef\u5728MQ , \u5982\u4f55\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u6211\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\uff0c\u6ca1\u9047\u5230\u8fc7\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e0d\u8fc7\uff0c\u5982\u679c\u53d1\u751f\u4e86\u5806\u79ef\u7684\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6848\u4e5f\u6240\u6709\u5f88\u591a\u7684 \u7b2c\u4e00:\u63d0\u9ad8\u6d88\u8d39\u8005\u7684\u6d88\u8d39\u80fd\u529b ,\u53ef\u4ee5\u4f7f\u7528\u591a\u7ebf\u7a0b\u6d88\u8d39\u4efb\u52a1 \u7b2c\u4e8c\uff1a\u589e\u52a0\u66f4\u591a\u6d88\u8d39\u8005\uff0c\u63d0\u9ad8\u6d88\u8d39\u901f\u5ea6 \u200b \u4f7f\u7528\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f, \u8bbe\u7f6e\u591a\u4e2a\u6d88\u8d39\u8005\u6d88\u8d39\u6d88\u8d39\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u7684\u6d88\u606f \u7b2c\u4e09\uff1a\u6269\u5927\u961f\u5217\u5bb9\u79ef\uff0c\u63d0\u9ad8\u5806\u79ef\u4e0a\u9650 \u53ef\u4ee5\u4f7f\u7528RabbitMQ\u60f0\u6027\u961f\u5217\uff0c\u60f0\u6027\u961f\u5217\u7684\u597d\u5904\u4e3b\u8981\u662f \u2460\u63a5\u6536\u5230\u6d88\u606f\u540e\u76f4\u63a5\u5b58\u5165\u78c1\u76d8\u800c\u975e\u5185\u5b58 \u2461\u6d88\u8d39\u8005\u8981\u6d88\u8d39\u6d88\u606f\u65f6\u624d\u4f1a\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u5e76\u52a0\u8f7d\u5230\u5185\u5b58 \u2462\u652f\u6301\u6570\u767e\u4e07\u6761\u7684\u6d88\u606f\u5b58\u50a8 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u7684\u9ad8\u53ef\u7528\u673a\u5236\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u719f\u6089\u7684~ \u6211\u4eec\u5f53\u65f6\u9879\u76ee\u5728\u751f\u4ea7\u73af\u5883\u4e0b\uff0c\u4f7f\u7528\u7684\u96c6\u7fa4\uff0c\u5f53\u65f6\u642d\u5efa\u662f\u955c\u50cf\u6a21\u5f0f\u96c6\u7fa4\uff0c\u4f7f\u7528\u4e863\u53f0\u673a\u5668\u3002 \u955c\u50cf\u961f\u5217\u7ed3\u6784\u662f\u4e00\u4e3b\u591a\u4ece\uff0c\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u4e3b\u8282\u70b9\u5b8c\u6210\uff0c\u7136\u540e\u540c\u6b65\u7ed9\u955c\u50cf\u8282\u70b9\uff0c\u5982\u679c\u4e3b\u8282\u70b9\u5b95\u673a\u540e\uff0c\u955c\u50cf\u8282\u70b9\u4f1a\u66ff\u4ee3\u6210\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u4e0d\u8fc7\u5728\u4e3b\u4ece\u540c\u6b65\u5b8c\u6210\u524d\uff0c\u4e3b\u8282\u70b9\u5c31\u5df2\u7ecf\u5b95\u673a\uff0c\u53ef\u80fd\u51fa\u73b0\u6570\u636e\u4e22\u5931 \u9762\u8bd5\u5b98 \uff1a\u90a3\u51fa\u73b0\u4e22\u6570\u636e\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba \uff1a \u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4ef2\u88c1\u961f\u5217\uff0c\u4e0e\u955c\u50cf\u961f\u5217\u4e00\u6837\uff0c\u90fd\u662f\u4e3b\u4ece\u6a21\u5f0f\uff0c\u652f\u6301\u4e3b\u4ece\u6570\u636e\u540c\u6b65\uff0c\u4e3b\u4ece\u540c\u6b65\u57fa\u4e8eRaft\u534f\u8bae\uff0c\u5f3a\u4e00\u81f4\u3002 \u5e76\u4e14\u4f7f\u7528\u8d77\u6765\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e\uff0c\u5728\u58f0\u660e\u961f\u5217\u7684\u65f6\u5019\u53ea\u8981\u6307\u5b9a\u8fd9\u4e2a\u662f\u4ef2\u88c1\u961f\u5217\u5373\u53ef \u9762\u8bd5\u5b98 \uff1aKafka\u662f\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u4e0d\u4e22\u5931 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4fdd\u8bc1\u673a\u5236\u5f88\u591a\uff0c\u5728\u53d1\u9001\u6d88\u606f\u5230\u6d88\u8d39\u8005\u63a5\u6536\u6d88\u606f\uff0c\u5728\u6bcf\u4e2a\u9636\u6bb5\u90fd\u6709\u53ef\u80fd\u4f1a\u4e22\u5931\u6d88\u606f\uff0c\u6240\u4ee5\u6211\u4eec\u89e3\u51b3\u7684\u8bdd\u4e5f\u662f\u4ece\u591a\u4e2a\u65b9\u9762\u8003\u8651 \u7b2c\u4e00\u4e2a\u662f\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65\u56de\u8c03\u53d1\u9001\uff0c\u5982\u679c\u6d88\u606f\u53d1\u9001\u5931\u8d25\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u56de\u8c03\u83b7\u53d6\u5931\u8d25\u540e\u7684\u6d88\u606f\u4fe1\u606f\uff0c\u53ef\u4ee5\u8003\u8651\u91cd\u8bd5\u6216\u8bb0\u5f55\u65e5\u5fd7\uff0c\u540e\u8fb9\u518d\u505a\u8865\u507f\u90fd\u662f\u53ef\u4ee5\u7684\u3002\u540c\u65f6\u5728\u751f\u4ea7\u8005\u8fd9\u8fb9\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u6d88\u606f\u91cd\u8bd5\uff0c\u6709\u7684\u65f6\u5019\u662f\u7531\u4e8e\u7f51\u7edc\u6296\u52a8\u7684\u539f\u56e0\u5bfc\u81f4\u53d1\u9001\u4e0d\u6210\u529f\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u91cd\u8bd5\u673a\u5236\u6765\u89e3\u51b3 \u7b2c\u4e8c\u4e2a\u5728broker\u4e2d\u6d88\u606f\u6709\u53ef\u80fd\u4f1a\u4e22\u5931\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7kafka\u7684\u590d\u5236\u673a\u5236\u6765\u786e\u4fdd\u6d88\u606f\u4e0d\u4e22\u5931\uff0c\u5728\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2aacks\uff0c\u5c31\u662f\u786e\u8ba4\u673a\u5236\u3002\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u53c2\u6570\u4e3aall\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5f53\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u5230\u4e86\u5206\u533a\u4e4b\u540e\uff0c\u4e0d\u4ec5\u4ec5\u53ea\u5728leader\u5206\u533a\u4fdd\u5b58\u786e\u8ba4\uff0c\u5728follwer\u5206\u533a\u4e5f\u4f1a\u4fdd\u5b58\u786e\u8ba4\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u526f\u672c\u90fd\u4fdd\u5b58\u786e\u8ba4\u4ee5\u540e\u624d\u7b97\u662f\u6210\u529f\u53d1\u9001\u4e86\u6d88\u606f\uff0c\u6240\u4ee5\uff0c\u8fd9\u6837\u8bbe\u7f6e\u5c31\u5f88\u5927\u7a0b\u5ea6\u4e86\u4fdd\u8bc1\u4e86\u6d88\u606f\u4e0d\u4f1a\u5728broker\u4e22\u5931 \u7b2c\u4e09\u4e2a\u6709\u53ef\u80fd\u662f\u5728\u6d88\u8d39\u8005\u7aef\u4e22\u5931\u6d88\u606f\uff0ckafka\u6d88\u8d39\u6d88\u606f\u90fd\u662f\u6309\u7167offset\u8fdb\u884c\u6807\u8bb0\u6d88\u8d39\u7684\uff0c\u6d88\u8d39\u8005\u9ed8\u8ba4\u662f\u81ea\u52a8\u6309\u671f\u63d0\u4ea4\u5df2\u7ecf\u6d88\u8d39\u7684\u504f\u79fb\u91cf\uff0c\u9ed8\u8ba4\u662f\u6bcf\u96945s\u63d0\u4ea4\u4e00\u6b21\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u5e73\u8861\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u91cd\u590d\u6d88\u8d39\u6216\u4e22\u5931\u6570\u636e\u3002\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u6389\u81ea\u52a8\u63d0\u4ef7\u504f\u79fb\u91cf\uff0c\u6539\u4e3a\u624b\u52a8\u63d0\u4ea4\uff0c\u5f53\u6d88\u8d39\u6210\u529f\u4ee5\u540e\u518d\u62a5\u544a\u7ed9broker\u6d88\u8d39\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6d88\u606f\u4e22\u5931\u548c\u91cd\u590d\u6d88\u8d39\u4e86 \u9762\u8bd5\u5b98 \uff1aKafka\u4e2d\u6d88\u606f\u7684\u91cd\u590d\u6d88\u8d39\u95ee\u9898\u5982\u4f55\u89e3\u51b3\u7684 \u5019\u9009\u4eba \uff1a kafka\u6d88\u8d39\u6d88\u606f\u90fd\u662f\u6309\u7167offset\u8fdb\u884c\u6807\u8bb0\u6d88\u8d39\u7684\uff0c\u6d88\u8d39\u8005\u9ed8\u8ba4\u662f\u81ea\u52a8\u6309\u671f\u63d0\u4ea4\u5df2\u7ecf\u6d88\u8d39\u7684\u504f\u79fb\u91cf\uff0c\u9ed8\u8ba4\u662f\u6bcf\u96945s\u63d0\u4ea4\u4e00\u6b21\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u5e73\u8861\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u91cd\u590d\u6d88\u8d39\u6216\u4e22\u5931\u6570\u636e\u3002\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u6389\u81ea\u52a8\u63d0\u4ef7\u504f\u79fb\u91cf\uff0c\u6539\u4e3a\u624b\u52a8\u63d0\u4ea4\uff0c\u5f53\u6d88\u8d39\u6210\u529f\u4ee5\u540e\u518d\u62a5\u544a\u7ed9broker\u6d88\u8d39\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6d88\u606f\u4e22\u5931\u548c\u91cd\u590d\u6d88\u8d39\u4e86 \u4e3a\u4e86\u6d88\u606f\u7684\u5e42\u7b49\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u552f\u4e00\u4e3b\u952e\u6765\u8fdb\u884c\u533a\u5206\uff0c\u6216\u8005\u662f\u52a0\u9501\uff0c\u6570\u636e\u5e93\u7684\u9501\uff0c\u6216\u8005\u662fredis\u5206\u5e03\u5f0f\u9501\uff0c\u90fd\u80fd\u89e3\u51b3\u5e42\u7b49\u7684\u95ee\u9898 \u9762\u8bd5\u5b98 \uff1aKafka\u662f\u5982\u4f55\u4fdd\u8bc1\u6d88\u8d39\u7684\u987a\u5e8f\u6027 \u5019\u9009\u4eba \uff1a kafka\u9ed8\u8ba4\u5b58\u50a8\u548c\u6d88\u8d39\u6d88\u606f\uff0c\u662f\u4e0d\u80fd\u4fdd\u8bc1\u987a\u5e8f\u6027\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2atopic\u6570\u636e\u53ef\u80fd\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u5206\u533a\u4e2d\uff0c\u6bcf\u4e2a\u5206\u533a\u90fd\u6709\u4e00\u4e2a\u6309\u7167\u987a\u5e8f\u7684\u5b58\u50a8\u7684\u504f\u79fb\u91cf\uff0c\u5982\u679c\u6d88\u8d39\u8005\u5173\u8054\u4e86\u591a\u4e2a\u5206\u533a\u4e0d\u80fd\u4fdd\u8bc1\u987a\u5e8f\u6027 \u5982\u679c\u6709\u8fd9\u6837\u7684\u9700\u6c42\u7684\u8bdd\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u89e3\u51b3\u7684\uff0c\u628a\u6d88\u606f\u90fd\u5b58\u50a8\u540c\u4e00\u4e2a\u5206\u533a\u4e0b\u5c31\u884c\u4e86\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\u8fdb\u884c\u8bbe\u7f6e\uff0c\u7b2c\u4e00\u4e2a\u662f\u53d1\u9001\u6d88\u606f\u65f6\u6307\u5b9a\u5206\u533a\u53f7\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53d1\u9001\u6d88\u606f\u65f6\u6309\u7167\u76f8\u540c\u7684\u4e1a\u52a1\u8bbe\u7f6e\u76f8\u540c\u7684key\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5206\u533a\u4e5f\u662f\u901a\u8fc7key\u7684hashcode\u503c\u6765\u9009\u62e9\u5206\u533a\u7684\uff0chash\u503c\u5982\u679c\u4e00\u6837\u7684\u8bdd\uff0c\u5206\u533a\u80af\u5b9a\u4e5f\u662f\u4e00\u6837\u7684 \u9762\u8bd5\u5b98 \uff1aKafka\u7684\u9ad8\u53ef\u7528\u673a\u5236\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4e3b\u8981\u662f\u6709\u4e24\u4e2a\u5c42\u9762\uff0c\u7b2c\u4e00\u4e2a\u662f\u96c6\u7fa4\uff0c\u7b2c\u4e8c\u4e2a\u662f\u63d0\u4f9b\u4e86\u590d\u5236\u673a\u5236 kafka\u96c6\u7fa4\u6307\u7684\u662f\u7531\u591a\u4e2abroker\u5b9e\u4f8b\u7ec4\u6210\uff0c\u5373\u4f7f\u67d0\u4e00\u53f0\u5b95\u673a\uff0c\u4e5f\u4e0d\u803d\u8bef\u5176\u4ed6broker\u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1 \u590d\u5236\u673a\u5236\u662f\u53ef\u4ee5\u4fdd\u8bc1kafka\u7684\u9ad8\u53ef\u7528\u7684\uff0c\u4e00\u4e2atopic\u6709\u591a\u4e2a\u5206\u533a\uff0c\u6bcf\u4e2a\u5206\u533a\u6709\u591a\u4e2a\u526f\u672c\uff0c\u6709\u4e00\u4e2aleader\uff0c\u5176\u4f59\u7684\u662ffollower\uff0c\u526f\u672c\u5b58\u50a8\u5728\u4e0d\u540c\u7684broker\u4e2d\uff1b\u6240\u6709\u7684\u5206\u533a\u526f\u672c\u7684\u5185\u5bb9\u662f\u90fd\u662f\u76f8\u540c\u7684\uff0c\u5982\u679cleader\u53d1\u751f\u6545\u969c\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u5176\u4e2d\u4e00\u4e2afollower\u63d0\u5347\u4e3aleader\uff0c\u4fdd\u8bc1\u4e86\u7cfb\u7edf\u7684\u5bb9\u9519\u6027\u3001\u9ad8\u53ef\u7528\u6027 \u9762\u8bd5\u5b98 \uff1a\u89e3\u91ca\u4e00\u4e0b\u590d\u5236\u673a\u5236\u4e2d\u7684ISR \u5019\u9009\u4eba \uff1a ISR\u7684\u610f\u601d\u662fin-sync replica\uff0c\u5c31\u662f\u9700\u8981\u540c\u6b65\u590d\u5236\u4fdd\u5b58\u7684follower \u5176\u4e2d\u5206\u533a\u526f\u672c\u6709\u5f88\u591a\u7684follower\uff0c\u5206\u4e3a\u4e86\u4e24\u7c7b\uff0c\u4e00\u4e2a\u662fISR\uff0c\u4e0eleader\u526f\u672c\u540c\u6b65\u4fdd\u5b58\u6570\u636e\uff0c\u53e6\u5916\u4e00\u4e2a\u666e\u901a\u7684\u526f\u672c\uff0c\u662f\u5f02\u6b65\u540c\u6b65\u6570\u636e\uff0c\u5f53leader\u6302\u6389\u4e4b\u540e\uff0c\u4f1a\u4f18\u5148\u4eceISR\u526f\u672c\u5217\u8868\u4e2d\u9009\u53d6\u4e00\u4e2a\u4f5c\u4e3aleader\uff0c\u56e0\u4e3aISR\u662f\u540c\u6b65\u4fdd\u5b58\u6570\u636e\uff0c\u6570\u636e\u66f4\u52a0\u7684\u5b8c\u6574\u4e00\u4e9b\uff0c\u6240\u4ee5\u4f18\u5148\u9009\u62e9ISR\u526f\u672c\u5217\u8868 \u9762\u8bd5\u5b98 \uff1aKafka\u6570\u636e\u6e05\u7406\u673a\u5236\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4e86\u89e3\u8fc7~~ Kafka\u4e2dtopic\u7684\u6570\u636e\u5b58\u50a8\u5728\u5206\u533a\u4e0a\uff0c\u5206\u533a\u5982\u679c\u6587\u4ef6\u8fc7\u5927\u4f1a\u5206\u6bb5\u5b58\u50a8segment \u6bcf\u4e2a\u5206\u6bb5\u90fd\u5728\u78c1\u76d8\u4e0a\u4ee5\u7d22\u5f15(xxxx.index)\u548c\u65e5\u5fd7\u6587\u4ef6(xxxx.log)\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u8fd9\u6837\u5206\u6bb5\u7684\u597d\u5904\u662f\uff0c\u7b2c\u4e00\u80fd\u591f\u51cf\u5c11\u5355\u4e2a\u6587\u4ef6\u5185\u5bb9\u7684\u5927\u5c0f\uff0c\u67e5\u627e\u6570\u636e\u65b9\u4fbf\uff0c\u7b2c\u4e8c\u65b9\u4fbfkafka\u8fdb\u884c\u65e5\u5fd7\u6e05\u7406\u3002 \u5728kafka\u4e2d\u63d0\u4f9b\u4e86\u4e24\u4e2a\u65e5\u5fd7\u7684\u6e05\u7406\u7b56\u7565\uff1a \u7b2c\u4e00\uff0c\u6839\u636e\u6d88\u606f\u7684\u4fdd\u7559\u65f6\u95f4\uff0c\u5f53\u6d88\u606f\u4fdd\u5b58\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86\u6307\u5b9a\u7684\u65f6\u95f4\uff0c\u5c31\u4f1a\u89e6\u53d1\u6e05\u7406\uff0c\u9ed8\u8ba4\u662f168\u5c0f\u65f6\uff08 7\u5929\uff09 \u7b2c\u4e8c\u662f\u6839\u636etopic\u5b58\u50a8\u7684\u6570\u636e\u5927\u5c0f\uff0c\u5f53topic\u6240\u5360\u7684\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e\u4e00\u5b9a\u7684\u9608\u503c\uff0c\u5219\u5f00\u59cb\u5220\u9664\u6700\u4e45\u7684\u6d88\u606f\u3002\u8fd9\u4e2a\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u8fd9\u4e24\u4e2a\u7b56\u7565\u90fd\u53ef\u4ee5\u901a\u8fc7kafka\u7684broker\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u8bbe\u7f6e \u9762\u8bd5\u5b98 \uff1aKafka\u4e2d\u5b9e\u73b0\u9ad8\u6027\u80fd\u7684\u8bbe\u8ba1\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a Kafka \u9ad8\u6027\u80fd\uff0c\u662f\u591a\u65b9\u9762\u534f\u540c\u7684\u7ed3\u679c\uff0c\u5305\u62ec\u5b8f\u89c2\u67b6\u6784\u3001\u5206\u5e03\u5f0f\u5b58\u50a8\u3001ISR \u6570\u636e\u540c\u6b65\u3001\u4ee5\u53ca\u9ad8\u6548\u7684\u5229\u7528\u78c1\u76d8\u3001\u64cd\u4f5c\u7cfb\u7edf\u7279\u6027\u7b49\u3002\u4e3b\u8981\u4f53\u73b0\u6709\u8fd9\u4e48\u51e0\u70b9\uff1a \u6d88\u606f\u5206\u533a\uff1a\u4e0d\u53d7\u5355\u53f0\u670d\u52a1\u5668\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u4e0d\u53d7\u9650\u7684\u5904\u7406\u66f4\u591a\u7684\u6570\u636e \u987a\u5e8f\u8bfb\u5199\uff1a\u78c1\u76d8\u987a\u5e8f\u8bfb\u5199\uff0c\u63d0\u5347\u8bfb\u5199\u6548\u7387 \u9875\u7f13\u5b58\uff1a\u628a\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u628a\u5bf9\u78c1\u76d8\u7684\u8bbf\u95ee\u53d8\u4e3a\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee \u96f6\u62f7\u8d1d\uff1a\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u53ca\u6570\u636e\u62f7\u8d1d \u6d88\u606f\u538b\u7f29\uff1a\u51cf\u5c11\u78c1\u76d8IO\u548c\u7f51\u7edcIO \u5206\u6279\u53d1\u9001\uff1a\u5c06\u6d88\u606f\u6253\u5305\u6279\u91cf\u53d1\u9001\uff0c\u51cf\u5c11\u7f51\u7edc\u5f00\u9500","title":"\u6d88\u606f\u4e2d\u95f4\u4ef6\u9762\u8bd5\u9898 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/06-%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%AF%87/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%8F%82%E8%80%83%E5%9B%9E%E7%AD%94/#-","text":"\u9762\u8bd5\u5b98 \uff1aRabbitMQ-\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u4e0d\u4e22\u5931 \u5019\u9009\u4eba \uff1a \u55ef\uff01\u6211\u4eec\u5f53\u65f6MYSQL\u548cRedis\u7684\u6570\u636e\u53cc\u5199\u4e00\u81f4\u6027\u5c31\u662f\u91c7\u7528RabbitMQ\u5b9e\u73b0\u540c\u6b65\u7684\uff0c\u8fd9\u91cc\u9762\u5c31\u8981\u6c42\u4e86\u6d88\u606f\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u6d88\u606f\u7684\u4e0d\u4e22\u5931\u3002\u4e3b\u8981\u4ece\u4e09\u4e2a\u5c42\u9762\u8003\u8651 \u7b2c\u4e00\u4e2a\u662f\u5f00\u542f\u751f\u4ea7\u8005\u786e\u8ba4\u673a\u5236\uff0c\u786e\u4fdd\u751f\u4ea7\u8005\u7684\u6d88\u606f\u80fd\u5230\u8fbe\u961f\u5217\uff0c\u5982\u679c\u62a5\u9519\u53ef\u4ee5\u5148\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\uff0c\u518d\u53bb\u4fee\u590d\u6570\u636e \u7b2c\u4e8c\u4e2a\u662f\u5f00\u542f\u6301\u4e45\u5316\u529f\u80fd\uff0c\u786e\u4fdd\u6d88\u606f\u672a\u6d88\u8d39\u524d\u5728\u961f\u5217\u4e2d\u4e0d\u4f1a\u4e22\u5931\uff0c\u5176\u4e2d\u7684\u4ea4\u6362\u673a\u3001\u961f\u5217\u3001\u548c\u6d88\u606f\u90fd\u8981\u505a\u6301\u4e45\u5316 \u7b2c\u4e09\u4e2a\u662f\u5f00\u542f\u6d88\u8d39\u8005\u786e\u8ba4\u673a\u5236\u4e3aauto\uff0c\u7531spring\u786e\u8ba4\u6d88\u606f\u5904\u7406\u6210\u529f\u540e\u5b8c\u6210ack\uff0c\u5f53\u7136\u4e5f\u9700\u8981\u8bbe\u7f6e\u4e00\u5b9a\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u6211\u4eec\u5f53\u65f6\u8bbe\u7f6e\u4e863\u6b21\uff0c\u5982\u679c\u91cd\u8bd53\u6b21\u8fd8\u6ca1\u6709\u6536\u5230\u6d88\u606f\uff0c\u5c31\u5c06\u5931\u8d25\u540e\u7684\u6d88\u606f\u6295\u9012\u5230\u5f02\u5e38\u4ea4\u6362\u673a\uff0c\u4ea4\u7531\u4eba\u5de5\u5904\u7406 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u6d88\u606f\u7684\u91cd\u590d\u6d88\u8d39\u95ee\u9898\u5982\u4f55\u89e3\u51b3\u7684 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u6211\u4eec\u8fd8\u771f\u9047\u5230\u8fc7\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u5f53\u65f6\u6d88\u8d39\u8005\u662f\u8bbe\u7f6e\u4e86\u81ea\u52a8\u786e\u8ba4\u673a\u5236\uff0c\u5f53\u670d\u52a1\u8fd8\u6ca1\u6765\u5f97\u53ca\u7ed9MQ\u786e\u8ba4\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5b95\u673a\u4e86\uff0c\u5bfc\u81f4\u670d\u52a1\u91cd\u542f\u4e4b\u540e\uff0c\u53c8\u6d88\u8d39\u4e86\u4e00\u6b21\u6d88\u606f\u3002\u8fd9\u6837\u5c31\u91cd\u590d\u6d88\u8d39\u4e86 \u56e0\u4e3a\u6211\u4eec\u5f53\u65f6\u5904\u7406\u7684\u652f\u4ed8\uff08\u8ba2\u5355|\u4e1a\u52a1\u552f\u4e00\u6807\u8bc6\uff09\uff0c\u5b83\u6709\u4e00\u4e2a\u4e1a\u52a1\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u6211\u4eec\u518d\u5904\u7406\u6d88\u606f\u65f6\uff0c\u5148\u5230\u6570\u636e\u5e93\u67e5\u8be2\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u6570\u636e\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u8bf4\u660e\u6ca1\u6709\u5904\u7406\u8fc7\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u6b63\u5e38\u5904\u7406\u8fd9\u4e2a\u6d88\u606f\u4e86\u3002\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u8fd9\u4e2a\u6570\u636e\u4e86\uff0c\u5c31\u8bf4\u660e\u6d88\u606f\u91cd\u590d\u6d88\u8d39\u4e86\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u518d\u6d88\u8d39\u4e86 \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u8fd8\u77e5\u9053\u5176\u4ed6\u7684\u89e3\u51b3\u65b9\u6848\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u60f3\u60f3~ \u5176\u5b9e\u8fd9\u4e2a\u5c31\u662f\u5178\u578b\u7684\u5e42\u7b49\u7684\u95ee\u9898\uff0c\u6bd4\u5982\uff0credis\u5206\u5e03\u5f0f\u9501\u3001\u6570\u636e\u5e93\u7684\u9501\u90fd\u662f\u53ef\u4ee5\u7684 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u4e2d\u6b7b\u4fe1\u4ea4\u6362\u673a ? \uff08RabbitMQ\u5ef6\u8fdf\u961f\u5217\u6709\u4e86\u89e3\u8fc7\u561b\uff09 \u5019\u9009\u4eba \uff1a \u55ef\uff01\u4e86\u89e3\u8fc7\uff01 \u6211\u4eec\u5f53\u65f6\u7684xx\u9879\u76ee\u6709\u4e00\u4e2axx\u4e1a\u52a1\uff0c\u9700\u8981\u7528\u5230\u5ef6\u8fdf\u961f\u5217\uff0c\u5176\u4e2d\u5c31\u662f\u4f7f\u7528RabbitMQ\u6765\u5b9e\u73b0\u7684\u3002 \u5ef6\u8fdf\u961f\u5217\u5c31\u662f\u7528\u5230\u4e86\u6b7b\u4fe1\u4ea4\u6362\u673a\u548cTTL\uff08\u6d88\u606f\u5b58\u6d3b\u65f6\u95f4\uff09\u5b9e\u73b0\u7684\u3002 \u5982\u679c\u6d88\u606f\u8d85\u65f6\u672a\u6d88\u8d39\u5c31\u4f1a\u53d8\u6210\u6b7b\u4fe1\uff0c\u5728RabbitMQ\u4e2d\u5982\u679c\u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\uff0c\u961f\u5217\u53ef\u4ee5\u7ed1\u5b9a\u4e00\u4e2a\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u5728\u6b7b\u4fe1\u4ea4\u6362\u673a\u4e0a\u53ef\u4ee5\u7ed1\u5b9a\u5176\u4ed6\u961f\u5217\uff0c\u5728\u6211\u4eec\u53d1\u6d88\u606f\u7684\u65f6\u5019\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u6307\u5b9aTTL\u7684\u65f6\u95f4\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u5ef6\u8fdf\u961f\u5217\u7684\u529f\u80fd\u4e86\u3002 \u6211\u8bb0\u5f97RabbitMQ\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\uff0c\u5728RabbitMQ\u4e2d\u5b89\u88c5\u4e00\u4e2a\u6b7b\u4fe1\u63d2\u4ef6\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\u4e00\u4e9b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u58f0\u660e\u4ea4\u4e92\u673a\u7684\u65f6\u5019\uff0c\u6307\u5b9a\u8fd9\u4e2a\u5c31\u662f\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u7136\u540e\u5728\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\u76f4\u63a5\u6307\u5b9a\u8d85\u65f6\u65f6\u95f4\u5c31\u884c\u4e86\uff0c\u76f8\u5bf9\u4e8e\u6b7b\u4fe1\u4ea4\u6362\u673a+TTL\u8981\u7701\u7565\u4e86\u4e00\u4e9b\u6b65\u9aa4 \u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u6709100\u4e07\u6d88\u606f\u5806\u79ef\u5728MQ , \u5982\u4f55\u89e3\u51b3 ? \u5019\u9009\u4eba \uff1a \u6211\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\uff0c\u6ca1\u9047\u5230\u8fc7\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e0d\u8fc7\uff0c\u5982\u679c\u53d1\u751f\u4e86\u5806\u79ef\u7684\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6848\u4e5f\u6240\u6709\u5f88\u591a\u7684 \u7b2c\u4e00:\u63d0\u9ad8\u6d88\u8d39\u8005\u7684\u6d88\u8d39\u80fd\u529b ,\u53ef\u4ee5\u4f7f\u7528\u591a\u7ebf\u7a0b\u6d88\u8d39\u4efb\u52a1 \u7b2c\u4e8c\uff1a\u589e\u52a0\u66f4\u591a\u6d88\u8d39\u8005\uff0c\u63d0\u9ad8\u6d88\u8d39\u901f\u5ea6 \u200b \u4f7f\u7528\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f, \u8bbe\u7f6e\u591a\u4e2a\u6d88\u8d39\u8005\u6d88\u8d39\u6d88\u8d39\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u7684\u6d88\u606f \u7b2c\u4e09\uff1a\u6269\u5927\u961f\u5217\u5bb9\u79ef\uff0c\u63d0\u9ad8\u5806\u79ef\u4e0a\u9650 \u53ef\u4ee5\u4f7f\u7528RabbitMQ\u60f0\u6027\u961f\u5217\uff0c\u60f0\u6027\u961f\u5217\u7684\u597d\u5904\u4e3b\u8981\u662f \u2460\u63a5\u6536\u5230\u6d88\u606f\u540e\u76f4\u63a5\u5b58\u5165\u78c1\u76d8\u800c\u975e\u5185\u5b58 \u2461\u6d88\u8d39\u8005\u8981\u6d88\u8d39\u6d88\u606f\u65f6\u624d\u4f1a\u4ece\u78c1\u76d8\u4e2d\u8bfb\u53d6\u5e76\u52a0\u8f7d\u5230\u5185\u5b58 \u2462\u652f\u6301\u6570\u767e\u4e07\u6761\u7684\u6d88\u606f\u5b58\u50a8 \u9762\u8bd5\u5b98 \uff1aRabbitMQ\u7684\u9ad8\u53ef\u7528\u673a\u5236\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u719f\u6089\u7684~ \u6211\u4eec\u5f53\u65f6\u9879\u76ee\u5728\u751f\u4ea7\u73af\u5883\u4e0b\uff0c\u4f7f\u7528\u7684\u96c6\u7fa4\uff0c\u5f53\u65f6\u642d\u5efa\u662f\u955c\u50cf\u6a21\u5f0f\u96c6\u7fa4\uff0c\u4f7f\u7528\u4e863\u53f0\u673a\u5668\u3002 \u955c\u50cf\u961f\u5217\u7ed3\u6784\u662f\u4e00\u4e3b\u591a\u4ece\uff0c\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u4e3b\u8282\u70b9\u5b8c\u6210\uff0c\u7136\u540e\u540c\u6b65\u7ed9\u955c\u50cf\u8282\u70b9\uff0c\u5982\u679c\u4e3b\u8282\u70b9\u5b95\u673a\u540e\uff0c\u955c\u50cf\u8282\u70b9\u4f1a\u66ff\u4ee3\u6210\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u4e0d\u8fc7\u5728\u4e3b\u4ece\u540c\u6b65\u5b8c\u6210\u524d\uff0c\u4e3b\u8282\u70b9\u5c31\u5df2\u7ecf\u5b95\u673a\uff0c\u53ef\u80fd\u51fa\u73b0\u6570\u636e\u4e22\u5931 \u9762\u8bd5\u5b98 \uff1a\u90a3\u51fa\u73b0\u4e22\u6570\u636e\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5019\u9009\u4eba \uff1a \u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4ef2\u88c1\u961f\u5217\uff0c\u4e0e\u955c\u50cf\u961f\u5217\u4e00\u6837\uff0c\u90fd\u662f\u4e3b\u4ece\u6a21\u5f0f\uff0c\u652f\u6301\u4e3b\u4ece\u6570\u636e\u540c\u6b65\uff0c\u4e3b\u4ece\u540c\u6b65\u57fa\u4e8eRaft\u534f\u8bae\uff0c\u5f3a\u4e00\u81f4\u3002 \u5e76\u4e14\u4f7f\u7528\u8d77\u6765\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e\uff0c\u5728\u58f0\u660e\u961f\u5217\u7684\u65f6\u5019\u53ea\u8981\u6307\u5b9a\u8fd9\u4e2a\u662f\u4ef2\u88c1\u961f\u5217\u5373\u53ef \u9762\u8bd5\u5b98 \uff1aKafka\u662f\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u4e0d\u4e22\u5931 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u8fd9\u4e2a\u4fdd\u8bc1\u673a\u5236\u5f88\u591a\uff0c\u5728\u53d1\u9001\u6d88\u606f\u5230\u6d88\u8d39\u8005\u63a5\u6536\u6d88\u606f\uff0c\u5728\u6bcf\u4e2a\u9636\u6bb5\u90fd\u6709\u53ef\u80fd\u4f1a\u4e22\u5931\u6d88\u606f\uff0c\u6240\u4ee5\u6211\u4eec\u89e3\u51b3\u7684\u8bdd\u4e5f\u662f\u4ece\u591a\u4e2a\u65b9\u9762\u8003\u8651 \u7b2c\u4e00\u4e2a\u662f\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u5f02\u6b65\u56de\u8c03\u53d1\u9001\uff0c\u5982\u679c\u6d88\u606f\u53d1\u9001\u5931\u8d25\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u56de\u8c03\u83b7\u53d6\u5931\u8d25\u540e\u7684\u6d88\u606f\u4fe1\u606f\uff0c\u53ef\u4ee5\u8003\u8651\u91cd\u8bd5\u6216\u8bb0\u5f55\u65e5\u5fd7\uff0c\u540e\u8fb9\u518d\u505a\u8865\u507f\u90fd\u662f\u53ef\u4ee5\u7684\u3002\u540c\u65f6\u5728\u751f\u4ea7\u8005\u8fd9\u8fb9\u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u6d88\u606f\u91cd\u8bd5\uff0c\u6709\u7684\u65f6\u5019\u662f\u7531\u4e8e\u7f51\u7edc\u6296\u52a8\u7684\u539f\u56e0\u5bfc\u81f4\u53d1\u9001\u4e0d\u6210\u529f\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u91cd\u8bd5\u673a\u5236\u6765\u89e3\u51b3 \u7b2c\u4e8c\u4e2a\u5728broker\u4e2d\u6d88\u606f\u6709\u53ef\u80fd\u4f1a\u4e22\u5931\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7kafka\u7684\u590d\u5236\u673a\u5236\u6765\u786e\u4fdd\u6d88\u606f\u4e0d\u4e22\u5931\uff0c\u5728\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2aacks\uff0c\u5c31\u662f\u786e\u8ba4\u673a\u5236\u3002\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u53c2\u6570\u4e3aall\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5f53\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u5230\u4e86\u5206\u533a\u4e4b\u540e\uff0c\u4e0d\u4ec5\u4ec5\u53ea\u5728leader\u5206\u533a\u4fdd\u5b58\u786e\u8ba4\uff0c\u5728follwer\u5206\u533a\u4e5f\u4f1a\u4fdd\u5b58\u786e\u8ba4\uff0c\u53ea\u6709\u5f53\u6240\u6709\u7684\u526f\u672c\u90fd\u4fdd\u5b58\u786e\u8ba4\u4ee5\u540e\u624d\u7b97\u662f\u6210\u529f\u53d1\u9001\u4e86\u6d88\u606f\uff0c\u6240\u4ee5\uff0c\u8fd9\u6837\u8bbe\u7f6e\u5c31\u5f88\u5927\u7a0b\u5ea6\u4e86\u4fdd\u8bc1\u4e86\u6d88\u606f\u4e0d\u4f1a\u5728broker\u4e22\u5931 \u7b2c\u4e09\u4e2a\u6709\u53ef\u80fd\u662f\u5728\u6d88\u8d39\u8005\u7aef\u4e22\u5931\u6d88\u606f\uff0ckafka\u6d88\u8d39\u6d88\u606f\u90fd\u662f\u6309\u7167offset\u8fdb\u884c\u6807\u8bb0\u6d88\u8d39\u7684\uff0c\u6d88\u8d39\u8005\u9ed8\u8ba4\u662f\u81ea\u52a8\u6309\u671f\u63d0\u4ea4\u5df2\u7ecf\u6d88\u8d39\u7684\u504f\u79fb\u91cf\uff0c\u9ed8\u8ba4\u662f\u6bcf\u96945s\u63d0\u4ea4\u4e00\u6b21\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u5e73\u8861\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u91cd\u590d\u6d88\u8d39\u6216\u4e22\u5931\u6570\u636e\u3002\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u6389\u81ea\u52a8\u63d0\u4ef7\u504f\u79fb\u91cf\uff0c\u6539\u4e3a\u624b\u52a8\u63d0\u4ea4\uff0c\u5f53\u6d88\u8d39\u6210\u529f\u4ee5\u540e\u518d\u62a5\u544a\u7ed9broker\u6d88\u8d39\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6d88\u606f\u4e22\u5931\u548c\u91cd\u590d\u6d88\u8d39\u4e86 \u9762\u8bd5\u5b98 \uff1aKafka\u4e2d\u6d88\u606f\u7684\u91cd\u590d\u6d88\u8d39\u95ee\u9898\u5982\u4f55\u89e3\u51b3\u7684 \u5019\u9009\u4eba \uff1a kafka\u6d88\u8d39\u6d88\u606f\u90fd\u662f\u6309\u7167offset\u8fdb\u884c\u6807\u8bb0\u6d88\u8d39\u7684\uff0c\u6d88\u8d39\u8005\u9ed8\u8ba4\u662f\u81ea\u52a8\u6309\u671f\u63d0\u4ea4\u5df2\u7ecf\u6d88\u8d39\u7684\u504f\u79fb\u91cf\uff0c\u9ed8\u8ba4\u662f\u6bcf\u96945s\u63d0\u4ea4\u4e00\u6b21\uff0c\u5982\u679c\u51fa\u73b0\u91cd\u5e73\u8861\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u91cd\u590d\u6d88\u8d39\u6216\u4e22\u5931\u6570\u636e\u3002\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u6389\u81ea\u52a8\u63d0\u4ef7\u504f\u79fb\u91cf\uff0c\u6539\u4e3a\u624b\u52a8\u63d0\u4ea4\uff0c\u5f53\u6d88\u8d39\u6210\u529f\u4ee5\u540e\u518d\u62a5\u544a\u7ed9broker\u6d88\u8d39\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u6d88\u606f\u4e22\u5931\u548c\u91cd\u590d\u6d88\u8d39\u4e86 \u4e3a\u4e86\u6d88\u606f\u7684\u5e42\u7b49\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u552f\u4e00\u4e3b\u952e\u6765\u8fdb\u884c\u533a\u5206\uff0c\u6216\u8005\u662f\u52a0\u9501\uff0c\u6570\u636e\u5e93\u7684\u9501\uff0c\u6216\u8005\u662fredis\u5206\u5e03\u5f0f\u9501\uff0c\u90fd\u80fd\u89e3\u51b3\u5e42\u7b49\u7684\u95ee\u9898 \u9762\u8bd5\u5b98 \uff1aKafka\u662f\u5982\u4f55\u4fdd\u8bc1\u6d88\u8d39\u7684\u987a\u5e8f\u6027 \u5019\u9009\u4eba \uff1a kafka\u9ed8\u8ba4\u5b58\u50a8\u548c\u6d88\u8d39\u6d88\u606f\uff0c\u662f\u4e0d\u80fd\u4fdd\u8bc1\u987a\u5e8f\u6027\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2atopic\u6570\u636e\u53ef\u80fd\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u5206\u533a\u4e2d\uff0c\u6bcf\u4e2a\u5206\u533a\u90fd\u6709\u4e00\u4e2a\u6309\u7167\u987a\u5e8f\u7684\u5b58\u50a8\u7684\u504f\u79fb\u91cf\uff0c\u5982\u679c\u6d88\u8d39\u8005\u5173\u8054\u4e86\u591a\u4e2a\u5206\u533a\u4e0d\u80fd\u4fdd\u8bc1\u987a\u5e8f\u6027 \u5982\u679c\u6709\u8fd9\u6837\u7684\u9700\u6c42\u7684\u8bdd\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u89e3\u51b3\u7684\uff0c\u628a\u6d88\u606f\u90fd\u5b58\u50a8\u540c\u4e00\u4e2a\u5206\u533a\u4e0b\u5c31\u884c\u4e86\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\u8fdb\u884c\u8bbe\u7f6e\uff0c\u7b2c\u4e00\u4e2a\u662f\u53d1\u9001\u6d88\u606f\u65f6\u6307\u5b9a\u5206\u533a\u53f7\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53d1\u9001\u6d88\u606f\u65f6\u6309\u7167\u76f8\u540c\u7684\u4e1a\u52a1\u8bbe\u7f6e\u76f8\u540c\u7684key\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5206\u533a\u4e5f\u662f\u901a\u8fc7key\u7684hashcode\u503c\u6765\u9009\u62e9\u5206\u533a\u7684\uff0chash\u503c\u5982\u679c\u4e00\u6837\u7684\u8bdd\uff0c\u5206\u533a\u80af\u5b9a\u4e5f\u662f\u4e00\u6837\u7684 \u9762\u8bd5\u5b98 \uff1aKafka\u7684\u9ad8\u53ef\u7528\u673a\u5236\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4e3b\u8981\u662f\u6709\u4e24\u4e2a\u5c42\u9762\uff0c\u7b2c\u4e00\u4e2a\u662f\u96c6\u7fa4\uff0c\u7b2c\u4e8c\u4e2a\u662f\u63d0\u4f9b\u4e86\u590d\u5236\u673a\u5236 kafka\u96c6\u7fa4\u6307\u7684\u662f\u7531\u591a\u4e2abroker\u5b9e\u4f8b\u7ec4\u6210\uff0c\u5373\u4f7f\u67d0\u4e00\u53f0\u5b95\u673a\uff0c\u4e5f\u4e0d\u803d\u8bef\u5176\u4ed6broker\u7ee7\u7eed\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1 \u590d\u5236\u673a\u5236\u662f\u53ef\u4ee5\u4fdd\u8bc1kafka\u7684\u9ad8\u53ef\u7528\u7684\uff0c\u4e00\u4e2atopic\u6709\u591a\u4e2a\u5206\u533a\uff0c\u6bcf\u4e2a\u5206\u533a\u6709\u591a\u4e2a\u526f\u672c\uff0c\u6709\u4e00\u4e2aleader\uff0c\u5176\u4f59\u7684\u662ffollower\uff0c\u526f\u672c\u5b58\u50a8\u5728\u4e0d\u540c\u7684broker\u4e2d\uff1b\u6240\u6709\u7684\u5206\u533a\u526f\u672c\u7684\u5185\u5bb9\u662f\u90fd\u662f\u76f8\u540c\u7684\uff0c\u5982\u679cleader\u53d1\u751f\u6545\u969c\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u5176\u4e2d\u4e00\u4e2afollower\u63d0\u5347\u4e3aleader\uff0c\u4fdd\u8bc1\u4e86\u7cfb\u7edf\u7684\u5bb9\u9519\u6027\u3001\u9ad8\u53ef\u7528\u6027 \u9762\u8bd5\u5b98 \uff1a\u89e3\u91ca\u4e00\u4e0b\u590d\u5236\u673a\u5236\u4e2d\u7684ISR \u5019\u9009\u4eba \uff1a ISR\u7684\u610f\u601d\u662fin-sync replica\uff0c\u5c31\u662f\u9700\u8981\u540c\u6b65\u590d\u5236\u4fdd\u5b58\u7684follower \u5176\u4e2d\u5206\u533a\u526f\u672c\u6709\u5f88\u591a\u7684follower\uff0c\u5206\u4e3a\u4e86\u4e24\u7c7b\uff0c\u4e00\u4e2a\u662fISR\uff0c\u4e0eleader\u526f\u672c\u540c\u6b65\u4fdd\u5b58\u6570\u636e\uff0c\u53e6\u5916\u4e00\u4e2a\u666e\u901a\u7684\u526f\u672c\uff0c\u662f\u5f02\u6b65\u540c\u6b65\u6570\u636e\uff0c\u5f53leader\u6302\u6389\u4e4b\u540e\uff0c\u4f1a\u4f18\u5148\u4eceISR\u526f\u672c\u5217\u8868\u4e2d\u9009\u53d6\u4e00\u4e2a\u4f5c\u4e3aleader\uff0c\u56e0\u4e3aISR\u662f\u540c\u6b65\u4fdd\u5b58\u6570\u636e\uff0c\u6570\u636e\u66f4\u52a0\u7684\u5b8c\u6574\u4e00\u4e9b\uff0c\u6240\u4ee5\u4f18\u5148\u9009\u62e9ISR\u526f\u672c\u5217\u8868 \u9762\u8bd5\u5b98 \uff1aKafka\u6570\u636e\u6e05\u7406\u673a\u5236\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4e86\u89e3\u8fc7~~ Kafka\u4e2dtopic\u7684\u6570\u636e\u5b58\u50a8\u5728\u5206\u533a\u4e0a\uff0c\u5206\u533a\u5982\u679c\u6587\u4ef6\u8fc7\u5927\u4f1a\u5206\u6bb5\u5b58\u50a8segment \u6bcf\u4e2a\u5206\u6bb5\u90fd\u5728\u78c1\u76d8\u4e0a\u4ee5\u7d22\u5f15(xxxx.index)\u548c\u65e5\u5fd7\u6587\u4ef6(xxxx.log)\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u8fd9\u6837\u5206\u6bb5\u7684\u597d\u5904\u662f\uff0c\u7b2c\u4e00\u80fd\u591f\u51cf\u5c11\u5355\u4e2a\u6587\u4ef6\u5185\u5bb9\u7684\u5927\u5c0f\uff0c\u67e5\u627e\u6570\u636e\u65b9\u4fbf\uff0c\u7b2c\u4e8c\u65b9\u4fbfkafka\u8fdb\u884c\u65e5\u5fd7\u6e05\u7406\u3002 \u5728kafka\u4e2d\u63d0\u4f9b\u4e86\u4e24\u4e2a\u65e5\u5fd7\u7684\u6e05\u7406\u7b56\u7565\uff1a \u7b2c\u4e00\uff0c\u6839\u636e\u6d88\u606f\u7684\u4fdd\u7559\u65f6\u95f4\uff0c\u5f53\u6d88\u606f\u4fdd\u5b58\u7684\u65f6\u95f4\u8d85\u8fc7\u4e86\u6307\u5b9a\u7684\u65f6\u95f4\uff0c\u5c31\u4f1a\u89e6\u53d1\u6e05\u7406\uff0c\u9ed8\u8ba4\u662f168\u5c0f\u65f6\uff08 7\u5929\uff09 \u7b2c\u4e8c\u662f\u6839\u636etopic\u5b58\u50a8\u7684\u6570\u636e\u5927\u5c0f\uff0c\u5f53topic\u6240\u5360\u7684\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e\u4e00\u5b9a\u7684\u9608\u503c\uff0c\u5219\u5f00\u59cb\u5220\u9664\u6700\u4e45\u7684\u6d88\u606f\u3002\u8fd9\u4e2a\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u8fd9\u4e24\u4e2a\u7b56\u7565\u90fd\u53ef\u4ee5\u901a\u8fc7kafka\u7684broker\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u8bbe\u7f6e \u9762\u8bd5\u5b98 \uff1aKafka\u4e2d\u5b9e\u73b0\u9ad8\u6027\u80fd\u7684\u8bbe\u8ba1\u6709\u4e86\u89e3\u8fc7\u561b \u5019\u9009\u4eba \uff1a Kafka \u9ad8\u6027\u80fd\uff0c\u662f\u591a\u65b9\u9762\u534f\u540c\u7684\u7ed3\u679c\uff0c\u5305\u62ec\u5b8f\u89c2\u67b6\u6784\u3001\u5206\u5e03\u5f0f\u5b58\u50a8\u3001ISR \u6570\u636e\u540c\u6b65\u3001\u4ee5\u53ca\u9ad8\u6548\u7684\u5229\u7528\u78c1\u76d8\u3001\u64cd\u4f5c\u7cfb\u7edf\u7279\u6027\u7b49\u3002\u4e3b\u8981\u4f53\u73b0\u6709\u8fd9\u4e48\u51e0\u70b9\uff1a \u6d88\u606f\u5206\u533a\uff1a\u4e0d\u53d7\u5355\u53f0\u670d\u52a1\u5668\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u4e0d\u53d7\u9650\u7684\u5904\u7406\u66f4\u591a\u7684\u6570\u636e \u987a\u5e8f\u8bfb\u5199\uff1a\u78c1\u76d8\u987a\u5e8f\u8bfb\u5199\uff0c\u63d0\u5347\u8bfb\u5199\u6548\u7387 \u9875\u7f13\u5b58\uff1a\u628a\u78c1\u76d8\u4e2d\u7684\u6570\u636e\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u628a\u5bf9\u78c1\u76d8\u7684\u8bbf\u95ee\u53d8\u4e3a\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee \u96f6\u62f7\u8d1d\uff1a\u51cf\u5c11\u4e0a\u4e0b\u6587\u5207\u6362\u53ca\u6570\u636e\u62f7\u8d1d \u6d88\u606f\u538b\u7f29\uff1a\u51cf\u5c11\u78c1\u76d8IO\u548c\u7f51\u7edcIO \u5206\u6279\u53d1\u9001\uff1a\u5c06\u6d88\u606f\u6253\u5305\u6279\u91cf\u53d1\u9001\uff0c\u51cf\u5c11\u7f51\u7edc\u5f00\u9500","title":"\u6d88\u606f\u4e2d\u95f4\u4ef6\u9762\u8bd5\u9898-\u53c2\u8003\u56de\u7b54"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/","text":"Java\u96c6\u5408\u76f8\u5173\u9762\u8bd5\u9898 \u5bfc\u5b66 \u8fd9\u6b21\u8bfe\u7a0b\u4e3b\u8981\u6d89\u53ca\u5230\u7684\u662fList\u548cMap\u76f8\u5173\u7684\u9762\u8bd5\u9898\uff0c\u6bd4\u8f83\u9ad8\u9891\u5c31\u662f ArrayList LinkedList HashMap ConcurrentHashMap ArrayList\u5e95\u5c42\u5b9e\u73b0\u662f\u6570\u7ec4 LinkedList\u5e95\u5c42\u5b9e\u73b0\u662f\u53cc\u5411\u94fe\u8868 HashMap\u7684\u5e95\u5c42\u5b9e\u73b0\u4f7f\u7528\u4e86\u4f17\u591a\u6570\u636e\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u6570\u7ec4\u3001\u94fe\u8868\u3001\u6563\u5217\u8868\u3001\u7ea2\u9ed1\u6811\u7b49 \u5728\u8bb2\u89e3\u8fd9\u4e9b\u96c6\u5408\u4e4b\u540e\uff0c\u6211\u4eec\u4f1a\u8bb2\u89e3\u6570\u636e\u7ed3\u6784\uff0c\u77e5\u9053\u4e86\u6570\u636e\u7ed3\u6784\u7684\u7279\u70b9\u4e4b\u540e\uff0c\u719f\u6089\u96c6\u5408\u5c31\u66f4\u52a0\u7b80\u5355\u4e86\u3002\u5728\u8bb2\u89e3\u6570\u636e\u7ed3\u6784\u4e4b\u524d\uff0c\u6211\u4eec\u4e5f\u4f1a\u7b80\u5355\u666e\u53ca\u4e00\u4e0b\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u8ba9\u5927\u5bb6\u80fd\u591f\u8bc4\u5224\u4ee3\u7801\u7684\u597d\u574f\uff0c\u4e5f\u80fd\u66f4\u52a0\u6df1\u5165\u53bb\u7406\u89e3\u6570\u636e\u7ed3\u6784\u548c\u96c6\u5408\u3002 1 \u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790 1.1 \u4e3a\u4ec0\u4e48\u8981\u8fdb\u884c\u590d\u6742\u5ea6\u5206\u6790\uff1f \u6211\u4eec\u5148\u6765\u770b\u4e0b\u9762\u8fd9\u4e2a\u4ee3\u7801\uff0c\u4f60\u80fd\u8bc4\u5224\u8fd9\u4e2a\u4ee3\u7801\u7684\u597d\u574f\u5417\uff1f /** ** *\u6c42**1~n**\u7684\u7d2f\u52a0\u548c ** @param* *n ** @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u5176\u5b9e\u5b66\u4e60\u7b97\u6cd5\u590d\u6742\u5ea6\u7684\u597d\u5904\u5c31\u662f\uff1a \u6307\u5bfc\u4f60\u7f16\u5199\u51fa\u6027\u80fd\u66f4\u4f18\u7684\u4ee3\u7801 \u8bc4\u5224\u522b\u4eba\u5199\u7684\u4ee3\u7801\u7684\u597d\u574f \u76f8\u4fe1\u4f60\u5b66\u5b8c\u4e86\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u5c31\u6709\u80fd\u529b\u8bc4\u5224\u4e0a\u9762\u4ee3\u7801\u7684\u597d\u574f\u4e86 \u5173\u4e8e\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u5305\u542b\u4e86\u4e24\u4e2a\u5185\u5bb9\uff0c\u4e00\u4e2a\u662f\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4e00\u4e2a\u662f\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u8bf4\u590d\u6742\u5ea6\uff0c\u90fd\u662f\u6307\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u4e5f\u4f1a\u91cd\u70b9\u8bb2\u89e3\u65f6\u95f4\u590d\u6742\u5ea6 1.2 \u65f6\u95f4\u590d\u6742\u5ea6 1.2.1 \u6848\u4f8b \u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\uff1a\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u8bc4\u4f30\u4ee3\u7801\u7684\u6267\u884c\u8017\u65f6\u7684\uff0c\u5927\u5bb6\u8fd8\u662f\u770b\u521a\u624d\u7684\u4ee3\u7801\uff1a /** ** *\u6c42**1~n**\u7684\u7d2f\u52a0\u548c ** @param* *n ** @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u5206\u6790\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5206\u6790\u8fc7\u7a0b\u5982\u4e0b\uff1a 1.\u5047\u5982\u6bcf\u884c\u4ee3\u7801\u7684\u6267\u884c\u8017\u65f6\u4e00\u6837\uff1a1ms 2.\u5206\u6790\u8fd9\u6bb5\u4ee3\u7801\u603b\u6267\u884c\u591a\u5c11\u884c\uff1f3n+3 3.\u4ee3\u7801\u8017\u65f6\u603b\u65f6\u95f4\uff1a T(n) = (3n + 3) * 1ms T(n):\u5c31\u662f\u4ee3\u7801\u603b\u8017\u65f6 \u6211\u4eec\u73b0\u5728\u6709\u4e86\u603b\u8017\u65f6\uff0c\u9700\u8981\u501f\u52a9\u5927O\u8868\u793a\u6cd5\u6765\u8ba1\u7b97\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6 1.2.2 \u5927O\u8868\u793a\u6cd5 \u5927O\u8868\u793a\u6cd5 \uff1a\u4e0d\u5177\u4f53\u8868\u793a\u4ee3\u7801\u771f\u6b63\u7684\u6267\u884c\u65f6\u95f4\uff0c\u800c\u662f\u8868\u793a \u4ee3\u7801\u6267\u884c\u65f6\u95f4\u968f\u6570\u636e\u89c4\u6a21\u589e\u957f\u7684\u53d8\u5316\u8d8b\u52bf \u3002 \u521a\u624d\u7684\u4ee3\u7801\u793a\u4f8b\u603b\u8017\u65f6\u516c\u5f0f\u4e3a\uff1aT(n) = (3n + 3) * 1ms \u5176\u4e2d (3n + 3) \u662f\u4ee3\u7801\u7684\u603b\u884c\u6570\uff0c\u6bcf\u884c\u6267\u884c\u7684\u65f6\u95f4\u90fd\u4e00\u6837\uff0c\u6240\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff1a T(n)\u4e0e\u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u6210\u6b63\u6bd4(\u4ee3\u7801\u884c\u6570\u8d8a\u591a\uff0c\u6267\u884c\u65f6\u95f4\u8d8a\u957f) \u4e0d\u8fc7\uff0c\u5927O\u8868\u793a\u6cd5\u53ea\u9700\u8981\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u4e0e\u6570\u636e\u89c4\u6a21\u7684\u589e\u957f\u8d8b\u52bf\uff0c\u516c\u5f0f\u53ef\u4ee5\u7b80\u5316\u5982\u4e0b\uff1a T(n) =O(3n + 3)------------> T(n) = O(n) \u5f53n\u5f88\u5927\u65f6\uff0c\u516c\u5f0f\u4e2d\u7684\u4f4e\u9636\uff0c\u5e38\u91cf\uff0c\u7cfb\u6570\u4e09\u90e8\u5206\u5e76\u4e0d\u5de6\u53f3\u5176\u589e\u957f\u8d8b\u52bf\uff0c\u56e0\u6b64\u53ef\u4ee5\u5ffd\u7565\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u6700\u5927\u7684\u91cf\u7ea7\u5c31\u53ef\u4ee5\u4e86 \u4e0b\u56fe\u4e5f\u80fd\u8868\u660e\u6570\u636e\u7684\u8d8b\u52bf 1.2.3 \u5e38\u89c1\u590d\u6742\u5ea6\u8868\u793a\u5f62\u5f0f \u901f\u8bb0\u53e3\u8bc0\uff1a \u5e38\u5bf9\u5e42\u6307\u9636 \u8d8a\u5728\u4e0a\u9762\u7684\u6027\u80fd\u5c31\u8d8a\u9ad8\uff0c\u8d8a\u5f80\u4e0b\u6027\u80fd\u5c31\u8d8a\u4f4e \u4e0b\u56fe\u662f\u4e00\u4e9b\u6bd4\u8f83\u5e38\u89c1\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u65f6\u95f4\u4e0e\u6570\u636e\u89c4\u6a21\u7684\u8d8b\u52bf\uff1a 1.2.4 \u65f6\u95f4\u590d\u6742\u5ea6O(1) \u5b9e\u4f8b\u4ee3\u7801\uff1a public int test01(int n){ int i=0; int j = 1; return i+j; } \u4ee3\u7801\u53ea\u6709\u4e09\u884c\uff0c\u5b83\u7684\u590d\u6742\u5ea6\u4e5f\u662fO(1)\uff0c\u800c\u4e0d\u662fO(3) \u518d\u770b\u5982\u4e0b\u4ee3\u7801\uff1a public void test02(int n){ int i=0; int sum=0; for(;i<100;i++){ sum = sum+i; } System.out.println(sum); } \u6574\u4e2a\u4ee3\u7801\u4e2d\u56e0\u4e3a\u5faa\u73af\u6b21\u6570\u662f\u56fa\u5b9a\u7684\u5c31\u662f100\u6b21\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u590d\u6742\u5ea6\u6211\u4eec\u8ba4\u4e3a\u4e5f\u662fO(1) \u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a \u53ea\u8981\u4ee3\u7801\u7684\u6267\u884c\u65f6\u95f4\u4e0d\u968f\u7740n\u7684\u589e\u5927\u800c\u589e\u5927\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u590d\u6742\u5ea6\u90fd\u662fO(1) 1.2.5 \u65f6\u95f4\u590d\u6742\u5ea6O(n) \u5b9e\u4f8b\u4ee3\u78011\uff1a /** * \u6c421~n\u7684\u7d2f\u52a0\u548c * @param n * @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u4e00\u5c42for\u5faa\u5e8f\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(n) \u5b9e\u4f8b\u4ee3\u78012\uff1a public static int sum2(int n){ int sum = 0; for (int i = 1; i < n; ++i) { for (int j = 1; j < n; ++j) { sum = sum + i * j; } } return sum; } \u8fd9\u4e2a\u4ee3\u7801\u7684\u6267\u884c\u884c\u6570\u4e3a\uff1aO( 3n^2 + 3n + 3 )\uff0c\u4e0d\u8fc7\uff0c\u4f9d\u636e\u5927O\u8868\u793a\u7684\u89c4\u5219\uff1a \u5e38\u91cf\u3001\u7cfb\u6570\u3001\u4f4e\u9636\uff0c\u53ef\u4ee5\u5ffd\u7565 \u6240\u4ee5\u8fd9\u4e2a\u4ee3\u7801\u6700\u7ec8\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1aO(n^2) 1.2.6 \u65f6\u95f4\u590d\u6742\u5ea6O(logn) \u5bf9\u6570\u590d\u6742\u5ea6\u975e\u5e38\u7684\u5e38\u89c1\uff0c\u4f46\u76f8\u5bf9\u6bd4\u8f83\u96be\u4ee5\u5206\u6790\uff0c\u5b9e\u4f8b\u4ee3\u7801\uff1a public void test04(int n){ int i=1; while(i<=n){ i = i * 2; } } \u5206\u6790\u8fd9\u4e2a\u4ee3\u7801\u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u518d\u5f3a\u8c03\u4e00\u4e2a\u524d\u63d0\uff1a \u590d\u6742\u5ea6\u5206\u6790\u5c31\u662f\u8981\u5f04\u6e05\u695a\u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u548c\u6570\u636e\u89c4\u6a21n\u4e4b\u95f4\u7684\u5173\u7cfb \u4ee5\u4e0a\u4ee3\u7801\u6700\u5173\u952e\u7684\u4e00\u884c\u662f\uff1a i = i * 2 \uff0c\u8fd9\u884c\u4ee3\u7801\u53ef\u4ee5\u51b3\u5b9a\u8fd9\u4e2awhile\u5faa\u73af\u6267\u884c\u4ee3\u7801\u7684\u884c\u6570\uff0c i \u7684\u503c\u662f\u53ef\u4ee5\u65e0\u9650\u63a5\u8fd1 n \u7684\u503c\u7684\u3002\u5982\u679c i \u4e00\u65e6\u5927\u4e8e\u7b49\u4e8e\u4e86 n \u5219\u5faa\u73af\u6761\u4ef6\u5c31\u4e0d\u6ee1\u8db3\u4e86\u3002\u4e5f\u5c31\u8bf4\u8fbe\u5230\u4e86\u6700\u5927\u7684\u884c\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5206\u6790\u4e00\u4e0b i \u8fd9\u4e2a\u503c\u53d8\u5316\u7684\u8fc7\u7a0b \u5206\u6790\u8fc7\u7a0b\u5982\u4e0b\uff1a \u7531\u6b64\u53ef\u77e5\uff0c\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8868\u793a\u4e3aO(log n) 1.2.7 \u65f6\u95f4\u590d\u6742\u5ea6O(n * log n) \u5206\u6790\u5b8cO( log n )\uff0c\u90a3O( n * log n )\u5c31\u5f88\u5bb9\u6613\u7406\u89e3\u4e86\uff0c\u6bd4\u5982\u4e0b\u5217\u4ee3\u7801\uff1a public void test05(int n){ int i=0; for(;i<=n;i++){ test04(n); } } public void test04(int n){ int i=1; while(i<=n){ i = i * 2; } } 1.3 \u7a7a\u95f4\u590d\u6742\u5ea6 \u7a7a\u95f4\u590d\u6742\u5ea6\u5168\u79f0\u662f\u6e10\u8fdb\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u8868\u793a\u7b97\u6cd5\u5360\u7528\u7684\u989d\u5916 \u5b58\u50a8\u7a7a\u95f4 \u4e0e \u6570\u636e\u89c4\u6a21 \u4e4b\u95f4\u7684\u589e\u957f\u5173\u7cfb \u770b\u4e0b\u9762\u4ee3\u7801 public void test(int n){ int i=0; int sum=0; for(;i<n;i++){ sum = sum+i; } System.out.println(sum); } \u4ee3\u7801\u6267\u884c\u5e76\u4e0d\u9700\u8981\u5360\u7528\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u53ea\u9700\u8981\u5e38\u91cf\u7ea7\u7684\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\uff0c\u56e0\u6b64\u7a7a\u95f4\u590d\u6742\u5ea6\u662fO(1) \u518d\u6765\u770b\u4e00\u4e2a\u5176\u4ed6\u4f8b\u5b50\uff1a void print(int n) { int i = 0; int[] a = new int[n]; for (i; i <n; ++i) { a[i] = i * i; } for (i = n-1; i >= 0; --i) { System.out.println(a[i]); } } \u4f20\u5165\u4e00\u4e2a\u53d8\u91cfn\uff0c\u51b3\u5b9a\u7533\u8bf7\u591a\u5c11\u7684int\u6570\u7ec4\u7a7a\u95f4\u5185\u5b58\uff0c\u6b64\u6bb5\u4ee3\u7801\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3aO(n) \u6211\u4eec\u5e38\u89c1\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(1),O(n),O(n ^2)\uff0c\u5176\u4ed6\u50cf\u5bf9\u6570\u9636\u7684\u590d\u6742\u5ea6\u51e0\u4e4e\u7528\u4e0d\u5230\uff0c\u56e0\u6b64\u7a7a\u95f4\u590d\u6742\u5ea6\u6bd4\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u8981\u7b80\u5355\u7684\u591a\u3002 2 List\u76f8\u5173\u9762\u8bd5\u9898 2.1 \u6570\u7ec4 2.1.1 \u6570\u7ec4\u6982\u8ff0 \u6570\u7ec4\uff08Array\uff09\u662f\u4e00\u79cd\u7528 \u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4 \u5b58\u50a8 \u76f8\u540c\u6570\u636e\u7c7b\u578b \u6570\u636e\u7684\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u3002 int[] array = {22,33,88,66,55,25}; \u6211\u4eec\u5b9a\u4e49\u4e86\u8fd9\u4e48\u4e00\u4e2a\u6570\u7ec4\u4e4b\u540e\uff0c\u5728\u5185\u5b58\u7684\u8868\u793a\u662f\u8fd9\u6837\u7684\uff1a \u73b0\u5728\u5047\u5982\uff0c\u6211\u4eec\u901a\u8fc7 arrar[1] \uff0c\u60f3\u8981\u83b7\u5f97\u4e0b\u6807\u4e3a1\u8fd9\u4e2a\u5143\u7d20\uff0c\u4f46\u662f\u73b0\u5728\u6808\u5185\u5b58\u4e2d\u6307\u5411\u7684\u5806\u5185\u5b58\u6570\u7ec4\u7684\u9996\u5730\u5740\uff0c\u5b83\u662f\u5982\u4f55\u83b7\u53d6\u4e0b\u6807\u4e3a1\u8fd9\u4e2a\u6570\u636e\u7684\uff1f 2.1.2 \u5bfb\u5740\u516c\u5f0f \u4e3a\u4e86\u65b9\u4fbf\u5927\u5bb6\u7406\u89e3\uff0c\u6211\u4eec\u628a\u6570\u7ec4\u7684\u5185\u5b58\u5730\u5740\u7a0d\u5fae\u6539\u4e86\u4e00\u4e0b\uff0c\u90fd\u6539\u6210\u4e86\u6570\u5b57\uff0c\u5982\u4e0b\u56fe \u5728\u6570\u7ec4\u5728\u5185\u5b58\u4e2d\u67e5\u627e\u5143\u7d20\u7684\u65f6\u5019\uff0c\u662f\u6709\u4e00\u4e2a\u5bfb\u5740\u516c\u5f0f\u7684\uff0c\u5982\u4e0b\uff1a arr[i] = baseAddress + i * dataTypeSize baseAddress\uff1a\u6570\u7ec4\u7684\u9996\u5730\u5740\uff0c\u76ee\u524d\u662f10 dataTypeSize\uff1a\u4ee3\u8868\u6570\u7ec4\u4e2d\u5143\u7d20\u7c7b\u578b\u7684\u5927\u5c0f\uff0c\u76ee\u524d\u6570\u7ec4\u91cd\u5b58\u50a8\u7684\u662fint\u578b\u7684\u6570\u636e\uff0cdataTypeSize=4\u4e2a\u5b57\u8282 arr\uff1a\u6307\u7684\u662f\u6570\u7ec4 i\uff1a\u6307\u7684\u662f\u6570\u7ec4\u7684\u4e0b\u6807 \u6709\u4e86\u5bfb\u5740\u516c\u5f0f\u4ee5\u540e\uff0c\u6211\u4eec\u518d\u6765\u83b7\u53d6\u4e00\u4e0b\u4e0b\u6807\u4e3a1\u7684\u5143\u7d20\uff0c\u8fd9\u4e2a\u662f\u539f\u6765\u7684\u6570\u7ec4 int[] array = {22,33,88,66,55,25}; \u5957\u5165\u516c\u5f0f\uff1a array[1] =10 + i * 4 = 14 \u83b7\u53d6\u523014\u8fd9\u4e2a\u5730\u5740\uff0c\u5c31\u80fd\u83b7\u53d6\u5230\u4e0b\u6807\u4e3a1\u7684\u8fd9\u4e2a\u5143\u7d20\u4e86\u3002 2.1.3 \u64cd\u4f5c\u6570\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6 1.\u968f\u673a\u67e5\u8be2(\u6839\u636e\u7d22\u5f15\u67e5\u8be2) \u6570\u7ec4\u5143\u7d20\u7684\u8bbf\u95ee\u662f\u901a\u8fc7\u4e0b\u6807\u6765\u8bbf\u95ee\u7684\uff0c\u8ba1\u7b97\u673a\u901a\u8fc7\u6570\u7ec4\u7684 \u9996\u5730\u5740 \u548c \u5bfb\u5740\u516c\u5f0f \u80fd\u591f\u5f88\u5feb\u901f\u7684\u627e\u5230\u60f3\u8981\u8bbf\u95ee\u7684\u5143\u7d20 public int test01(int[] a,int i){ return a[i]; // a[i] = baseAddress + i \\* dataSize } \u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u5e76\u4e0d\u4f1a\u968f\u7740\u6570\u7ec4\u7684\u6570\u636e\u89c4\u6a21\u5927\u5c0f\u53d8\u5316\u800c\u53d8\u5316\uff0c\u662f\u5e38\u6570\u7ea7\u7684\uff0c\u6240\u4ee5\u67e5\u8be2\u6570\u636e\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) 2. \u672a\u77e5\u7d22\u5f15\u67e5\u8be2O(n)\u6216O(log2n) \u60c5\u51b5\u4e00\uff1a\u67e5\u627e\u6570\u7ec4\u5185\u7684\u5143\u7d20\uff0c\u67e5\u627e55\u53f7\u6570\u636e\uff0c\u904d\u5386\u6570\u7ec4\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n) \u60c5\u51b5\u4e8c\uff1a\u67e5\u627e\u6392\u5e8f\u540e\u6570\u7ec4\u5185\u7684\u5143\u7d20\uff0c\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u7b97\u6cd5\u67e5\u627e55\u53f7\u6570\u636e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(logn) 3.\u63d2\u5165O(n) \u6570\u7ec4\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u56e0\u6b64\u4e3a\u4e86\u4fdd\u8bc1\u6570\u7ec4\u7684\u8fde\u7eed\u6027\u4f1a\u4f7f\u5f97\u6570\u7ec4\u7684\u63d2\u5165\u548c\u5220\u9664\u7684\u6548\u7387\u53d8\u7684\u5f88\u4f4e\u3002 \u5047\u8bbe\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a n\uff0c\u73b0\u5728\u5982\u679c\u6211\u4eec\u9700\u8981\u5c06\u4e00\u4e2a\u6570\u636e\u63d2\u5165\u5230\u6570\u7ec4\u4e2d\u7684\u7b2c k \u4e2a\u4f4d\u7f6e\u3002\u4e3a\u4e86\u628a\u7b2c k \u4e2a\u4f4d\u7f6e\u817e\u51fa\u6765\u7ed9\u65b0\u6765\u7684\u6570\u636e\uff0c\u6211\u4eec\u9700\u8981\u5c06\u7b2c k\uff5en \u8fd9\u90e8\u5206\u7684\u5143\u7d20\u90fd\u987a\u5e8f\u5730\u5f80\u540e\u632a\u4e00\u4f4d\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u65b0\u589e\u4e4b\u540e\u7684\u6570\u636e\u53d8\u5316\uff0c\u5982\u4e0b \u6240\u4ee5\uff1a \u63d2\u5165\u64cd\u4f5c\uff0c\u6700\u597d\u60c5\u51b5\u4e0b\u662fO(1)\u7684\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u662fO(n)\u7684\uff0c \u5e73\u5747\u60c5\u51b5\u4e0b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u3002 4.\u5220\u9664O(n) \u540c\u7406\u53ef\u5f97\uff1a\u5982\u679c\u6211\u4eec\u8981\u5220\u9664\u7b2c k \u4e2a\u4f4d\u7f6e\u7684\u6570\u636e\uff0c\u4e3a\u4e86\u5185\u5b58\u7684\u8fde\u7eed\u6027\uff0c\u4e5f\u9700\u8981\u642c\u79fb\u6570\u636e\uff0c\u4e0d\u7136\u4e2d\u95f4\u5c31\u4f1a\u51fa\u73b0\u7a7a\u6d1e\uff0c\u5185\u5b58\u5c31\u4e0d\u8fde\u7eed\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u7136\u662fO(n)\u3002 2.2 ArrayList\u6e90\u7801\u5206\u6790 \u5206\u6790ArrayList\u6e90\u7801\u4e3b\u8981\u4ece\u4e09\u4e2a\u65b9\u9762\u53bb\u7ffb\u9605\uff1a\u6210\u5458\u53d8\u91cf\uff0c\u6784\u9020\u51fd\u6570\uff0c\u5173\u952e\u65b9\u6cd5 \u4ee5\u4e0b\u6e90\u7801\u90fd\u6765\u6e90\u4e8ejdk1.8 2.2.1 \u6210\u5458\u53d8\u91cf DEFAULT_CAPACITY = 10; \u9ed8\u8ba4\u521d\u59cb\u7684\u5bb9\u91cf**(CAPACITY) EMPTY_ELEMENTDATA = {}; \u7528\u4e8e\u7a7a\u5b9e\u4f8b\u7684\u5171\u4eab\u7a7a\u6570\u7ec4\u5b9e\u4f8b DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};\u7528\u4e8e\u9ed8\u8ba4\u5927\u5c0f\u7684\u7a7a\u5b9e\u4f8b\u7684\u5171\u4eab\u7a7a\u6570\u7ec4\u5b9e\u4f8b Object[] elementData; \u5b58\u50a8\u5143\u7d20\u7684\u6570\u7ec4\u7f13\u51b2\u533a int size; ArrayList\u7684\u5927\u5c0f\uff08\u5b83\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff09 2.2.2 \u6784\u9020\u65b9\u6cd5 \u7b2c\u4e00\u4e2a\u6784\u9020\u662f\u5e26\u521d\u59cb\u5316\u5bb9\u91cf\u7684\u6784\u9020\u51fd\u6570\uff0c\u53ef\u4ee5\u6309\u7167\u6307\u5b9a\u7684\u5bb9\u91cf\u521d\u59cb\u5316\u6570\u7ec4 \u7b2c\u4e8c\u4e2a\u662f\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u7a7a\u96c6\u5408 \u5c06collection\u5bf9\u8c61\u8f6c\u6362\u6210\u6570\u7ec4\uff0c\u7136\u540e\u5c06\u6570\u7ec4\u7684\u5730\u5740\u7684\u8d4b\u7ed9elementData 2.2.3 ArrayList\u6e90\u7801\u5206\u6790 \u6dfb\u52a0\u6570\u636e\u7684\u6d41\u7a0b \u7ed3\u8bba\uff1a \u5e95\u5c42\u6570\u636e\u7ed3\u6784 ArrayList\u5e95\u5c42\u662f\u7528\u52a8\u6001\u7684\u6570\u7ec4\u5b9e\u73b0\u7684 \u521d\u59cb\u5bb9\u91cf ArrayList\u521d\u59cb\u5bb9\u91cf\u4e3a0\uff0c\u5f53\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u7684\u65f6\u5019\u624d\u4f1a\u521d\u59cb\u5316\u5bb9\u91cf\u4e3a10 \u6269\u5bb9\u903b\u8f91 ArrayList\u5728\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\u662f\u539f\u6765\u5bb9\u91cf\u76841.5\u500d\uff0c\u6bcf\u6b21\u6269\u5bb9\u90fd\u9700\u8981\u62f7\u8d1d\u6570\u7ec4 \u6dfb\u52a0\u903b\u8f91 \u786e\u4fdd\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6\uff08size\uff09\u52a01\u4e4b\u540e\u8db3\u591f\u5b58\u4e0b\u4e0b\u4e00\u4e2a\u6570\u636e \u8ba1\u7b97\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5982\u679c\u5f53\u524d\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6+1\u540e\u7684\u5927\u4e8e\u5f53\u524d\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8c03\u7528grow\u65b9\u6cd5\u6269\u5bb9\uff08\u539f\u6765\u76841.5\u500d\uff09 \u786e\u4fdd\u65b0\u589e\u7684\u6570\u636e\u6709\u5730\u65b9\u5b58\u50a8\u4e4b\u540e\uff0c\u5219\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u4f4d\u4e8esize\u7684\u4f4d\u7f6e\u4e0a\u3002 \u8fd4\u56de\u6dfb\u52a0\u6210\u529f\u5e03\u5c14\u503c\u3002 2.2.4 \u9762\u8bd5\u9898-ArrayList list=new ArrayList(10)\u4e2d\u7684list\u6269\u5bb9\u51e0\u6b21 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u8be5\u8bed\u53e5\u53ea\u662f\u58f0\u660e\u548c\u5b9e\u4f8b\u4e86\u4e00\u4e2a ArrayList\uff0c\u6307\u5b9a\u4e86\u5bb9\u91cf\u4e3a 10\uff0c\u672a\u6269\u5bb9 2.2.4 \u9762\u8bd5\u9898-\u5982\u4f55\u5b9e\u73b0\u6570\u7ec4\u548cList\u4e4b\u95f4\u7684\u8f6c\u6362 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u5982\u4e0b\u4ee3\u7801\uff1a \u53c2\u8003\u56de\u7b54\uff1a \u6570\u7ec4\u8f6cList \uff0c\u4f7f\u7528JDK\u4e2djava.util.Arrays\u5de5\u5177\u7c7b\u7684asList\u65b9\u6cd5 List\u8f6c\u6570\u7ec4\uff0c\u4f7f\u7528List\u7684toArray\u65b9\u6cd5\u3002\u65e0\u53c2toArray\u65b9\u6cd5\u8fd4\u56de Object\u6570\u7ec4\uff0c\u4f20\u5165\u521d\u59cb\u5316\u957f\u5ea6\u7684\u6570\u7ec4\u5bf9\u8c61\uff0c\u8fd4\u56de\u8be5\u5bf9\u8c61\u6570\u7ec4 \u9762\u8bd5\u5b98\u518d\u95ee\uff1a 1\uff0c\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417 2\uff0cList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 \u6570\u7ec4\u8f6cList\u53d7\u5f71\u54cd List\u8f6c\u6570\u7ec4\u4e0d\u53d7\u5f71\u54cd \u518d\u7b54\uff1a 1\uff0c\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417 Arrays.asList\u8f6c\u6362list\u4e4b\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u7684\u5185\u5bb9\uff0clist\u4f1a\u53d7\u5f71\u54cd\uff0c\u56e0\u4e3a\u5b83\u7684\u5e95\u5c42\u4f7f\u7528\u7684Arrays\u7c7b\u4e2d\u7684\u4e00\u4e2a\u5185\u90e8\u7c7bArrayList\u6765\u6784\u9020\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u4e2a\u96c6\u5408\u7684\u6784\u9020\u5668\u4e2d\uff0c\u628a\u6211\u4eec\u4f20\u5165\u7684\u8fd9\u4e2a\u96c6\u5408\u8fdb\u884c\u4e86\u5305\u88c5\u800c\u5df2\uff0c\u6700\u7ec8\u6307\u5411\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u5185\u5b58\u5730\u5740 2\uff0cList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 list\u7528\u4e86toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86list\u5185\u5bb9\uff0c\u6570\u7ec4\u4e0d\u4f1a\u5f71\u54cd\uff0c\u5f53\u8c03\u7528\u4e86toArray\u4ee5\u540e\uff0c\u5728\u5e95\u5c42\u662f\u5b83\u662f\u8fdb\u884c\u4e86\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u8ddf\u539f\u6765\u7684\u5143\u7d20\u5c31\u6ca1\u5565\u5173\u7cfb\u4e86\uff0c\u6240\u4ee5\u5373\u4f7flist\u4fee\u6539\u4e86\u4ee5\u540e\uff0c\u6570\u7ec4\u4e5f\u4e0d\u53d7\u5f71\u54cd 2.3 \u94fe\u8868 2.3.1 \u5355\u5411\u94fe\u8868 \u94fe\u8868\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u79f0\u4e4b\u4e3a\u7ed3\u70b9\uff08Node\uff09 \u7269\u7406\u5b58\u50a8\u5355\u5143\u4e0a\uff0c\u975e\u8fde\u7eed\u3001\u975e\u987a\u5e8f\u7684\u5b58\u50a8\u7ed3\u6784 \u5355\u5411\u94fe\u8868\uff1a\u6bcf\u4e2a\u7ed3\u70b9\u5305\u62ec\u4e24\u4e2a\u90e8\u5206\uff1a\u4e00\u4e2a\u662f\u5b58\u50a8\u6570\u636e\u5143\u7d20\u7684\u6570\u636e\u57df\uff0c\u53e6\u4e00\u4e2a\u662f\u5b58\u50a8\u4e0b\u4e00\u4e2a\u7ed3\u70b9\u5730\u5740\u7684\u6307\u9488\u57df\u3002\u8bb0\u5f55\u4e0b\u4e2a\u7ed3\u70b9\u5730\u5740\u7684\u6307\u9488\u53eb\u4f5c\u540e\u7ee7\u6307\u9488 next \u4ee3\u7801\u5b9e\u73b0\u53c2\u8003\uff1a \u94fe\u8868\u4e2d\u7684\u67d0\u4e2a\u8282\u70b9\u4e3aB\uff0cB\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u4e3aC \u8868\u793a\uff1a B.next==C 2.3.2 \u5355\u5411\u94fe\u8868\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790 \uff081\uff09\u67e5\u8be2\u64cd\u4f5c \u53ea\u6709\u5728\u67e5\u8be2\u5934\u8282\u70b9\u7684\u65f6\u5019\u4e0d\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u67e5\u8be2\u5176\u4ed6\u7ed3\u70b9\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \uff082\uff09\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c \u53ea\u6709\u5728\u6dfb\u52a0\u548c\u5220\u9664\u5934\u8282\u70b9\u7684\u65f6\u5019\u4e0d\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u6dfb\u52a0\u6216\u5220\u9664\u5176\u4ed6\u7ed3\u70b9\u9700\u8981\u904d\u5386\u94fe\u8868\u627e\u5230\u5bf9\u5e94\u8282\u70b9\u540e\uff0c\u624d\u80fd\u5b8c\u6210\u65b0\u589e\u6216\u5220\u9664\u8282\u70b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) 2.3.3 \u53cc\u5411\u94fe\u8868 \u800c\u53cc\u5411\u94fe\u8868\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u652f\u6301\u4e24\u4e2a\u65b9\u5411 \u6bcf\u4e2a\u7ed3\u70b9\u4e0d\u6b62\u6709\u4e00\u4e2a\u540e\u7ee7\u6307\u9488 next \u6307\u5411\u540e\u9762\u7684\u7ed3\u70b9 \u6709\u4e00\u4e2a\u524d\u9a71\u6307\u9488 prev \u6307\u5411\u524d\u9762\u7684\u7ed3\u70b9 \u53c2\u8003\u4ee3\u7801 \u5bf9\u6bd4\u5355\u94fe\u8868\uff1a \u53cc\u5411\u94fe\u8868\u9700\u8981\u989d\u5916\u7684\u4e24\u4e2a\u7a7a\u95f4\u6765\u5b58\u50a8\u540e\u7ee7\u7ed3\u70b9\u548c\u524d\u9a71\u7ed3\u70b9\u7684\u5730\u5740 \u652f\u6301\u53cc\u5411\u904d\u5386\uff0c\u8fd9\u6837\u4e5f\u5e26\u6765\u4e86\u53cc\u5411\u94fe\u8868\u64cd\u4f5c\u7684\u7075\u6d3b\u6027 2.3.4 \u53cc\u5411\u94fe\u8868\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790 \uff081\uff09\u67e5\u8be2\u64cd\u4f5c \u67e5\u8be2\u5934\u5c3e\u7ed3\u70b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u5e73\u5747\u7684\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u7ed9\u5b9a\u8282\u70b9\u627e\u524d\u9a71\u8282\u70b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1) \uff082\uff09\u589e\u5220\u64cd\u4f5c \u5934\u5c3e\u7ed3\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1) \u5176\u4ed6\u90e8\u5206\u7ed3\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(n) \u7ed9\u5b9a\u8282\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1) 2.3.5 \u9762\u8bd5\u9898-ArrayList\u548cLinkedList\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u5e95\u5c42\u6570\u636e\u7ed3\u6784 ArrayList \u662f\u52a8\u6001\u6570\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0 \u64cd\u4f5c\u6570\u636e\u6548\u7387 ArrayList\u6309\u7167\u4e0b\u6807\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6O(1)\u3010\u5185\u5b58\u662f\u8fde\u7eed\u7684\uff0c\u6839\u636e\u5bfb\u5740\u516c\u5f0f\u3011\uff0c LinkedList\u4e0d\u652f\u6301\u4e0b\u6807\u67e5\u8be2 \u67e5\u627e\uff08\u672a\u77e5\u7d22\u5f15\uff09\uff1a ArrayList\u9700\u8981\u904d\u5386\uff0c\u94fe\u8868\u4e5f\u9700\u8981\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(n) \u65b0\u589e\u548c\u5220\u9664 ArrayList\u5c3e\u90e8\u63d2\u5165\u548c\u5220\u9664\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff1b\u5176\u4ed6\u90e8\u5206\u589e\u5220\u9700\u8981\u632a\u52a8\u6570\u7ec4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) LinkedList\u5934\u5c3e\u8282\u70b9\u589e\u5220\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff0c\u5176\u4ed6\u90fd\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u5185\u5b58\u7a7a\u95f4\u5360\u7528 ArrayList\u5e95\u5c42\u662f\u6570\u7ec4\uff0c\u5185\u5b58\u8fde\u7eed\uff0c\u8282\u7701\u5185\u5b58 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u9700\u8981\u5b58\u50a8\u6570\u636e\uff0c\u548c\u4e24\u4e2a\u6307\u9488\uff0c\u66f4\u5360\u7528\u5185\u5b58 \u7ebf\u7a0b\u5b89\u5168 ArrayList\u548cLinkedList\u90fd\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u5982\u679c\u9700\u8981\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff0c\u6709\u4e24\u79cd\u65b9\u6848\uff1a \u5728\u65b9\u6cd5\u5185\u4f7f\u7528\uff0c\u5c40\u90e8\u53d8\u91cf\u5219\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684ArrayList\u548cLinkedList 3 HashMap\u76f8\u5173\u9762\u8bd5\u9898 3.1 \u4e8c\u53c9\u6811 3.1.1 \u4e8c\u53c9\u6811\u6982\u8ff0 \u4e8c\u53c9\u6811\uff0c\u987e\u540d\u601d\u4e49\uff0c\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u6709\u4e24\u4e2a\u201c\u53c9\u201d\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u5206\u522b\u662f\u5de6\u5b50\u8282\u70b9\u548c\u53f3\u5b50\u8282\u70b9\u3002\u4e0d\u8fc7\uff0c\u4e8c\u53c9\u6811\u5e76\u4e0d\u8981\u6c42\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u6709\u7684\u8282\u70b9\u53ea\u6709\u5de6\u5b50\u8282\u70b9\uff0c\u6709\u7684\u8282\u70b9\u53ea\u6709\u53f3\u5b50\u8282\u70b9\u3002 \u4e8c\u53c9\u6811\u6bcf\u4e2a\u8282\u70b9\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u4e5f\u5206\u522b\u6ee1\u8db3\u4e8c\u53c9\u6811\u7684\u5b9a\u4e49\u3002 Java\u4e2d\u6709\u4e24\u4e2a\u65b9\u5f0f\u5b9e\u73b0\u4e8c\u53c9\u6811\uff1a\u6570\u7ec4\u5b58\u50a8\uff0c\u94fe\u5f0f\u5b58\u50a8\u3002 \u57fa\u4e8e\u94fe\u5f0f\u5b58\u50a8\u7684\u6811\u7684\u8282\u70b9\u53ef\u5b9a\u4e49\u5982\u4e0b\uff1a 3.1.2 \u4e8c\u53c9\u641c\u7d22\u6811 \u5728\u4e8c\u53c9\u6811\u4e2d\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u4e8c\u53c9\u6811\u6709\uff1a \u6ee1\u4e8c\u53c9\u6811 \u5b8c\u5168\u4e8c\u53c9\u6811 \u4e8c\u53c9\u641c\u7d22\u6811 \u7ea2\u9ed1\u6811 \u6211\u4eec\u91cd\u70b9\u8bb2\u89e3\u4e8c\u53c9\u641c\u7d22\u6811\u548c\u7ea2\u9ed1\u6811 \uff081\uff09\u4e8c\u53c9\u641c\u7d22\u6811\u6982\u8ff0 \u4e8c\u53c9\u641c\u7d22\u6811(Binary Search Tree,BST)\u53c8\u540d\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u6709\u5e8f\u4e8c\u53c9\u6811\u6216\u8005\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u662f\u4e8c\u53c9\u6811\u4e2d\u6bd4\u8f83\u5e38\u7528\u7684\u4e00\u79cd\u7c7b\u578b \u4e8c\u53c9\u67e5\u627e\u6811\u8981\u6c42\uff0c\u5728\u6811\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\uff0c\u5176\u5de6\u5b50\u6811\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u7684\u503c\uff0c\u90fd\u8981\u5c0f\u4e8e\u8fd9\u4e2a\u8282\u70b9\u7684\u503c\uff0c\u800c\u53f3\u5b50\u6811\u8282\u70b9\u7684\u503c\u90fd\u5927\u4e8e\u8fd9\u4e2a\u8282\u70b9\u7684\u503c \uff082\uff09\u4e8c\u53c9\u641c\u7d22\u6811-\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790 \u5b9e\u9645\u4e0a\u7531\u4e8e\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u5f62\u6001\u5404\u5f02\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u6211\u753b\u4e86\u51e0\u68f5\u6811\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u63d2\u5165\uff0c\u67e5\u627e\uff0c\u5220\u9664\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u63d2\u5165\uff0c\u67e5\u627e\uff0c\u5220\u9664\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(logn) \u6781\u7aef\u60c5\u51b5\u4e0b\u4e8c\u53c9\u641c\u7d22\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u5bf9\u4e8e\u56fe\u4e2d\u8fd9\u79cd\u60c5\u51b5\u5c5e\u4e8e\u6700\u574f\u7684\u60c5\u51b5\uff0c\u4e8c\u53c9\u67e5\u627e\u6811\u5df2\u7ecf\u9000\u5316\u6210\u4e86\u94fe\u8868\uff0c\u5de6\u53f3\u5b50\u6811\u6781\u5ea6\u4e0d\u5e73\u8861\uff0c\u6b64\u65f6\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u80af\u5b9a\u662fO(n)\u3002 3.1.3 \u7ea2\u9ed1\u6811 \uff081\uff09\u6982\u8ff0 \u7ea2\u9ed1\u6811\uff08Red Black Tree\uff09 \uff1a\u4e5f\u662f\u4e00\u79cd\u81ea\u5e73\u8861\u7684\u4e8c\u53c9\u641c\u7d22\u6811(BST)\uff0c\u4e4b\u524d\u53eb\u505a\u5e73\u8861\u4e8c\u53c9B\u6811\uff08Symmetric Binary B-Tree\uff09 \uff082\uff09\u7ea2\u9ed1\u6811\u7684\u7279\u8d28 \u6027\u8d281\uff1a\u8282\u70b9\u8981\u4e48\u662f \u7ea2\u8272 ,\u8981\u4e48\u662f \u9ed1\u8272 \u6027\u8d282\uff1a\u6839\u8282\u70b9\u662f \u9ed1\u8272 \u6027\u8d283\uff1a\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u7684\u7a7a\u8282\u70b9 \u6027\u8d284\uff1a\u7ea2\u9ed1\u6811\u4e2d\u7ea2\u8272\u8282\u70b9\u7684\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272 \u6027\u8d285\uff1a\u4ece\u4efb\u4e00\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u7684\u6240\u6709\u8def\u5f84\u90fd\u5305\u542b\u76f8\u540c\u6570\u76ee\u7684\u9ed1\u8272\u8282\u70b9 \u5728\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u7684\u65f6\u5019\uff0c\u5982\u679c\u4e0d\u7b26\u5408\u8fd9\u4e9b\u6027\u8d28\u4f1a\u53d1\u751f\u65cb\u8f6c\uff0c\u4ee5\u8fbe\u5230\u6240\u6709\u7684\u6027\u8d28\uff0c\u4fdd\u8bc1\u7ea2\u9ed1\u6811\u7684\u5e73\u8861 \uff083\uff09\u7ea2\u9ed1\u6811\u7684\u590d\u6742\u5ea6 \u67e5\u627e\uff1a \u7ea2\u9ed1\u6811\u4e5f\u662f\u4e00\u68f5BST\uff08\u4e8c\u53c9\u641c\u7d22\u6811\uff09\u6811\uff0c\u67e5\u627e\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1aO(log n) \u6dfb\u52a0\uff1a \u6dfb\u52a0\u5148\u8981\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u627e\u5230\u5143\u7d20\u6dfb\u52a0\u7684\u4f4d\u7f6e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(log n) \u6dfb\u52a0\u5b8c\u6210\u540e\u6d89\u53ca\u5230\u590d\u6742\u5ea6\u4e3aO(1)\u7684\u65cb\u8f6c\u8c03\u6574\u64cd\u4f5c \u6545\u6574\u4f53\u590d\u6742\u5ea6\u4e3a\uff1aO(log n) \u5220\u9664\uff1a \u9996\u5148\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u627e\u5230\u88ab\u5220\u9664\u5143\u7d20\u7684\u4f4d\u7f6e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(log n) \u5220\u9664\u5b8c\u6210\u540e\u6d89\u53ca\u5230\u590d\u6742\u5ea6\u4e3aO(1)\u7684\u65cb\u8f6c\u8c03\u6574\u64cd\u4f5c \u6545\u6574\u4f53\u590d\u6742\u5ea6\u4e3a\uff1aO(log n) 3.2 \u6563\u5217\u8868 \u5728HashMap\u4e2d\u7684\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c31\u662f\u6563\u5217\u8868\uff0c\u5728\u6563\u5217\u8868\u4e2d\u53c8\u4f7f\u7528\u5230\u4e86\u7ea2\u9ed1\u6811\u548c\u94fe\u8868 3.2.1 \u6563\u5217\u8868\uff08Hash Table\uff09\u6982\u8ff0 \u6563\u5217\u8868(Hash Table)\u53c8\u540d\u54c8\u5e0c\u8868/Hash\u8868\uff0c\u662f\u6839\u636e\u952e\uff08Key\uff09\u76f4\u63a5\u8bbf\u95ee\u5728\u5185\u5b58\u5b58\u50a8\u4f4d\u7f6e\u503c\uff08Value\uff09\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u662f\u7531\u6570\u7ec4\u6f14\u5316\u800c\u6765\u7684\uff0c\u5229\u7528\u4e86\u6570\u7ec4\u652f\u6301\u6309\u7167\u4e0b\u6807\u8fdb\u884c\u968f\u673a\u8bbf\u95ee\u6570\u636e\u7684\u7279\u6027 \u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5047\u8bbe\u6709100\u4e2a\u4eba\u53c2\u52a0\u9a6c\u62c9\u677e\uff0c\u7f16\u53f7\u662f1-100\uff0c\u5982\u679c\u8981\u7f16\u7a0b\u5b9e\u73b0\u6839\u636e\u9009\u624b\u7684\u7f16\u53f7\u8fc5\u901f\u627e\u5230\u9009\u624b\u4fe1\u606f\uff1f \u53ef\u4ee5\u628a\u9009\u624b\u4fe1\u606f\u5b58\u5165\u6570\u7ec4\u4e2d\uff0c\u9009\u624b\u7f16\u53f7\u5c31\u662f\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u6570\u7ec4\u7684\u5143\u7d20\u5c31\u662f\u9009\u624b\u7684\u4fe1\u606f\u3002 \u5f53\u6211\u4eec\u67e5\u8be2\u9009\u624b\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u6839\u636e\u9009\u624b\u7684\u7f16\u53f7\u5230\u6570\u7ec4\u4e2d\u67e5\u8be2\u5bf9\u5e94\u7684\u5143\u7d20\u5c31\u53ef\u4ee5\u5feb\u901f\u627e\u5230\u9009\u624b\u7684\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\uff1a \u73b0\u5728\u9700\u6c42\u5347\u7ea7\u4e86\uff1a \u5047\u8bbe\u6709100\u4e2a\u4eba\u53c2\u52a0\u9a6c\u62c9\u677e\uff0c\u4e0d\u91c7\u75281-100\u7684\u81ea\u7136\u6570\u5bf9\u9009\u624b\u8fdb\u884c\u7f16\u53f7\uff0c\u7f16\u53f7\u6709\u4e00\u5b9a\u7684\u89c4\u5219\u6bd4\u5982\uff1a2023ZHBJ001\uff0c\u5176\u4e2d2023\u4ee3\u8868\u5e74\u4efd\uff0cZH\u4ee3\u8868\u4e2d\u56fd\uff0cBJ\u4ee3\u8868\u5317\u4eac\uff0c001\u4ee3\u8868\u539f\u6765\u7684\u7f16\u53f7\uff0c\u90a3\u6b64\u65f6\u7684\u7f16\u53f72023ZHBJ001\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u6b64\u65f6\u5e94\u8be5\u5982\u4f55\u5b9e\u73b0\u5462\uff1f \u6211\u4eec\u76ee\u524d\u662f\u628a\u9009\u624b\u7684\u4fe1\u606f\u5b58\u5165\u5230\u6570\u7ec4\u4e2d\uff0c\u4e0d\u8fc7\u9009\u624b\u7684\u7f16\u53f7\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u4e0d\u8fc7\uff0c\u53ef\u4ee5\u628a\u9009\u624b\u7684\u9009\u53f7\u8fdb\u884c\u8f6c\u6362\uff0c\u8f6c\u6362\u4e3a\u6570\u503c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\u4e86\uff1f \u8f6c\u6362\u53ef\u4ee5\u4f7f\u7528\u6563\u5217\u51fd\u6570\u8fdb\u884c\u8f6c\u6362 3.2.2 \u6563\u5217\u51fd\u6570\u548c\u6563\u5217\u51b2\u7a81 \u5c06\u952e(key)\u6620\u5c04\u4e3a\u6570\u7ec4\u4e0b\u6807\u7684\u51fd\u6570\u53eb\u505a\u6563\u5217\u51fd\u6570\u3002\u53ef\u4ee5\u8868\u793a\u4e3a\uff1ahashValue = hash(key) \u6563\u5217\u51fd\u6570\u7684\u57fa\u672c\u8981\u6c42\uff1a \u6563\u5217\u51fd\u6570\u8ba1\u7b97\u5f97\u5230\u7684\u6563\u5217\u503c\u5fc5\u987b\u662f\u5927\u4e8e\u7b49\u4e8e0\u7684\u6b63\u6574\u6570\uff0c\u56e0\u4e3ahashValue\u9700\u8981\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\u3002 \u5982\u679ckey1==key2\uff0c\u90a3\u4e48\u7ecf\u8fc7hash\u540e\u5f97\u5230\u7684\u54c8\u5e0c\u503c\u4e5f\u5fc5\u76f8\u540c\u5373\uff1ahash(key1) == hash(key2\uff09 \u5982\u679ckey1 != key2\uff0c\u90a3\u4e48\u7ecf\u8fc7hash\u540e\u5f97\u5230\u7684\u54c8\u5e0c\u503c\u4e5f\u5fc5\u4e0d\u76f8\u540c\u5373\uff1ahash(key1) != hash(key2) \u5b9e\u9645\u7684\u60c5\u51b5\u4e0b\u60f3\u627e\u4e00\u4e2a\u6563\u5217\u51fd\u6570\u80fd\u591f\u505a\u5230\u5bf9\u4e8e\u4e0d\u540c\u7684key\u8ba1\u7b97\u5f97\u5230\u7684\u6563\u5217\u503c\u90fd\u4e0d\u540c\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u5373\u4fbf\u50cf\u8457\u540d\u7684MD5,SHA\u7b49\u54c8\u5e0c\u7b97\u6cd5\u4e5f\u65e0\u6cd5\u907f\u514d\u8fd9\u4e00\u60c5\u51b5\uff0c\u8fd9\u5c31\u662f\u6563\u5217\u51b2\u7a81(\u6216\u8005\u54c8\u5e0c\u51b2\u7a81\uff0c\u54c8\u5e0c\u78b0\u649e\uff0c \u5c31\u662f\u6307\u591a\u4e2akey\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u6570\u7ec4\u4e0b\u6807\u4f4d\u7f6e ) 3.2.3 \u6563\u5217\u51b2\u7a81-\u94fe\u8868\u6cd5\uff08\u62c9\u94fe\uff09 \u5728\u6563\u5217\u8868\u4e2d\uff0c\u6570\u7ec4\u7684\u6bcf\u4e2a\u4e0b\u6807\u4f4d\u7f6e\u6211\u4eec\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u6876\uff08bucket\uff09\u6216\u8005\u69fd\uff08slot\uff09\uff0c\u6bcf\u4e2a\u6876(\u69fd)\u4f1a\u5bf9\u5e94\u4e00\u6761\u94fe\u8868\uff0c\u6240\u6709\u6563\u5217\u503c\u76f8\u540c\u7684\u5143\u7d20\u6211\u4eec\u90fd\u653e\u5230\u76f8\u540c\u69fd\u4f4d\u5bf9\u5e94\u7684\u94fe\u8868\u4e2d\u3002 \u7b80\u5355\u5c31\u662f\uff0c\u5982\u679c\u6709\u591a\u4e2akey\u6700\u7ec8\u7684hash\u503c\u662f\u4e00\u6837\u7684\uff0c\u5c31\u4f1a\u5b58\u5165\u6570\u7ec4\u7684\u540c\u4e00\u4e2a\u4e0b\u6807\u4e2d\uff0c\u4e0b\u6807\u4e2d\u6302\u4e00\u4e2a\u94fe\u8868\u5b58\u5165\u591a\u4e2a\u6570\u636e 3.2.4 \u65f6\u95f4\u590d\u6742\u5ea6-\u6563\u5217\u8868 1\uff0c\u63d2\u5165\u64cd\u4f5c\uff0c\u901a\u8fc7\u6563\u5217\u51fd\u6570\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u6563\u5217\u69fd\u4f4d\uff0c\u5c06\u5176\u63d2\u5165\u5230\u5bf9\u5e94\u94fe\u8868\u4e2d\u5373\u53ef\uff0c\u63d2\u5165\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(1) \u901a\u8fc7\u8ba1\u7b97\u5c31\u53ef\u4ee5\u627e\u5230\u5143\u7d20 2\uff0c\u5f53\u67e5\u627e\u3001\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u6211\u4eec\u540c\u6837\u901a\u8fc7\u6563\u5217\u51fd\u6570\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u69fd\uff0c\u7136\u540e\u904d\u5386\u94fe\u8868\u67e5\u627e\u6216\u8005\u5220\u9664 \u5e73\u5747\u60c5\u51b5\u4e0b\u57fa\u4e8e\u94fe\u8868\u6cd5\u89e3\u51b3\u51b2\u7a81\u65f6\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u6563\u5217\u8868\u53ef\u80fd\u4f1a\u9000\u5316\u4e3a\u94fe\u8868,\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4ece O(1) \u9000\u5316\u4e3a O(n) \u5c06\u94fe\u8868\u6cd5\u4e2d\u7684\u94fe\u8868\u6539\u9020\u4e3a\u5176\u4ed6\u9ad8\u6548\u7684\u52a8\u6001\u6570\u636e\u7ed3\u6784\uff0c\u6bd4\u5982\u7ea2\u9ed1\u6811\uff0c\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(logn) \u5c06\u94fe\u8868\u6cd5\u4e2d\u7684\u94fe\u8868\u6539\u9020\u7ea2\u9ed1\u6811\u8fd8\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u539f\u56e0\uff0c\u53ef\u4ee5\u9632\u6b62DDos\u653b\u51fb DDos \u653b\u51fb: \u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb(\u82f1\u6587\u610f\u601d\u662fDistributed Denial of Service\uff0c\u7b80\u79f0DDoS\uff09 \u6307\u5904\u4e8e\u4e0d\u540c\u4f4d\u7f6e\u7684\u591a\u4e2a\u653b\u51fb\u8005\u540c\u65f6\u5411\u4e00\u4e2a\u6216\u6570\u4e2a\u76ee\u6807\u53d1\u52a8\u653b\u51fb\uff0c\u6216\u8005\u4e00\u4e2a\u653b\u51fb\u8005\u63a7\u5236\u4e86\u4f4d\u4e8e\u4e0d\u540c\u4f4d\u7f6e\u7684\u591a\u53f0\u673a\u5668\u5e76\u5229\u7528\u8fd9\u4e9b\u673a\u5668\u5bf9\u53d7\u5bb3\u8005\u540c\u65f6\u5b9e\u65bd\u653b\u51fb\u3002\u7531\u4e8e\u653b\u51fb\u7684\u53d1\u51fa\u70b9\u662f\u5206\u5e03\u5728\u4e0d\u540c\u5730\u65b9\u7684\uff0c\u8fd9\u7c7b\u653b\u51fb\u79f0\u4e3a\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff0c\u5176\u4e2d\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u6709\u591a\u4e2a 3.3 \u9762\u8bd5\u9898-\u8bf4\u4e00\u4e0bHashMap\u7684\u5b9e\u73b0\u539f\u7406\uff1f HashMap\u7684\u6570\u636e\u7ed3\u6784\uff1a \u5e95\u5c42\u4f7f\u7528hash\u8868\u6570\u636e\u7ed3\u6784\uff0c\u5373\u6570\u7ec4\u548c\u94fe\u8868\u6216\u7ea2\u9ed1\u6811 \u5f53\u6211\u4eec\u5f80HashMap\u4e2dput\u5143\u7d20\u65f6\uff0c\u5229\u7528key\u7684hashCode\u91cd\u65b0hash\u8ba1\u7b97\u51fa\u5f53\u524d\u5bf9\u8c61\u7684\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807 \u5b58\u50a8\u65f6\uff0c\u5982\u679c\u51fa\u73b0hash\u503c\u76f8\u540c\u7684key\uff0c\u6b64\u65f6\u6709\u4e24\u79cd\u60c5\u51b5\u3002 a. \u5982\u679ckey\u76f8\u540c\uff0c\u5219\u8986\u76d6\u539f\u59cb\u503c\uff1b b. \u5982\u679ckey\u4e0d\u540c\uff08\u51fa\u73b0\u51b2\u7a81\uff09\uff0c\u5219\u5c06\u5f53\u524d\u7684key-value\u653e\u5165\u94fe\u8868\u6216\u7ea2\u9ed1\u6811\u4e2d \u83b7\u53d6\u65f6\uff0c\u76f4\u63a5\u627e\u5230hash\u503c\u5bf9\u5e94\u7684\u4e0b\u6807\uff0c\u5728\u8fdb\u4e00\u6b65\u5224\u65adkey\u662f\u5426\u76f8\u540c\uff0c\u4ece\u800c\u627e\u5230\u5bf9\u5e94\u503c\u3002 \u9762\u8bd5\u5b98\u8ffd\u95ee\uff1aHashMap\u7684jdk1.7\u548cjdk1.8\u6709\u4ec0\u4e48\u533a\u522b JDK1.8\u4e4b\u524d\u91c7\u7528\u7684\u662f\u62c9\u94fe\u6cd5\u3002\u62c9\u94fe\u6cd5\uff1a\u5c06\u94fe\u8868\u548c\u6570\u7ec4\u76f8\u7ed3\u5408\u3002\u4e5f\u5c31\u662f\u8bf4\u521b\u5efa\u4e00\u4e2a\u94fe\u8868\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u6bcf\u4e00\u683c\u5c31\u662f\u4e00\u4e2a\u94fe\u8868\u3002\u82e5\u9047\u5230\u54c8\u5e0c\u51b2\u7a81\uff0c\u5219\u5c06\u51b2\u7a81\u7684\u503c\u52a0\u5230\u94fe\u8868\u4e2d\u5373\u53ef\u3002 jdk1.8\u5728\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u65f6\u6709\u4e86\u8f83\u5927\u7684\u53d8\u5316\uff0c\u5f53\u94fe\u8868\u957f\u5ea6\u5927\u4e8e\u9608\u503c\uff08\u9ed8\u8ba4\u4e3a8\uff09 \u65f6\u5e76\u4e14\u6570\u7ec4\u957f\u5ea6\u8fbe\u523064\u65f6\uff0c\u5c06\u94fe\u8868\u8f6c\u5316\u4e3a\u7ea2\u9ed1\u6811\uff0c\u4ee5\u51cf\u5c11\u641c\u7d22\u65f6\u95f4\u3002\u6269\u5bb9 resize( ) \u65f6\uff0c\u7ea2\u9ed1\u6811\u62c6\u5206\u6210\u7684\u6811\u7684\u7ed3\u70b9\u6570\u5c0f\u4e8e\u7b49\u4e8e\u4e34\u754c\u503c6\u4e2a\uff0c\u5219\u9000\u5316\u6210\u94fe\u8868 3.4 \u9762\u8bd5\u9898-HashMap\u7684put\u65b9\u6cd5\u7684\u5177\u4f53\u6d41\u7a0b 3.4.1 hashMap\u5e38\u89c1\u5c5e\u6027 3.4.2 \u6e90\u7801\u5206\u6790 HashMap\u662f\u61d2\u60f0\u52a0\u8f7d\uff0c\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u5e76\u6ca1\u6709\u521d\u59cb\u5316\u6570\u7ec4 \u5728\u65e0\u53c2\u7684\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u7684\u52a0\u8f7d\u56e0\u5b50\u662f0.75 \u6dfb\u52a0\u6570\u636e\u6d41\u7a0b\u56fe \u5177\u4f53\u7684\u6e90\u7801\uff1a public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node<K,V>[] tab; Node<K,V> p; int n, i; //\u5224\u65ad\u6570\u7ec4\u662f\u5426\u672a\u521d\u59cb\u5316 if ((tab = table) == null || (n = tab.length) == 0) //\u5982\u679c\u672a\u521d\u59cb\u5316\uff0c\u8c03\u7528resize\u65b9\u6cd5 \u8fdb\u884c\u521d\u59cb\u5316 n = (tab = resize()).length; //\u901a\u8fc7 & \u8fd0\u7b97\u6c42\u51fa\u8be5\u6570\u636e\uff08key\uff09\u7684\u6570\u7ec4\u4e0b\u6807\u5e76\u5224\u65ad\u8be5\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u6570\u636e if ((p = tab[i = (n - 1) & hash]) == null) //\u5982\u679c\u6ca1\u6709\uff0c\u76f4\u63a5\u5c06\u6570\u636e\u653e\u5728\u8be5\u4e0b\u6807\u4f4d\u7f6e tab[i] = newNode(hash, key, value, null); //\u8be5\u6570\u7ec4\u4e0b\u6807\u6709\u6570\u636e\u7684\u60c5\u51b5 else { Node<K,V> e; K k; //\u5224\u65ad\u8be5\u4f4d\u7f6e\u6570\u636e\u7684key\u548c\u65b0\u6765\u7684\u6570\u636e\u662f\u5426\u4e00\u6837 if (p.hash == hash && ((k = p.key) == key || (key != null && key.equals(k)))) //\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c\uff0c\u8be5\u8282\u70b9\u7684\u6570\u636e\u8d4b\u503c\u7ed9e,\u540e\u8fb9\u4f1a\u7528\u5230 e = p; //\u5224\u65ad\u662f\u4e0d\u662f\u7ea2\u9ed1\u6811 else if (p instanceof TreeNode) //\u5982\u679c\u662f\u7ea2\u9ed1\u6811\u7684\u8bdd\uff0c\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value); //\u65b0\u6570\u636e\u548c\u5f53\u524d\u6570\u7ec4\u65e2\u4e0d\u76f8\u540c\uff0c\u4e5f\u4e0d\u662f\u7ea2\u9ed1\u6811\u8282\u70b9\uff0c\u8bc1\u660e\u662f\u94fe\u8868 else { //\u904d\u5386\u94fe\u8868 for (int binCount = 0; ; ++binCount) { //\u5224\u65adnext\u8282\u70b9\uff0c\u5982\u679c\u4e3a\u7a7a\u7684\u8bdd\uff0c\u8bc1\u660e\u904d\u5386\u5230\u94fe\u8868\u5c3e\u90e8\u4e86 if ((e = p.next) == null) { //\u628a\u65b0\u503c\u653e\u5165\u94fe\u8868\u5c3e\u90e8 p.next = newNode(hash, key, value, null); //\u56e0\u4e3a\u65b0\u63d2\u5165\u4e86\u4e00\u6761\u6570\u636e\uff0c\u6240\u4ee5\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u4e0d\u662f\u5927\u4e8e\u7b49\u4e8e8 if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st //\u5982\u679c\u662f\uff0c\u8fdb\u884c\u8f6c\u6362\u7ea2\u9ed1\u6811\u64cd\u4f5c treeifyBin(tab, hash); break; } //\u5224\u65ad\u94fe\u8868\u5f53\u4e2d\u6709\u6570\u636e\u76f8\u540c\u7684\u503c\uff0c\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) break; //\u628a\u4e0b\u4e00\u4e2a\u8282\u70b9\u8d4b\u503c\u4e3a\u5f53\u524d\u8282\u70b9 p = e; } } //\u5224\u65ade\u662f\u5426\u4e3a\u7a7a\uff08e\u503c\u4e3a\u4fee\u6539\u64cd\u4f5c\u5b58\u653e\u539f\u6570\u636e\u7684\u53d8\u91cf\uff09 if (e != null) { // existing mapping for key //\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8bc1\u660e\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u53d6\u51fa\u8001\u503c V oldValue = e.value; //\u4e00\u5b9a\u4f1a\u6267\u884c onlyIfAbsent\u4f20\u8fdb\u6765\u7684\u662ffalse if (!onlyIfAbsent || oldValue == null) //\u5c06\u65b0\u503c\u8d4b\u503c\u5f53\u524d\u8282\u70b9 e.value = value; afterNodeAccess(e); //\u8fd4\u56de\u8001\u503c return oldValue; } } //\u8ba1\u6570\u5668\uff0c\u8ba1\u7b97\u5f53\u524d\u8282\u70b9\u7684\u4fee\u6539\u6b21\u6570 ++modCount; //\u5f53\u524d\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u6570\u91cf\u5982\u679c\u5927\u4e8e\u6269\u5bb9\u9608\u503c if (++size > threshold) //\u8fdb\u884c\u6269\u5bb9\u64cd\u4f5c resize(); //\u7a7a\u65b9\u6cd5 afterNodeInsertion(evict); //\u6dfb\u52a0\u64cd\u4f5c\u65f6 \u8fd4\u56de\u7a7a\u503c return null; } \u5224\u65ad\u952e\u503c\u5bf9\u6570\u7ec4table\u662f\u5426\u4e3a\u7a7a\u6216\u4e3anull\uff0c\u5426\u5219\u6267\u884cresize()\u8fdb\u884c\u6269\u5bb9\uff08\u521d\u59cb\u5316\uff09 \u6839\u636e\u952e\u503ckey\u8ba1\u7b97hash\u503c\u5f97\u5230\u6570\u7ec4\u7d22\u5f15 \u5224\u65adtable[i]==null\uff0c\u6761\u4ef6\u6210\u7acb\uff0c\u76f4\u63a5\u65b0\u5efa\u8282\u70b9\u6dfb\u52a0 \u5982\u679ctable[i]==null ,\u4e0d\u6210\u7acb 4.1 \u5224\u65adtable[i]\u7684\u9996\u4e2a\u5143\u7d20\u662f\u5426\u548ckey\u4e00\u6837\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u8986\u76d6value 4.2 \u5224\u65adtable[i] \u662f\u5426\u4e3atreeNode\uff0c\u5373table[i] \u662f\u5426\u662f\u7ea2\u9ed1\u6811\uff0c\u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u76f4\u63a5\u5728\u6811\u4e2d\u63d2\u5165\u952e\u503c\u5bf9 4.3 \u904d\u5386table[i]\uff0c\u94fe\u8868\u7684\u5c3e\u90e8\u63d2\u5165\u6570\u636e\uff0c\u7136\u540e\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u5426\u5927\u4e8e8\uff0c\u5927\u4e8e8\u7684\u8bdd\u628a\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5728\u7ea2\u9ed1\u6811\u4e2d\u6267\u884c\u63d2\u5165\u64cd \u4f5c\uff0c\u904d\u5386\u8fc7\u7a0b\u4e2d\u82e5\u53d1\u73b0key\u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6value \u63d2\u5165\u6210\u529f\u540e\uff0c\u5224\u65ad\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cfsize\u662f\u5426\u8d85\u591a\u4e86\u6700\u5927\u5bb9\u91cfthreshold\uff08\u6570\u7ec4\u957f\u5ea6*0.75\uff09\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u8fdb\u884c\u6269\u5bb9\u3002 3.5 \u9762\u8bd5\u9898-\u8bb2\u4e00\u8bb2HashMap\u7684\u6269\u5bb9\u673a\u5236 \u6269\u5bb9\u7684\u6d41\u7a0b\uff1a \u6e90\u7801\uff1a //\u6269\u5bb9\u3001\u521d\u59cb\u5316\u6570\u7ec4 final Node<K,V>[] resize() { Node<K,V>[] oldTab = table; //\u5982\u679c\u5f53\u524d\u6570\u7ec4\u4e3anull\u7684\u65f6\u5019\uff0c\u628aoldCap\u8001\u6570\u7ec4\u5bb9\u91cf\u8bbe\u7f6e\u4e3a0 int oldCap = (oldTab == null) ? 0 : oldTab.length; //\u8001\u7684\u6269\u5bb9\u9608\u503c int oldThr = threshold; int newCap, newThr = 0; //\u5224\u65ad\u6570\u7ec4\u5bb9\u91cf\u662f\u5426\u5927\u4e8e0\uff0c\u5927\u4e8e0\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u521d\u59cb\u5316 if (oldCap > 0) { //\u5224\u65ad\u5f53\u524d\u6570\u7ec4\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6700\u5927\u6570\u7ec4\u957f\u5ea6 if (oldCap >= MAXIMUM_CAPACITY) { //\u5982\u679c\u662f\uff0c\u5c06\u6269\u5bb9\u9608\u503c\u76f4\u63a5\u8bbe\u7f6e\u4e3aint\u7c7b\u578b\u7684\u6700\u5927\u6570\u503c\u5e76\u76f4\u63a5\u8fd4\u56de threshold = Integer.MAX_VALUE; return oldTab; } //\u5982\u679c\u5728\u6700\u5927\u957f\u5ea6\u8303\u56f4\u5185\uff0c\u5219\u9700\u8981\u6269\u5bb9 OldCap << 1\u7b49\u4ef7\u4e8eoldCap*2 //\u8fd0\u7b97\u8fc7\u540e\u5224\u65ad\u662f\u4e0d\u662f\u6700\u5927\u503c\u5e76\u4e14oldCap\u9700\u8981\u5927\u4e8e16 else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY && oldCap >= DEFAULT_INITIAL_CAPACITY) newThr = oldThr << 1; // double threshold \u7b49\u4ef7\u4e8eoldThr*2 } //\u5982\u679coldCap<0\uff0c\u4f46\u662f\u5df2\u7ecf\u521d\u59cb\u5316\u4e86\uff0c\u50cf\u628a\u5143\u7d20\u5220\u9664\u5b8c\u4e4b\u540e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5b83\u7684\u4e34\u754c\u503c\u80af\u5b9a\u8fd8\u5b58\u5728\uff0c \u5982\u679c\u662f\u9996\u6b21\u521d\u59cb\u5316\uff0c\u5b83\u7684\u4e34\u754c\u503c\u5219\u4e3a0 else if (oldThr > 0) // initial capacity was placed in threshold newCap = oldThr; //\u6570\u7ec4\u672a\u521d\u59cb\u5316\u7684\u60c5\u51b5\uff0c\u5c06\u9608\u503c\u548c\u6269\u5bb9\u56e0\u5b50\u90fd\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } //\u521d\u59cb\u5316\u5bb9\u91cf\u5c0f\u4e8e16\u7684\u65f6\u5019\uff0c\u6269\u5bb9\u9608\u503c\u662f\u6ca1\u6709\u8d4b\u503c\u7684 if (newThr == 0) { //\u521b\u5efa\u9608\u503c float ft = (float)newCap * loadFactor; //\u5224\u65ad\u65b0\u5bb9\u91cf\u548c\u65b0\u9608\u503c\u662f\u5426\u5927\u4e8e\u6700\u5927\u5bb9\u91cf newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } //\u8ba1\u7b97\u51fa\u6765\u7684\u9608\u503c\u8d4b\u503c threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) //\u6839\u636e\u4e0a\u8fb9\u8ba1\u7b97\u5f97\u51fa\u7684\u5bb9\u91cf \u521b\u5efa\u65b0\u7684\u6570\u7ec4 Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap]; //\u8d4b\u503c table = newTab; //\u6269\u5bb9\u64cd\u4f5c\uff0c\u5224\u65ad\u4e0d\u4e3a\u7a7a\u8bc1\u660e\u4e0d\u662f\u521d\u59cb\u5316\u6570\u7ec4 if (oldTab != null) { //\u904d\u5386\u6570\u7ec4 for (int j = 0; j < oldCap; ++j) { Node<K,V> e; //\u5224\u65ad\u5f53\u524d\u4e0b\u6807\u4e3aj\u7684\u6570\u7ec4\u5982\u679c\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8d4b\u503c\u4e2ae\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c if ((e = oldTab[j]) != null) { //\u5c06\u6570\u7ec4\u4f4d\u7f6e\u7f6e\u7a7a oldTab[j] = null; //\u5224\u65ad\u662f\u5426\u6709\u4e0b\u4e2a\u8282\u70b9 if (e.next == null) //\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u91cd\u65b0\u8ba1\u7b97\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5e76\u653e\u8fdb\u53bb newTab[e.hash & (newCap - 1)] = e; //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6811\u5316 else if (e instanceof TreeNode) //\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c ((TreeNode<K,V>)e).split(this, newTab, j, oldCap); //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u6ca1\u6709\u6811\u5316\uff08\u94fe\u8868\u5f62\u5f0f\uff09 else { //\u6bd4\u5982\u8001\u6570\u7ec4\u5bb9\u91cf\u662f16\uff0c\u90a3\u4e0b\u6807\u5c31\u4e3a0-15 //\u6269\u5bb9\u64cd\u4f5c*2\uff0c\u5bb9\u91cf\u5c31\u53d8\u4e3a32\uff0c\u4e0b\u6807\u4e3a0-31 //\u4f4e\u4f4d\uff1a0-15\uff0c\u9ad8\u4f4d16-31 //\u5b9a\u4e49\u4e86\u56db\u4e2a\u53d8\u91cf // \u4f4e\u4f4d\u5934 \u4f4e\u4f4d\u5c3e Node<K,V> loHead = null, loTail = null; // \u9ad8\u4f4d\u5934 \u9ad8\u4f4d\u5c3e Node<K,V> hiHead = null, hiTail = null; //\u4e0b\u4e2a\u8282\u70b9 Node<K,V> next; //\u5faa\u73af\u904d\u5386 do { //\u53d6\u51fanext\u8282\u70b9 next = e.next; //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e3a0 if ((e.hash & oldCap) == 0) { //\u5982\u679c\u4f4e\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (loTail == null) //\u5c06e\u503c\u653e\u5165\u4f4e\u4f4d\u5934 loHead = e; //\u4f4e\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 loTail.next = e; //\u8bb0\u5f55\u4f4e\u4f4d\u5c3e\u6570\u636e loTail = e; } //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e0d\u4e3a0 else { //\u5982\u679c\u9ad8\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (hiTail == null) //\u5c06e\u503c\u653e\u5165\u9ad8\u4f4d\u5934 hiHead = e; //\u9ad8\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 hiTail.next = e; //\u8bb0\u5f55\u9ad8\u4f4d\u5c3e\u6570\u636e hiTail = e; } } //\u5982\u679ce\u4e0d\u4e3a\u7a7a\uff0c\u8bc1\u660e\u6ca1\u6709\u5230\u94fe\u8868\u5c3e\u90e8\uff0c\u7ee7\u7eed\u6267\u884c\u5faa\u73af while ((e = next) != null); //\u4f4e\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (loTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a loTail.next = null; //\u5c06\u4f4e\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684\u539f\u4e0b\u6807\u4f4d\u7f6e newTab[j] = loHead; } //\u9ad8\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (hiTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a hiTail.next = null; //\u5c06\u9ad8\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684(\u539f\u4e0b\u6807+\u539f\u6570\u7ec4\u5bb9\u91cf)\u4f4d\u7f6e newTab[j + oldCap] = hiHead; } } } } } //\u8fd4\u56de\u65b0\u7684\u6570\u7ec4\u5bf9\u8c61 return newTab; } \u5728\u6dfb\u52a0\u5143\u7d20\u6216\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981\u8c03\u7528resize\u65b9\u6cd5\u8fdb\u884c\u6269\u5bb9\uff0c\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u521d\u59cb\u5316\u6570\u7ec4\u957f\u5ea6\u4e3a16\uff0c\u4ee5\u540e\u6bcf\u6b21\u6bcf\u6b21\u6269\u5bb9\u90fd\u662f\u8fbe\u5230\u4e86\u6269\u5bb9\u9608\u503c\uff08\u6570\u7ec4\u957f\u5ea6 * 0.75\uff09 \u6bcf\u6b21\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u90fd\u662f\u6269\u5bb9\u4e4b\u524d\u5bb9\u91cf\u76842\u500d\uff1b \u6269\u5bb9\u4e4b\u540e\uff0c\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u9700\u8981\u628a\u8001\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u632a\u52a8\u5230\u65b0\u7684\u6570\u7ec4\u4e2d \u6ca1\u6709hash\u51b2\u7a81\u7684\u8282\u70b9\uff0c\u5219\u76f4\u63a5\u4f7f\u7528 e.hash & (newCap - 1) \u8ba1\u7b97\u65b0\u6570\u7ec4\u7684\u7d22\u5f15\u4f4d\u7f6e \u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u8d70\u7ea2\u9ed1\u6811\u7684\u6dfb\u52a0 \u5982\u679c\u662f\u94fe\u8868\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u53ef\u80fd\u9700\u8981\u62c6\u5206\u94fe\u8868\uff0c\u5224\u65ad(e.hash & oldCap)\u662f\u5426\u4e3a0\uff0c\u8be5\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u505c\u7559\u5728\u539f\u59cb\u4f4d\u7f6e\uff0c\u8981\u4e48\u79fb\u52a8\u5230\u539f\u59cb\u4f4d\u7f6e+\u589e\u52a0\u7684\u6570\u7ec4\u5927\u5c0f\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a 3.6 \u9762\u8bd5\u9898-hashMap\u7684\u5bfb\u5740\u7b97\u6cd5 \u5728putVal\u65b9\u6cd5\u4e2d\uff0c\u6709\u4e00\u4e2ahash(key)\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u6765\u53bb\u8ba1\u7b97key\u7684hash\u503c\u7684\uff0c\u770b\u4e0b\u9762\u7684\u4ee3\u7801 \u9996\u5148\u83b7\u53d6key\u7684hashCode\u503c\uff0c\u7136\u540e\u53f3\u79fb16\u4f4d \u5f02\u6216\u8fd0\u7b97 \u539f\u6765\u7684hashCode\u503c\uff0c\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u4f7f\u539f\u6765\u7684hash\u503c\u66f4\u52a0\u5747\u5300\uff0c\u51cf\u5c11hash\u51b2\u7a81 \u6709\u4e86hash\u503c\u4e4b\u540e\uff0c\u5c31\u5f88\u65b9\u4fbf\u7684\u53bb\u8ba1\u7b97\u5f53\u524dkey\u7684\u5728\u6570\u7ec4\u4e2d\u5b58\u50a8\u7684\u4e0b\u6807\uff0c\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff1a (n-1)&hash : \u5f97\u5230\u6570\u7ec4\u4e2d\u7684\u7d22\u5f15\uff0c\u4ee3\u66ff\u53d6\u6a21\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u6570\u7ec4\u957f\u5ea6\u5fc5\u987b\u662f2\u7684n\u6b21\u5e42 \u5173\u4e8ehash\u503c\u7684\u5176\u4ed6\u9762\u8bd5\u9898\uff1a\u4e3a\u4f55HashMap\u7684\u6570\u7ec4\u957f\u5ea6\u4e00\u5b9a\u662f2\u7684\u6b21\u5e42\uff1f \u8ba1\u7b97\u7d22\u5f15\u65f6\u6548\u7387\u66f4\u9ad8\uff1a\u5982\u679c\u662f 2 \u7684 n \u6b21\u5e42\u53ef\u4ee5\u4f7f\u7528\u4f4d\u4e0e\u8fd0\u7b97\u4ee3\u66ff\u53d6\u6a21 \u6269\u5bb9\u65f6\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\u6548\u7387\u66f4\u9ad8\uff1a hash & oldCap == 0 \u7684\u5143\u7d20\u7559\u5728\u539f\u6765\u4f4d\u7f6e \uff0c\u5426\u5219\u65b0\u4f4d\u7f6e = \u65e7\u4f4d\u7f6e + oldCap 3.7 \u9762\u8bd5\u9898-hashmap\u57281.7\u60c5\u51b5\u4e0b\u7684\u591a\u7ebf\u7a0b\u6b7b\u5faa\u73af\u95ee\u9898 jdk7\u7684\u7684\u6570\u636e\u7ed3\u6784\u662f\uff1a\u6570\u7ec4+\u94fe\u8868 \u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f\u5934\u63d2\u6cd5\uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u53d8\u91cfe\u6307\u5411\u7684\u662f\u9700\u8981\u8fc1\u79fb\u7684\u5bf9\u8c61 \u53d8\u91cfnext\u6307\u5411\u7684\u662f\u4e0b\u4e00\u4e2a\u9700\u8981\u8fc1\u79fb\u7684\u5bf9\u8c61 Jdk1.7\u4e2d\u7684\u94fe\u8868\u91c7\u7528\u7684\u5934\u63d2\u6cd5 \u5728\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\u5e76\u6ca1\u6709\u65b0\u7684\u5bf9\u8c61\u4ea7\u751f\uff0c\u53ea\u662f\u6539\u53d8\u4e86\u5bf9\u8c61\u7684\u5f15\u7528 \u4ea7\u751f\u6b7b\u5faa\u73af\u7684\u8fc7\u7a0b\uff1a \u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u7684\u53d8\u91cfe\u548cnext\u90fd\u5f15\u7528\u4e86\u8fd9\u4e2a\u4e24\u4e2a\u8282\u70b9 \u7ebf\u7a0b2\u6269\u5bb9\u540e\uff0c\u7531\u4e8e\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u987a\u5e8f\u98a0\u5012\uff0c\u4f46\u662f\u7ebf\u7a0b1\u7684\u4e34\u65f6\u53d8\u91cfe\u548cnext\u8fd8\u5f15\u7528\u4e86\u8fd9\u4e24\u4e2a\u8282\u70b9 \u7b2c\u4e00\u6b21\u5faa\u73af \u7531\u4e8e\u7ebf\u7a0b2\u8fc1\u79fb\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u628aB\u7684next\u6267\u884c\u4e86A \u7b2c\u4e8c\u6b21\u5faa\u73af \u7b2c\u4e09\u6b21\u5faa\u73af \u53c2\u8003\u56de\u7b54\uff1a \u5728jdk1.7\u7684hashmap\u4e2d\u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f\u5934\u63d2\u6cd5\uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u6bd4\u5982\u8bf4\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\u7ebf\u7a0b \u7ebf\u7a0b\u4e00\uff1a\u8bfb\u53d6\u5230\u5f53\u524d\u7684hashmap\u6570\u636e\uff0c\u6570\u636e\u4e2d\u4e00\u4e2a\u94fe\u8868\uff0c\u5728\u51c6\u5907\u6269\u5bb9\u65f6\uff0c\u7ebf\u7a0b\u4e8c\u4ecb\u5165 \u7ebf\u7a0b\u4e8c\uff1a\u4e5f\u8bfb\u53d6hashmap\uff0c\u76f4\u63a5\u8fdb\u884c\u6269\u5bb9\u3002\u56e0\u4e3a\u662f\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u7684\u987a\u5e8f\u4f1a\u8fdb\u884c\u98a0\u5012\u8fc7\u6765\u3002\u6bd4\u5982\u539f\u6765\u7684\u987a\u5e8f\u662fAB\uff0c\u6269\u5bb9\u540e\u7684\u987a\u5e8f\u662fBA\uff0c\u7ebf\u7a0b\u4e8c\u6267\u884c\u7ed3\u675f\u3002 \u7ebf\u7a0b\u4e00\uff1a\u7ee7\u7eed\u6267\u884c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u7ebf\u7a0b\u4e00\u5148\u5c06A\u79fb\u5165\u65b0\u7684\u94fe\u8868\uff0c\u518d\u5c06B\u63d2\u5165\u5230\u94fe\u5934\uff0c\u7531\u4e8e\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u7684\u539f\u56e0\uff0cB\u7684next\u6307\u5411\u4e86A\uff0c \u6240\u4ee5B->A->B,\u5f62\u6210\u5faa\u73af\u3002 \u5f53\u7136\uff0cJDK 8 \u5c06\u6269\u5bb9\u7b97\u6cd5\u505a\u4e86\u8c03\u6574\uff0c\u4e0d\u518d\u5c06\u5143\u7d20\u52a0\u5165\u94fe\u8868\u5934\uff08\u800c\u662f\u4fdd\u6301\u4e0e\u6269\u5bb9\u524d\u4e00\u6837\u7684\u987a\u5e8f\uff09\uff0c \u5c3e\u63d2\u6cd5 \uff0c\u5c31\u907f\u514d\u4e86jdk7\u4e2d\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 3.8 \u9762\u8bd5\u9898-HashSet\u4e0eHashMap\u7684\u533a\u522b (1)HashSet\u5b9e\u73b0\u4e86Set\u63a5\u53e3, \u4ec5\u5b58\u50a8\u5bf9\u8c61; HashMap\u5b9e\u73b0\u4e86 Map\u63a5\u53e3, \u5b58\u50a8\u7684\u662f\u952e\u503c\u5bf9. (2)HashSet\u5e95\u5c42\u5176\u5b9e\u662f\u7528HashMap\u5b9e\u73b0\u5b58\u50a8\u7684, HashSet\u5c01\u88c5\u4e86\u4e00\u7cfb\u5217HashMap\u7684\u65b9\u6cd5. \u4f9d\u9760HashMap\u6765\u5b58\u50a8\u5143\u7d20\u503c,(\u5229\u7528hashMap\u7684key\u952e\u8fdb\u884c\u5b58\u50a8), \u800cvalue\u503c\u9ed8\u8ba4\u4e3aObject\u5bf9\u8c61. \u6240\u4ee5HashSet\u4e5f\u4e0d\u5141\u8bb8\u51fa\u73b0\u91cd\u590d\u503c, \u5224\u65ad\u6807\u51c6\u548cHashMap\u5224\u65ad\u6807\u51c6\u76f8\u540c, \u4e24\u4e2a\u5143\u7d20\u7684hashCode\u76f8\u7b49\u5e76\u4e14\u901a\u8fc7equals()\u65b9\u6cd5\u8fd4\u56detrue. 3.9 \u9762\u8bd5\u9898-HashTable\u4e0eHashMap\u7684\u533a\u522b \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u4e3b\u8981\u533a\u522b\uff1a \u533a\u522b HashTable HashMap \u6570\u636e\u7ed3\u6784 \u6570\u7ec4+\u94fe\u8868 \u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811 \u662f\u5426\u53ef\u4ee5\u4e3anull Key\u548cvalue\u90fd\u4e0d\u80fd\u4e3anull \u53ef\u4ee5\u4e3anull hash\u7b97\u6cd5 key\u7684hashCode() \u4e8c\u6b21hash \u6269\u5bb9\u65b9\u5f0f \u5f53\u524d\u5bb9\u91cf\u7ffb\u500d +1 \u5f53\u524d\u5bb9\u91cf\u7ffb\u500d \u7ebf\u7a0b\u5b89\u5168 \u540c\u6b65(synchronized)\u7684\uff0c\u7ebf\u7a0b\u5b89\u5168 \u975e\u7ebf\u7a0b\u5b89\u5168 \u5728\u5b9e\u9645\u5f00\u4e2d\u4e0d\u5efa\u8bae\u4f7f\u7528HashTable\uff0c\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u53ef\u4ee5\u4f7f\u7528ConcurrentHashMap\u7c7b 3 \u771f\u5b9e\u9762\u8bd5\u8fd8\u539f 3.1 Java\u5e38\u89c1\u7684\u96c6\u5408\u7c7b \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u8bf4Java\u63d0\u4f9b\u7684\u5e38\u89c1\u96c6\u5408\uff1f\uff08\u753b\u4e00\u4e0b\u96c6\u5408\u7ed3\u6784\u56fe\uff09 \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u597d\u7684\u3002 \u5728java\u4e2d\u63d0\u4f9b\u4e86\u91cf\u5927\u7c7b\u7684\u96c6\u5408\u6846\u67b6\uff0c\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff1a \u7b2c\u4e00\u4e2a\u662fCollection \u5c5e\u4e8e\u5355\u5217\u96c6\u5408\uff0c\u7b2c\u4e8c\u4e2a\u662fMap \u5c5e\u4e8e\u53cc\u5217\u96c6\u5408 \u5728Collection\u4e2d\u6709\u4e24\u4e2a\u5b50\u63a5\u53e3List\u548cSet\u3002\u5728\u6211\u4eec\u5e73\u5e38\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u7528\u7684\u6bd4\u8f83\u591a\u50cflist\u63a5\u53e3\u4e2d\u7684\u5b9e\u73b0\u7c7bArrarList\u548cLinkedList\u3002 \u5728Set\u63a5\u53e3\u4e2d\u6709\u5b9e\u73b0\u7c7bHashSet\u548cTreeSet\u3002 \u5728map\u63a5\u53e3\u4e2d\u6709\u5f88\u591a\u7684\u5b9e\u73b0\u7c7b\uff0c\u5e73\u65f6\u6bd4\u8f83\u5e38\u89c1\u7684\u662fHashMap\u3001TreeMap\uff0c\u8fd8\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684map:ConcurrentHashMap 3.2 List \u9762\u8bd5\u5b98 \uff1aArrayList\u5e95\u5c42\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u6211\u9605\u8bfb\u8fc7arraylist\u7684\u6e90\u7801\uff0c\u6211\u4e3b\u8981\u8bf4\u4e00\u4e0badd\u65b9\u6cd5\u5427 \u7b2c\u4e00\uff1a\u786e\u4fdd\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6\uff08size\uff09\u52a01\u4e4b\u540e\u8db3\u591f\u5b58\u4e0b\u4e0b\u4e00\u4e2a\u6570\u636e \u7b2c\u4e8c\uff1a\u8ba1\u7b97\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5982\u679c\u5f53\u524d\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6+1\u540e\u7684\u5927\u4e8e\u5f53\u524d\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8c03\u7528grow\u65b9\u6cd5\u6269\u5bb9\uff08\u539f\u6765\u76841.5\u500d\uff09 \u7b2c\u4e09\uff1a\u786e\u4fdd\u65b0\u589e\u7684\u6570\u636e\u6709\u5730\u65b9\u5b58\u50a8\u4e4b\u540e\uff0c\u5219\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u4f4d\u4e8esize\u7684\u4f4d\u7f6e\u4e0a\u3002 \u7b2c\u56db\uff1a\u8fd4\u56de\u6dfb\u52a0\u6210\u529f\u5e03\u5c14\u503c\u3002 \u9762\u8bd5\u5b98 \uff1aArrayList list=new ArrayList(10)\u4e2d\u7684list\u6269\u5bb9\u51e0\u6b21 \u5019\u9009\u4eba \uff1a \u200b \u662fnew\u4e86\u4e00\u4e2aArrarList\u5e76\u4e14\u7ed9\u4e86\u4e00\u4e2a\u6784\u9020\u53c2\u657010\uff0c\u5bf9\u5427\uff1f(\u95ee\u9898\u4e00\u5b9a\u8981\u95ee\u6e05\u695a\u518d\u7b54) \u9762\u8bd5\u5b98 \uff1a\u662f\u7684 \u5019\u9009\u4eba \uff1a \u200b \u597d\u7684\uff0c\u5728ArrayList\u7684\u6e90\u7801\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u53c2\u6570\u5c31\u662f\u6307\u5b9a\u7684\u96c6\u5408\u521d\u59cb\u957f\u5ea6\uff0c\u6240\u4ee5\u7ed9\u4e86\u4e00\u4e2a10\u7684\u53c2\u6570\uff0c\u5c31\u662f\u6307\u5b9a\u4e86\u96c6\u5408\u7684\u521d\u59cb\u957f\u5ea6\u662f10\uff0c\u8fd9\u91cc\u9762\u5e76\u6ca1\u6709\u6269\u5bb9\u3002 \u9762\u8bd5\u5b98 \uff1a\u5982\u4f55\u5b9e\u73b0\u6570\u7ec4\u548cList\u4e4b\u95f4\u7684\u8f6c\u6362 \u5019\u9009\u4eba \uff1a \u200b \u55ef\uff0c\u8fd9\u4e2a\u5728\u6211\u4eec\u5e73\u65f6\u5f00\u53d1\u5f88\u5e38\u89c1 \u200b \u6570\u7ec4\u8f6clist\uff0c\u53ef\u4ee5\u4f7f\u7528jdk\u81ea\u52a8\u7684\u4e00\u4e2a\u5de5\u5177\u7c7bArrars\uff0c\u91cc\u9762\u6709\u4e00\u4e2aasList\u65b9\u6cd5\u53ef\u4ee5\u8f6c\u6362\u4e3a\u6570\u7ec4 \u200b List \u8f6c\u6570\u7ec4\uff0c\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528list\u4e2d\u7684toArray\u65b9\u6cd5\uff0c\u9700\u8981\u7ed9\u4e00\u4e2a\u53c2\u6570\uff0c\u6307\u5b9a\u6570\u7ec4\u7684\u7c7b\u578b\uff0c\u9700\u8981\u6307\u5b9a\u6570\u7ec4\u7684\u957f\u5ea6\u3002 \u9762\u8bd5\u5b98 \uff1a\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417\uff1fList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 \u5019\u9009\u4eba \uff1a Arrays.asList\u8f6c\u6362list\u4e4b\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u7684\u5185\u5bb9\uff0clist\u4f1a\u53d7\u5f71\u54cd\uff0c\u56e0\u4e3a\u5b83\u7684\u5e95\u5c42\u4f7f\u7528\u7684Arrays\u7c7b\u4e2d\u7684\u4e00\u4e2a\u5185\u90e8\u7c7bArrayList\u6765\u6784\u9020\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u4e2a\u96c6\u5408\u7684\u6784\u9020\u5668\u4e2d\uff0c\u628a\u6211\u4eec\u4f20\u5165\u7684\u8fd9\u4e2a\u96c6\u5408\u8fdb\u884c\u4e86\u5305\u88c5\u800c\u5df2\uff0c\u6700\u7ec8\u6307\u5411\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u5185\u5b58\u5730\u5740 list\u7528\u4e86toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86list\u5185\u5bb9\uff0c\u6570\u7ec4\u4e0d\u4f1a\u5f71\u54cd\uff0c\u5f53\u8c03\u7528\u4e86toArray\u4ee5\u540e\uff0c\u5728\u5e95\u5c42\u662f\u5b83\u662f\u8fdb\u884c\u4e86\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u8ddf\u539f\u6765\u7684\u5143\u7d20\u5c31\u6ca1\u5565\u5173\u7cfb\u4e86\uff0c\u6240\u4ee5\u5373\u4f7flist\u4fee\u6539\u4e86\u4ee5\u540e\uff0c\u6570\u7ec4\u4e5f\u4e0d\u53d7\u5f71\u54cd \u9762\u8bd5\u5b98 \uff1aArrayList \u548c LinkedList \u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u5b83\u4eec\u4e24\u4e2a\u4e3b\u8981\u662f\u5e95\u5c42\u4f7f\u7528\u7684\u6570\u636e\u7ed3\u6784\u4e0d\u4e00\u6837\uff0cArrayList \u662f\u52a8\u6001\u6570\u7ec4\uff0cLinkedList \u662f\u53cc\u5411\u94fe\u8868\uff0c\u8fd9\u4e5f\u5bfc\u81f4\u4e86\u5b83\u4eec\u5f88\u591a\u4e0d\u540c\u7684\u7279\u70b9\u3002 1\uff0c\u4ece\u64cd\u4f5c\u6570\u636e\u6548\u7387\u6765\u8bf4 ArrayList\u6309\u7167\u4e0b\u6807\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6O(1)\u3010\u5185\u5b58\u662f\u8fde\u7eed\u7684\uff0c\u6839\u636e\u5bfb\u5740\u516c\u5f0f\u3011\uff0c LinkedList\u4e0d\u652f\u6301\u4e0b\u6807\u67e5\u8be2 \u67e5\u627e\uff08\u672a\u77e5\u7d22\u5f15\uff09\uff1a ArrayList\u9700\u8981\u904d\u5386\uff0c\u94fe\u8868\u4e5f\u9700\u8981\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(n) \u65b0\u589e\u548c\u5220\u9664 ArrayList\u5c3e\u90e8\u63d2\u5165\u548c\u5220\u9664\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff1b\u5176\u4ed6\u90e8\u5206\u589e\u5220\u9700\u8981\u632a\u52a8\u6570\u7ec4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) LinkedList\u5934\u5c3e\u8282\u70b9\u589e\u5220\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff0c\u5176\u4ed6\u90fd\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) 2\uff0c\u4ece\u5185\u5b58\u7a7a\u95f4\u5360\u7528\u6765\u8bf4 ArrayList\u5e95\u5c42\u662f\u6570\u7ec4\uff0c\u5185\u5b58\u8fde\u7eed\uff0c\u8282\u7701\u5185\u5b58 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u9700\u8981\u5b58\u50a8\u6570\u636e\uff0c\u548c\u4e24\u4e2a\u6307\u9488\uff0c\u66f4\u5360\u7528\u5185\u5b58 3\uff0c\u4ece\u7ebf\u7a0b\u5b89\u5168\u6765\u8bf4\uff0cArrayList\u548cLinkedList\u90fd\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86ArrayList \u548c LinkedList \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u4f60\u4eec\u5728\u9879\u76ee\u4e2d\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u4e3b\u8981\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6848\uff1a \u7b2c\u4e00\uff1a\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u96c6\u5408\uff0c\u4f18\u5148\u5728\u65b9\u6cd5\u5185\u4f7f\u7528\uff0c\u5b9a\u4e49\u4e3a\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u51fa\u73b0\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002 \u7b2c\u4e8c\uff1a\u5982\u679c\u975e\u8981\u5728\u6210\u5458\u53d8\u91cf\u4e2d\u4f7f\u7528\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408\u6765\u66ff\u4ee3 ArrayList\u53ef\u4ee5\u901a\u8fc7Collections \u7684 synchronizedList \u65b9\u6cd5\u5c06 ArrayList \u8f6c\u6362\u6210\u7ebf\u7a0b\u5b89\u5168\u7684\u5bb9\u5668\u540e\u518d\u4f7f\u7528\u3002 LinkedList \u6362\u6210ConcurrentLinkedQueue\u6765\u4f7f\u7528 3.4 HashMap \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0bHashMap\u7684\u5b9e\u73b0\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u200b \u55ef\u3002\u5b83\u4e3b\u8981\u5206\u4e3a\u4e86\u4e00\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a 1\uff0c\u5e95\u5c42\u4f7f\u7528hash\u8868\u6570\u636e\u7ed3\u6784\uff0c\u5373\u6570\u7ec4+\uff08\u94fe\u8868 | \u7ea2\u9ed1\u6811\uff09 2\uff0c\u6dfb\u52a0\u6570\u636e\u65f6\uff0c\u8ba1\u7b97key\u7684\u503c\u786e\u5b9a\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807 \u200b key\u76f8\u540c\u5219\u66ff\u6362 \u200b \u4e0d\u540c\u5219\u5b58\u5165\u94fe\u8868\u6216\u7ea2\u9ed1\u6811\u4e2d 3\uff0c\u83b7\u53d6\u6570\u636e\u901a\u8fc7key\u7684hash\u8ba1\u7b97\u6570\u7ec4\u4e0b\u6807\u83b7\u53d6\u5143\u7d20 \u9762\u8bd5\u5b98 \uff1aHashMap\u7684jdk1.7\u548cjdk1.8\u6709\u4ec0\u4e48\u533a\u522b \u5019\u9009\u4eba \uff1a JDK1.8\u4e4b\u524d\u91c7\u7528\u7684\u62c9\u94fe\u6cd5\uff0c\u6570\u7ec4+\u94fe\u8868 JDK1.8\u4e4b\u540e\u91c7\u7528\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811\uff0c\u94fe\u8868\u957f\u5ea6\u5927\u4e8e8\u4e14\u6570\u7ec4\u957f\u5ea6\u5927\u4e8e64\u5219\u4f1a\u4ece\u94fe\u8868\u8f6c\u5316\u4e3a\u7ea2\u9ed1\u6811 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u8bf4\u4e0bHashMap\u7684put\u65b9\u6cd5\u7684\u5177\u4f53\u6d41\u7a0b\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\u597d\u7684\u3002 \u5224\u65ad\u952e\u503c\u5bf9\u6570\u7ec4table\u662f\u5426\u4e3a\u7a7a\u6216\u4e3anull\uff0c\u5426\u5219\u6267\u884cresize()\u8fdb\u884c\u6269\u5bb9\uff08\u521d\u59cb\u5316\uff09 \u6839\u636e\u952e\u503ckey\u8ba1\u7b97hash\u503c\u5f97\u5230\u6570\u7ec4\u7d22\u5f15 \u5224\u65adtable[i]==null\uff0c\u6761\u4ef6\u6210\u7acb\uff0c\u76f4\u63a5\u65b0\u5efa\u8282\u70b9\u6dfb\u52a0 \u5982\u679ctable[i]==null ,\u4e0d\u6210\u7acb 4.1 \u5224\u65adtable[i]\u7684\u9996\u4e2a\u5143\u7d20\u662f\u5426\u548ckey\u4e00\u6837\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u8986\u76d6value 4.2 \u5224\u65adtable[i] \u662f\u5426\u4e3atreeNode\uff0c\u5373table[i] \u662f\u5426\u662f\u7ea2\u9ed1\u6811\uff0c\u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u76f4\u63a5\u5728\u6811\u4e2d\u63d2\u5165\u952e\u503c\u5bf9 4.3 \u904d\u5386table[i]\uff0c\u94fe\u8868\u7684\u5c3e\u90e8\u63d2\u5165\u6570\u636e\uff0c\u7136\u540e\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u5426\u5927\u4e8e8\uff0c\u5927\u4e8e8\u7684\u8bdd\u628a\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5728\u7ea2\u9ed1\u6811\u4e2d\u6267\u884c\u63d2\u5165\u64cd \u4f5c\uff0c\u904d\u5386\u8fc7\u7a0b\u4e2d\u82e5\u53d1\u73b0key\u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6value \u63d2\u5165\u6210\u529f\u540e\uff0c\u5224\u65ad\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cfsize\u662f\u5426\u8d85\u591a\u4e86\u6700\u5927\u5bb9\u91cfthreshold\uff08\u6570\u7ec4\u957f\u5ea6*0.75\uff09\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u8fdb\u884c\u6269\u5bb9\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u591a\u6b21\u4ecb\u7ecd\u4e86hsahmap\u7684\u6269\u5bb9\uff0c\u80fd\u8bb2\u4e00\u8bb2HashMap\u7684\u6269\u5bb9\u673a\u5236\u5417\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684 \u5728\u6dfb\u52a0\u5143\u7d20\u6216\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981\u8c03\u7528resize\u65b9\u6cd5\u8fdb\u884c\u6269\u5bb9\uff0c\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u521d\u59cb\u5316\u6570\u7ec4\u957f\u5ea6\u4e3a16\uff0c\u4ee5\u540e\u6bcf\u6b21\u6bcf\u6b21\u6269\u5bb9\u90fd\u662f\u8fbe\u5230\u4e86\u6269\u5bb9\u9608\u503c\uff08\u6570\u7ec4\u957f\u5ea6 * 0.75\uff09 \u6bcf\u6b21\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u90fd\u662f\u6269\u5bb9\u4e4b\u524d\u5bb9\u91cf\u76842\u500d\uff1b \u6269\u5bb9\u4e4b\u540e\uff0c\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u9700\u8981\u628a\u8001\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u632a\u52a8\u5230\u65b0\u7684\u6570\u7ec4\u4e2d \u6ca1\u6709hash\u51b2\u7a81\u7684\u8282\u70b9\uff0c\u5219\u76f4\u63a5\u4f7f\u7528 e.hash & (newCap - 1) \u8ba1\u7b97\u65b0\u6570\u7ec4\u7684\u7d22\u5f15\u4f4d\u7f6e \u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u8d70\u7ea2\u9ed1\u6811\u7684\u6dfb\u52a0 \u5982\u679c\u662f\u94fe\u8868\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u53ef\u80fd\u9700\u8981\u62c6\u5206\u94fe\u8868\uff0c\u5224\u65ad(e.hash & oldCap)\u662f\u5426\u4e3a0\uff0c\u8be5\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u505c\u7559\u5728\u539f\u59cb\u4f4d\u7f6e\uff0c\u8981\u4e48\u79fb\u52a8\u5230\u539f\u59cb\u4f4d\u7f6e+\u589e\u52a0\u7684\u6570\u7ec4\u5927\u5c0f\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684\u901a\u8fc7hash\u8ba1\u7b97\u540e\u627e\u5230\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u662f\u5982\u4f55\u627e\u5230\u7684\u5462\uff0c\u4f60\u4e86\u89e3hashMap\u7684\u5bfb\u5740\u7b97\u6cd5\u5417\uff1f \u5019\u9009\u4eba \uff1a \u8fd9\u4e2a\u54c8\u5e0c\u65b9\u6cd5\u9996\u5148\u8ba1\u7b97\u51fakey\u7684hashCode\u503c\uff0c\u7136\u540e\u901a\u8fc7\u8fd9\u4e2ahash\u503c\u53f3\u79fb16\u4f4d\u540e\u7684\u4e8c\u8fdb\u5236\u8fdb\u884c\u6309\u4f4d \u5f02\u6216\u8fd0\u7b97 \u5f97\u5230\u6700\u540e\u7684hash\u503c\u3002 \u5728putValue\u7684\u65b9\u6cd5\u4e2d\uff0c\u8ba1\u7b97\u6570\u7ec4\u4e0b\u6807\u7684\u65f6\u5019\u4f7f\u7528hash\u503c\u4e0e\u6570\u7ec4\u957f\u5ea6\u53d6\u6a21\u5f97\u5230\u5b58\u50a8\u6570\u636e\u4e0b\u6807\u7684\u4f4d\u7f6e\uff0chashmap\u4e3a\u4e86\u6027\u80fd\u66f4\u597d\uff0c\u5e76\u6ca1\u6709\u76f4\u63a5\u91c7\u7528\u53d6\u6a21\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u6570\u7ec4\u957f\u5ea6-1 \u5f97\u5230\u4e00\u4e2a\u503c\uff0c\u7528\u8fd9\u4e2a\u503c\u6309\u4f4d\u4e0e\u8fd0\u7b97hash\u503c\uff0c\u6700\u7ec8\u5f97\u5230\u6570\u7ec4\u7684\u4f4d\u7f6e\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4f55HashMap\u7684\u6570\u7ec4\u957f\u5ea6\u4e00\u5b9a\u662f2\u7684\u6b21\u5e42\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\u3002hashmap\u8fd9\u4e48\u8bbe\u8ba1\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u7b2c\u4e00\uff1a \u8ba1\u7b97\u7d22\u5f15\u65f6\u6548\u7387\u66f4\u9ad8\uff1a\u5982\u679c\u662f 2 \u7684 n \u6b21\u5e42\u53ef\u4ee5\u4f7f\u7528\u4f4d\u4e0e\u8fd0\u7b97\u4ee3\u66ff\u53d6\u6a21 \u7b2c\u4e8c\uff1a \u6269\u5bb9\u65f6\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\u6548\u7387\u66f4\u9ad8\uff1a\u5728\u8fdb\u884c\u6269\u5bb9\u662f\u4f1a\u8fdb\u884c\u5224\u65ad hash\u503c\u6309\u4f4d\u4e0e\u8fd0\u7b97\u65e7\u6570\u7ec4\u957f\u79df\u662f\u5426 == 0 \u5982\u679c\u7b49\u4e8e0\uff0c\u5219\u628a\u5143\u7d20\u7559\u5728\u539f\u6765\u4f4d\u7f6e \uff0c\u5426\u5219\u65b0\u4f4d\u7f6e\u662f\u7b49\u4e8e\u65e7\u4f4d\u7f6e\u7684\u4e0b\u6807+\u65e7\u6570\u7ec4\u957f\u5ea6 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u6211\u770b\u4f60\u5bf9hashmap\u4e86\u89e3\u7684\u633a\u6df1\u5165\u7684\uff0c\u4f60\u77e5\u9053hashmap\u57281.7\u60c5\u51b5\u4e0b\u7684\u591a\u7ebf\u7a0b\u6b7b\u5faa\u73af\u95ee\u9898\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u7684\u3002\u662f\u8fd9\u6837 jdk7\u7684\u7684\u6570\u636e\u7ed3\u6784\u662f\uff1a\u6570\u7ec4+\u94fe\u8868 \u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f \u5934\u63d2\u6cd5 \uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u6bd4\u5982\u8bf4\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\u7ebf\u7a0b \u7ebf\u7a0b\u4e00\uff1a \u8bfb\u53d6 \u5230\u5f53\u524d\u7684hashmap\u6570\u636e\uff0c\u6570\u636e\u4e2d\u4e00\u4e2a\u94fe\u8868\uff0c\u5728\u51c6\u5907\u6269\u5bb9\u65f6\uff0c\u7ebf\u7a0b\u4e8c\u4ecb\u5165 \u7ebf\u7a0b\u4e8c\u4e5f\u8bfb\u53d6hashmap\uff0c\u76f4\u63a5\u8fdb\u884c\u6269\u5bb9\u3002\u56e0\u4e3a\u662f\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u7684\u987a\u5e8f\u4f1a\u8fdb\u884c\u98a0\u5012\u8fc7\u6765\u3002\u6bd4\u5982\u539f\u6765\u7684\u987a\u5e8f\u662fAB\uff0c\u6269\u5bb9\u540e\u7684\u987a\u5e8f\u662fBA\uff0c\u7ebf\u7a0b\u4e8c\u6267\u884c\u7ed3\u675f\u3002 \u5f53\u7ebf\u7a0b\u4e00\u518d\u7ee7\u7eed\u6267\u884c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u7ebf\u7a0b\u4e00\u5148\u5c06A\u79fb\u5165\u65b0\u7684\u94fe\u8868\uff0c\u518d\u5c06B\u63d2\u5165\u5230\u94fe\u5934\uff0c\u7531\u4e8e\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u7684\u539f\u56e0\uff0cB\u7684next\u6307\u5411\u4e86A\uff0c\u6240\u4ee5B->A->B,\u5f62\u6210\u5faa\u73af\u3002 \u5f53\u7136\uff0cJDK 8 \u5c06\u6269\u5bb9\u7b97\u6cd5\u505a\u4e86\u8c03\u6574\uff0c\u4e0d\u518d\u5c06\u5143\u7d20\u52a0\u5165\u94fe\u8868\u5934\uff08\u800c\u662f\u4fdd\u6301\u4e0e\u6269\u5bb9\u524d\u4e00\u6837\u7684\u987a\u5e8f\uff09\uff0c \u5c3e\u63d2\u6cd5 \uff0c\u5c31\u907f\u514d\u4e86jdk7\u4e2d\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0chashmap\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f \u5019\u9009\u4eba \uff1a\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u9762\u8bd5\u5b98 \uff1a\u90a3\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684map\u8be5\u600e\u4e48\u505a\u5462\uff1f \u5019\u9009\u4eba \uff1a\u6211\u4eec\u53ef\u4ee5\u91c7\u7528ConcurrentHashMap\u8fdb\u884c\u4f7f\u7528\uff0c\u5b83\u662f\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684HashMap \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u80fd\u804a\u4e00\u4e0bConcurrentHashMap\u7684\u539f\u7406\u5417\uff1f \u5019\u9009\u4eba \uff1a\u597d\u7684\uff0c\u8bf7\u53c2\u8003\u300a\u591a\u7ebf\u7a0b\u76f8\u5173\u9762\u8bd5\u9898\u300b\u4e2d\u7684ConcurrentHashMap\u90e8\u5206\u7684\u8bb2\u89e3 \u9762\u8bd5\u5b98 \uff1aHashSet\u4e0eHashMap\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u8fd9\u6837\u3002 HashSet\u5e95\u5c42\u5176\u5b9e\u662f\u7528HashMap\u5b9e\u73b0\u5b58\u50a8\u7684, HashSet\u5c01\u88c5\u4e86\u4e00\u7cfb\u5217HashMap\u7684\u65b9\u6cd5. \u4f9d\u9760HashMap\u6765\u5b58\u50a8\u5143\u7d20\u503c,(\u5229\u7528hashMap\u7684key\u952e\u8fdb\u884c\u5b58\u50a8), \u800cvalue\u503c\u9ed8\u8ba4\u4e3aObject\u5bf9\u8c61. \u6240\u4ee5HashSet\u4e5f\u4e0d\u5141\u8bb8\u51fa\u73b0\u91cd\u590d\u503c, \u5224\u65ad\u6807\u51c6\u548cHashMap\u5224\u65ad\u6807\u51c6\u76f8\u540c, \u4e24\u4e2a\u5143\u7d20\u7684hashCode\u76f8\u7b49\u5e76\u4e14\u901a\u8fc7equals()\u65b9\u6cd5\u8fd4\u56detrue. \u9762\u8bd5\u5b98 \uff1aHashTable\u4e0eHashMap\u7684\u533a\u522b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4ed6\u4eec\u7684\u4e3b\u8981\u533a\u522b\u662f\u6709\u51e0\u4e2a\u5427 \u7b2c\u4e00\uff0c\u6570\u636e\u7ed3\u6784\u4e0d\u4e00\u6837\uff0chashtable\u662f\u6570\u7ec4+\u94fe\u8868\uff0chashmap\u57281.8\u4e4b\u540e\u6539\u4e3a\u4e86\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811 \u7b2c\u4e8c\uff0chashtable\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u90fd\u4e0d\u80fd\u4e3anull\uff0c\u800chashmap\u662f\u53ef\u4ee5\u7684 \u7b2c\u4e09\uff0chash\u7b97\u6cd5\u4e0d\u540c\uff0chashtable\u662f\u7528\u672c\u5730\u4fee\u9970\u7684hashcode\u503c\uff0c\u800chashmap\u7ecf\u5e38\u4e86\u4e8c\u6b21hash \u7b2c\u56db\uff0c\u6269\u5bb9\u65b9\u5f0f\u4e0d\u540c\uff0chashtable\u662f\u5f53\u524d\u5bb9\u91cf\u7ffb\u500d+1\uff0chashmap\u662f\u5f53\u524d\u5bb9\u91cf\u7ffb\u500d \u7b2c\u4e94\uff0chashtable\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u64cd\u4f5c\u6570\u636e\u7684\u65f6\u5019\u52a0\u4e86\u9501synchronized\uff0chashmap\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6548\u7387\u66f4\u9ad8\u4e00\u4e9b \u5728\u5b9e\u9645\u5f00\u4e2d\u4e0d\u5efa\u8bae\u4f7f\u7528HashTable\uff0c\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u53ef\u4ee5\u4f7f\u7528ConcurrentHashMap\u7c7b","title":"Java\u96c6\u5408\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#java","text":"","title":"Java\u96c6\u5408\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#_1","text":"\u8fd9\u6b21\u8bfe\u7a0b\u4e3b\u8981\u6d89\u53ca\u5230\u7684\u662fList\u548cMap\u76f8\u5173\u7684\u9762\u8bd5\u9898\uff0c\u6bd4\u8f83\u9ad8\u9891\u5c31\u662f ArrayList LinkedList HashMap ConcurrentHashMap ArrayList\u5e95\u5c42\u5b9e\u73b0\u662f\u6570\u7ec4 LinkedList\u5e95\u5c42\u5b9e\u73b0\u662f\u53cc\u5411\u94fe\u8868 HashMap\u7684\u5e95\u5c42\u5b9e\u73b0\u4f7f\u7528\u4e86\u4f17\u591a\u6570\u636e\u7ed3\u6784\uff0c\u5305\u542b\u4e86\u6570\u7ec4\u3001\u94fe\u8868\u3001\u6563\u5217\u8868\u3001\u7ea2\u9ed1\u6811\u7b49 \u5728\u8bb2\u89e3\u8fd9\u4e9b\u96c6\u5408\u4e4b\u540e\uff0c\u6211\u4eec\u4f1a\u8bb2\u89e3\u6570\u636e\u7ed3\u6784\uff0c\u77e5\u9053\u4e86\u6570\u636e\u7ed3\u6784\u7684\u7279\u70b9\u4e4b\u540e\uff0c\u719f\u6089\u96c6\u5408\u5c31\u66f4\u52a0\u7b80\u5355\u4e86\u3002\u5728\u8bb2\u89e3\u6570\u636e\u7ed3\u6784\u4e4b\u524d\uff0c\u6211\u4eec\u4e5f\u4f1a\u7b80\u5355\u666e\u53ca\u4e00\u4e0b\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u8ba9\u5927\u5bb6\u80fd\u591f\u8bc4\u5224\u4ee3\u7801\u7684\u597d\u574f\uff0c\u4e5f\u80fd\u66f4\u52a0\u6df1\u5165\u53bb\u7406\u89e3\u6570\u636e\u7ed3\u6784\u548c\u96c6\u5408\u3002","title":"\u5bfc\u5b66"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#1","text":"","title":"1 \u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#11","text":"\u6211\u4eec\u5148\u6765\u770b\u4e0b\u9762\u8fd9\u4e2a\u4ee3\u7801\uff0c\u4f60\u80fd\u8bc4\u5224\u8fd9\u4e2a\u4ee3\u7801\u7684\u597d\u574f\u5417\uff1f /** ** *\u6c42**1~n**\u7684\u7d2f\u52a0\u548c ** @param* *n ** @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u5176\u5b9e\u5b66\u4e60\u7b97\u6cd5\u590d\u6742\u5ea6\u7684\u597d\u5904\u5c31\u662f\uff1a \u6307\u5bfc\u4f60\u7f16\u5199\u51fa\u6027\u80fd\u66f4\u4f18\u7684\u4ee3\u7801 \u8bc4\u5224\u522b\u4eba\u5199\u7684\u4ee3\u7801\u7684\u597d\u574f \u76f8\u4fe1\u4f60\u5b66\u5b8c\u4e86\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u5c31\u6709\u80fd\u529b\u8bc4\u5224\u4e0a\u9762\u4ee3\u7801\u7684\u597d\u574f\u4e86 \u5173\u4e8e\u7b97\u6cd5\u590d\u6742\u5ea6\u5206\u6790\uff0c\u5305\u542b\u4e86\u4e24\u4e2a\u5185\u5bb9\uff0c\u4e00\u4e2a\u662f\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4e00\u4e2a\u662f\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u8bf4\u590d\u6742\u5ea6\uff0c\u90fd\u662f\u6307\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u4e5f\u4f1a\u91cd\u70b9\u8bb2\u89e3\u65f6\u95f4\u590d\u6742\u5ea6","title":"1.1 \u4e3a\u4ec0\u4e48\u8981\u8fdb\u884c\u590d\u6742\u5ea6\u5206\u6790\uff1f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#12","text":"","title":"1.2 \u65f6\u95f4\u590d\u6742\u5ea6"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#121","text":"\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\uff1a\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u8bc4\u4f30\u4ee3\u7801\u7684\u6267\u884c\u8017\u65f6\u7684\uff0c\u5927\u5bb6\u8fd8\u662f\u770b\u521a\u624d\u7684\u4ee3\u7801\uff1a /** ** *\u6c42**1~n**\u7684\u7d2f\u52a0\u548c ** @param* *n ** @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u5206\u6790\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5206\u6790\u8fc7\u7a0b\u5982\u4e0b\uff1a 1.\u5047\u5982\u6bcf\u884c\u4ee3\u7801\u7684\u6267\u884c\u8017\u65f6\u4e00\u6837\uff1a1ms 2.\u5206\u6790\u8fd9\u6bb5\u4ee3\u7801\u603b\u6267\u884c\u591a\u5c11\u884c\uff1f3n+3 3.\u4ee3\u7801\u8017\u65f6\u603b\u65f6\u95f4\uff1a T(n) = (3n + 3) * 1ms T(n):\u5c31\u662f\u4ee3\u7801\u603b\u8017\u65f6 \u6211\u4eec\u73b0\u5728\u6709\u4e86\u603b\u8017\u65f6\uff0c\u9700\u8981\u501f\u52a9\u5927O\u8868\u793a\u6cd5\u6765\u8ba1\u7b97\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6","title":"1.2.1 \u6848\u4f8b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#122-o","text":"\u5927O\u8868\u793a\u6cd5 \uff1a\u4e0d\u5177\u4f53\u8868\u793a\u4ee3\u7801\u771f\u6b63\u7684\u6267\u884c\u65f6\u95f4\uff0c\u800c\u662f\u8868\u793a \u4ee3\u7801\u6267\u884c\u65f6\u95f4\u968f\u6570\u636e\u89c4\u6a21\u589e\u957f\u7684\u53d8\u5316\u8d8b\u52bf \u3002 \u521a\u624d\u7684\u4ee3\u7801\u793a\u4f8b\u603b\u8017\u65f6\u516c\u5f0f\u4e3a\uff1aT(n) = (3n + 3) * 1ms \u5176\u4e2d (3n + 3) \u662f\u4ee3\u7801\u7684\u603b\u884c\u6570\uff0c\u6bcf\u884c\u6267\u884c\u7684\u65f6\u95f4\u90fd\u4e00\u6837\uff0c\u6240\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff1a T(n)\u4e0e\u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u6210\u6b63\u6bd4(\u4ee3\u7801\u884c\u6570\u8d8a\u591a\uff0c\u6267\u884c\u65f6\u95f4\u8d8a\u957f) \u4e0d\u8fc7\uff0c\u5927O\u8868\u793a\u6cd5\u53ea\u9700\u8981\u4ee3\u7801\u6267\u884c\u65f6\u95f4\u4e0e\u6570\u636e\u89c4\u6a21\u7684\u589e\u957f\u8d8b\u52bf\uff0c\u516c\u5f0f\u53ef\u4ee5\u7b80\u5316\u5982\u4e0b\uff1a T(n) =O(3n + 3)------------> T(n) = O(n) \u5f53n\u5f88\u5927\u65f6\uff0c\u516c\u5f0f\u4e2d\u7684\u4f4e\u9636\uff0c\u5e38\u91cf\uff0c\u7cfb\u6570\u4e09\u90e8\u5206\u5e76\u4e0d\u5de6\u53f3\u5176\u589e\u957f\u8d8b\u52bf\uff0c\u56e0\u6b64\u53ef\u4ee5\u5ffd\u7565\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u6700\u5927\u7684\u91cf\u7ea7\u5c31\u53ef\u4ee5\u4e86 \u4e0b\u56fe\u4e5f\u80fd\u8868\u660e\u6570\u636e\u7684\u8d8b\u52bf","title":"1.2.2 \u5927O\u8868\u793a\u6cd5"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#123","text":"\u901f\u8bb0\u53e3\u8bc0\uff1a \u5e38\u5bf9\u5e42\u6307\u9636 \u8d8a\u5728\u4e0a\u9762\u7684\u6027\u80fd\u5c31\u8d8a\u9ad8\uff0c\u8d8a\u5f80\u4e0b\u6027\u80fd\u5c31\u8d8a\u4f4e \u4e0b\u56fe\u662f\u4e00\u4e9b\u6bd4\u8f83\u5e38\u89c1\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u65f6\u95f4\u4e0e\u6570\u636e\u89c4\u6a21\u7684\u8d8b\u52bf\uff1a","title":"1.2.3 \u5e38\u89c1\u590d\u6742\u5ea6\u8868\u793a\u5f62\u5f0f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#124-o1","text":"\u5b9e\u4f8b\u4ee3\u7801\uff1a public int test01(int n){ int i=0; int j = 1; return i+j; } \u4ee3\u7801\u53ea\u6709\u4e09\u884c\uff0c\u5b83\u7684\u590d\u6742\u5ea6\u4e5f\u662fO(1)\uff0c\u800c\u4e0d\u662fO(3) \u518d\u770b\u5982\u4e0b\u4ee3\u7801\uff1a public void test02(int n){ int i=0; int sum=0; for(;i<100;i++){ sum = sum+i; } System.out.println(sum); } \u6574\u4e2a\u4ee3\u7801\u4e2d\u56e0\u4e3a\u5faa\u73af\u6b21\u6570\u662f\u56fa\u5b9a\u7684\u5c31\u662f100\u6b21\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u590d\u6742\u5ea6\u6211\u4eec\u8ba4\u4e3a\u4e5f\u662fO(1) \u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a \u53ea\u8981\u4ee3\u7801\u7684\u6267\u884c\u65f6\u95f4\u4e0d\u968f\u7740n\u7684\u589e\u5927\u800c\u589e\u5927\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u590d\u6742\u5ea6\u90fd\u662fO(1)","title":"1.2.4 \u65f6\u95f4\u590d\u6742\u5ea6O(1)"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#125-on","text":"\u5b9e\u4f8b\u4ee3\u78011\uff1a /** * \u6c421~n\u7684\u7d2f\u52a0\u548c * @param n * @return */ public int sum(int n) { int sum = 0; for ( int i = 1; i <= n; i++) { sum = sum + i; } return sum; } \u4e00\u5c42for\u5faa\u5e8f\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(n) \u5b9e\u4f8b\u4ee3\u78012\uff1a public static int sum2(int n){ int sum = 0; for (int i = 1; i < n; ++i) { for (int j = 1; j < n; ++j) { sum = sum + i * j; } } return sum; } \u8fd9\u4e2a\u4ee3\u7801\u7684\u6267\u884c\u884c\u6570\u4e3a\uff1aO( 3n^2 + 3n + 3 )\uff0c\u4e0d\u8fc7\uff0c\u4f9d\u636e\u5927O\u8868\u793a\u7684\u89c4\u5219\uff1a \u5e38\u91cf\u3001\u7cfb\u6570\u3001\u4f4e\u9636\uff0c\u53ef\u4ee5\u5ffd\u7565 \u6240\u4ee5\u8fd9\u4e2a\u4ee3\u7801\u6700\u7ec8\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1aO(n^2)","title":"1.2.5 \u65f6\u95f4\u590d\u6742\u5ea6O(n)"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#126-ologn","text":"\u5bf9\u6570\u590d\u6742\u5ea6\u975e\u5e38\u7684\u5e38\u89c1\uff0c\u4f46\u76f8\u5bf9\u6bd4\u8f83\u96be\u4ee5\u5206\u6790\uff0c\u5b9e\u4f8b\u4ee3\u7801\uff1a public void test04(int n){ int i=1; while(i<=n){ i = i * 2; } } \u5206\u6790\u8fd9\u4e2a\u4ee3\u7801\u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u518d\u5f3a\u8c03\u4e00\u4e2a\u524d\u63d0\uff1a \u590d\u6742\u5ea6\u5206\u6790\u5c31\u662f\u8981\u5f04\u6e05\u695a\u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u548c\u6570\u636e\u89c4\u6a21n\u4e4b\u95f4\u7684\u5173\u7cfb \u4ee5\u4e0a\u4ee3\u7801\u6700\u5173\u952e\u7684\u4e00\u884c\u662f\uff1a i = i * 2 \uff0c\u8fd9\u884c\u4ee3\u7801\u53ef\u4ee5\u51b3\u5b9a\u8fd9\u4e2awhile\u5faa\u73af\u6267\u884c\u4ee3\u7801\u7684\u884c\u6570\uff0c i \u7684\u503c\u662f\u53ef\u4ee5\u65e0\u9650\u63a5\u8fd1 n \u7684\u503c\u7684\u3002\u5982\u679c i \u4e00\u65e6\u5927\u4e8e\u7b49\u4e8e\u4e86 n \u5219\u5faa\u73af\u6761\u4ef6\u5c31\u4e0d\u6ee1\u8db3\u4e86\u3002\u4e5f\u5c31\u8bf4\u8fbe\u5230\u4e86\u6700\u5927\u7684\u884c\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5206\u6790\u4e00\u4e0b i \u8fd9\u4e2a\u503c\u53d8\u5316\u7684\u8fc7\u7a0b \u5206\u6790\u8fc7\u7a0b\u5982\u4e0b\uff1a \u7531\u6b64\u53ef\u77e5\uff0c\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8868\u793a\u4e3aO(log n)","title":"1.2.6 \u65f6\u95f4\u590d\u6742\u5ea6O(logn)"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#127-on-log-n","text":"\u5206\u6790\u5b8cO( log n )\uff0c\u90a3O( n * log n )\u5c31\u5f88\u5bb9\u6613\u7406\u89e3\u4e86\uff0c\u6bd4\u5982\u4e0b\u5217\u4ee3\u7801\uff1a public void test05(int n){ int i=0; for(;i<=n;i++){ test04(n); } } public void test04(int n){ int i=1; while(i<=n){ i = i * 2; } }","title":"1.2.7 \u65f6\u95f4\u590d\u6742\u5ea6O(n * log n)"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#13","text":"\u7a7a\u95f4\u590d\u6742\u5ea6\u5168\u79f0\u662f\u6e10\u8fdb\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u8868\u793a\u7b97\u6cd5\u5360\u7528\u7684\u989d\u5916 \u5b58\u50a8\u7a7a\u95f4 \u4e0e \u6570\u636e\u89c4\u6a21 \u4e4b\u95f4\u7684\u589e\u957f\u5173\u7cfb \u770b\u4e0b\u9762\u4ee3\u7801 public void test(int n){ int i=0; int sum=0; for(;i<n;i++){ sum = sum+i; } System.out.println(sum); } \u4ee3\u7801\u6267\u884c\u5e76\u4e0d\u9700\u8981\u5360\u7528\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u53ea\u9700\u8981\u5e38\u91cf\u7ea7\u7684\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\uff0c\u56e0\u6b64\u7a7a\u95f4\u590d\u6742\u5ea6\u662fO(1) \u518d\u6765\u770b\u4e00\u4e2a\u5176\u4ed6\u4f8b\u5b50\uff1a void print(int n) { int i = 0; int[] a = new int[n]; for (i; i <n; ++i) { a[i] = i * i; } for (i = n-1; i >= 0; --i) { System.out.println(a[i]); } } \u4f20\u5165\u4e00\u4e2a\u53d8\u91cfn\uff0c\u51b3\u5b9a\u7533\u8bf7\u591a\u5c11\u7684int\u6570\u7ec4\u7a7a\u95f4\u5185\u5b58\uff0c\u6b64\u6bb5\u4ee3\u7801\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3aO(n) \u6211\u4eec\u5e38\u89c1\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(1),O(n),O(n ^2)\uff0c\u5176\u4ed6\u50cf\u5bf9\u6570\u9636\u7684\u590d\u6742\u5ea6\u51e0\u4e4e\u7528\u4e0d\u5230\uff0c\u56e0\u6b64\u7a7a\u95f4\u590d\u6742\u5ea6\u6bd4\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u8981\u7b80\u5355\u7684\u591a\u3002","title":"1.3 \u7a7a\u95f4\u590d\u6742\u5ea6"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#2-list","text":"","title":"2 List\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#21","text":"","title":"2.1 \u6570\u7ec4"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#211","text":"\u6570\u7ec4\uff08Array\uff09\u662f\u4e00\u79cd\u7528 \u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4 \u5b58\u50a8 \u76f8\u540c\u6570\u636e\u7c7b\u578b \u6570\u636e\u7684\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u3002 int[] array = {22,33,88,66,55,25}; \u6211\u4eec\u5b9a\u4e49\u4e86\u8fd9\u4e48\u4e00\u4e2a\u6570\u7ec4\u4e4b\u540e\uff0c\u5728\u5185\u5b58\u7684\u8868\u793a\u662f\u8fd9\u6837\u7684\uff1a \u73b0\u5728\u5047\u5982\uff0c\u6211\u4eec\u901a\u8fc7 arrar[1] \uff0c\u60f3\u8981\u83b7\u5f97\u4e0b\u6807\u4e3a1\u8fd9\u4e2a\u5143\u7d20\uff0c\u4f46\u662f\u73b0\u5728\u6808\u5185\u5b58\u4e2d\u6307\u5411\u7684\u5806\u5185\u5b58\u6570\u7ec4\u7684\u9996\u5730\u5740\uff0c\u5b83\u662f\u5982\u4f55\u83b7\u53d6\u4e0b\u6807\u4e3a1\u8fd9\u4e2a\u6570\u636e\u7684\uff1f","title":"2.1.1 \u6570\u7ec4\u6982\u8ff0"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#212","text":"\u4e3a\u4e86\u65b9\u4fbf\u5927\u5bb6\u7406\u89e3\uff0c\u6211\u4eec\u628a\u6570\u7ec4\u7684\u5185\u5b58\u5730\u5740\u7a0d\u5fae\u6539\u4e86\u4e00\u4e0b\uff0c\u90fd\u6539\u6210\u4e86\u6570\u5b57\uff0c\u5982\u4e0b\u56fe \u5728\u6570\u7ec4\u5728\u5185\u5b58\u4e2d\u67e5\u627e\u5143\u7d20\u7684\u65f6\u5019\uff0c\u662f\u6709\u4e00\u4e2a\u5bfb\u5740\u516c\u5f0f\u7684\uff0c\u5982\u4e0b\uff1a arr[i] = baseAddress + i * dataTypeSize baseAddress\uff1a\u6570\u7ec4\u7684\u9996\u5730\u5740\uff0c\u76ee\u524d\u662f10 dataTypeSize\uff1a\u4ee3\u8868\u6570\u7ec4\u4e2d\u5143\u7d20\u7c7b\u578b\u7684\u5927\u5c0f\uff0c\u76ee\u524d\u6570\u7ec4\u91cd\u5b58\u50a8\u7684\u662fint\u578b\u7684\u6570\u636e\uff0cdataTypeSize=4\u4e2a\u5b57\u8282 arr\uff1a\u6307\u7684\u662f\u6570\u7ec4 i\uff1a\u6307\u7684\u662f\u6570\u7ec4\u7684\u4e0b\u6807 \u6709\u4e86\u5bfb\u5740\u516c\u5f0f\u4ee5\u540e\uff0c\u6211\u4eec\u518d\u6765\u83b7\u53d6\u4e00\u4e0b\u4e0b\u6807\u4e3a1\u7684\u5143\u7d20\uff0c\u8fd9\u4e2a\u662f\u539f\u6765\u7684\u6570\u7ec4 int[] array = {22,33,88,66,55,25}; \u5957\u5165\u516c\u5f0f\uff1a array[1] =10 + i * 4 = 14 \u83b7\u53d6\u523014\u8fd9\u4e2a\u5730\u5740\uff0c\u5c31\u80fd\u83b7\u53d6\u5230\u4e0b\u6807\u4e3a1\u7684\u8fd9\u4e2a\u5143\u7d20\u4e86\u3002","title":"2.1.2 \u5bfb\u5740\u516c\u5f0f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#213","text":"1.\u968f\u673a\u67e5\u8be2(\u6839\u636e\u7d22\u5f15\u67e5\u8be2) \u6570\u7ec4\u5143\u7d20\u7684\u8bbf\u95ee\u662f\u901a\u8fc7\u4e0b\u6807\u6765\u8bbf\u95ee\u7684\uff0c\u8ba1\u7b97\u673a\u901a\u8fc7\u6570\u7ec4\u7684 \u9996\u5730\u5740 \u548c \u5bfb\u5740\u516c\u5f0f \u80fd\u591f\u5f88\u5feb\u901f\u7684\u627e\u5230\u60f3\u8981\u8bbf\u95ee\u7684\u5143\u7d20 public int test01(int[] a,int i){ return a[i]; // a[i] = baseAddress + i \\* dataSize } \u4ee3\u7801\u7684\u6267\u884c\u6b21\u6570\u5e76\u4e0d\u4f1a\u968f\u7740\u6570\u7ec4\u7684\u6570\u636e\u89c4\u6a21\u5927\u5c0f\u53d8\u5316\u800c\u53d8\u5316\uff0c\u662f\u5e38\u6570\u7ea7\u7684\uff0c\u6240\u4ee5\u67e5\u8be2\u6570\u636e\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) 2. \u672a\u77e5\u7d22\u5f15\u67e5\u8be2O(n)\u6216O(log2n) \u60c5\u51b5\u4e00\uff1a\u67e5\u627e\u6570\u7ec4\u5185\u7684\u5143\u7d20\uff0c\u67e5\u627e55\u53f7\u6570\u636e\uff0c\u904d\u5386\u6570\u7ec4\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(n) \u60c5\u51b5\u4e8c\uff1a\u67e5\u627e\u6392\u5e8f\u540e\u6570\u7ec4\u5185\u7684\u5143\u7d20\uff0c\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u7b97\u6cd5\u67e5\u627e55\u53f7\u6570\u636e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(logn) 3.\u63d2\u5165O(n) \u6570\u7ec4\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u56e0\u6b64\u4e3a\u4e86\u4fdd\u8bc1\u6570\u7ec4\u7684\u8fde\u7eed\u6027\u4f1a\u4f7f\u5f97\u6570\u7ec4\u7684\u63d2\u5165\u548c\u5220\u9664\u7684\u6548\u7387\u53d8\u7684\u5f88\u4f4e\u3002 \u5047\u8bbe\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a n\uff0c\u73b0\u5728\u5982\u679c\u6211\u4eec\u9700\u8981\u5c06\u4e00\u4e2a\u6570\u636e\u63d2\u5165\u5230\u6570\u7ec4\u4e2d\u7684\u7b2c k \u4e2a\u4f4d\u7f6e\u3002\u4e3a\u4e86\u628a\u7b2c k \u4e2a\u4f4d\u7f6e\u817e\u51fa\u6765\u7ed9\u65b0\u6765\u7684\u6570\u636e\uff0c\u6211\u4eec\u9700\u8981\u5c06\u7b2c k\uff5en \u8fd9\u90e8\u5206\u7684\u5143\u7d20\u90fd\u987a\u5e8f\u5730\u5f80\u540e\u632a\u4e00\u4f4d\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u65b0\u589e\u4e4b\u540e\u7684\u6570\u636e\u53d8\u5316\uff0c\u5982\u4e0b \u6240\u4ee5\uff1a \u63d2\u5165\u64cd\u4f5c\uff0c\u6700\u597d\u60c5\u51b5\u4e0b\u662fO(1)\u7684\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u662fO(n)\u7684\uff0c \u5e73\u5747\u60c5\u51b5\u4e0b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u3002 4.\u5220\u9664O(n) \u540c\u7406\u53ef\u5f97\uff1a\u5982\u679c\u6211\u4eec\u8981\u5220\u9664\u7b2c k \u4e2a\u4f4d\u7f6e\u7684\u6570\u636e\uff0c\u4e3a\u4e86\u5185\u5b58\u7684\u8fde\u7eed\u6027\uff0c\u4e5f\u9700\u8981\u642c\u79fb\u6570\u636e\uff0c\u4e0d\u7136\u4e2d\u95f4\u5c31\u4f1a\u51fa\u73b0\u7a7a\u6d1e\uff0c\u5185\u5b58\u5c31\u4e0d\u8fde\u7eed\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u7136\u662fO(n)\u3002","title":"2.1.3 \u64cd\u4f5c\u6570\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#22-arraylist","text":"\u5206\u6790ArrayList\u6e90\u7801\u4e3b\u8981\u4ece\u4e09\u4e2a\u65b9\u9762\u53bb\u7ffb\u9605\uff1a\u6210\u5458\u53d8\u91cf\uff0c\u6784\u9020\u51fd\u6570\uff0c\u5173\u952e\u65b9\u6cd5 \u4ee5\u4e0b\u6e90\u7801\u90fd\u6765\u6e90\u4e8ejdk1.8","title":"2.2 ArrayList\u6e90\u7801\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#221","text":"DEFAULT_CAPACITY = 10; \u9ed8\u8ba4\u521d\u59cb\u7684\u5bb9\u91cf**(CAPACITY) EMPTY_ELEMENTDATA = {}; \u7528\u4e8e\u7a7a\u5b9e\u4f8b\u7684\u5171\u4eab\u7a7a\u6570\u7ec4\u5b9e\u4f8b DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};\u7528\u4e8e\u9ed8\u8ba4\u5927\u5c0f\u7684\u7a7a\u5b9e\u4f8b\u7684\u5171\u4eab\u7a7a\u6570\u7ec4\u5b9e\u4f8b Object[] elementData; \u5b58\u50a8\u5143\u7d20\u7684\u6570\u7ec4\u7f13\u51b2\u533a int size; ArrayList\u7684\u5927\u5c0f\uff08\u5b83\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff09","title":"2.2.1 \u6210\u5458\u53d8\u91cf"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#222","text":"\u7b2c\u4e00\u4e2a\u6784\u9020\u662f\u5e26\u521d\u59cb\u5316\u5bb9\u91cf\u7684\u6784\u9020\u51fd\u6570\uff0c\u53ef\u4ee5\u6309\u7167\u6307\u5b9a\u7684\u5bb9\u91cf\u521d\u59cb\u5316\u6570\u7ec4 \u7b2c\u4e8c\u4e2a\u662f\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u7a7a\u96c6\u5408 \u5c06collection\u5bf9\u8c61\u8f6c\u6362\u6210\u6570\u7ec4\uff0c\u7136\u540e\u5c06\u6570\u7ec4\u7684\u5730\u5740\u7684\u8d4b\u7ed9elementData","title":"2.2.2 \u6784\u9020\u65b9\u6cd5"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#223-arraylist","text":"\u6dfb\u52a0\u6570\u636e\u7684\u6d41\u7a0b \u7ed3\u8bba\uff1a \u5e95\u5c42\u6570\u636e\u7ed3\u6784 ArrayList\u5e95\u5c42\u662f\u7528\u52a8\u6001\u7684\u6570\u7ec4\u5b9e\u73b0\u7684 \u521d\u59cb\u5bb9\u91cf ArrayList\u521d\u59cb\u5bb9\u91cf\u4e3a0\uff0c\u5f53\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u7684\u65f6\u5019\u624d\u4f1a\u521d\u59cb\u5316\u5bb9\u91cf\u4e3a10 \u6269\u5bb9\u903b\u8f91 ArrayList\u5728\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\u662f\u539f\u6765\u5bb9\u91cf\u76841.5\u500d\uff0c\u6bcf\u6b21\u6269\u5bb9\u90fd\u9700\u8981\u62f7\u8d1d\u6570\u7ec4 \u6dfb\u52a0\u903b\u8f91 \u786e\u4fdd\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6\uff08size\uff09\u52a01\u4e4b\u540e\u8db3\u591f\u5b58\u4e0b\u4e0b\u4e00\u4e2a\u6570\u636e \u8ba1\u7b97\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5982\u679c\u5f53\u524d\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6+1\u540e\u7684\u5927\u4e8e\u5f53\u524d\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8c03\u7528grow\u65b9\u6cd5\u6269\u5bb9\uff08\u539f\u6765\u76841.5\u500d\uff09 \u786e\u4fdd\u65b0\u589e\u7684\u6570\u636e\u6709\u5730\u65b9\u5b58\u50a8\u4e4b\u540e\uff0c\u5219\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u4f4d\u4e8esize\u7684\u4f4d\u7f6e\u4e0a\u3002 \u8fd4\u56de\u6dfb\u52a0\u6210\u529f\u5e03\u5c14\u503c\u3002","title":"2.2.3 ArrayList\u6e90\u7801\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#224-arraylist-listnew-arraylist10list","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u8be5\u8bed\u53e5\u53ea\u662f\u58f0\u660e\u548c\u5b9e\u4f8b\u4e86\u4e00\u4e2a ArrayList\uff0c\u6307\u5b9a\u4e86\u5bb9\u91cf\u4e3a 10\uff0c\u672a\u6269\u5bb9","title":"2.2.4 \u9762\u8bd5\u9898-ArrayList list=new ArrayList(10)\u4e2d\u7684list\u6269\u5bb9\u51e0\u6b21"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#224-list","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u5982\u4e0b\u4ee3\u7801\uff1a \u53c2\u8003\u56de\u7b54\uff1a \u6570\u7ec4\u8f6cList \uff0c\u4f7f\u7528JDK\u4e2djava.util.Arrays\u5de5\u5177\u7c7b\u7684asList\u65b9\u6cd5 List\u8f6c\u6570\u7ec4\uff0c\u4f7f\u7528List\u7684toArray\u65b9\u6cd5\u3002\u65e0\u53c2toArray\u65b9\u6cd5\u8fd4\u56de Object\u6570\u7ec4\uff0c\u4f20\u5165\u521d\u59cb\u5316\u957f\u5ea6\u7684\u6570\u7ec4\u5bf9\u8c61\uff0c\u8fd4\u56de\u8be5\u5bf9\u8c61\u6570\u7ec4 \u9762\u8bd5\u5b98\u518d\u95ee\uff1a 1\uff0c\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417 2\uff0cList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 \u6570\u7ec4\u8f6cList\u53d7\u5f71\u54cd List\u8f6c\u6570\u7ec4\u4e0d\u53d7\u5f71\u54cd \u518d\u7b54\uff1a 1\uff0c\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417 Arrays.asList\u8f6c\u6362list\u4e4b\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u7684\u5185\u5bb9\uff0clist\u4f1a\u53d7\u5f71\u54cd\uff0c\u56e0\u4e3a\u5b83\u7684\u5e95\u5c42\u4f7f\u7528\u7684Arrays\u7c7b\u4e2d\u7684\u4e00\u4e2a\u5185\u90e8\u7c7bArrayList\u6765\u6784\u9020\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u4e2a\u96c6\u5408\u7684\u6784\u9020\u5668\u4e2d\uff0c\u628a\u6211\u4eec\u4f20\u5165\u7684\u8fd9\u4e2a\u96c6\u5408\u8fdb\u884c\u4e86\u5305\u88c5\u800c\u5df2\uff0c\u6700\u7ec8\u6307\u5411\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u5185\u5b58\u5730\u5740 2\uff0cList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 list\u7528\u4e86toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86list\u5185\u5bb9\uff0c\u6570\u7ec4\u4e0d\u4f1a\u5f71\u54cd\uff0c\u5f53\u8c03\u7528\u4e86toArray\u4ee5\u540e\uff0c\u5728\u5e95\u5c42\u662f\u5b83\u662f\u8fdb\u884c\u4e86\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u8ddf\u539f\u6765\u7684\u5143\u7d20\u5c31\u6ca1\u5565\u5173\u7cfb\u4e86\uff0c\u6240\u4ee5\u5373\u4f7flist\u4fee\u6539\u4e86\u4ee5\u540e\uff0c\u6570\u7ec4\u4e5f\u4e0d\u53d7\u5f71\u54cd","title":"2.2.4 \u9762\u8bd5\u9898-\u5982\u4f55\u5b9e\u73b0\u6570\u7ec4\u548cList\u4e4b\u95f4\u7684\u8f6c\u6362"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#23","text":"","title":"2.3 \u94fe\u8868"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#231","text":"\u94fe\u8868\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u79f0\u4e4b\u4e3a\u7ed3\u70b9\uff08Node\uff09 \u7269\u7406\u5b58\u50a8\u5355\u5143\u4e0a\uff0c\u975e\u8fde\u7eed\u3001\u975e\u987a\u5e8f\u7684\u5b58\u50a8\u7ed3\u6784 \u5355\u5411\u94fe\u8868\uff1a\u6bcf\u4e2a\u7ed3\u70b9\u5305\u62ec\u4e24\u4e2a\u90e8\u5206\uff1a\u4e00\u4e2a\u662f\u5b58\u50a8\u6570\u636e\u5143\u7d20\u7684\u6570\u636e\u57df\uff0c\u53e6\u4e00\u4e2a\u662f\u5b58\u50a8\u4e0b\u4e00\u4e2a\u7ed3\u70b9\u5730\u5740\u7684\u6307\u9488\u57df\u3002\u8bb0\u5f55\u4e0b\u4e2a\u7ed3\u70b9\u5730\u5740\u7684\u6307\u9488\u53eb\u4f5c\u540e\u7ee7\u6307\u9488 next \u4ee3\u7801\u5b9e\u73b0\u53c2\u8003\uff1a \u94fe\u8868\u4e2d\u7684\u67d0\u4e2a\u8282\u70b9\u4e3aB\uff0cB\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u4e3aC \u8868\u793a\uff1a B.next==C","title":"2.3.1 \u5355\u5411\u94fe\u8868"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#232","text":"\uff081\uff09\u67e5\u8be2\u64cd\u4f5c \u53ea\u6709\u5728\u67e5\u8be2\u5934\u8282\u70b9\u7684\u65f6\u5019\u4e0d\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u67e5\u8be2\u5176\u4ed6\u7ed3\u70b9\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \uff082\uff09\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c \u53ea\u6709\u5728\u6dfb\u52a0\u548c\u5220\u9664\u5934\u8282\u70b9\u7684\u65f6\u5019\u4e0d\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u6dfb\u52a0\u6216\u5220\u9664\u5176\u4ed6\u7ed3\u70b9\u9700\u8981\u904d\u5386\u94fe\u8868\u627e\u5230\u5bf9\u5e94\u8282\u70b9\u540e\uff0c\u624d\u80fd\u5b8c\u6210\u65b0\u589e\u6216\u5220\u9664\u8282\u70b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n)","title":"2.3.2 \u5355\u5411\u94fe\u8868\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#233","text":"\u800c\u53cc\u5411\u94fe\u8868\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u652f\u6301\u4e24\u4e2a\u65b9\u5411 \u6bcf\u4e2a\u7ed3\u70b9\u4e0d\u6b62\u6709\u4e00\u4e2a\u540e\u7ee7\u6307\u9488 next \u6307\u5411\u540e\u9762\u7684\u7ed3\u70b9 \u6709\u4e00\u4e2a\u524d\u9a71\u6307\u9488 prev \u6307\u5411\u524d\u9762\u7684\u7ed3\u70b9 \u53c2\u8003\u4ee3\u7801 \u5bf9\u6bd4\u5355\u94fe\u8868\uff1a \u53cc\u5411\u94fe\u8868\u9700\u8981\u989d\u5916\u7684\u4e24\u4e2a\u7a7a\u95f4\u6765\u5b58\u50a8\u540e\u7ee7\u7ed3\u70b9\u548c\u524d\u9a71\u7ed3\u70b9\u7684\u5730\u5740 \u652f\u6301\u53cc\u5411\u904d\u5386\uff0c\u8fd9\u6837\u4e5f\u5e26\u6765\u4e86\u53cc\u5411\u94fe\u8868\u64cd\u4f5c\u7684\u7075\u6d3b\u6027","title":"2.3.3 \u53cc\u5411\u94fe\u8868"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#234","text":"\uff081\uff09\u67e5\u8be2\u64cd\u4f5c \u67e5\u8be2\u5934\u5c3e\u7ed3\u70b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u5e73\u5747\u7684\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u7ed9\u5b9a\u8282\u70b9\u627e\u524d\u9a71\u8282\u70b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1) \uff082\uff09\u589e\u5220\u64cd\u4f5c \u5934\u5c3e\u7ed3\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1) \u5176\u4ed6\u90e8\u5206\u7ed3\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(n) \u7ed9\u5b9a\u8282\u70b9\u589e\u5220\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)","title":"2.3.4 \u53cc\u5411\u94fe\u8868\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#235-arraylistlinkedlist","text":"\u5e95\u5c42\u6570\u636e\u7ed3\u6784 ArrayList \u662f\u52a8\u6001\u6570\u7ec4\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0 \u64cd\u4f5c\u6570\u636e\u6548\u7387 ArrayList\u6309\u7167\u4e0b\u6807\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6O(1)\u3010\u5185\u5b58\u662f\u8fde\u7eed\u7684\uff0c\u6839\u636e\u5bfb\u5740\u516c\u5f0f\u3011\uff0c LinkedList\u4e0d\u652f\u6301\u4e0b\u6807\u67e5\u8be2 \u67e5\u627e\uff08\u672a\u77e5\u7d22\u5f15\uff09\uff1a ArrayList\u9700\u8981\u904d\u5386\uff0c\u94fe\u8868\u4e5f\u9700\u8981\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(n) \u65b0\u589e\u548c\u5220\u9664 ArrayList\u5c3e\u90e8\u63d2\u5165\u548c\u5220\u9664\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff1b\u5176\u4ed6\u90e8\u5206\u589e\u5220\u9700\u8981\u632a\u52a8\u6570\u7ec4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) LinkedList\u5934\u5c3e\u8282\u70b9\u589e\u5220\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff0c\u5176\u4ed6\u90fd\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) \u5185\u5b58\u7a7a\u95f4\u5360\u7528 ArrayList\u5e95\u5c42\u662f\u6570\u7ec4\uff0c\u5185\u5b58\u8fde\u7eed\uff0c\u8282\u7701\u5185\u5b58 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u9700\u8981\u5b58\u50a8\u6570\u636e\uff0c\u548c\u4e24\u4e2a\u6307\u9488\uff0c\u66f4\u5360\u7528\u5185\u5b58 \u7ebf\u7a0b\u5b89\u5168 ArrayList\u548cLinkedList\u90fd\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u5982\u679c\u9700\u8981\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff0c\u6709\u4e24\u79cd\u65b9\u6848\uff1a \u5728\u65b9\u6cd5\u5185\u4f7f\u7528\uff0c\u5c40\u90e8\u53d8\u91cf\u5219\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684ArrayList\u548cLinkedList","title":"2.3.5 \u9762\u8bd5\u9898-ArrayList\u548cLinkedList\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3-hashmap","text":"","title":"3 HashMap\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#31","text":"","title":"3.1 \u4e8c\u53c9\u6811"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#311","text":"\u4e8c\u53c9\u6811\uff0c\u987e\u540d\u601d\u4e49\uff0c\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u6709\u4e24\u4e2a\u201c\u53c9\u201d\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u5206\u522b\u662f\u5de6\u5b50\u8282\u70b9\u548c\u53f3\u5b50\u8282\u70b9\u3002\u4e0d\u8fc7\uff0c\u4e8c\u53c9\u6811\u5e76\u4e0d\u8981\u6c42\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u6709\u7684\u8282\u70b9\u53ea\u6709\u5de6\u5b50\u8282\u70b9\uff0c\u6709\u7684\u8282\u70b9\u53ea\u6709\u53f3\u5b50\u8282\u70b9\u3002 \u4e8c\u53c9\u6811\u6bcf\u4e2a\u8282\u70b9\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u4e5f\u5206\u522b\u6ee1\u8db3\u4e8c\u53c9\u6811\u7684\u5b9a\u4e49\u3002 Java\u4e2d\u6709\u4e24\u4e2a\u65b9\u5f0f\u5b9e\u73b0\u4e8c\u53c9\u6811\uff1a\u6570\u7ec4\u5b58\u50a8\uff0c\u94fe\u5f0f\u5b58\u50a8\u3002 \u57fa\u4e8e\u94fe\u5f0f\u5b58\u50a8\u7684\u6811\u7684\u8282\u70b9\u53ef\u5b9a\u4e49\u5982\u4e0b\uff1a","title":"3.1.1 \u4e8c\u53c9\u6811\u6982\u8ff0"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#312","text":"\u5728\u4e8c\u53c9\u6811\u4e2d\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u4e8c\u53c9\u6811\u6709\uff1a \u6ee1\u4e8c\u53c9\u6811 \u5b8c\u5168\u4e8c\u53c9\u6811 \u4e8c\u53c9\u641c\u7d22\u6811 \u7ea2\u9ed1\u6811 \u6211\u4eec\u91cd\u70b9\u8bb2\u89e3\u4e8c\u53c9\u641c\u7d22\u6811\u548c\u7ea2\u9ed1\u6811 \uff081\uff09\u4e8c\u53c9\u641c\u7d22\u6811\u6982\u8ff0 \u4e8c\u53c9\u641c\u7d22\u6811(Binary Search Tree,BST)\u53c8\u540d\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u6709\u5e8f\u4e8c\u53c9\u6811\u6216\u8005\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u662f\u4e8c\u53c9\u6811\u4e2d\u6bd4\u8f83\u5e38\u7528\u7684\u4e00\u79cd\u7c7b\u578b \u4e8c\u53c9\u67e5\u627e\u6811\u8981\u6c42\uff0c\u5728\u6811\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\uff0c\u5176\u5de6\u5b50\u6811\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u7684\u503c\uff0c\u90fd\u8981\u5c0f\u4e8e\u8fd9\u4e2a\u8282\u70b9\u7684\u503c\uff0c\u800c\u53f3\u5b50\u6811\u8282\u70b9\u7684\u503c\u90fd\u5927\u4e8e\u8fd9\u4e2a\u8282\u70b9\u7684\u503c \uff082\uff09\u4e8c\u53c9\u641c\u7d22\u6811-\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790 \u5b9e\u9645\u4e0a\u7531\u4e8e\u4e8c\u53c9\u67e5\u627e\u6811\u7684\u5f62\u6001\u5404\u5f02\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u6211\u753b\u4e86\u51e0\u68f5\u6811\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u63d2\u5165\uff0c\u67e5\u627e\uff0c\u5220\u9664\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u63d2\u5165\uff0c\u67e5\u627e\uff0c\u5220\u9664\u7684\u65f6\u95f4\u590d\u6742\u5ea6 O(logn) \u6781\u7aef\u60c5\u51b5\u4e0b\u4e8c\u53c9\u641c\u7d22\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u5bf9\u4e8e\u56fe\u4e2d\u8fd9\u79cd\u60c5\u51b5\u5c5e\u4e8e\u6700\u574f\u7684\u60c5\u51b5\uff0c\u4e8c\u53c9\u67e5\u627e\u6811\u5df2\u7ecf\u9000\u5316\u6210\u4e86\u94fe\u8868\uff0c\u5de6\u53f3\u5b50\u6811\u6781\u5ea6\u4e0d\u5e73\u8861\uff0c\u6b64\u65f6\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u80af\u5b9a\u662fO(n)\u3002","title":"3.1.2 \u4e8c\u53c9\u641c\u7d22\u6811"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#313","text":"\uff081\uff09\u6982\u8ff0 \u7ea2\u9ed1\u6811\uff08Red Black Tree\uff09 \uff1a\u4e5f\u662f\u4e00\u79cd\u81ea\u5e73\u8861\u7684\u4e8c\u53c9\u641c\u7d22\u6811(BST)\uff0c\u4e4b\u524d\u53eb\u505a\u5e73\u8861\u4e8c\u53c9B\u6811\uff08Symmetric Binary B-Tree\uff09 \uff082\uff09\u7ea2\u9ed1\u6811\u7684\u7279\u8d28 \u6027\u8d281\uff1a\u8282\u70b9\u8981\u4e48\u662f \u7ea2\u8272 ,\u8981\u4e48\u662f \u9ed1\u8272 \u6027\u8d282\uff1a\u6839\u8282\u70b9\u662f \u9ed1\u8272 \u6027\u8d283\uff1a\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u7684\u7a7a\u8282\u70b9 \u6027\u8d284\uff1a\u7ea2\u9ed1\u6811\u4e2d\u7ea2\u8272\u8282\u70b9\u7684\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272 \u6027\u8d285\uff1a\u4ece\u4efb\u4e00\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u7684\u6240\u6709\u8def\u5f84\u90fd\u5305\u542b\u76f8\u540c\u6570\u76ee\u7684\u9ed1\u8272\u8282\u70b9 \u5728\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u7684\u65f6\u5019\uff0c\u5982\u679c\u4e0d\u7b26\u5408\u8fd9\u4e9b\u6027\u8d28\u4f1a\u53d1\u751f\u65cb\u8f6c\uff0c\u4ee5\u8fbe\u5230\u6240\u6709\u7684\u6027\u8d28\uff0c\u4fdd\u8bc1\u7ea2\u9ed1\u6811\u7684\u5e73\u8861 \uff083\uff09\u7ea2\u9ed1\u6811\u7684\u590d\u6742\u5ea6 \u67e5\u627e\uff1a \u7ea2\u9ed1\u6811\u4e5f\u662f\u4e00\u68f5BST\uff08\u4e8c\u53c9\u641c\u7d22\u6811\uff09\u6811\uff0c\u67e5\u627e\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\uff1aO(log n) \u6dfb\u52a0\uff1a \u6dfb\u52a0\u5148\u8981\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u627e\u5230\u5143\u7d20\u6dfb\u52a0\u7684\u4f4d\u7f6e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(log n) \u6dfb\u52a0\u5b8c\u6210\u540e\u6d89\u53ca\u5230\u590d\u6742\u5ea6\u4e3aO(1)\u7684\u65cb\u8f6c\u8c03\u6574\u64cd\u4f5c \u6545\u6574\u4f53\u590d\u6742\u5ea6\u4e3a\uff1aO(log n) \u5220\u9664\uff1a \u9996\u5148\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u627e\u5230\u88ab\u5220\u9664\u5143\u7d20\u7684\u4f4d\u7f6e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(log n) \u5220\u9664\u5b8c\u6210\u540e\u6d89\u53ca\u5230\u590d\u6742\u5ea6\u4e3aO(1)\u7684\u65cb\u8f6c\u8c03\u6574\u64cd\u4f5c \u6545\u6574\u4f53\u590d\u6742\u5ea6\u4e3a\uff1aO(log n)","title":"3.1.3 \u7ea2\u9ed1\u6811"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#32","text":"\u5728HashMap\u4e2d\u7684\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5c31\u662f\u6563\u5217\u8868\uff0c\u5728\u6563\u5217\u8868\u4e2d\u53c8\u4f7f\u7528\u5230\u4e86\u7ea2\u9ed1\u6811\u548c\u94fe\u8868","title":"3.2 \u6563\u5217\u8868"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#321-hash-table","text":"\u6563\u5217\u8868(Hash Table)\u53c8\u540d\u54c8\u5e0c\u8868/Hash\u8868\uff0c\u662f\u6839\u636e\u952e\uff08Key\uff09\u76f4\u63a5\u8bbf\u95ee\u5728\u5185\u5b58\u5b58\u50a8\u4f4d\u7f6e\u503c\uff08Value\uff09\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u662f\u7531\u6570\u7ec4\u6f14\u5316\u800c\u6765\u7684\uff0c\u5229\u7528\u4e86\u6570\u7ec4\u652f\u6301\u6309\u7167\u4e0b\u6807\u8fdb\u884c\u968f\u673a\u8bbf\u95ee\u6570\u636e\u7684\u7279\u6027 \u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5047\u8bbe\u6709100\u4e2a\u4eba\u53c2\u52a0\u9a6c\u62c9\u677e\uff0c\u7f16\u53f7\u662f1-100\uff0c\u5982\u679c\u8981\u7f16\u7a0b\u5b9e\u73b0\u6839\u636e\u9009\u624b\u7684\u7f16\u53f7\u8fc5\u901f\u627e\u5230\u9009\u624b\u4fe1\u606f\uff1f \u53ef\u4ee5\u628a\u9009\u624b\u4fe1\u606f\u5b58\u5165\u6570\u7ec4\u4e2d\uff0c\u9009\u624b\u7f16\u53f7\u5c31\u662f\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u6570\u7ec4\u7684\u5143\u7d20\u5c31\u662f\u9009\u624b\u7684\u4fe1\u606f\u3002 \u5f53\u6211\u4eec\u67e5\u8be2\u9009\u624b\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u6839\u636e\u9009\u624b\u7684\u7f16\u53f7\u5230\u6570\u7ec4\u4e2d\u67e5\u8be2\u5bf9\u5e94\u7684\u5143\u7d20\u5c31\u53ef\u4ee5\u5feb\u901f\u627e\u5230\u9009\u624b\u7684\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\uff1a \u73b0\u5728\u9700\u6c42\u5347\u7ea7\u4e86\uff1a \u5047\u8bbe\u6709100\u4e2a\u4eba\u53c2\u52a0\u9a6c\u62c9\u677e\uff0c\u4e0d\u91c7\u75281-100\u7684\u81ea\u7136\u6570\u5bf9\u9009\u624b\u8fdb\u884c\u7f16\u53f7\uff0c\u7f16\u53f7\u6709\u4e00\u5b9a\u7684\u89c4\u5219\u6bd4\u5982\uff1a2023ZHBJ001\uff0c\u5176\u4e2d2023\u4ee3\u8868\u5e74\u4efd\uff0cZH\u4ee3\u8868\u4e2d\u56fd\uff0cBJ\u4ee3\u8868\u5317\u4eac\uff0c001\u4ee3\u8868\u539f\u6765\u7684\u7f16\u53f7\uff0c\u90a3\u6b64\u65f6\u7684\u7f16\u53f72023ZHBJ001\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u6b64\u65f6\u5e94\u8be5\u5982\u4f55\u5b9e\u73b0\u5462\uff1f \u6211\u4eec\u76ee\u524d\u662f\u628a\u9009\u624b\u7684\u4fe1\u606f\u5b58\u5165\u5230\u6570\u7ec4\u4e2d\uff0c\u4e0d\u8fc7\u9009\u624b\u7684\u7f16\u53f7\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u4e0d\u8fc7\uff0c\u53ef\u4ee5\u628a\u9009\u624b\u7684\u9009\u53f7\u8fdb\u884c\u8f6c\u6362\uff0c\u8f6c\u6362\u4e3a\u6570\u503c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\u4e86\uff1f \u8f6c\u6362\u53ef\u4ee5\u4f7f\u7528\u6563\u5217\u51fd\u6570\u8fdb\u884c\u8f6c\u6362","title":"3.2.1 \u6563\u5217\u8868\uff08Hash Table\uff09\u6982\u8ff0"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#322","text":"\u5c06\u952e(key)\u6620\u5c04\u4e3a\u6570\u7ec4\u4e0b\u6807\u7684\u51fd\u6570\u53eb\u505a\u6563\u5217\u51fd\u6570\u3002\u53ef\u4ee5\u8868\u793a\u4e3a\uff1ahashValue = hash(key) \u6563\u5217\u51fd\u6570\u7684\u57fa\u672c\u8981\u6c42\uff1a \u6563\u5217\u51fd\u6570\u8ba1\u7b97\u5f97\u5230\u7684\u6563\u5217\u503c\u5fc5\u987b\u662f\u5927\u4e8e\u7b49\u4e8e0\u7684\u6b63\u6574\u6570\uff0c\u56e0\u4e3ahashValue\u9700\u8981\u4f5c\u4e3a\u6570\u7ec4\u7684\u4e0b\u6807\u3002 \u5982\u679ckey1==key2\uff0c\u90a3\u4e48\u7ecf\u8fc7hash\u540e\u5f97\u5230\u7684\u54c8\u5e0c\u503c\u4e5f\u5fc5\u76f8\u540c\u5373\uff1ahash(key1) == hash(key2\uff09 \u5982\u679ckey1 != key2\uff0c\u90a3\u4e48\u7ecf\u8fc7hash\u540e\u5f97\u5230\u7684\u54c8\u5e0c\u503c\u4e5f\u5fc5\u4e0d\u76f8\u540c\u5373\uff1ahash(key1) != hash(key2) \u5b9e\u9645\u7684\u60c5\u51b5\u4e0b\u60f3\u627e\u4e00\u4e2a\u6563\u5217\u51fd\u6570\u80fd\u591f\u505a\u5230\u5bf9\u4e8e\u4e0d\u540c\u7684key\u8ba1\u7b97\u5f97\u5230\u7684\u6563\u5217\u503c\u90fd\u4e0d\u540c\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u5373\u4fbf\u50cf\u8457\u540d\u7684MD5,SHA\u7b49\u54c8\u5e0c\u7b97\u6cd5\u4e5f\u65e0\u6cd5\u907f\u514d\u8fd9\u4e00\u60c5\u51b5\uff0c\u8fd9\u5c31\u662f\u6563\u5217\u51b2\u7a81(\u6216\u8005\u54c8\u5e0c\u51b2\u7a81\uff0c\u54c8\u5e0c\u78b0\u649e\uff0c \u5c31\u662f\u6307\u591a\u4e2akey\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u6570\u7ec4\u4e0b\u6807\u4f4d\u7f6e )","title":"3.2.2 \u6563\u5217\u51fd\u6570\u548c\u6563\u5217\u51b2\u7a81"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#323-","text":"\u5728\u6563\u5217\u8868\u4e2d\uff0c\u6570\u7ec4\u7684\u6bcf\u4e2a\u4e0b\u6807\u4f4d\u7f6e\u6211\u4eec\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u6876\uff08bucket\uff09\u6216\u8005\u69fd\uff08slot\uff09\uff0c\u6bcf\u4e2a\u6876(\u69fd)\u4f1a\u5bf9\u5e94\u4e00\u6761\u94fe\u8868\uff0c\u6240\u6709\u6563\u5217\u503c\u76f8\u540c\u7684\u5143\u7d20\u6211\u4eec\u90fd\u653e\u5230\u76f8\u540c\u69fd\u4f4d\u5bf9\u5e94\u7684\u94fe\u8868\u4e2d\u3002 \u7b80\u5355\u5c31\u662f\uff0c\u5982\u679c\u6709\u591a\u4e2akey\u6700\u7ec8\u7684hash\u503c\u662f\u4e00\u6837\u7684\uff0c\u5c31\u4f1a\u5b58\u5165\u6570\u7ec4\u7684\u540c\u4e00\u4e2a\u4e0b\u6807\u4e2d\uff0c\u4e0b\u6807\u4e2d\u6302\u4e00\u4e2a\u94fe\u8868\u5b58\u5165\u591a\u4e2a\u6570\u636e","title":"3.2.3 \u6563\u5217\u51b2\u7a81-\u94fe\u8868\u6cd5\uff08\u62c9\u94fe\uff09"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#324-","text":"1\uff0c\u63d2\u5165\u64cd\u4f5c\uff0c\u901a\u8fc7\u6563\u5217\u51fd\u6570\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u6563\u5217\u69fd\u4f4d\uff0c\u5c06\u5176\u63d2\u5165\u5230\u5bf9\u5e94\u94fe\u8868\u4e2d\u5373\u53ef\uff0c\u63d2\u5165\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(1) \u901a\u8fc7\u8ba1\u7b97\u5c31\u53ef\u4ee5\u627e\u5230\u5143\u7d20 2\uff0c\u5f53\u67e5\u627e\u3001\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u6211\u4eec\u540c\u6837\u901a\u8fc7\u6563\u5217\u51fd\u6570\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u69fd\uff0c\u7136\u540e\u904d\u5386\u94fe\u8868\u67e5\u627e\u6216\u8005\u5220\u9664 \u5e73\u5747\u60c5\u51b5\u4e0b\u57fa\u4e8e\u94fe\u8868\u6cd5\u89e3\u51b3\u51b2\u7a81\u65f6\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1) \u6563\u5217\u8868\u53ef\u80fd\u4f1a\u9000\u5316\u4e3a\u94fe\u8868,\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4ece O(1) \u9000\u5316\u4e3a O(n) \u5c06\u94fe\u8868\u6cd5\u4e2d\u7684\u94fe\u8868\u6539\u9020\u4e3a\u5176\u4ed6\u9ad8\u6548\u7684\u52a8\u6001\u6570\u636e\u7ed3\u6784\uff0c\u6bd4\u5982\u7ea2\u9ed1\u6811\uff0c\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f O(logn) \u5c06\u94fe\u8868\u6cd5\u4e2d\u7684\u94fe\u8868\u6539\u9020\u7ea2\u9ed1\u6811\u8fd8\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u539f\u56e0\uff0c\u53ef\u4ee5\u9632\u6b62DDos\u653b\u51fb DDos \u653b\u51fb: \u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb(\u82f1\u6587\u610f\u601d\u662fDistributed Denial of Service\uff0c\u7b80\u79f0DDoS\uff09 \u6307\u5904\u4e8e\u4e0d\u540c\u4f4d\u7f6e\u7684\u591a\u4e2a\u653b\u51fb\u8005\u540c\u65f6\u5411\u4e00\u4e2a\u6216\u6570\u4e2a\u76ee\u6807\u53d1\u52a8\u653b\u51fb\uff0c\u6216\u8005\u4e00\u4e2a\u653b\u51fb\u8005\u63a7\u5236\u4e86\u4f4d\u4e8e\u4e0d\u540c\u4f4d\u7f6e\u7684\u591a\u53f0\u673a\u5668\u5e76\u5229\u7528\u8fd9\u4e9b\u673a\u5668\u5bf9\u53d7\u5bb3\u8005\u540c\u65f6\u5b9e\u65bd\u653b\u51fb\u3002\u7531\u4e8e\u653b\u51fb\u7684\u53d1\u51fa\u70b9\u662f\u5206\u5e03\u5728\u4e0d\u540c\u5730\u65b9\u7684\uff0c\u8fd9\u7c7b\u653b\u51fb\u79f0\u4e3a\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff0c\u5176\u4e2d\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u6709\u591a\u4e2a","title":"3.2.4 \u65f6\u95f4\u590d\u6742\u5ea6-\u6563\u5217\u8868"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#33-hashmap","text":"HashMap\u7684\u6570\u636e\u7ed3\u6784\uff1a \u5e95\u5c42\u4f7f\u7528hash\u8868\u6570\u636e\u7ed3\u6784\uff0c\u5373\u6570\u7ec4\u548c\u94fe\u8868\u6216\u7ea2\u9ed1\u6811 \u5f53\u6211\u4eec\u5f80HashMap\u4e2dput\u5143\u7d20\u65f6\uff0c\u5229\u7528key\u7684hashCode\u91cd\u65b0hash\u8ba1\u7b97\u51fa\u5f53\u524d\u5bf9\u8c61\u7684\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807 \u5b58\u50a8\u65f6\uff0c\u5982\u679c\u51fa\u73b0hash\u503c\u76f8\u540c\u7684key\uff0c\u6b64\u65f6\u6709\u4e24\u79cd\u60c5\u51b5\u3002 a. \u5982\u679ckey\u76f8\u540c\uff0c\u5219\u8986\u76d6\u539f\u59cb\u503c\uff1b b. \u5982\u679ckey\u4e0d\u540c\uff08\u51fa\u73b0\u51b2\u7a81\uff09\uff0c\u5219\u5c06\u5f53\u524d\u7684key-value\u653e\u5165\u94fe\u8868\u6216\u7ea2\u9ed1\u6811\u4e2d \u83b7\u53d6\u65f6\uff0c\u76f4\u63a5\u627e\u5230hash\u503c\u5bf9\u5e94\u7684\u4e0b\u6807\uff0c\u5728\u8fdb\u4e00\u6b65\u5224\u65adkey\u662f\u5426\u76f8\u540c\uff0c\u4ece\u800c\u627e\u5230\u5bf9\u5e94\u503c\u3002 \u9762\u8bd5\u5b98\u8ffd\u95ee\uff1aHashMap\u7684jdk1.7\u548cjdk1.8\u6709\u4ec0\u4e48\u533a\u522b JDK1.8\u4e4b\u524d\u91c7\u7528\u7684\u662f\u62c9\u94fe\u6cd5\u3002\u62c9\u94fe\u6cd5\uff1a\u5c06\u94fe\u8868\u548c\u6570\u7ec4\u76f8\u7ed3\u5408\u3002\u4e5f\u5c31\u662f\u8bf4\u521b\u5efa\u4e00\u4e2a\u94fe\u8868\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u6bcf\u4e00\u683c\u5c31\u662f\u4e00\u4e2a\u94fe\u8868\u3002\u82e5\u9047\u5230\u54c8\u5e0c\u51b2\u7a81\uff0c\u5219\u5c06\u51b2\u7a81\u7684\u503c\u52a0\u5230\u94fe\u8868\u4e2d\u5373\u53ef\u3002 jdk1.8\u5728\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u65f6\u6709\u4e86\u8f83\u5927\u7684\u53d8\u5316\uff0c\u5f53\u94fe\u8868\u957f\u5ea6\u5927\u4e8e\u9608\u503c\uff08\u9ed8\u8ba4\u4e3a8\uff09 \u65f6\u5e76\u4e14\u6570\u7ec4\u957f\u5ea6\u8fbe\u523064\u65f6\uff0c\u5c06\u94fe\u8868\u8f6c\u5316\u4e3a\u7ea2\u9ed1\u6811\uff0c\u4ee5\u51cf\u5c11\u641c\u7d22\u65f6\u95f4\u3002\u6269\u5bb9 resize( ) \u65f6\uff0c\u7ea2\u9ed1\u6811\u62c6\u5206\u6210\u7684\u6811\u7684\u7ed3\u70b9\u6570\u5c0f\u4e8e\u7b49\u4e8e\u4e34\u754c\u503c6\u4e2a\uff0c\u5219\u9000\u5316\u6210\u94fe\u8868","title":"3.3 \u9762\u8bd5\u9898-\u8bf4\u4e00\u4e0bHashMap\u7684\u5b9e\u73b0\u539f\u7406\uff1f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#34-hashmapput","text":"","title":"3.4 \u9762\u8bd5\u9898-HashMap\u7684put\u65b9\u6cd5\u7684\u5177\u4f53\u6d41\u7a0b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#341-hashmap","text":"","title":"3.4.1 hashMap\u5e38\u89c1\u5c5e\u6027"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#342","text":"HashMap\u662f\u61d2\u60f0\u52a0\u8f7d\uff0c\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u5e76\u6ca1\u6709\u521d\u59cb\u5316\u6570\u7ec4 \u5728\u65e0\u53c2\u7684\u6784\u9020\u51fd\u6570\u4e2d\uff0c\u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u7684\u52a0\u8f7d\u56e0\u5b50\u662f0.75 \u6dfb\u52a0\u6570\u636e\u6d41\u7a0b\u56fe \u5177\u4f53\u7684\u6e90\u7801\uff1a public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node<K,V>[] tab; Node<K,V> p; int n, i; //\u5224\u65ad\u6570\u7ec4\u662f\u5426\u672a\u521d\u59cb\u5316 if ((tab = table) == null || (n = tab.length) == 0) //\u5982\u679c\u672a\u521d\u59cb\u5316\uff0c\u8c03\u7528resize\u65b9\u6cd5 \u8fdb\u884c\u521d\u59cb\u5316 n = (tab = resize()).length; //\u901a\u8fc7 & \u8fd0\u7b97\u6c42\u51fa\u8be5\u6570\u636e\uff08key\uff09\u7684\u6570\u7ec4\u4e0b\u6807\u5e76\u5224\u65ad\u8be5\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u6570\u636e if ((p = tab[i = (n - 1) & hash]) == null) //\u5982\u679c\u6ca1\u6709\uff0c\u76f4\u63a5\u5c06\u6570\u636e\u653e\u5728\u8be5\u4e0b\u6807\u4f4d\u7f6e tab[i] = newNode(hash, key, value, null); //\u8be5\u6570\u7ec4\u4e0b\u6807\u6709\u6570\u636e\u7684\u60c5\u51b5 else { Node<K,V> e; K k; //\u5224\u65ad\u8be5\u4f4d\u7f6e\u6570\u636e\u7684key\u548c\u65b0\u6765\u7684\u6570\u636e\u662f\u5426\u4e00\u6837 if (p.hash == hash && ((k = p.key) == key || (key != null && key.equals(k)))) //\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c\uff0c\u8be5\u8282\u70b9\u7684\u6570\u636e\u8d4b\u503c\u7ed9e,\u540e\u8fb9\u4f1a\u7528\u5230 e = p; //\u5224\u65ad\u662f\u4e0d\u662f\u7ea2\u9ed1\u6811 else if (p instanceof TreeNode) //\u5982\u679c\u662f\u7ea2\u9ed1\u6811\u7684\u8bdd\uff0c\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value); //\u65b0\u6570\u636e\u548c\u5f53\u524d\u6570\u7ec4\u65e2\u4e0d\u76f8\u540c\uff0c\u4e5f\u4e0d\u662f\u7ea2\u9ed1\u6811\u8282\u70b9\uff0c\u8bc1\u660e\u662f\u94fe\u8868 else { //\u904d\u5386\u94fe\u8868 for (int binCount = 0; ; ++binCount) { //\u5224\u65adnext\u8282\u70b9\uff0c\u5982\u679c\u4e3a\u7a7a\u7684\u8bdd\uff0c\u8bc1\u660e\u904d\u5386\u5230\u94fe\u8868\u5c3e\u90e8\u4e86 if ((e = p.next) == null) { //\u628a\u65b0\u503c\u653e\u5165\u94fe\u8868\u5c3e\u90e8 p.next = newNode(hash, key, value, null); //\u56e0\u4e3a\u65b0\u63d2\u5165\u4e86\u4e00\u6761\u6570\u636e\uff0c\u6240\u4ee5\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u4e0d\u662f\u5927\u4e8e\u7b49\u4e8e8 if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st //\u5982\u679c\u662f\uff0c\u8fdb\u884c\u8f6c\u6362\u7ea2\u9ed1\u6811\u64cd\u4f5c treeifyBin(tab, hash); break; } //\u5224\u65ad\u94fe\u8868\u5f53\u4e2d\u6709\u6570\u636e\u76f8\u540c\u7684\u503c\uff0c\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) break; //\u628a\u4e0b\u4e00\u4e2a\u8282\u70b9\u8d4b\u503c\u4e3a\u5f53\u524d\u8282\u70b9 p = e; } } //\u5224\u65ade\u662f\u5426\u4e3a\u7a7a\uff08e\u503c\u4e3a\u4fee\u6539\u64cd\u4f5c\u5b58\u653e\u539f\u6570\u636e\u7684\u53d8\u91cf\uff09 if (e != null) { // existing mapping for key //\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8bc1\u660e\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u53d6\u51fa\u8001\u503c V oldValue = e.value; //\u4e00\u5b9a\u4f1a\u6267\u884c onlyIfAbsent\u4f20\u8fdb\u6765\u7684\u662ffalse if (!onlyIfAbsent || oldValue == null) //\u5c06\u65b0\u503c\u8d4b\u503c\u5f53\u524d\u8282\u70b9 e.value = value; afterNodeAccess(e); //\u8fd4\u56de\u8001\u503c return oldValue; } } //\u8ba1\u6570\u5668\uff0c\u8ba1\u7b97\u5f53\u524d\u8282\u70b9\u7684\u4fee\u6539\u6b21\u6570 ++modCount; //\u5f53\u524d\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u6570\u91cf\u5982\u679c\u5927\u4e8e\u6269\u5bb9\u9608\u503c if (++size > threshold) //\u8fdb\u884c\u6269\u5bb9\u64cd\u4f5c resize(); //\u7a7a\u65b9\u6cd5 afterNodeInsertion(evict); //\u6dfb\u52a0\u64cd\u4f5c\u65f6 \u8fd4\u56de\u7a7a\u503c return null; } \u5224\u65ad\u952e\u503c\u5bf9\u6570\u7ec4table\u662f\u5426\u4e3a\u7a7a\u6216\u4e3anull\uff0c\u5426\u5219\u6267\u884cresize()\u8fdb\u884c\u6269\u5bb9\uff08\u521d\u59cb\u5316\uff09 \u6839\u636e\u952e\u503ckey\u8ba1\u7b97hash\u503c\u5f97\u5230\u6570\u7ec4\u7d22\u5f15 \u5224\u65adtable[i]==null\uff0c\u6761\u4ef6\u6210\u7acb\uff0c\u76f4\u63a5\u65b0\u5efa\u8282\u70b9\u6dfb\u52a0 \u5982\u679ctable[i]==null ,\u4e0d\u6210\u7acb 4.1 \u5224\u65adtable[i]\u7684\u9996\u4e2a\u5143\u7d20\u662f\u5426\u548ckey\u4e00\u6837\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u8986\u76d6value 4.2 \u5224\u65adtable[i] \u662f\u5426\u4e3atreeNode\uff0c\u5373table[i] \u662f\u5426\u662f\u7ea2\u9ed1\u6811\uff0c\u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u76f4\u63a5\u5728\u6811\u4e2d\u63d2\u5165\u952e\u503c\u5bf9 4.3 \u904d\u5386table[i]\uff0c\u94fe\u8868\u7684\u5c3e\u90e8\u63d2\u5165\u6570\u636e\uff0c\u7136\u540e\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u5426\u5927\u4e8e8\uff0c\u5927\u4e8e8\u7684\u8bdd\u628a\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5728\u7ea2\u9ed1\u6811\u4e2d\u6267\u884c\u63d2\u5165\u64cd \u4f5c\uff0c\u904d\u5386\u8fc7\u7a0b\u4e2d\u82e5\u53d1\u73b0key\u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6value \u63d2\u5165\u6210\u529f\u540e\uff0c\u5224\u65ad\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cfsize\u662f\u5426\u8d85\u591a\u4e86\u6700\u5927\u5bb9\u91cfthreshold\uff08\u6570\u7ec4\u957f\u5ea6*0.75\uff09\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u8fdb\u884c\u6269\u5bb9\u3002","title":"3.4.2 \u6e90\u7801\u5206\u6790"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#35-hashmap","text":"\u6269\u5bb9\u7684\u6d41\u7a0b\uff1a \u6e90\u7801\uff1a //\u6269\u5bb9\u3001\u521d\u59cb\u5316\u6570\u7ec4 final Node<K,V>[] resize() { Node<K,V>[] oldTab = table; //\u5982\u679c\u5f53\u524d\u6570\u7ec4\u4e3anull\u7684\u65f6\u5019\uff0c\u628aoldCap\u8001\u6570\u7ec4\u5bb9\u91cf\u8bbe\u7f6e\u4e3a0 int oldCap = (oldTab == null) ? 0 : oldTab.length; //\u8001\u7684\u6269\u5bb9\u9608\u503c int oldThr = threshold; int newCap, newThr = 0; //\u5224\u65ad\u6570\u7ec4\u5bb9\u91cf\u662f\u5426\u5927\u4e8e0\uff0c\u5927\u4e8e0\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u521d\u59cb\u5316 if (oldCap > 0) { //\u5224\u65ad\u5f53\u524d\u6570\u7ec4\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6700\u5927\u6570\u7ec4\u957f\u5ea6 if (oldCap >= MAXIMUM_CAPACITY) { //\u5982\u679c\u662f\uff0c\u5c06\u6269\u5bb9\u9608\u503c\u76f4\u63a5\u8bbe\u7f6e\u4e3aint\u7c7b\u578b\u7684\u6700\u5927\u6570\u503c\u5e76\u76f4\u63a5\u8fd4\u56de threshold = Integer.MAX_VALUE; return oldTab; } //\u5982\u679c\u5728\u6700\u5927\u957f\u5ea6\u8303\u56f4\u5185\uff0c\u5219\u9700\u8981\u6269\u5bb9 OldCap << 1\u7b49\u4ef7\u4e8eoldCap*2 //\u8fd0\u7b97\u8fc7\u540e\u5224\u65ad\u662f\u4e0d\u662f\u6700\u5927\u503c\u5e76\u4e14oldCap\u9700\u8981\u5927\u4e8e16 else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY && oldCap >= DEFAULT_INITIAL_CAPACITY) newThr = oldThr << 1; // double threshold \u7b49\u4ef7\u4e8eoldThr*2 } //\u5982\u679coldCap<0\uff0c\u4f46\u662f\u5df2\u7ecf\u521d\u59cb\u5316\u4e86\uff0c\u50cf\u628a\u5143\u7d20\u5220\u9664\u5b8c\u4e4b\u540e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5b83\u7684\u4e34\u754c\u503c\u80af\u5b9a\u8fd8\u5b58\u5728\uff0c \u5982\u679c\u662f\u9996\u6b21\u521d\u59cb\u5316\uff0c\u5b83\u7684\u4e34\u754c\u503c\u5219\u4e3a0 else if (oldThr > 0) // initial capacity was placed in threshold newCap = oldThr; //\u6570\u7ec4\u672a\u521d\u59cb\u5316\u7684\u60c5\u51b5\uff0c\u5c06\u9608\u503c\u548c\u6269\u5bb9\u56e0\u5b50\u90fd\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } //\u521d\u59cb\u5316\u5bb9\u91cf\u5c0f\u4e8e16\u7684\u65f6\u5019\uff0c\u6269\u5bb9\u9608\u503c\u662f\u6ca1\u6709\u8d4b\u503c\u7684 if (newThr == 0) { //\u521b\u5efa\u9608\u503c float ft = (float)newCap * loadFactor; //\u5224\u65ad\u65b0\u5bb9\u91cf\u548c\u65b0\u9608\u503c\u662f\u5426\u5927\u4e8e\u6700\u5927\u5bb9\u91cf newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } //\u8ba1\u7b97\u51fa\u6765\u7684\u9608\u503c\u8d4b\u503c threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) //\u6839\u636e\u4e0a\u8fb9\u8ba1\u7b97\u5f97\u51fa\u7684\u5bb9\u91cf \u521b\u5efa\u65b0\u7684\u6570\u7ec4 Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap]; //\u8d4b\u503c table = newTab; //\u6269\u5bb9\u64cd\u4f5c\uff0c\u5224\u65ad\u4e0d\u4e3a\u7a7a\u8bc1\u660e\u4e0d\u662f\u521d\u59cb\u5316\u6570\u7ec4 if (oldTab != null) { //\u904d\u5386\u6570\u7ec4 for (int j = 0; j < oldCap; ++j) { Node<K,V> e; //\u5224\u65ad\u5f53\u524d\u4e0b\u6807\u4e3aj\u7684\u6570\u7ec4\u5982\u679c\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8d4b\u503c\u4e2ae\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c if ((e = oldTab[j]) != null) { //\u5c06\u6570\u7ec4\u4f4d\u7f6e\u7f6e\u7a7a oldTab[j] = null; //\u5224\u65ad\u662f\u5426\u6709\u4e0b\u4e2a\u8282\u70b9 if (e.next == null) //\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u91cd\u65b0\u8ba1\u7b97\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5e76\u653e\u8fdb\u53bb newTab[e.hash & (newCap - 1)] = e; //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6811\u5316 else if (e instanceof TreeNode) //\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c ((TreeNode<K,V>)e).split(this, newTab, j, oldCap); //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u6ca1\u6709\u6811\u5316\uff08\u94fe\u8868\u5f62\u5f0f\uff09 else { //\u6bd4\u5982\u8001\u6570\u7ec4\u5bb9\u91cf\u662f16\uff0c\u90a3\u4e0b\u6807\u5c31\u4e3a0-15 //\u6269\u5bb9\u64cd\u4f5c*2\uff0c\u5bb9\u91cf\u5c31\u53d8\u4e3a32\uff0c\u4e0b\u6807\u4e3a0-31 //\u4f4e\u4f4d\uff1a0-15\uff0c\u9ad8\u4f4d16-31 //\u5b9a\u4e49\u4e86\u56db\u4e2a\u53d8\u91cf // \u4f4e\u4f4d\u5934 \u4f4e\u4f4d\u5c3e Node<K,V> loHead = null, loTail = null; // \u9ad8\u4f4d\u5934 \u9ad8\u4f4d\u5c3e Node<K,V> hiHead = null, hiTail = null; //\u4e0b\u4e2a\u8282\u70b9 Node<K,V> next; //\u5faa\u73af\u904d\u5386 do { //\u53d6\u51fanext\u8282\u70b9 next = e.next; //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e3a0 if ((e.hash & oldCap) == 0) { //\u5982\u679c\u4f4e\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (loTail == null) //\u5c06e\u503c\u653e\u5165\u4f4e\u4f4d\u5934 loHead = e; //\u4f4e\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 loTail.next = e; //\u8bb0\u5f55\u4f4e\u4f4d\u5c3e\u6570\u636e loTail = e; } //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e0d\u4e3a0 else { //\u5982\u679c\u9ad8\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (hiTail == null) //\u5c06e\u503c\u653e\u5165\u9ad8\u4f4d\u5934 hiHead = e; //\u9ad8\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 hiTail.next = e; //\u8bb0\u5f55\u9ad8\u4f4d\u5c3e\u6570\u636e hiTail = e; } } //\u5982\u679ce\u4e0d\u4e3a\u7a7a\uff0c\u8bc1\u660e\u6ca1\u6709\u5230\u94fe\u8868\u5c3e\u90e8\uff0c\u7ee7\u7eed\u6267\u884c\u5faa\u73af while ((e = next) != null); //\u4f4e\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (loTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a loTail.next = null; //\u5c06\u4f4e\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684\u539f\u4e0b\u6807\u4f4d\u7f6e newTab[j] = loHead; } //\u9ad8\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (hiTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a hiTail.next = null; //\u5c06\u9ad8\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684(\u539f\u4e0b\u6807+\u539f\u6570\u7ec4\u5bb9\u91cf)\u4f4d\u7f6e newTab[j + oldCap] = hiHead; } } } } } //\u8fd4\u56de\u65b0\u7684\u6570\u7ec4\u5bf9\u8c61 return newTab; } \u5728\u6dfb\u52a0\u5143\u7d20\u6216\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981\u8c03\u7528resize\u65b9\u6cd5\u8fdb\u884c\u6269\u5bb9\uff0c\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u521d\u59cb\u5316\u6570\u7ec4\u957f\u5ea6\u4e3a16\uff0c\u4ee5\u540e\u6bcf\u6b21\u6bcf\u6b21\u6269\u5bb9\u90fd\u662f\u8fbe\u5230\u4e86\u6269\u5bb9\u9608\u503c\uff08\u6570\u7ec4\u957f\u5ea6 * 0.75\uff09 \u6bcf\u6b21\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u90fd\u662f\u6269\u5bb9\u4e4b\u524d\u5bb9\u91cf\u76842\u500d\uff1b \u6269\u5bb9\u4e4b\u540e\uff0c\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u9700\u8981\u628a\u8001\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u632a\u52a8\u5230\u65b0\u7684\u6570\u7ec4\u4e2d \u6ca1\u6709hash\u51b2\u7a81\u7684\u8282\u70b9\uff0c\u5219\u76f4\u63a5\u4f7f\u7528 e.hash & (newCap - 1) \u8ba1\u7b97\u65b0\u6570\u7ec4\u7684\u7d22\u5f15\u4f4d\u7f6e \u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u8d70\u7ea2\u9ed1\u6811\u7684\u6dfb\u52a0 \u5982\u679c\u662f\u94fe\u8868\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u53ef\u80fd\u9700\u8981\u62c6\u5206\u94fe\u8868\uff0c\u5224\u65ad(e.hash & oldCap)\u662f\u5426\u4e3a0\uff0c\u8be5\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u505c\u7559\u5728\u539f\u59cb\u4f4d\u7f6e\uff0c\u8981\u4e48\u79fb\u52a8\u5230\u539f\u59cb\u4f4d\u7f6e+\u589e\u52a0\u7684\u6570\u7ec4\u5927\u5c0f\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a","title":"3.5 \u9762\u8bd5\u9898-\u8bb2\u4e00\u8bb2HashMap\u7684\u6269\u5bb9\u673a\u5236"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#36-hashmap","text":"\u5728putVal\u65b9\u6cd5\u4e2d\uff0c\u6709\u4e00\u4e2ahash(key)\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u6765\u53bb\u8ba1\u7b97key\u7684hash\u503c\u7684\uff0c\u770b\u4e0b\u9762\u7684\u4ee3\u7801 \u9996\u5148\u83b7\u53d6key\u7684hashCode\u503c\uff0c\u7136\u540e\u53f3\u79fb16\u4f4d \u5f02\u6216\u8fd0\u7b97 \u539f\u6765\u7684hashCode\u503c\uff0c\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u4f7f\u539f\u6765\u7684hash\u503c\u66f4\u52a0\u5747\u5300\uff0c\u51cf\u5c11hash\u51b2\u7a81 \u6709\u4e86hash\u503c\u4e4b\u540e\uff0c\u5c31\u5f88\u65b9\u4fbf\u7684\u53bb\u8ba1\u7b97\u5f53\u524dkey\u7684\u5728\u6570\u7ec4\u4e2d\u5b58\u50a8\u7684\u4e0b\u6807\uff0c\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff1a (n-1)&hash : \u5f97\u5230\u6570\u7ec4\u4e2d\u7684\u7d22\u5f15\uff0c\u4ee3\u66ff\u53d6\u6a21\uff0c\u6027\u80fd\u66f4\u597d\uff0c\u6570\u7ec4\u957f\u5ea6\u5fc5\u987b\u662f2\u7684n\u6b21\u5e42 \u5173\u4e8ehash\u503c\u7684\u5176\u4ed6\u9762\u8bd5\u9898\uff1a\u4e3a\u4f55HashMap\u7684\u6570\u7ec4\u957f\u5ea6\u4e00\u5b9a\u662f2\u7684\u6b21\u5e42\uff1f \u8ba1\u7b97\u7d22\u5f15\u65f6\u6548\u7387\u66f4\u9ad8\uff1a\u5982\u679c\u662f 2 \u7684 n \u6b21\u5e42\u53ef\u4ee5\u4f7f\u7528\u4f4d\u4e0e\u8fd0\u7b97\u4ee3\u66ff\u53d6\u6a21 \u6269\u5bb9\u65f6\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\u6548\u7387\u66f4\u9ad8\uff1a hash & oldCap == 0 \u7684\u5143\u7d20\u7559\u5728\u539f\u6765\u4f4d\u7f6e \uff0c\u5426\u5219\u65b0\u4f4d\u7f6e = \u65e7\u4f4d\u7f6e + oldCap","title":"3.6 \u9762\u8bd5\u9898-hashMap\u7684\u5bfb\u5740\u7b97\u6cd5"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#37-hashmap17","text":"jdk7\u7684\u7684\u6570\u636e\u7ed3\u6784\u662f\uff1a\u6570\u7ec4+\u94fe\u8868 \u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f\u5934\u63d2\u6cd5\uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u53d8\u91cfe\u6307\u5411\u7684\u662f\u9700\u8981\u8fc1\u79fb\u7684\u5bf9\u8c61 \u53d8\u91cfnext\u6307\u5411\u7684\u662f\u4e0b\u4e00\u4e2a\u9700\u8981\u8fc1\u79fb\u7684\u5bf9\u8c61 Jdk1.7\u4e2d\u7684\u94fe\u8868\u91c7\u7528\u7684\u5934\u63d2\u6cd5 \u5728\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\u5e76\u6ca1\u6709\u65b0\u7684\u5bf9\u8c61\u4ea7\u751f\uff0c\u53ea\u662f\u6539\u53d8\u4e86\u5bf9\u8c61\u7684\u5f15\u7528 \u4ea7\u751f\u6b7b\u5faa\u73af\u7684\u8fc7\u7a0b\uff1a \u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u7684\u53d8\u91cfe\u548cnext\u90fd\u5f15\u7528\u4e86\u8fd9\u4e2a\u4e24\u4e2a\u8282\u70b9 \u7ebf\u7a0b2\u6269\u5bb9\u540e\uff0c\u7531\u4e8e\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u987a\u5e8f\u98a0\u5012\uff0c\u4f46\u662f\u7ebf\u7a0b1\u7684\u4e34\u65f6\u53d8\u91cfe\u548cnext\u8fd8\u5f15\u7528\u4e86\u8fd9\u4e24\u4e2a\u8282\u70b9 \u7b2c\u4e00\u6b21\u5faa\u73af \u7531\u4e8e\u7ebf\u7a0b2\u8fc1\u79fb\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u628aB\u7684next\u6267\u884c\u4e86A \u7b2c\u4e8c\u6b21\u5faa\u73af \u7b2c\u4e09\u6b21\u5faa\u73af \u53c2\u8003\u56de\u7b54\uff1a \u5728jdk1.7\u7684hashmap\u4e2d\u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f\u5934\u63d2\u6cd5\uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u6bd4\u5982\u8bf4\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\u7ebf\u7a0b \u7ebf\u7a0b\u4e00\uff1a\u8bfb\u53d6\u5230\u5f53\u524d\u7684hashmap\u6570\u636e\uff0c\u6570\u636e\u4e2d\u4e00\u4e2a\u94fe\u8868\uff0c\u5728\u51c6\u5907\u6269\u5bb9\u65f6\uff0c\u7ebf\u7a0b\u4e8c\u4ecb\u5165 \u7ebf\u7a0b\u4e8c\uff1a\u4e5f\u8bfb\u53d6hashmap\uff0c\u76f4\u63a5\u8fdb\u884c\u6269\u5bb9\u3002\u56e0\u4e3a\u662f\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u7684\u987a\u5e8f\u4f1a\u8fdb\u884c\u98a0\u5012\u8fc7\u6765\u3002\u6bd4\u5982\u539f\u6765\u7684\u987a\u5e8f\u662fAB\uff0c\u6269\u5bb9\u540e\u7684\u987a\u5e8f\u662fBA\uff0c\u7ebf\u7a0b\u4e8c\u6267\u884c\u7ed3\u675f\u3002 \u7ebf\u7a0b\u4e00\uff1a\u7ee7\u7eed\u6267\u884c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u7ebf\u7a0b\u4e00\u5148\u5c06A\u79fb\u5165\u65b0\u7684\u94fe\u8868\uff0c\u518d\u5c06B\u63d2\u5165\u5230\u94fe\u5934\uff0c\u7531\u4e8e\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u7684\u539f\u56e0\uff0cB\u7684next\u6307\u5411\u4e86A\uff0c \u6240\u4ee5B->A->B,\u5f62\u6210\u5faa\u73af\u3002 \u5f53\u7136\uff0cJDK 8 \u5c06\u6269\u5bb9\u7b97\u6cd5\u505a\u4e86\u8c03\u6574\uff0c\u4e0d\u518d\u5c06\u5143\u7d20\u52a0\u5165\u94fe\u8868\u5934\uff08\u800c\u662f\u4fdd\u6301\u4e0e\u6269\u5bb9\u524d\u4e00\u6837\u7684\u987a\u5e8f\uff09\uff0c \u5c3e\u63d2\u6cd5 \uff0c\u5c31\u907f\u514d\u4e86jdk7\u4e2d\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002","title":"3.7 \u9762\u8bd5\u9898-hashmap\u57281.7\u60c5\u51b5\u4e0b\u7684\u591a\u7ebf\u7a0b\u6b7b\u5faa\u73af\u95ee\u9898"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#38-hashsethashmap","text":"(1)HashSet\u5b9e\u73b0\u4e86Set\u63a5\u53e3, \u4ec5\u5b58\u50a8\u5bf9\u8c61; HashMap\u5b9e\u73b0\u4e86 Map\u63a5\u53e3, \u5b58\u50a8\u7684\u662f\u952e\u503c\u5bf9. (2)HashSet\u5e95\u5c42\u5176\u5b9e\u662f\u7528HashMap\u5b9e\u73b0\u5b58\u50a8\u7684, HashSet\u5c01\u88c5\u4e86\u4e00\u7cfb\u5217HashMap\u7684\u65b9\u6cd5. \u4f9d\u9760HashMap\u6765\u5b58\u50a8\u5143\u7d20\u503c,(\u5229\u7528hashMap\u7684key\u952e\u8fdb\u884c\u5b58\u50a8), \u800cvalue\u503c\u9ed8\u8ba4\u4e3aObject\u5bf9\u8c61. \u6240\u4ee5HashSet\u4e5f\u4e0d\u5141\u8bb8\u51fa\u73b0\u91cd\u590d\u503c, \u5224\u65ad\u6807\u51c6\u548cHashMap\u5224\u65ad\u6807\u51c6\u76f8\u540c, \u4e24\u4e2a\u5143\u7d20\u7684hashCode\u76f8\u7b49\u5e76\u4e14\u901a\u8fc7equals()\u65b9\u6cd5\u8fd4\u56detrue.","title":"3.8 \u9762\u8bd5\u9898-HashSet\u4e0eHashMap\u7684\u533a\u522b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#39-hashtablehashmap","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u4e3b\u8981\u533a\u522b\uff1a \u533a\u522b HashTable HashMap \u6570\u636e\u7ed3\u6784 \u6570\u7ec4+\u94fe\u8868 \u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811 \u662f\u5426\u53ef\u4ee5\u4e3anull Key\u548cvalue\u90fd\u4e0d\u80fd\u4e3anull \u53ef\u4ee5\u4e3anull hash\u7b97\u6cd5 key\u7684hashCode() \u4e8c\u6b21hash \u6269\u5bb9\u65b9\u5f0f \u5f53\u524d\u5bb9\u91cf\u7ffb\u500d +1 \u5f53\u524d\u5bb9\u91cf\u7ffb\u500d \u7ebf\u7a0b\u5b89\u5168 \u540c\u6b65(synchronized)\u7684\uff0c\u7ebf\u7a0b\u5b89\u5168 \u975e\u7ebf\u7a0b\u5b89\u5168 \u5728\u5b9e\u9645\u5f00\u4e2d\u4e0d\u5efa\u8bae\u4f7f\u7528HashTable\uff0c\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u53ef\u4ee5\u4f7f\u7528ConcurrentHashMap\u7c7b","title":"3.9 \u9762\u8bd5\u9898-HashTable\u4e0eHashMap\u7684\u533a\u522b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3","text":"","title":"3 \u771f\u5b9e\u9762\u8bd5\u8fd8\u539f"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#31-java","text":"\u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u8bf4Java\u63d0\u4f9b\u7684\u5e38\u89c1\u96c6\u5408\uff1f\uff08\u753b\u4e00\u4e0b\u96c6\u5408\u7ed3\u6784\u56fe\uff09 \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u597d\u7684\u3002 \u5728java\u4e2d\u63d0\u4f9b\u4e86\u91cf\u5927\u7c7b\u7684\u96c6\u5408\u6846\u67b6\uff0c\u4e3b\u8981\u5206\u4e3a\u4e24\u7c7b\uff1a \u7b2c\u4e00\u4e2a\u662fCollection \u5c5e\u4e8e\u5355\u5217\u96c6\u5408\uff0c\u7b2c\u4e8c\u4e2a\u662fMap \u5c5e\u4e8e\u53cc\u5217\u96c6\u5408 \u5728Collection\u4e2d\u6709\u4e24\u4e2a\u5b50\u63a5\u53e3List\u548cSet\u3002\u5728\u6211\u4eec\u5e73\u5e38\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u7528\u7684\u6bd4\u8f83\u591a\u50cflist\u63a5\u53e3\u4e2d\u7684\u5b9e\u73b0\u7c7bArrarList\u548cLinkedList\u3002 \u5728Set\u63a5\u53e3\u4e2d\u6709\u5b9e\u73b0\u7c7bHashSet\u548cTreeSet\u3002 \u5728map\u63a5\u53e3\u4e2d\u6709\u5f88\u591a\u7684\u5b9e\u73b0\u7c7b\uff0c\u5e73\u65f6\u6bd4\u8f83\u5e38\u89c1\u7684\u662fHashMap\u3001TreeMap\uff0c\u8fd8\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684map:ConcurrentHashMap","title":"3.1 Java\u5e38\u89c1\u7684\u96c6\u5408\u7c7b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#32-list","text":"\u9762\u8bd5\u5b98 \uff1aArrayList\u5e95\u5c42\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u6211\u9605\u8bfb\u8fc7arraylist\u7684\u6e90\u7801\uff0c\u6211\u4e3b\u8981\u8bf4\u4e00\u4e0badd\u65b9\u6cd5\u5427 \u7b2c\u4e00\uff1a\u786e\u4fdd\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6\uff08size\uff09\u52a01\u4e4b\u540e\u8db3\u591f\u5b58\u4e0b\u4e0b\u4e00\u4e2a\u6570\u636e \u7b2c\u4e8c\uff1a\u8ba1\u7b97\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5982\u679c\u5f53\u524d\u6570\u7ec4\u5df2\u4f7f\u7528\u957f\u5ea6+1\u540e\u7684\u5927\u4e8e\u5f53\u524d\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8c03\u7528grow\u65b9\u6cd5\u6269\u5bb9\uff08\u539f\u6765\u76841.5\u500d\uff09 \u7b2c\u4e09\uff1a\u786e\u4fdd\u65b0\u589e\u7684\u6570\u636e\u6709\u5730\u65b9\u5b58\u50a8\u4e4b\u540e\uff0c\u5219\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u4f4d\u4e8esize\u7684\u4f4d\u7f6e\u4e0a\u3002 \u7b2c\u56db\uff1a\u8fd4\u56de\u6dfb\u52a0\u6210\u529f\u5e03\u5c14\u503c\u3002 \u9762\u8bd5\u5b98 \uff1aArrayList list=new ArrayList(10)\u4e2d\u7684list\u6269\u5bb9\u51e0\u6b21 \u5019\u9009\u4eba \uff1a \u200b \u662fnew\u4e86\u4e00\u4e2aArrarList\u5e76\u4e14\u7ed9\u4e86\u4e00\u4e2a\u6784\u9020\u53c2\u657010\uff0c\u5bf9\u5427\uff1f(\u95ee\u9898\u4e00\u5b9a\u8981\u95ee\u6e05\u695a\u518d\u7b54) \u9762\u8bd5\u5b98 \uff1a\u662f\u7684 \u5019\u9009\u4eba \uff1a \u200b \u597d\u7684\uff0c\u5728ArrayList\u7684\u6e90\u7801\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u53c2\u6570\u5c31\u662f\u6307\u5b9a\u7684\u96c6\u5408\u521d\u59cb\u957f\u5ea6\uff0c\u6240\u4ee5\u7ed9\u4e86\u4e00\u4e2a10\u7684\u53c2\u6570\uff0c\u5c31\u662f\u6307\u5b9a\u4e86\u96c6\u5408\u7684\u521d\u59cb\u957f\u5ea6\u662f10\uff0c\u8fd9\u91cc\u9762\u5e76\u6ca1\u6709\u6269\u5bb9\u3002 \u9762\u8bd5\u5b98 \uff1a\u5982\u4f55\u5b9e\u73b0\u6570\u7ec4\u548cList\u4e4b\u95f4\u7684\u8f6c\u6362 \u5019\u9009\u4eba \uff1a \u200b \u55ef\uff0c\u8fd9\u4e2a\u5728\u6211\u4eec\u5e73\u65f6\u5f00\u53d1\u5f88\u5e38\u89c1 \u200b \u6570\u7ec4\u8f6clist\uff0c\u53ef\u4ee5\u4f7f\u7528jdk\u81ea\u52a8\u7684\u4e00\u4e2a\u5de5\u5177\u7c7bArrars\uff0c\u91cc\u9762\u6709\u4e00\u4e2aasList\u65b9\u6cd5\u53ef\u4ee5\u8f6c\u6362\u4e3a\u6570\u7ec4 \u200b List \u8f6c\u6570\u7ec4\uff0c\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528list\u4e2d\u7684toArray\u65b9\u6cd5\uff0c\u9700\u8981\u7ed9\u4e00\u4e2a\u53c2\u6570\uff0c\u6307\u5b9a\u6570\u7ec4\u7684\u7c7b\u578b\uff0c\u9700\u8981\u6307\u5b9a\u6570\u7ec4\u7684\u957f\u5ea6\u3002 \u9762\u8bd5\u5b98 \uff1a\u7528Arrays.asList\u8f6cList\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u5185\u5bb9\uff0clist\u53d7\u5f71\u54cd\u5417\uff1fList\u7528toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86List\u5185\u5bb9\uff0c\u6570\u7ec4\u53d7\u5f71\u54cd\u5417 \u5019\u9009\u4eba \uff1a Arrays.asList\u8f6c\u6362list\u4e4b\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86\u6570\u7ec4\u7684\u5185\u5bb9\uff0clist\u4f1a\u53d7\u5f71\u54cd\uff0c\u56e0\u4e3a\u5b83\u7684\u5e95\u5c42\u4f7f\u7528\u7684Arrays\u7c7b\u4e2d\u7684\u4e00\u4e2a\u5185\u90e8\u7c7bArrayList\u6765\u6784\u9020\u7684\u96c6\u5408\uff0c\u5728\u8fd9\u4e2a\u96c6\u5408\u7684\u6784\u9020\u5668\u4e2d\uff0c\u628a\u6211\u4eec\u4f20\u5165\u7684\u8fd9\u4e2a\u96c6\u5408\u8fdb\u884c\u4e86\u5305\u88c5\u800c\u5df2\uff0c\u6700\u7ec8\u6307\u5411\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u5185\u5b58\u5730\u5740 list\u7528\u4e86toArray\u8f6c\u6570\u7ec4\u540e\uff0c\u5982\u679c\u4fee\u6539\u4e86list\u5185\u5bb9\uff0c\u6570\u7ec4\u4e0d\u4f1a\u5f71\u54cd\uff0c\u5f53\u8c03\u7528\u4e86toArray\u4ee5\u540e\uff0c\u5728\u5e95\u5c42\u662f\u5b83\u662f\u8fdb\u884c\u4e86\u6570\u7ec4\u7684\u62f7\u8d1d\uff0c\u8ddf\u539f\u6765\u7684\u5143\u7d20\u5c31\u6ca1\u5565\u5173\u7cfb\u4e86\uff0c\u6240\u4ee5\u5373\u4f7flist\u4fee\u6539\u4e86\u4ee5\u540e\uff0c\u6570\u7ec4\u4e5f\u4e0d\u53d7\u5f71\u54cd \u9762\u8bd5\u5b98 \uff1aArrayList \u548c LinkedList \u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u5b83\u4eec\u4e24\u4e2a\u4e3b\u8981\u662f\u5e95\u5c42\u4f7f\u7528\u7684\u6570\u636e\u7ed3\u6784\u4e0d\u4e00\u6837\uff0cArrayList \u662f\u52a8\u6001\u6570\u7ec4\uff0cLinkedList \u662f\u53cc\u5411\u94fe\u8868\uff0c\u8fd9\u4e5f\u5bfc\u81f4\u4e86\u5b83\u4eec\u5f88\u591a\u4e0d\u540c\u7684\u7279\u70b9\u3002 1\uff0c\u4ece\u64cd\u4f5c\u6570\u636e\u6548\u7387\u6765\u8bf4 ArrayList\u6309\u7167\u4e0b\u6807\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6O(1)\u3010\u5185\u5b58\u662f\u8fde\u7eed\u7684\uff0c\u6839\u636e\u5bfb\u5740\u516c\u5f0f\u3011\uff0c LinkedList\u4e0d\u652f\u6301\u4e0b\u6807\u67e5\u8be2 \u67e5\u627e\uff08\u672a\u77e5\u7d22\u5f15\uff09\uff1a ArrayList\u9700\u8981\u904d\u5386\uff0c\u94fe\u8868\u4e5f\u9700\u8981\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(n) \u65b0\u589e\u548c\u5220\u9664 ArrayList\u5c3e\u90e8\u63d2\u5165\u548c\u5220\u9664\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff1b\u5176\u4ed6\u90e8\u5206\u589e\u5220\u9700\u8981\u632a\u52a8\u6570\u7ec4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) LinkedList\u5934\u5c3e\u8282\u70b9\u589e\u5220\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff0c\u5176\u4ed6\u90fd\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n) 2\uff0c\u4ece\u5185\u5b58\u7a7a\u95f4\u5360\u7528\u6765\u8bf4 ArrayList\u5e95\u5c42\u662f\u6570\u7ec4\uff0c\u5185\u5b58\u8fde\u7eed\uff0c\u8282\u7701\u5185\u5b58 LinkedList \u662f\u53cc\u5411\u94fe\u8868\u9700\u8981\u5b58\u50a8\u6570\u636e\uff0c\u548c\u4e24\u4e2a\u6307\u9488\uff0c\u66f4\u5360\u7528\u5185\u5b58 3\uff0c\u4ece\u7ebf\u7a0b\u5b89\u5168\u6765\u8bf4\uff0cArrayList\u548cLinkedList\u90fd\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86ArrayList \u548c LinkedList \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u4f60\u4eec\u5728\u9879\u76ee\u4e2d\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u7684\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u4e3b\u8981\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6848\uff1a \u7b2c\u4e00\uff1a\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u96c6\u5408\uff0c\u4f18\u5148\u5728\u65b9\u6cd5\u5185\u4f7f\u7528\uff0c\u5b9a\u4e49\u4e3a\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u51fa\u73b0\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002 \u7b2c\u4e8c\uff1a\u5982\u679c\u975e\u8981\u5728\u6210\u5458\u53d8\u91cf\u4e2d\u4f7f\u7528\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408\u6765\u66ff\u4ee3 ArrayList\u53ef\u4ee5\u901a\u8fc7Collections \u7684 synchronizedList \u65b9\u6cd5\u5c06 ArrayList \u8f6c\u6362\u6210\u7ebf\u7a0b\u5b89\u5168\u7684\u5bb9\u5668\u540e\u518d\u4f7f\u7528\u3002 LinkedList \u6362\u6210ConcurrentLinkedQueue\u6765\u4f7f\u7528","title":"3.2 List"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#34-hashmap","text":"\u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0bHashMap\u7684\u5b9e\u73b0\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u200b \u55ef\u3002\u5b83\u4e3b\u8981\u5206\u4e3a\u4e86\u4e00\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a 1\uff0c\u5e95\u5c42\u4f7f\u7528hash\u8868\u6570\u636e\u7ed3\u6784\uff0c\u5373\u6570\u7ec4+\uff08\u94fe\u8868 | \u7ea2\u9ed1\u6811\uff09 2\uff0c\u6dfb\u52a0\u6570\u636e\u65f6\uff0c\u8ba1\u7b97key\u7684\u503c\u786e\u5b9a\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807 \u200b key\u76f8\u540c\u5219\u66ff\u6362 \u200b \u4e0d\u540c\u5219\u5b58\u5165\u94fe\u8868\u6216\u7ea2\u9ed1\u6811\u4e2d 3\uff0c\u83b7\u53d6\u6570\u636e\u901a\u8fc7key\u7684hash\u8ba1\u7b97\u6570\u7ec4\u4e0b\u6807\u83b7\u53d6\u5143\u7d20 \u9762\u8bd5\u5b98 \uff1aHashMap\u7684jdk1.7\u548cjdk1.8\u6709\u4ec0\u4e48\u533a\u522b \u5019\u9009\u4eba \uff1a JDK1.8\u4e4b\u524d\u91c7\u7528\u7684\u62c9\u94fe\u6cd5\uff0c\u6570\u7ec4+\u94fe\u8868 JDK1.8\u4e4b\u540e\u91c7\u7528\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811\uff0c\u94fe\u8868\u957f\u5ea6\u5927\u4e8e8\u4e14\u6570\u7ec4\u957f\u5ea6\u5927\u4e8e64\u5219\u4f1a\u4ece\u94fe\u8868\u8f6c\u5316\u4e3a\u7ea2\u9ed1\u6811 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u8bf4\u4e0bHashMap\u7684put\u65b9\u6cd5\u7684\u5177\u4f53\u6d41\u7a0b\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\u597d\u7684\u3002 \u5224\u65ad\u952e\u503c\u5bf9\u6570\u7ec4table\u662f\u5426\u4e3a\u7a7a\u6216\u4e3anull\uff0c\u5426\u5219\u6267\u884cresize()\u8fdb\u884c\u6269\u5bb9\uff08\u521d\u59cb\u5316\uff09 \u6839\u636e\u952e\u503ckey\u8ba1\u7b97hash\u503c\u5f97\u5230\u6570\u7ec4\u7d22\u5f15 \u5224\u65adtable[i]==null\uff0c\u6761\u4ef6\u6210\u7acb\uff0c\u76f4\u63a5\u65b0\u5efa\u8282\u70b9\u6dfb\u52a0 \u5982\u679ctable[i]==null ,\u4e0d\u6210\u7acb 4.1 \u5224\u65adtable[i]\u7684\u9996\u4e2a\u5143\u7d20\u662f\u5426\u548ckey\u4e00\u6837\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u8986\u76d6value 4.2 \u5224\u65adtable[i] \u662f\u5426\u4e3atreeNode\uff0c\u5373table[i] \u662f\u5426\u662f\u7ea2\u9ed1\u6811\uff0c\u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u76f4\u63a5\u5728\u6811\u4e2d\u63d2\u5165\u952e\u503c\u5bf9 4.3 \u904d\u5386table[i]\uff0c\u94fe\u8868\u7684\u5c3e\u90e8\u63d2\u5165\u6570\u636e\uff0c\u7136\u540e\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u5426\u5927\u4e8e8\uff0c\u5927\u4e8e8\u7684\u8bdd\u628a\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5728\u7ea2\u9ed1\u6811\u4e2d\u6267\u884c\u63d2\u5165\u64cd \u4f5c\uff0c\u904d\u5386\u8fc7\u7a0b\u4e2d\u82e5\u53d1\u73b0key\u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6value \u63d2\u5165\u6210\u529f\u540e\uff0c\u5224\u65ad\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cfsize\u662f\u5426\u8d85\u591a\u4e86\u6700\u5927\u5bb9\u91cfthreshold\uff08\u6570\u7ec4\u957f\u5ea6*0.75\uff09\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u8fdb\u884c\u6269\u5bb9\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u591a\u6b21\u4ecb\u7ecd\u4e86hsahmap\u7684\u6269\u5bb9\uff0c\u80fd\u8bb2\u4e00\u8bb2HashMap\u7684\u6269\u5bb9\u673a\u5236\u5417\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684 \u5728\u6dfb\u52a0\u5143\u7d20\u6216\u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981\u8c03\u7528resize\u65b9\u6cd5\u8fdb\u884c\u6269\u5bb9\uff0c\u7b2c\u4e00\u6b21\u6dfb\u52a0\u6570\u636e\u521d\u59cb\u5316\u6570\u7ec4\u957f\u5ea6\u4e3a16\uff0c\u4ee5\u540e\u6bcf\u6b21\u6bcf\u6b21\u6269\u5bb9\u90fd\u662f\u8fbe\u5230\u4e86\u6269\u5bb9\u9608\u503c\uff08\u6570\u7ec4\u957f\u5ea6 * 0.75\uff09 \u6bcf\u6b21\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u90fd\u662f\u6269\u5bb9\u4e4b\u524d\u5bb9\u91cf\u76842\u500d\uff1b \u6269\u5bb9\u4e4b\u540e\uff0c\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u9700\u8981\u628a\u8001\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u632a\u52a8\u5230\u65b0\u7684\u6570\u7ec4\u4e2d \u6ca1\u6709hash\u51b2\u7a81\u7684\u8282\u70b9\uff0c\u5219\u76f4\u63a5\u4f7f\u7528 e.hash & (newCap - 1) \u8ba1\u7b97\u65b0\u6570\u7ec4\u7684\u7d22\u5f15\u4f4d\u7f6e \u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u8d70\u7ea2\u9ed1\u6811\u7684\u6dfb\u52a0 \u5982\u679c\u662f\u94fe\u8868\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\uff0c\u53ef\u80fd\u9700\u8981\u62c6\u5206\u94fe\u8868\uff0c\u5224\u65ad(e.hash & oldCap)\u662f\u5426\u4e3a0\uff0c\u8be5\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u505c\u7559\u5728\u539f\u59cb\u4f4d\u7f6e\uff0c\u8981\u4e48\u79fb\u52a8\u5230\u539f\u59cb\u4f4d\u7f6e+\u589e\u52a0\u7684\u6570\u7ec4\u5927\u5c0f\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684\u901a\u8fc7hash\u8ba1\u7b97\u540e\u627e\u5230\u6570\u7ec4\u7684\u4e0b\u6807\uff0c\u662f\u5982\u4f55\u627e\u5230\u7684\u5462\uff0c\u4f60\u4e86\u89e3hashMap\u7684\u5bfb\u5740\u7b97\u6cd5\u5417\uff1f \u5019\u9009\u4eba \uff1a \u8fd9\u4e2a\u54c8\u5e0c\u65b9\u6cd5\u9996\u5148\u8ba1\u7b97\u51fakey\u7684hashCode\u503c\uff0c\u7136\u540e\u901a\u8fc7\u8fd9\u4e2ahash\u503c\u53f3\u79fb16\u4f4d\u540e\u7684\u4e8c\u8fdb\u5236\u8fdb\u884c\u6309\u4f4d \u5f02\u6216\u8fd0\u7b97 \u5f97\u5230\u6700\u540e\u7684hash\u503c\u3002 \u5728putValue\u7684\u65b9\u6cd5\u4e2d\uff0c\u8ba1\u7b97\u6570\u7ec4\u4e0b\u6807\u7684\u65f6\u5019\u4f7f\u7528hash\u503c\u4e0e\u6570\u7ec4\u957f\u5ea6\u53d6\u6a21\u5f97\u5230\u5b58\u50a8\u6570\u636e\u4e0b\u6807\u7684\u4f4d\u7f6e\uff0chashmap\u4e3a\u4e86\u6027\u80fd\u66f4\u597d\uff0c\u5e76\u6ca1\u6709\u76f4\u63a5\u91c7\u7528\u53d6\u6a21\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u6570\u7ec4\u957f\u5ea6-1 \u5f97\u5230\u4e00\u4e2a\u503c\uff0c\u7528\u8fd9\u4e2a\u503c\u6309\u4f4d\u4e0e\u8fd0\u7b97hash\u503c\uff0c\u6700\u7ec8\u5f97\u5230\u6570\u7ec4\u7684\u4f4d\u7f6e\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4f55HashMap\u7684\u6570\u7ec4\u957f\u5ea6\u4e00\u5b9a\u662f2\u7684\u6b21\u5e42\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u597d\u7684\u3002hashmap\u8fd9\u4e48\u8bbe\u8ba1\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u7b2c\u4e00\uff1a \u8ba1\u7b97\u7d22\u5f15\u65f6\u6548\u7387\u66f4\u9ad8\uff1a\u5982\u679c\u662f 2 \u7684 n \u6b21\u5e42\u53ef\u4ee5\u4f7f\u7528\u4f4d\u4e0e\u8fd0\u7b97\u4ee3\u66ff\u53d6\u6a21 \u7b2c\u4e8c\uff1a \u6269\u5bb9\u65f6\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\u6548\u7387\u66f4\u9ad8\uff1a\u5728\u8fdb\u884c\u6269\u5bb9\u662f\u4f1a\u8fdb\u884c\u5224\u65ad hash\u503c\u6309\u4f4d\u4e0e\u8fd0\u7b97\u65e7\u6570\u7ec4\u957f\u79df\u662f\u5426 == 0 \u5982\u679c\u7b49\u4e8e0\uff0c\u5219\u628a\u5143\u7d20\u7559\u5728\u539f\u6765\u4f4d\u7f6e \uff0c\u5426\u5219\u65b0\u4f4d\u7f6e\u662f\u7b49\u4e8e\u65e7\u4f4d\u7f6e\u7684\u4e0b\u6807+\u65e7\u6570\u7ec4\u957f\u5ea6 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u6211\u770b\u4f60\u5bf9hashmap\u4e86\u89e3\u7684\u633a\u6df1\u5165\u7684\uff0c\u4f60\u77e5\u9053hashmap\u57281.7\u60c5\u51b5\u4e0b\u7684\u591a\u7ebf\u7a0b\u6b7b\u5faa\u73af\u95ee\u9898\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u7684\u3002\u662f\u8fd9\u6837 jdk7\u7684\u7684\u6570\u636e\u7ed3\u6784\u662f\uff1a\u6570\u7ec4+\u94fe\u8868 \u5728\u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u94fe\u8868\u662f \u5934\u63d2\u6cd5 \uff0c\u5728\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6b7b\u5faa\u73af \u6bd4\u5982\u8bf4\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\u7ebf\u7a0b \u7ebf\u7a0b\u4e00\uff1a \u8bfb\u53d6 \u5230\u5f53\u524d\u7684hashmap\u6570\u636e\uff0c\u6570\u636e\u4e2d\u4e00\u4e2a\u94fe\u8868\uff0c\u5728\u51c6\u5907\u6269\u5bb9\u65f6\uff0c\u7ebf\u7a0b\u4e8c\u4ecb\u5165 \u7ebf\u7a0b\u4e8c\u4e5f\u8bfb\u53d6hashmap\uff0c\u76f4\u63a5\u8fdb\u884c\u6269\u5bb9\u3002\u56e0\u4e3a\u662f\u5934\u63d2\u6cd5\uff0c\u94fe\u8868\u7684\u987a\u5e8f\u4f1a\u8fdb\u884c\u98a0\u5012\u8fc7\u6765\u3002\u6bd4\u5982\u539f\u6765\u7684\u987a\u5e8f\u662fAB\uff0c\u6269\u5bb9\u540e\u7684\u987a\u5e8f\u662fBA\uff0c\u7ebf\u7a0b\u4e8c\u6267\u884c\u7ed3\u675f\u3002 \u5f53\u7ebf\u7a0b\u4e00\u518d\u7ee7\u7eed\u6267\u884c\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u7ebf\u7a0b\u4e00\u5148\u5c06A\u79fb\u5165\u65b0\u7684\u94fe\u8868\uff0c\u518d\u5c06B\u63d2\u5165\u5230\u94fe\u5934\uff0c\u7531\u4e8e\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u7684\u539f\u56e0\uff0cB\u7684next\u6307\u5411\u4e86A\uff0c\u6240\u4ee5B->A->B,\u5f62\u6210\u5faa\u73af\u3002 \u5f53\u7136\uff0cJDK 8 \u5c06\u6269\u5bb9\u7b97\u6cd5\u505a\u4e86\u8c03\u6574\uff0c\u4e0d\u518d\u5c06\u5143\u7d20\u52a0\u5165\u94fe\u8868\u5934\uff08\u800c\u662f\u4fdd\u6301\u4e0e\u6269\u5bb9\u524d\u4e00\u6837\u7684\u987a\u5e8f\uff09\uff0c \u5c3e\u63d2\u6cd5 \uff0c\u5c31\u907f\u514d\u4e86jdk7\u4e2d\u6b7b\u5faa\u73af\u7684\u95ee\u9898\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0chashmap\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f \u5019\u9009\u4eba \uff1a\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u9762\u8bd5\u5b98 \uff1a\u90a3\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684map\u8be5\u600e\u4e48\u505a\u5462\uff1f \u5019\u9009\u4eba \uff1a\u6211\u4eec\u53ef\u4ee5\u91c7\u7528ConcurrentHashMap\u8fdb\u884c\u4f7f\u7528\uff0c\u5b83\u662f\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684HashMap \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u80fd\u804a\u4e00\u4e0bConcurrentHashMap\u7684\u539f\u7406\u5417\uff1f \u5019\u9009\u4eba \uff1a\u597d\u7684\uff0c\u8bf7\u53c2\u8003\u300a\u591a\u7ebf\u7a0b\u76f8\u5173\u9762\u8bd5\u9898\u300b\u4e2d\u7684ConcurrentHashMap\u90e8\u5206\u7684\u8bb2\u89e3 \u9762\u8bd5\u5b98 \uff1aHashSet\u4e0eHashMap\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba \uff1a\u55ef\uff0c\u662f\u8fd9\u6837\u3002 HashSet\u5e95\u5c42\u5176\u5b9e\u662f\u7528HashMap\u5b9e\u73b0\u5b58\u50a8\u7684, HashSet\u5c01\u88c5\u4e86\u4e00\u7cfb\u5217HashMap\u7684\u65b9\u6cd5. \u4f9d\u9760HashMap\u6765\u5b58\u50a8\u5143\u7d20\u503c,(\u5229\u7528hashMap\u7684key\u952e\u8fdb\u884c\u5b58\u50a8), \u800cvalue\u503c\u9ed8\u8ba4\u4e3aObject\u5bf9\u8c61. \u6240\u4ee5HashSet\u4e5f\u4e0d\u5141\u8bb8\u51fa\u73b0\u91cd\u590d\u503c, \u5224\u65ad\u6807\u51c6\u548cHashMap\u5224\u65ad\u6807\u51c6\u76f8\u540c, \u4e24\u4e2a\u5143\u7d20\u7684hashCode\u76f8\u7b49\u5e76\u4e14\u901a\u8fc7equals()\u65b9\u6cd5\u8fd4\u56detrue. \u9762\u8bd5\u5b98 \uff1aHashTable\u4e0eHashMap\u7684\u533a\u522b \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u4ed6\u4eec\u7684\u4e3b\u8981\u533a\u522b\u662f\u6709\u51e0\u4e2a\u5427 \u7b2c\u4e00\uff0c\u6570\u636e\u7ed3\u6784\u4e0d\u4e00\u6837\uff0chashtable\u662f\u6570\u7ec4+\u94fe\u8868\uff0chashmap\u57281.8\u4e4b\u540e\u6539\u4e3a\u4e86\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811 \u7b2c\u4e8c\uff0chashtable\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u90fd\u4e0d\u80fd\u4e3anull\uff0c\u800chashmap\u662f\u53ef\u4ee5\u7684 \u7b2c\u4e09\uff0chash\u7b97\u6cd5\u4e0d\u540c\uff0chashtable\u662f\u7528\u672c\u5730\u4fee\u9970\u7684hashcode\u503c\uff0c\u800chashmap\u7ecf\u5e38\u4e86\u4e8c\u6b21hash \u7b2c\u56db\uff0c\u6269\u5bb9\u65b9\u5f0f\u4e0d\u540c\uff0chashtable\u662f\u5f53\u524d\u5bb9\u91cf\u7ffb\u500d+1\uff0chashmap\u662f\u5f53\u524d\u5bb9\u91cf\u7ffb\u500d \u7b2c\u4e94\uff0chashtable\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u64cd\u4f5c\u6570\u636e\u7684\u65f6\u5019\u52a0\u4e86\u9501synchronized\uff0chashmap\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6548\u7387\u66f4\u9ad8\u4e00\u4e9b \u5728\u5b9e\u9645\u5f00\u4e2d\u4e0d\u5efa\u8bae\u4f7f\u7528HashTable\uff0c\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u53ef\u4ee5\u4f7f\u7528ConcurrentHashMap\u7c7b","title":"3.4 HashMap"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/hashmap%E6%BA%90%E7%A0%81/","text":"HashMap\u6e90\u7801 1 put\u65b9\u6cd5\u6d41\u7a0b public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node<K,V>[] tab; Node<K,V> p; int n, i; //\u5224\u65ad\u6570\u7ec4\u662f\u5426\u672a\u521d\u59cb\u5316 if ((tab = table) == null || (n = tab.length) == 0) //\u5982\u679c\u672a\u521d\u59cb\u5316\uff0c\u8c03\u7528resize\u65b9\u6cd5 \u8fdb\u884c\u521d\u59cb\u5316 n = (tab = resize()).length; //\u901a\u8fc7 & \u8fd0\u7b97\u6c42\u51fa\u8be5\u6570\u636e\uff08key\uff09\u7684\u6570\u7ec4\u4e0b\u6807\u5e76\u5224\u65ad\u8be5\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u6570\u636e if ((p = tab[i = (n - 1) & hash]) == null) //\u5982\u679c\u6ca1\u6709\uff0c\u76f4\u63a5\u5c06\u6570\u636e\u653e\u5728\u8be5\u4e0b\u6807\u4f4d\u7f6e tab[i] = newNode(hash, key, value, null); //\u8be5\u6570\u7ec4\u4e0b\u6807\u6709\u6570\u636e\u7684\u60c5\u51b5 else { Node<K,V> e; K k; //\u5224\u65ad\u8be5\u4f4d\u7f6e\u6570\u636e\u7684key\u548c\u65b0\u6765\u7684\u6570\u636e\u662f\u5426\u4e00\u6837 if (p.hash == hash && ((k = p.key) == key || (key != null && key.equals(k)))) //\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c\uff0c\u8be5\u8282\u70b9\u7684\u6570\u636e\u8d4b\u503c\u7ed9e,\u540e\u8fb9\u4f1a\u7528\u5230 e = p; //\u5224\u65ad\u662f\u4e0d\u662f\u7ea2\u9ed1\u6811 else if (p instanceof TreeNode) //\u5982\u679c\u662f\u7ea2\u9ed1\u6811\u7684\u8bdd\uff0c\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value); //\u65b0\u6570\u636e\u548c\u5f53\u524d\u6570\u7ec4\u65e2\u4e0d\u76f8\u540c\uff0c\u4e5f\u4e0d\u662f\u7ea2\u9ed1\u6811\u8282\u70b9\uff0c\u8bc1\u660e\u662f\u94fe\u8868 else { //\u904d\u5386\u94fe\u8868 for (int binCount = 0; ; ++binCount) { //\u5224\u65adnext\u8282\u70b9\uff0c\u5982\u679c\u4e3a\u7a7a\u7684\u8bdd\uff0c\u8bc1\u660e\u904d\u5386\u5230\u94fe\u8868\u5c3e\u90e8\u4e86 if ((e = p.next) == null) { //\u628a\u65b0\u503c\u653e\u5165\u94fe\u8868\u5c3e\u90e8 p.next = newNode(hash, key, value, null); //\u56e0\u4e3a\u65b0\u63d2\u5165\u4e86\u4e00\u6761\u6570\u636e\uff0c\u6240\u4ee5\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u4e0d\u662f\u5927\u4e8e\u7b49\u4e8e8 if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st //\u5982\u679c\u662f\uff0c\u8fdb\u884c\u8f6c\u6362\u7ea2\u9ed1\u6811\u64cd\u4f5c treeifyBin(tab, hash); break; } //\u5224\u65ad\u94fe\u8868\u5f53\u4e2d\u6709\u6570\u636e\u76f8\u540c\u7684\u503c\uff0c\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) break; //\u628a\u4e0b\u4e00\u4e2a\u8282\u70b9\u8d4b\u503c\u4e3a\u5f53\u524d\u8282\u70b9 p = e; } } //\u5224\u65ade\u662f\u5426\u4e3a\u7a7a\uff08e\u503c\u4e3a\u4fee\u6539\u64cd\u4f5c\u5b58\u653e\u539f\u6570\u636e\u7684\u53d8\u91cf\uff09 if (e != null) { // existing mapping for key //\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8bc1\u660e\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u53d6\u51fa\u8001\u503c V oldValue = e.value; //\u4e00\u5b9a\u4f1a\u6267\u884c onlyIfAbsent\u4f20\u8fdb\u6765\u7684\u662ffalse if (!onlyIfAbsent || oldValue == null) //\u5c06\u65b0\u503c\u8d4b\u503c\u5f53\u524d\u8282\u70b9 e.value = value; afterNodeAccess(e); //\u8fd4\u56de\u8001\u503c return oldValue; } } //\u8ba1\u6570\u5668\uff0c\u8ba1\u7b97\u5f53\u524d\u8282\u70b9\u7684\u4fee\u6539\u6b21\u6570 ++modCount; //\u5f53\u524d\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u6570\u91cf\u5982\u679c\u5927\u4e8e\u6269\u5bb9\u9608\u503c if (++size > threshold) //\u8fdb\u884c\u6269\u5bb9\u64cd\u4f5c resize(); //\u7a7a\u65b9\u6cd5 afterNodeInsertion(evict); //\u6dfb\u52a0\u64cd\u4f5c\u65f6 \u8fd4\u56de\u7a7a\u503c return null; } 2 \u6269\u5bb9 //\u6269\u5bb9\u3001\u521d\u59cb\u5316\u6570\u7ec4 final Node<K,V>[] resize() { Node<K,V>[] oldTab = table; //\u5982\u679c\u5f53\u524d\u6570\u7ec4\u4e3anull\u7684\u65f6\u5019\uff0c\u628aoldCap\u8001\u6570\u7ec4\u5bb9\u91cf\u8bbe\u7f6e\u4e3a0 int oldCap = (oldTab == null) ? 0 : oldTab.length; //\u8001\u7684\u6269\u5bb9\u9608\u503c int oldThr = threshold; int newCap, newThr = 0; //\u5224\u65ad\u6570\u7ec4\u5bb9\u91cf\u662f\u5426\u5927\u4e8e0\uff0c\u5927\u4e8e0\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u521d\u59cb\u5316 if (oldCap > 0) { //\u5224\u65ad\u5f53\u524d\u6570\u7ec4\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6700\u5927\u6570\u7ec4\u957f\u5ea6 if (oldCap >= MAXIMUM_CAPACITY) { //\u5982\u679c\u662f\uff0c\u5c06\u6269\u5bb9\u9608\u503c\u76f4\u63a5\u8bbe\u7f6e\u4e3aint\u7c7b\u578b\u7684\u6700\u5927\u6570\u503c\u5e76\u76f4\u63a5\u8fd4\u56de threshold = Integer.MAX_VALUE; return oldTab; } //\u5982\u679c\u5728\u6700\u5927\u957f\u5ea6\u8303\u56f4\u5185\uff0c\u5219\u9700\u8981\u6269\u5bb9 OldCap << 1\u7b49\u4ef7\u4e8eoldCap*2 //\u8fd0\u7b97\u8fc7\u540e\u5224\u65ad\u662f\u4e0d\u662f\u6700\u5927\u503c\u5e76\u4e14oldCap\u9700\u8981\u5927\u4e8e16 else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY && oldCap >= DEFAULT_INITIAL_CAPACITY) newThr = oldThr << 1; // double threshold \u7b49\u4ef7\u4e8eoldThr*2 } //\u5982\u679coldCap<0\uff0c\u4f46\u662f\u5df2\u7ecf\u521d\u59cb\u5316\u4e86\uff0c\u50cf\u628a\u5143\u7d20\u5220\u9664\u5b8c\u4e4b\u540e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5b83\u7684\u4e34\u754c\u503c\u80af\u5b9a\u8fd8\u5b58\u5728\uff0c \u5982\u679c\u662f\u9996\u6b21\u521d\u59cb\u5316\uff0c\u5b83\u7684\u4e34\u754c\u503c\u5219\u4e3a0 else if (oldThr > 0) // initial capacity was placed in threshold newCap = oldThr; //\u6570\u7ec4\u672a\u521d\u59cb\u5316\u7684\u60c5\u51b5\uff0c\u5c06\u9608\u503c\u548c\u6269\u5bb9\u56e0\u5b50\u90fd\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } //\u521d\u59cb\u5316\u5bb9\u91cf\u5c0f\u4e8e16\u7684\u65f6\u5019\uff0c\u6269\u5bb9\u9608\u503c\u662f\u6ca1\u6709\u8d4b\u503c\u7684 if (newThr == 0) { //\u521b\u5efa\u9608\u503c float ft = (float)newCap * loadFactor; //\u5224\u65ad\u65b0\u5bb9\u91cf\u548c\u65b0\u9608\u503c\u662f\u5426\u5927\u4e8e\u6700\u5927\u5bb9\u91cf newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } //\u8ba1\u7b97\u51fa\u6765\u7684\u9608\u503c\u8d4b\u503c threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) //\u6839\u636e\u4e0a\u8fb9\u8ba1\u7b97\u5f97\u51fa\u7684\u5bb9\u91cf \u521b\u5efa\u65b0\u7684\u6570\u7ec4 Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap]; //\u8d4b\u503c table = newTab; //\u6269\u5bb9\u64cd\u4f5c\uff0c\u5224\u65ad\u4e0d\u4e3a\u7a7a\u8bc1\u660e\u4e0d\u662f\u521d\u59cb\u5316\u6570\u7ec4 if (oldTab != null) { //\u904d\u5386\u6570\u7ec4 for (int j = 0; j < oldCap; ++j) { Node<K,V> e; //\u5224\u65ad\u5f53\u524d\u4e0b\u6807\u4e3aj\u7684\u6570\u7ec4\u5982\u679c\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8d4b\u503c\u4e2ae\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c if ((e = oldTab[j]) != null) { //\u5c06\u6570\u7ec4\u4f4d\u7f6e\u7f6e\u7a7a oldTab[j] = null; //\u5224\u65ad\u662f\u5426\u6709\u4e0b\u4e2a\u8282\u70b9 if (e.next == null) //\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u91cd\u65b0\u8ba1\u7b97\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5e76\u653e\u8fdb\u53bb newTab[e.hash & (newCap - 1)] = e; //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6811\u5316 else if (e instanceof TreeNode) //\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c ((TreeNode<K,V>)e).split(this, newTab, j, oldCap); //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u6ca1\u6709\u6811\u5316\uff08\u94fe\u8868\u5f62\u5f0f\uff09 else { //\u6bd4\u5982\u8001\u6570\u7ec4\u5bb9\u91cf\u662f16\uff0c\u90a3\u4e0b\u6807\u5c31\u4e3a0-15 //\u6269\u5bb9\u64cd\u4f5c*2\uff0c\u5bb9\u91cf\u5c31\u53d8\u4e3a32\uff0c\u4e0b\u6807\u4e3a0-31 //\u4f4e\u4f4d\uff1a0-15\uff0c\u9ad8\u4f4d16-31 //\u5b9a\u4e49\u4e86\u56db\u4e2a\u53d8\u91cf // \u4f4e\u4f4d\u5934 \u4f4e\u4f4d\u5c3e Node<K,V> loHead = null, loTail = null; // \u9ad8\u4f4d\u5934 \u9ad8\u4f4d\u5c3e Node<K,V> hiHead = null, hiTail = null; //\u4e0b\u4e2a\u8282\u70b9 Node<K,V> next; //\u5faa\u73af\u904d\u5386 do { //\u53d6\u51fanext\u8282\u70b9 next = e.next; //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e3a0 if ((e.hash & oldCap) == 0) { //\u5982\u679c\u4f4e\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (loTail == null) //\u5c06e\u503c\u653e\u5165\u4f4e\u4f4d\u5934 loHead = e; //\u4f4e\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 loTail.next = e; //\u8bb0\u5f55\u4f4e\u4f4d\u5c3e\u6570\u636e loTail = e; } //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e0d\u4e3a0 else { //\u5982\u679c\u9ad8\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (hiTail == null) //\u5c06e\u503c\u653e\u5165\u9ad8\u4f4d\u5934 hiHead = e; //\u9ad8\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 hiTail.next = e; //\u8bb0\u5f55\u9ad8\u4f4d\u5c3e\u6570\u636e hiTail = e; } } //\u5982\u679ce\u4e0d\u4e3a\u7a7a\uff0c\u8bc1\u660e\u6ca1\u6709\u5230\u94fe\u8868\u5c3e\u90e8\uff0c\u7ee7\u7eed\u6267\u884c\u5faa\u73af while ((e = next) != null); //\u4f4e\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (loTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a loTail.next = null; //\u5c06\u4f4e\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684\u539f\u4e0b\u6807\u4f4d\u7f6e newTab[j] = loHead; } //\u9ad8\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (hiTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a hiTail.next = null; //\u5c06\u9ad8\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684(\u539f\u4e0b\u6807+\u539f\u6570\u7ec4\u5bb9\u91cf)\u4f4d\u7f6e newTab[j + oldCap] = hiHead; } } } } } //\u8fd4\u56de\u65b0\u7684\u6570\u7ec4\u5bf9\u8c61 return newTab; } 3 get\u65b9\u6cd5 public V get(Object key) { Node<K,V> e; //hash(key)\uff0c\u83b7\u53d6key\u7684hash\u503c //\u8c03\u7528getNode\u65b9\u6cd5\uff0c\u89c1\u4e0b\u9762\u65b9\u6cd5 return (e = getNode(hash(key), key)) == null ? null : e.value; } final Node<K,V> getNode(int hash, Object key) { Node<K,V>[] tab; Node<K,V> first, e; int n; K k; //\u627e\u5230key\u5bf9\u5e94\u7684\u6876\u4e0b\u6807\uff0c\u8d4b\u503c\u7ed9first\u8282\u70b9 if ((tab = table) != null && (n = tab.length) > 0 && (first = tab[(n - 1) & hash]) != null) { //\u5224\u65adhash\u503c\u548ckey\u662f\u5426\u76f8\u7b49\uff0c\u5982\u679c\u662f\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u6876\u4e2d\u53ea\u6709\u4e00\u4e2a\u6570\u636e\uff08\u5927\u90e8\u5206\u7684\u60c5\u51b5\uff09 if (first.hash == hash && // always check first node ((k = first.key) == key || (key != null && key.equals(k)))) return first; if ((e = first.next) != null) { //\u8be5\u8282\u70b9\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u9700\u8981\u901a\u8fc7\u7ea2\u9ed1\u6811\u67e5\u627e\u6570\u636e if (first instanceof TreeNode) return ((TreeNode<K,V>)first).getTreeNode(hash, key); //\u94fe\u8868\u7684\u60c5\u51b5\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\u67e5\u627e\u6570\u636e do { if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) return e; } while ((e = e.next) != null); } } return null; }","title":"HashMap\u6e90\u7801"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/hashmap%E6%BA%90%E7%A0%81/#hashmap","text":"","title":"HashMap\u6e90\u7801"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/hashmap%E6%BA%90%E7%A0%81/#1-put","text":"public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node<K,V>[] tab; Node<K,V> p; int n, i; //\u5224\u65ad\u6570\u7ec4\u662f\u5426\u672a\u521d\u59cb\u5316 if ((tab = table) == null || (n = tab.length) == 0) //\u5982\u679c\u672a\u521d\u59cb\u5316\uff0c\u8c03\u7528resize\u65b9\u6cd5 \u8fdb\u884c\u521d\u59cb\u5316 n = (tab = resize()).length; //\u901a\u8fc7 & \u8fd0\u7b97\u6c42\u51fa\u8be5\u6570\u636e\uff08key\uff09\u7684\u6570\u7ec4\u4e0b\u6807\u5e76\u5224\u65ad\u8be5\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u6570\u636e if ((p = tab[i = (n - 1) & hash]) == null) //\u5982\u679c\u6ca1\u6709\uff0c\u76f4\u63a5\u5c06\u6570\u636e\u653e\u5728\u8be5\u4e0b\u6807\u4f4d\u7f6e tab[i] = newNode(hash, key, value, null); //\u8be5\u6570\u7ec4\u4e0b\u6807\u6709\u6570\u636e\u7684\u60c5\u51b5 else { Node<K,V> e; K k; //\u5224\u65ad\u8be5\u4f4d\u7f6e\u6570\u636e\u7684key\u548c\u65b0\u6765\u7684\u6570\u636e\u662f\u5426\u4e00\u6837 if (p.hash == hash && ((k = p.key) == key || (key != null && key.equals(k)))) //\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c\uff0c\u8be5\u8282\u70b9\u7684\u6570\u636e\u8d4b\u503c\u7ed9e,\u540e\u8fb9\u4f1a\u7528\u5230 e = p; //\u5224\u65ad\u662f\u4e0d\u662f\u7ea2\u9ed1\u6811 else if (p instanceof TreeNode) //\u5982\u679c\u662f\u7ea2\u9ed1\u6811\u7684\u8bdd\uff0c\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value); //\u65b0\u6570\u636e\u548c\u5f53\u524d\u6570\u7ec4\u65e2\u4e0d\u76f8\u540c\uff0c\u4e5f\u4e0d\u662f\u7ea2\u9ed1\u6811\u8282\u70b9\uff0c\u8bc1\u660e\u662f\u94fe\u8868 else { //\u904d\u5386\u94fe\u8868 for (int binCount = 0; ; ++binCount) { //\u5224\u65adnext\u8282\u70b9\uff0c\u5982\u679c\u4e3a\u7a7a\u7684\u8bdd\uff0c\u8bc1\u660e\u904d\u5386\u5230\u94fe\u8868\u5c3e\u90e8\u4e86 if ((e = p.next) == null) { //\u628a\u65b0\u503c\u653e\u5165\u94fe\u8868\u5c3e\u90e8 p.next = newNode(hash, key, value, null); //\u56e0\u4e3a\u65b0\u63d2\u5165\u4e86\u4e00\u6761\u6570\u636e\uff0c\u6240\u4ee5\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u4e0d\u662f\u5927\u4e8e\u7b49\u4e8e8 if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st //\u5982\u679c\u662f\uff0c\u8fdb\u884c\u8f6c\u6362\u7ea2\u9ed1\u6811\u64cd\u4f5c treeifyBin(tab, hash); break; } //\u5224\u65ad\u94fe\u8868\u5f53\u4e2d\u6709\u6570\u636e\u76f8\u540c\u7684\u503c\uff0c\u5982\u679c\u4e00\u6837\uff0c\u8bc1\u660e\u4e3a\u4fee\u6539\u64cd\u4f5c if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) break; //\u628a\u4e0b\u4e00\u4e2a\u8282\u70b9\u8d4b\u503c\u4e3a\u5f53\u524d\u8282\u70b9 p = e; } } //\u5224\u65ade\u662f\u5426\u4e3a\u7a7a\uff08e\u503c\u4e3a\u4fee\u6539\u64cd\u4f5c\u5b58\u653e\u539f\u6570\u636e\u7684\u53d8\u91cf\uff09 if (e != null) { // existing mapping for key //\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8bc1\u660e\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u53d6\u51fa\u8001\u503c V oldValue = e.value; //\u4e00\u5b9a\u4f1a\u6267\u884c onlyIfAbsent\u4f20\u8fdb\u6765\u7684\u662ffalse if (!onlyIfAbsent || oldValue == null) //\u5c06\u65b0\u503c\u8d4b\u503c\u5f53\u524d\u8282\u70b9 e.value = value; afterNodeAccess(e); //\u8fd4\u56de\u8001\u503c return oldValue; } } //\u8ba1\u6570\u5668\uff0c\u8ba1\u7b97\u5f53\u524d\u8282\u70b9\u7684\u4fee\u6539\u6b21\u6570 ++modCount; //\u5f53\u524d\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u6570\u91cf\u5982\u679c\u5927\u4e8e\u6269\u5bb9\u9608\u503c if (++size > threshold) //\u8fdb\u884c\u6269\u5bb9\u64cd\u4f5c resize(); //\u7a7a\u65b9\u6cd5 afterNodeInsertion(evict); //\u6dfb\u52a0\u64cd\u4f5c\u65f6 \u8fd4\u56de\u7a7a\u503c return null; }","title":"1 put\u65b9\u6cd5\u6d41\u7a0b"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/hashmap%E6%BA%90%E7%A0%81/#2","text":"//\u6269\u5bb9\u3001\u521d\u59cb\u5316\u6570\u7ec4 final Node<K,V>[] resize() { Node<K,V>[] oldTab = table; //\u5982\u679c\u5f53\u524d\u6570\u7ec4\u4e3anull\u7684\u65f6\u5019\uff0c\u628aoldCap\u8001\u6570\u7ec4\u5bb9\u91cf\u8bbe\u7f6e\u4e3a0 int oldCap = (oldTab == null) ? 0 : oldTab.length; //\u8001\u7684\u6269\u5bb9\u9608\u503c int oldThr = threshold; int newCap, newThr = 0; //\u5224\u65ad\u6570\u7ec4\u5bb9\u91cf\u662f\u5426\u5927\u4e8e0\uff0c\u5927\u4e8e0\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u521d\u59cb\u5316 if (oldCap > 0) { //\u5224\u65ad\u5f53\u524d\u6570\u7ec4\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6700\u5927\u6570\u7ec4\u957f\u5ea6 if (oldCap >= MAXIMUM_CAPACITY) { //\u5982\u679c\u662f\uff0c\u5c06\u6269\u5bb9\u9608\u503c\u76f4\u63a5\u8bbe\u7f6e\u4e3aint\u7c7b\u578b\u7684\u6700\u5927\u6570\u503c\u5e76\u76f4\u63a5\u8fd4\u56de threshold = Integer.MAX_VALUE; return oldTab; } //\u5982\u679c\u5728\u6700\u5927\u957f\u5ea6\u8303\u56f4\u5185\uff0c\u5219\u9700\u8981\u6269\u5bb9 OldCap << 1\u7b49\u4ef7\u4e8eoldCap*2 //\u8fd0\u7b97\u8fc7\u540e\u5224\u65ad\u662f\u4e0d\u662f\u6700\u5927\u503c\u5e76\u4e14oldCap\u9700\u8981\u5927\u4e8e16 else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY && oldCap >= DEFAULT_INITIAL_CAPACITY) newThr = oldThr << 1; // double threshold \u7b49\u4ef7\u4e8eoldThr*2 } //\u5982\u679coldCap<0\uff0c\u4f46\u662f\u5df2\u7ecf\u521d\u59cb\u5316\u4e86\uff0c\u50cf\u628a\u5143\u7d20\u5220\u9664\u5b8c\u4e4b\u540e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5b83\u7684\u4e34\u754c\u503c\u80af\u5b9a\u8fd8\u5b58\u5728\uff0c \u5982\u679c\u662f\u9996\u6b21\u521d\u59cb\u5316\uff0c\u5b83\u7684\u4e34\u754c\u503c\u5219\u4e3a0 else if (oldThr > 0) // initial capacity was placed in threshold newCap = oldThr; //\u6570\u7ec4\u672a\u521d\u59cb\u5316\u7684\u60c5\u51b5\uff0c\u5c06\u9608\u503c\u548c\u6269\u5bb9\u56e0\u5b50\u90fd\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } //\u521d\u59cb\u5316\u5bb9\u91cf\u5c0f\u4e8e16\u7684\u65f6\u5019\uff0c\u6269\u5bb9\u9608\u503c\u662f\u6ca1\u6709\u8d4b\u503c\u7684 if (newThr == 0) { //\u521b\u5efa\u9608\u503c float ft = (float)newCap * loadFactor; //\u5224\u65ad\u65b0\u5bb9\u91cf\u548c\u65b0\u9608\u503c\u662f\u5426\u5927\u4e8e\u6700\u5927\u5bb9\u91cf newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } //\u8ba1\u7b97\u51fa\u6765\u7684\u9608\u503c\u8d4b\u503c threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) //\u6839\u636e\u4e0a\u8fb9\u8ba1\u7b97\u5f97\u51fa\u7684\u5bb9\u91cf \u521b\u5efa\u65b0\u7684\u6570\u7ec4 Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap]; //\u8d4b\u503c table = newTab; //\u6269\u5bb9\u64cd\u4f5c\uff0c\u5224\u65ad\u4e0d\u4e3a\u7a7a\u8bc1\u660e\u4e0d\u662f\u521d\u59cb\u5316\u6570\u7ec4 if (oldTab != null) { //\u904d\u5386\u6570\u7ec4 for (int j = 0; j < oldCap; ++j) { Node<K,V> e; //\u5224\u65ad\u5f53\u524d\u4e0b\u6807\u4e3aj\u7684\u6570\u7ec4\u5982\u679c\u4e0d\u4e3a\u7a7a\u7684\u8bdd\u8d4b\u503c\u4e2ae\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c if ((e = oldTab[j]) != null) { //\u5c06\u6570\u7ec4\u4f4d\u7f6e\u7f6e\u7a7a oldTab[j] = null; //\u5224\u65ad\u662f\u5426\u6709\u4e0b\u4e2a\u8282\u70b9 if (e.next == null) //\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u91cd\u65b0\u8ba1\u7b97\u5728\u65b0\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5e76\u653e\u8fdb\u53bb newTab[e.hash & (newCap - 1)] = e; //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6811\u5316 else if (e instanceof TreeNode) //\u8fdb\u884c\u7ea2\u9ed1\u6811\u7684\u64cd\u4f5c ((TreeNode<K,V>)e).split(this, newTab, j, oldCap); //\u6709\u4e0b\u4e2a\u8282\u70b9\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u6ca1\u6709\u6811\u5316\uff08\u94fe\u8868\u5f62\u5f0f\uff09 else { //\u6bd4\u5982\u8001\u6570\u7ec4\u5bb9\u91cf\u662f16\uff0c\u90a3\u4e0b\u6807\u5c31\u4e3a0-15 //\u6269\u5bb9\u64cd\u4f5c*2\uff0c\u5bb9\u91cf\u5c31\u53d8\u4e3a32\uff0c\u4e0b\u6807\u4e3a0-31 //\u4f4e\u4f4d\uff1a0-15\uff0c\u9ad8\u4f4d16-31 //\u5b9a\u4e49\u4e86\u56db\u4e2a\u53d8\u91cf // \u4f4e\u4f4d\u5934 \u4f4e\u4f4d\u5c3e Node<K,V> loHead = null, loTail = null; // \u9ad8\u4f4d\u5934 \u9ad8\u4f4d\u5c3e Node<K,V> hiHead = null, hiTail = null; //\u4e0b\u4e2a\u8282\u70b9 Node<K,V> next; //\u5faa\u73af\u904d\u5386 do { //\u53d6\u51fanext\u8282\u70b9 next = e.next; //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e3a0 if ((e.hash & oldCap) == 0) { //\u5982\u679c\u4f4e\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (loTail == null) //\u5c06e\u503c\u653e\u5165\u4f4e\u4f4d\u5934 loHead = e; //\u4f4e\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 loTail.next = e; //\u8bb0\u5f55\u4f4e\u4f4d\u5c3e\u6570\u636e loTail = e; } //\u901a\u8fc7 \u4e0e\u64cd\u4f5c \u8ba1\u7b97\u5f97\u51fa\u7ed3\u679c\u4e0d\u4e3a0 else { //\u5982\u679c\u9ad8\u4f4d\u5c3e\u4e3anull\uff0c\u8bc1\u660e\u5f53\u524d\u6570\u7ec4\u4f4d\u7f6e\u4e3a\u7a7a\uff0c\u6ca1\u6709\u4efb\u4f55\u6570\u636e if (hiTail == null) //\u5c06e\u503c\u653e\u5165\u9ad8\u4f4d\u5934 hiHead = e; //\u9ad8\u4f4d\u5c3e\u4e0d\u4e3anull\uff0c\u8bc1\u660e\u5df2\u7ecf\u6709\u6570\u636e\u4e86 else //\u5c06\u6570\u636e\u653e\u5165next\u8282\u70b9 hiTail.next = e; //\u8bb0\u5f55\u9ad8\u4f4d\u5c3e\u6570\u636e hiTail = e; } } //\u5982\u679ce\u4e0d\u4e3a\u7a7a\uff0c\u8bc1\u660e\u6ca1\u6709\u5230\u94fe\u8868\u5c3e\u90e8\uff0c\u7ee7\u7eed\u6267\u884c\u5faa\u73af while ((e = next) != null); //\u4f4e\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (loTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a loTail.next = null; //\u5c06\u4f4e\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684\u539f\u4e0b\u6807\u4f4d\u7f6e newTab[j] = loHead; } //\u9ad8\u4f4d\u5c3e\u5982\u679c\u8bb0\u5f55\u7684\u6709\u6570\u636e\uff0c\u662f\u94fe\u8868 if (hiTail != null) { //\u5c06\u4e0b\u4e00\u4e2a\u5143\u7d20\u7f6e\u7a7a hiTail.next = null; //\u5c06\u9ad8\u4f4d\u5934\u653e\u5165\u65b0\u6570\u7ec4\u7684(\u539f\u4e0b\u6807+\u539f\u6570\u7ec4\u5bb9\u91cf)\u4f4d\u7f6e newTab[j + oldCap] = hiHead; } } } } } //\u8fd4\u56de\u65b0\u7684\u6570\u7ec4\u5bf9\u8c61 return newTab; }","title":"2 \u6269\u5bb9"},{"location":"heimajava/07-%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%E7%AF%87/hashmap%E6%BA%90%E7%A0%81/#3-get","text":"public V get(Object key) { Node<K,V> e; //hash(key)\uff0c\u83b7\u53d6key\u7684hash\u503c //\u8c03\u7528getNode\u65b9\u6cd5\uff0c\u89c1\u4e0b\u9762\u65b9\u6cd5 return (e = getNode(hash(key), key)) == null ? null : e.value; } final Node<K,V> getNode(int hash, Object key) { Node<K,V>[] tab; Node<K,V> first, e; int n; K k; //\u627e\u5230key\u5bf9\u5e94\u7684\u6876\u4e0b\u6807\uff0c\u8d4b\u503c\u7ed9first\u8282\u70b9 if ((tab = table) != null && (n = tab.length) > 0 && (first = tab[(n - 1) & hash]) != null) { //\u5224\u65adhash\u503c\u548ckey\u662f\u5426\u76f8\u7b49\uff0c\u5982\u679c\u662f\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u6876\u4e2d\u53ea\u6709\u4e00\u4e2a\u6570\u636e\uff08\u5927\u90e8\u5206\u7684\u60c5\u51b5\uff09 if (first.hash == hash && // always check first node ((k = first.key) == key || (key != null && key.equals(k)))) return first; if ((e = first.next) != null) { //\u8be5\u8282\u70b9\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u9700\u8981\u901a\u8fc7\u7ea2\u9ed1\u6811\u67e5\u627e\u6570\u636e if (first instanceof TreeNode) return ((TreeNode<K,V>)first).getTreeNode(hash, key); //\u94fe\u8868\u7684\u60c5\u51b5\uff0c\u5219\u9700\u8981\u904d\u5386\u94fe\u8868\u67e5\u627e\u6570\u636e do { if (e.hash == hash && ((k = e.key) == key || (key != null && key.equals(k)))) return e; } while ((e = e.next) != null); } } return null; }","title":"3 get\u65b9\u6cd5"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/","text":"\u6587\u6863\u8bf4\u660e \u5728\u6587\u6863\u4e2d\u5bf9\u6240\u6709\u7684\u9762\u8bd5\u9898\u90fd\u8fdb\u884c\u4e86 \u96be\u6613\u7a0b\u5ea6 \u548c \u51fa\u73b0\u9891\u7387 \u7684\u7b49\u7ea7\u8bf4\u660e \u661f\u6570\u8d8a\u591a\u4ee3\u8868\u6743\u91cd\u8d8a\u5927\uff0c\u6700\u591a\u4e94\u9897\u661f\uff08\u2606\u2606\u2606\u2606\u2606\uff09 \u6700\u5c11\u4e00\u9897\u661f\uff08\u2606\uff09 Java\u591a\u7ebf\u7a0b\u76f8\u5173\u9762\u8bd5\u9898 1.\u7ebf\u7a0b\u7684\u57fa\u7840\u77e5\u8bc6 1.1 \u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u533a\u522b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7a0b\u5e8f\u7531\u6307\u4ee4\u548c\u6570\u636e\u7ec4\u6210\uff0c\u4f46\u8fd9\u4e9b\u6307\u4ee4\u8981\u8fd0\u884c\uff0c\u6570\u636e\u8981\u8bfb\u5199\uff0c\u5c31\u5fc5\u987b\u5c06\u6307\u4ee4\u52a0\u8f7d\u81f3 CPU\uff0c\u6570\u636e\u52a0\u8f7d\u81f3\u5185\u5b58\u3002\u5728\u6307\u4ee4\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u8fd8\u9700\u8981\u7528\u5230\u78c1\u76d8\u3001\u7f51\u7edc\u7b49\u8bbe\u5907\u3002\u8fdb\u7a0b\u5c31\u662f\u7528\u6765\u52a0\u8f7d\u6307\u4ee4\u3001\u7ba1\u7406\u5185\u5b58\u3001\u7ba1\u7406 IO \u7684\u3002 \u5f53\u4e00\u4e2a\u7a0b\u5e8f\u88ab\u8fd0\u884c\uff0c\u4ece\u78c1\u76d8\u52a0\u8f7d\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u4ee3\u7801\u81f3\u5185\u5b58\uff0c\u8fd9\u65f6\u5c31\u5f00\u542f\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u3002 \u4e00\u4e2a\u8fdb\u7a0b\u4e4b\u5185\u53ef\u4ee5\u5206\u4e3a\u4e00\u5230\u591a\u4e2a\u7ebf\u7a0b\u3002 \u4e00\u4e2a\u7ebf\u7a0b\u5c31\u662f\u4e00\u4e2a\u6307\u4ee4\u6d41\uff0c\u5c06\u6307\u4ee4\u6d41\u4e2d\u7684\u4e00\u6761\u6761\u6307\u4ee4\u4ee5\u4e00\u5b9a\u7684\u987a\u5e8f\u4ea4\u7ed9 CPU \u6267\u884c Java \u4e2d\uff0c\u7ebf\u7a0b\u4f5c\u4e3a\u6700\u5c0f\u8c03\u5ea6\u5355\u4f4d\uff0c\u8fdb\u7a0b\u4f5c\u4e3a\u8d44\u6e90\u5206\u914d\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u5728 windows \u4e2d\u8fdb\u7a0b\u662f\u4e0d\u6d3b\u52a8\u7684\uff0c\u53ea\u662f\u4f5c\u4e3a\u7ebf\u7a0b\u7684\u5bb9\u5668 \u4e8c\u8005\u5bf9\u6bd4 \u8fdb\u7a0b\u662f\u6b63\u5728\u8fd0\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u8fdb\u7a0b\u4e2d\u5305\u542b\u4e86\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e0d\u540c\u7684\u4efb\u52a1 \u4e0d\u540c\u7684\u8fdb\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u5f53\u524d\u8fdb\u7a0b\u4e0b\u7684\u6240\u6709\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u5185\u5b58\u7a7a\u95f4 \u7ebf\u7a0b\u66f4\u8f7b\u91cf\uff0c\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u6210\u672c\u4e00\u822c\u4e0a\u8981\u6bd4\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u4f4e(\u4e0a\u4e0b\u6587\u5207\u6362\u6307\u7684\u662f\u4ece\u4e00\u4e2a\u7ebf\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b) 1.2 \u5e76\u884c\u548c\u5e76\u53d1\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606 \u5355\u6838CPU \u5355\u6838CPU\u4e0b\u7ebf\u7a0b\u5b9e\u9645\u8fd8\u662f\u4e32\u884c\u6267\u884c\u7684 \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6709\u4e00\u4e2a\u7ec4\u4ef6\u53eb\u505a\u4efb\u52a1\u8c03\u5ea6\u5668\uff0c\u5c06cpu\u7684\u65f6\u95f4\u7247\uff08windows\u4e0b\u65f6\u95f4\u7247\u6700\u5c0f\u7ea6\u4e3a 15 \u6beb\u79d2\uff09\u5206\u7ed9\u4e0d\u540c\u7684\u7a0b\u5e8f\u4f7f\u7528\uff0c\u53ea\u662f\u7531\u4e8ecpu\u5728\u7ebf\u7a0b\u95f4\uff08\u65f6\u95f4\u7247\u5f88\u77ed\uff09\u7684\u5207\u6362\u975e\u5e38\u5feb\uff0c\u4eba\u7c7b\u611f\u89c9\u662f\u540c\u65f6\u8fd0\u884c\u7684 \u3002 \u603b\u7ed3\u4e3a\u4e00\u53e5\u8bdd\u5c31\u662f\uff1a \u5fae\u89c2\u4e32\u884c\uff0c\u5b8f\u89c2\u5e76\u884c \u4e00\u822c\u4f1a\u5c06\u8fd9\u79cd\u7ebf\u7a0b\u8f6e\u6d41\u4f7f\u7528CPU\u7684\u505a\u6cd5\u79f0\u4e3a\u5e76\u53d1\uff08concurrent\uff09 \u591a\u6838CPU \u6bcf\u4e2a\u6838\uff08core\uff09\u90fd\u53ef\u4ee5\u8c03\u5ea6\u8fd0\u884c\u7ebf\u7a0b\uff0c\u8fd9\u65f6\u5019\u7ebf\u7a0b\u53ef\u4ee5\u662f\u5e76\u884c\u7684\u3002 \u5e76\u53d1\uff08concurrent\uff09\u662f\u540c\u4e00\u65f6\u95f4\u5e94\u5bf9\uff08dealing with\uff09\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b \u5e76\u884c\uff08parallel\uff09\u662f\u540c\u4e00\u65f6\u95f4\u52a8\u624b\u505a\uff08doing\uff09\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b \u4e3e\u4f8b\uff1a \u5bb6\u5ead\u4e3b\u5987\u505a\u996d\u3001\u6253\u626b\u536b\u751f\u3001\u7ed9\u5b69\u5b50\u5582\u5976\uff0c\u5979\u4e00\u4e2a\u4eba\u8f6e\u6d41\u4ea4\u66ff\u505a\u8fd9\u591a\u4ef6\u4e8b\uff0c\u8fd9\u65f6\u5c31\u662f\u5e76\u53d1 \u5bb6\u5ead\u4e3b\u5987\u96c7\u4e86\u4e2a\u4fdd\u59c6\uff0c\u5979\u4eec\u4e00\u8d77\u8fd9\u4e9b\u4e8b\uff0c\u8fd9\u65f6\u65e2\u6709\u5e76\u53d1\uff0c\u4e5f\u6709\u5e76\u884c\uff08\u8fd9\u65f6\u4f1a\u4ea7\u751f\u7ade\u4e89\uff0c\u4f8b\u5982\u9505\u53ea\u6709\u4e00\u53e3\uff0c\u4e00\u4e2a\u4eba\u7528\u9505\u65f6\uff0c\u53e6\u4e00\u4e2a\u4eba\u5c31\u5f97\u7b49\u5f85\uff09 \u96c7\u4e863\u4e2a\u4fdd\u59c6\uff0c\u4e00\u4e2a\u4e13\u505a\u996d\u3001\u4e00\u4e2a\u4e13\u6253\u626b\u536b\u751f\u3001\u4e00\u4e2a\u4e13\u5582\u5976\uff0c\u4e92\u4e0d\u5e72\u6270\uff0c\u8fd9\u65f6\u662f\u5e76\u884c 1.3 \u521b\u5efa\u7ebf\u7a0b\u7684\u56db\u79cd\u65b9\u5f0f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u5171\u6709\u56db\u79cd\u65b9\u5f0f\u53ef\u4ee5\u521b\u5efa\u7ebf\u7a0b\uff0c\u5206\u522b\u662f\uff1a\u7ee7\u627fThread\u7c7b\u3001\u5b9e\u73b0runnable\u63a5\u53e3\u3001\u5b9e\u73b0Callable\u63a5\u53e3\u3001\u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b \u8be6\u7ec6\u521b\u5efa\u65b9\u5f0f\u53c2\u8003\u4e0b\u9762\u4ee3\u7801\uff1a \u2460 \u7ee7\u627fThread\u7c7b public class MyThread extends Thread { @Override public void run() { System.out.println(\"MyThread...run...\"); } public static void main(String[] args) { // \u521b\u5efaMyThread\u5bf9\u8c61 MyThread t1 = new MyThread() ; MyThread t2 = new MyThread() ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); } } \u2461 \u5b9e\u73b0runnable\u63a5\u53e3 public class MyRunnable implements Runnable{ @Override public void run() { System.out.println(\"MyRunnable...run...\"); } public static void main(String[] args) { // \u521b\u5efaMyRunnable\u5bf9\u8c61 MyRunnable mr = new MyRunnable() ; // \u521b\u5efaThread\u5bf9\u8c61 Thread t1 = new Thread(mr) ; Thread t2 = new Thread(mr) ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); } } \u2462 \u5b9e\u73b0Callable\u63a5\u53e3 public class MyCallable implements Callable<String> { @Override public String call() throws Exception { System.out.println(\"MyCallable...call...\"); return \"OK\"; } public static void main(String[] args) throws ExecutionException, InterruptedException { // \u521b\u5efaMyCallable\u5bf9\u8c61 MyCallable mc = new MyCallable() ; // \u521b\u5efaF FutureTask<String> ft = new FutureTask<String>(mc) ; // \u521b\u5efaThread\u5bf9\u8c61 Thread t1 = new Thread(ft) ; Thread t2 = new Thread(ft) ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); // \u8c03\u7528ft\u7684get\u65b9\u6cd5\u83b7\u53d6\u6267\u884c\u7ed3\u679c String result = ft.get(); // \u8f93\u51fa System.out.println(result); } } \u2463 \u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b public class MyExecutors implements Runnable{ @Override public void run() { System.out.println(\"MyRunnable...run...\"); } public static void main(String[] args) { // \u521b\u5efa\u7ebf\u7a0b\u6c60\u5bf9\u8c61 ExecutorService threadPool = Executors.newFixedThreadPool(3); threadPool.submit(new MyExecutors()) ; // \u5173\u95ed\u7ebf\u7a0b\u6c60 threadPool.shutdown(); } } 1.4 runnable \u548c callable \u6709\u4ec0\u4e48\u533a\u522b \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a Runnable \u63a5\u53e3run\u65b9\u6cd5\u6ca1\u6709\u8fd4\u56de\u503c\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\uff0c\u662f\u4e2a\u6cdb\u578b\uff0c\u548cFuture\u3001FutureTask\u914d\u5408\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5f02\u6b65\u6267\u884c\u7684\u7ed3\u679c Callalbe\u63a5\u53e3\u652f\u6301\u8fd4\u56de\u6267\u884c\u7ed3\u679c\uff0c\u9700\u8981\u8c03\u7528FutureTask.get()\u5f97\u5230\uff0c\u6b64\u65b9\u6cd5\u4f1a\u963b\u585e\u4e3b\u8fdb\u7a0b\u7684\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u679c\u4e0d\u8c03\u7528\u4e0d\u4f1a\u963b\u585e\u3002 Callable\u63a5\u53e3\u7684call()\u65b9\u6cd5\u5141\u8bb8\u629b\u51fa\u5f02\u5e38\uff1b\u800cRunnable\u63a5\u53e3\u7684run()\u65b9\u6cd5\u7684\u5f02\u5e38\u53ea\u80fd\u5728\u5185\u90e8\u6d88\u5316\uff0c\u4e0d\u80fd\u7ee7\u7eed\u4e0a\u629b 1.5 \u7ebf\u7a0b\u7684 run()\u548c start()\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 start(): \u7528\u6765\u542f\u52a8\u7ebf\u7a0b\uff0c\u901a\u8fc7\u8be5\u7ebf\u7a0b\u8c03\u7528run\u65b9\u6cd5\u6267\u884crun\u65b9\u6cd5\u4e2d\u6240\u5b9a\u4e49\u7684\u903b\u8f91\u4ee3\u7801\u3002start\u65b9\u6cd5\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\u3002 run(): \u5c01\u88c5\u4e86\u8981\u88ab\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u88ab\u8c03\u7528\u591a\u6b21\u3002 1.6 \u7ebf\u7a0b\u5305\u62ec\u54ea\u4e9b\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u7684\u72b6\u6001\u53ef\u4ee5\u53c2\u8003JDK\u4e2d\u7684Thread\u7c7b\u4e2d\u7684\u679a\u4e3eState public enum State { /** * \u5c1a\u672a\u542f\u52a8\u7684\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001 */ NEW, /** * \u53ef\u8fd0\u884c\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u5904\u4e8e\u53ef\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728 Java \u865a\u62df\u673a\u4e2d\u6267\u884c\uff0c\u4f46\u5b83\u53ef\u80fd\u6b63\u5728\u7b49\u5f85\u6765\u81ea * \u64cd\u4f5c\u7cfb\u7edf\u7684\u5176\u4ed6\u8d44\u6e90\uff0c\u4f8b\u5982\u5904\u7406\u5668\u3002 */ RUNNABLE, /** * \u7ebf\u7a0b\u963b\u585e\u7b49\u5f85\u76d1\u89c6\u5668\u9501\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u76d1\u89c6\u5668\u9501\u8fdb\u5165\u540c\u6b65\u5757/\u65b9\u6cd5\u6216\u5728\u8c03 * \u7528Object.wait\u540e\u91cd\u65b0\u8fdb\u5165\u540c\u6b65\u5757/\u65b9\u6cd5\u3002 */ BLOCKED, /** * \u7b49\u5f85\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7531\u4e8e\u8c03\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff0c\u7ebf\u7a0b\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff1a * Object.wait\u6ca1\u6709\u8d85\u65f6 * \u6ca1\u6709\u8d85\u65f6\u7684Thread.join * LockSupport.park * \u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002 * \u4f8b\u5982\uff0c\u4e00\u4e2a\u5bf9\u5bf9\u8c61\u8c03\u7528Object.wait()\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8be5\u5bf9\u8c61\u8c03\u7528Object.notify() * \u6216Object.notifyAll() \u3002\u5df2\u8c03\u7528Thread.join()\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u6307\u5b9a\u7ebf\u7a0b\u7ec8\u6b62\u3002 */ WAITING, /** * \u5177\u6709\u6307\u5b9a\u7b49\u5f85\u65f6\u95f4\u7684\u7b49\u5f85\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7531\u4e8e\u4ee5\u6307\u5b9a\u7684\u6b63\u7b49\u5f85\u65f6\u95f4\u8c03\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff0c\u7ebf\u7a0b\u5904\u4e8e\u5b9a * \u65f6\u7b49\u5f85\u72b6\u6001\uff1a * Thread.sleep * Object.wait\u8d85\u65f6 * Thread.join\u8d85\u65f6 * LockSupport.parkNanos * LockSupport.parkUntil * </ul> */ TIMED_WAITING, /** * \u5df2\u7ec8\u6b62\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7ebf\u7a0b\u5df2\u5b8c\u6210\u6267\u884c */ TERMINATED; } \u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684 \u5206\u522b\u662f \u65b0\u5efa \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\u88ab\u521b\u5efa\uff0c\u4f46\u8fd8\u672a\u8c03\u7528 start \u65b9\u6cd5\u65f6\u5904\u4e8e \u65b0\u5efa \u72b6\u6001 \u6b64\u65f6\u672a\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054 \u53ef\u8fd0\u884c \u8c03\u7528\u4e86 start \u65b9\u6cd5\uff0c\u5c31\u4f1a\u7531 \u65b0\u5efa \u8fdb\u5165 \u53ef\u8fd0\u884c \u6b64\u65f6\u4e0e\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u6267\u884c \u7ec8\u7ed3 \u7ebf\u7a0b\u5185\u4ee3\u7801\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 \u7ec8\u7ed3 \u6b64\u65f6\u4f1a\u53d6\u6d88\u4e0e\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054 \u963b\u585e \u5f53\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 Monitor \u7684\u963b\u585e\u961f\u5217 \u963b\u585e \uff0c\u6b64\u65f6\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u6301\u9501\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u963b\u585e\u961f\u5217\u4e2d\u7684 \u963b\u585e \u7ebf\u7a0b\uff0c\u5524\u9192\u540e\u7684\u7ebf\u7a0b\u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001 \u7b49\u5f85 \u5f53\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait() \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501\u8fdb\u5165 Monitor \u7b49\u5f85\u96c6\u5408 \u7b49\u5f85 \uff0c\u540c\u6837\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u7b49\u5f85\u96c6\u5408\u4e2d\u7684 \u7b49\u5f85 \u7ebf\u7a0b\uff0c\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u6709\u65f6\u9650\u7b49\u5f85 \u5f53\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait(long) \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501\u8fdb\u5165 Monitor \u7b49\u5f85\u96c6\u5408\u8fdb\u884c \u6709\u65f6\u9650\u7b49\u5f85 \uff0c\u540c\u6837\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u7b49\u5f85\u96c6\u5408\u4e2d\u7684 \u6709\u65f6\u9650\u7b49\u5f85 \u7ebf\u7a0b\uff0c\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001\uff0c\u5e76\u91cd\u65b0\u53bb\u7ade\u4e89\u9501 \u5982\u679c\u7b49\u5f85\u8d85\u65f6\uff0c\u4e5f\u4f1a\u4ece \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001\uff0c\u5e76\u91cd\u65b0\u53bb\u7ade\u4e89\u9501 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f\u8c03\u7528 sleep(long) \u65b9\u6cd5\u4e5f\u4f1a\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u8fdb\u5165 \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\uff0c\u4f46\u4e0e Monitor \u65e0\u5173\uff0c\u4e0d\u9700\u8981\u4e3b\u52a8\u5524\u9192\uff0c\u8d85\u65f6\u65f6\u95f4\u5230\u81ea\u7136\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 1.7 \u65b0\u5efa T1\u3001T2\u3001T3 \u4e09\u4e2a\u7ebf\u7a0b\uff0c\u5982\u4f55\u4fdd\u8bc1\u5b83\u4eec\u6309\u987a\u5e8f\u6267\u884c\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728\u591a\u7ebf\u7a0b\u4e2d\u6709\u591a\u79cd\u65b9\u6cd5\u8ba9\u7ebf\u7a0b\u6309\u7279\u5b9a\u987a\u5e8f\u6267\u884c\uff0c\u4f60\u53ef\u4ee5\u7528\u7ebf\u7a0b\u7c7b\u7684 join ()\u65b9\u6cd5\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u542f\u52a8\u53e6\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u8be5\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u3002 \u4ee3\u7801\u4e3e\u4f8b\uff1a \u4e3a\u4e86\u786e\u4fdd\u4e09\u4e2a\u7ebf\u7a0b\u7684\u987a\u5e8f\u4f60\u5e94\u8be5\u5148\u542f\u52a8\u6700\u540e\u4e00\u4e2a(T3\u8c03\u7528T2\uff0cT2\u8c03\u7528T1)\uff0c\u8fd9\u6837T1\u5c31\u4f1a\u5148\u5b8c\u6210\u800cT3\u6700\u540e\u5b8c\u6210 public class JoinTest { public static void main(String[] args) { // \u521b\u5efa\u7ebf\u7a0b\u5bf9\u8c61 Thread t1 = new Thread(() -> { System.out.println(\"t1\"); }) ; Thread t2 = new Thread(() -> { try { t1.join(); // \u52a0\u5165\u7ebf\u7a0bt1,\u53ea\u6709t1\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u4ee5\u540e\uff0c\u518d\u6b21\u6267\u884c\u8be5\u7ebf\u7a0b } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"t2\"); }) ; Thread t3 = new Thread(() -> { try { t2.join(); // \u52a0\u5165\u7ebf\u7a0bt2,\u53ea\u6709t2\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u4ee5\u540e\uff0c\u518d\u6b21\u6267\u884c\u8be5\u7ebf\u7a0b } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"t3\"); }) ; // \u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); t3.start(); } } 1.8 notify()\u548c notifyAll()\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 notifyAll\uff1a\u5524\u9192\u6240\u6709wait\u7684\u7ebf\u7a0b notify\uff1a\u53ea\u968f\u673a\u5524\u9192\u4e00\u4e2a wait \u7ebf\u7a0b package com.itheima.basic; public class WaitNotify { static boolean flag = false; static Object lock = new Object(); public static void main(String[] args) { Thread t1 = new Thread(() -> { synchronized (lock){ while (!flag){ System.out.println(Thread.currentThread().getName()+\"...wating...\"); try { lock.wait(); } catch (InterruptedException e) { e.printStackTrace(); } } System.out.println(Thread.currentThread().getName()+\"...flag is true\"); } }); Thread t2 = new Thread(() -> { synchronized (lock){ while (!flag){ System.out.println(Thread.currentThread().getName()+\"...wating...\"); try { lock.wait(); } catch (InterruptedException e) { e.printStackTrace(); } } System.out.println(Thread.currentThread().getName()+\"...flag is true\"); } }); Thread t3 = new Thread(() -> { synchronized (lock) { System.out.println(Thread.currentThread().getName() + \" hold lock\"); lock.notifyAll(); flag = true; try { Thread.sleep(2000); } catch (InterruptedException e) { e.printStackTrace(); } } }); t1.start(); t2.start(); t3.start(); } } 1.9 \u5728 java \u4e2d wait \u548c sleep \u65b9\u6cd5\u7684\u4e0d\u540c\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u5171\u540c\u70b9 wait() \uff0cwait(long) \u548c sleep(long) \u7684\u6548\u679c\u90fd\u662f\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6682\u65f6\u653e\u5f03 CPU \u7684\u4f7f\u7528\u6743\uff0c\u8fdb\u5165\u963b\u585e\u72b6\u6001 \u4e0d\u540c\u70b9 \u65b9\u6cd5\u5f52\u5c5e\u4e0d\u540c sleep(long) \u662f Thread \u7684\u9759\u6001\u65b9\u6cd5 \u800c wait()\uff0cwait(long) \u90fd\u662f Object \u7684\u6210\u5458\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709 \u9192\u6765\u65f6\u673a\u4e0d\u540c \u6267\u884c sleep(long) \u548c wait(long) \u7684\u7ebf\u7a0b\u90fd\u4f1a\u5728\u7b49\u5f85\u76f8\u5e94\u6beb\u79d2\u540e\u9192\u6765 wait(long) \u548c wait() \u8fd8\u53ef\u4ee5\u88ab notify \u5524\u9192\uff0cwait() \u5982\u679c\u4e0d\u5524\u9192\u5c31\u4e00\u76f4\u7b49\u4e0b\u53bb \u5b83\u4eec\u90fd\u53ef\u4ee5\u88ab\u6253\u65ad\u5524\u9192 \u9501\u7279\u6027\u4e0d\u540c\uff08\u91cd\u70b9\uff09 wait \u65b9\u6cd5\u7684\u8c03\u7528\u5fc5\u987b\u5148\u83b7\u53d6 wait \u5bf9\u8c61\u7684\u9501\uff0c\u800c sleep \u5219\u65e0\u6b64\u9650\u5236 wait \u65b9\u6cd5\u6267\u884c\u540e\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff0c\u5141\u8bb8\u5176\u5b83\u7ebf\u7a0b\u83b7\u5f97\u8be5\u5bf9\u8c61\u9501\uff08\u6211\u653e\u5f03 cpu\uff0c\u4f46\u4f60\u4eec\u8fd8\u53ef\u4ee5\u7528\uff09 \u800c sleep \u5982\u679c\u5728 synchronized \u4ee3\u7801\u5757\u4e2d\u6267\u884c\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff08\u6211\u653e\u5f03 cpu\uff0c\u4f60\u4eec\u4e5f\u7528\u4e0d\u4e86\uff09 \u4ee3\u7801\u793a\u4f8b\uff1a public class WaitSleepCase { static final Object LOCK = new Object(); public static void main(String[] args) throws InterruptedException { sleeping(); } private static void illegalWait() throws InterruptedException { LOCK.wait(); } private static void waiting() throws InterruptedException { Thread t1 = new Thread(() -> { synchronized (LOCK) { try { get(\"t\").debug(\"waiting...\"); LOCK.wait(5000L); } catch (InterruptedException e) { get(\"t\").debug(\"interrupted...\"); e.printStackTrace(); } } }, \"t1\"); t1.start(); Thread.sleep(100); synchronized (LOCK) { main.debug(\"other...\"); } } private static void sleeping() throws InterruptedException { Thread t1 = new Thread(() -> { synchronized (LOCK) { try { get(\"t\").debug(\"sleeping...\"); Thread.sleep(5000L); } catch (InterruptedException e) { get(\"t\").debug(\"interrupted...\"); e.printStackTrace(); } } }, \"t1\"); t1.start(); Thread.sleep(100); synchronized (LOCK) { main.debug(\"other...\"); } } } 1.10 \u5982\u4f55\u505c\u6b62\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u6709\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u505c\u6b62\u7ebf\u7a0b \u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa\uff0c\u4e5f\u5c31\u662f\u5f53run\u65b9\u6cd5\u5b8c\u6210\u540e\u7ebf\u7a0b\u7ec8\u6b62 \u4f7f\u7528stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62\uff08\u4e0d\u63a8\u8350\uff0c\u65b9\u6cd5\u5df2\u4f5c\u5e9f\uff09 \u4f7f\u7528interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b \u4ee3\u7801\u53c2\u8003\u5982\u4e0b\uff1a \u2460 \u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa \u3002 public class MyInterrupt1 extends Thread { volatile boolean flag = false ; // \u7ebf\u7a0b\u6267\u884c\u7684\u9000\u51fa\u6807\u8bb0 @Override public void run() { while(!flag) { System.out.println(\"MyThread...run...\"); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { // \u521b\u5efaMyThread\u5bf9\u8c61 MyInterrupt1 t1 = new MyInterrupt1() ; t1.start(); // \u4e3b\u7ebf\u7a0b\u4f11\u77206\u79d2 Thread.sleep(6000); // \u66f4\u6539\u6807\u8bb0\u4e3atrue t1.flag = true ; } } \u2461 \u4f7f\u7528stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62 public class MyInterrupt2 extends Thread { volatile boolean flag = false ; // \u7ebf\u7a0b\u6267\u884c\u7684\u9000\u51fa\u6807\u8bb0 @Override public void run() { while(!flag) { System.out.println(\"MyThread...run...\"); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { // \u521b\u5efaMyThread\u5bf9\u8c61 MyInterrupt2 t1 = new MyInterrupt2() ; t1.start(); // \u4e3b\u7ebf\u7a0b\u4f11\u77202\u79d2 Thread.sleep(6000); // \u8c03\u7528stop\u65b9\u6cd5 t1.stop(); } } \u2462 \u4f7f\u7528interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b \u3002 package com.itheima.basic; public class MyInterrupt3 { public static void main(String[] args) throws InterruptedException { //1.\u6253\u65ad\u963b\u585e\u7684\u7ebf\u7a0b /*Thread t1 = new Thread(()->{ System.out.println(\"t1 \u6b63\u5728\u8fd0\u884c...\"); try { Thread.sleep(5000); } catch (InterruptedException e) { e.printStackTrace(); } }, \"t1\"); t1.start(); Thread.sleep(500); t1.interrupt(); System.out.println(t1.isInterrupted());*/ //2.\u6253\u65ad\u6b63\u5e38\u7684\u7ebf\u7a0b Thread t2 = new Thread(()->{ while(true) { Thread current = Thread.currentThread(); boolean interrupted = current.isInterrupted(); if(interrupted) { System.out.println(\"\u6253\u65ad\u72b6\u6001\uff1a\"+interrupted); break; } } }, \"t2\"); t2.start(); Thread.sleep(500); // t2.interrupt(); } } 2.\u7ebf\u7a0b\u4e2d\u5e76\u53d1\u9501 2.1 \u8bb2\u4e00\u4e0bsynchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 2.1.1 \u57fa\u672c\u4f7f\u7528 \u5982\u4e0b\u62a2\u7968\u7684\u4ee3\u7801\uff0c\u5982\u679c\u4e0d\u52a0\u9501\uff0c\u5c31\u4f1a\u51fa\u73b0\u8d85\u5356\u6216\u8005\u4e00\u5f20\u7968\u5356\u7ed9\u591a\u4e2a\u4eba Synchronized\u3010\u5bf9\u8c61\u9501\u3011\u91c7\u7528\u4e92\u65a5\u7684\u65b9\u5f0f\u8ba9\u540c\u4e00\u65f6\u523b\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u6301\u6709\u3010\u5bf9\u8c61\u9501\u3011\uff0c\u5176\u5b83\u7ebf\u7a0b\u518d\u60f3\u83b7\u53d6\u8fd9\u4e2a\u3010\u5bf9\u8c61\u9501\u3011\u65f6\u5c31\u4f1a\u963b\u585e\u4f4f public class TicketDemo { static Object lock = new Object(); int ticketNum = 10; public synchronized void getTicket() { synchronized (this) { if (ticketNum <= 0) { return; } System.out.println(Thread.currentThread().getName() + \"\u62a2\u5230\u4e00\u5f20\u7968,\u5269\u4f59:\" + ticketNum); // \u975e\u539f\u5b50\u6027\u64cd\u4f5c ticketNum--; } } public static void main(String[] args) { TicketDemo ticketDemo = new TicketDemo(); for (int i = 0; i < 20; i++) { new Thread(() -> { ticketDemo.getTicket(); }).start(); } } } 2.1.2 Monitor Monitor \u88ab\u7ffb\u8bd1\u4e3a\u76d1\u89c6\u5668\uff0c\u662f\u7531jvm\u63d0\u4f9b\uff0cc++\u8bed\u8a00\u5b9e\u73b0 \u5728\u4ee3\u7801\u4e2d\u60f3\u8981\u4f53\u73b0monitor\u9700\u8981\u501f\u52a9javap\u547d\u4ee4\u67e5\u770bclsss\u7684\u5b57\u8282\u7801\uff0c\u6bd4\u5982\u4ee5\u4e0b\u4ee3\u7801\uff1a public class SyncTest { static final Object lock = new Object(); static int counter = 0; public static void main(String[] args) { synchronized (lock) { counter++; } } } \u627e\u5230\u8fd9\u4e2a\u7c7b\u7684class\u6587\u4ef6\uff0c\u5728class\u6587\u4ef6\u76ee\u5f55\u4e0b\u6267\u884c javap -v SyncTest.class \uff0c\u53cd\u7f16\u8bd1\u6548\u679c\u5982\u4e0b\uff1a monitorenter \u4e0a\u9501\u5f00\u59cb\u7684\u5730\u65b9 monitorexit \u89e3\u9501\u7684\u5730\u65b9 \u5176\u4e2d\u88abmonitorenter\u548cmonitorexit\u5305\u56f4\u4f4f\u7684\u6307\u4ee4\u5c31\u662f\u4e0a\u9501\u7684\u4ee3\u7801 \u6709\u4e24\u4e2amonitorexit\u7684\u539f\u56e0\uff0c\u7b2c\u4e8c\u4e2amonitorexit\u662f\u4e3a\u4e86\u9632\u6b62\u9501\u4f4f\u7684\u4ee3\u7801\u629b\u5f02\u5e38\u540e\u4e0d\u80fd\u53ca\u65f6\u91ca\u653e\u9501 \u5728\u4f7f\u7528\u4e86synchornized\u4ee3\u7801\u5757\u65f6\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6240\u4ee5synchornized\u4e5f\u88ab\u79f0\u4e3a\u5bf9\u8c61\u9501 monitor\u4e3b\u8981\u5c31\u662f\u8ddf\u8fd9\u4e2a\u5bf9\u8c61\u4ea7\u751f\u5173\u8054\uff0c\u5982\u4e0b\u56fe Monitor\u5185\u90e8\u5177\u4f53\u7684\u5b58\u50a8\u7ed3\u6784\uff1a Owner\uff1a\u5b58\u50a8\u5f53\u524d\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u7684\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u83b7\u53d6 EntryList\uff1a\u5173\u8054\u6ca1\u6709\u62a2\u5230\u9501\u7684\u7ebf\u7a0b\uff0c\u5904\u4e8eBlocked\u72b6\u6001\u7684\u7ebf\u7a0b WaitSet\uff1a\u5173\u8054\u8c03\u7528\u4e86wait\u65b9\u6cd5\u7684\u7ebf\u7a0b\uff0c\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b \u5177\u4f53\u7684\u6d41\u7a0b\uff1a \u4ee3\u7801\u8fdb\u5165synchorized\u4ee3\u7801\u5757\uff0c\u5148\u8ba9lock\uff08\u5bf9\u8c61\u9501\uff09\u5173\u8054\u7684monitor\uff0c\u7136\u540e\u5224\u65adOwner\u662f\u5426\u6709\u7ebf\u7a0b\u6301\u6709 \u5982\u679c\u6ca1\u6709\u7ebf\u7a0b\u6301\u6709\uff0c\u5219\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\uff0c\u8868\u793a\u8be5\u7ebf\u7a0b\u83b7\u53d6\u9501\u6210\u529f \u5982\u679c\u6709\u7ebf\u7a0b\u6301\u6709\uff0c\u5219\u8ba9\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165entryList\u8fdb\u884c\u963b\u585e\uff0c\u5982\u679cOwner\u6301\u6709\u7684\u7ebf\u7a0b\u5df2\u7ecf\u91ca\u653e\u4e86\u9501\uff0c\u5728EntryList\u4e2d\u7684\u7ebf\u7a0b\u53bb\u7ade\u4e89\u9501\u7684\u6301\u6709\u6743\uff08\u975e\u516c\u5e73\uff09 \u5982\u679c\u4ee3\u7801\u5757\u4e2d\u8c03\u7528\u4e86wait()\u65b9\u6cd5\uff0c\u5219\u4f1a\u8fdb\u53bbWaitSet\u4e2d\u8fdb\u884c\u7b49\u5f85 \u53c2\u8003\u56de\u7b54\uff1a Synchronized\u3010\u5bf9\u8c61\u9501\u3011\u91c7\u7528\u4e92\u65a5\u7684\u65b9\u5f0f\u8ba9\u540c\u4e00\u65f6\u523b\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u6301\u6709\u3010\u5bf9\u8c61\u9501\u3011 \u5b83\u7684\u5e95\u5c42\u7531monitor\u5b9e\u73b0\u7684\uff0cmonitor\u662fjvm\u7ea7\u522b\u7684\u5bf9\u8c61\uff08 C++\u5b9e\u73b0\uff09\uff0c\u7ebf\u7a0b\u83b7\u5f97\u9501\u9700\u8981\u4f7f\u7528\u5bf9\u8c61\uff08\u9501\uff09\u5173\u8054monitor \u5728monitor\u5185\u90e8\u6709\u4e09\u4e2a\u5c5e\u6027\uff0c\u5206\u522b\u662fowner\u3001entrylist\u3001waitset \u5176\u4e2downer\u662f\u5173\u8054\u7684\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\uff0c\u5e76\u4e14\u53ea\u80fd\u5173\u8054\u4e00\u4e2a\u7ebf\u7a0b\uff1bentrylist\u5173\u8054\u7684\u662f\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684\u7ebf\u7a0b\uff1bwaitset\u5173\u8054\u7684\u662f\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b 2.2 synchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406-\u8fdb\u9636 Monitor\u5b9e\u73b0\u7684\u9501\u5c5e\u4e8e\u91cd\u91cf\u7ea7\u9501\uff0c\u4f60\u4e86\u89e3\u8fc7\u9501\u5347\u7ea7\u5417\uff1f Monitor\u5b9e\u73b0\u7684\u9501\u5c5e\u4e8e\u91cd\u91cf\u7ea7\u9501\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u5728JDK 1.6\u5f15\u5165\u4e86\u4e24\u79cd\u65b0\u578b\u9501\u673a\u5236\uff1a\u504f\u5411\u9501\u548c\u8f7b\u91cf\u7ea7\u9501\uff0c\u5b83\u4eec\u7684\u5f15\u5165\u662f\u4e3a\u4e86\u89e3\u51b3\u5728\u6ca1\u6709\u591a\u7ebf\u7a0b\u7ade\u4e89\u6216\u57fa\u672c\u6ca1\u6709\u7ade\u4e89\u7684\u573a\u666f\u4e0b\u56e0\u4f7f\u7528\u4f20\u7edf\u9501\u673a\u5236\u5e26\u6765\u7684\u6027\u80fd\u5f00\u9500\u95ee\u9898\u3002 2.2.1 \u5bf9\u8c61\u7684\u5185\u5b58\u7ed3\u6784 \u5728HotSpot\u865a\u62df\u673a\u4e2d\uff0c\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u5b58\u50a8\u7684\u5e03\u5c40\u53ef\u5206\u4e3a3\u5757\u533a\u57df\uff1a\u5bf9\u8c61\u5934\uff08Header\uff09\u3001\u5b9e\u4f8b\u6570\u636e\uff08Instance Data\uff09\u548c\u5bf9\u9f50\u586b\u5145 \u6211\u4eec\u9700\u8981\u91cd\u70b9\u5206\u6790MarkWord\u5bf9\u8c61\u5934 2.2.2 MarkWord hashcode\uff1a25\u4f4d\u7684\u5bf9\u8c61\u6807\u8bc6Hash\u7801 age\uff1a\u5bf9\u8c61\u5206\u4ee3\u5e74\u9f84\u53604\u4f4d biased_lock\uff1a\u504f\u5411\u9501\u6807\u8bc6\uff0c\u53601\u4f4d \uff0c0\u8868\u793a\u6ca1\u6709\u5f00\u59cb\u504f\u5411\u9501\uff0c1\u8868\u793a\u5f00\u542f\u4e86\u504f\u5411\u9501 thread\uff1a\u6301\u6709\u504f\u5411\u9501\u7684\u7ebf\u7a0bID\uff0c\u536023\u4f4d epoch\uff1a\u504f\u5411\u65f6\u95f4\u6233\uff0c\u53602\u4f4d ptr_to_lock_record\uff1a\u8f7b\u91cf\u7ea7\u9501\u72b6\u6001\u4e0b\uff0c\u6307\u5411\u6808\u4e2d\u9501\u8bb0\u5f55\u7684\u6307\u9488\uff0c\u536030\u4f4d ptr_to_heavyweight_monitor\uff1a\u91cd\u91cf\u7ea7\u9501\u72b6\u6001\u4e0b\uff0c\u6307\u5411\u5bf9\u8c61\u76d1\u89c6\u5668Monitor\u7684\u6307\u9488\uff0c\u536030\u4f4d \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7lock\u7684\u6807\u8bc6\uff0c\u6765\u5224\u65ad\u662f\u54ea\u4e00\u79cd\u9501\u7684\u7b49\u7ea7 \u540e\u4e09\u4f4d\u662f001\u8868\u793a\u65e0\u9501 \u540e\u4e09\u4f4d\u662f101\u8868\u793a\u504f\u5411\u9501 \u540e\u4e24\u4f4d\u662f00\u8868\u793a\u8f7b\u91cf\u7ea7\u9501 \u540e\u4e24\u4f4d\u662f10\u8868\u793a\u91cd\u91cf\u7ea7\u9501 2.2.3 \u518d\u8bf4Monitor\u91cd\u91cf\u7ea7\u9501 \u6bcf\u4e2a Java \u5bf9\u8c61\u90fd\u53ef\u4ee5\u5173\u8054\u4e00\u4e2a Monitor \u5bf9\u8c61\uff0c\u5982\u679c\u4f7f\u7528 synchronized \u7ed9\u5bf9\u8c61\u4e0a\u9501\uff08\u91cd\u91cf\u7ea7\uff09\u4e4b\u540e\uff0c \u8be5\u5bf9\u8c61\u5934\u7684Mark Word \u4e2d\u5c31\u88ab\u8bbe\u7f6e\u6307\u5411 Monitor \u5bf9\u8c61\u7684\u6307\u9488 \u7b80\u5355\u8bf4\u5c31\u662f\uff1a\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u90fd\u53ef\u4ee5\u8bbe\u7f6emonoitor\u7684\u6307\u9488\uff0c\u8ba9\u5bf9\u8c61\u4e0emonitor\u4ea7\u751f\u5173\u8054 2.2.4 \u8f7b\u91cf\u7ea7\u9501 \u5728\u5f88\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u5728Java\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u540c\u6b65\u5757\u4e2d\u7684\u4ee3\u7801\u90fd\u662f\u4e0d\u5b58\u5728\u7ade\u4e89\u7684\uff0c\u4e0d\u540c\u7684\u7ebf\u7a0b\u4ea4\u66ff\u7684\u6267\u884c\u540c\u6b65\u5757\u4e2d\u7684\u4ee3\u7801\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u91cd\u91cf\u7ea7\u9501\u662f\u6ca1\u5fc5\u8981\u7684\u3002\u56e0\u6b64JVM\u5f15\u5165\u4e86\u8f7b\u91cf\u7ea7\u9501\u7684\u6982\u5ff5\u3002 static final Object obj = new Object(); public static void method1() { synchronized (obj) { // \u540c\u6b65\u5757 A method2(); } } public static void method2() { synchronized (obj) { // \u540c\u6b65\u5757 B } } \u52a0\u9501\u7684\u6d41\u7a0b 1.\u5728\u7ebf\u7a0b\u6808\u4e2d\u521b\u5efa\u4e00\u4e2aLock Record\uff0c\u5c06\u5176obj\u5b57\u6bb5\u6307\u5411\u9501\u5bf9\u8c61\u3002 2.\u901a\u8fc7CAS\u6307\u4ee4\u5c06Lock Record\u7684\u5730\u5740\u5b58\u50a8\u5728\u5bf9\u8c61\u5934\u7684mark word\u4e2d\uff08\u6570\u636e\u8fdb\u884c\u4ea4\u6362\uff09\uff0c\u5982\u679c\u5bf9\u8c61\u5904\u4e8e\u65e0\u9501\u72b6\u6001\u5219\u4fee\u6539\u6210\u529f\uff0c\u4ee3\u8868\u8be5\u7ebf\u7a0b\u83b7\u5f97\u4e86\u8f7b\u91cf\u7ea7\u9501\u3002 3.\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u8be5\u9501\u4e86\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u9501\u91cd\u5165\u3002\u8bbe\u7f6eLock Record\u7b2c\u4e00\u90e8\u5206\u4e3anull\uff0c\u8d77\u5230\u4e86\u4e00\u4e2a\u91cd\u5165\u8ba1\u6570\u5668\u7684\u4f5c\u7528\u3002 4.\u5982\u679cCAS\u4fee\u6539\u5931\u8d25\uff0c\u8bf4\u660e\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u9700\u8981\u81a8\u80c0\u4e3a\u91cd\u91cf\u7ea7\u9501\u3002 \u89e3\u9501\u8fc7\u7a0b 1.\u904d\u5386\u7ebf\u7a0b\u6808,\u627e\u5230\u6240\u6709obj\u5b57\u6bb5\u7b49\u4e8e\u5f53\u524d\u9501\u5bf9\u8c61\u7684Lock Record\u3002 2.\u5982\u679cLock Record\u7684Mark Word\u4e3anull\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u91cd\u5165\uff0c\u5c06obj\u8bbe\u7f6e\u4e3anull\u540econtinue\u3002 3.\u5982\u679cLock Record\u7684 Mark Word\u4e0d\u4e3anull\uff0c\u5219\u5229\u7528CAS\u6307\u4ee4\u5c06\u5bf9\u8c61\u5934\u7684mark word\u6062\u590d\u6210\u4e3a\u65e0\u9501\u72b6\u6001\u3002\u5982\u679c\u5931\u8d25\u5219\u81a8\u80c0\u4e3a\u91cd\u91cf\u7ea7\u9501\u3002 2.2.5 \u504f\u5411\u9501 \u8f7b\u91cf\u7ea7\u9501\u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff08\u5c31\u81ea\u5df1\u8fd9\u4e2a\u7ebf\u7a0b\uff09\uff0c\u6bcf\u6b21\u91cd\u5165\u4ecd\u7136\u9700\u8981\u6267\u884c CAS \u64cd\u4f5c\u3002 Java 6 \u4e2d\u5f15\u5165\u4e86\u504f\u5411\u9501\u6765\u505a\u8fdb\u4e00\u6b65\u4f18\u5316\uff1a\u53ea\u6709\u7b2c\u4e00\u6b21\u4f7f\u7528 CAS \u5c06\u7ebf\u7a0b ID \u8bbe\u7f6e\u5230\u5bf9\u8c61\u7684 Mark Word \u5934\uff0c\u4e4b\u540e\u53d1\u73b0 \u8fd9\u4e2a\u7ebf\u7a0b ID \u662f\u81ea\u5df1\u7684\u5c31\u8868\u793a\u6ca1\u6709\u7ade\u4e89\uff0c\u4e0d\u7528\u91cd\u65b0 CAS\u3002\u4ee5\u540e\u53ea\u8981\u4e0d\u53d1\u751f\u7ade\u4e89\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5f52\u8be5\u7ebf\u7a0b\u6240\u6709 static final Object obj = new Object(); public static void m1() { synchronized (obj) { // \u540c\u6b65\u5757 A m2(); } } public static void m2() { synchronized (obj) { // \u540c\u6b65\u5757 B m3(); } } public static void m3() { synchronized (obj) { } } \u52a0\u9501\u7684\u6d41\u7a0b 1.\u5728\u7ebf\u7a0b\u6808\u4e2d\u521b\u5efa\u4e00\u4e2aLock Record\uff0c\u5c06\u5176obj\u5b57\u6bb5\u6307\u5411\u9501\u5bf9\u8c61\u3002 2.\u901a\u8fc7CAS\u6307\u4ee4\u5c06Lock Record\u7684 \u7ebf\u7a0bid \u5b58\u50a8\u5728\u5bf9\u8c61\u5934\u7684mark word\u4e2d\uff0c\u540c\u65f6\u4e5f\u8bbe\u7f6e\u504f\u5411\u9501\u7684\u6807\u8bc6\u4e3a101\uff0c\u5982\u679c\u5bf9\u8c61\u5904\u4e8e\u65e0\u9501\u72b6\u6001\u5219\u4fee\u6539\u6210\u529f\uff0c\u4ee3\u8868\u8be5\u7ebf\u7a0b\u83b7\u5f97\u4e86\u504f\u5411\u9501\u3002 3.\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u8be5\u9501\u4e86\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u9501\u91cd\u5165\u3002\u8bbe\u7f6eLock Record\u7b2c\u4e00\u90e8\u5206\u4e3anull\uff0c\u8d77\u5230\u4e86\u4e00\u4e2a\u91cd\u5165\u8ba1\u6570\u5668\u7684\u4f5c\u7528\u3002\u4e0e\u8f7b\u91cf\u7ea7\u9501\u4e0d\u540c\u7684\u65f6\uff0c\u8fd9\u91cc\u4e0d\u4f1a\u518d\u6b21\u8fdb\u884ccas\u64cd\u4f5c\uff0c\u53ea\u662f\u5224\u65ad\u5bf9\u8c61\u5934\u4e2d\u7684\u7ebf\u7a0bid\u662f\u5426\u662f\u81ea\u5df1\uff0c\u56e0\u4e3a\u7f3a\u5c11\u4e86cas\u64cd\u4f5c\uff0c\u6027\u80fd\u76f8\u5bf9\u8f7b\u91cf\u7ea7\u9501\u66f4\u597d\u4e00\u4e9b \u89e3\u9501\u6d41\u7a0b\u53c2\u8003\u8f7b\u91cf\u7ea7\u9501 2.2.6 \u53c2\u8003\u56de\u7b54 Java\u4e2d\u7684synchronized\u6709\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\u3001\u91cd\u91cf\u7ea7\u9501\u4e09\u79cd\u5f62\u5f0f\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u9501\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u3001\u4e0d\u540c\u7ebf\u7a0b\u4ea4\u66ff\u6301\u6709\u9501\u3001\u591a\u7ebf\u7a0b\u7ade\u4e89\u9501\u4e09\u79cd\u60c5\u51b5\u3002 \u63cf\u8ff0 \u91cd\u91cf\u7ea7\u9501 \u5e95\u5c42\u4f7f\u7528\u7684Monitor\u5b9e\u73b0\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u8f7b\u91cf\u7ea7\u9501 \u7ebf\u7a0b\u52a0\u9501\u7684\u65f6\u95f4\u662f\u9519\u5f00\u7684\uff08\u4e5f\u5c31\u662f\u6ca1\u6709\u7ade\u4e89\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f7b\u91cf\u7ea7\u9501\u6765\u4f18\u5316\u3002\u8f7b\u91cf\u7ea7\u4fee\u6539\u4e86\u5bf9\u8c61\u5934\u7684\u9501\u6807\u5fd7\uff0c\u76f8\u5bf9\u91cd\u91cf\u7ea7\u9501\u6027\u80fd\u63d0\u5347\u5f88\u591a\u3002\u6bcf\u6b21\u4fee\u6539\u90fd\u662fCAS\u64cd\u4f5c\uff0c\u4fdd\u8bc1\u539f\u5b50\u6027 \u504f\u5411\u9501 \u4e00\u6bb5\u5f88\u957f\u7684\u65f6\u95f4\u5185\u90fd\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u504f\u5411\u9501\uff0c\u5728\u7b2c\u4e00\u6b21\u83b7\u5f97\u9501\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2aCAS\u64cd\u4f5c\uff0c\u4e4b\u540e\u8be5\u7ebf\u7a0b\u518d\u83b7\u53d6\u9501\uff0c\u53ea\u9700\u8981\u5224\u65admark word\u4e2d\u662f\u5426\u662f\u81ea\u5df1\u7684\u7ebf\u7a0bid\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u5f00\u9500\u76f8\u5bf9\u8f83\u5927\u7684CAS\u547d\u4ee4 \u4e00\u65e6\u9501\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u90fd\u4f1a\u5347\u7ea7\u4e3a\u91cd\u91cf\u7ea7\u9501 2.3\u4f60\u8c08\u8c08 JMM\uff08Java \u5185\u5b58\u6a21\u578b\uff09 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 JMM(Java Memory Model)Java\u5185\u5b58\u6a21\u578b,\u662fjava\u865a\u62df\u673a\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684\u4e00\u79cd\u5185\u5b58\u6a21\u578b\u3002 Java\u5185\u5b58\u6a21\u578b(Java Memory Model)\u63cf\u8ff0\u4e86Java\u7a0b\u5e8f\u4e2d\u5404\u79cd\u53d8\u91cf(\u7ebf\u7a0b\u5171\u4eab\u53d8\u91cf)\u7684\u8bbf\u95ee\u89c4\u5219\uff0c\u4ee5\u53ca\u5728JVM\u4e2d\u5c06\u53d8\u91cf\u5b58\u50a8\u5230\u5185\u5b58\u548c\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u53d8\u91cf\u8fd9\u6837\u7684\u5e95\u5c42\u7ec6\u8282\u3002 \u7279\u70b9\uff1a \u6240\u6709\u7684\u5171\u4eab\u53d8\u91cf\u90fd\u5b58\u50a8\u4e8e\u4e3b\u5185\u5b58(\u8ba1\u7b97\u673a\u7684RAM)\u8fd9\u91cc\u6240\u8bf4\u7684\u53d8\u91cf\u6307\u7684\u662f\u5b9e\u4f8b\u53d8\u91cf\u548c\u7c7b\u53d8\u91cf\u3002\u4e0d\u5305\u542b\u5c40\u90e8\u53d8\u91cf\uff0c\u56e0\u4e3a\u5c40\u90e8\u53d8\u91cf\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u7ade\u4e89\u95ee\u9898\u3002 \u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u8fd8\u5b58\u5728\u81ea\u5df1\u7684\u5de5\u4f5c\u5185\u5b58\uff0c\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\uff0c\u4fdd\u7559\u4e86\u88ab\u7ebf\u7a0b\u4f7f\u7528\u7684\u53d8\u91cf\u7684\u5de5\u4f5c\u526f\u672c\u3002 \u7ebf\u7a0b\u5bf9\u53d8\u91cf\u7684\u6240\u6709\u7684\u64cd\u4f5c(\u8bfb\uff0c\u5199)\u90fd\u5fc5\u987b\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u5b8c\u6210\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u8bfb\u5199\u4e3b\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u4e0d\u540c\u7ebf\u7a0b\u4e4b\u95f4\u4e5f\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5bf9\u65b9\u5de5\u4f5c\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u7ebf\u7a0b\u95f4\u53d8\u91cf\u7684\u503c\u7684\u4f20\u9012\u9700\u8981\u901a\u8fc7\u4e3b\u5185\u5b58\u5b8c\u6210\u3002 2.4 CAS \u4f60\u77e5\u9053\u5417\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 2.4.1 \u6982\u8ff0\u53ca\u57fa\u672c\u5de5\u4f5c\u6d41\u7a0b CAS\u7684\u5168\u79f0\u662f\uff1a Compare And Swap(\u6bd4\u8f83\u518d\u4ea4\u6362)\uff0c\u5b83\u4f53\u73b0\u7684\u4e00\u79cd\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff0c\u5728\u65e0\u9501\u60c5\u51b5\u4e0b\u4fdd\u8bc1\u7ebf\u7a0b\u64cd\u4f5c\u5171\u4eab\u6570\u636e\u7684\u539f\u5b50\u6027\u3002 \u5728JUC\uff08 java.util.concurrent \uff09\u5305\u4e0b\u5b9e\u73b0\u7684\u5f88\u591a\u7c7b\u90fd\u7528\u5230\u4e86CAS\u64cd\u4f5c AbstractQueuedSynchronizer\uff08AQS\u6846\u67b6\uff09 AtomicXXX\u7c7b \u4f8b\u5b50\uff1a \u6211\u4eec\u8fd8\u662f\u57fa\u4e8e\u521a\u624d\u5b66\u4e60\u8fc7\u7684JMM\u5185\u5b58\u6a21\u578b\u8fdb\u884c\u8bf4\u660e \u7ebf\u7a0b1\u4e0e\u7ebf\u7a0b2\u90fd\u4ece\u4e3b\u5185\u5b58\u4e2d\u83b7\u53d6\u53d8\u91cfint a = 100,\u540c\u65f6\u653e\u5230\u5404\u4e2a\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u4e2d \u4e00\u4e2a\u5f53\u524d\u5185\u5b58\u503cV\u3001\u65e7\u7684\u9884\u671f\u503cA\u3001\u5373\u5c06\u66f4\u65b0\u7684\u503cB\uff0c\u5f53\u4e14\u4ec5\u5f53\u65e7\u7684\u9884\u671f\u503cA\u548c\u5185\u5b58\u503cV\u76f8\u540c\u65f6\uff0c\u5c06\u5185\u5b58\u503c\u4fee\u6539\u4e3aB\u5e76\u8fd4\u56detrue\uff0c\u5426\u5219\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u5e76\u8fd4\u56defalse\u3002\u5982\u679cCAS\u64cd\u4f5c\u5931\u8d25\uff0c\u901a\u8fc7\u81ea\u65cb\u7684\u65b9\u5f0f\u7b49\u5f85\u5e76\u518d\u6b21\u5c1d\u8bd5\uff0c\u76f4\u5230\u6210\u529f \u7ebf\u7a0b1\u64cd\u4f5c\uff1aV\uff1aint a = 100\uff0cA\uff1aint a = 100\uff0cB\uff1a\u4fee\u6539\u540e\u7684\u503c\uff1aint a = 101 (a++) \u7ebf\u7a0b1\u62ffA\u7684\u503c\u4e0e\u4e3b\u5185\u5b58V\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5224\u65ad\u662f\u5426\u76f8\u7b49 \u5982\u679c\u76f8\u7b49\uff0c\u5219\u628aB\u7684\u503c101\u66f4\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d \u7ebf\u7a0b2\u64cd\u4f5c\uff1aV\uff1aint a = 100\uff0cA\uff1aint a = 100\uff0cB\uff1a\u4fee\u6539\u540e\u7684\u503c\uff1aint a = 99(a--) \u7ebf\u7a0b2\u62ffA\u7684\u503c\u4e0e\u4e3b\u5185\u5b58V\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5224\u65ad\u662f\u5426\u76f8\u7b49(\u76ee\u524d\u4e0d\u76f8\u7b49\uff0c\u56e0\u4e3a\u7ebf\u7a0b1\u5df2\u66f4\u65b0V\u7684\u503c99) \u4e0d\u76f8\u7b49\uff0c\u5219\u7ebf\u7a0b2\u66f4\u65b0\u5931\u8d25 \u81ea\u65cb\u9501\u64cd\u4f5c \u56e0\u4e3a\u6ca1\u6709\u52a0\u9501\uff0c\u6240\u4ee5\u7ebf\u7a0b\u4e0d\u4f1a\u9677\u5165\u963b\u585e\uff0c\u6548\u7387\u8f83\u9ad8 \u5982\u679c\u7ade\u4e89\u6fc0\u70c8\uff0c\u91cd\u8bd5\u9891\u7e41\u53d1\u751f\uff0c\u6548\u7387\u4f1a\u53d7\u5f71\u54cd \u9700\u8981\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u5171\u4eab\u5185\u5b58V\u4e2d\u6700\u65b0\u7684\u503c\uff0c\u7136\u540e\u518d\u5728\u65b0\u7684\u503c\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\uff0c\u5982\u679c\u5931\u8d25\u5c31\u7ee7\u7eed\u5c1d\u8bd5\u83b7\u53d6\u65b0\u7684\u503c\uff0c\u76f4\u5230\u66f4\u65b0\u6210\u529f 2.4.2 CAS \u5e95\u5c42\u5b9e\u73b0 CAS \u5e95\u5c42\u4f9d\u8d56\u4e8e\u4e00\u4e2a Unsafe \u7c7b\u6765\u76f4\u63a5\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u7684 CAS \u6307\u4ee4 \u90fd\u662fnative\u4fee\u9970\u7684\u65b9\u6cd5\uff0c\u7531\u7cfb\u7edf\u63d0\u4f9b\u7684\u63a5\u53e3\u6267\u884c\uff0c\u5e76\u975ejava\u4ee3\u7801\u5b9e\u73b0\uff0c\u4e00\u822c\u7684\u601d\u8def\u4e5f\u90fd\u662f\u81ea\u65cb\u9501\u5b9e\u73b0 \u5728java\u4e2d\u6bd4\u8f83\u5e38\u89c1\u4f7f\u7528\u6709\u5f88\u591a\uff0c\u6bd4\u5982ReentrantLock\u548cAtomic\u5f00\u5934\u7684\u7ebf\u7a0b\u5b89\u5168\u7c7b\uff0c\u90fd\u8c03\u7528\u4e86Unsafe\u4e2d\u7684\u65b9\u6cd5 ReentrantLock\u4e2d\u7684\u4e00\u6bb5CAS\u4ee3\u7801 2.4.3 \u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501 CAS \u662f\u57fa\u4e8e\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff1a\u6700\u4e50\u89c2\u7684\u4f30\u8ba1\uff0c\u4e0d\u6015\u522b\u7684\u7ebf\u7a0b\u6765\u4fee\u6539\u5171\u4eab\u53d8\u91cf\uff0c\u5c31\u7b97\u6539\u4e86\u4e5f\u6ca1\u5173\u7cfb\uff0c\u6211\u5403\u4e8f\u70b9\u518d\u91cd\u8bd5\u5457\u3002 synchronized \u662f\u57fa\u4e8e\u60b2\u89c2\u9501\u7684\u601d\u60f3\uff1a\u6700\u60b2\u89c2\u7684\u4f30\u8ba1\uff0c\u5f97\u9632\u7740\u5176\u5b83\u7ebf\u7a0b\u6765\u4fee\u6539\u5171\u4eab\u53d8\u91cf\uff0c\u6211\u4e0a\u4e86\u9501\u4f60\u4eec\u90fd\u522b\u60f3\u6539\uff0c\u6211\u6539\u5b8c\u4e86\u89e3\u5f00\u9501\uff0c\u4f60\u4eec\u624d\u6709\u673a\u4f1a\u3002 2.5 \u8bf7\u8c08\u8c08\u4f60\u5bf9 volatile \u7684\u7406\u89e3 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e00\u65e6\u4e00\u4e2a\u5171\u4eab\u53d8\u91cf\uff08\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u3001\u7c7b\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\uff09\u88abvolatile\u4fee\u9970\u4e4b\u540e\uff0c\u90a3\u4e48\u5c31\u5177\u5907\u4e86\u4e24\u5c42\u8bed\u4e49\uff1a 2.5.1 \u4fdd\u8bc1\u7ebf\u7a0b\u95f4\u7684\u53ef\u89c1\u6027 \u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u65f6\u7684\u53ef\u89c1\u6027\uff0c\u5373\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u8fd9\u65b0\u503c\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u6765\u8bf4\u662f\u7acb\u5373\u53ef\u89c1\u7684,volatile\u5173\u952e\u5b57\u4f1a\u5f3a\u5236\u5c06\u4fee\u6539\u7684\u503c\u7acb\u5373\u5199\u5165\u4e3b\u5b58\u3002 \u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff1a\u6c38\u4e0d\u505c\u6b62\u7684\u5faa\u73af package com.itheima.basic; // \u53ef\u89c1\u6027\u4f8b\u5b50 // -Xint public class ForeverLoop { static boolean stop = false; public static void main(String[] args) { new Thread(() -> { try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } stop = true; System.out.println(\"modify stop to true...\"); }).start(); foo(); } static void foo() { int i = 0; while (!stop) { i++; } System.out.println(\"stopped... c:\"+ i); } } \u5f53\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u53d1\u73b0foo()\u65b9\u6cd5\u4e2d\u7684\u5faa\u73af\u662f\u7ed3\u675f\u4e0d\u4e86\u7684\uff0c\u4e5f\u5c31\u8bf4\u8bfb\u53d6\u4e0d\u5230\u5171\u4eab\u53d8\u91cf\u7684\u503c\u7ed3\u675f\u5faa\u73af\u3002 \u4e3b\u8981\u662f\u56e0\u4e3a\u5728JVM\u865a\u62df\u673a\u4e2d\u6709\u4e00\u4e2aJIT\uff08\u5373\u65f6\u7f16\u8f91\u5668\uff09\u7ed9\u4ee3\u7801\u505a\u4e86\u4f18\u5316\u3002 \u4e0a\u8ff0\u4ee3\u7801 java while (!stop) { i++; } \u5728\u5f88\u77ed\u7684\u65f6\u95f4\u5185\uff0c\u8fd9\u4e2a\u4ee3\u7801\u6267\u884c\u7684\u6b21\u6570\u592a\u591a\u4e86\uff0c\u5f53\u8fbe\u5230\u4e86\u4e00\u4e2a\u9608\u503c\uff0cJIT\u5c31\u4f1a\u4f18\u5316\u6b64\u4ee3\u7801\uff0c\u5982\u4e0b\uff1a java while (true) { i++; } \u5f53\u628a\u4ee3\u7801\u4f18\u5316\u6210\u8fd9\u6837\u5b50\u4ee5\u540e\uff0c\u53ca\u65f6 stop \u53d8\u91cf\u6539\u53d8\u4e3a\u4e86 false \u4e5f\u4f9d\u7136\u505c\u6b62\u4e0d\u4e86\u5faa\u73af \u89e3\u51b3\u65b9\u6848\uff1a \u7b2c\u4e00\uff1a \u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u52a0\u5165vm\u53c2\u6570 -Xint \u8868\u793a\u7981\u7528\u5373\u65f6\u7f16\u8f91\u5668\uff0c\u4e0d\u63a8\u8350\uff0c\u5f97\u4e0d\u507f\u5931\uff08\u5176\u4ed6\u7a0b\u5e8f\u8fd8\u8981\u4f7f\u7528\uff09 \u7b2c\u4e8c\uff1a \u5728\u4fee\u9970 stop \u53d8\u91cf\u7684\u65f6\u5019\u52a0\u4e0a volatile ,\u8868\u793a\u5f53\u524d\u4ee3\u7801\u7981\u7528\u4e86\u5373\u65f6\u7f16\u8f91\u5668\uff0c\u95ee\u9898\u5c31\u53ef\u4ee5\u89e3\u51b3\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a static volatile boolean stop = false; 2.5.2 \u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f \u7528 volatile \u4fee\u9970\u5171\u4eab\u53d8\u91cf\u4f1a\u5728\u8bfb\u3001\u5199\u5171\u4eab\u53d8\u91cf\u65f6\u52a0\u5165\u4e0d\u540c\u7684\u5c4f\u969c\uff0c\u963b\u6b62\u5176\u4ed6\u8bfb\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\uff0c\u4ece\u800c\u8fbe\u5230\u963b\u6b62\u91cd\u6392\u5e8f\u7684\u6548\u679c \u5728\u53bb\u83b7\u53d6\u4e0a\u9762\u7684\u7ed3\u679c\u7684\u65f6\u5019\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b04\u79cd\u60c5\u51b5 \u60c5\u51b5\u4e00\uff1a\u5148\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->0,0(\u6b63\u5e38) \u60c5\u51b5\u4e8c\uff1a\u5148\u6267\u884cactor1\u4e2d\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->0,1(\u6b63\u5e38) \u60c5\u51b5\u4e09\uff1a\u5148\u6267\u884cactor1\u4e2d\u6240\u6709\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->1,1(\u6b63\u5e38) \u60c5\u51b5\u56db\uff1a\u5148\u6267\u884cactor1\u4e2d\u7b2c\u4e8c\u884c\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->1,0(\u53d1\u751f\u4e86\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u5f71\u54cd\u7ed3\u679c) \u89e3\u51b3\u65b9\u6848 \u5728\u53d8\u91cf\u4e0a\u6dfb\u52a0volatile\uff0c\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u5219\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898 \u5c4f\u969c\u6dfb\u52a0\u7684\u793a\u610f\u56fe \u5199\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0a\u65b9\u5176\u5b83\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u5199\u4e4b\u4e0b \u8bfb\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0b\u65b9\u5176\u5b83\u8bfb\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u8bfb\u4e4b\u4e0a \u5176\u4ed6\u8865\u5145 \u6211\u4eec\u4e0a\u9762\u7684\u89e3\u51b3\u65b9\u6848\u662f\u628avolatile\u52a0\u5728\u4e86int y\u8fd9\u4e2a\u53d8\u91cf\u4e0a\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u628a\u5b83\u52a0\u5728int x\u8fd9\u4e2a\u53d8\u91cf\u4e0a\u5462\uff1f \u4e0b\u9762\u4ee3\u7801\u4f7f\u7528volatile\u4fee\u9970\u4e86x\u53d8\u91cf \u5c4f\u969c\u6dfb\u52a0\u7684\u793a\u610f\u56fe \u8fd9\u6837\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u4e0b\u9762\u4e24\u4e2a\u539f\u5219\uff1a \u5199\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0a\u65b9\u5176\u5b83\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u5199\u4e4b\u4e0b \u8bfb\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0b\u65b9\u5176\u5b83\u8bfb\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u8bfb\u4e4b\u4e0a \u6240\u4ee5\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u603b\u7ed3\u4e00\u4e2avolatile\u4f7f\u7528\u7684\u5c0f\u5999\u62db\uff1a \u5199\u53d8\u91cf\u8ba9volatile\u4fee\u9970\u7684\u53d8\u91cf\u7684\u5728\u4ee3\u7801\u6700\u540e\u4f4d\u7f6e \u8bfb\u53d8\u91cf\u8ba9volatile\u4fee\u9970\u7684\u53d8\u91cf\u7684\u5728\u4ee3\u7801\u6700\u5f00\u59cb\u4f4d\u7f6e 2.6 \u4ec0\u4e48\u662fAQS\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 2.6.1 \u6982\u8ff0 \u5168\u79f0\u662f AbstractQueuedSynchronizer\uff0c\u662f\u963b\u585e\u5f0f\u9501\u548c\u76f8\u5173\u7684\u540c\u6b65\u5668\u5de5\u5177\u7684\u6846\u67b6\uff0c\u5b83\u662f\u6784\u5efa\u9501\u6216\u8005\u5176\u4ed6\u540c\u6b65\u7ec4\u4ef6\u7684\u57fa\u7840\u6846\u67b6 AQS\u4e0eSynchronized\u7684\u533a\u522b synchronized AQS \u5173\u952e\u5b57\uff0cc++ \u8bed\u8a00\u5b9e\u73b0 java \u8bed\u8a00\u5b9e\u73b0 \u60b2\u89c2\u9501\uff0c\u81ea\u52a8\u91ca\u653e\u9501 \u60b2\u89c2\u9501\uff0c\u624b\u52a8\u5f00\u542f\u548c\u5173\u95ed \u9501\u7ade\u4e89\u6fc0\u70c8\u90fd\u662f\u91cd\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u5dee \u9501\u7ade\u4e89\u6fc0\u70c8\u7684\u60c5\u51b5\u4e0b\uff0c\u63d0\u4f9b\u4e86\u591a\u79cd\u89e3\u51b3\u65b9\u6848 AQS\u5e38\u89c1\u7684\u5b9e\u73b0\u7c7b ReentrantLock \u963b\u585e\u5f0f\u9501 Semaphore \u4fe1\u53f7\u91cf CountDownLatch \u5012\u8ba1\u65f6\u9501 2.6.2 \u5de5\u4f5c\u673a\u5236 \u5728AQS\u4e2d\u7ef4\u62a4\u4e86\u4e00\u4e2a\u4f7f\u7528\u4e86volatile\u4fee\u9970\u7684state\u5c5e\u6027\u6765\u8868\u793a\u8d44\u6e90\u7684\u72b6\u6001\uff0c0\u8868\u793a\u65e0\u9501\uff0c1\u8868\u793a\u6709\u9501 \u63d0\u4f9b\u4e86\u57fa\u4e8e FIFO \u7684\u7b49\u5f85\u961f\u5217\uff0c\u7c7b\u4f3c\u4e8e Monitor \u7684 EntryList \u6761\u4ef6\u53d8\u91cf\u6765\u5b9e\u73b0\u7b49\u5f85\u3001\u5524\u9192\u673a\u5236\uff0c\u652f\u6301\u591a\u4e2a\u6761\u4ef6\u53d8\u91cf\uff0c\u7c7b\u4f3c\u4e8e Monitor \u7684 WaitSet \u7ebf\u7a0b0\u6765\u4e86\u4ee5\u540e\uff0c\u53bb\u5c1d\u8bd5\u4fee\u6539state\u5c5e\u6027\uff0c\u5982\u679c\u53d1\u73b0state\u5c5e\u6027\u662f0\uff0c\u5c31\u4fee\u6539state\u72b6\u6001\u4e3a1\uff0c\u8868\u793a\u7ebf\u7a0b0\u62a2\u9501\u6210\u529f \u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u4e5f\u4f1a\u5148\u5c1d\u8bd5\u4fee\u6539state\u5c5e\u6027\uff0c\u53d1\u73b0state\u7684\u503c\u5df2\u7ecf\u662f1\u4e86\uff0c\u6709\u5176\u4ed6\u7ebf\u7a0b\u6301\u6709\u9501\uff0c\u5b83\u4eec\u90fd\u4f1a\u5230FIFO\u961f\u5217\u4e2d\u8fdb\u884c\u7b49\u5f85\uff0c FIFO\u662f\u4e00\u4e2a\u53cc\u5411\u961f\u5217\uff0chead\u5c5e\u6027\u8868\u793a\u5934\u7ed3\u70b9\uff0ctail\u8868\u793a\u5c3e\u7ed3\u70b9 \u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u5171\u540c\u53bb\u62a2\u8fd9\u4e2a\u8d44\u6e90\u662f\u5982\u4f55\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u5462\uff1f \u5728\u53bb\u4fee\u6539state\u72b6\u6001\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7684cas\u81ea\u65cb\u9501\u6765\u4fdd\u8bc1\u539f\u5b50\u6027\uff0c\u786e\u4fdd\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u6210\u529f\uff0c\u4fee\u6539\u5931\u8d25\u7684\u7ebf\u7a0b\u5c06\u4f1a\u8fdb\u5165FIFO\u961f\u5217\u4e2d\u7b49\u5f85 AQS\u662f\u516c\u5e73\u9501\u5417\uff0c\u8fd8\u662f\u975e\u516c\u5e73\u9501\uff1f \u65b0\u7684\u7ebf\u7a0b\u4e0e\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u5171\u540c\u6765\u62a2\u8d44\u6e90\uff0c\u662f\u975e\u516c\u5e73\u9501 \u65b0\u7684\u7ebf\u7a0b\u5230\u961f\u5217\u4e2d\u7b49\u5f85\uff0c\u53ea\u8ba9\u961f\u5217\u4e2d\u7684head\u7ebf\u7a0b\u83b7\u53d6\u9501\uff0c\u662f\u516c\u5e73\u9501 \u6bd4\u8f83\u5178\u578b\u7684AQS\u5b9e\u73b0\u7c7bReentrantLock\uff0c\u5b83\u9ed8\u8ba4\u5c31\u662f\u975e\u516c\u5e73\u9501\uff0c\u65b0\u7684\u7ebf\u7a0b\u4e0e\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u5171\u540c\u6765\u62a2\u8d44\u6e90 2.5 ReentrantLock\u7684\u5b9e\u73b0\u539f\u7406 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 2.5.1 \u6982\u8ff0 ReentrantLock\u7ffb\u8bd1\u8fc7\u6765\u662f\u53ef\u91cd\u5165\u9501\uff0c\u76f8\u5bf9\u4e8esynchronized\u5b83\u5177\u5907\u4ee5\u4e0b\u7279\u70b9\uff1a \u53ef\u4e2d\u65ad \u53ef\u4ee5\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 \u53ef\u4ee5\u8bbe\u7f6e\u516c\u5e73\u9501 \u652f\u6301\u591a\u4e2a\u6761\u4ef6\u53d8\u91cf \u4e0esynchronized\u4e00\u6837\uff0c\u90fd\u652f\u6301\u91cd\u5165 2.5.2 \u5b9e\u73b0\u539f\u7406 ReentrantLock\u4e3b\u8981\u5229\u7528CAS+AQS\u961f\u5217\u6765\u5b9e\u73b0\u3002\u5b83\u652f\u6301\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501\uff0c\u4e24\u8005\u7684\u5b9e\u73b0\u7c7b\u4f3c \u6784\u9020\u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u7684\u516c\u5e73\u53c2\u6570\uff08\u9ed8\u8ba4\u975e\u516c\u5e73\u9501\uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\uff0c\u8868\u793a\u516c\u5e73\u9501\uff0c\u5426\u5219\u4e3a\u975e\u516c\u5e73\u9501\u3002\u516c\u5e73\u9501\u7684\u6548\u7387\u5f80\u5f80\u6ca1\u6709\u975e\u516c\u5e73\u9501\u7684\u6548\u7387\u9ad8\uff0c\u5728\u8bb8\u591a\u7ebf\u7a0b\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\uff0c\u516c\u5e73\u9501\u8868\u73b0\u51fa\u8f83\u4f4e\u7684\u541e\u5410\u91cf\u3002 \u67e5\u770bReentrantLock\u6e90\u7801\u4e2d\u7684\u6784\u9020\u65b9\u6cd5\uff1a \u63d0\u4f9b\u4e86\u4e24\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u5e26\u53c2\u6570\u7684\u9ed8\u8ba4\u4e3a\u975e\u516c\u5e73 \u5982\u679c\u4f7f\u7528\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u5e76\u4e14\u4f20\u7684\u503c\u4e3atrue\uff0c\u5219\u662f\u516c\u5e73\u9501 \u5176\u4e2dNonfairSync\u548cFairSync\u8fd9\u4e24\u4e2a\u7c7b\u7236\u7c7b\u90fd\u662fSync \u800cSync\u7684\u7236\u7c7b\u662fAQS\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u51faReentrantLock\u5e95\u5c42\u4e3b\u8981\u5b9e\u73b0\u5c31\u662f\u57fa\u4e8eAQS\u6765\u5b9e\u73b0\u7684 \u5de5\u4f5c\u6d41\u7a0b \u7ebf\u7a0b\u6765\u62a2\u9501\u540e\u4f7f\u7528cas\u7684\u65b9\u5f0f\u4fee\u6539state\u72b6\u6001\uff0c\u4fee\u6539\u72b6\u6001\u6210\u529f\u4e3a1\uff0c\u5219\u8ba9exclusiveOwnerThread\u5c5e\u6027\u6307\u5411\u5f53\u524d\u7ebf\u7a0b\uff0c\u83b7\u53d6\u9501\u6210\u529f \u5047\u5982\u4fee\u6539\u72b6\u6001\u5931\u8d25\uff0c\u5219\u4f1a\u8fdb\u5165\u53cc\u5411\u961f\u5217\u4e2d\u7b49\u5f85\uff0chead\u6307\u5411\u53cc\u5411\u961f\u5217\u5934\u90e8\uff0ctail\u6307\u5411\u53cc\u5411\u961f\u5217\u5c3e\u90e8 \u5f53exclusiveOwnerThread\u4e3anull\u7684\u65f6\u5019\uff0c\u5219\u4f1a\u5524\u9192\u5728\u53cc\u5411\u961f\u5217\u4e2d\u7b49\u5f85\u7684\u7ebf\u7a0b \u516c\u5e73\u9501\u5219\u4f53\u73b0\u5728\u6309\u7167\u5148\u540e\u987a\u5e8f\u83b7\u53d6\u9501\uff0c\u975e\u516c\u5e73\u4f53\u73b0\u5728\u4e0d\u5728\u6392\u961f\u7684\u7ebf\u7a0b\u4e5f\u53ef\u4ee5\u62a2\u9501 2.6 synchronized\u548cLock\u6709\u4ec0\u4e48\u533a\u522b ? \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54 \u8bed\u6cd5\u5c42\u9762 synchronized \u662f\u5173\u952e\u5b57\uff0c\u6e90\u7801\u5728 jvm \u4e2d\uff0c\u7528 c++ \u8bed\u8a00\u5b9e\u73b0 Lock \u662f\u63a5\u53e3\uff0c\u6e90\u7801\u7531 jdk \u63d0\u4f9b\uff0c\u7528 java \u8bed\u8a00\u5b9e\u73b0 \u4f7f\u7528 synchronized \u65f6\uff0c\u9000\u51fa\u540c\u6b65\u4ee3\u7801\u5757\u9501\u4f1a\u81ea\u52a8\u91ca\u653e\uff0c\u800c\u4f7f\u7528 Lock \u65f6\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 unlock \u65b9\u6cd5\u91ca\u653e\u9501 \u529f\u80fd\u5c42\u9762 \u4e8c\u8005\u5747\u5c5e\u4e8e\u60b2\u89c2\u9501\u3001\u90fd\u5177\u5907\u57fa\u672c\u7684\u4e92\u65a5\u3001\u540c\u6b65\u3001\u9501\u91cd\u5165\u529f\u80fd Lock \u63d0\u4f9b\u4e86\u8bb8\u591a synchronized \u4e0d\u5177\u5907\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u83b7\u53d6\u7b49\u5f85\u72b6\u6001\u3001\u516c\u5e73\u9501\u3001\u53ef\u6253\u65ad\u3001\u53ef\u8d85\u65f6\u3001\u591a\u6761\u4ef6\u53d8\u91cf Lock \u6709\u9002\u5408\u4e0d\u540c\u573a\u666f\u7684\u5b9e\u73b0\uff0c\u5982 ReentrantLock\uff0c ReentrantReadWriteLock \u6027\u80fd\u5c42\u9762 \u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff0csynchronized \u505a\u4e86\u5f88\u591a\u4f18\u5316\uff0c\u5982\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u4e0d\u8d56 \u5728\u7ade\u4e89\u6fc0\u70c8\u65f6\uff0cLock \u7684\u5b9e\u73b0\u901a\u5e38\u4f1a\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd 2.7 \u6b7b\u9501\u4ea7\u751f\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u6b7b\u9501 \uff1a\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u540c\u65f6\u83b7\u53d6\u591a\u628a\u9501\uff0c\u8fd9\u65f6\u5c31\u5bb9\u6613\u53d1\u751f\u6b7b\u9501 \u4f8b\u5982\uff1a t1 \u7ebf\u7a0b\u83b7\u5f97A\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6B\u5bf9\u8c61\u7684\u9501 t2 \u7ebf\u7a0b\u83b7\u5f97B\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6A\u5bf9\u8c61\u7684\u9501 \u4ee3\u7801\u5982\u4e0b\uff1a package com.itheima.basic; import static java.lang.Thread.sleep; public class Deadlock { public static void main(String[] args) { Object A = new Object(); Object B = new Object(); Thread t1 = new Thread(() -> { synchronized (A) { System.out.println(\"lock A\"); try { sleep(1000); } catch (InterruptedException e) { throw new RuntimeException(e); } synchronized (B) { System.out.println(\"lock B\"); System.out.println(\"\u64cd\u4f5c...\"); } } }, \"t1\"); Thread t2 = new Thread(() -> { synchronized (B) { System.out.println(\"lock B\"); try { sleep(500); } catch (InterruptedException e) { throw new RuntimeException(e); } synchronized (A) { System.out.println(\"lock A\"); System.out.println(\"\u64cd\u4f5c...\"); } } }, \"t2\"); t1.start(); t2.start(); } } \u63a7\u5236\u53f0\u8f93\u51fa\u7ed3\u679c \u6b64\u65f6\u7a0b\u5e8f\u5e76\u6ca1\u6709\u7ed3\u675f\uff0c\u8fd9\u79cd\u73b0\u8c61\u5c31\u662f\u6b7b\u9501\u73b0\u8c61...\u7ebf\u7a0bt1\u6301\u6709A\u7684\u9501\u7b49\u5f85\u83b7\u53d6B\u9501\uff0c\u7ebf\u7a0bt2\u6301\u6709B\u7684\u9501\u7b49\u5f85\u83b7\u53d6A\u7684\u9501\u3002 2.8 \u5982\u4f55\u8fdb\u884c\u6b7b\u9501\u8bca\u65ad\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5f53\u7a0b\u5e8f\u51fa\u73b0\u4e86\u6b7b\u9501\u73b0\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528jdk\u81ea\u5e26\u7684\u5de5\u5177\uff1ajps\u548c jstack \u6b65\u9aa4\u5982\u4e0b\uff1a \u7b2c\u4e00\uff1a\u67e5\u770b\u8fd0\u884c\u7684\u7ebf\u7a0b \u7b2c\u4e8c\uff1a\u4f7f\u7528jstack\u67e5\u770b\u7ebf\u7a0b\u8fd0\u884c\u7684\u60c5\u51b5\uff0c\u4e0b\u56fe\u662f\u622a\u56fe\u7684\u5173\u952e\u4fe1\u606f \u8fd0\u884c\u547d\u4ee4\uff1a jstack -l 46032 \u5176\u4ed6\u89e3\u51b3\u5de5\u5177\uff0c\u53ef\u89c6\u5316\u5de5\u5177 jconsole \u7528\u4e8e\u5bf9jvm\u7684\u5185\u5b58\uff0c\u7ebf\u7a0b\uff0c\u7c7b \u7684\u76d1\u63a7\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8e jmx \u7684 GUI \u6027\u80fd\u76d1\u63a7\u5de5\u5177 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jconsole.exe \u5c31\u884c VisualVM\uff1a\u6545\u969c\u5904\u7406\u5de5\u5177 \u80fd\u591f\u76d1\u63a7\u7ebf\u7a0b\uff0c\u5185\u5b58\u60c5\u51b5\uff0c\u67e5\u770b\u65b9\u6cd5\u7684CPU\u65f6\u95f4\u548c\u5185\u5b58\u4e2d\u7684\u5bf9 \u8c61\uff0c\u5df2\u88abGC\u7684\u5bf9\u8c61\uff0c\u53cd\u5411\u67e5\u770b\u5206\u914d\u7684\u5806\u6808 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jvisualvm.exe\u5c31\u884c 2.10 ConcurrentHashMap \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 ConcurrentHashMap \u662f\u4e00\u79cd\u7ebf\u7a0b\u5b89\u5168\u7684\u9ad8\u6548Map\u96c6\u5408 \u5e95\u5c42\u6570\u636e\u7ed3\u6784\uff1a JDK1.7\u5e95\u5c42\u91c7\u7528\u5206\u6bb5\u7684\u6570\u7ec4+\u94fe\u8868\u5b9e\u73b0 JDK1.8 \u91c7\u7528\u7684\u6570\u636e\u7ed3\u6784\u8ddfHashMap1.8\u7684\u7ed3\u6784\u4e00\u6837\uff0c\u6570\u7ec4+\u94fe\u8868/\u7ea2\u9ed1\u4e8c\u53c9\u6811\u3002 \uff081\uff09 JDK1.7\u4e2dconcurrentHashMap \u6570\u636e\u7ed3\u6784 \u63d0\u4f9b\u4e86\u4e00\u4e2asegment\u6570\u7ec4\uff0c\u5728\u521d\u59cb\u5316ConcurrentHashMap \u7684\u65f6\u5019\u53ef\u4ee5\u6307\u5b9a\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u9ed8\u8ba4\u662f16\uff0c\u4e00\u65e6\u521d\u59cb\u5316\u4e4b\u540e\u4e2d\u95f4\u4e0d\u53ef\u6269\u5bb9 \u5728\u6bcf\u4e2asegment\u4e2d\u90fd\u53ef\u4ee5\u6302\u4e00\u4e2aHashEntry\u6570\u7ec4\uff0c\u6570\u7ec4\u91cc\u9762\u53ef\u4ee5\u5b58\u50a8\u5177\u4f53\u7684\u5143\u7d20\uff0cHashEntry\u6570\u7ec4\u662f\u53ef\u4ee5\u6269\u5bb9\u7684 \u5728HashEntry\u5b58\u50a8\u7684\u6570\u7ec4\u4e2d\u5b58\u50a8\u7684\u5143\u7d20\uff0c\u5982\u679c\u53d1\u751f\u51b2\u7a81\uff0c\u5219\u53ef\u4ee5\u6302\u5355\u5411\u94fe\u8868 \u5b58\u50a8\u6d41\u7a0b \u5148\u53bb\u8ba1\u7b97key\u7684hash\u503c\uff0c\u7136\u540e\u786e\u5b9asegment\u6570\u7ec4\u4e0b\u6807 \u518d\u901a\u8fc7hash\u503c\u786e\u5b9ahashEntry\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5b58\u50a8\u6570\u636e \u5728\u8fdb\u884c\u64cd\u4f5c\u6570\u636e\u7684\u4e4b\u524d\uff0c\u4f1a\u5148\u5224\u65ad\u5f53\u524dsegment\u5bf9\u5e94\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u7ebf\u7a0b\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e3a\u4e86\u7ebf\u7a0b\u5b89\u5168\u4f7f\u7528\u7684\u662fReentrantLock\u8fdb\u884c\u52a0\u9501\uff0c\u5982\u679c\u83b7\u53d6\u9501\u662f\u88ab\u4f1a\u4f7f\u7528cas\u81ea\u65cb\u9501\u8fdb\u884c\u5c1d\u8bd5 \uff082\uff09 JDK1.8\u4e2dconcurrentHashMap \u5728JDK1.8\u4e2d\uff0c\u653e\u5f03\u4e86Segment\u81c3\u80bf\u7684\u8bbe\u8ba1\uff0c\u6570\u636e\u7ed3\u6784\u8ddfHashMap\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e00\u6837\u7684\uff1a\u6570\u7ec4+\u7ea2\u9ed1\u6811+\u94fe\u8868 \u91c7\u7528 CAS + Synchronized\u6765\u4fdd\u8bc1\u5e76\u53d1\u5b89\u5168\u8fdb\u884c\u5b9e\u73b0 CAS\u63a7\u5236\u6570\u7ec4\u8282\u70b9\u7684\u6dfb\u52a0 synchronized\u53ea\u9501\u5b9a\u5f53\u524d\u94fe\u8868\u6216\u7ea2\u9ed1\u4e8c\u53c9\u6811\u7684\u9996\u8282\u70b9\uff0c\u53ea\u8981hash\u4e0d\u51b2\u7a81\uff0c\u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1\u7684\u95ee\u9898 , \u6548\u7387\u5f97\u5230\u63d0\u5347 2.11 \u5bfc\u81f4\u5e76\u53d1\u7a0b\u5e8f\u51fa\u73b0\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0\u662f\u4ec0\u4e48 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 Java\u5e76\u53d1\u7f16\u7a0b\u4e09\u5927\u7279\u6027 \u539f\u5b50\u6027 \u53ef\u89c1\u6027 \u6709\u5e8f\u6027 \uff081\uff09\u539f\u5b50\u6027 \u4e00\u4e2a\u7ebf\u7a0b\u5728CPU\u4e2d\u64cd\u4f5c\u4e0d\u53ef\u6682\u505c\uff0c\u4e5f\u4e0d\u53ef\u4e2d\u65ad\uff0c\u8981\u4e0d\u6267\u884c\u5b8c\u6210\uff0c\u8981\u4e0d\u4e0d\u6267\u884c \u6bd4\u5982\uff0c\u5982\u4e0b\u4ee3\u7801\u80fd\u4fdd\u8bc1\u539f\u5b50\u6027\u5417\uff1f \u4ee5\u4e0a\u4ee3\u7801\u4f1a\u51fa\u73b0\u8d85\u5356\u6216\u8005\u662f\u4e00\u5f20\u7968\u5356\u7ed9\u540c\u4e00\u4e2a\u4eba\uff0c\u6267\u884c\u5e76\u4e0d\u662f\u539f\u5b50\u6027\u7684 \u89e3\u51b3\u65b9\u6848\uff1a 1.synchronized\uff1a\u540c\u6b65\u52a0\u9501 2.JUC\u91cc\u9762\u7684lock\uff1a\u52a0\u9501 \uff083\uff09\u5185\u5b58\u53ef\u89c1\u6027 \u5185\u5b58\u53ef\u89c1\u6027\uff1a\u8ba9\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u4fee\u6539\u5bf9\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u89c1 \u6bd4\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u4e0d\u80fd\u4fdd\u8bc1\u5185\u5b58\u53ef\u89c1\u6027 \u89e3\u51b3\u65b9\u6848\uff1a synchronized volatile\uff08\u63a8\u8350\uff09 LOCK \uff083\uff09\u6709\u5e8f\u6027 \u6307\u4ee4\u91cd\u6392\uff1a\u5904\u7406\u5668\u4e3a\u4e86\u63d0\u9ad8\u7a0b\u5e8f\u8fd0\u884c\u6548\u7387\uff0c\u53ef\u80fd\u4f1a\u5bf9\u8f93\u5165\u4ee3\u7801\u8fdb\u884c\u4f18\u5316\uff0c\u5b83\u4e0d\u4fdd\u8bc1\u7a0b\u5e8f\u4e2d\u5404\u4e2a\u8bed\u53e5\u7684\u6267\u884c\u5148\u540e\u987a\u5e8f\u540c\u4ee3\u7801\u4e2d\u7684\u987a\u5e8f\u4e00\u81f4\uff0c\u4f46\u662f\u5b83\u4f1a\u4fdd\u8bc1\u7a0b\u5e8f\u6700\u7ec8\u6267\u884c\u7ed3\u679c\u548c\u4ee3\u7801\u987a\u5e8f\u6267\u884c\u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684 \u8fd8\u662f\u4e4b\u524d\u7684\u4f8b\u5b50\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a \u89e3\u51b3\u65b9\u6848\uff1a volatile 3.\u7ebf\u7a0b\u6c60 3.1 \u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u53c2\u6570\uff08\u7ebf\u7a0b\u6c60\u7684\u6267\u884c\u539f\u7406\u77e5\u9053\u561b\uff09 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u4e3b\u8981\u53c2\u8003ThreadPoolExecutor\u8fd9\u4e2a\u7c7b\u76847\u4e2a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570 corePoolSize \u6838\u5fc3\u7ebf\u7a0b\u6570\u76ee maximumPoolSize \u6700\u5927\u7ebf\u7a0b\u6570\u76ee = (\u6838\u5fc3\u7ebf\u7a0b+\u6551\u6025\u7ebf\u7a0b\u7684\u6700\u5927\u6570\u76ee) keepAliveTime \u751f\u5b58\u65f6\u95f4 - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u751f\u5b58\u65f6\u95f4\u5185\u6ca1\u6709\u65b0\u4efb\u52a1\uff0c\u6b64\u7ebf\u7a0b\u8d44\u6e90\u4f1a\u91ca\u653e unit \u65f6\u95f4\u5355\u4f4d - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\u5355\u4f4d\uff0c\u5982\u79d2\u3001\u6beb\u79d2\u7b49 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 threadFactory \u7ebf\u7a0b\u5de5\u5382 - \u53ef\u4ee5\u5b9a\u5236\u7ebf\u7a0b\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u4f8b\u5982\u8bbe\u7f6e\u7ebf\u7a0b\u540d\u5b57\u3001\u662f\u5426\u662f\u5b88\u62a4\u7ebf\u7a0b\u7b49 handler \u62d2\u7edd\u7b56\u7565 - \u5f53\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0cworkQueue \u4e5f\u653e\u6ee1\u65f6\uff0c\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565 \u5de5\u4f5c\u6d41\u7a0b 1\uff0c\u4efb\u52a1\u5728\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u9996\u5148\u5224\u65ad\u6838\u5fc3\u7ebf\u7a0b\u6570\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u6ca1\u6709\u6ee1\u5219\u76f4\u63a5\u6dfb\u52a0\u5230\u5de5\u4f5c\u7ebf\u7a0b\u6267\u884c 2\uff0c\u5982\u679c\u6838\u5fc3\u7ebf\u7a0b\u6570\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u963b\u585e\u961f\u5217\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u6ca1\u6709\u6ee1\uff0c\u5f53\u524d\u4efb\u52a1\u5b58\u5165\u963b\u585e\u961f\u5217 3\uff0c\u5982\u679c\u963b\u585e\u961f\u5217\u4e5f\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u7ebf\u7a0b\u6570\u662f\u5426\u5c0f\u4e8e\u6700\u5927\u7ebf\u7a0b\u6570\uff0c\u5982\u679c\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u4f7f\u7528\u4e34\u65f6\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 \u5982\u679c\u6838\u5fc3\u6216\u4e34\u65f6\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u4efb\u52a1\u540e\u4f1a\u68c0\u67e5\u963b\u585e\u961f\u5217\u4e2d\u662f\u5426\u6709\u9700\u8981\u6267\u884c\u7684\u7ebf\u7a0b\uff0c\u5982\u679c\u6709\uff0c\u5219\u4f7f\u7528\u975e\u6838\u5fc3\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 4\uff0c\u5982\u679c\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u5fd9\u7740\uff08\u6838\u5fc3\u7ebf\u7a0b+\u4e34\u65f6\u7ebf\u7a0b\uff09\uff0c\u5219\u8d70\u62d2\u7edd\u7b56\u7565 \u62d2\u7edd\u7b56\u7565\uff1a 1.AbortPolicy\uff1a\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\uff0c\u9ed8\u8ba4\u7b56\u7565\uff1b 2.CallerRunsPolicy\uff1a\u7528\u8c03\u7528\u8005\u6240\u5728\u7684\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\uff1b 3.DiscardOldestPolicy\uff1a\u4e22\u5f03\u963b\u585e\u961f\u5217\u4e2d\u9760\u6700\u524d\u7684\u4efb\u52a1\uff0c\u5e76\u6267\u884c\u5f53\u524d\u4efb\u52a1\uff1b 4.DiscardPolicy\uff1a\u76f4\u63a5\u4e22\u5f03\u4efb\u52a1\uff1b \u53c2\u8003\u4ee3\u7801\uff1a public class TestThreadPoolExecutor { static class MyTask implements Runnable { private final String name; private final long duration; public MyTask(String name) { this(name, 0); } public MyTask(String name, long duration) { this.name = name; this.duration = duration; } @Override public void run() { try { LoggerUtils.get(\"myThread\").debug(\"running...\" + this); Thread.sleep(duration); } catch (InterruptedException e) { e.printStackTrace(); } } @Override public String toString() { return \"MyTask(\" + name + \")\"; } } public static void main(String[] args) throws InterruptedException { AtomicInteger c = new AtomicInteger(1); ArrayBlockingQueue<Runnable> queue = new ArrayBlockingQueue<>(2); ThreadPoolExecutor threadPool = new ThreadPoolExecutor( 2, 3, 0, TimeUnit.MILLISECONDS, queue, r -> new Thread(r, \"myThread\" + c.getAndIncrement()), new ThreadPoolExecutor.AbortPolicy()); showState(queue, threadPool); threadPool.submit(new MyTask(\"1\", 3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"2\", 3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"3\")); showState(queue, threadPool); threadPool.submit(new MyTask(\"4\")); showState(queue, threadPool); threadPool.submit(new MyTask(\"5\",3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"6\")); showState(queue, threadPool); } private static void showState(ArrayBlockingQueue<Runnable> queue, ThreadPoolExecutor threadPool) { try { Thread.sleep(300); } catch (InterruptedException e) { e.printStackTrace(); } List<Object> tasks = new ArrayList<>(); for (Runnable runnable : queue) { try { Field callable = FutureTask.class.getDeclaredField(\"callable\"); callable.setAccessible(true); Object adapter = callable.get(runnable); Class<?> clazz = Class.forName(\"java.util.concurrent.Executors$RunnableAdapter\"); Field task = clazz.getDeclaredField(\"task\"); task.setAccessible(true); Object o = task.get(adapter); tasks.add(o); } catch (Exception e) { e.printStackTrace(); } } LoggerUtils.main.debug(\"pool size: {}, queue: {}\", threadPool.getPoolSize(), tasks); } } 3.2 \u7ebf\u7a0b\u6c60\u4e2d\u6709\u54ea\u4e9b\u5e38\u89c1\u7684\u963b\u585e\u961f\u5217 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 \u6bd4\u8f83\u5e38\u89c1\u7684\u67094\u4e2a\uff0c\u7528\u7684\u6700\u591a\u662fArrayBlockingQueue\u548cLinkedBlockingQueue 1.ArrayBlockingQueue\uff1a\u57fa\u4e8e\u6570\u7ec4\u7ed3\u6784\u7684\u6709\u754c\u963b\u585e\u961f\u5217\uff0cFIFO\u3002 2.LinkedBlockingQueue\uff1a\u57fa\u4e8e\u94fe\u8868\u7ed3\u6784\u7684\u6709\u754c\u963b\u585e\u961f\u5217\uff0cFIFO\u3002 3.DelayedWorkQueue \uff1a\u662f\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u51fa\u961f\u7684\u4efb\u52a1\u90fd\u662f\u5f53\u524d\u961f\u5217\u4e2d\u6267\u884c\u65f6\u95f4\u6700\u9760\u524d\u7684 4.SynchronousQueue\uff1a\u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u6bcf\u4e2a\u63d2\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2a\u79fb\u51fa\u64cd\u4f5c\u3002 ArrayBlockingQueue\u7684LinkedBlockingQueue\u533a\u522b LinkedBlockingQueue ArrayBlockingQueue \u9ed8\u8ba4\u65e0\u754c\uff0c\u652f\u6301\u6709\u754c \u5f3a\u5236\u6709\u754c \u5e95\u5c42\u662f\u94fe\u8868 \u5e95\u5c42\u662f\u6570\u7ec4 \u662f\u61d2\u60f0\u7684\uff0c\u521b\u5efa\u8282\u70b9\u7684\u65f6\u5019\u6dfb\u52a0\u6570\u636e \u63d0\u524d\u521d\u59cb\u5316 Node \u6570\u7ec4 \u5165\u961f\u4f1a\u751f\u6210\u65b0 Node Node\u9700\u8981\u662f\u63d0\u524d\u521b\u5efa\u597d\u7684 \u4e24\u628a\u9501\uff08\u5934\u5c3e\uff09 \u4e00\u628a\u9501 \u5de6\u8fb9\u662fLinkedBlockingQueue\u52a0\u9501\u7684\u65b9\u5f0f\uff0c\u53f3\u8fb9\u662fArrayBlockingQueue\u52a0\u9501\u7684\u65b9\u5f0f LinkedBlockingQueue\u8bfb\u548c\u5199\u5404\u6709\u4e00\u628a\u9501\uff0c\u6027\u80fd\u76f8\u5bf9\u8f83\u597d ArrayBlockingQueue\u53ea\u6709\u4e00\u628a\u9501\uff0c\u8bfb\u548c\u5199\u516c\u7528\uff0c\u6027\u80fd\u76f8\u5bf9\u4e8eLinkedBlockingQueue\u5dee\u4e00\u4e9b 3.3 \u5982\u4f55\u786e\u5b9a\u6838\u5fc3\u7ebf\u7a0b\u6570 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728\u8bbe\u7f6e\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e4b\u524d\uff0c\u9700\u8981\u5148\u719f\u6089\u4e00\u4e9b\u6267\u884c\u7ebf\u7a0b\u6c60\u6267\u884c\u4efb\u52a1\u7684\u7c7b\u578b IO\u5bc6\u96c6\u578b\u4efb\u52a1 \u4e00\u822c\u6765\u8bf4\uff1a\u6587\u4ef6\u8bfb\u5199\u3001DB\u8bfb\u5199\u3001\u7f51\u7edc\u8bf7\u6c42\u7b49 \u63a8\u8350\uff1a\u6838\u5fc3\u7ebf\u7a0b\u6570\u5927\u5c0f\u8bbe\u7f6e\u4e3a2N+1 \uff08N\u4e3a\u8ba1\u7b97\u673a\u7684CPU\u6838\u6570\uff09 CPU\u5bc6\u96c6\u578b\u4efb\u52a1 \u4e00\u822c\u6765\u8bf4\uff1a\u8ba1\u7b97\u578b\u4ee3\u7801\u3001Bitmap\u8f6c\u6362\u3001Gson\u8f6c\u6362\u7b49 \u63a8\u8350\uff1a\u6838\u5fc3\u7ebf\u7a0b\u6570\u5927\u5c0f\u8bbe\u7f6e\u4e3aN+1 \uff08N\u4e3a\u8ba1\u7b97\u673a\u7684CPU\u6838\u6570\uff09 java\u4ee3\u7801\u67e5\u770bCPU\u6838\u6570 \u53c2\u8003\u56de\u7b54\uff1a \u2460 \u9ad8\u5e76\u53d1\u3001\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u77ed -->\uff08 CPU\u6838\u6570+1 \uff09\uff0c\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7684\u5207\u6362 \u2461 \u5e76\u53d1\u4e0d\u9ad8\u3001\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u957f IO\u5bc6\u96c6\u578b\u7684\u4efb\u52a1 --> (CPU\u6838\u6570 * 2 + 1) \u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1 --> \uff08 CPU\u6838\u6570+1 \uff09 \u2462 \u5e76\u53d1\u9ad8\u3001\u4e1a\u52a1\u6267\u884c\u65f6\u95f4\u957f\uff0c\u89e3\u51b3\u8fd9\u79cd\u7c7b\u578b\u4efb\u52a1\u7684\u5173\u952e\u4e0d\u5728\u4e8e\u7ebf\u7a0b\u6c60\u800c\u5728\u4e8e\u6574\u4f53\u67b6\u6784\u7684\u8bbe\u8ba1\uff0c\u770b\u770b\u8fd9\u4e9b\u4e1a\u52a1\u91cc\u9762\u67d0\u4e9b\u6570\u636e\u662f\u5426\u80fd\u505a\u7f13\u5b58\u662f\u7b2c\u4e00\u6b65\uff0c\u589e\u52a0\u670d\u52a1\u5668\u662f\u7b2c\u4e8c\u6b65\uff0c\u81f3\u4e8e\u7ebf\u7a0b\u6c60\u7684\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u53c2\u8003\uff082\uff09 3.4 \u7ebf\u7a0b\u6c60\u7684\u79cd\u7c7b\u6709\u54ea\u4e9b \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728java.util.concurrent.Executors\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u5927\u91cf\u521b\u5efa\u8fde\u63a5\u6c60\u7684\u9759\u6001\u65b9\u6cd5\uff0c\u5e38\u89c1\u5c31\u6709\u56db\u79cd \u521b\u5efa\u4f7f\u7528\u56fa\u5b9a\u7ebf\u7a0b\u6570\u7684\u7ebf\u7a0b\u6c60 \u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0e\u6700\u5927\u7ebf\u7a0b\u6570\u4e00\u6837\uff0c\u6ca1\u6709\u6551\u6025\u7ebf\u7a0b \u963b\u585e\u961f\u5217\u662fLinkedBlockingQueue\uff0c\u6700\u5927\u5bb9\u91cf\u4e3aInteger.MAX_VALUE \u9002\u7528\u573a\u666f\uff1a\u9002\u7528\u4e8e\u4efb\u52a1\u91cf\u5df2\u77e5\uff0c\u76f8\u5bf9\u8017\u65f6\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class FixedThreadPoolCase { static class FixedThreadDemo implements Runnable{ @Override public void run() { String name = Thread.currentThread().getName(); for (int i = 0; i < 2; i++) { System.out.println(name + \":\" + i); } } } public static void main(String[] args) throws InterruptedException { //\u521b\u5efa\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f3 ExecutorService executorService = Executors.newFixedThreadPool(3); for (int i = 0; i < 5; i++) { executorService.submit(new FixedThreadDemo()); Thread.sleep(10); } executorService.shutdown(); } } ``` \u5355\u7ebf\u7a0b\u5316\u7684\u7ebf\u7a0b\u6c60\uff0c\u5b83\u53ea\u4f1a\u7528\u552f\u4e00\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\uff0c\u4fdd\u8bc1\u6240\u6709\u4efb\u52a1\u6309\u7167\u6307\u5b9a\u987a\u5e8f(FIFO)\u6267\u884c \u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f1 \u963b\u585e\u961f\u5217\u662fLinkedBlockingQueue\uff0c\u6700\u5927\u5bb9\u91cf\u4e3aInteger.MAX_VALUE \u9002\u7528\u573a\u666f\uff1a\u9002\u7528\u4e8e\u6309\u7167\u987a\u5e8f\u6267\u884c\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class NewSingleThreadCase { static int count = 0; static class Demo implements Runnable { @Override public void run() { count++; System.out.println(Thread.currentThread().getName() + \":\" + count); } } public static void main(String[] args) throws InterruptedException { //\u5355\u4e2a\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f1 ExecutorService exec = Executors.newSingleThreadExecutor(); for (int i = 0; i < 10; i++) { exec.execute(new Demo()); Thread.sleep(5); } exec.shutdown(); } } ``` \u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60 \u6838\u5fc3\u7ebf\u7a0b\u6570\u4e3a0 \u6700\u5927\u7ebf\u7a0b\u6570\u662fInteger.MAX_VALUE \u963b\u585e\u961f\u5217\u4e3aSynchronousQueue:\u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u6bcf\u4e2a\u63d2\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2a\u79fb\u51fa\u64cd\u4f5c\u3002 \u9002\u7528\u573a\u666f\uff1a\u9002\u5408\u4efb\u52a1\u6570\u6bd4\u8f83\u5bc6\u96c6\uff0c\u4f46\u6bcf\u4e2a\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u8f83\u77ed\u7684\u60c5\u51b5 \u6848\u4f8b\uff1a ```java public class CachedThreadPoolCase { static class Demo implements Runnable { @Override public void run() { String name = Thread.currentThread().getName(); try { //\u4fee\u6539\u7761\u7720\u65f6\u95f4\uff0c\u6a21\u62df\u7ebf\u7a0b\u6267\u884c\u9700\u8981\u82b1\u8d39\u7684\u65f6\u95f4 Thread.sleep(100); System.out.println(name + \"\u6267\u884c\u5b8c\u4e86\"); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { //\u521b\u5efa\u4e00\u4e2a\u7f13\u5b58\u7684\u7ebf\u7a0b\uff0c\u6ca1\u6709\u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u6700\u5927\u7ebf\u7a0b\u6570\u4e3aInteger.MAX_VALUE ExecutorService exec = Executors.newCachedThreadPool(); for (int i = 0; i < 10; i++) { exec.execute(new Demo()); Thread.sleep(1); } exec.shutdown(); } } ``` \u63d0\u4f9b\u4e86\u201c\u5ef6\u8fdf\u201d\u548c\u201c\u5468\u671f\u6267\u884c\u201d\u529f\u80fd\u7684ThreadPoolExecutor\u3002 \u9002\u7528\u573a\u666f\uff1a\u6709\u5b9a\u65f6\u548c\u5ef6\u8fdf\u6267\u884c\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class ScheduledThreadPoolCase { static class Task implements Runnable { @Override public void run() { try { String name = Thread.currentThread().getName(); System.out.println(name + \", \u5f00\u59cb\uff1a\" + new Date()); Thread.sleep(1000); System.out.println(name + \", \u7ed3\u675f\uff1a\" + new Date()); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { //\u6309\u7167\u5468\u671f\u6267\u884c\u7684\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e3a2\uff0c\u6700\u5927\u7ebf\u7a0b\u6570\u4e3aInteger.MAX_VALUE ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(2); System.out.println(\"\u7a0b\u5e8f\u5f00\u59cb\uff1a\" + new Date()); /** * schedule \u63d0\u4ea4\u4efb\u52a1\u5230\u7ebf\u7a0b\u6c60\u4e2d * \u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u63d0\u4ea4\u7684\u4efb\u52a1 * \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u4efb\u52a1\u6267\u884c\u7684\u5ef6\u8fdf\u65f6\u95f4 * \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1a\u65f6\u95f4\u5355\u4f4d */ scheduledThreadPool.schedule(new Task(), 0, TimeUnit.SECONDS); scheduledThreadPool.schedule(new Task(), 1, TimeUnit.SECONDS); scheduledThreadPool.schedule(new Task(), 5, TimeUnit.SECONDS); Thread.sleep(5000); // \u5173\u95ed\u7ebf\u7a0b\u6c60 scheduledThreadPool.shutdown(); } } ``` 3.5 \u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u963f\u91cc\u5f00\u53d1\u624b\u518c\u300aJava\u5f00\u53d1\u624b\u518c-\u5d69\u5c71\u7248\u300b 4.\u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u95ee\u9898 4.1 \u7ebf\u7a0b\u6c60\u4f7f\u7528\u573a\u666fCountDownLatch\u3001Future\uff08\u4f60\u4eec\u9879\u76ee\u54ea\u91cc\u7528\u5230\u4e86\u591a\u7ebf\u7a0b\uff09 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 4.1.1 CountDownLatch CountDownLatch\uff08\u95ed\u9501/\u5012\u8ba1\u65f6\u9501\uff09\u7528\u6765\u8fdb\u884c\u7ebf\u7a0b\u540c\u6b65\u534f\u4f5c\uff0c\u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u5b8c\u6210\u5012\u8ba1\u65f6\uff08\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7ebf\u7a0b\uff0c\u7b49\u5f85\u5176\u4ed6\u591a\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u67d0\u4ef6\u4e8b\u60c5\u4e4b\u540e\u624d\u80fd\u6267\u884c\uff09 \u5176\u4e2d\u6784\u9020\u53c2\u6570\u7528\u6765\u521d\u59cb\u5316\u7b49\u5f85\u8ba1\u6570\u503c await() \u7528\u6765\u7b49\u5f85\u8ba1\u6570\u5f52\u96f6 countDown() \u7528\u6765\u8ba9\u8ba1\u6570\u51cf\u4e00 \u6848\u4f8b\u4ee3\u7801\uff1a public class CountDownLatchDemo { public static void main(String[] args) throws InterruptedException { //\u521d\u59cb\u5316\u4e86\u4e00\u4e2a\u5012\u8ba1\u65f6\u9501 \u53c2\u6570\u4e3a 3 CountDownLatch latch = new CountDownLatch(3); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(1000); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(2000); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(1500); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); String name = Thread.currentThread().getName(); System.out.println(name + \"-waiting...\"); //\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u5b8c\u6210 latch.await(); System.out.println(name + \"-wait end...\"); } } 4.1.2 \u6848\u4f8b\u4e00\uff08es\u6570\u636e\u6279\u91cf\u5bfc\u5165\uff09 \u5728\u6211\u4eec\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u628a\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4e00\u6b21\u6027\u7684\u540c\u6b65\u5230es\u7d22\u5f15\u5e93\u4e2d\uff0c\u4f46\u662f\u5f53\u65f6\u7684\u6570\u636e\u597d\u50cf\u662f1000\u4e07\u5de6\u53f3\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u6570\u636e\u80af\u5b9a\u4e0d\u884c\uff08oom\u5f02\u5e38\uff09\uff0c\u5f53\u65f6\u6211\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u5bfc\u5165\uff0c\u5229\u7528CountDownLatch\u6765\u63a7\u5236\uff0c\u5c31\u80fd\u907f\u514d\u4e00\u6b21\u6027\u52a0\u8f7d\u8fc7\u591a\uff0c\u9632\u6b62\u5185\u5b58\u6ea2\u51fa \u6574\u4f53\u6d41\u7a0b\u5c31\u662f\u901a\u8fc7CountDownLatch+\u7ebf\u7a0b\u6c60\u914d\u5408\u53bb\u6267\u884c \u8be6\u7ec6\u5b9e\u73b0\u6d41\u7a0b\uff1a \u8be6\u7ec6\u5b9e\u73b0\u4ee3\u7801\uff0c\u8bf7\u67e5\u770b\u5f53\u5929\u4ee3\u7801 4.1.3 \u6848\u4f8b\u4e8c\uff08\u6570\u636e\u6c47\u603b\uff09 \u5728\u4e00\u4e2a\u7535\u5546\u7f51\u7ad9\u4e2d\uff0c\u7528\u6237\u4e0b\u5355\u4e4b\u540e\uff0c\u9700\u8981\u67e5\u8be2\u6570\u636e\uff0c\u6570\u636e\u5305\u542b\u4e86\u4e09\u90e8\u5206\uff1a\u8ba2\u5355\u4fe1\u606f\u3001\u5305\u542b\u7684\u5546\u54c1\u3001\u7269\u6d41\u4fe1\u606f\uff1b\u8fd9\u4e09\u5757\u4fe1\u606f\u90fd\u5728\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u4e2d\u8fdb\u884c\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u5982\u4f55\u5b8c\u6210\u8fd9\u4e2a\u4e1a\u52a1\u5462\uff1f \u8be6\u7ec6\u5b9e\u73b0\u4ee3\u7801\uff0c\u8bf7\u67e5\u770b\u5f53\u5929\u4ee3\u7801 \u5728\u5b9e\u9645\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u96be\u514d\u9700\u8981\u8c03\u7528\u591a\u4e2a\u63a5\u53e3\u6765\u6c47\u603b\u6570\u636e\uff0c\u5982\u679c\u6240\u6709\u63a5\u53e3\uff08\u6216\u90e8\u5206\u63a5\u53e3\uff09\u7684\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60+future\u6765\u63d0\u5347\u6027\u80fd \u62a5\u8868\u6c47\u603b 4.1.4 \u6848\u4f8b\u4e8c\uff08\u5f02\u6b65\u8c03\u7528\uff09 \u5728\u8fdb\u884c\u641c\u7d22\u7684\u65f6\u5019\uff0c\u9700\u8981\u4fdd\u5b58\u7528\u6237\u7684\u641c\u7d22\u8bb0\u5f55\uff0c\u800c\u641c\u7d22\u8bb0\u5f55\u4e0d\u80fd\u5f71\u54cd\u7528\u6237\u7684\u6b63\u5e38\u641c\u7d22\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u5386\u53f2\u8bb0\u5f55\u7684\u4fdd\u5b58\uff0c\u5728\u65b0\u5f00\u542f\u7684\u7ebf\u7a0b\u5728\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5229\u7528\u7ebf\u7a0b\u63d0\u4ea4\u4efb\u52a1 4.1 \u5982\u4f55\u63a7\u5236\u67d0\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5e76\u53d1\u8bbf\u95ee\u7ebf\u7a0b\u7684\u6570\u91cf\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 Semaphore [\u02c8s\u025bm\u0259\u02ccf\u0254r] \u4fe1\u53f7\u91cf\uff0c\u662fJUC\u5305\u4e0b\u7684\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5176\u9650\u5236\u6267\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u8fbe\u5230\u9650\u6d41\u7684\u6548\u679c \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u65f6\u5148\u901a\u8fc7\u5176\u65b9\u6cd5\u8fdb\u884c\u83b7\u53d6\u8bb8\u53ef\u64cd\u4f5c\uff0c\u83b7\u53d6\u5230\u8bb8\u53ef\u7684\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u4e1a\u52a1\u903b\u8f91\uff0c\u5f53\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u540e\u8fdb\u884c\u91ca\u653e\u8bb8\u53ef\u64cd\u4f5c\uff0c\u672a\u83b7\u53d6\u8fbe\u5230\u8bb8\u53ef\u7684\u7ebf\u7a0b\u8fdb\u884c\u7b49\u5f85\u6216\u8005\u76f4\u63a5\u7ed3\u675f\u3002 Semaphore\u4e24\u4e2a\u91cd\u8981\u7684\u65b9\u6cd5 lsemaphore.acquire()\uff1a \u8bf7\u6c42\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u8fd9\u65f6\u5019\u7684\u4fe1\u53f7\u91cf\u4e2a\u6570-1\uff08\u4e00\u65e6\u6ca1\u6709\u53ef\u4f7f\u7528\u7684\u4fe1\u53f7\u91cf\uff0c\u4e5f\u5373\u4fe1\u53f7\u91cf\u4e2a\u6570\u53d8\u4e3a\u8d1f\u6570\u65f6\uff0c\u518d\u6b21\u8bf7\u6c42\u7684\u65f6\u5019\u5c31\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u5176\u4ed6\u7ebf\u7a0b\u91ca\u653e\u4e86\u4fe1\u53f7\u91cf\uff09 lsemaphore.release()\uff1a\u91ca\u653e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u6b64\u65f6\u4fe1\u53f7\u91cf\u4e2a\u6570+1 \u7ebf\u7a0b\u4efb\u52a1\u7c7b\uff1a public class SemaphoreCase { public static void main(String[] args) { // 1. \u521b\u5efa semaphore \u5bf9\u8c61 Semaphore semaphore = new Semaphore(3); // 2. 10\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8fd0\u884c for (int i = 0; i < 10; i++) { new Thread(() -> { try { // 3. \u83b7\u53d6\u8bb8\u53ef semaphore.acquire(); } catch (InterruptedException e) { e.printStackTrace(); } try { System.out.println(\"running...\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"end...\"); } finally { // 4. \u91ca\u653e\u8bb8\u53ef semaphore.release(); } }).start(); } } } 5.\u5176\u4ed6 5.1 \u8c08\u8c08\u4f60\u5bf9ThreadLocal\u7684\u7406\u89e3 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 5.1.1 \u6982\u8ff0 ThreadLocal\u662f\u591a\u7ebf\u7a0b\u4e2d\u5bf9\u4e8e\u89e3\u51b3\u7ebf\u7a0b\u5b89\u5168\u7684\u4e00\u4e2a\u64cd\u4f5c\u7c7b\uff0c\u5b83\u4f1a\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5206\u914d\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u526f\u672c\u4ece\u800c\u89e3\u51b3\u4e86\u53d8\u91cf\u5e76\u53d1\u8bbf\u95ee\u51b2\u7a81\u7684\u95ee\u9898\u3002ThreadLocal \u540c\u65f6\u5b9e\u73b0\u4e86\u7ebf\u7a0b\u5185\u7684\u8d44\u6e90\u5171\u4eab \u6848\u4f8b\uff1a\u4f7f\u7528JDBC\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\uff0c\u4f1a\u5c06\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u7684Connection\u653e\u5165\u5404\u81ea\u7684ThreadLocal\u4e2d\uff0c\u4ece\u800c\u4fdd\u8bc1\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5728\u5404\u81ea\u7684 Connection \u4e0a\u8fdb\u884c\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c\u907f\u514dA\u7ebf\u7a0b\u5173\u95ed\u4e86B\u7ebf\u7a0b\u7684\u8fde\u63a5\u3002 5.1.2 ThreadLocal\u57fa\u672c\u4f7f\u7528 \u4e09\u4e2a\u4e3b\u8981\u65b9\u6cd5\uff1a set(value) \u8bbe\u7f6e\u503c get() \u83b7\u53d6\u503c remove() \u6e05\u9664\u503c public class ThreadLocalTest { static ThreadLocal<String> threadLocal = new ThreadLocal<>(); public static void main(String[] args) { new Thread(() -> { String name = Thread.currentThread().getName(); threadLocal.set(\"itcast\"); print(name); System.out.println(name + \"-after remove : \" + threadLocal.get()); }, \"t1\").start(); new Thread(() -> { String name = Thread.currentThread().getName(); threadLocal.set(\"itheima\"); print(name); System.out.println(name + \"-after remove : \" + threadLocal.get()); }, \"t2\").start(); } static void print(String str) { //\u6253\u5370\u5f53\u524d\u7ebf\u7a0b\u4e2d\u672c\u5730\u5185\u5b58\u4e2d\u672c\u5730\u53d8\u91cf\u7684\u503c System.out.println(str + \" :\" + threadLocal.get()); //\u6e05\u9664\u672c\u5730\u5185\u5b58\u4e2d\u7684\u672c\u5730\u53d8\u91cf threadLocal.remove(); } } 5.1.3 ThreadLocal\u7684\u5b9e\u73b0\u539f\u7406&\u6e90\u7801\u89e3\u6790 ThreadLocal\u672c\u8d28\u6765\u8bf4\u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u5185\u90e8\u5b58\u50a8\u7c7b\uff0c\u4ece\u800c\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u53ea\u64cd\u4f5c\u81ea\u5df1\u5185\u90e8\u7684\u503c\uff0c\u4ece\u800c\u5b9e\u73b0\u7ebf\u7a0b\u6570\u636e\u9694\u79bb \u5728ThreadLocal\u4e2d\u6709\u4e00\u4e2a\u5185\u90e8\u7c7b\u53eb\u505aThreadLocalMap\uff0c\u7c7b\u4f3c\u4e8eHashMap ThreadLocalMap\u4e2d\u6709\u4e00\u4e2a\u5c5e\u6027table\u6570\u7ec4\uff0c\u8fd9\u4e2a\u662f\u771f\u6b63\u5b58\u50a8\u6570\u636e\u7684\u4f4d\u7f6e set\u65b9\u6cd5 get\u65b9\u6cd5/remove\u65b9\u6cd5 5.1.4 ThreadLocal-\u5185\u5b58\u6cc4\u9732\u95ee\u9898 Java\u5bf9\u8c61\u4e2d\u7684\u56db\u79cd\u5f15\u7528\u7c7b\u578b\uff1a\u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528 \u5f3a\u5f15\u7528\uff1a\u6700\u4e3a\u666e\u901a\u7684\u5f15\u7528\u65b9\u5f0f\uff0c\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u6709\u7528\u4e14\u5fc5\u987b\u7684\u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5177\u6709\u5f3a\u5f15\u7528\uff0c\u5219GC\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\u3002\u5373\u4fbf\u5806\u4e2d\u5185\u5b58\u4e0d\u8db3\u4e86\uff0c\u5b81\u53ef\u51fa\u73b0OOM\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u56de\u6536 \u5f31\u5f15\u7528\uff1a\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u53ef\u80fd\u6709\u7528\u4e14\u975e\u5fc5\u987b\u7684\u72b6\u6001\u3002\u5728GC\u7ebf\u7a0b\u626b\u63cf\u5185\u5b58\u533a\u57df\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u5f31\u5f15\u7528\uff0c\u5c31\u4f1a\u56de\u6536\u5230\u5f31\u5f15\u7528\u76f8\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u5f31\u5f15\u7528\u7684\u56de\u6536\uff0c\u65e0\u5173\u5185\u5b58\u533a\u57df\u662f\u5426\u8db3\u591f\uff0c\u4e00\u65e6\u53d1\u73b0\u5219\u4f1a\u88ab\u56de\u6536 \u6bcf\u4e00\u4e2aThread\u7ef4\u62a4\u4e00\u4e2aThreadLocalMap\uff0c\u5728ThreadLocalMap\u4e2d\u7684Entry\u5bf9\u8c61\u7ee7\u627f\u4e86WeakReference\u3002\u5176\u4e2dkey\u4e3a\u4f7f\u7528\u5f31\u5f15\u7528\u7684ThreadLocal\u5b9e\u4f8b\uff0cvalue\u4e3a\u7ebf\u7a0b\u53d8\u91cf\u7684\u526f\u672c \u5728\u4f7f\u7528ThreadLocal\u7684\u65f6\u5019\uff0c\u5f3a\u70c8\u5efa\u8bae\uff1a \u52a1\u5fc5\u624b\u52a8remove 6 \u771f\u5b9e\u9762\u8bd5\u8fd8\u539f 6.1 \u7ebf\u7a0b\u7684\u57fa\u7840\u77e5\u8bc6 \u9762\u8bd5\u5b98 \uff1a\u804a\u4e00\u4e0b\u5e76\u884c\u548c\u5e76\u53d1\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837\u7684~~ \u73b0\u5728\u90fd\u662f\u591a\u6838CPU\uff0c\u5728\u591a\u6838CPU\u4e0b \u5e76\u53d1\u662f\u540c\u4e00\u65f6\u95f4\u5e94\u5bf9\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u8f6e\u6d41\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aCPU \u5e76\u884c\u662f\u540c\u4e00\u65f6\u95f4\u52a8\u624b\u505a\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b\uff0c4\u6838CPU\u540c\u65f6\u6267\u884c4\u4e2a\u7ebf\u7a0b \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u597d~ \u8fdb\u7a0b\u662f\u6b63\u5728\u8fd0\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u8fdb\u7a0b\u4e2d\u5305\u542b\u4e86\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e0d\u540c\u7684\u4efb\u52a1 \u4e0d\u540c\u7684\u8fdb\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u5f53\u524d\u8fdb\u7a0b\u4e0b\u7684\u6240\u6709\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u5185\u5b58\u7a7a\u95f4 \u7ebf\u7a0b\u66f4\u8f7b\u91cf\uff0c\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u6210\u672c\u4e00\u822c\u4e0a\u8981\u6bd4\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u4f4e(\u4e0a\u4e0b\u6587\u5207\u6362\u6307\u7684\u662f\u4ece\u4e00\u4e2a\u7ebf\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b) \u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u5728java\u4e2d\u521b\u5efa\u7ebf\u7a0b\u6709\u54ea\u4e9b\u65b9\u5f0f\uff1f \u5019\u9009\u4eba\uff1a \u5728java\u4e2d\u4e00\u5171\u6709\u56db\u79cd\u5e38\u89c1\u7684\u521b\u5efa\u65b9\u5f0f\uff0c\u5206\u522b\u662f\uff1a\u7ee7\u627fThread\u7c7b\u3001\u5b9e\u73b0runnable\u63a5\u53e3\u3001\u5b9e\u73b0Callable\u63a5\u53e3\u3001\u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9879\u76ee\u4e2d\u90fd\u4f1a\u91c7\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u521b\u5efa\u7ebf\u7a0b\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684runnable \u548c callable \u4e24\u4e2a\u63a5\u53e3\u521b\u5efa\u7ebf\u7a0b\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837\u7684~ \u6700\u4e3b\u8981\u7684\u4e24\u4e2a\u7ebf\u7a0b\u4e00\u4e2a\u662f\u6709\u8fd4\u56de\u503c\uff0c\u4e00\u4e2a\u662f\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u3002 Runnable \u63a5\u53e3run\u65b9\u6cd5\u65e0\u8fd4\u56de\u503c\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\uff0c\u662f\u4e2a\u6cdb\u578b\uff0c\u548cFuture\u3001FutureTask\u914d\u5408\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5f02\u6b65\u6267\u884c\u7684\u7ed3\u679c \u8fd8\u6709\u4e00\u4e2a\u5c31\u662f\uff0c\u4ed6\u4eec\u5f02\u5e38\u5904\u7406\u4e5f\u4e0d\u4e00\u6837\u3002Runnable\u63a5\u53e3run\u65b9\u6cd5\u53ea\u80fd\u629b\u51fa\u8fd0\u884c\u65f6\u5f02\u5e38\uff0c\u4e5f\u65e0\u6cd5\u6355\u83b7\u5904\u7406\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u5141\u8bb8\u629b\u51fa\u5f02\u5e38\uff0c\u53ef\u4ee5\u83b7\u53d6\u5f02\u5e38\u4fe1\u606f \u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5982\u679c\u9700\u8981\u62ff\u5230\u6267\u884c\u7684\u7ed3\u679c\uff0c\u9700\u8981\u4f7f\u7528Callalbe\u63a5\u53e3\u521b\u5efa\u7ebf\u7a0b\uff0c\u8c03\u7528FutureTask.get()\u5f97\u5230\u53ef\u4ee5\u5f97\u5230\u8fd4\u56de\u503c\uff0c\u6b64\u65b9\u6cd5\u4f1a\u963b\u585e\u4e3b\u8fdb\u7a0b\u7684\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u679c\u4e0d\u8c03\u7528\u4e0d\u4f1a\u963b\u585e\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u5305\u62ec\u54ea\u4e9b\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684\uff1f \u5019\u9009\u4eba\uff1a \u5728JDK\u4e2d\u7684Thread\u7c7b\u4e2d\u7684\u679a\u4e3eState\u91cc\u9762\u5b9a\u4e49\u4e866\u4e2d\u7ebf\u7a0b\u7684\u72b6\u6001\u5206\u522b\u662f\uff1a\u65b0\u5efa\u3001\u53ef\u8fd0\u884c\u3001\u7ec8\u7ed3\u3001\u963b\u585e\u3001\u7b49\u5f85\u548c\u6709\u65f6\u9650\u7b49\u5f85\u516d\u79cd\u3002 \u5173\u4e8e\u7ebf\u7a0b\u7684\u72b6\u6001\u5207\u6362\u60c5\u51b5\u6bd4\u8f83\u591a\u3002\u6211\u5206\u522b\u4ecb\u7ecd\u4e00\u4e0b \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\u88ab\u521b\u5efa\uff0c\u4f46\u8fd8\u672a\u8c03\u7528 start \u65b9\u6cd5\u65f6\u5904\u4e8e \u65b0\u5efa \u72b6\u6001\uff0c\u8c03\u7528\u4e86 start \u65b9\u6cd5\uff0c\u5c31\u4f1a\u7531 \u65b0\u5efa \u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001\u3002\u5982\u679c\u7ebf\u7a0b\u5185\u4ee3\u7801\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 \u7ec8\u7ed3 \u72b6\u6001\u3002\u5f53\u7136\u8fd9\u4e9b\u662f\u4e00\u4e2a\u7ebf\u7a0b\u6b63\u5e38\u6267\u884c\u60c5\u51b5\u3002 \u5982\u679c\u7ebf\u7a0b\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 Monitor \u7684\u963b\u585e\u961f\u5217 \u963b\u585e \uff0c\u53ea\u6709\u5f53\u6301\u9501\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u963b\u585e\u961f\u5217\u4e2d\u7684 \u963b\u585e \u7ebf\u7a0b\uff0c\u5524\u9192\u540e\u7684\u7ebf\u7a0b\u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001 \u5982\u679c\u7ebf\u7a0b\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait() \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501 \u7b49\u5f85 \u72b6\u6001\uff0c\u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f\u8c03\u7528 sleep(long) \u65b9\u6cd5\u4e5f\u4f1a\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u8fdb\u5165 \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\uff0c\u4e0d\u9700\u8981\u4e3b\u52a8\u5524\u9192\uff0c\u8d85\u65f6\u65f6\u95f4\u5230\u81ea\u7136\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684\u7ebf\u7a0b\u4e2d\u7684 wait \u548c sleep\u65b9\u6cd5\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5019\u9009\u4eba\uff1a \u5b83\u4eec\u4e24\u4e2a\u7684\u76f8\u540c\u70b9\u662f\u90fd\u53ef\u4ee5\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6682\u65f6\u653e\u5f03 CPU \u7684\u4f7f\u7528\u6743\uff0c\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002 \u4e0d\u540c\u70b9\u4e3b\u8981\u6709\u4e09\u4e2a\u65b9\u9762\uff1a \u7b2c\u4e00\uff1a\u65b9\u6cd5\u5f52\u5c5e\u4e0d\u540c sleep(long) \u662f Thread \u7684\u9759\u6001\u65b9\u6cd5\u3002\u800c wait()\uff0c\u662f Object \u7684\u6210\u5458\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709 \u7b2c\u4e8c\uff1a\u7ebf\u7a0b\u9192\u6765\u65f6\u673a\u4e0d\u540c \u7ebf\u7a0b\u6267\u884c sleep(long) \u4f1a\u5728\u7b49\u5f85\u76f8\u5e94\u6beb\u79d2\u540e\u9192\u6765\uff0c\u800c wait() \u9700\u8981\u88ab notify \u5524\u9192\uff0cwait() \u5982\u679c\u4e0d\u5524\u9192\u5c31\u4e00\u76f4\u7b49\u4e0b\u53bb \u7b2c\u4e09\uff1a\u9501\u7279\u6027\u4e0d\u540c wait \u65b9\u6cd5\u7684\u8c03\u7528\u5fc5\u987b\u5148\u83b7\u53d6 wait \u5bf9\u8c61\u7684\u9501\uff0c\u800c sleep \u5219\u65e0\u6b64\u9650\u5236 wait \u65b9\u6cd5\u6267\u884c\u540e\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff0c\u5141\u8bb8\u5176\u5b83\u7ebf\u7a0b\u83b7\u5f97\u8be5\u5bf9\u8c61\u9501\uff08\u76f8\u5f53\u4e8e\u6211\u653e\u5f03 cpu\uff0c\u4f46\u4f60\u4eec\u8fd8\u53ef\u4ee5\u7528\uff09 \u800c sleep \u5982\u679c\u5728 synchronized \u4ee3\u7801\u5757\u4e2d\u6267\u884c\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff08\u76f8\u5f53\u4e8e\u6211\u653e\u5f03 cpu\uff0c\u4f60\u4eec\u4e5f\u7528\u4e0d\u4e86\uff09 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u6211\u73b0\u5728\u4e3e\u4e00\u4e2a\u573a\u666f\uff0c\u4f60\u6765\u5206\u6790\u4e00\u4e0b\u600e\u4e48\u505a\uff0c\u65b0\u5efa T1\u3001T2\u3001T3 \u4e09\u4e2a\u7ebf\u7a0b\uff0c\u5982\u4f55\u4fdd\u8bc1\u5b83\u4eec\u6309\u987a\u5e8f\u6267\u884c\uff1f \u5019\u9009\u4eba\uff1a \u55ef~~\uff0c\u6211\u601d\u8003\u4e00\u4e0b \uff08\u9002\u5f53\u7684\u601d\u8003\u6216\u60f3\u4e00\u4e0b\u5c5e\u4e8e\u6b63\u5e38\u60c5\u51b5\uff0c\u8131\u53e3\u800c\u51fa\u53cd\u800c\u592a\u5047[\u80cc\u8bf5\u75d5\u8ff9]\uff09 \u53ef\u4ee5\u8fd9\u4e48\u505a\uff0c\u5728\u591a\u7ebf\u7a0b\u4e2d\u6709\u591a\u79cd\u65b9\u6cd5\u8ba9\u7ebf\u7a0b\u6309\u7279\u5b9a\u987a\u5e8f\u6267\u884c\uff0c\u53ef\u4ee5\u7528\u7ebf\u7a0b\u7c7b\u7684 join ()\u65b9\u6cd5\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u542f\u52a8\u53e6\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u8be5\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u3002 \u6bd4\u5982\u8bf4\uff1a \u4f7f\u7528join\u65b9\u6cd5\uff0cT3\u8c03\u7528T2\uff0cT2\u8c03\u7528T1\uff0c\u8fd9\u6837\u5c31\u80fd\u786e\u4fddT1\u5c31\u4f1a\u5148\u5b8c\u6210\u800cT3\u6700\u540e\u5b8c\u6210 \u9762\u8bd5\u5b98 \uff1a\u5728\u6211\u4eec\u4f7f\u7528\u7ebf\u7a0b\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4e24\u4e2a\u65b9\u6cd5\u3002\u7ebf\u7a0b\u7684 run()\u548c start()\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a start\u65b9\u6cd5\u7528\u6765\u542f\u52a8\u7ebf\u7a0b\uff0c\u901a\u8fc7\u8be5\u7ebf\u7a0b\u8c03\u7528run\u65b9\u6cd5\u6267\u884crun\u65b9\u6cd5\u4e2d\u6240\u5b9a\u4e49\u7684\u903b\u8f91\u4ee3\u7801\u3002start\u65b9\u6cd5\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\u3002run\u65b9\u6cd5\u5c01\u88c5\u4e86\u8981\u88ab\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u88ab\u8c03\u7528\u591a\u6b21\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5982\u4f55\u505c\u6b62\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u5462\uff1f \u5019\u9009\u4eba \uff1a \u6709\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u505c\u6b62\u7ebf\u7a0b \u7b2c\u4e00\uff1a\u53ef\u4ee5\u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa\uff0c\u4e5f\u5c31\u662f\u5f53run\u65b9\u6cd5\u5b8c\u6210\u540e\u7ebf\u7a0b\u7ec8\u6b62\uff0c\u4e00\u822c\u6211\u4eec\u52a0\u4e00\u4e2a\u6807\u8bb0 \u7b2c\u4e8c\uff1a\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u7684stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62\uff0c\u4e0d\u8fc7\u4e00\u822c\u4e0d\u63a8\u8350\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5df2\u4f5c\u5e9f \u7b2c\u4e09\uff1a\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b\uff0c\u5185\u90e8\u5176\u5b9e\u4e5f\u662f\u4f7f\u7528\u4e2d\u65ad\u6807\u5fd7\u6765\u4e2d\u65ad\u7ebf\u7a0b \u6211\u4eec\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u8bdd\uff0c\u5efa\u8bae\u4f7f\u7528\u7b2c\u4e00\u79cd\u6216\u7b2c\u4e09\u79cd\u65b9\u5f0f\u4e2d\u65ad\u7ebf\u7a0b 6.2 \u7ebf\u7a0b\u4e2d\u5e76\u53d1\u9501 \u9762\u8bd5\u5b98 \uff1a\u8bb2\u4e00\u4e0bsynchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\u597d\u7684\uff0c synchronized \u5e95\u5c42\u4f7f\u7528\u7684JVM\u7ea7\u522b\u4e2d\u7684Monitor \u6765\u51b3\u5b9a\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u83b7\u5f97\u4e86\u9501\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u5f97\u4e86\u9501\uff0c\u5728\u6ca1\u6709\u91ca\u653e\u9501\u4e4b\u524d\uff0c\u5176\u4ed6\u7ebf\u7a0b\u662f\u4e0d\u80fd\u6216\u5f97\u5230\u9501\u7684\u3002synchronized \u5c5e\u4e8e\u60b2\u89c2\u9501\u3002 synchronized \u56e0\u4e3a\u9700\u8981\u4f9d\u8d56\u4e8eJVM\u7ea7\u522b\u7684Monitor \uff0c\u76f8\u5bf9\u6027\u80fd\u4e5f\u6bd4\u8f83\u4f4e\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u5177\u4f53\u8bf4\u4e0bMonitor \u5417\uff1f \u5019\u9009\u4eba \uff1a monitor\u5bf9\u8c61\u5b58\u5728\u4e8e\u6bcf\u4e2aJava\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u4e2d\uff0csynchronized \u9501\u4fbf\u662f\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u83b7\u53d6\u9501\u7684\uff0c\u4e5f\u662f\u4e3a\u4ec0\u4e48Java\u4e2d\u4efb\u610f\u5bf9\u8c61\u53ef\u4ee5\u4f5c\u4e3a\u9501\u7684\u539f\u56e0 monitor\u5185\u90e8\u7ef4\u62a4\u4e86\u4e09\u4e2a\u53d8\u91cf WaitSet\uff1a\u4fdd\u5b58\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b EntryList\uff1a\u4fdd\u5b58\u5904\u4e8eBlocked\u72b6\u6001\u7684\u7ebf\u7a0b Owner\uff1a\u6301\u6709\u9501\u7684\u7ebf\u7a0b \u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5230\u7684\u6807\u5fd7\u5c31\u662f\u5728monitor\u4e2d\u8bbe\u7f6e\u6210\u529f\u4e86Owner\uff0c\u4e00\u4e2amonitor\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2aOwner \u5728\u4e0a\u9501\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u6709\u5176\u4ed6\u7ebf\u7a0b\u4e5f\u6765\u62a2\u9501\uff0c\u5219\u8fdb\u5165EntryList \u8fdb\u884c\u963b\u585e\uff0c\u5f53\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\u6267\u884c\u5b8c\u4e86\uff0c\u91ca\u653e\u4e86\u9501\uff0c\u5c31\u4f1a\u5524\u9192EntryList \u4e2d\u7b49\u5f85\u7684\u7ebf\u7a0b\u7ade\u4e89\u9501\uff0c\u7ade\u4e89\u7684\u65f6\u5019\u662f\u975e\u516c\u5e73\u7684\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u5173\u4e8esynchronized \u7684\u9501\u5347\u7ea7\u7684\u60c5\u51b5\u4e86\u89e3\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u4e00\u4e9b\uff08\u8981\u8c26\u865a\uff09 Java\u4e2d\u7684synchronized\u6709\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\u3001\u91cd\u91cf\u7ea7\u9501\u4e09\u79cd\u5f62\u5f0f\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u9501\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u3001\u4e0d\u540c\u7ebf\u7a0b\u4ea4\u66ff\u6301\u6709\u9501\u3001\u591a\u7ebf\u7a0b\u7ade\u4e89\u9501\u4e09\u79cd\u60c5\u51b5\u3002 \u91cd\u91cf\u7ea7\u9501\uff1a\u5e95\u5c42\u4f7f\u7528\u7684Monitor\u5b9e\u73b0\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u8f7b\u91cf\u7ea7\u9501\uff1a\u7ebf\u7a0b\u52a0\u9501\u7684\u65f6\u95f4\u662f\u9519\u5f00\u7684\uff08\u4e5f\u5c31\u662f\u6ca1\u6709\u7ade\u4e89\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f7b\u91cf\u7ea7\u9501\u6765\u4f18\u5316\u3002\u8f7b\u91cf\u7ea7\u4fee\u6539\u4e86\u5bf9\u8c61\u5934\u7684\u9501\u6807\u5fd7\uff0c\u76f8\u5bf9\u91cd\u91cf\u7ea7\u9501\u6027\u80fd\u63d0\u5347\u5f88\u591a\u3002\u6bcf\u6b21\u4fee\u6539\u90fd\u662fCAS\u64cd\u4f5c\uff0c\u4fdd\u8bc1\u539f\u5b50\u6027 \u504f\u5411\u9501\uff1a\u4e00\u6bb5\u5f88\u957f\u7684\u65f6\u95f4\u5185\u90fd\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u504f\u5411\u9501\uff0c\u5728\u7b2c\u4e00\u6b21\u83b7\u5f97\u9501\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2aCAS\u64cd\u4f5c\uff0c\u4e4b\u540e\u8be5\u7ebf\u7a0b\u518d\u83b7\u53d6\u9501\uff0c\u53ea\u9700\u8981\u5224\u65admark word\u4e2d\u662f\u5426\u662f\u81ea\u5df1\u7684\u7ebf\u7a0bid\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u5f00\u9500\u76f8\u5bf9\u8f83\u5927\u7684CAS\u547d\u4ee4 \u4e00\u65e6\u9501\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u90fd\u4f1a\u5347\u7ea7\u4e3a\u91cd\u91cf\u7ea7\u9501 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86synchronized\u5b83\u5728\u9ad8\u5e76\u53d1\u91cf\u7684\u60c5\u51b5\u4e0b\uff0c\u6027\u80fd\u4e0d\u9ad8\uff0c\u5728\u9879\u76ee\u8be5\u5982\u4f55\u63a7\u5236\u4f7f\u7528\u9501\u5462\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u5176\u5b9e\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528ReentrantLock\u6765\u52a0\u9501\u3002 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u90a3\u4f60\u8bf4\u4e0bReentrantLock\u7684\u4f7f\u7528\u65b9\u5f0f\u548c\u5e95\u5c42\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\uff0c ReentrantLock\u662f\u4e00\u4e2a\u53ef\u91cd\u5165\u9501:\uff0c\u8c03\u7528 lock \u65b9 \u6cd5\u83b7\u53d6\u4e86\u9501\u4e4b\u540e\uff0c\u518d\u6b21\u8c03\u7528 lock\uff0c\u662f\u4e0d\u4f1a\u518d\u963b\u585e\uff0c\u5185\u90e8\u76f4\u63a5\u589e\u52a0\u91cd\u5165\u6b21\u6570 \u5c31\u884c\u4e86\uff0c\u6807\u8bc6\u8fd9\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u91cd\u590d\u83b7\u53d6\u4e00\u628a\u9501\u800c\u4e0d\u9700\u8981\u7b49\u5f85\u9501\u7684\u91ca\u653e\u3002 ReentrantLock\u662f\u5c5e\u4e8ejuc\u62a5\u4e0b\u7684\u7c7b\uff0c\u5c5e\u4e8eapi\u5c42\u9762\u7684\u9501\uff0c\u8ddfsynchronized\u4e00\u6837\uff0c\u90fd\u662f\u60b2\u89c2\u9501\u3002\u901a\u8fc7lock()\u7528\u6765\u83b7\u53d6\u9501\uff0cunlock()\u91ca\u653e\u9501\u3002 \u5b83\u7684\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u4e3b\u8981\u5229\u7528 CAS+AQS\u961f\u5217 \u6765\u5b9e\u73b0\u3002\u5b83\u652f\u6301\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501\uff0c\u4e24\u8005\u7684\u5b9e\u73b0\u7c7b\u4f3c \u6784\u9020\u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u7684\u516c\u5e73\u53c2\u6570\uff08 \u9ed8\u8ba4\u975e\u516c\u5e73\u9501 \uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\uff0c\u8868\u793a\u516c\u5e73\u9501\uff0c\u5426\u5219\u4e3a\u975e\u516c\u5e73\u9501\u3002\u516c\u5e73\u9501\u7684\u6548\u7387\u5f80\u5f80\u6ca1\u6709\u975e\u516c\u5e73\u9501\u7684\u6548\u7387\u9ad8\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86CAS\u548cAQS\uff0c\u4f60\u80fd\u4ecb\u7ecd\u4e00\u4e0b\u5417\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\u3002 CAS\u7684\u5168\u79f0\u662f\uff1a Compare And Swap(\u6bd4\u8f83\u518d\u4ea4\u6362);\u5b83\u4f53\u73b0\u7684\u4e00\u79cd\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff0c\u5728\u65e0\u9501\u72b6\u6001\u4e0b\u4fdd\u8bc1\u7ebf\u7a0b\u64cd\u4f5c\u6570\u636e\u7684\u539f\u5b50\u6027\u3002 CAS\u4f7f\u7528\u5230\u7684\u5730\u65b9\u5f88\u591a\uff1aAQS\u6846\u67b6\u3001AtomicXXX\u7c7b \u5728\u64cd\u4f5c\u5171\u4eab\u53d8\u91cf\u7684\u65f6\u5019\u4f7f\u7528\u7684\u81ea\u65cb\u9501\uff0c\u6548\u7387\u4e0a\u66f4\u9ad8\u4e00\u4e9b CAS\u7684\u5e95\u5c42\u662f\u8c03\u7528\u7684Unsafe\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u90fd\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\uff0c\u5176\u4ed6\u8bed\u8a00\u5b9e\u73b0 AQS\u7684\u8bdd\uff0c\u5176\u5b9e\u5c31\u4e00\u4e2ajdk\u63d0\u4f9b\u7684\u7c7bAbstractQueuedSynchronizer\uff0c\u662f\u963b\u585e\u5f0f\u9501\u548c\u76f8\u5173\u7684\u540c\u6b65\u5668\u5de5\u5177\u7684\u6846\u67b6\u3002 \u5185\u90e8\u6709\u4e00\u4e2a\u5c5e\u6027 state \u5c5e\u6027\u6765\u8868\u793a\u8d44\u6e90\u7684\u72b6\u6001\uff0c\u9ed8\u8ba4state\u7b49\u4e8e0\uff0c\u8868\u793a\u6ca1\u6709\u83b7\u53d6\u9501\uff0cstate\u7b49\u4e8e1\u7684\u65f6\u5019\u624d\u6807\u660e\u83b7\u53d6\u5230\u4e86\u9501\u3002\u901a\u8fc7cas \u673a\u5236\u8bbe\u7f6e state \u72b6\u6001 \u5728\u5b83\u7684\u5185\u90e8\u8fd8\u63d0\u4f9b\u4e86\u57fa\u4e8e FIFO \u7684\u7b49\u5f85\u961f\u5217\uff0c\u662f\u4e00\u4e2a\u53cc\u5411\u5217\u8868\uff0c\u5176\u4e2d tail \u6307\u5411\u961f\u5217\u6700\u540e\u4e00\u4e2a\u5143\u7d20 head \u6307\u5411\u961f\u5217\u4e2d\u6700\u4e45\u7684\u4e00\u4e2a\u5143\u7d20 \u5176\u4e2d\u6211\u4eec\u521a\u521a\u804a\u7684ReentrantLock\u5e95\u5c42\u7684\u5b9e\u73b0\u5c31\u662f\u4e00\u4e2aAQS\u3002 \u9762\u8bd5\u5b98 \uff1asynchronized\u548cLock\u6709\u4ec0\u4e48\u533a\u522b ? \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u597d\u7684\uff0c\u4e3b\u8981\u6709\u4e09\u4e2a\u65b9\u9762\u4e0d\u592a\u4e00\u6837 \u7b2c\u4e00\uff0c\u8bed\u6cd5\u5c42\u9762 synchronized \u662f\u5173\u952e\u5b57\uff0c\u6e90\u7801\u5728 jvm \u4e2d\uff0c\u7528 c++ \u8bed\u8a00\u5b9e\u73b0\uff0c\u9000\u51fa\u540c\u6b65\u4ee3\u7801\u5757\u9501\u4f1a\u81ea\u52a8\u91ca\u653e Lock \u662f\u63a5\u53e3\uff0c\u6e90\u7801\u7531 jdk \u63d0\u4f9b\uff0c\u7528 java \u8bed\u8a00\u5b9e\u73b0\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 unlock \u65b9\u6cd5\u91ca\u653e\u9501 \u7b2c\u4e8c\uff0c\u529f\u80fd\u5c42\u9762 \u4e8c\u8005\u5747\u5c5e\u4e8e\u60b2\u89c2\u9501\u3001\u90fd\u5177\u5907\u57fa\u672c\u7684\u4e92\u65a5\u3001\u540c\u6b65\u3001\u9501\u91cd\u5165\u529f\u80fd Lock \u63d0\u4f9b\u4e86\u8bb8\u591a synchronized \u4e0d\u5177\u5907\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u83b7\u53d6\u7b49\u5f85\u72b6\u6001\u3001\u516c\u5e73\u9501\u3001\u53ef\u6253\u65ad\u3001\u53ef\u8d85\u65f6\u3001\u591a\u6761\u4ef6\u53d8\u91cf\uff0c\u540c\u65f6Lock \u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u573a\u666f\uff0c\u5982 ReentrantLock\uff0c ReentrantReadWriteLock \u7b2c\u4e09\uff0c\u6027\u80fd\u5c42\u9762 \u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff0csynchronized \u505a\u4e86\u5f88\u591a\u4f18\u5316\uff0c\u5982\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u4e0d\u8d56 \u5728\u7ade\u4e89\u6fc0\u70c8\u65f6\uff0cLock \u7684\u5b9e\u73b0\u901a\u5e38\u4f1a\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd \u7edf\u5408\u6765\u770b\uff0c\u9700\u8981\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u6765\u9009\u62e9\u4e0d\u540c\u7684\u9501\u7684\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1a\u6b7b\u9501\u4ea7\u751f\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u540c\u65f6\u83b7\u53d6\u591a\u628a\u9501\uff0c\u8fd9\u65f6\u5c31\u5bb9\u6613\u53d1\u751f\u6b7b\u9501\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff1a t1 \u7ebf\u7a0b\u83b7\u5f97A\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6B\u5bf9\u8c61\u7684\u9501 t2 \u7ebf\u7a0b\u83b7\u5f97B\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6A\u5bf9\u8c61\u7684\u9501 \u8fd9\u4e2a\u65f6\u5019t1\u7ebf\u7a0b\u548ct2\u7ebf\u7a0b\u90fd\u5728\u4e92\u76f8\u7b49\u5f85\u5bf9\u65b9\u7684\u9501\uff0c\u5c31\u4ea7\u751f\u4e86\u6b7b\u9501 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5982\u679c\u4ea7\u51fa\u4e86\u8fd9\u6837\u7684\uff0c\u5982\u4f55\u8fdb\u884c\u6b7b\u9501\u8bca\u65ad\uff1f \u5019\u9009\u4eba \uff1a \u8fd9\u4e2a\u4e5f\u5f88\u5bb9\u6613\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7jdk\u81ea\u52a8\u7684\u5de5\u5177\u5c31\u80fd\u641e\u5b9a \u6211\u4eec\u53ef\u4ee5\u5148\u901a\u8fc7jps\u6765\u67e5\u770b\u5f53\u524djava\u7a0b\u5e8f\u8fd0\u884c\u7684\u8fdb\u7a0bid \u7136\u540e\u901a\u8fc7jstack\u6765\u67e5\u770b\u8fd9\u4e2a\u8fdb\u7a0bid\uff0c\u5c31\u80fd\u5c55\u793a\u51fa\u6765\u6b7b\u9501\u7684\u95ee\u9898\uff0c\u5e76\u4e14\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u4ee3\u7801\u7684\u5177\u4f53\u884c\u53f7\u8303\u56f4\uff0c\u6211\u4eec\u518d\u53bb\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\u8fdb\u884c\u6392\u67e5\u5c31\u884c\u4e86\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf7\u8c08\u8c08\u4f60\u5bf9 volatile \u7684\u7406\u89e3 \u5019\u9009\u4eba \uff1a \u55ef~~ volatile \u662f\u4e00\u4e2a\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u4fee\u9970\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u3001\u7c7b\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u529f\u80fd \u7b2c\u4e00\uff1a\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u65f6\u7684\u53ef\u89c1\u6027\uff0c\u5373\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u8fd9\u65b0\u503c\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u6765\u8bf4\u662f\u7acb\u5373\u53ef\u89c1\u7684,volatile\u5173\u952e\u5b57\u4f1a\u5f3a\u5236\u5c06\u4fee\u6539\u7684\u503c\u7acb\u5373\u5199\u5165\u4e3b\u5b58\u3002 \u7b2c\u4e8c\uff1a \u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u4ee3\u7801\u6267\u884c\u6709\u5e8f\u6027\u3002\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u662f\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a \u5185\u5b58\u5c4f\u969c \uff0c\u901a\u8fc7\u63d2\u5165\u5185\u5b58\u5c4f\u969c\u7981\u6b62\u5728\u5185\u5b58\u5c4f\u969c \u524d\u540e \u7684\u6307\u4ee4\u6267\u884c\u91cd\u6392\u5e8f\u4f18\u5316 \u672c\u6587\u4f5c\u8005 \uff1a\u63a5\u300a\u96c6\u5408\u76f8\u5173\u9762\u8bd5\u9898\u300b \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u80fd\u804a\u4e00\u4e0bConcurrentHashMap\u7684\u539f\u7406\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\u597d\u7684\uff0c ConcurrentHashMap \u662f\u4e00\u79cd\u7ebf\u7a0b\u5b89\u5168\u7684\u9ad8\u6548Map\u96c6\u5408\uff0cjdk1.7\u548c1.8\u4e5f\u505a\u4e86\u5f88\u591a\u8c03\u6574\u3002 JDK1.7\u7684\u5e95\u5c42\u91c7\u7528\u662f \u5206\u6bb5\u7684\u6570\u7ec4 + \u94fe\u8868 \u5b9e\u73b0 JDK1.8 \u91c7\u7528\u7684\u6570\u636e\u7ed3\u6784\u8ddfHashMap1.8\u7684\u7ed3\u6784\u4e00\u6837\uff0c\u6570\u7ec4+\u94fe\u8868/\u7ea2\u9ed1\u4e8c\u53c9\u6811\u3002 \u5728jdk1.7\u4e2d ConcurrentHashMap \u91cc\u5305\u542b\u4e00\u4e2a Segment \u6570\u7ec4\u3002Segment \u7684\u7ed3\u6784\u548cHashMap\u7c7b\u4f3c\uff0c\u662f\u4e00 \u79cd\u6570\u7ec4\u548c\u94fe\u8868\u7ed3\u6784\uff0c\u4e00\u4e2a Segment \u5305\u542b\u4e00\u4e2a HashEntry \u6570\u7ec4\uff0c\u6bcf\u4e2a HashEntry \u662f\u4e00\u4e2a\u94fe\u8868\u7ed3\u6784 \u7684\u5143\u7d20\uff0c\u6bcf\u4e2a Segment \u5b88\u62a4\u7740\u4e00\u4e2aHashEntry\u6570\u7ec4\u91cc\u7684\u5143\u7d20\uff0c\u5f53\u5bf9 HashEntry \u6570\u7ec4\u7684\u6570\u636e\u8fdb\u884c\u4fee \u6539\u65f6\uff0c\u5fc5\u987b\u9996\u5148\u83b7\u5f97\u5bf9\u5e94\u7684 Segment\u7684\u9501\u3002 Segment \u662f\u4e00\u79cd\u53ef\u91cd\u5165\u7684\u9501 ReentrantLock\uff0c\u6bcf\u4e2a Segment \u5b88\u62a4\u4e00\u4e2aHashEntry \u6570\u7ec4\u91cc\u5f97\u5143 \u7d20\uff0c\u5f53\u5bf9 HashEntry \u6570\u7ec4\u7684\u6570\u636e\u8fdb\u884c\u4fee\u6539\u65f6\uff0c\u5fc5\u987b\u9996\u5148\u83b7\u5f97\u5bf9\u5e94\u7684 Segment \u9501 \u5728jdk1.8\u4e2d\u7684ConcurrentHashMap \u505a\u4e86\u8f83\u5927\u7684\u4f18\u5316\uff0c\u6027\u80fd\u63d0\u5347\u4e86\u4e0d\u5c11\u3002\u9996\u5148\u662f\u5b83\u7684\u6570\u636e\u7ed3\u6784\u4e0ejdk1.8\u7684hashMap\u6570\u636e\u7ed3\u6784\u5b8c\u5168\u4e00\u81f4\u3002\u5176\u6b21\u662f\u653e\u5f03\u4e86Segment\u81c3\u80bf\u7684\u8bbe\u8ba1\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u91c7\u7528Node + CAS + Synchronized\u6765\u4fdd \u8bc1\u5e76\u53d1\u5b89\u5168\u8fdb\u884c\u5b9e\u73b0\uff0csynchronized\u53ea\u9501\u5b9a\u5f53\u524d\u94fe\u8868\u6216\u7ea2\u9ed1\u4e8c\u53c9\u6811\u7684\u9996\u8282\u70b9\uff0c\u8fd9\u6837\u53ea\u8981hash\u4e0d\u51b2 \u7a81\uff0c\u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1 , \u6548\u7387\u5f97\u5230\u63d0\u5347 6.3 \u7ebf\u7a0b\u6c60 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u79cd\u7c7b\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff01\u662f\u8fd9\u6837 \u5728jdk\u4e2d\u9ed8\u8ba4\u63d0\u4f9b\u4e864\u4e2d\u65b9\u5f0f\u521b\u5efa\u7ebf\u7a0b\u6c60 \u7b2c\u4e00\u4e2a\u662f\uff1anewCachedThreadPool\u521b\u5efa\u4e00\u4e2a\u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u957f\u5ea6\u8d85\u8fc7\u5904\u7406\u9700\u8981\uff0c\u53ef\u7075\u6d3b\u56de \u6536\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u82e5\u65e0\u53ef\u56de\u6536\uff0c\u5219\u65b0\u5efa\u7ebf\u7a0b\u3002 \u7b2c\u4e8c\u4e2a\u662f\uff1anewFixedThreadPool \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u53ef\u63a7\u5236\u7ebf\u7a0b\u6700\u5927\u5e76\u53d1\u6570\uff0c\u8d85\u51fa\u7684\u7ebf\u7a0b\u4f1a\u5728\u961f\u5217 \u4e2d\u7b49\u5f85\u3002 \u7b2c\u4e09\u4e2a\u662f\uff1anewScheduledThreadPool \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u652f\u6301\u5b9a\u65f6\u53ca\u5468\u671f\u6027\u4efb\u52a1\u6267\u884c\u3002 \u7b2c\u56db\u4e2a\u662f\uff1anewSingleThreadExecutor \u521b\u5efa\u4e00\u4e2a\u5355\u7ebf\u7a0b\u5316\u7684\u7ebf\u7a0b\u6c60\uff0c\u5b83\u53ea\u4f1a\u7528\u552f\u4e00\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\uff0c\u4fdd\u8bc1\u6240\u6709\u4efb\u52a1\u6309\u7167\u6307\u5b9a\u987a\u5e8f(FIFO, LIFO, \u4f18\u5148\u7ea7)\u6267\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u53c2\u6570\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u5728\u7ebf\u7a0b\u6c60\u4e2d\u4e00\u5171\u67097\u4e2a\u6838\u5fc3\u53c2\u6570\uff1a corePoolSize \u6838\u5fc3\u7ebf\u7a0b\u6570\u76ee - \u6c60\u4e2d\u4f1a\u4fdd\u7559\u7684\u6700\u591a\u7ebf\u7a0b\u6570 maximumPoolSize \u6700\u5927\u7ebf\u7a0b\u6570\u76ee - \u6838\u5fc3\u7ebf\u7a0b+\u6551\u6025\u7ebf\u7a0b\u7684\u6700\u5927\u6570\u76ee keepAliveTime \u751f\u5b58\u65f6\u95f4 - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u751f\u5b58\u65f6\u95f4\u5185\u6ca1\u6709\u65b0\u4efb\u52a1\uff0c\u6b64\u7ebf\u7a0b\u8d44\u6e90\u4f1a\u91ca\u653e unit \u65f6\u95f4\u5355\u4f4d - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\u5355\u4f4d\uff0c\u5982\u79d2\u3001\u6beb\u79d2\u7b49 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 threadFactory \u7ebf\u7a0b\u5de5\u5382 - \u53ef\u4ee5\u5b9a\u5236\u7ebf\u7a0b\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u4f8b\u5982\u8bbe\u7f6e\u7ebf\u7a0b\u540d\u5b57\u3001\u662f\u5426\u662f\u5b88\u62a4\u7ebf\u7a0b\u7b49 handler \u62d2\u7edd\u7b56\u7565 - \u5f53\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0cworkQueue \u4e5f\u653e\u6ee1\u65f6\uff0c\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565 \u5728\u62d2\u7edd\u7b56\u7565\u4e2d\u53c8\u67094\u4e2d\u62d2\u7edd\u7b56\u7565 \u5f53\u7ebf\u7a0b\u6570\u8fc7\u591a\u4ee5\u540e\uff0c\u7b2c\u4e00\u79cd\u662f\u629b\u5f02\u5e38\u3001\u7b2c\u4e8c\u79cd\u662f\u7531\u8c03\u7528\u8005\u6267\u884c\u4efb\u52a1\u3001\u7b2c\u4e09\u662f\u4e22\u5f03\u5f53\u524d\u7684\u4efb\u52a1\uff0c\u7b2c\u56db\u662f\u4e22\u5f03\u6700\u65e9\u6392\u961f\u4efb\u52a1\u3002\u9ed8\u8ba4\u662f\u76f4\u63a5\u629b\u5f02\u5e38\u3002 \u9762\u8bd5\u5b98 \uff1a\u5982\u4f55\u786e\u5b9a\u6838\u5fc3\u7ebf\u7a0b\u6c60\u5462\uff1f \u5019\u9009\u4eba \uff1a \u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u516c\u53f8\u5f53\u65f6\u6709\u4e00\u4e9b\u89c4\u8303\uff0c\u4e3a\u4e86\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7684\u5207\u6362\uff0c\u8981\u6839\u636e\u5f53\u65f6\u90e8\u7f72\u7684\u670d\u52a1\u5668\u7684CPU\u6838\u6570\u6765\u51b3\u5b9a\uff0c\u6211\u4eec\u89c4\u5219\u662f\uff1aCPU\u6838\u6570+1\u5c31\u662f\u6700\u7ec8\u7684\u6838\u5fc3\u7ebf\u7a0b\u6570\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u6267\u884c\u539f\u7406\u77e5\u9053\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5b83\u662f\u8fd9\u6837\u7684 \u9996\u5148\u5224\u65ad\u7ebf\u7a0b\u6c60\u91cc\u7684\u6838\u5fc3\u7ebf\u7a0b\u662f\u5426\u90fd\u5728\u6267\u884c\u4efb\u52a1\uff0c\u5982\u679c\u4e0d\u662f\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\u3002\u5982\u679c\u6838\u5fc3\u7ebf\u7a0b\u90fd\u5728\u6267\u884c\u4efb\u52a1\uff0c\u5219\u7ebf\u7a0b\u6c60\u5224\u65ad\u5de5\u4f5c\u961f\u5217\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u5de5\u4f5c\u961f\u5217\u6ca1\u6709\u6ee1\uff0c\u5219\u5c06\u65b0\u63d0\u4ea4\u7684\u4efb\u52a1\u5b58\u50a8\u5728\u8fd9\u4e2a\u5de5\u4f5c\u961f \u5217\u91cc\u3002\u5982\u679c\u5de5\u4f5c\u961f\u5217\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u7ebf\u7a0b\u6c60\u91cc\u7684\u7ebf\u7a0b\u662f\u5426\u90fd\u5904\u4e8e\u5de5\u4f5c\u72b6\u6001\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\u3002\u5982\u679c\u5df2\u7ecf\u6ee1\u4e86\uff0c\u5219\u4ea4\u7ed9\u62d2\u7edd\u7b56\u7565\u6765\u5904\u7406\u8fd9\u4e2a\u4efb\u52a1\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u4f7f\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60\u5462\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\uff0c\u5176\u5b9e\u8fd9\u4e2a\u4e8b\u60c5\u5728\u963f\u91cc\u63d0\u4f9b\u7684\u6700\u65b0\u5f00\u53d1\u624b\u518c\u300aJava\u5f00\u53d1\u624b\u518c-\u5d69\u5c71\u7248\u300b\u4e2d\u4e5f\u63d0\u5230\u4e86 \u4e3b\u8981\u539f\u56e0\u662f\u5982\u679c\u4f7f\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60\u7684\u8bdd\uff0c\u5b83\u5141\u8bb8\u7684\u8bf7\u6c42\u961f\u5217\u9ed8\u8ba4\u957f\u5ea6\u662fInteger.MAX_VALUE\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u5806\u79ef\u5927\u91cf\u7684\u8bf7\u6c42\uff0c\u4ece\u800c\u5bfc\u81f4OOM\uff08\u5185\u5b58\u6ea2\u51fa\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u63a8\u8350\u4f7f\u7528ThreadPoolExecutor\u6765\u521b\u5efa\u7ebf\u7a0b\u6c60\uff0c\u8fd9\u6837\u53ef\u4ee5\u660e\u786e\u89c4\u5b9a\u7ebf\u7a0b\u6c60\u7684\u53c2\u6570\uff0c\u907f\u514d\u8d44\u6e90\u7684\u8017\u5c3d\u3002 6.4 \u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u95ee\u9898 \u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u63a7\u5236\u67d0\u4e00\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5e76\u53d1\u8bbf\u95ee\u7ebf\u7a0b\u7684\u6570\u91cf\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u6211\u60f3\u4e00\u4e0b \u5728jdk\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2aSemaphore[sem\u0259f\u0254\u02d0r]\u7c7b\uff08\u4fe1\u53f7\u91cf\uff09 \u5b83\u63d0\u4f9b\u4e86\u4e24\u4e2a\u65b9\u6cd5\uff0csemaphore.acquire() \u8bf7\u6c42\u4fe1\u53f7\u91cf\uff0c\u53ef\u4ee5\u9650\u5236\u7ebf\u7a0b\u7684\u4e2a\u6570\uff0c\u662f\u4e00\u4e2a\u6b63\u6570\uff0c\u5982\u679c\u4fe1\u53f7\u91cf\u662f-1,\u5c31\u4ee3\u8868\u5df2\u7ecf\u7528\u5b8c\u4e86\u4fe1\u53f7\u91cf\uff0c\u5176\u4ed6\u7ebf\u7a0b\u9700\u8981\u963b\u585e\u4e86 \u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u662fsemaphore.release()\uff0c\u4ee3\u8868\u662f\u91ca\u653e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u6b64\u65f6\u4fe1\u53f7\u91cf\u7684\u4e2a\u6570+1 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u8be5\u5982\u4f55\u4fdd\u8bc1Java\u7a0b\u5e8f\u5728\u591a\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u5b89\u5168\u5462\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u521a\u624d\u8bb2\u8fc7\u4e86\u5bfc\u81f4\u7ebf\u7a0b\u5b89\u5168\u7684\u539f\u56e0\uff0c\u5982\u679c\u89e3\u51b3\u7684\u8bdd\uff0cjdk\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u7c7b\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u591a\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898\uff0c\u6bd4\u5982\uff1a JDK Atomic\u5f00\u5934\u7684\u539f\u5b50\u7c7b\u3001synchronized\u3001LOCK\uff0c\u53ef\u4ee5\u89e3\u51b3\u539f\u5b50\u6027\u95ee\u9898 synchronized\u3001volatile\u3001LOCK\uff0c\u53ef\u4ee5\u89e3\u51b3\u53ef\u89c1\u6027\u95ee\u9898 Happens-Before \u89c4\u5219\u53ef\u4ee5\u89e3\u51b3\u6709\u5e8f\u6027\u95ee\u9898 \u9762\u8bd5\u5b98 \uff1a\u4f60\u5728\u9879\u76ee\u4e2d\u54ea\u91cc\u7528\u4e86\u591a\u7ebf\u7a0b\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u6211\u60f3\u4e00\u4e0b\u5f53\u65f6\u7684\u573a\u666f[\u6839\u636e\u81ea\u5df1\u7b80\u5386\u4e0a\u7684\u6a21\u5757\u8bbe\u8ba1\u591a\u7ebf\u7a0b\u573a\u666f] \u53c2\u8003\u573a\u666f\u4e00\uff1a es\u6570\u636e\u6279\u91cf\u5bfc\u5165 \u5728\u6211\u4eec\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u628a\u6570\u636e\u91cf\u7684\u6570\u636e\u4e00\u6b21\u6027\u7684\u540c\u6b65\u5230es\u7d22\u5f15\u5e93\u4e2d\uff0c\u4f46\u662f\u5f53\u65f6\u7684\u6570\u636e\u597d\u50cf\u662f1000\u4e07\u5de6\u53f3\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u6570\u636e\u80af\u5b9a\u4e0d\u884c\uff08oom\u5f02\u5e38\uff09\uff0c\u5982\u679c\u5206\u6279\u6267\u884c\u7684\u8bdd\uff0c\u8017\u65f6\u4e5f\u592a\u4e45\u4e86\u3002\u6240\u4ee5\uff0c\u5f53\u65f6\u6211\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u5bfc\u5165\uff0c\u5229\u7528CountDownLatch+Future\u6765\u63a7\u5236\uff0c\u5c31\u80fd\u5927\u5927\u63d0\u5347\u5bfc\u5165\u7684\u65f6\u95f4\u3002 \u53c2\u8003\u573a\u666f\u4e8c\uff1a \u5728\u6211\u505a\u90a3\u4e2axx\u7535\u5546\u7f51\u7ad9\u7684\u65f6\u5019\uff0c\u91cc\u9762\u6709\u4e00\u4e2a\u6570\u636e\u6c47\u603b\u7684\u529f\u80fd\uff0c\u5728\u7528\u6237\u4e0b\u5355\u4e4b\u540e\u9700\u8981\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f\uff0c\u4e5f\u9700\u8981\u83b7\u5f97\u8ba2\u5355\u4e2d\u7684\u5546\u54c1\u8be6\u7ec6\u4fe1\u606f\uff08\u53ef\u80fd\u662f\u591a\u4e2a\uff09\uff0c\u8fd8\u9700\u8981\u67e5\u770b\u7269\u6d41\u53d1\u8d27\u4fe1\u606f\u3002\u56e0\u4e3a\u5b83\u4eec\u4e09\u4e2a\u5bf9\u5e94\u7684\u5206\u522b\u4e09\u4e2a\u5fae\u670d\u52a1\uff0c\u5982\u679c\u4e00\u4e2a\u4e00\u4e2a\u7684\u64cd\u4f5c\u7684\u8bdd\uff0c\u4e92\u76f8\u7b49\u5f85\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\u3002\u6240\u4ee5\uff0c\u6211\u5f53\u65f6\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\uff0c\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u5904\u7406\uff0c\u6700\u7ec8\u518d\u6c47\u603b\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f53\u7136\u91cc\u9762\u9700\u8981\u7528\u5230Future\u6765\u83b7\u53d6\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e4b\u540e\u7684\u7ed3\u679c\u624d\u884c \u53c2\u8003\u573a\u666f\u4e09\uff1a \u300a\u9ed1\u9a6c\u5934\u6761\u300b\u9879\u76ee\u4e2d\u4f7f\u7528\u7684 \u6211\u5f53\u65f6\u505a\u4e86\u4e00\u4e2a\u6587\u7ae0\u641c\u7d22\u7684\u529f\u80fd\uff0c\u7528\u6237\u8f93\u5165\u5173\u952e\u5b57\u8981\u641c\u7d22\u6587\u7ae0\uff0c\u540c\u65f6\u9700\u8981\u4fdd\u5b58\u7528\u6237\u7684\u641c\u7d22\u8bb0\u5f55\uff08\u641c\u7d22\u5386\u53f2\uff09\uff0c\u8fd9\u5757\u6211\u8bbe\u8ba1\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u4e0d\u5f71\u54cd\u7528\u6237\u7684\u6b63\u5e38\u641c\u7d22\uff0c\u6211\u4eec\u91c7\u7528\u7684\u5f02\u6b65\u7684\u65b9\u5f0f\u8fdb\u884c\u4fdd\u5b58\u7684\uff0c\u4e3a\u4e86\u63d0\u5347\u6027\u80fd\uff0c\u6211\u4eec\u52a0\u5165\u4e86\u7ebf\u7a0b\u6c60\uff0c\u4e5f\u5c31\u8bf4\u5728\u8c03\u7528\u5f02\u6b65\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4ece\u7ebf\u7a0b\u6c60\u4e2d\u83b7\u53d6\u7ebf\u7a0b\u4f7f\u7528 6.5 \u5176\u4ed6 \u9762\u8bd5\u5b98 \uff1a\u8c08\u8c08\u4f60\u5bf9ThreadLocal\u7684\u7406\u89e3 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684~~ ThreadLocal \u4e3b\u8981\u529f\u80fd\u6709\u4e24\u4e2a\uff0c\u7b2c\u4e00\u4e2a\u662f\u53ef\u4ee5\u5b9e\u73b0\u8d44\u6e90\u5bf9\u8c61\u7684\u7ebf\u7a0b\u9694\u79bb\uff0c\u8ba9\u6bcf\u4e2a\u7ebf\u7a0b\u5404\u7528\u5404\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u907f\u514d\u4e89\u7528\u5f15\u53d1\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\uff0c\u7b2c\u4e8c\u4e2a\u662f\u5b9e\u73b0\u4e86\u7ebf\u7a0b\u5185\u7684\u8d44\u6e90\u5171\u4eab \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u4f60\u77e5\u9053ThreadLocal\u7684\u5e95\u5c42\u539f\u7406\u5b9e\u73b0\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u4e00\u4e9b~ \u5728ThreadLocal\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u4e00\u4e2a ThreadLocalMap \u7c7b\u578b\u7684\u6210\u5458\u53d8\u91cf\uff0c\u7528\u6765\u5b58\u50a8\u8d44\u6e90\u5bf9\u8c61 \u5f53\u6211\u4eec\u8c03\u7528 set \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u8d44\u6e90\u5bf9\u8c61\u4f5c\u4e3a value\uff0c\u653e\u5165\u5f53\u524d\u7ebf\u7a0b\u7684 ThreadLocalMap \u96c6\u5408\u4e2d \u5f53\u8c03\u7528 get \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u5230\u5f53\u524d\u7ebf\u7a0b\u4e2d\u67e5\u627e\u5173\u8054\u7684\u8d44\u6e90\u503c \u5f53\u8c03\u7528 remove \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u79fb\u9664\u5f53\u524d\u7ebf\u7a0b\u5173\u8054\u7684\u8d44\u6e90\u503c \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u5173\u4e8eThreadLocal\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u8fd9\u4e2a\u4e8b\u60c5\uff0c\u4e86\u89e3\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u4e4b\u524d\u770b\u8fc7\u6e90\u7801\uff0c\u6211\u60f3\u4e00\u4e0b~~ \u662f\u5e94\u4e3aThreadLocalMap \u4e2d\u7684 key \u88ab\u8bbe\u8ba1\u4e3a\u5f31\u5f15\u7528\uff0c\u5b83\u662f\u88ab\u52a8\u7684\u88abGC\u8c03\u7528\u91ca\u653ekey\uff0c\u4e0d\u8fc7\u5173\u952e\u7684\u662f\u53ea\u6709key\u53ef\u4ee5\u5f97\u5230\u5185\u5b58\u91ca\u653e\uff0c\u800cvalue\u4e0d\u4f1a\uff0c\u56e0\u4e3avalue\u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\u3002 \u5728\u4f7f\u7528ThreadLocal \u65f6\u90fd\u628a\u5b83\u4f5c\u4e3a\u9759\u6001\u53d8\u91cf\uff08\u5373\u5f3a\u5f15\u7528\uff09\uff0c\u56e0\u6b64\u65e0\u6cd5\u88ab\u52a8\u4f9d\u9760 GC \u56de\u6536\uff0c\u5efa\u8bae\u4e3b\u52a8\u7684remove \u91ca\u653e key\uff0c\u8fd9\u6837\u5c31\u80fd\u907f\u514d\u5185\u5b58\u6ea2\u51fa\u3002","title":"\u591a\u7ebf\u7a0b\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#java","text":"","title":"Java\u591a\u7ebf\u7a0b\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#1","text":"","title":"1.\u7ebf\u7a0b\u7684\u57fa\u7840\u77e5\u8bc6"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#11","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7a0b\u5e8f\u7531\u6307\u4ee4\u548c\u6570\u636e\u7ec4\u6210\uff0c\u4f46\u8fd9\u4e9b\u6307\u4ee4\u8981\u8fd0\u884c\uff0c\u6570\u636e\u8981\u8bfb\u5199\uff0c\u5c31\u5fc5\u987b\u5c06\u6307\u4ee4\u52a0\u8f7d\u81f3 CPU\uff0c\u6570\u636e\u52a0\u8f7d\u81f3\u5185\u5b58\u3002\u5728\u6307\u4ee4\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u8fd8\u9700\u8981\u7528\u5230\u78c1\u76d8\u3001\u7f51\u7edc\u7b49\u8bbe\u5907\u3002\u8fdb\u7a0b\u5c31\u662f\u7528\u6765\u52a0\u8f7d\u6307\u4ee4\u3001\u7ba1\u7406\u5185\u5b58\u3001\u7ba1\u7406 IO \u7684\u3002 \u5f53\u4e00\u4e2a\u7a0b\u5e8f\u88ab\u8fd0\u884c\uff0c\u4ece\u78c1\u76d8\u52a0\u8f7d\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u4ee3\u7801\u81f3\u5185\u5b58\uff0c\u8fd9\u65f6\u5c31\u5f00\u542f\u4e86\u4e00\u4e2a\u8fdb\u7a0b\u3002 \u4e00\u4e2a\u8fdb\u7a0b\u4e4b\u5185\u53ef\u4ee5\u5206\u4e3a\u4e00\u5230\u591a\u4e2a\u7ebf\u7a0b\u3002 \u4e00\u4e2a\u7ebf\u7a0b\u5c31\u662f\u4e00\u4e2a\u6307\u4ee4\u6d41\uff0c\u5c06\u6307\u4ee4\u6d41\u4e2d\u7684\u4e00\u6761\u6761\u6307\u4ee4\u4ee5\u4e00\u5b9a\u7684\u987a\u5e8f\u4ea4\u7ed9 CPU \u6267\u884c Java \u4e2d\uff0c\u7ebf\u7a0b\u4f5c\u4e3a\u6700\u5c0f\u8c03\u5ea6\u5355\u4f4d\uff0c\u8fdb\u7a0b\u4f5c\u4e3a\u8d44\u6e90\u5206\u914d\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u5728 windows \u4e2d\u8fdb\u7a0b\u662f\u4e0d\u6d3b\u52a8\u7684\uff0c\u53ea\u662f\u4f5c\u4e3a\u7ebf\u7a0b\u7684\u5bb9\u5668 \u4e8c\u8005\u5bf9\u6bd4 \u8fdb\u7a0b\u662f\u6b63\u5728\u8fd0\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u8fdb\u7a0b\u4e2d\u5305\u542b\u4e86\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e0d\u540c\u7684\u4efb\u52a1 \u4e0d\u540c\u7684\u8fdb\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u5f53\u524d\u8fdb\u7a0b\u4e0b\u7684\u6240\u6709\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u5185\u5b58\u7a7a\u95f4 \u7ebf\u7a0b\u66f4\u8f7b\u91cf\uff0c\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u6210\u672c\u4e00\u822c\u4e0a\u8981\u6bd4\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u4f4e(\u4e0a\u4e0b\u6587\u5207\u6362\u6307\u7684\u662f\u4ece\u4e00\u4e2a\u7ebf\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b)","title":"1.1 \u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u533a\u522b\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#12","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606 \u5355\u6838CPU \u5355\u6838CPU\u4e0b\u7ebf\u7a0b\u5b9e\u9645\u8fd8\u662f\u4e32\u884c\u6267\u884c\u7684 \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6709\u4e00\u4e2a\u7ec4\u4ef6\u53eb\u505a\u4efb\u52a1\u8c03\u5ea6\u5668\uff0c\u5c06cpu\u7684\u65f6\u95f4\u7247\uff08windows\u4e0b\u65f6\u95f4\u7247\u6700\u5c0f\u7ea6\u4e3a 15 \u6beb\u79d2\uff09\u5206\u7ed9\u4e0d\u540c\u7684\u7a0b\u5e8f\u4f7f\u7528\uff0c\u53ea\u662f\u7531\u4e8ecpu\u5728\u7ebf\u7a0b\u95f4\uff08\u65f6\u95f4\u7247\u5f88\u77ed\uff09\u7684\u5207\u6362\u975e\u5e38\u5feb\uff0c\u4eba\u7c7b\u611f\u89c9\u662f\u540c\u65f6\u8fd0\u884c\u7684 \u3002 \u603b\u7ed3\u4e3a\u4e00\u53e5\u8bdd\u5c31\u662f\uff1a \u5fae\u89c2\u4e32\u884c\uff0c\u5b8f\u89c2\u5e76\u884c \u4e00\u822c\u4f1a\u5c06\u8fd9\u79cd\u7ebf\u7a0b\u8f6e\u6d41\u4f7f\u7528CPU\u7684\u505a\u6cd5\u79f0\u4e3a\u5e76\u53d1\uff08concurrent\uff09 \u591a\u6838CPU \u6bcf\u4e2a\u6838\uff08core\uff09\u90fd\u53ef\u4ee5\u8c03\u5ea6\u8fd0\u884c\u7ebf\u7a0b\uff0c\u8fd9\u65f6\u5019\u7ebf\u7a0b\u53ef\u4ee5\u662f\u5e76\u884c\u7684\u3002 \u5e76\u53d1\uff08concurrent\uff09\u662f\u540c\u4e00\u65f6\u95f4\u5e94\u5bf9\uff08dealing with\uff09\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b \u5e76\u884c\uff08parallel\uff09\u662f\u540c\u4e00\u65f6\u95f4\u52a8\u624b\u505a\uff08doing\uff09\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b \u4e3e\u4f8b\uff1a \u5bb6\u5ead\u4e3b\u5987\u505a\u996d\u3001\u6253\u626b\u536b\u751f\u3001\u7ed9\u5b69\u5b50\u5582\u5976\uff0c\u5979\u4e00\u4e2a\u4eba\u8f6e\u6d41\u4ea4\u66ff\u505a\u8fd9\u591a\u4ef6\u4e8b\uff0c\u8fd9\u65f6\u5c31\u662f\u5e76\u53d1 \u5bb6\u5ead\u4e3b\u5987\u96c7\u4e86\u4e2a\u4fdd\u59c6\uff0c\u5979\u4eec\u4e00\u8d77\u8fd9\u4e9b\u4e8b\uff0c\u8fd9\u65f6\u65e2\u6709\u5e76\u53d1\uff0c\u4e5f\u6709\u5e76\u884c\uff08\u8fd9\u65f6\u4f1a\u4ea7\u751f\u7ade\u4e89\uff0c\u4f8b\u5982\u9505\u53ea\u6709\u4e00\u53e3\uff0c\u4e00\u4e2a\u4eba\u7528\u9505\u65f6\uff0c\u53e6\u4e00\u4e2a\u4eba\u5c31\u5f97\u7b49\u5f85\uff09 \u96c7\u4e863\u4e2a\u4fdd\u59c6\uff0c\u4e00\u4e2a\u4e13\u505a\u996d\u3001\u4e00\u4e2a\u4e13\u6253\u626b\u536b\u751f\u3001\u4e00\u4e2a\u4e13\u5582\u5976\uff0c\u4e92\u4e0d\u5e72\u6270\uff0c\u8fd9\u65f6\u662f\u5e76\u884c","title":"1.2 \u5e76\u884c\u548c\u5e76\u53d1\u6709\u4ec0\u4e48\u533a\u522b\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#13","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u5171\u6709\u56db\u79cd\u65b9\u5f0f\u53ef\u4ee5\u521b\u5efa\u7ebf\u7a0b\uff0c\u5206\u522b\u662f\uff1a\u7ee7\u627fThread\u7c7b\u3001\u5b9e\u73b0runnable\u63a5\u53e3\u3001\u5b9e\u73b0Callable\u63a5\u53e3\u3001\u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b \u8be6\u7ec6\u521b\u5efa\u65b9\u5f0f\u53c2\u8003\u4e0b\u9762\u4ee3\u7801\uff1a \u2460 \u7ee7\u627fThread\u7c7b public class MyThread extends Thread { @Override public void run() { System.out.println(\"MyThread...run...\"); } public static void main(String[] args) { // \u521b\u5efaMyThread\u5bf9\u8c61 MyThread t1 = new MyThread() ; MyThread t2 = new MyThread() ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); } } \u2461 \u5b9e\u73b0runnable\u63a5\u53e3 public class MyRunnable implements Runnable{ @Override public void run() { System.out.println(\"MyRunnable...run...\"); } public static void main(String[] args) { // \u521b\u5efaMyRunnable\u5bf9\u8c61 MyRunnable mr = new MyRunnable() ; // \u521b\u5efaThread\u5bf9\u8c61 Thread t1 = new Thread(mr) ; Thread t2 = new Thread(mr) ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); } } \u2462 \u5b9e\u73b0Callable\u63a5\u53e3 public class MyCallable implements Callable<String> { @Override public String call() throws Exception { System.out.println(\"MyCallable...call...\"); return \"OK\"; } public static void main(String[] args) throws ExecutionException, InterruptedException { // \u521b\u5efaMyCallable\u5bf9\u8c61 MyCallable mc = new MyCallable() ; // \u521b\u5efaF FutureTask<String> ft = new FutureTask<String>(mc) ; // \u521b\u5efaThread\u5bf9\u8c61 Thread t1 = new Thread(ft) ; Thread t2 = new Thread(ft) ; // \u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b t1.start(); // \u8c03\u7528ft\u7684get\u65b9\u6cd5\u83b7\u53d6\u6267\u884c\u7ed3\u679c String result = ft.get(); // \u8f93\u51fa System.out.println(result); } } \u2463 \u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b public class MyExecutors implements Runnable{ @Override public void run() { System.out.println(\"MyRunnable...run...\"); } public static void main(String[] args) { // \u521b\u5efa\u7ebf\u7a0b\u6c60\u5bf9\u8c61 ExecutorService threadPool = Executors.newFixedThreadPool(3); threadPool.submit(new MyExecutors()) ; // \u5173\u95ed\u7ebf\u7a0b\u6c60 threadPool.shutdown(); } }","title":"1.3 \u521b\u5efa\u7ebf\u7a0b\u7684\u56db\u79cd\u65b9\u5f0f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#14-runnable-callable","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a Runnable \u63a5\u53e3run\u65b9\u6cd5\u6ca1\u6709\u8fd4\u56de\u503c\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\uff0c\u662f\u4e2a\u6cdb\u578b\uff0c\u548cFuture\u3001FutureTask\u914d\u5408\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5f02\u6b65\u6267\u884c\u7684\u7ed3\u679c Callalbe\u63a5\u53e3\u652f\u6301\u8fd4\u56de\u6267\u884c\u7ed3\u679c\uff0c\u9700\u8981\u8c03\u7528FutureTask.get()\u5f97\u5230\uff0c\u6b64\u65b9\u6cd5\u4f1a\u963b\u585e\u4e3b\u8fdb\u7a0b\u7684\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u679c\u4e0d\u8c03\u7528\u4e0d\u4f1a\u963b\u585e\u3002 Callable\u63a5\u53e3\u7684call()\u65b9\u6cd5\u5141\u8bb8\u629b\u51fa\u5f02\u5e38\uff1b\u800cRunnable\u63a5\u53e3\u7684run()\u65b9\u6cd5\u7684\u5f02\u5e38\u53ea\u80fd\u5728\u5185\u90e8\u6d88\u5316\uff0c\u4e0d\u80fd\u7ee7\u7eed\u4e0a\u629b","title":"1.4 runnable \u548c callable \u6709\u4ec0\u4e48\u533a\u522b"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#15-run-start","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 start(): \u7528\u6765\u542f\u52a8\u7ebf\u7a0b\uff0c\u901a\u8fc7\u8be5\u7ebf\u7a0b\u8c03\u7528run\u65b9\u6cd5\u6267\u884crun\u65b9\u6cd5\u4e2d\u6240\u5b9a\u4e49\u7684\u903b\u8f91\u4ee3\u7801\u3002start\u65b9\u6cd5\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\u3002 run(): \u5c01\u88c5\u4e86\u8981\u88ab\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u88ab\u8c03\u7528\u591a\u6b21\u3002","title":"1.5 \u7ebf\u7a0b\u7684 run()\u548c start()\u6709\u4ec0\u4e48\u533a\u522b\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#16","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u7684\u72b6\u6001\u53ef\u4ee5\u53c2\u8003JDK\u4e2d\u7684Thread\u7c7b\u4e2d\u7684\u679a\u4e3eState public enum State { /** * \u5c1a\u672a\u542f\u52a8\u7684\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001 */ NEW, /** * \u53ef\u8fd0\u884c\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u5904\u4e8e\u53ef\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728 Java \u865a\u62df\u673a\u4e2d\u6267\u884c\uff0c\u4f46\u5b83\u53ef\u80fd\u6b63\u5728\u7b49\u5f85\u6765\u81ea * \u64cd\u4f5c\u7cfb\u7edf\u7684\u5176\u4ed6\u8d44\u6e90\uff0c\u4f8b\u5982\u5904\u7406\u5668\u3002 */ RUNNABLE, /** * \u7ebf\u7a0b\u963b\u585e\u7b49\u5f85\u76d1\u89c6\u5668\u9501\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u76d1\u89c6\u5668\u9501\u8fdb\u5165\u540c\u6b65\u5757/\u65b9\u6cd5\u6216\u5728\u8c03 * \u7528Object.wait\u540e\u91cd\u65b0\u8fdb\u5165\u540c\u6b65\u5757/\u65b9\u6cd5\u3002 */ BLOCKED, /** * \u7b49\u5f85\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7531\u4e8e\u8c03\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff0c\u7ebf\u7a0b\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff1a * Object.wait\u6ca1\u6709\u8d85\u65f6 * \u6ca1\u6709\u8d85\u65f6\u7684Thread.join * LockSupport.park * \u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u3002 * \u4f8b\u5982\uff0c\u4e00\u4e2a\u5bf9\u5bf9\u8c61\u8c03\u7528Object.wait()\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8be5\u5bf9\u8c61\u8c03\u7528Object.notify() * \u6216Object.notifyAll() \u3002\u5df2\u8c03\u7528Thread.join()\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u6307\u5b9a\u7ebf\u7a0b\u7ec8\u6b62\u3002 */ WAITING, /** * \u5177\u6709\u6307\u5b9a\u7b49\u5f85\u65f6\u95f4\u7684\u7b49\u5f85\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7531\u4e8e\u4ee5\u6307\u5b9a\u7684\u6b63\u7b49\u5f85\u65f6\u95f4\u8c03\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff0c\u7ebf\u7a0b\u5904\u4e8e\u5b9a * \u65f6\u7b49\u5f85\u72b6\u6001\uff1a * Thread.sleep * Object.wait\u8d85\u65f6 * Thread.join\u8d85\u65f6 * LockSupport.parkNanos * LockSupport.parkUntil * </ul> */ TIMED_WAITING, /** * \u5df2\u7ec8\u6b62\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u72b6\u6001\u3002\u7ebf\u7a0b\u5df2\u5b8c\u6210\u6267\u884c */ TERMINATED; } \u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684 \u5206\u522b\u662f \u65b0\u5efa \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\u88ab\u521b\u5efa\uff0c\u4f46\u8fd8\u672a\u8c03\u7528 start \u65b9\u6cd5\u65f6\u5904\u4e8e \u65b0\u5efa \u72b6\u6001 \u6b64\u65f6\u672a\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054 \u53ef\u8fd0\u884c \u8c03\u7528\u4e86 start \u65b9\u6cd5\uff0c\u5c31\u4f1a\u7531 \u65b0\u5efa \u8fdb\u5165 \u53ef\u8fd0\u884c \u6b64\u65f6\u4e0e\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u6267\u884c \u7ec8\u7ed3 \u7ebf\u7a0b\u5185\u4ee3\u7801\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 \u7ec8\u7ed3 \u6b64\u65f6\u4f1a\u53d6\u6d88\u4e0e\u5e95\u5c42\u7ebf\u7a0b\u5173\u8054 \u963b\u585e \u5f53\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 Monitor \u7684\u963b\u585e\u961f\u5217 \u963b\u585e \uff0c\u6b64\u65f6\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u6301\u9501\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u963b\u585e\u961f\u5217\u4e2d\u7684 \u963b\u585e \u7ebf\u7a0b\uff0c\u5524\u9192\u540e\u7684\u7ebf\u7a0b\u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001 \u7b49\u5f85 \u5f53\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait() \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501\u8fdb\u5165 Monitor \u7b49\u5f85\u96c6\u5408 \u7b49\u5f85 \uff0c\u540c\u6837\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u7b49\u5f85\u96c6\u5408\u4e2d\u7684 \u7b49\u5f85 \u7ebf\u7a0b\uff0c\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u6709\u65f6\u9650\u7b49\u5f85 \u5f53\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait(long) \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501\u8fdb\u5165 Monitor \u7b49\u5f85\u96c6\u5408\u8fdb\u884c \u6709\u65f6\u9650\u7b49\u5f85 \uff0c\u540c\u6837\u4e0d\u5360\u7528 cpu \u65f6\u95f4 \u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u7b49\u5f85\u96c6\u5408\u4e2d\u7684 \u6709\u65f6\u9650\u7b49\u5f85 \u7ebf\u7a0b\uff0c\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001\uff0c\u5e76\u91cd\u65b0\u53bb\u7ade\u4e89\u9501 \u5982\u679c\u7b49\u5f85\u8d85\u65f6\uff0c\u4e5f\u4f1a\u4ece \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001\uff0c\u5e76\u91cd\u65b0\u53bb\u7ade\u4e89\u9501 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f\u8c03\u7528 sleep(long) \u65b9\u6cd5\u4e5f\u4f1a\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u8fdb\u5165 \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\uff0c\u4f46\u4e0e Monitor \u65e0\u5173\uff0c\u4e0d\u9700\u8981\u4e3b\u52a8\u5524\u9192\uff0c\u8d85\u65f6\u65f6\u95f4\u5230\u81ea\u7136\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001","title":"1.6 \u7ebf\u7a0b\u5305\u62ec\u54ea\u4e9b\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#17-t1t2t3","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728\u591a\u7ebf\u7a0b\u4e2d\u6709\u591a\u79cd\u65b9\u6cd5\u8ba9\u7ebf\u7a0b\u6309\u7279\u5b9a\u987a\u5e8f\u6267\u884c\uff0c\u4f60\u53ef\u4ee5\u7528\u7ebf\u7a0b\u7c7b\u7684 join ()\u65b9\u6cd5\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u542f\u52a8\u53e6\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u8be5\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u3002 \u4ee3\u7801\u4e3e\u4f8b\uff1a \u4e3a\u4e86\u786e\u4fdd\u4e09\u4e2a\u7ebf\u7a0b\u7684\u987a\u5e8f\u4f60\u5e94\u8be5\u5148\u542f\u52a8\u6700\u540e\u4e00\u4e2a(T3\u8c03\u7528T2\uff0cT2\u8c03\u7528T1)\uff0c\u8fd9\u6837T1\u5c31\u4f1a\u5148\u5b8c\u6210\u800cT3\u6700\u540e\u5b8c\u6210 public class JoinTest { public static void main(String[] args) { // \u521b\u5efa\u7ebf\u7a0b\u5bf9\u8c61 Thread t1 = new Thread(() -> { System.out.println(\"t1\"); }) ; Thread t2 = new Thread(() -> { try { t1.join(); // \u52a0\u5165\u7ebf\u7a0bt1,\u53ea\u6709t1\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u4ee5\u540e\uff0c\u518d\u6b21\u6267\u884c\u8be5\u7ebf\u7a0b } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"t2\"); }) ; Thread t3 = new Thread(() -> { try { t2.join(); // \u52a0\u5165\u7ebf\u7a0bt2,\u53ea\u6709t2\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u4ee5\u540e\uff0c\u518d\u6b21\u6267\u884c\u8be5\u7ebf\u7a0b } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"t3\"); }) ; // \u542f\u52a8\u7ebf\u7a0b t1.start(); t2.start(); t3.start(); } }","title":"1.7 \u65b0\u5efa T1\u3001T2\u3001T3 \u4e09\u4e2a\u7ebf\u7a0b\uff0c\u5982\u4f55\u4fdd\u8bc1\u5b83\u4eec\u6309\u987a\u5e8f\u6267\u884c\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#18-notify-notifyall","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 notifyAll\uff1a\u5524\u9192\u6240\u6709wait\u7684\u7ebf\u7a0b notify\uff1a\u53ea\u968f\u673a\u5524\u9192\u4e00\u4e2a wait \u7ebf\u7a0b package com.itheima.basic; public class WaitNotify { static boolean flag = false; static Object lock = new Object(); public static void main(String[] args) { Thread t1 = new Thread(() -> { synchronized (lock){ while (!flag){ System.out.println(Thread.currentThread().getName()+\"...wating...\"); try { lock.wait(); } catch (InterruptedException e) { e.printStackTrace(); } } System.out.println(Thread.currentThread().getName()+\"...flag is true\"); } }); Thread t2 = new Thread(() -> { synchronized (lock){ while (!flag){ System.out.println(Thread.currentThread().getName()+\"...wating...\"); try { lock.wait(); } catch (InterruptedException e) { e.printStackTrace(); } } System.out.println(Thread.currentThread().getName()+\"...flag is true\"); } }); Thread t3 = new Thread(() -> { synchronized (lock) { System.out.println(Thread.currentThread().getName() + \" hold lock\"); lock.notifyAll(); flag = true; try { Thread.sleep(2000); } catch (InterruptedException e) { e.printStackTrace(); } } }); t1.start(); t2.start(); t3.start(); } }","title":"1.8 notify()\u548c notifyAll()\u6709\u4ec0\u4e48\u533a\u522b\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#19-java-wait-sleep","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u5171\u540c\u70b9 wait() \uff0cwait(long) \u548c sleep(long) \u7684\u6548\u679c\u90fd\u662f\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6682\u65f6\u653e\u5f03 CPU \u7684\u4f7f\u7528\u6743\uff0c\u8fdb\u5165\u963b\u585e\u72b6\u6001 \u4e0d\u540c\u70b9 \u65b9\u6cd5\u5f52\u5c5e\u4e0d\u540c sleep(long) \u662f Thread \u7684\u9759\u6001\u65b9\u6cd5 \u800c wait()\uff0cwait(long) \u90fd\u662f Object \u7684\u6210\u5458\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709 \u9192\u6765\u65f6\u673a\u4e0d\u540c \u6267\u884c sleep(long) \u548c wait(long) \u7684\u7ebf\u7a0b\u90fd\u4f1a\u5728\u7b49\u5f85\u76f8\u5e94\u6beb\u79d2\u540e\u9192\u6765 wait(long) \u548c wait() \u8fd8\u53ef\u4ee5\u88ab notify \u5524\u9192\uff0cwait() \u5982\u679c\u4e0d\u5524\u9192\u5c31\u4e00\u76f4\u7b49\u4e0b\u53bb \u5b83\u4eec\u90fd\u53ef\u4ee5\u88ab\u6253\u65ad\u5524\u9192 \u9501\u7279\u6027\u4e0d\u540c\uff08\u91cd\u70b9\uff09 wait \u65b9\u6cd5\u7684\u8c03\u7528\u5fc5\u987b\u5148\u83b7\u53d6 wait \u5bf9\u8c61\u7684\u9501\uff0c\u800c sleep \u5219\u65e0\u6b64\u9650\u5236 wait \u65b9\u6cd5\u6267\u884c\u540e\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff0c\u5141\u8bb8\u5176\u5b83\u7ebf\u7a0b\u83b7\u5f97\u8be5\u5bf9\u8c61\u9501\uff08\u6211\u653e\u5f03 cpu\uff0c\u4f46\u4f60\u4eec\u8fd8\u53ef\u4ee5\u7528\uff09 \u800c sleep \u5982\u679c\u5728 synchronized \u4ee3\u7801\u5757\u4e2d\u6267\u884c\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff08\u6211\u653e\u5f03 cpu\uff0c\u4f60\u4eec\u4e5f\u7528\u4e0d\u4e86\uff09 \u4ee3\u7801\u793a\u4f8b\uff1a public class WaitSleepCase { static final Object LOCK = new Object(); public static void main(String[] args) throws InterruptedException { sleeping(); } private static void illegalWait() throws InterruptedException { LOCK.wait(); } private static void waiting() throws InterruptedException { Thread t1 = new Thread(() -> { synchronized (LOCK) { try { get(\"t\").debug(\"waiting...\"); LOCK.wait(5000L); } catch (InterruptedException e) { get(\"t\").debug(\"interrupted...\"); e.printStackTrace(); } } }, \"t1\"); t1.start(); Thread.sleep(100); synchronized (LOCK) { main.debug(\"other...\"); } } private static void sleeping() throws InterruptedException { Thread t1 = new Thread(() -> { synchronized (LOCK) { try { get(\"t\").debug(\"sleeping...\"); Thread.sleep(5000L); } catch (InterruptedException e) { get(\"t\").debug(\"interrupted...\"); e.printStackTrace(); } } }, \"t1\"); t1.start(); Thread.sleep(100); synchronized (LOCK) { main.debug(\"other...\"); } } }","title":"1.9 \u5728 java \u4e2d wait \u548c sleep \u65b9\u6cd5\u7684\u4e0d\u540c\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#110","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 \u53c2\u8003\u56de\u7b54\uff1a \u6709\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u505c\u6b62\u7ebf\u7a0b \u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa\uff0c\u4e5f\u5c31\u662f\u5f53run\u65b9\u6cd5\u5b8c\u6210\u540e\u7ebf\u7a0b\u7ec8\u6b62 \u4f7f\u7528stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62\uff08\u4e0d\u63a8\u8350\uff0c\u65b9\u6cd5\u5df2\u4f5c\u5e9f\uff09 \u4f7f\u7528interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b \u4ee3\u7801\u53c2\u8003\u5982\u4e0b\uff1a \u2460 \u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa \u3002 public class MyInterrupt1 extends Thread { volatile boolean flag = false ; // \u7ebf\u7a0b\u6267\u884c\u7684\u9000\u51fa\u6807\u8bb0 @Override public void run() { while(!flag) { System.out.println(\"MyThread...run...\"); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { // \u521b\u5efaMyThread\u5bf9\u8c61 MyInterrupt1 t1 = new MyInterrupt1() ; t1.start(); // \u4e3b\u7ebf\u7a0b\u4f11\u77206\u79d2 Thread.sleep(6000); // \u66f4\u6539\u6807\u8bb0\u4e3atrue t1.flag = true ; } } \u2461 \u4f7f\u7528stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62 public class MyInterrupt2 extends Thread { volatile boolean flag = false ; // \u7ebf\u7a0b\u6267\u884c\u7684\u9000\u51fa\u6807\u8bb0 @Override public void run() { while(!flag) { System.out.println(\"MyThread...run...\"); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { // \u521b\u5efaMyThread\u5bf9\u8c61 MyInterrupt2 t1 = new MyInterrupt2() ; t1.start(); // \u4e3b\u7ebf\u7a0b\u4f11\u77202\u79d2 Thread.sleep(6000); // \u8c03\u7528stop\u65b9\u6cd5 t1.stop(); } } \u2462 \u4f7f\u7528interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b \u3002 package com.itheima.basic; public class MyInterrupt3 { public static void main(String[] args) throws InterruptedException { //1.\u6253\u65ad\u963b\u585e\u7684\u7ebf\u7a0b /*Thread t1 = new Thread(()->{ System.out.println(\"t1 \u6b63\u5728\u8fd0\u884c...\"); try { Thread.sleep(5000); } catch (InterruptedException e) { e.printStackTrace(); } }, \"t1\"); t1.start(); Thread.sleep(500); t1.interrupt(); System.out.println(t1.isInterrupted());*/ //2.\u6253\u65ad\u6b63\u5e38\u7684\u7ebf\u7a0b Thread t2 = new Thread(()->{ while(true) { Thread current = Thread.currentThread(); boolean interrupted = current.isInterrupted(); if(interrupted) { System.out.println(\"\u6253\u65ad\u72b6\u6001\uff1a\"+interrupted); break; } } }, \"t2\"); t2.start(); Thread.sleep(500); // t2.interrupt(); } }","title":"1.10 \u5982\u4f55\u505c\u6b62\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#2","text":"","title":"2.\u7ebf\u7a0b\u4e2d\u5e76\u53d1\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#21-synchronized","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"2.1 \u8bb2\u4e00\u4e0bsynchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#211","text":"\u5982\u4e0b\u62a2\u7968\u7684\u4ee3\u7801\uff0c\u5982\u679c\u4e0d\u52a0\u9501\uff0c\u5c31\u4f1a\u51fa\u73b0\u8d85\u5356\u6216\u8005\u4e00\u5f20\u7968\u5356\u7ed9\u591a\u4e2a\u4eba Synchronized\u3010\u5bf9\u8c61\u9501\u3011\u91c7\u7528\u4e92\u65a5\u7684\u65b9\u5f0f\u8ba9\u540c\u4e00\u65f6\u523b\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u6301\u6709\u3010\u5bf9\u8c61\u9501\u3011\uff0c\u5176\u5b83\u7ebf\u7a0b\u518d\u60f3\u83b7\u53d6\u8fd9\u4e2a\u3010\u5bf9\u8c61\u9501\u3011\u65f6\u5c31\u4f1a\u963b\u585e\u4f4f public class TicketDemo { static Object lock = new Object(); int ticketNum = 10; public synchronized void getTicket() { synchronized (this) { if (ticketNum <= 0) { return; } System.out.println(Thread.currentThread().getName() + \"\u62a2\u5230\u4e00\u5f20\u7968,\u5269\u4f59:\" + ticketNum); // \u975e\u539f\u5b50\u6027\u64cd\u4f5c ticketNum--; } } public static void main(String[] args) { TicketDemo ticketDemo = new TicketDemo(); for (int i = 0; i < 20; i++) { new Thread(() -> { ticketDemo.getTicket(); }).start(); } } }","title":"2.1.1 \u57fa\u672c\u4f7f\u7528"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#212-monitor","text":"Monitor \u88ab\u7ffb\u8bd1\u4e3a\u76d1\u89c6\u5668\uff0c\u662f\u7531jvm\u63d0\u4f9b\uff0cc++\u8bed\u8a00\u5b9e\u73b0 \u5728\u4ee3\u7801\u4e2d\u60f3\u8981\u4f53\u73b0monitor\u9700\u8981\u501f\u52a9javap\u547d\u4ee4\u67e5\u770bclsss\u7684\u5b57\u8282\u7801\uff0c\u6bd4\u5982\u4ee5\u4e0b\u4ee3\u7801\uff1a public class SyncTest { static final Object lock = new Object(); static int counter = 0; public static void main(String[] args) { synchronized (lock) { counter++; } } } \u627e\u5230\u8fd9\u4e2a\u7c7b\u7684class\u6587\u4ef6\uff0c\u5728class\u6587\u4ef6\u76ee\u5f55\u4e0b\u6267\u884c javap -v SyncTest.class \uff0c\u53cd\u7f16\u8bd1\u6548\u679c\u5982\u4e0b\uff1a monitorenter \u4e0a\u9501\u5f00\u59cb\u7684\u5730\u65b9 monitorexit \u89e3\u9501\u7684\u5730\u65b9 \u5176\u4e2d\u88abmonitorenter\u548cmonitorexit\u5305\u56f4\u4f4f\u7684\u6307\u4ee4\u5c31\u662f\u4e0a\u9501\u7684\u4ee3\u7801 \u6709\u4e24\u4e2amonitorexit\u7684\u539f\u56e0\uff0c\u7b2c\u4e8c\u4e2amonitorexit\u662f\u4e3a\u4e86\u9632\u6b62\u9501\u4f4f\u7684\u4ee3\u7801\u629b\u5f02\u5e38\u540e\u4e0d\u80fd\u53ca\u65f6\u91ca\u653e\u9501 \u5728\u4f7f\u7528\u4e86synchornized\u4ee3\u7801\u5757\u65f6\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6240\u4ee5synchornized\u4e5f\u88ab\u79f0\u4e3a\u5bf9\u8c61\u9501 monitor\u4e3b\u8981\u5c31\u662f\u8ddf\u8fd9\u4e2a\u5bf9\u8c61\u4ea7\u751f\u5173\u8054\uff0c\u5982\u4e0b\u56fe Monitor\u5185\u90e8\u5177\u4f53\u7684\u5b58\u50a8\u7ed3\u6784\uff1a Owner\uff1a\u5b58\u50a8\u5f53\u524d\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u7684\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u83b7\u53d6 EntryList\uff1a\u5173\u8054\u6ca1\u6709\u62a2\u5230\u9501\u7684\u7ebf\u7a0b\uff0c\u5904\u4e8eBlocked\u72b6\u6001\u7684\u7ebf\u7a0b WaitSet\uff1a\u5173\u8054\u8c03\u7528\u4e86wait\u65b9\u6cd5\u7684\u7ebf\u7a0b\uff0c\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b \u5177\u4f53\u7684\u6d41\u7a0b\uff1a \u4ee3\u7801\u8fdb\u5165synchorized\u4ee3\u7801\u5757\uff0c\u5148\u8ba9lock\uff08\u5bf9\u8c61\u9501\uff09\u5173\u8054\u7684monitor\uff0c\u7136\u540e\u5224\u65adOwner\u662f\u5426\u6709\u7ebf\u7a0b\u6301\u6709 \u5982\u679c\u6ca1\u6709\u7ebf\u7a0b\u6301\u6709\uff0c\u5219\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6301\u6709\uff0c\u8868\u793a\u8be5\u7ebf\u7a0b\u83b7\u53d6\u9501\u6210\u529f \u5982\u679c\u6709\u7ebf\u7a0b\u6301\u6709\uff0c\u5219\u8ba9\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165entryList\u8fdb\u884c\u963b\u585e\uff0c\u5982\u679cOwner\u6301\u6709\u7684\u7ebf\u7a0b\u5df2\u7ecf\u91ca\u653e\u4e86\u9501\uff0c\u5728EntryList\u4e2d\u7684\u7ebf\u7a0b\u53bb\u7ade\u4e89\u9501\u7684\u6301\u6709\u6743\uff08\u975e\u516c\u5e73\uff09 \u5982\u679c\u4ee3\u7801\u5757\u4e2d\u8c03\u7528\u4e86wait()\u65b9\u6cd5\uff0c\u5219\u4f1a\u8fdb\u53bbWaitSet\u4e2d\u8fdb\u884c\u7b49\u5f85 \u53c2\u8003\u56de\u7b54\uff1a Synchronized\u3010\u5bf9\u8c61\u9501\u3011\u91c7\u7528\u4e92\u65a5\u7684\u65b9\u5f0f\u8ba9\u540c\u4e00\u65f6\u523b\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u6301\u6709\u3010\u5bf9\u8c61\u9501\u3011 \u5b83\u7684\u5e95\u5c42\u7531monitor\u5b9e\u73b0\u7684\uff0cmonitor\u662fjvm\u7ea7\u522b\u7684\u5bf9\u8c61\uff08 C++\u5b9e\u73b0\uff09\uff0c\u7ebf\u7a0b\u83b7\u5f97\u9501\u9700\u8981\u4f7f\u7528\u5bf9\u8c61\uff08\u9501\uff09\u5173\u8054monitor \u5728monitor\u5185\u90e8\u6709\u4e09\u4e2a\u5c5e\u6027\uff0c\u5206\u522b\u662fowner\u3001entrylist\u3001waitset \u5176\u4e2downer\u662f\u5173\u8054\u7684\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\uff0c\u5e76\u4e14\u53ea\u80fd\u5173\u8054\u4e00\u4e2a\u7ebf\u7a0b\uff1bentrylist\u5173\u8054\u7684\u662f\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684\u7ebf\u7a0b\uff1bwaitset\u5173\u8054\u7684\u662f\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b","title":"2.1.2 Monitor"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#22-synchronized-","text":"Monitor\u5b9e\u73b0\u7684\u9501\u5c5e\u4e8e\u91cd\u91cf\u7ea7\u9501\uff0c\u4f60\u4e86\u89e3\u8fc7\u9501\u5347\u7ea7\u5417\uff1f Monitor\u5b9e\u73b0\u7684\u9501\u5c5e\u4e8e\u91cd\u91cf\u7ea7\u9501\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u5728JDK 1.6\u5f15\u5165\u4e86\u4e24\u79cd\u65b0\u578b\u9501\u673a\u5236\uff1a\u504f\u5411\u9501\u548c\u8f7b\u91cf\u7ea7\u9501\uff0c\u5b83\u4eec\u7684\u5f15\u5165\u662f\u4e3a\u4e86\u89e3\u51b3\u5728\u6ca1\u6709\u591a\u7ebf\u7a0b\u7ade\u4e89\u6216\u57fa\u672c\u6ca1\u6709\u7ade\u4e89\u7684\u573a\u666f\u4e0b\u56e0\u4f7f\u7528\u4f20\u7edf\u9501\u673a\u5236\u5e26\u6765\u7684\u6027\u80fd\u5f00\u9500\u95ee\u9898\u3002","title":"2.2 synchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406-\u8fdb\u9636"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#221","text":"\u5728HotSpot\u865a\u62df\u673a\u4e2d\uff0c\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u5b58\u50a8\u7684\u5e03\u5c40\u53ef\u5206\u4e3a3\u5757\u533a\u57df\uff1a\u5bf9\u8c61\u5934\uff08Header\uff09\u3001\u5b9e\u4f8b\u6570\u636e\uff08Instance Data\uff09\u548c\u5bf9\u9f50\u586b\u5145 \u6211\u4eec\u9700\u8981\u91cd\u70b9\u5206\u6790MarkWord\u5bf9\u8c61\u5934","title":"2.2.1 \u5bf9\u8c61\u7684\u5185\u5b58\u7ed3\u6784"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#222-markword","text":"hashcode\uff1a25\u4f4d\u7684\u5bf9\u8c61\u6807\u8bc6Hash\u7801 age\uff1a\u5bf9\u8c61\u5206\u4ee3\u5e74\u9f84\u53604\u4f4d biased_lock\uff1a\u504f\u5411\u9501\u6807\u8bc6\uff0c\u53601\u4f4d \uff0c0\u8868\u793a\u6ca1\u6709\u5f00\u59cb\u504f\u5411\u9501\uff0c1\u8868\u793a\u5f00\u542f\u4e86\u504f\u5411\u9501 thread\uff1a\u6301\u6709\u504f\u5411\u9501\u7684\u7ebf\u7a0bID\uff0c\u536023\u4f4d epoch\uff1a\u504f\u5411\u65f6\u95f4\u6233\uff0c\u53602\u4f4d ptr_to_lock_record\uff1a\u8f7b\u91cf\u7ea7\u9501\u72b6\u6001\u4e0b\uff0c\u6307\u5411\u6808\u4e2d\u9501\u8bb0\u5f55\u7684\u6307\u9488\uff0c\u536030\u4f4d ptr_to_heavyweight_monitor\uff1a\u91cd\u91cf\u7ea7\u9501\u72b6\u6001\u4e0b\uff0c\u6307\u5411\u5bf9\u8c61\u76d1\u89c6\u5668Monitor\u7684\u6307\u9488\uff0c\u536030\u4f4d \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7lock\u7684\u6807\u8bc6\uff0c\u6765\u5224\u65ad\u662f\u54ea\u4e00\u79cd\u9501\u7684\u7b49\u7ea7 \u540e\u4e09\u4f4d\u662f001\u8868\u793a\u65e0\u9501 \u540e\u4e09\u4f4d\u662f101\u8868\u793a\u504f\u5411\u9501 \u540e\u4e24\u4f4d\u662f00\u8868\u793a\u8f7b\u91cf\u7ea7\u9501 \u540e\u4e24\u4f4d\u662f10\u8868\u793a\u91cd\u91cf\u7ea7\u9501","title":"2.2.2 MarkWord"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#223-monitor","text":"\u6bcf\u4e2a Java \u5bf9\u8c61\u90fd\u53ef\u4ee5\u5173\u8054\u4e00\u4e2a Monitor \u5bf9\u8c61\uff0c\u5982\u679c\u4f7f\u7528 synchronized \u7ed9\u5bf9\u8c61\u4e0a\u9501\uff08\u91cd\u91cf\u7ea7\uff09\u4e4b\u540e\uff0c \u8be5\u5bf9\u8c61\u5934\u7684Mark Word \u4e2d\u5c31\u88ab\u8bbe\u7f6e\u6307\u5411 Monitor \u5bf9\u8c61\u7684\u6307\u9488 \u7b80\u5355\u8bf4\u5c31\u662f\uff1a\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u90fd\u53ef\u4ee5\u8bbe\u7f6emonoitor\u7684\u6307\u9488\uff0c\u8ba9\u5bf9\u8c61\u4e0emonitor\u4ea7\u751f\u5173\u8054","title":"2.2.3 \u518d\u8bf4Monitor\u91cd\u91cf\u7ea7\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#224","text":"\u5728\u5f88\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u5728Java\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u540c\u6b65\u5757\u4e2d\u7684\u4ee3\u7801\u90fd\u662f\u4e0d\u5b58\u5728\u7ade\u4e89\u7684\uff0c\u4e0d\u540c\u7684\u7ebf\u7a0b\u4ea4\u66ff\u7684\u6267\u884c\u540c\u6b65\u5757\u4e2d\u7684\u4ee3\u7801\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u91cd\u91cf\u7ea7\u9501\u662f\u6ca1\u5fc5\u8981\u7684\u3002\u56e0\u6b64JVM\u5f15\u5165\u4e86\u8f7b\u91cf\u7ea7\u9501\u7684\u6982\u5ff5\u3002 static final Object obj = new Object(); public static void method1() { synchronized (obj) { // \u540c\u6b65\u5757 A method2(); } } public static void method2() { synchronized (obj) { // \u540c\u6b65\u5757 B } } \u52a0\u9501\u7684\u6d41\u7a0b 1.\u5728\u7ebf\u7a0b\u6808\u4e2d\u521b\u5efa\u4e00\u4e2aLock Record\uff0c\u5c06\u5176obj\u5b57\u6bb5\u6307\u5411\u9501\u5bf9\u8c61\u3002 2.\u901a\u8fc7CAS\u6307\u4ee4\u5c06Lock Record\u7684\u5730\u5740\u5b58\u50a8\u5728\u5bf9\u8c61\u5934\u7684mark word\u4e2d\uff08\u6570\u636e\u8fdb\u884c\u4ea4\u6362\uff09\uff0c\u5982\u679c\u5bf9\u8c61\u5904\u4e8e\u65e0\u9501\u72b6\u6001\u5219\u4fee\u6539\u6210\u529f\uff0c\u4ee3\u8868\u8be5\u7ebf\u7a0b\u83b7\u5f97\u4e86\u8f7b\u91cf\u7ea7\u9501\u3002 3.\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u8be5\u9501\u4e86\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u9501\u91cd\u5165\u3002\u8bbe\u7f6eLock Record\u7b2c\u4e00\u90e8\u5206\u4e3anull\uff0c\u8d77\u5230\u4e86\u4e00\u4e2a\u91cd\u5165\u8ba1\u6570\u5668\u7684\u4f5c\u7528\u3002 4.\u5982\u679cCAS\u4fee\u6539\u5931\u8d25\uff0c\u8bf4\u660e\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u9700\u8981\u81a8\u80c0\u4e3a\u91cd\u91cf\u7ea7\u9501\u3002 \u89e3\u9501\u8fc7\u7a0b 1.\u904d\u5386\u7ebf\u7a0b\u6808,\u627e\u5230\u6240\u6709obj\u5b57\u6bb5\u7b49\u4e8e\u5f53\u524d\u9501\u5bf9\u8c61\u7684Lock Record\u3002 2.\u5982\u679cLock Record\u7684Mark Word\u4e3anull\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u91cd\u5165\uff0c\u5c06obj\u8bbe\u7f6e\u4e3anull\u540econtinue\u3002 3.\u5982\u679cLock Record\u7684 Mark Word\u4e0d\u4e3anull\uff0c\u5219\u5229\u7528CAS\u6307\u4ee4\u5c06\u5bf9\u8c61\u5934\u7684mark word\u6062\u590d\u6210\u4e3a\u65e0\u9501\u72b6\u6001\u3002\u5982\u679c\u5931\u8d25\u5219\u81a8\u80c0\u4e3a\u91cd\u91cf\u7ea7\u9501\u3002","title":"2.2.4 \u8f7b\u91cf\u7ea7\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#225","text":"\u8f7b\u91cf\u7ea7\u9501\u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff08\u5c31\u81ea\u5df1\u8fd9\u4e2a\u7ebf\u7a0b\uff09\uff0c\u6bcf\u6b21\u91cd\u5165\u4ecd\u7136\u9700\u8981\u6267\u884c CAS \u64cd\u4f5c\u3002 Java 6 \u4e2d\u5f15\u5165\u4e86\u504f\u5411\u9501\u6765\u505a\u8fdb\u4e00\u6b65\u4f18\u5316\uff1a\u53ea\u6709\u7b2c\u4e00\u6b21\u4f7f\u7528 CAS \u5c06\u7ebf\u7a0b ID \u8bbe\u7f6e\u5230\u5bf9\u8c61\u7684 Mark Word \u5934\uff0c\u4e4b\u540e\u53d1\u73b0 \u8fd9\u4e2a\u7ebf\u7a0b ID \u662f\u81ea\u5df1\u7684\u5c31\u8868\u793a\u6ca1\u6709\u7ade\u4e89\uff0c\u4e0d\u7528\u91cd\u65b0 CAS\u3002\u4ee5\u540e\u53ea\u8981\u4e0d\u53d1\u751f\u7ade\u4e89\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5f52\u8be5\u7ebf\u7a0b\u6240\u6709 static final Object obj = new Object(); public static void m1() { synchronized (obj) { // \u540c\u6b65\u5757 A m2(); } } public static void m2() { synchronized (obj) { // \u540c\u6b65\u5757 B m3(); } } public static void m3() { synchronized (obj) { } } \u52a0\u9501\u7684\u6d41\u7a0b 1.\u5728\u7ebf\u7a0b\u6808\u4e2d\u521b\u5efa\u4e00\u4e2aLock Record\uff0c\u5c06\u5176obj\u5b57\u6bb5\u6307\u5411\u9501\u5bf9\u8c61\u3002 2.\u901a\u8fc7CAS\u6307\u4ee4\u5c06Lock Record\u7684 \u7ebf\u7a0bid \u5b58\u50a8\u5728\u5bf9\u8c61\u5934\u7684mark word\u4e2d\uff0c\u540c\u65f6\u4e5f\u8bbe\u7f6e\u504f\u5411\u9501\u7684\u6807\u8bc6\u4e3a101\uff0c\u5982\u679c\u5bf9\u8c61\u5904\u4e8e\u65e0\u9501\u72b6\u6001\u5219\u4fee\u6539\u6210\u529f\uff0c\u4ee3\u8868\u8be5\u7ebf\u7a0b\u83b7\u5f97\u4e86\u504f\u5411\u9501\u3002 3.\u5982\u679c\u662f\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u8be5\u9501\u4e86\uff0c\u4ee3\u8868\u8fd9\u662f\u4e00\u6b21\u9501\u91cd\u5165\u3002\u8bbe\u7f6eLock Record\u7b2c\u4e00\u90e8\u5206\u4e3anull\uff0c\u8d77\u5230\u4e86\u4e00\u4e2a\u91cd\u5165\u8ba1\u6570\u5668\u7684\u4f5c\u7528\u3002\u4e0e\u8f7b\u91cf\u7ea7\u9501\u4e0d\u540c\u7684\u65f6\uff0c\u8fd9\u91cc\u4e0d\u4f1a\u518d\u6b21\u8fdb\u884ccas\u64cd\u4f5c\uff0c\u53ea\u662f\u5224\u65ad\u5bf9\u8c61\u5934\u4e2d\u7684\u7ebf\u7a0bid\u662f\u5426\u662f\u81ea\u5df1\uff0c\u56e0\u4e3a\u7f3a\u5c11\u4e86cas\u64cd\u4f5c\uff0c\u6027\u80fd\u76f8\u5bf9\u8f7b\u91cf\u7ea7\u9501\u66f4\u597d\u4e00\u4e9b \u89e3\u9501\u6d41\u7a0b\u53c2\u8003\u8f7b\u91cf\u7ea7\u9501","title":"2.2.5 \u504f\u5411\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#226","text":"Java\u4e2d\u7684synchronized\u6709\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\u3001\u91cd\u91cf\u7ea7\u9501\u4e09\u79cd\u5f62\u5f0f\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u9501\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u3001\u4e0d\u540c\u7ebf\u7a0b\u4ea4\u66ff\u6301\u6709\u9501\u3001\u591a\u7ebf\u7a0b\u7ade\u4e89\u9501\u4e09\u79cd\u60c5\u51b5\u3002 \u63cf\u8ff0 \u91cd\u91cf\u7ea7\u9501 \u5e95\u5c42\u4f7f\u7528\u7684Monitor\u5b9e\u73b0\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u8f7b\u91cf\u7ea7\u9501 \u7ebf\u7a0b\u52a0\u9501\u7684\u65f6\u95f4\u662f\u9519\u5f00\u7684\uff08\u4e5f\u5c31\u662f\u6ca1\u6709\u7ade\u4e89\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f7b\u91cf\u7ea7\u9501\u6765\u4f18\u5316\u3002\u8f7b\u91cf\u7ea7\u4fee\u6539\u4e86\u5bf9\u8c61\u5934\u7684\u9501\u6807\u5fd7\uff0c\u76f8\u5bf9\u91cd\u91cf\u7ea7\u9501\u6027\u80fd\u63d0\u5347\u5f88\u591a\u3002\u6bcf\u6b21\u4fee\u6539\u90fd\u662fCAS\u64cd\u4f5c\uff0c\u4fdd\u8bc1\u539f\u5b50\u6027 \u504f\u5411\u9501 \u4e00\u6bb5\u5f88\u957f\u7684\u65f6\u95f4\u5185\u90fd\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u504f\u5411\u9501\uff0c\u5728\u7b2c\u4e00\u6b21\u83b7\u5f97\u9501\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2aCAS\u64cd\u4f5c\uff0c\u4e4b\u540e\u8be5\u7ebf\u7a0b\u518d\u83b7\u53d6\u9501\uff0c\u53ea\u9700\u8981\u5224\u65admark word\u4e2d\u662f\u5426\u662f\u81ea\u5df1\u7684\u7ebf\u7a0bid\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u5f00\u9500\u76f8\u5bf9\u8f83\u5927\u7684CAS\u547d\u4ee4 \u4e00\u65e6\u9501\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u90fd\u4f1a\u5347\u7ea7\u4e3a\u91cd\u91cf\u7ea7\u9501","title":"2.2.6 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#23-jmmjava","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 JMM(Java Memory Model)Java\u5185\u5b58\u6a21\u578b,\u662fjava\u865a\u62df\u673a\u89c4\u8303\u4e2d\u6240\u5b9a\u4e49\u7684\u4e00\u79cd\u5185\u5b58\u6a21\u578b\u3002 Java\u5185\u5b58\u6a21\u578b(Java Memory Model)\u63cf\u8ff0\u4e86Java\u7a0b\u5e8f\u4e2d\u5404\u79cd\u53d8\u91cf(\u7ebf\u7a0b\u5171\u4eab\u53d8\u91cf)\u7684\u8bbf\u95ee\u89c4\u5219\uff0c\u4ee5\u53ca\u5728JVM\u4e2d\u5c06\u53d8\u91cf\u5b58\u50a8\u5230\u5185\u5b58\u548c\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u53d8\u91cf\u8fd9\u6837\u7684\u5e95\u5c42\u7ec6\u8282\u3002 \u7279\u70b9\uff1a \u6240\u6709\u7684\u5171\u4eab\u53d8\u91cf\u90fd\u5b58\u50a8\u4e8e\u4e3b\u5185\u5b58(\u8ba1\u7b97\u673a\u7684RAM)\u8fd9\u91cc\u6240\u8bf4\u7684\u53d8\u91cf\u6307\u7684\u662f\u5b9e\u4f8b\u53d8\u91cf\u548c\u7c7b\u53d8\u91cf\u3002\u4e0d\u5305\u542b\u5c40\u90e8\u53d8\u91cf\uff0c\u56e0\u4e3a\u5c40\u90e8\u53d8\u91cf\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u7ade\u4e89\u95ee\u9898\u3002 \u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u8fd8\u5b58\u5728\u81ea\u5df1\u7684\u5de5\u4f5c\u5185\u5b58\uff0c\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\uff0c\u4fdd\u7559\u4e86\u88ab\u7ebf\u7a0b\u4f7f\u7528\u7684\u53d8\u91cf\u7684\u5de5\u4f5c\u526f\u672c\u3002 \u7ebf\u7a0b\u5bf9\u53d8\u91cf\u7684\u6240\u6709\u7684\u64cd\u4f5c(\u8bfb\uff0c\u5199)\u90fd\u5fc5\u987b\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u5b8c\u6210\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u8bfb\u5199\u4e3b\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u4e0d\u540c\u7ebf\u7a0b\u4e4b\u95f4\u4e5f\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5bf9\u65b9\u5de5\u4f5c\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u7ebf\u7a0b\u95f4\u53d8\u91cf\u7684\u503c\u7684\u4f20\u9012\u9700\u8981\u901a\u8fc7\u4e3b\u5185\u5b58\u5b8c\u6210\u3002","title":"2.3\u4f60\u8c08\u8c08 JMM\uff08Java \u5185\u5b58\u6a21\u578b\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#24-cas","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606","title":"2.4 CAS \u4f60\u77e5\u9053\u5417\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#241","text":"CAS\u7684\u5168\u79f0\u662f\uff1a Compare And Swap(\u6bd4\u8f83\u518d\u4ea4\u6362)\uff0c\u5b83\u4f53\u73b0\u7684\u4e00\u79cd\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff0c\u5728\u65e0\u9501\u60c5\u51b5\u4e0b\u4fdd\u8bc1\u7ebf\u7a0b\u64cd\u4f5c\u5171\u4eab\u6570\u636e\u7684\u539f\u5b50\u6027\u3002 \u5728JUC\uff08 java.util.concurrent \uff09\u5305\u4e0b\u5b9e\u73b0\u7684\u5f88\u591a\u7c7b\u90fd\u7528\u5230\u4e86CAS\u64cd\u4f5c AbstractQueuedSynchronizer\uff08AQS\u6846\u67b6\uff09 AtomicXXX\u7c7b \u4f8b\u5b50\uff1a \u6211\u4eec\u8fd8\u662f\u57fa\u4e8e\u521a\u624d\u5b66\u4e60\u8fc7\u7684JMM\u5185\u5b58\u6a21\u578b\u8fdb\u884c\u8bf4\u660e \u7ebf\u7a0b1\u4e0e\u7ebf\u7a0b2\u90fd\u4ece\u4e3b\u5185\u5b58\u4e2d\u83b7\u53d6\u53d8\u91cfint a = 100,\u540c\u65f6\u653e\u5230\u5404\u4e2a\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u4e2d \u4e00\u4e2a\u5f53\u524d\u5185\u5b58\u503cV\u3001\u65e7\u7684\u9884\u671f\u503cA\u3001\u5373\u5c06\u66f4\u65b0\u7684\u503cB\uff0c\u5f53\u4e14\u4ec5\u5f53\u65e7\u7684\u9884\u671f\u503cA\u548c\u5185\u5b58\u503cV\u76f8\u540c\u65f6\uff0c\u5c06\u5185\u5b58\u503c\u4fee\u6539\u4e3aB\u5e76\u8fd4\u56detrue\uff0c\u5426\u5219\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u5e76\u8fd4\u56defalse\u3002\u5982\u679cCAS\u64cd\u4f5c\u5931\u8d25\uff0c\u901a\u8fc7\u81ea\u65cb\u7684\u65b9\u5f0f\u7b49\u5f85\u5e76\u518d\u6b21\u5c1d\u8bd5\uff0c\u76f4\u5230\u6210\u529f \u7ebf\u7a0b1\u64cd\u4f5c\uff1aV\uff1aint a = 100\uff0cA\uff1aint a = 100\uff0cB\uff1a\u4fee\u6539\u540e\u7684\u503c\uff1aint a = 101 (a++) \u7ebf\u7a0b1\u62ffA\u7684\u503c\u4e0e\u4e3b\u5185\u5b58V\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5224\u65ad\u662f\u5426\u76f8\u7b49 \u5982\u679c\u76f8\u7b49\uff0c\u5219\u628aB\u7684\u503c101\u66f4\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d \u7ebf\u7a0b2\u64cd\u4f5c\uff1aV\uff1aint a = 100\uff0cA\uff1aint a = 100\uff0cB\uff1a\u4fee\u6539\u540e\u7684\u503c\uff1aint a = 99(a--) \u7ebf\u7a0b2\u62ffA\u7684\u503c\u4e0e\u4e3b\u5185\u5b58V\u7684\u503c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5224\u65ad\u662f\u5426\u76f8\u7b49(\u76ee\u524d\u4e0d\u76f8\u7b49\uff0c\u56e0\u4e3a\u7ebf\u7a0b1\u5df2\u66f4\u65b0V\u7684\u503c99) \u4e0d\u76f8\u7b49\uff0c\u5219\u7ebf\u7a0b2\u66f4\u65b0\u5931\u8d25 \u81ea\u65cb\u9501\u64cd\u4f5c \u56e0\u4e3a\u6ca1\u6709\u52a0\u9501\uff0c\u6240\u4ee5\u7ebf\u7a0b\u4e0d\u4f1a\u9677\u5165\u963b\u585e\uff0c\u6548\u7387\u8f83\u9ad8 \u5982\u679c\u7ade\u4e89\u6fc0\u70c8\uff0c\u91cd\u8bd5\u9891\u7e41\u53d1\u751f\uff0c\u6548\u7387\u4f1a\u53d7\u5f71\u54cd \u9700\u8981\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u5171\u4eab\u5185\u5b58V\u4e2d\u6700\u65b0\u7684\u503c\uff0c\u7136\u540e\u518d\u5728\u65b0\u7684\u503c\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\uff0c\u5982\u679c\u5931\u8d25\u5c31\u7ee7\u7eed\u5c1d\u8bd5\u83b7\u53d6\u65b0\u7684\u503c\uff0c\u76f4\u5230\u66f4\u65b0\u6210\u529f","title":"2.4.1 \u6982\u8ff0\u53ca\u57fa\u672c\u5de5\u4f5c\u6d41\u7a0b"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#242-cas","text":"CAS \u5e95\u5c42\u4f9d\u8d56\u4e8e\u4e00\u4e2a Unsafe \u7c7b\u6765\u76f4\u63a5\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u7684 CAS \u6307\u4ee4 \u90fd\u662fnative\u4fee\u9970\u7684\u65b9\u6cd5\uff0c\u7531\u7cfb\u7edf\u63d0\u4f9b\u7684\u63a5\u53e3\u6267\u884c\uff0c\u5e76\u975ejava\u4ee3\u7801\u5b9e\u73b0\uff0c\u4e00\u822c\u7684\u601d\u8def\u4e5f\u90fd\u662f\u81ea\u65cb\u9501\u5b9e\u73b0 \u5728java\u4e2d\u6bd4\u8f83\u5e38\u89c1\u4f7f\u7528\u6709\u5f88\u591a\uff0c\u6bd4\u5982ReentrantLock\u548cAtomic\u5f00\u5934\u7684\u7ebf\u7a0b\u5b89\u5168\u7c7b\uff0c\u90fd\u8c03\u7528\u4e86Unsafe\u4e2d\u7684\u65b9\u6cd5 ReentrantLock\u4e2d\u7684\u4e00\u6bb5CAS\u4ee3\u7801","title":"2.4.2 CAS \u5e95\u5c42\u5b9e\u73b0"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#243","text":"CAS \u662f\u57fa\u4e8e\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff1a\u6700\u4e50\u89c2\u7684\u4f30\u8ba1\uff0c\u4e0d\u6015\u522b\u7684\u7ebf\u7a0b\u6765\u4fee\u6539\u5171\u4eab\u53d8\u91cf\uff0c\u5c31\u7b97\u6539\u4e86\u4e5f\u6ca1\u5173\u7cfb\uff0c\u6211\u5403\u4e8f\u70b9\u518d\u91cd\u8bd5\u5457\u3002 synchronized \u662f\u57fa\u4e8e\u60b2\u89c2\u9501\u7684\u601d\u60f3\uff1a\u6700\u60b2\u89c2\u7684\u4f30\u8ba1\uff0c\u5f97\u9632\u7740\u5176\u5b83\u7ebf\u7a0b\u6765\u4fee\u6539\u5171\u4eab\u53d8\u91cf\uff0c\u6211\u4e0a\u4e86\u9501\u4f60\u4eec\u90fd\u522b\u60f3\u6539\uff0c\u6211\u6539\u5b8c\u4e86\u89e3\u5f00\u9501\uff0c\u4f60\u4eec\u624d\u6709\u673a\u4f1a\u3002","title":"2.4.3 \u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#25-volatile","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e00\u65e6\u4e00\u4e2a\u5171\u4eab\u53d8\u91cf\uff08\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u3001\u7c7b\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\uff09\u88abvolatile\u4fee\u9970\u4e4b\u540e\uff0c\u90a3\u4e48\u5c31\u5177\u5907\u4e86\u4e24\u5c42\u8bed\u4e49\uff1a","title":"2.5 \u8bf7\u8c08\u8c08\u4f60\u5bf9 volatile \u7684\u7406\u89e3"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#251","text":"\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u65f6\u7684\u53ef\u89c1\u6027\uff0c\u5373\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u8fd9\u65b0\u503c\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u6765\u8bf4\u662f\u7acb\u5373\u53ef\u89c1\u7684,volatile\u5173\u952e\u5b57\u4f1a\u5f3a\u5236\u5c06\u4fee\u6539\u7684\u503c\u7acb\u5373\u5199\u5165\u4e3b\u5b58\u3002 \u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff1a\u6c38\u4e0d\u505c\u6b62\u7684\u5faa\u73af package com.itheima.basic; // \u53ef\u89c1\u6027\u4f8b\u5b50 // -Xint public class ForeverLoop { static boolean stop = false; public static void main(String[] args) { new Thread(() -> { try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } stop = true; System.out.println(\"modify stop to true...\"); }).start(); foo(); } static void foo() { int i = 0; while (!stop) { i++; } System.out.println(\"stopped... c:\"+ i); } } \u5f53\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u53d1\u73b0foo()\u65b9\u6cd5\u4e2d\u7684\u5faa\u73af\u662f\u7ed3\u675f\u4e0d\u4e86\u7684\uff0c\u4e5f\u5c31\u8bf4\u8bfb\u53d6\u4e0d\u5230\u5171\u4eab\u53d8\u91cf\u7684\u503c\u7ed3\u675f\u5faa\u73af\u3002 \u4e3b\u8981\u662f\u56e0\u4e3a\u5728JVM\u865a\u62df\u673a\u4e2d\u6709\u4e00\u4e2aJIT\uff08\u5373\u65f6\u7f16\u8f91\u5668\uff09\u7ed9\u4ee3\u7801\u505a\u4e86\u4f18\u5316\u3002 \u4e0a\u8ff0\u4ee3\u7801 java while (!stop) { i++; } \u5728\u5f88\u77ed\u7684\u65f6\u95f4\u5185\uff0c\u8fd9\u4e2a\u4ee3\u7801\u6267\u884c\u7684\u6b21\u6570\u592a\u591a\u4e86\uff0c\u5f53\u8fbe\u5230\u4e86\u4e00\u4e2a\u9608\u503c\uff0cJIT\u5c31\u4f1a\u4f18\u5316\u6b64\u4ee3\u7801\uff0c\u5982\u4e0b\uff1a java while (true) { i++; } \u5f53\u628a\u4ee3\u7801\u4f18\u5316\u6210\u8fd9\u6837\u5b50\u4ee5\u540e\uff0c\u53ca\u65f6 stop \u53d8\u91cf\u6539\u53d8\u4e3a\u4e86 false \u4e5f\u4f9d\u7136\u505c\u6b62\u4e0d\u4e86\u5faa\u73af \u89e3\u51b3\u65b9\u6848\uff1a \u7b2c\u4e00\uff1a \u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u52a0\u5165vm\u53c2\u6570 -Xint \u8868\u793a\u7981\u7528\u5373\u65f6\u7f16\u8f91\u5668\uff0c\u4e0d\u63a8\u8350\uff0c\u5f97\u4e0d\u507f\u5931\uff08\u5176\u4ed6\u7a0b\u5e8f\u8fd8\u8981\u4f7f\u7528\uff09 \u7b2c\u4e8c\uff1a \u5728\u4fee\u9970 stop \u53d8\u91cf\u7684\u65f6\u5019\u52a0\u4e0a volatile ,\u8868\u793a\u5f53\u524d\u4ee3\u7801\u7981\u7528\u4e86\u5373\u65f6\u7f16\u8f91\u5668\uff0c\u95ee\u9898\u5c31\u53ef\u4ee5\u89e3\u51b3\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a static volatile boolean stop = false;","title":"2.5.1 \u4fdd\u8bc1\u7ebf\u7a0b\u95f4\u7684\u53ef\u89c1\u6027"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#252","text":"\u7528 volatile \u4fee\u9970\u5171\u4eab\u53d8\u91cf\u4f1a\u5728\u8bfb\u3001\u5199\u5171\u4eab\u53d8\u91cf\u65f6\u52a0\u5165\u4e0d\u540c\u7684\u5c4f\u969c\uff0c\u963b\u6b62\u5176\u4ed6\u8bfb\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\uff0c\u4ece\u800c\u8fbe\u5230\u963b\u6b62\u91cd\u6392\u5e8f\u7684\u6548\u679c \u5728\u53bb\u83b7\u53d6\u4e0a\u9762\u7684\u7ed3\u679c\u7684\u65f6\u5019\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b04\u79cd\u60c5\u51b5 \u60c5\u51b5\u4e00\uff1a\u5148\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->0,0(\u6b63\u5e38) \u60c5\u51b5\u4e8c\uff1a\u5148\u6267\u884cactor1\u4e2d\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->0,1(\u6b63\u5e38) \u60c5\u51b5\u4e09\uff1a\u5148\u6267\u884cactor1\u4e2d\u6240\u6709\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->1,1(\u6b63\u5e38) \u60c5\u51b5\u56db\uff1a\u5148\u6267\u884cactor1\u4e2d\u7b2c\u4e8c\u884c\u4ee3\u7801\uff0c\u7136\u540e\u6267\u884cactor2\u83b7\u53d6\u7ed3\u679c--->1,0(\u53d1\u751f\u4e86\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u5f71\u54cd\u7ed3\u679c) \u89e3\u51b3\u65b9\u6848 \u5728\u53d8\u91cf\u4e0a\u6dfb\u52a0volatile\uff0c\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u5219\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898 \u5c4f\u969c\u6dfb\u52a0\u7684\u793a\u610f\u56fe \u5199\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0a\u65b9\u5176\u5b83\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u5199\u4e4b\u4e0b \u8bfb\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0b\u65b9\u5176\u5b83\u8bfb\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u8bfb\u4e4b\u4e0a \u5176\u4ed6\u8865\u5145 \u6211\u4eec\u4e0a\u9762\u7684\u89e3\u51b3\u65b9\u6848\u662f\u628avolatile\u52a0\u5728\u4e86int y\u8fd9\u4e2a\u53d8\u91cf\u4e0a\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u628a\u5b83\u52a0\u5728int x\u8fd9\u4e2a\u53d8\u91cf\u4e0a\u5462\uff1f \u4e0b\u9762\u4ee3\u7801\u4f7f\u7528volatile\u4fee\u9970\u4e86x\u53d8\u91cf \u5c4f\u969c\u6dfb\u52a0\u7684\u793a\u610f\u56fe \u8fd9\u6837\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u4e0b\u9762\u4e24\u4e2a\u539f\u5219\uff1a \u5199\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0a\u65b9\u5176\u5b83\u5199\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u5199\u4e4b\u4e0b \u8bfb\u64cd\u4f5c\u52a0\u7684\u5c4f\u969c\u662f\u963b\u6b62\u4e0b\u65b9\u5176\u5b83\u8bfb\u64cd\u4f5c\u8d8a\u8fc7\u5c4f\u969c\u6392\u5230volatile\u53d8\u91cf\u8bfb\u4e4b\u4e0a \u6240\u4ee5\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u603b\u7ed3\u4e00\u4e2avolatile\u4f7f\u7528\u7684\u5c0f\u5999\u62db\uff1a \u5199\u53d8\u91cf\u8ba9volatile\u4fee\u9970\u7684\u53d8\u91cf\u7684\u5728\u4ee3\u7801\u6700\u540e\u4f4d\u7f6e \u8bfb\u53d8\u91cf\u8ba9volatile\u4fee\u9970\u7684\u53d8\u91cf\u7684\u5728\u4ee3\u7801\u6700\u5f00\u59cb\u4f4d\u7f6e","title":"2.5.2 \u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#26-aqs","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"2.6 \u4ec0\u4e48\u662fAQS\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#261","text":"\u5168\u79f0\u662f AbstractQueuedSynchronizer\uff0c\u662f\u963b\u585e\u5f0f\u9501\u548c\u76f8\u5173\u7684\u540c\u6b65\u5668\u5de5\u5177\u7684\u6846\u67b6\uff0c\u5b83\u662f\u6784\u5efa\u9501\u6216\u8005\u5176\u4ed6\u540c\u6b65\u7ec4\u4ef6\u7684\u57fa\u7840\u6846\u67b6 AQS\u4e0eSynchronized\u7684\u533a\u522b synchronized AQS \u5173\u952e\u5b57\uff0cc++ \u8bed\u8a00\u5b9e\u73b0 java \u8bed\u8a00\u5b9e\u73b0 \u60b2\u89c2\u9501\uff0c\u81ea\u52a8\u91ca\u653e\u9501 \u60b2\u89c2\u9501\uff0c\u624b\u52a8\u5f00\u542f\u548c\u5173\u95ed \u9501\u7ade\u4e89\u6fc0\u70c8\u90fd\u662f\u91cd\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u5dee \u9501\u7ade\u4e89\u6fc0\u70c8\u7684\u60c5\u51b5\u4e0b\uff0c\u63d0\u4f9b\u4e86\u591a\u79cd\u89e3\u51b3\u65b9\u6848 AQS\u5e38\u89c1\u7684\u5b9e\u73b0\u7c7b ReentrantLock \u963b\u585e\u5f0f\u9501 Semaphore \u4fe1\u53f7\u91cf CountDownLatch \u5012\u8ba1\u65f6\u9501","title":"2.6.1 \u6982\u8ff0"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#262","text":"\u5728AQS\u4e2d\u7ef4\u62a4\u4e86\u4e00\u4e2a\u4f7f\u7528\u4e86volatile\u4fee\u9970\u7684state\u5c5e\u6027\u6765\u8868\u793a\u8d44\u6e90\u7684\u72b6\u6001\uff0c0\u8868\u793a\u65e0\u9501\uff0c1\u8868\u793a\u6709\u9501 \u63d0\u4f9b\u4e86\u57fa\u4e8e FIFO \u7684\u7b49\u5f85\u961f\u5217\uff0c\u7c7b\u4f3c\u4e8e Monitor \u7684 EntryList \u6761\u4ef6\u53d8\u91cf\u6765\u5b9e\u73b0\u7b49\u5f85\u3001\u5524\u9192\u673a\u5236\uff0c\u652f\u6301\u591a\u4e2a\u6761\u4ef6\u53d8\u91cf\uff0c\u7c7b\u4f3c\u4e8e Monitor \u7684 WaitSet \u7ebf\u7a0b0\u6765\u4e86\u4ee5\u540e\uff0c\u53bb\u5c1d\u8bd5\u4fee\u6539state\u5c5e\u6027\uff0c\u5982\u679c\u53d1\u73b0state\u5c5e\u6027\u662f0\uff0c\u5c31\u4fee\u6539state\u72b6\u6001\u4e3a1\uff0c\u8868\u793a\u7ebf\u7a0b0\u62a2\u9501\u6210\u529f \u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u4e5f\u4f1a\u5148\u5c1d\u8bd5\u4fee\u6539state\u5c5e\u6027\uff0c\u53d1\u73b0state\u7684\u503c\u5df2\u7ecf\u662f1\u4e86\uff0c\u6709\u5176\u4ed6\u7ebf\u7a0b\u6301\u6709\u9501\uff0c\u5b83\u4eec\u90fd\u4f1a\u5230FIFO\u961f\u5217\u4e2d\u8fdb\u884c\u7b49\u5f85\uff0c FIFO\u662f\u4e00\u4e2a\u53cc\u5411\u961f\u5217\uff0chead\u5c5e\u6027\u8868\u793a\u5934\u7ed3\u70b9\uff0ctail\u8868\u793a\u5c3e\u7ed3\u70b9 \u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u5171\u540c\u53bb\u62a2\u8fd9\u4e2a\u8d44\u6e90\u662f\u5982\u4f55\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u5462\uff1f \u5728\u53bb\u4fee\u6539state\u72b6\u6001\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7684cas\u81ea\u65cb\u9501\u6765\u4fdd\u8bc1\u539f\u5b50\u6027\uff0c\u786e\u4fdd\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u6210\u529f\uff0c\u4fee\u6539\u5931\u8d25\u7684\u7ebf\u7a0b\u5c06\u4f1a\u8fdb\u5165FIFO\u961f\u5217\u4e2d\u7b49\u5f85 AQS\u662f\u516c\u5e73\u9501\u5417\uff0c\u8fd8\u662f\u975e\u516c\u5e73\u9501\uff1f \u65b0\u7684\u7ebf\u7a0b\u4e0e\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u5171\u540c\u6765\u62a2\u8d44\u6e90\uff0c\u662f\u975e\u516c\u5e73\u9501 \u65b0\u7684\u7ebf\u7a0b\u5230\u961f\u5217\u4e2d\u7b49\u5f85\uff0c\u53ea\u8ba9\u961f\u5217\u4e2d\u7684head\u7ebf\u7a0b\u83b7\u53d6\u9501\uff0c\u662f\u516c\u5e73\u9501 \u6bd4\u8f83\u5178\u578b\u7684AQS\u5b9e\u73b0\u7c7bReentrantLock\uff0c\u5b83\u9ed8\u8ba4\u5c31\u662f\u975e\u516c\u5e73\u9501\uff0c\u65b0\u7684\u7ebf\u7a0b\u4e0e\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u5171\u540c\u6765\u62a2\u8d44\u6e90","title":"2.6.2 \u5de5\u4f5c\u673a\u5236"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#25-reentrantlock","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"2.5 ReentrantLock\u7684\u5b9e\u73b0\u539f\u7406"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#251_1","text":"ReentrantLock\u7ffb\u8bd1\u8fc7\u6765\u662f\u53ef\u91cd\u5165\u9501\uff0c\u76f8\u5bf9\u4e8esynchronized\u5b83\u5177\u5907\u4ee5\u4e0b\u7279\u70b9\uff1a \u53ef\u4e2d\u65ad \u53ef\u4ee5\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 \u53ef\u4ee5\u8bbe\u7f6e\u516c\u5e73\u9501 \u652f\u6301\u591a\u4e2a\u6761\u4ef6\u53d8\u91cf \u4e0esynchronized\u4e00\u6837\uff0c\u90fd\u652f\u6301\u91cd\u5165","title":"2.5.1 \u6982\u8ff0"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#252_1","text":"ReentrantLock\u4e3b\u8981\u5229\u7528CAS+AQS\u961f\u5217\u6765\u5b9e\u73b0\u3002\u5b83\u652f\u6301\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501\uff0c\u4e24\u8005\u7684\u5b9e\u73b0\u7c7b\u4f3c \u6784\u9020\u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u7684\u516c\u5e73\u53c2\u6570\uff08\u9ed8\u8ba4\u975e\u516c\u5e73\u9501\uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\uff0c\u8868\u793a\u516c\u5e73\u9501\uff0c\u5426\u5219\u4e3a\u975e\u516c\u5e73\u9501\u3002\u516c\u5e73\u9501\u7684\u6548\u7387\u5f80\u5f80\u6ca1\u6709\u975e\u516c\u5e73\u9501\u7684\u6548\u7387\u9ad8\uff0c\u5728\u8bb8\u591a\u7ebf\u7a0b\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\uff0c\u516c\u5e73\u9501\u8868\u73b0\u51fa\u8f83\u4f4e\u7684\u541e\u5410\u91cf\u3002 \u67e5\u770bReentrantLock\u6e90\u7801\u4e2d\u7684\u6784\u9020\u65b9\u6cd5\uff1a \u63d0\u4f9b\u4e86\u4e24\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u4e0d\u5e26\u53c2\u6570\u7684\u9ed8\u8ba4\u4e3a\u975e\u516c\u5e73 \u5982\u679c\u4f7f\u7528\u5e26\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\uff0c\u5e76\u4e14\u4f20\u7684\u503c\u4e3atrue\uff0c\u5219\u662f\u516c\u5e73\u9501 \u5176\u4e2dNonfairSync\u548cFairSync\u8fd9\u4e24\u4e2a\u7c7b\u7236\u7c7b\u90fd\u662fSync \u800cSync\u7684\u7236\u7c7b\u662fAQS\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u51faReentrantLock\u5e95\u5c42\u4e3b\u8981\u5b9e\u73b0\u5c31\u662f\u57fa\u4e8eAQS\u6765\u5b9e\u73b0\u7684 \u5de5\u4f5c\u6d41\u7a0b \u7ebf\u7a0b\u6765\u62a2\u9501\u540e\u4f7f\u7528cas\u7684\u65b9\u5f0f\u4fee\u6539state\u72b6\u6001\uff0c\u4fee\u6539\u72b6\u6001\u6210\u529f\u4e3a1\uff0c\u5219\u8ba9exclusiveOwnerThread\u5c5e\u6027\u6307\u5411\u5f53\u524d\u7ebf\u7a0b\uff0c\u83b7\u53d6\u9501\u6210\u529f \u5047\u5982\u4fee\u6539\u72b6\u6001\u5931\u8d25\uff0c\u5219\u4f1a\u8fdb\u5165\u53cc\u5411\u961f\u5217\u4e2d\u7b49\u5f85\uff0chead\u6307\u5411\u53cc\u5411\u961f\u5217\u5934\u90e8\uff0ctail\u6307\u5411\u53cc\u5411\u961f\u5217\u5c3e\u90e8 \u5f53exclusiveOwnerThread\u4e3anull\u7684\u65f6\u5019\uff0c\u5219\u4f1a\u5524\u9192\u5728\u53cc\u5411\u961f\u5217\u4e2d\u7b49\u5f85\u7684\u7ebf\u7a0b \u516c\u5e73\u9501\u5219\u4f53\u73b0\u5728\u6309\u7167\u5148\u540e\u987a\u5e8f\u83b7\u53d6\u9501\uff0c\u975e\u516c\u5e73\u4f53\u73b0\u5728\u4e0d\u5728\u6392\u961f\u7684\u7ebf\u7a0b\u4e5f\u53ef\u4ee5\u62a2\u9501","title":"2.5.2 \u5b9e\u73b0\u539f\u7406"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#26-synchronizedlock","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u53c2\u8003\u56de\u7b54 \u8bed\u6cd5\u5c42\u9762 synchronized \u662f\u5173\u952e\u5b57\uff0c\u6e90\u7801\u5728 jvm \u4e2d\uff0c\u7528 c++ \u8bed\u8a00\u5b9e\u73b0 Lock \u662f\u63a5\u53e3\uff0c\u6e90\u7801\u7531 jdk \u63d0\u4f9b\uff0c\u7528 java \u8bed\u8a00\u5b9e\u73b0 \u4f7f\u7528 synchronized \u65f6\uff0c\u9000\u51fa\u540c\u6b65\u4ee3\u7801\u5757\u9501\u4f1a\u81ea\u52a8\u91ca\u653e\uff0c\u800c\u4f7f\u7528 Lock \u65f6\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 unlock \u65b9\u6cd5\u91ca\u653e\u9501 \u529f\u80fd\u5c42\u9762 \u4e8c\u8005\u5747\u5c5e\u4e8e\u60b2\u89c2\u9501\u3001\u90fd\u5177\u5907\u57fa\u672c\u7684\u4e92\u65a5\u3001\u540c\u6b65\u3001\u9501\u91cd\u5165\u529f\u80fd Lock \u63d0\u4f9b\u4e86\u8bb8\u591a synchronized \u4e0d\u5177\u5907\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u83b7\u53d6\u7b49\u5f85\u72b6\u6001\u3001\u516c\u5e73\u9501\u3001\u53ef\u6253\u65ad\u3001\u53ef\u8d85\u65f6\u3001\u591a\u6761\u4ef6\u53d8\u91cf Lock \u6709\u9002\u5408\u4e0d\u540c\u573a\u666f\u7684\u5b9e\u73b0\uff0c\u5982 ReentrantLock\uff0c ReentrantReadWriteLock \u6027\u80fd\u5c42\u9762 \u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff0csynchronized \u505a\u4e86\u5f88\u591a\u4f18\u5316\uff0c\u5982\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u4e0d\u8d56 \u5728\u7ade\u4e89\u6fc0\u70c8\u65f6\uff0cLock \u7684\u5b9e\u73b0\u901a\u5e38\u4f1a\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd","title":"2.6 synchronized\u548cLock\u6709\u4ec0\u4e48\u533a\u522b ?"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#27","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u6b7b\u9501 \uff1a\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u540c\u65f6\u83b7\u53d6\u591a\u628a\u9501\uff0c\u8fd9\u65f6\u5c31\u5bb9\u6613\u53d1\u751f\u6b7b\u9501 \u4f8b\u5982\uff1a t1 \u7ebf\u7a0b\u83b7\u5f97A\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6B\u5bf9\u8c61\u7684\u9501 t2 \u7ebf\u7a0b\u83b7\u5f97B\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6A\u5bf9\u8c61\u7684\u9501 \u4ee3\u7801\u5982\u4e0b\uff1a package com.itheima.basic; import static java.lang.Thread.sleep; public class Deadlock { public static void main(String[] args) { Object A = new Object(); Object B = new Object(); Thread t1 = new Thread(() -> { synchronized (A) { System.out.println(\"lock A\"); try { sleep(1000); } catch (InterruptedException e) { throw new RuntimeException(e); } synchronized (B) { System.out.println(\"lock B\"); System.out.println(\"\u64cd\u4f5c...\"); } } }, \"t1\"); Thread t2 = new Thread(() -> { synchronized (B) { System.out.println(\"lock B\"); try { sleep(500); } catch (InterruptedException e) { throw new RuntimeException(e); } synchronized (A) { System.out.println(\"lock A\"); System.out.println(\"\u64cd\u4f5c...\"); } } }, \"t2\"); t1.start(); t2.start(); } } \u63a7\u5236\u53f0\u8f93\u51fa\u7ed3\u679c \u6b64\u65f6\u7a0b\u5e8f\u5e76\u6ca1\u6709\u7ed3\u675f\uff0c\u8fd9\u79cd\u73b0\u8c61\u5c31\u662f\u6b7b\u9501\u73b0\u8c61...\u7ebf\u7a0bt1\u6301\u6709A\u7684\u9501\u7b49\u5f85\u83b7\u53d6B\u9501\uff0c\u7ebf\u7a0bt2\u6301\u6709B\u7684\u9501\u7b49\u5f85\u83b7\u53d6A\u7684\u9501\u3002","title":"2.7 \u6b7b\u9501\u4ea7\u751f\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#28","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5f53\u7a0b\u5e8f\u51fa\u73b0\u4e86\u6b7b\u9501\u73b0\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528jdk\u81ea\u5e26\u7684\u5de5\u5177\uff1ajps\u548c jstack \u6b65\u9aa4\u5982\u4e0b\uff1a \u7b2c\u4e00\uff1a\u67e5\u770b\u8fd0\u884c\u7684\u7ebf\u7a0b \u7b2c\u4e8c\uff1a\u4f7f\u7528jstack\u67e5\u770b\u7ebf\u7a0b\u8fd0\u884c\u7684\u60c5\u51b5\uff0c\u4e0b\u56fe\u662f\u622a\u56fe\u7684\u5173\u952e\u4fe1\u606f \u8fd0\u884c\u547d\u4ee4\uff1a jstack -l 46032 \u5176\u4ed6\u89e3\u51b3\u5de5\u5177\uff0c\u53ef\u89c6\u5316\u5de5\u5177 jconsole \u7528\u4e8e\u5bf9jvm\u7684\u5185\u5b58\uff0c\u7ebf\u7a0b\uff0c\u7c7b \u7684\u76d1\u63a7\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8e jmx \u7684 GUI \u6027\u80fd\u76d1\u63a7\u5de5\u5177 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jconsole.exe \u5c31\u884c VisualVM\uff1a\u6545\u969c\u5904\u7406\u5de5\u5177 \u80fd\u591f\u76d1\u63a7\u7ebf\u7a0b\uff0c\u5185\u5b58\u60c5\u51b5\uff0c\u67e5\u770b\u65b9\u6cd5\u7684CPU\u65f6\u95f4\u548c\u5185\u5b58\u4e2d\u7684\u5bf9 \u8c61\uff0c\u5df2\u88abGC\u7684\u5bf9\u8c61\uff0c\u53cd\u5411\u67e5\u770b\u5206\u914d\u7684\u5806\u6808 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jvisualvm.exe\u5c31\u884c","title":"2.8 \u5982\u4f55\u8fdb\u884c\u6b7b\u9501\u8bca\u65ad\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#210-concurrenthashmap","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 ConcurrentHashMap \u662f\u4e00\u79cd\u7ebf\u7a0b\u5b89\u5168\u7684\u9ad8\u6548Map\u96c6\u5408 \u5e95\u5c42\u6570\u636e\u7ed3\u6784\uff1a JDK1.7\u5e95\u5c42\u91c7\u7528\u5206\u6bb5\u7684\u6570\u7ec4+\u94fe\u8868\u5b9e\u73b0 JDK1.8 \u91c7\u7528\u7684\u6570\u636e\u7ed3\u6784\u8ddfHashMap1.8\u7684\u7ed3\u6784\u4e00\u6837\uff0c\u6570\u7ec4+\u94fe\u8868/\u7ea2\u9ed1\u4e8c\u53c9\u6811\u3002","title":"2.10 ConcurrentHashMap"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#1-jdk17concurrenthashmap","text":"\u6570\u636e\u7ed3\u6784 \u63d0\u4f9b\u4e86\u4e00\u4e2asegment\u6570\u7ec4\uff0c\u5728\u521d\u59cb\u5316ConcurrentHashMap \u7684\u65f6\u5019\u53ef\u4ee5\u6307\u5b9a\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u9ed8\u8ba4\u662f16\uff0c\u4e00\u65e6\u521d\u59cb\u5316\u4e4b\u540e\u4e2d\u95f4\u4e0d\u53ef\u6269\u5bb9 \u5728\u6bcf\u4e2asegment\u4e2d\u90fd\u53ef\u4ee5\u6302\u4e00\u4e2aHashEntry\u6570\u7ec4\uff0c\u6570\u7ec4\u91cc\u9762\u53ef\u4ee5\u5b58\u50a8\u5177\u4f53\u7684\u5143\u7d20\uff0cHashEntry\u6570\u7ec4\u662f\u53ef\u4ee5\u6269\u5bb9\u7684 \u5728HashEntry\u5b58\u50a8\u7684\u6570\u7ec4\u4e2d\u5b58\u50a8\u7684\u5143\u7d20\uff0c\u5982\u679c\u53d1\u751f\u51b2\u7a81\uff0c\u5219\u53ef\u4ee5\u6302\u5355\u5411\u94fe\u8868 \u5b58\u50a8\u6d41\u7a0b \u5148\u53bb\u8ba1\u7b97key\u7684hash\u503c\uff0c\u7136\u540e\u786e\u5b9asegment\u6570\u7ec4\u4e0b\u6807 \u518d\u901a\u8fc7hash\u503c\u786e\u5b9ahashEntry\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u5b58\u50a8\u6570\u636e \u5728\u8fdb\u884c\u64cd\u4f5c\u6570\u636e\u7684\u4e4b\u524d\uff0c\u4f1a\u5148\u5224\u65ad\u5f53\u524dsegment\u5bf9\u5e94\u4e0b\u6807\u4f4d\u7f6e\u662f\u5426\u6709\u7ebf\u7a0b\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e3a\u4e86\u7ebf\u7a0b\u5b89\u5168\u4f7f\u7528\u7684\u662fReentrantLock\u8fdb\u884c\u52a0\u9501\uff0c\u5982\u679c\u83b7\u53d6\u9501\u662f\u88ab\u4f1a\u4f7f\u7528cas\u81ea\u65cb\u9501\u8fdb\u884c\u5c1d\u8bd5","title":"\uff081\uff09 JDK1.7\u4e2dconcurrentHashMap"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#2-jdk18concurrenthashmap","text":"\u5728JDK1.8\u4e2d\uff0c\u653e\u5f03\u4e86Segment\u81c3\u80bf\u7684\u8bbe\u8ba1\uff0c\u6570\u636e\u7ed3\u6784\u8ddfHashMap\u7684\u6570\u636e\u7ed3\u6784\u662f\u4e00\u6837\u7684\uff1a\u6570\u7ec4+\u7ea2\u9ed1\u6811+\u94fe\u8868 \u91c7\u7528 CAS + Synchronized\u6765\u4fdd\u8bc1\u5e76\u53d1\u5b89\u5168\u8fdb\u884c\u5b9e\u73b0 CAS\u63a7\u5236\u6570\u7ec4\u8282\u70b9\u7684\u6dfb\u52a0 synchronized\u53ea\u9501\u5b9a\u5f53\u524d\u94fe\u8868\u6216\u7ea2\u9ed1\u4e8c\u53c9\u6811\u7684\u9996\u8282\u70b9\uff0c\u53ea\u8981hash\u4e0d\u51b2\u7a81\uff0c\u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1\u7684\u95ee\u9898 , \u6548\u7387\u5f97\u5230\u63d0\u5347","title":"\uff082\uff09 JDK1.8\u4e2dconcurrentHashMap"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#211_1","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 Java\u5e76\u53d1\u7f16\u7a0b\u4e09\u5927\u7279\u6027 \u539f\u5b50\u6027 \u53ef\u89c1\u6027 \u6709\u5e8f\u6027","title":"2.11 \u5bfc\u81f4\u5e76\u53d1\u7a0b\u5e8f\u51fa\u73b0\u95ee\u9898\u7684\u6839\u672c\u539f\u56e0\u662f\u4ec0\u4e48"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#1_1","text":"\u4e00\u4e2a\u7ebf\u7a0b\u5728CPU\u4e2d\u64cd\u4f5c\u4e0d\u53ef\u6682\u505c\uff0c\u4e5f\u4e0d\u53ef\u4e2d\u65ad\uff0c\u8981\u4e0d\u6267\u884c\u5b8c\u6210\uff0c\u8981\u4e0d\u4e0d\u6267\u884c \u6bd4\u5982\uff0c\u5982\u4e0b\u4ee3\u7801\u80fd\u4fdd\u8bc1\u539f\u5b50\u6027\u5417\uff1f \u4ee5\u4e0a\u4ee3\u7801\u4f1a\u51fa\u73b0\u8d85\u5356\u6216\u8005\u662f\u4e00\u5f20\u7968\u5356\u7ed9\u540c\u4e00\u4e2a\u4eba\uff0c\u6267\u884c\u5e76\u4e0d\u662f\u539f\u5b50\u6027\u7684 \u89e3\u51b3\u65b9\u6848\uff1a 1.synchronized\uff1a\u540c\u6b65\u52a0\u9501 2.JUC\u91cc\u9762\u7684lock\uff1a\u52a0\u9501","title":"\uff081\uff09\u539f\u5b50\u6027"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3","text":"\u5185\u5b58\u53ef\u89c1\u6027\uff1a\u8ba9\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u4fee\u6539\u5bf9\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u89c1 \u6bd4\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u4e0d\u80fd\u4fdd\u8bc1\u5185\u5b58\u53ef\u89c1\u6027 \u89e3\u51b3\u65b9\u6848\uff1a synchronized volatile\uff08\u63a8\u8350\uff09 LOCK","title":"\uff083\uff09\u5185\u5b58\u53ef\u89c1\u6027"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3_1","text":"\u6307\u4ee4\u91cd\u6392\uff1a\u5904\u7406\u5668\u4e3a\u4e86\u63d0\u9ad8\u7a0b\u5e8f\u8fd0\u884c\u6548\u7387\uff0c\u53ef\u80fd\u4f1a\u5bf9\u8f93\u5165\u4ee3\u7801\u8fdb\u884c\u4f18\u5316\uff0c\u5b83\u4e0d\u4fdd\u8bc1\u7a0b\u5e8f\u4e2d\u5404\u4e2a\u8bed\u53e5\u7684\u6267\u884c\u5148\u540e\u987a\u5e8f\u540c\u4ee3\u7801\u4e2d\u7684\u987a\u5e8f\u4e00\u81f4\uff0c\u4f46\u662f\u5b83\u4f1a\u4fdd\u8bc1\u7a0b\u5e8f\u6700\u7ec8\u6267\u884c\u7ed3\u679c\u548c\u4ee3\u7801\u987a\u5e8f\u6267\u884c\u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684 \u8fd8\u662f\u4e4b\u524d\u7684\u4f8b\u5b50\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a \u89e3\u51b3\u65b9\u6848\uff1a volatile","title":"\uff083\uff09\u6709\u5e8f\u6027"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3_2","text":"","title":"3.\u7ebf\u7a0b\u6c60"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#31","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u4e3b\u8981\u53c2\u8003ThreadPoolExecutor\u8fd9\u4e2a\u7c7b\u76847\u4e2a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570 corePoolSize \u6838\u5fc3\u7ebf\u7a0b\u6570\u76ee maximumPoolSize \u6700\u5927\u7ebf\u7a0b\u6570\u76ee = (\u6838\u5fc3\u7ebf\u7a0b+\u6551\u6025\u7ebf\u7a0b\u7684\u6700\u5927\u6570\u76ee) keepAliveTime \u751f\u5b58\u65f6\u95f4 - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u751f\u5b58\u65f6\u95f4\u5185\u6ca1\u6709\u65b0\u4efb\u52a1\uff0c\u6b64\u7ebf\u7a0b\u8d44\u6e90\u4f1a\u91ca\u653e unit \u65f6\u95f4\u5355\u4f4d - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\u5355\u4f4d\uff0c\u5982\u79d2\u3001\u6beb\u79d2\u7b49 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 threadFactory \u7ebf\u7a0b\u5de5\u5382 - \u53ef\u4ee5\u5b9a\u5236\u7ebf\u7a0b\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u4f8b\u5982\u8bbe\u7f6e\u7ebf\u7a0b\u540d\u5b57\u3001\u662f\u5426\u662f\u5b88\u62a4\u7ebf\u7a0b\u7b49 handler \u62d2\u7edd\u7b56\u7565 - \u5f53\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0cworkQueue \u4e5f\u653e\u6ee1\u65f6\uff0c\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565 \u5de5\u4f5c\u6d41\u7a0b 1\uff0c\u4efb\u52a1\u5728\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u9996\u5148\u5224\u65ad\u6838\u5fc3\u7ebf\u7a0b\u6570\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u6ca1\u6709\u6ee1\u5219\u76f4\u63a5\u6dfb\u52a0\u5230\u5de5\u4f5c\u7ebf\u7a0b\u6267\u884c 2\uff0c\u5982\u679c\u6838\u5fc3\u7ebf\u7a0b\u6570\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u963b\u585e\u961f\u5217\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u6ca1\u6709\u6ee1\uff0c\u5f53\u524d\u4efb\u52a1\u5b58\u5165\u963b\u585e\u961f\u5217 3\uff0c\u5982\u679c\u963b\u585e\u961f\u5217\u4e5f\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u7ebf\u7a0b\u6570\u662f\u5426\u5c0f\u4e8e\u6700\u5927\u7ebf\u7a0b\u6570\uff0c\u5982\u679c\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u4f7f\u7528\u4e34\u65f6\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 \u5982\u679c\u6838\u5fc3\u6216\u4e34\u65f6\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u4efb\u52a1\u540e\u4f1a\u68c0\u67e5\u963b\u585e\u961f\u5217\u4e2d\u662f\u5426\u6709\u9700\u8981\u6267\u884c\u7684\u7ebf\u7a0b\uff0c\u5982\u679c\u6709\uff0c\u5219\u4f7f\u7528\u975e\u6838\u5fc3\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 4\uff0c\u5982\u679c\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u5fd9\u7740\uff08\u6838\u5fc3\u7ebf\u7a0b+\u4e34\u65f6\u7ebf\u7a0b\uff09\uff0c\u5219\u8d70\u62d2\u7edd\u7b56\u7565 \u62d2\u7edd\u7b56\u7565\uff1a 1.AbortPolicy\uff1a\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\uff0c\u9ed8\u8ba4\u7b56\u7565\uff1b 2.CallerRunsPolicy\uff1a\u7528\u8c03\u7528\u8005\u6240\u5728\u7684\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\uff1b 3.DiscardOldestPolicy\uff1a\u4e22\u5f03\u963b\u585e\u961f\u5217\u4e2d\u9760\u6700\u524d\u7684\u4efb\u52a1\uff0c\u5e76\u6267\u884c\u5f53\u524d\u4efb\u52a1\uff1b 4.DiscardPolicy\uff1a\u76f4\u63a5\u4e22\u5f03\u4efb\u52a1\uff1b \u53c2\u8003\u4ee3\u7801\uff1a public class TestThreadPoolExecutor { static class MyTask implements Runnable { private final String name; private final long duration; public MyTask(String name) { this(name, 0); } public MyTask(String name, long duration) { this.name = name; this.duration = duration; } @Override public void run() { try { LoggerUtils.get(\"myThread\").debug(\"running...\" + this); Thread.sleep(duration); } catch (InterruptedException e) { e.printStackTrace(); } } @Override public String toString() { return \"MyTask(\" + name + \")\"; } } public static void main(String[] args) throws InterruptedException { AtomicInteger c = new AtomicInteger(1); ArrayBlockingQueue<Runnable> queue = new ArrayBlockingQueue<>(2); ThreadPoolExecutor threadPool = new ThreadPoolExecutor( 2, 3, 0, TimeUnit.MILLISECONDS, queue, r -> new Thread(r, \"myThread\" + c.getAndIncrement()), new ThreadPoolExecutor.AbortPolicy()); showState(queue, threadPool); threadPool.submit(new MyTask(\"1\", 3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"2\", 3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"3\")); showState(queue, threadPool); threadPool.submit(new MyTask(\"4\")); showState(queue, threadPool); threadPool.submit(new MyTask(\"5\",3600000)); showState(queue, threadPool); threadPool.submit(new MyTask(\"6\")); showState(queue, threadPool); } private static void showState(ArrayBlockingQueue<Runnable> queue, ThreadPoolExecutor threadPool) { try { Thread.sleep(300); } catch (InterruptedException e) { e.printStackTrace(); } List<Object> tasks = new ArrayList<>(); for (Runnable runnable : queue) { try { Field callable = FutureTask.class.getDeclaredField(\"callable\"); callable.setAccessible(true); Object adapter = callable.get(runnable); Class<?> clazz = Class.forName(\"java.util.concurrent.Executors$RunnableAdapter\"); Field task = clazz.getDeclaredField(\"task\"); task.setAccessible(true); Object o = task.get(adapter); tasks.add(o); } catch (Exception e) { e.printStackTrace(); } } LoggerUtils.main.debug(\"pool size: {}, queue: {}\", threadPool.getPoolSize(), tasks); } }","title":"3.1 \u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u53c2\u6570\uff08\u7ebf\u7a0b\u6c60\u7684\u6267\u884c\u539f\u7406\u77e5\u9053\u561b\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#32","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 \u6bd4\u8f83\u5e38\u89c1\u7684\u67094\u4e2a\uff0c\u7528\u7684\u6700\u591a\u662fArrayBlockingQueue\u548cLinkedBlockingQueue 1.ArrayBlockingQueue\uff1a\u57fa\u4e8e\u6570\u7ec4\u7ed3\u6784\u7684\u6709\u754c\u963b\u585e\u961f\u5217\uff0cFIFO\u3002 2.LinkedBlockingQueue\uff1a\u57fa\u4e8e\u94fe\u8868\u7ed3\u6784\u7684\u6709\u754c\u963b\u585e\u961f\u5217\uff0cFIFO\u3002 3.DelayedWorkQueue \uff1a\u662f\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u51fa\u961f\u7684\u4efb\u52a1\u90fd\u662f\u5f53\u524d\u961f\u5217\u4e2d\u6267\u884c\u65f6\u95f4\u6700\u9760\u524d\u7684 4.SynchronousQueue\uff1a\u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u6bcf\u4e2a\u63d2\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2a\u79fb\u51fa\u64cd\u4f5c\u3002 ArrayBlockingQueue\u7684LinkedBlockingQueue\u533a\u522b LinkedBlockingQueue ArrayBlockingQueue \u9ed8\u8ba4\u65e0\u754c\uff0c\u652f\u6301\u6709\u754c \u5f3a\u5236\u6709\u754c \u5e95\u5c42\u662f\u94fe\u8868 \u5e95\u5c42\u662f\u6570\u7ec4 \u662f\u61d2\u60f0\u7684\uff0c\u521b\u5efa\u8282\u70b9\u7684\u65f6\u5019\u6dfb\u52a0\u6570\u636e \u63d0\u524d\u521d\u59cb\u5316 Node \u6570\u7ec4 \u5165\u961f\u4f1a\u751f\u6210\u65b0 Node Node\u9700\u8981\u662f\u63d0\u524d\u521b\u5efa\u597d\u7684 \u4e24\u628a\u9501\uff08\u5934\u5c3e\uff09 \u4e00\u628a\u9501 \u5de6\u8fb9\u662fLinkedBlockingQueue\u52a0\u9501\u7684\u65b9\u5f0f\uff0c\u53f3\u8fb9\u662fArrayBlockingQueue\u52a0\u9501\u7684\u65b9\u5f0f LinkedBlockingQueue\u8bfb\u548c\u5199\u5404\u6709\u4e00\u628a\u9501\uff0c\u6027\u80fd\u76f8\u5bf9\u8f83\u597d ArrayBlockingQueue\u53ea\u6709\u4e00\u628a\u9501\uff0c\u8bfb\u548c\u5199\u516c\u7528\uff0c\u6027\u80fd\u76f8\u5bf9\u4e8eLinkedBlockingQueue\u5dee\u4e00\u4e9b","title":"3.2 \u7ebf\u7a0b\u6c60\u4e2d\u6709\u54ea\u4e9b\u5e38\u89c1\u7684\u963b\u585e\u961f\u5217"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#33","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728\u8bbe\u7f6e\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e4b\u524d\uff0c\u9700\u8981\u5148\u719f\u6089\u4e00\u4e9b\u6267\u884c\u7ebf\u7a0b\u6c60\u6267\u884c\u4efb\u52a1\u7684\u7c7b\u578b IO\u5bc6\u96c6\u578b\u4efb\u52a1 \u4e00\u822c\u6765\u8bf4\uff1a\u6587\u4ef6\u8bfb\u5199\u3001DB\u8bfb\u5199\u3001\u7f51\u7edc\u8bf7\u6c42\u7b49 \u63a8\u8350\uff1a\u6838\u5fc3\u7ebf\u7a0b\u6570\u5927\u5c0f\u8bbe\u7f6e\u4e3a2N+1 \uff08N\u4e3a\u8ba1\u7b97\u673a\u7684CPU\u6838\u6570\uff09 CPU\u5bc6\u96c6\u578b\u4efb\u52a1 \u4e00\u822c\u6765\u8bf4\uff1a\u8ba1\u7b97\u578b\u4ee3\u7801\u3001Bitmap\u8f6c\u6362\u3001Gson\u8f6c\u6362\u7b49 \u63a8\u8350\uff1a\u6838\u5fc3\u7ebf\u7a0b\u6570\u5927\u5c0f\u8bbe\u7f6e\u4e3aN+1 \uff08N\u4e3a\u8ba1\u7b97\u673a\u7684CPU\u6838\u6570\uff09 java\u4ee3\u7801\u67e5\u770bCPU\u6838\u6570 \u53c2\u8003\u56de\u7b54\uff1a \u2460 \u9ad8\u5e76\u53d1\u3001\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u77ed -->\uff08 CPU\u6838\u6570+1 \uff09\uff0c\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7684\u5207\u6362 \u2461 \u5e76\u53d1\u4e0d\u9ad8\u3001\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u957f IO\u5bc6\u96c6\u578b\u7684\u4efb\u52a1 --> (CPU\u6838\u6570 * 2 + 1) \u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1 --> \uff08 CPU\u6838\u6570+1 \uff09 \u2462 \u5e76\u53d1\u9ad8\u3001\u4e1a\u52a1\u6267\u884c\u65f6\u95f4\u957f\uff0c\u89e3\u51b3\u8fd9\u79cd\u7c7b\u578b\u4efb\u52a1\u7684\u5173\u952e\u4e0d\u5728\u4e8e\u7ebf\u7a0b\u6c60\u800c\u5728\u4e8e\u6574\u4f53\u67b6\u6784\u7684\u8bbe\u8ba1\uff0c\u770b\u770b\u8fd9\u4e9b\u4e1a\u52a1\u91cc\u9762\u67d0\u4e9b\u6570\u636e\u662f\u5426\u80fd\u505a\u7f13\u5b58\u662f\u7b2c\u4e00\u6b65\uff0c\u589e\u52a0\u670d\u52a1\u5668\u662f\u7b2c\u4e8c\u6b65\uff0c\u81f3\u4e8e\u7ebf\u7a0b\u6c60\u7684\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u53c2\u8003\uff082\uff09","title":"3.3 \u5982\u4f55\u786e\u5b9a\u6838\u5fc3\u7ebf\u7a0b\u6570"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#34","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u5728java.util.concurrent.Executors\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u5927\u91cf\u521b\u5efa\u8fde\u63a5\u6c60\u7684\u9759\u6001\u65b9\u6cd5\uff0c\u5e38\u89c1\u5c31\u6709\u56db\u79cd \u521b\u5efa\u4f7f\u7528\u56fa\u5b9a\u7ebf\u7a0b\u6570\u7684\u7ebf\u7a0b\u6c60 \u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0e\u6700\u5927\u7ebf\u7a0b\u6570\u4e00\u6837\uff0c\u6ca1\u6709\u6551\u6025\u7ebf\u7a0b \u963b\u585e\u961f\u5217\u662fLinkedBlockingQueue\uff0c\u6700\u5927\u5bb9\u91cf\u4e3aInteger.MAX_VALUE \u9002\u7528\u573a\u666f\uff1a\u9002\u7528\u4e8e\u4efb\u52a1\u91cf\u5df2\u77e5\uff0c\u76f8\u5bf9\u8017\u65f6\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class FixedThreadPoolCase { static class FixedThreadDemo implements Runnable{ @Override public void run() { String name = Thread.currentThread().getName(); for (int i = 0; i < 2; i++) { System.out.println(name + \":\" + i); } } } public static void main(String[] args) throws InterruptedException { //\u521b\u5efa\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f3 ExecutorService executorService = Executors.newFixedThreadPool(3); for (int i = 0; i < 5; i++) { executorService.submit(new FixedThreadDemo()); Thread.sleep(10); } executorService.shutdown(); } } ``` \u5355\u7ebf\u7a0b\u5316\u7684\u7ebf\u7a0b\u6c60\uff0c\u5b83\u53ea\u4f1a\u7528\u552f\u4e00\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\uff0c\u4fdd\u8bc1\u6240\u6709\u4efb\u52a1\u6309\u7167\u6307\u5b9a\u987a\u5e8f(FIFO)\u6267\u884c \u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f1 \u963b\u585e\u961f\u5217\u662fLinkedBlockingQueue\uff0c\u6700\u5927\u5bb9\u91cf\u4e3aInteger.MAX_VALUE \u9002\u7528\u573a\u666f\uff1a\u9002\u7528\u4e8e\u6309\u7167\u987a\u5e8f\u6267\u884c\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class NewSingleThreadCase { static int count = 0; static class Demo implements Runnable { @Override public void run() { count++; System.out.println(Thread.currentThread().getName() + \":\" + count); } } public static void main(String[] args) throws InterruptedException { //\u5355\u4e2a\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u548c\u6700\u5927\u7ebf\u7a0b\u6570\u90fd\u662f1 ExecutorService exec = Executors.newSingleThreadExecutor(); for (int i = 0; i < 10; i++) { exec.execute(new Demo()); Thread.sleep(5); } exec.shutdown(); } } ``` \u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60 \u6838\u5fc3\u7ebf\u7a0b\u6570\u4e3a0 \u6700\u5927\u7ebf\u7a0b\u6570\u662fInteger.MAX_VALUE \u963b\u585e\u961f\u5217\u4e3aSynchronousQueue:\u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u6bcf\u4e2a\u63d2\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2a\u79fb\u51fa\u64cd\u4f5c\u3002 \u9002\u7528\u573a\u666f\uff1a\u9002\u5408\u4efb\u52a1\u6570\u6bd4\u8f83\u5bc6\u96c6\uff0c\u4f46\u6bcf\u4e2a\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u8f83\u77ed\u7684\u60c5\u51b5 \u6848\u4f8b\uff1a ```java public class CachedThreadPoolCase { static class Demo implements Runnable { @Override public void run() { String name = Thread.currentThread().getName(); try { //\u4fee\u6539\u7761\u7720\u65f6\u95f4\uff0c\u6a21\u62df\u7ebf\u7a0b\u6267\u884c\u9700\u8981\u82b1\u8d39\u7684\u65f6\u95f4 Thread.sleep(100); System.out.println(name + \"\u6267\u884c\u5b8c\u4e86\"); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { //\u521b\u5efa\u4e00\u4e2a\u7f13\u5b58\u7684\u7ebf\u7a0b\uff0c\u6ca1\u6709\u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u6700\u5927\u7ebf\u7a0b\u6570\u4e3aInteger.MAX_VALUE ExecutorService exec = Executors.newCachedThreadPool(); for (int i = 0; i < 10; i++) { exec.execute(new Demo()); Thread.sleep(1); } exec.shutdown(); } } ``` \u63d0\u4f9b\u4e86\u201c\u5ef6\u8fdf\u201d\u548c\u201c\u5468\u671f\u6267\u884c\u201d\u529f\u80fd\u7684ThreadPoolExecutor\u3002 \u9002\u7528\u573a\u666f\uff1a\u6709\u5b9a\u65f6\u548c\u5ef6\u8fdf\u6267\u884c\u7684\u4efb\u52a1 \u6848\u4f8b\uff1a ```java public class ScheduledThreadPoolCase { static class Task implements Runnable { @Override public void run() { try { String name = Thread.currentThread().getName(); System.out.println(name + \", \u5f00\u59cb\uff1a\" + new Date()); Thread.sleep(1000); System.out.println(name + \", \u7ed3\u675f\uff1a\" + new Date()); } catch (InterruptedException e) { e.printStackTrace(); } } } public static void main(String[] args) throws InterruptedException { //\u6309\u7167\u5468\u671f\u6267\u884c\u7684\u7ebf\u7a0b\u6c60\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e3a2\uff0c\u6700\u5927\u7ebf\u7a0b\u6570\u4e3aInteger.MAX_VALUE ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(2); System.out.println(\"\u7a0b\u5e8f\u5f00\u59cb\uff1a\" + new Date()); /** * schedule \u63d0\u4ea4\u4efb\u52a1\u5230\u7ebf\u7a0b\u6c60\u4e2d * \u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u63d0\u4ea4\u7684\u4efb\u52a1 * \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u4efb\u52a1\u6267\u884c\u7684\u5ef6\u8fdf\u65f6\u95f4 * \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1a\u65f6\u95f4\u5355\u4f4d */ scheduledThreadPool.schedule(new Task(), 0, TimeUnit.SECONDS); scheduledThreadPool.schedule(new Task(), 1, TimeUnit.SECONDS); scheduledThreadPool.schedule(new Task(), 5, TimeUnit.SECONDS); Thread.sleep(5000); // \u5173\u95ed\u7ebf\u7a0b\u6c60 scheduledThreadPool.shutdown(); } } ```","title":"3.4 \u7ebf\u7a0b\u6c60\u7684\u79cd\u7c7b\u6709\u54ea\u4e9b"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#35-executors","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u53c2\u8003\u963f\u91cc\u5f00\u53d1\u624b\u518c\u300aJava\u5f00\u53d1\u624b\u518c-\u5d69\u5c71\u7248\u300b","title":"3.5 \u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4","text":"","title":"4.\u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u95ee\u9898"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#41-countdownlatchfuture","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606","title":"4.1 \u7ebf\u7a0b\u6c60\u4f7f\u7528\u573a\u666fCountDownLatch\u3001Future\uff08\u4f60\u4eec\u9879\u76ee\u54ea\u91cc\u7528\u5230\u4e86\u591a\u7ebf\u7a0b\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#411-countdownlatch","text":"CountDownLatch\uff08\u95ed\u9501/\u5012\u8ba1\u65f6\u9501\uff09\u7528\u6765\u8fdb\u884c\u7ebf\u7a0b\u540c\u6b65\u534f\u4f5c\uff0c\u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u5b8c\u6210\u5012\u8ba1\u65f6\uff08\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7ebf\u7a0b\uff0c\u7b49\u5f85\u5176\u4ed6\u591a\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u67d0\u4ef6\u4e8b\u60c5\u4e4b\u540e\u624d\u80fd\u6267\u884c\uff09 \u5176\u4e2d\u6784\u9020\u53c2\u6570\u7528\u6765\u521d\u59cb\u5316\u7b49\u5f85\u8ba1\u6570\u503c await() \u7528\u6765\u7b49\u5f85\u8ba1\u6570\u5f52\u96f6 countDown() \u7528\u6765\u8ba9\u8ba1\u6570\u51cf\u4e00 \u6848\u4f8b\u4ee3\u7801\uff1a public class CountDownLatchDemo { public static void main(String[] args) throws InterruptedException { //\u521d\u59cb\u5316\u4e86\u4e00\u4e2a\u5012\u8ba1\u65f6\u9501 \u53c2\u6570\u4e3a 3 CountDownLatch latch = new CountDownLatch(3); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(1000); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(2000); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); new Thread(() -> { System.out.println(Thread.currentThread().getName()+\"-begin...\"); try { Thread.sleep(1500); } catch (InterruptedException e) { throw new RuntimeException(e); } //count-- latch.countDown(); System.out.println(Thread.currentThread().getName()+\"-end...\" +latch.getCount()); }).start(); String name = Thread.currentThread().getName(); System.out.println(name + \"-waiting...\"); //\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u5b8c\u6210 latch.await(); System.out.println(name + \"-wait end...\"); } }","title":"4.1.1 CountDownLatch"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#412-es","text":"\u5728\u6211\u4eec\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u628a\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u4e00\u6b21\u6027\u7684\u540c\u6b65\u5230es\u7d22\u5f15\u5e93\u4e2d\uff0c\u4f46\u662f\u5f53\u65f6\u7684\u6570\u636e\u597d\u50cf\u662f1000\u4e07\u5de6\u53f3\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u6570\u636e\u80af\u5b9a\u4e0d\u884c\uff08oom\u5f02\u5e38\uff09\uff0c\u5f53\u65f6\u6211\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u5bfc\u5165\uff0c\u5229\u7528CountDownLatch\u6765\u63a7\u5236\uff0c\u5c31\u80fd\u907f\u514d\u4e00\u6b21\u6027\u52a0\u8f7d\u8fc7\u591a\uff0c\u9632\u6b62\u5185\u5b58\u6ea2\u51fa \u6574\u4f53\u6d41\u7a0b\u5c31\u662f\u901a\u8fc7CountDownLatch+\u7ebf\u7a0b\u6c60\u914d\u5408\u53bb\u6267\u884c \u8be6\u7ec6\u5b9e\u73b0\u6d41\u7a0b\uff1a \u8be6\u7ec6\u5b9e\u73b0\u4ee3\u7801\uff0c\u8bf7\u67e5\u770b\u5f53\u5929\u4ee3\u7801","title":"4.1.2 \u6848\u4f8b\u4e00\uff08es\u6570\u636e\u6279\u91cf\u5bfc\u5165\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#413","text":"\u5728\u4e00\u4e2a\u7535\u5546\u7f51\u7ad9\u4e2d\uff0c\u7528\u6237\u4e0b\u5355\u4e4b\u540e\uff0c\u9700\u8981\u67e5\u8be2\u6570\u636e\uff0c\u6570\u636e\u5305\u542b\u4e86\u4e09\u90e8\u5206\uff1a\u8ba2\u5355\u4fe1\u606f\u3001\u5305\u542b\u7684\u5546\u54c1\u3001\u7269\u6d41\u4fe1\u606f\uff1b\u8fd9\u4e09\u5757\u4fe1\u606f\u90fd\u5728\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u4e2d\u8fdb\u884c\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u5982\u4f55\u5b8c\u6210\u8fd9\u4e2a\u4e1a\u52a1\u5462\uff1f \u8be6\u7ec6\u5b9e\u73b0\u4ee3\u7801\uff0c\u8bf7\u67e5\u770b\u5f53\u5929\u4ee3\u7801 \u5728\u5b9e\u9645\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u96be\u514d\u9700\u8981\u8c03\u7528\u591a\u4e2a\u63a5\u53e3\u6765\u6c47\u603b\u6570\u636e\uff0c\u5982\u679c\u6240\u6709\u63a5\u53e3\uff08\u6216\u90e8\u5206\u63a5\u53e3\uff09\u7684\u6ca1\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60+future\u6765\u63d0\u5347\u6027\u80fd \u62a5\u8868\u6c47\u603b","title":"4.1.3 \u6848\u4f8b\u4e8c\uff08\u6570\u636e\u6c47\u603b\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#414","text":"\u5728\u8fdb\u884c\u641c\u7d22\u7684\u65f6\u5019\uff0c\u9700\u8981\u4fdd\u5b58\u7528\u6237\u7684\u641c\u7d22\u8bb0\u5f55\uff0c\u800c\u641c\u7d22\u8bb0\u5f55\u4e0d\u80fd\u5f71\u54cd\u7528\u6237\u7684\u6b63\u5e38\u641c\u7d22\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u5386\u53f2\u8bb0\u5f55\u7684\u4fdd\u5b58\uff0c\u5728\u65b0\u5f00\u542f\u7684\u7ebf\u7a0b\u5728\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u5229\u7528\u7ebf\u7a0b\u63d0\u4ea4\u4efb\u52a1","title":"4.1.4 \u6848\u4f8b\u4e8c\uff08\u5f02\u6b65\u8c03\u7528\uff09"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#41","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606 Semaphore [\u02c8s\u025bm\u0259\u02ccf\u0254r] \u4fe1\u53f7\u91cf\uff0c\u662fJUC\u5305\u4e0b\u7684\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5176\u9650\u5236\u6267\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u8fbe\u5230\u9650\u6d41\u7684\u6548\u679c \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u65f6\u5148\u901a\u8fc7\u5176\u65b9\u6cd5\u8fdb\u884c\u83b7\u53d6\u8bb8\u53ef\u64cd\u4f5c\uff0c\u83b7\u53d6\u5230\u8bb8\u53ef\u7684\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u4e1a\u52a1\u903b\u8f91\uff0c\u5f53\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u540e\u8fdb\u884c\u91ca\u653e\u8bb8\u53ef\u64cd\u4f5c\uff0c\u672a\u83b7\u53d6\u8fbe\u5230\u8bb8\u53ef\u7684\u7ebf\u7a0b\u8fdb\u884c\u7b49\u5f85\u6216\u8005\u76f4\u63a5\u7ed3\u675f\u3002 Semaphore\u4e24\u4e2a\u91cd\u8981\u7684\u65b9\u6cd5 lsemaphore.acquire()\uff1a \u8bf7\u6c42\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u8fd9\u65f6\u5019\u7684\u4fe1\u53f7\u91cf\u4e2a\u6570-1\uff08\u4e00\u65e6\u6ca1\u6709\u53ef\u4f7f\u7528\u7684\u4fe1\u53f7\u91cf\uff0c\u4e5f\u5373\u4fe1\u53f7\u91cf\u4e2a\u6570\u53d8\u4e3a\u8d1f\u6570\u65f6\uff0c\u518d\u6b21\u8bf7\u6c42\u7684\u65f6\u5019\u5c31\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u5176\u4ed6\u7ebf\u7a0b\u91ca\u653e\u4e86\u4fe1\u53f7\u91cf\uff09 lsemaphore.release()\uff1a\u91ca\u653e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u6b64\u65f6\u4fe1\u53f7\u91cf\u4e2a\u6570+1 \u7ebf\u7a0b\u4efb\u52a1\u7c7b\uff1a public class SemaphoreCase { public static void main(String[] args) { // 1. \u521b\u5efa semaphore \u5bf9\u8c61 Semaphore semaphore = new Semaphore(3); // 2. 10\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8fd0\u884c for (int i = 0; i < 10; i++) { new Thread(() -> { try { // 3. \u83b7\u53d6\u8bb8\u53ef semaphore.acquire(); } catch (InterruptedException e) { e.printStackTrace(); } try { System.out.println(\"running...\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"end...\"); } finally { // 4. \u91ca\u653e\u8bb8\u53ef semaphore.release(); } }).start(); } } }","title":"4.1 \u5982\u4f55\u63a7\u5236\u67d0\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5e76\u53d1\u8bbf\u95ee\u7ebf\u7a0b\u7684\u6570\u91cf\uff1f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#5","text":"","title":"5.\u5176\u4ed6"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#51-threadlocal","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606","title":"5.1 \u8c08\u8c08\u4f60\u5bf9ThreadLocal\u7684\u7406\u89e3"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#511","text":"ThreadLocal\u662f\u591a\u7ebf\u7a0b\u4e2d\u5bf9\u4e8e\u89e3\u51b3\u7ebf\u7a0b\u5b89\u5168\u7684\u4e00\u4e2a\u64cd\u4f5c\u7c7b\uff0c\u5b83\u4f1a\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5206\u914d\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u526f\u672c\u4ece\u800c\u89e3\u51b3\u4e86\u53d8\u91cf\u5e76\u53d1\u8bbf\u95ee\u51b2\u7a81\u7684\u95ee\u9898\u3002ThreadLocal \u540c\u65f6\u5b9e\u73b0\u4e86\u7ebf\u7a0b\u5185\u7684\u8d44\u6e90\u5171\u4eab \u6848\u4f8b\uff1a\u4f7f\u7528JDBC\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\uff0c\u4f1a\u5c06\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u7684Connection\u653e\u5165\u5404\u81ea\u7684ThreadLocal\u4e2d\uff0c\u4ece\u800c\u4fdd\u8bc1\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5728\u5404\u81ea\u7684 Connection \u4e0a\u8fdb\u884c\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c\u907f\u514dA\u7ebf\u7a0b\u5173\u95ed\u4e86B\u7ebf\u7a0b\u7684\u8fde\u63a5\u3002","title":"5.1.1 \u6982\u8ff0"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#512-threadlocal","text":"\u4e09\u4e2a\u4e3b\u8981\u65b9\u6cd5\uff1a set(value) \u8bbe\u7f6e\u503c get() \u83b7\u53d6\u503c remove() \u6e05\u9664\u503c public class ThreadLocalTest { static ThreadLocal<String> threadLocal = new ThreadLocal<>(); public static void main(String[] args) { new Thread(() -> { String name = Thread.currentThread().getName(); threadLocal.set(\"itcast\"); print(name); System.out.println(name + \"-after remove : \" + threadLocal.get()); }, \"t1\").start(); new Thread(() -> { String name = Thread.currentThread().getName(); threadLocal.set(\"itheima\"); print(name); System.out.println(name + \"-after remove : \" + threadLocal.get()); }, \"t2\").start(); } static void print(String str) { //\u6253\u5370\u5f53\u524d\u7ebf\u7a0b\u4e2d\u672c\u5730\u5185\u5b58\u4e2d\u672c\u5730\u53d8\u91cf\u7684\u503c System.out.println(str + \" :\" + threadLocal.get()); //\u6e05\u9664\u672c\u5730\u5185\u5b58\u4e2d\u7684\u672c\u5730\u53d8\u91cf threadLocal.remove(); } }","title":"5.1.2 ThreadLocal\u57fa\u672c\u4f7f\u7528"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#513-threadlocal","text":"ThreadLocal\u672c\u8d28\u6765\u8bf4\u5c31\u662f\u4e00\u4e2a\u7ebf\u7a0b\u5185\u90e8\u5b58\u50a8\u7c7b\uff0c\u4ece\u800c\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u53ea\u64cd\u4f5c\u81ea\u5df1\u5185\u90e8\u7684\u503c\uff0c\u4ece\u800c\u5b9e\u73b0\u7ebf\u7a0b\u6570\u636e\u9694\u79bb \u5728ThreadLocal\u4e2d\u6709\u4e00\u4e2a\u5185\u90e8\u7c7b\u53eb\u505aThreadLocalMap\uff0c\u7c7b\u4f3c\u4e8eHashMap ThreadLocalMap\u4e2d\u6709\u4e00\u4e2a\u5c5e\u6027table\u6570\u7ec4\uff0c\u8fd9\u4e2a\u662f\u771f\u6b63\u5b58\u50a8\u6570\u636e\u7684\u4f4d\u7f6e set\u65b9\u6cd5 get\u65b9\u6cd5/remove\u65b9\u6cd5","title":"5.1.3 ThreadLocal\u7684\u5b9e\u73b0\u539f\u7406&amp;\u6e90\u7801\u89e3\u6790"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#514-threadlocal-","text":"Java\u5bf9\u8c61\u4e2d\u7684\u56db\u79cd\u5f15\u7528\u7c7b\u578b\uff1a\u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528 \u5f3a\u5f15\u7528\uff1a\u6700\u4e3a\u666e\u901a\u7684\u5f15\u7528\u65b9\u5f0f\uff0c\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u6709\u7528\u4e14\u5fc5\u987b\u7684\u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5177\u6709\u5f3a\u5f15\u7528\uff0c\u5219GC\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\u3002\u5373\u4fbf\u5806\u4e2d\u5185\u5b58\u4e0d\u8db3\u4e86\uff0c\u5b81\u53ef\u51fa\u73b0OOM\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u56de\u6536 \u5f31\u5f15\u7528\uff1a\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u53ef\u80fd\u6709\u7528\u4e14\u975e\u5fc5\u987b\u7684\u72b6\u6001\u3002\u5728GC\u7ebf\u7a0b\u626b\u63cf\u5185\u5b58\u533a\u57df\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u5f31\u5f15\u7528\uff0c\u5c31\u4f1a\u56de\u6536\u5230\u5f31\u5f15\u7528\u76f8\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u5f31\u5f15\u7528\u7684\u56de\u6536\uff0c\u65e0\u5173\u5185\u5b58\u533a\u57df\u662f\u5426\u8db3\u591f\uff0c\u4e00\u65e6\u53d1\u73b0\u5219\u4f1a\u88ab\u56de\u6536 \u6bcf\u4e00\u4e2aThread\u7ef4\u62a4\u4e00\u4e2aThreadLocalMap\uff0c\u5728ThreadLocalMap\u4e2d\u7684Entry\u5bf9\u8c61\u7ee7\u627f\u4e86WeakReference\u3002\u5176\u4e2dkey\u4e3a\u4f7f\u7528\u5f31\u5f15\u7528\u7684ThreadLocal\u5b9e\u4f8b\uff0cvalue\u4e3a\u7ebf\u7a0b\u53d8\u91cf\u7684\u526f\u672c \u5728\u4f7f\u7528ThreadLocal\u7684\u65f6\u5019\uff0c\u5f3a\u70c8\u5efa\u8bae\uff1a \u52a1\u5fc5\u624b\u52a8remove","title":"5.1.4 ThreadLocal-\u5185\u5b58\u6cc4\u9732\u95ee\u9898"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#6","text":"","title":"6 \u771f\u5b9e\u9762\u8bd5\u8fd8\u539f"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#61","text":"\u9762\u8bd5\u5b98 \uff1a\u804a\u4e00\u4e0b\u5e76\u884c\u548c\u5e76\u53d1\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837\u7684~~ \u73b0\u5728\u90fd\u662f\u591a\u6838CPU\uff0c\u5728\u591a\u6838CPU\u4e0b \u5e76\u53d1\u662f\u540c\u4e00\u65f6\u95f4\u5e94\u5bf9\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u8f6e\u6d41\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aCPU \u5e76\u884c\u662f\u540c\u4e00\u65f6\u95f4\u52a8\u624b\u505a\u591a\u4ef6\u4e8b\u60c5\u7684\u80fd\u529b\uff0c4\u6838CPU\u540c\u65f6\u6267\u884c4\u4e2a\u7ebf\u7a0b \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a \u55ef\uff0c\u597d~ \u8fdb\u7a0b\u662f\u6b63\u5728\u8fd0\u884c\u7a0b\u5e8f\u7684\u5b9e\u4f8b\uff0c\u8fdb\u7a0b\u4e2d\u5305\u542b\u4e86\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e0d\u540c\u7684\u4efb\u52a1 \u4e0d\u540c\u7684\u8fdb\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u5f53\u524d\u8fdb\u7a0b\u4e0b\u7684\u6240\u6709\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u5185\u5b58\u7a7a\u95f4 \u7ebf\u7a0b\u66f4\u8f7b\u91cf\uff0c\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u6210\u672c\u4e00\u822c\u4e0a\u8981\u6bd4\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u4f4e(\u4e0a\u4e0b\u6587\u5207\u6362\u6307\u7684\u662f\u4ece\u4e00\u4e2a\u7ebf\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b) \u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u5728java\u4e2d\u521b\u5efa\u7ebf\u7a0b\u6709\u54ea\u4e9b\u65b9\u5f0f\uff1f \u5019\u9009\u4eba\uff1a \u5728java\u4e2d\u4e00\u5171\u6709\u56db\u79cd\u5e38\u89c1\u7684\u521b\u5efa\u65b9\u5f0f\uff0c\u5206\u522b\u662f\uff1a\u7ee7\u627fThread\u7c7b\u3001\u5b9e\u73b0runnable\u63a5\u53e3\u3001\u5b9e\u73b0Callable\u63a5\u53e3\u3001\u7ebf\u7a0b\u6c60\u521b\u5efa\u7ebf\u7a0b\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9879\u76ee\u4e2d\u90fd\u4f1a\u91c7\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u521b\u5efa\u7ebf\u7a0b\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684runnable \u548c callable \u4e24\u4e2a\u63a5\u53e3\u521b\u5efa\u7ebf\u7a0b\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5019\u9009\u4eba\uff1a \u662f\u8fd9\u6837\u7684~ \u6700\u4e3b\u8981\u7684\u4e24\u4e2a\u7ebf\u7a0b\u4e00\u4e2a\u662f\u6709\u8fd4\u56de\u503c\uff0c\u4e00\u4e2a\u662f\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u3002 Runnable \u63a5\u53e3run\u65b9\u6cd5\u65e0\u8fd4\u56de\u503c\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\uff0c\u662f\u4e2a\u6cdb\u578b\uff0c\u548cFuture\u3001FutureTask\u914d\u5408\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5f02\u6b65\u6267\u884c\u7684\u7ed3\u679c \u8fd8\u6709\u4e00\u4e2a\u5c31\u662f\uff0c\u4ed6\u4eec\u5f02\u5e38\u5904\u7406\u4e5f\u4e0d\u4e00\u6837\u3002Runnable\u63a5\u53e3run\u65b9\u6cd5\u53ea\u80fd\u629b\u51fa\u8fd0\u884c\u65f6\u5f02\u5e38\uff0c\u4e5f\u65e0\u6cd5\u6355\u83b7\u5904\u7406\uff1bCallable\u63a5\u53e3call\u65b9\u6cd5\u5141\u8bb8\u629b\u51fa\u5f02\u5e38\uff0c\u53ef\u4ee5\u83b7\u53d6\u5f02\u5e38\u4fe1\u606f \u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5982\u679c\u9700\u8981\u62ff\u5230\u6267\u884c\u7684\u7ed3\u679c\uff0c\u9700\u8981\u4f7f\u7528Callalbe\u63a5\u53e3\u521b\u5efa\u7ebf\u7a0b\uff0c\u8c03\u7528FutureTask.get()\u5f97\u5230\u53ef\u4ee5\u5f97\u5230\u8fd4\u56de\u503c\uff0c\u6b64\u65b9\u6cd5\u4f1a\u963b\u585e\u4e3b\u8fdb\u7a0b\u7684\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u679c\u4e0d\u8c03\u7528\u4e0d\u4f1a\u963b\u585e\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u5305\u62ec\u54ea\u4e9b\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u662f\u5982\u4f55\u53d8\u5316\u7684\uff1f \u5019\u9009\u4eba\uff1a \u5728JDK\u4e2d\u7684Thread\u7c7b\u4e2d\u7684\u679a\u4e3eState\u91cc\u9762\u5b9a\u4e49\u4e866\u4e2d\u7ebf\u7a0b\u7684\u72b6\u6001\u5206\u522b\u662f\uff1a\u65b0\u5efa\u3001\u53ef\u8fd0\u884c\u3001\u7ec8\u7ed3\u3001\u963b\u585e\u3001\u7b49\u5f85\u548c\u6709\u65f6\u9650\u7b49\u5f85\u516d\u79cd\u3002 \u5173\u4e8e\u7ebf\u7a0b\u7684\u72b6\u6001\u5207\u6362\u60c5\u51b5\u6bd4\u8f83\u591a\u3002\u6211\u5206\u522b\u4ecb\u7ecd\u4e00\u4e0b \u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\u88ab\u521b\u5efa\uff0c\u4f46\u8fd8\u672a\u8c03\u7528 start \u65b9\u6cd5\u65f6\u5904\u4e8e \u65b0\u5efa \u72b6\u6001\uff0c\u8c03\u7528\u4e86 start \u65b9\u6cd5\uff0c\u5c31\u4f1a\u7531 \u65b0\u5efa \u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001\u3002\u5982\u679c\u7ebf\u7a0b\u5185\u4ee3\u7801\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 \u7ec8\u7ed3 \u72b6\u6001\u3002\u5f53\u7136\u8fd9\u4e9b\u662f\u4e00\u4e2a\u7ebf\u7a0b\u6b63\u5e38\u6267\u884c\u60c5\u51b5\u3002 \u5982\u679c\u7ebf\u7a0b\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u7531 \u53ef\u8fd0\u884c \u8fdb\u5165 Monitor \u7684\u963b\u585e\u961f\u5217 \u963b\u585e \uff0c\u53ea\u6709\u5f53\u6301\u9501\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4f1a\u6309\u7167\u4e00\u5b9a\u89c4\u5219\u5524\u9192\u963b\u585e\u961f\u5217\u4e2d\u7684 \u963b\u585e \u7ebf\u7a0b\uff0c\u5524\u9192\u540e\u7684\u7ebf\u7a0b\u8fdb\u5165 \u53ef\u8fd0\u884c \u72b6\u6001 \u5982\u679c\u7ebf\u7a0b\u83b7\u53d6\u9501\u6210\u529f\u540e\uff0c\u4f46\u7531\u4e8e\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u8c03\u7528\u4e86 wait() \u65b9\u6cd5\uff0c\u6b64\u65f6\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u91ca\u653e\u9501 \u7b49\u5f85 \u72b6\u6001\uff0c\u5f53\u5176\u5b83\u6301\u9501\u7ebf\u7a0b\u8c03\u7528 notify() \u6216 notifyAll() \u65b9\u6cd5\uff0c\u4f1a\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f\u8c03\u7528 sleep(long) \u65b9\u6cd5\u4e5f\u4f1a\u4ece \u53ef\u8fd0\u884c \u72b6\u6001\u8fdb\u5165 \u6709\u65f6\u9650\u7b49\u5f85 \u72b6\u6001\uff0c\u4e0d\u9700\u8981\u4e3b\u52a8\u5524\u9192\uff0c\u8d85\u65f6\u65f6\u95f4\u5230\u81ea\u7136\u6062\u590d\u4e3a \u53ef\u8fd0\u884c \u72b6\u6001 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u7684\u7ebf\u7a0b\u4e2d\u7684 wait \u548c sleep\u65b9\u6cd5\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5019\u9009\u4eba\uff1a \u5b83\u4eec\u4e24\u4e2a\u7684\u76f8\u540c\u70b9\u662f\u90fd\u53ef\u4ee5\u8ba9\u5f53\u524d\u7ebf\u7a0b\u6682\u65f6\u653e\u5f03 CPU \u7684\u4f7f\u7528\u6743\uff0c\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002 \u4e0d\u540c\u70b9\u4e3b\u8981\u6709\u4e09\u4e2a\u65b9\u9762\uff1a \u7b2c\u4e00\uff1a\u65b9\u6cd5\u5f52\u5c5e\u4e0d\u540c sleep(long) \u662f Thread \u7684\u9759\u6001\u65b9\u6cd5\u3002\u800c wait()\uff0c\u662f Object \u7684\u6210\u5458\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709 \u7b2c\u4e8c\uff1a\u7ebf\u7a0b\u9192\u6765\u65f6\u673a\u4e0d\u540c \u7ebf\u7a0b\u6267\u884c sleep(long) \u4f1a\u5728\u7b49\u5f85\u76f8\u5e94\u6beb\u79d2\u540e\u9192\u6765\uff0c\u800c wait() \u9700\u8981\u88ab notify \u5524\u9192\uff0cwait() \u5982\u679c\u4e0d\u5524\u9192\u5c31\u4e00\u76f4\u7b49\u4e0b\u53bb \u7b2c\u4e09\uff1a\u9501\u7279\u6027\u4e0d\u540c wait \u65b9\u6cd5\u7684\u8c03\u7528\u5fc5\u987b\u5148\u83b7\u53d6 wait \u5bf9\u8c61\u7684\u9501\uff0c\u800c sleep \u5219\u65e0\u6b64\u9650\u5236 wait \u65b9\u6cd5\u6267\u884c\u540e\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff0c\u5141\u8bb8\u5176\u5b83\u7ebf\u7a0b\u83b7\u5f97\u8be5\u5bf9\u8c61\u9501\uff08\u76f8\u5f53\u4e8e\u6211\u653e\u5f03 cpu\uff0c\u4f46\u4f60\u4eec\u8fd8\u53ef\u4ee5\u7528\uff09 \u800c sleep \u5982\u679c\u5728 synchronized \u4ee3\u7801\u5757\u4e2d\u6267\u884c\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u5bf9\u8c61\u9501\uff08\u76f8\u5f53\u4e8e\u6211\u653e\u5f03 cpu\uff0c\u4f60\u4eec\u4e5f\u7528\u4e0d\u4e86\uff09 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u6211\u73b0\u5728\u4e3e\u4e00\u4e2a\u573a\u666f\uff0c\u4f60\u6765\u5206\u6790\u4e00\u4e0b\u600e\u4e48\u505a\uff0c\u65b0\u5efa T1\u3001T2\u3001T3 \u4e09\u4e2a\u7ebf\u7a0b\uff0c\u5982\u4f55\u4fdd\u8bc1\u5b83\u4eec\u6309\u987a\u5e8f\u6267\u884c\uff1f \u5019\u9009\u4eba\uff1a \u55ef~~\uff0c\u6211\u601d\u8003\u4e00\u4e0b \uff08\u9002\u5f53\u7684\u601d\u8003\u6216\u60f3\u4e00\u4e0b\u5c5e\u4e8e\u6b63\u5e38\u60c5\u51b5\uff0c\u8131\u53e3\u800c\u51fa\u53cd\u800c\u592a\u5047[\u80cc\u8bf5\u75d5\u8ff9]\uff09 \u53ef\u4ee5\u8fd9\u4e48\u505a\uff0c\u5728\u591a\u7ebf\u7a0b\u4e2d\u6709\u591a\u79cd\u65b9\u6cd5\u8ba9\u7ebf\u7a0b\u6309\u7279\u5b9a\u987a\u5e8f\u6267\u884c\uff0c\u53ef\u4ee5\u7528\u7ebf\u7a0b\u7c7b\u7684 join ()\u65b9\u6cd5\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u542f\u52a8\u53e6\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u8be5\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\u3002 \u6bd4\u5982\u8bf4\uff1a \u4f7f\u7528join\u65b9\u6cd5\uff0cT3\u8c03\u7528T2\uff0cT2\u8c03\u7528T1\uff0c\u8fd9\u6837\u5c31\u80fd\u786e\u4fddT1\u5c31\u4f1a\u5148\u5b8c\u6210\u800cT3\u6700\u540e\u5b8c\u6210 \u9762\u8bd5\u5b98 \uff1a\u5728\u6211\u4eec\u4f7f\u7528\u7ebf\u7a0b\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4e24\u4e2a\u65b9\u6cd5\u3002\u7ebf\u7a0b\u7684 run()\u548c start()\u6709\u4ec0\u4e48\u533a\u522b\uff1f \u5019\u9009\u4eba\uff1a start\u65b9\u6cd5\u7528\u6765\u542f\u52a8\u7ebf\u7a0b\uff0c\u901a\u8fc7\u8be5\u7ebf\u7a0b\u8c03\u7528run\u65b9\u6cd5\u6267\u884crun\u65b9\u6cd5\u4e2d\u6240\u5b9a\u4e49\u7684\u903b\u8f91\u4ee3\u7801\u3002start\u65b9\u6cd5\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\u3002run\u65b9\u6cd5\u5c01\u88c5\u4e86\u8981\u88ab\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u88ab\u8c03\u7528\u591a\u6b21\u3002 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5982\u4f55\u505c\u6b62\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u5462\uff1f \u5019\u9009\u4eba \uff1a \u6709\u4e09\u79cd\u65b9\u5f0f\u53ef\u4ee5\u505c\u6b62\u7ebf\u7a0b \u7b2c\u4e00\uff1a\u53ef\u4ee5\u4f7f\u7528\u9000\u51fa\u6807\u5fd7\uff0c\u4f7f\u7ebf\u7a0b\u6b63\u5e38\u9000\u51fa\uff0c\u4e5f\u5c31\u662f\u5f53run\u65b9\u6cd5\u5b8c\u6210\u540e\u7ebf\u7a0b\u7ec8\u6b62\uff0c\u4e00\u822c\u6211\u4eec\u52a0\u4e00\u4e2a\u6807\u8bb0 \u7b2c\u4e8c\uff1a\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u7684stop\u65b9\u6cd5\u5f3a\u884c\u7ec8\u6b62\uff0c\u4e0d\u8fc7\u4e00\u822c\u4e0d\u63a8\u8350\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5df2\u4f5c\u5e9f \u7b2c\u4e09\uff1a\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\u4e2d\u65ad\u7ebf\u7a0b\uff0c\u5185\u90e8\u5176\u5b9e\u4e5f\u662f\u4f7f\u7528\u4e2d\u65ad\u6807\u5fd7\u6765\u4e2d\u65ad\u7ebf\u7a0b \u6211\u4eec\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u8bdd\uff0c\u5efa\u8bae\u4f7f\u7528\u7b2c\u4e00\u79cd\u6216\u7b2c\u4e09\u79cd\u65b9\u5f0f\u4e2d\u65ad\u7ebf\u7a0b","title":"6.1 \u7ebf\u7a0b\u7684\u57fa\u7840\u77e5\u8bc6"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#62","text":"\u9762\u8bd5\u5b98 \uff1a\u8bb2\u4e00\u4e0bsynchronized\u5173\u952e\u5b57\u7684\u5e95\u5c42\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\u597d\u7684\uff0c synchronized \u5e95\u5c42\u4f7f\u7528\u7684JVM\u7ea7\u522b\u4e2d\u7684Monitor \u6765\u51b3\u5b9a\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u83b7\u5f97\u4e86\u9501\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u5f97\u4e86\u9501\uff0c\u5728\u6ca1\u6709\u91ca\u653e\u9501\u4e4b\u524d\uff0c\u5176\u4ed6\u7ebf\u7a0b\u662f\u4e0d\u80fd\u6216\u5f97\u5230\u9501\u7684\u3002synchronized \u5c5e\u4e8e\u60b2\u89c2\u9501\u3002 synchronized \u56e0\u4e3a\u9700\u8981\u4f9d\u8d56\u4e8eJVM\u7ea7\u522b\u7684Monitor \uff0c\u76f8\u5bf9\u6027\u80fd\u4e5f\u6bd4\u8f83\u4f4e\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u5177\u4f53\u8bf4\u4e0bMonitor \u5417\uff1f \u5019\u9009\u4eba \uff1a monitor\u5bf9\u8c61\u5b58\u5728\u4e8e\u6bcf\u4e2aJava\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u4e2d\uff0csynchronized \u9501\u4fbf\u662f\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u83b7\u53d6\u9501\u7684\uff0c\u4e5f\u662f\u4e3a\u4ec0\u4e48Java\u4e2d\u4efb\u610f\u5bf9\u8c61\u53ef\u4ee5\u4f5c\u4e3a\u9501\u7684\u539f\u56e0 monitor\u5185\u90e8\u7ef4\u62a4\u4e86\u4e09\u4e2a\u53d8\u91cf WaitSet\uff1a\u4fdd\u5b58\u5904\u4e8eWaiting\u72b6\u6001\u7684\u7ebf\u7a0b EntryList\uff1a\u4fdd\u5b58\u5904\u4e8eBlocked\u72b6\u6001\u7684\u7ebf\u7a0b Owner\uff1a\u6301\u6709\u9501\u7684\u7ebf\u7a0b \u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5230\u7684\u6807\u5fd7\u5c31\u662f\u5728monitor\u4e2d\u8bbe\u7f6e\u6210\u529f\u4e86Owner\uff0c\u4e00\u4e2amonitor\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2aOwner \u5728\u4e0a\u9501\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u6709\u5176\u4ed6\u7ebf\u7a0b\u4e5f\u6765\u62a2\u9501\uff0c\u5219\u8fdb\u5165EntryList \u8fdb\u884c\u963b\u585e\uff0c\u5f53\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\u6267\u884c\u5b8c\u4e86\uff0c\u91ca\u653e\u4e86\u9501\uff0c\u5c31\u4f1a\u5524\u9192EntryList \u4e2d\u7b49\u5f85\u7684\u7ebf\u7a0b\u7ade\u4e89\u9501\uff0c\u7ade\u4e89\u7684\u65f6\u5019\u662f\u975e\u516c\u5e73\u7684\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u5173\u4e8esynchronized \u7684\u9501\u5347\u7ea7\u7684\u60c5\u51b5\u4e86\u89e3\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u4e00\u4e9b\uff08\u8981\u8c26\u865a\uff09 Java\u4e2d\u7684synchronized\u6709\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\u3001\u91cd\u91cf\u7ea7\u9501\u4e09\u79cd\u5f62\u5f0f\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u9501\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u3001\u4e0d\u540c\u7ebf\u7a0b\u4ea4\u66ff\u6301\u6709\u9501\u3001\u591a\u7ebf\u7a0b\u7ade\u4e89\u9501\u4e09\u79cd\u60c5\u51b5\u3002 \u91cd\u91cf\u7ea7\u9501\uff1a\u5e95\u5c42\u4f7f\u7528\u7684Monitor\u5b9e\u73b0\uff0c\u91cc\u9762\u6d89\u53ca\u5230\u4e86\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u7684\u5207\u6362\u3001\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u6210\u672c\u8f83\u9ad8\uff0c\u6027\u80fd\u6bd4\u8f83\u4f4e\u3002 \u8f7b\u91cf\u7ea7\u9501\uff1a\u7ebf\u7a0b\u52a0\u9501\u7684\u65f6\u95f4\u662f\u9519\u5f00\u7684\uff08\u4e5f\u5c31\u662f\u6ca1\u6709\u7ade\u4e89\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u8f7b\u91cf\u7ea7\u9501\u6765\u4f18\u5316\u3002\u8f7b\u91cf\u7ea7\u4fee\u6539\u4e86\u5bf9\u8c61\u5934\u7684\u9501\u6807\u5fd7\uff0c\u76f8\u5bf9\u91cd\u91cf\u7ea7\u9501\u6027\u80fd\u63d0\u5347\u5f88\u591a\u3002\u6bcf\u6b21\u4fee\u6539\u90fd\u662fCAS\u64cd\u4f5c\uff0c\u4fdd\u8bc1\u539f\u5b50\u6027 \u504f\u5411\u9501\uff1a\u4e00\u6bb5\u5f88\u957f\u7684\u65f6\u95f4\u5185\u90fd\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u504f\u5411\u9501\uff0c\u5728\u7b2c\u4e00\u6b21\u83b7\u5f97\u9501\u65f6\uff0c\u4f1a\u6709\u4e00\u4e2aCAS\u64cd\u4f5c\uff0c\u4e4b\u540e\u8be5\u7ebf\u7a0b\u518d\u83b7\u53d6\u9501\uff0c\u53ea\u9700\u8981\u5224\u65admark word\u4e2d\u662f\u5426\u662f\u81ea\u5df1\u7684\u7ebf\u7a0bid\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u5f00\u9500\u76f8\u5bf9\u8f83\u5927\u7684CAS\u547d\u4ee4 \u4e00\u65e6\u9501\u53d1\u751f\u4e86\u7ade\u4e89\uff0c\u90fd\u4f1a\u5347\u7ea7\u4e3a\u91cd\u91cf\u7ea7\u9501 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86synchronized\u5b83\u5728\u9ad8\u5e76\u53d1\u91cf\u7684\u60c5\u51b5\u4e0b\uff0c\u6027\u80fd\u4e0d\u9ad8\uff0c\u5728\u9879\u76ee\u8be5\u5982\u4f55\u63a7\u5236\u4f7f\u7528\u9501\u5462\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u5176\u5b9e\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528ReentrantLock\u6765\u52a0\u9501\u3002 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u90a3\u4f60\u8bf4\u4e0bReentrantLock\u7684\u4f7f\u7528\u65b9\u5f0f\u548c\u5e95\u5c42\u539f\u7406\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\uff0c ReentrantLock\u662f\u4e00\u4e2a\u53ef\u91cd\u5165\u9501:\uff0c\u8c03\u7528 lock \u65b9 \u6cd5\u83b7\u53d6\u4e86\u9501\u4e4b\u540e\uff0c\u518d\u6b21\u8c03\u7528 lock\uff0c\u662f\u4e0d\u4f1a\u518d\u963b\u585e\uff0c\u5185\u90e8\u76f4\u63a5\u589e\u52a0\u91cd\u5165\u6b21\u6570 \u5c31\u884c\u4e86\uff0c\u6807\u8bc6\u8fd9\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u91cd\u590d\u83b7\u53d6\u4e00\u628a\u9501\u800c\u4e0d\u9700\u8981\u7b49\u5f85\u9501\u7684\u91ca\u653e\u3002 ReentrantLock\u662f\u5c5e\u4e8ejuc\u62a5\u4e0b\u7684\u7c7b\uff0c\u5c5e\u4e8eapi\u5c42\u9762\u7684\u9501\uff0c\u8ddfsynchronized\u4e00\u6837\uff0c\u90fd\u662f\u60b2\u89c2\u9501\u3002\u901a\u8fc7lock()\u7528\u6765\u83b7\u53d6\u9501\uff0cunlock()\u91ca\u653e\u9501\u3002 \u5b83\u7684\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u4e3b\u8981\u5229\u7528 CAS+AQS\u961f\u5217 \u6765\u5b9e\u73b0\u3002\u5b83\u652f\u6301\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501\uff0c\u4e24\u8005\u7684\u5b9e\u73b0\u7c7b\u4f3c \u6784\u9020\u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u7684\u516c\u5e73\u53c2\u6570\uff08 \u9ed8\u8ba4\u975e\u516c\u5e73\u9501 \uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\uff0c\u8868\u793a\u516c\u5e73\u9501\uff0c\u5426\u5219\u4e3a\u975e\u516c\u5e73\u9501\u3002\u516c\u5e73\u9501\u7684\u6548\u7387\u5f80\u5f80\u6ca1\u6709\u975e\u516c\u5e73\u9501\u7684\u6548\u7387\u9ad8\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u521a\u624d\u4f60\u8bf4\u4e86CAS\u548cAQS\uff0c\u4f60\u80fd\u4ecb\u7ecd\u4e00\u4e0b\u5417\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\u3002 CAS\u7684\u5168\u79f0\u662f\uff1a Compare And Swap(\u6bd4\u8f83\u518d\u4ea4\u6362);\u5b83\u4f53\u73b0\u7684\u4e00\u79cd\u4e50\u89c2\u9501\u7684\u601d\u60f3\uff0c\u5728\u65e0\u9501\u72b6\u6001\u4e0b\u4fdd\u8bc1\u7ebf\u7a0b\u64cd\u4f5c\u6570\u636e\u7684\u539f\u5b50\u6027\u3002 CAS\u4f7f\u7528\u5230\u7684\u5730\u65b9\u5f88\u591a\uff1aAQS\u6846\u67b6\u3001AtomicXXX\u7c7b \u5728\u64cd\u4f5c\u5171\u4eab\u53d8\u91cf\u7684\u65f6\u5019\u4f7f\u7528\u7684\u81ea\u65cb\u9501\uff0c\u6548\u7387\u4e0a\u66f4\u9ad8\u4e00\u4e9b CAS\u7684\u5e95\u5c42\u662f\u8c03\u7528\u7684Unsafe\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u90fd\u662f\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\uff0c\u5176\u4ed6\u8bed\u8a00\u5b9e\u73b0 AQS\u7684\u8bdd\uff0c\u5176\u5b9e\u5c31\u4e00\u4e2ajdk\u63d0\u4f9b\u7684\u7c7bAbstractQueuedSynchronizer\uff0c\u662f\u963b\u585e\u5f0f\u9501\u548c\u76f8\u5173\u7684\u540c\u6b65\u5668\u5de5\u5177\u7684\u6846\u67b6\u3002 \u5185\u90e8\u6709\u4e00\u4e2a\u5c5e\u6027 state \u5c5e\u6027\u6765\u8868\u793a\u8d44\u6e90\u7684\u72b6\u6001\uff0c\u9ed8\u8ba4state\u7b49\u4e8e0\uff0c\u8868\u793a\u6ca1\u6709\u83b7\u53d6\u9501\uff0cstate\u7b49\u4e8e1\u7684\u65f6\u5019\u624d\u6807\u660e\u83b7\u53d6\u5230\u4e86\u9501\u3002\u901a\u8fc7cas \u673a\u5236\u8bbe\u7f6e state \u72b6\u6001 \u5728\u5b83\u7684\u5185\u90e8\u8fd8\u63d0\u4f9b\u4e86\u57fa\u4e8e FIFO \u7684\u7b49\u5f85\u961f\u5217\uff0c\u662f\u4e00\u4e2a\u53cc\u5411\u5217\u8868\uff0c\u5176\u4e2d tail \u6307\u5411\u961f\u5217\u6700\u540e\u4e00\u4e2a\u5143\u7d20 head \u6307\u5411\u961f\u5217\u4e2d\u6700\u4e45\u7684\u4e00\u4e2a\u5143\u7d20 \u5176\u4e2d\u6211\u4eec\u521a\u521a\u804a\u7684ReentrantLock\u5e95\u5c42\u7684\u5b9e\u73b0\u5c31\u662f\u4e00\u4e2aAQS\u3002 \u9762\u8bd5\u5b98 \uff1asynchronized\u548cLock\u6709\u4ec0\u4e48\u533a\u522b ? \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u597d\u7684\uff0c\u4e3b\u8981\u6709\u4e09\u4e2a\u65b9\u9762\u4e0d\u592a\u4e00\u6837 \u7b2c\u4e00\uff0c\u8bed\u6cd5\u5c42\u9762 synchronized \u662f\u5173\u952e\u5b57\uff0c\u6e90\u7801\u5728 jvm \u4e2d\uff0c\u7528 c++ \u8bed\u8a00\u5b9e\u73b0\uff0c\u9000\u51fa\u540c\u6b65\u4ee3\u7801\u5757\u9501\u4f1a\u81ea\u52a8\u91ca\u653e Lock \u662f\u63a5\u53e3\uff0c\u6e90\u7801\u7531 jdk \u63d0\u4f9b\uff0c\u7528 java \u8bed\u8a00\u5b9e\u73b0\uff0c\u9700\u8981\u624b\u52a8\u8c03\u7528 unlock \u65b9\u6cd5\u91ca\u653e\u9501 \u7b2c\u4e8c\uff0c\u529f\u80fd\u5c42\u9762 \u4e8c\u8005\u5747\u5c5e\u4e8e\u60b2\u89c2\u9501\u3001\u90fd\u5177\u5907\u57fa\u672c\u7684\u4e92\u65a5\u3001\u540c\u6b65\u3001\u9501\u91cd\u5165\u529f\u80fd Lock \u63d0\u4f9b\u4e86\u8bb8\u591a synchronized \u4e0d\u5177\u5907\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u83b7\u53d6\u7b49\u5f85\u72b6\u6001\u3001\u516c\u5e73\u9501\u3001\u53ef\u6253\u65ad\u3001\u53ef\u8d85\u65f6\u3001\u591a\u6761\u4ef6\u53d8\u91cf\uff0c\u540c\u65f6Lock \u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u573a\u666f\uff0c\u5982 ReentrantLock\uff0c ReentrantReadWriteLock \u7b2c\u4e09\uff0c\u6027\u80fd\u5c42\u9762 \u5728\u6ca1\u6709\u7ade\u4e89\u65f6\uff0csynchronized \u505a\u4e86\u5f88\u591a\u4f18\u5316\uff0c\u5982\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\uff0c\u6027\u80fd\u4e0d\u8d56 \u5728\u7ade\u4e89\u6fc0\u70c8\u65f6\uff0cLock \u7684\u5b9e\u73b0\u901a\u5e38\u4f1a\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd \u7edf\u5408\u6765\u770b\uff0c\u9700\u8981\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u6765\u9009\u62e9\u4e0d\u540c\u7684\u9501\u7684\u4f7f\u7528\u3002 \u9762\u8bd5\u5b98 \uff1a\u6b7b\u9501\u4ea7\u751f\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u540c\u65f6\u83b7\u53d6\u591a\u628a\u9501\uff0c\u8fd9\u65f6\u5c31\u5bb9\u6613\u53d1\u751f\u6b7b\u9501\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff1a t1 \u7ebf\u7a0b\u83b7\u5f97A\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6B\u5bf9\u8c61\u7684\u9501 t2 \u7ebf\u7a0b\u83b7\u5f97B\u5bf9\u8c61\u9501\uff0c\u63a5\u4e0b\u6765\u60f3\u83b7\u53d6A\u5bf9\u8c61\u7684\u9501 \u8fd9\u4e2a\u65f6\u5019t1\u7ebf\u7a0b\u548ct2\u7ebf\u7a0b\u90fd\u5728\u4e92\u76f8\u7b49\u5f85\u5bf9\u65b9\u7684\u9501\uff0c\u5c31\u4ea7\u751f\u4e86\u6b7b\u9501 \u9762\u8bd5\u5b98 \uff1a\u90a3\u5982\u679c\u4ea7\u51fa\u4e86\u8fd9\u6837\u7684\uff0c\u5982\u4f55\u8fdb\u884c\u6b7b\u9501\u8bca\u65ad\uff1f \u5019\u9009\u4eba \uff1a \u8fd9\u4e2a\u4e5f\u5f88\u5bb9\u6613\uff0c\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7jdk\u81ea\u52a8\u7684\u5de5\u5177\u5c31\u80fd\u641e\u5b9a \u6211\u4eec\u53ef\u4ee5\u5148\u901a\u8fc7jps\u6765\u67e5\u770b\u5f53\u524djava\u7a0b\u5e8f\u8fd0\u884c\u7684\u8fdb\u7a0bid \u7136\u540e\u901a\u8fc7jstack\u6765\u67e5\u770b\u8fd9\u4e2a\u8fdb\u7a0bid\uff0c\u5c31\u80fd\u5c55\u793a\u51fa\u6765\u6b7b\u9501\u7684\u95ee\u9898\uff0c\u5e76\u4e14\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u4ee3\u7801\u7684\u5177\u4f53\u884c\u53f7\u8303\u56f4\uff0c\u6211\u4eec\u518d\u53bb\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\u8fdb\u884c\u6392\u67e5\u5c31\u884c\u4e86\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf7\u8c08\u8c08\u4f60\u5bf9 volatile \u7684\u7406\u89e3 \u5019\u9009\u4eba \uff1a \u55ef~~ volatile \u662f\u4e00\u4e2a\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u4fee\u9970\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u3001\u7c7b\u7684\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u529f\u80fd \u7b2c\u4e00\uff1a\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u65f6\u7684\u53ef\u89c1\u6027\uff0c\u5373\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u8fd9\u65b0\u503c\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u6765\u8bf4\u662f\u7acb\u5373\u53ef\u89c1\u7684,volatile\u5173\u952e\u5b57\u4f1a\u5f3a\u5236\u5c06\u4fee\u6539\u7684\u503c\u7acb\u5373\u5199\u5165\u4e3b\u5b58\u3002 \u7b2c\u4e8c\uff1a \u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u4ee3\u7801\u6267\u884c\u6709\u5e8f\u6027\u3002\u5e95\u5c42\u5b9e\u73b0\u539f\u7406\u662f\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a \u5185\u5b58\u5c4f\u969c \uff0c\u901a\u8fc7\u63d2\u5165\u5185\u5b58\u5c4f\u969c\u7981\u6b62\u5728\u5185\u5b58\u5c4f\u969c \u524d\u540e \u7684\u6307\u4ee4\u6267\u884c\u91cd\u6392\u5e8f\u4f18\u5316 \u672c\u6587\u4f5c\u8005 \uff1a\u63a5\u300a\u96c6\u5408\u76f8\u5173\u9762\u8bd5\u9898\u300b \u9762\u8bd5\u5b98 \uff1a\u90a3\u4f60\u80fd\u804a\u4e00\u4e0bConcurrentHashMap\u7684\u539f\u7406\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\u597d\u7684\uff0c ConcurrentHashMap \u662f\u4e00\u79cd\u7ebf\u7a0b\u5b89\u5168\u7684\u9ad8\u6548Map\u96c6\u5408\uff0cjdk1.7\u548c1.8\u4e5f\u505a\u4e86\u5f88\u591a\u8c03\u6574\u3002 JDK1.7\u7684\u5e95\u5c42\u91c7\u7528\u662f \u5206\u6bb5\u7684\u6570\u7ec4 + \u94fe\u8868 \u5b9e\u73b0 JDK1.8 \u91c7\u7528\u7684\u6570\u636e\u7ed3\u6784\u8ddfHashMap1.8\u7684\u7ed3\u6784\u4e00\u6837\uff0c\u6570\u7ec4+\u94fe\u8868/\u7ea2\u9ed1\u4e8c\u53c9\u6811\u3002 \u5728jdk1.7\u4e2d ConcurrentHashMap \u91cc\u5305\u542b\u4e00\u4e2a Segment \u6570\u7ec4\u3002Segment \u7684\u7ed3\u6784\u548cHashMap\u7c7b\u4f3c\uff0c\u662f\u4e00 \u79cd\u6570\u7ec4\u548c\u94fe\u8868\u7ed3\u6784\uff0c\u4e00\u4e2a Segment \u5305\u542b\u4e00\u4e2a HashEntry \u6570\u7ec4\uff0c\u6bcf\u4e2a HashEntry \u662f\u4e00\u4e2a\u94fe\u8868\u7ed3\u6784 \u7684\u5143\u7d20\uff0c\u6bcf\u4e2a Segment \u5b88\u62a4\u7740\u4e00\u4e2aHashEntry\u6570\u7ec4\u91cc\u7684\u5143\u7d20\uff0c\u5f53\u5bf9 HashEntry \u6570\u7ec4\u7684\u6570\u636e\u8fdb\u884c\u4fee \u6539\u65f6\uff0c\u5fc5\u987b\u9996\u5148\u83b7\u5f97\u5bf9\u5e94\u7684 Segment\u7684\u9501\u3002 Segment \u662f\u4e00\u79cd\u53ef\u91cd\u5165\u7684\u9501 ReentrantLock\uff0c\u6bcf\u4e2a Segment \u5b88\u62a4\u4e00\u4e2aHashEntry \u6570\u7ec4\u91cc\u5f97\u5143 \u7d20\uff0c\u5f53\u5bf9 HashEntry \u6570\u7ec4\u7684\u6570\u636e\u8fdb\u884c\u4fee\u6539\u65f6\uff0c\u5fc5\u987b\u9996\u5148\u83b7\u5f97\u5bf9\u5e94\u7684 Segment \u9501 \u5728jdk1.8\u4e2d\u7684ConcurrentHashMap \u505a\u4e86\u8f83\u5927\u7684\u4f18\u5316\uff0c\u6027\u80fd\u63d0\u5347\u4e86\u4e0d\u5c11\u3002\u9996\u5148\u662f\u5b83\u7684\u6570\u636e\u7ed3\u6784\u4e0ejdk1.8\u7684hashMap\u6570\u636e\u7ed3\u6784\u5b8c\u5168\u4e00\u81f4\u3002\u5176\u6b21\u662f\u653e\u5f03\u4e86Segment\u81c3\u80bf\u7684\u8bbe\u8ba1\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u91c7\u7528Node + CAS + Synchronized\u6765\u4fdd \u8bc1\u5e76\u53d1\u5b89\u5168\u8fdb\u884c\u5b9e\u73b0\uff0csynchronized\u53ea\u9501\u5b9a\u5f53\u524d\u94fe\u8868\u6216\u7ea2\u9ed1\u4e8c\u53c9\u6811\u7684\u9996\u8282\u70b9\uff0c\u8fd9\u6837\u53ea\u8981hash\u4e0d\u51b2 \u7a81\uff0c\u5c31\u4e0d\u4f1a\u4ea7\u751f\u5e76\u53d1 , \u6548\u7387\u5f97\u5230\u63d0\u5347","title":"6.2 \u7ebf\u7a0b\u4e2d\u5e76\u53d1\u9501"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#63","text":"\u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u79cd\u7c7b\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff01\u662f\u8fd9\u6837 \u5728jdk\u4e2d\u9ed8\u8ba4\u63d0\u4f9b\u4e864\u4e2d\u65b9\u5f0f\u521b\u5efa\u7ebf\u7a0b\u6c60 \u7b2c\u4e00\u4e2a\u662f\uff1anewCachedThreadPool\u521b\u5efa\u4e00\u4e2a\u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u957f\u5ea6\u8d85\u8fc7\u5904\u7406\u9700\u8981\uff0c\u53ef\u7075\u6d3b\u56de \u6536\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u82e5\u65e0\u53ef\u56de\u6536\uff0c\u5219\u65b0\u5efa\u7ebf\u7a0b\u3002 \u7b2c\u4e8c\u4e2a\u662f\uff1anewFixedThreadPool \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u53ef\u63a7\u5236\u7ebf\u7a0b\u6700\u5927\u5e76\u53d1\u6570\uff0c\u8d85\u51fa\u7684\u7ebf\u7a0b\u4f1a\u5728\u961f\u5217 \u4e2d\u7b49\u5f85\u3002 \u7b2c\u4e09\u4e2a\u662f\uff1anewScheduledThreadPool \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u652f\u6301\u5b9a\u65f6\u53ca\u5468\u671f\u6027\u4efb\u52a1\u6267\u884c\u3002 \u7b2c\u56db\u4e2a\u662f\uff1anewSingleThreadExecutor \u521b\u5efa\u4e00\u4e2a\u5355\u7ebf\u7a0b\u5316\u7684\u7ebf\u7a0b\u6c60\uff0c\u5b83\u53ea\u4f1a\u7528\u552f\u4e00\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\uff0c\u4fdd\u8bc1\u6240\u6709\u4efb\u52a1\u6309\u7167\u6307\u5b9a\u987a\u5e8f(FIFO, LIFO, \u4f18\u5148\u7ea7)\u6267\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u53c2\u6570\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba \uff1a \u5728\u7ebf\u7a0b\u6c60\u4e2d\u4e00\u5171\u67097\u4e2a\u6838\u5fc3\u53c2\u6570\uff1a corePoolSize \u6838\u5fc3\u7ebf\u7a0b\u6570\u76ee - \u6c60\u4e2d\u4f1a\u4fdd\u7559\u7684\u6700\u591a\u7ebf\u7a0b\u6570 maximumPoolSize \u6700\u5927\u7ebf\u7a0b\u6570\u76ee - \u6838\u5fc3\u7ebf\u7a0b+\u6551\u6025\u7ebf\u7a0b\u7684\u6700\u5927\u6570\u76ee keepAliveTime \u751f\u5b58\u65f6\u95f4 - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\uff0c\u751f\u5b58\u65f6\u95f4\u5185\u6ca1\u6709\u65b0\u4efb\u52a1\uff0c\u6b64\u7ebf\u7a0b\u8d44\u6e90\u4f1a\u91ca\u653e unit \u65f6\u95f4\u5355\u4f4d - \u6551\u6025\u7ebf\u7a0b\u7684\u751f\u5b58\u65f6\u95f4\u5355\u4f4d\uff0c\u5982\u79d2\u3001\u6beb\u79d2\u7b49 workQueue - \u5f53\u6ca1\u6709\u7a7a\u95f2\u6838\u5fc3\u7ebf\u7a0b\u65f6\uff0c\u65b0\u6765\u4efb\u52a1\u4f1a\u52a0\u5165\u5230\u6b64\u961f\u5217\u6392\u961f\uff0c\u961f\u5217\u6ee1\u4f1a\u521b\u5efa\u6551\u6025\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1 threadFactory \u7ebf\u7a0b\u5de5\u5382 - \u53ef\u4ee5\u5b9a\u5236\u7ebf\u7a0b\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u4f8b\u5982\u8bbe\u7f6e\u7ebf\u7a0b\u540d\u5b57\u3001\u662f\u5426\u662f\u5b88\u62a4\u7ebf\u7a0b\u7b49 handler \u62d2\u7edd\u7b56\u7565 - \u5f53\u6240\u6709\u7ebf\u7a0b\u90fd\u5728\u7e41\u5fd9\uff0cworkQueue \u4e5f\u653e\u6ee1\u65f6\uff0c\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565 \u5728\u62d2\u7edd\u7b56\u7565\u4e2d\u53c8\u67094\u4e2d\u62d2\u7edd\u7b56\u7565 \u5f53\u7ebf\u7a0b\u6570\u8fc7\u591a\u4ee5\u540e\uff0c\u7b2c\u4e00\u79cd\u662f\u629b\u5f02\u5e38\u3001\u7b2c\u4e8c\u79cd\u662f\u7531\u8c03\u7528\u8005\u6267\u884c\u4efb\u52a1\u3001\u7b2c\u4e09\u662f\u4e22\u5f03\u5f53\u524d\u7684\u4efb\u52a1\uff0c\u7b2c\u56db\u662f\u4e22\u5f03\u6700\u65e9\u6392\u961f\u4efb\u52a1\u3002\u9ed8\u8ba4\u662f\u76f4\u63a5\u629b\u5f02\u5e38\u3002 \u9762\u8bd5\u5b98 \uff1a\u5982\u4f55\u786e\u5b9a\u6838\u5fc3\u7ebf\u7a0b\u6c60\u5462\uff1f \u5019\u9009\u4eba \uff1a \u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u516c\u53f8\u5f53\u65f6\u6709\u4e00\u4e9b\u89c4\u8303\uff0c\u4e3a\u4e86\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7684\u5207\u6362\uff0c\u8981\u6839\u636e\u5f53\u65f6\u90e8\u7f72\u7684\u670d\u52a1\u5668\u7684CPU\u6838\u6570\u6765\u51b3\u5b9a\uff0c\u6211\u4eec\u89c4\u5219\u662f\uff1aCPU\u6838\u6570+1\u5c31\u662f\u6700\u7ec8\u7684\u6838\u5fc3\u7ebf\u7a0b\u6570\u3002 \u9762\u8bd5\u5b98 \uff1a\u7ebf\u7a0b\u6c60\u7684\u6267\u884c\u539f\u7406\u77e5\u9053\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef~\uff0c\u5b83\u662f\u8fd9\u6837\u7684 \u9996\u5148\u5224\u65ad\u7ebf\u7a0b\u6c60\u91cc\u7684\u6838\u5fc3\u7ebf\u7a0b\u662f\u5426\u90fd\u5728\u6267\u884c\u4efb\u52a1\uff0c\u5982\u679c\u4e0d\u662f\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\u3002\u5982\u679c\u6838\u5fc3\u7ebf\u7a0b\u90fd\u5728\u6267\u884c\u4efb\u52a1\uff0c\u5219\u7ebf\u7a0b\u6c60\u5224\u65ad\u5de5\u4f5c\u961f\u5217\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u5de5\u4f5c\u961f\u5217\u6ca1\u6709\u6ee1\uff0c\u5219\u5c06\u65b0\u63d0\u4ea4\u7684\u4efb\u52a1\u5b58\u50a8\u5728\u8fd9\u4e2a\u5de5\u4f5c\u961f \u5217\u91cc\u3002\u5982\u679c\u5de5\u4f5c\u961f\u5217\u6ee1\u4e86\uff0c\u5219\u5224\u65ad\u7ebf\u7a0b\u6c60\u91cc\u7684\u7ebf\u7a0b\u662f\u5426\u90fd\u5904\u4e8e\u5de5\u4f5c\u72b6\u6001\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb \u52a1\u3002\u5982\u679c\u5df2\u7ecf\u6ee1\u4e86\uff0c\u5219\u4ea4\u7ed9\u62d2\u7edd\u7b56\u7565\u6765\u5904\u7406\u8fd9\u4e2a\u4efb\u52a1\u3002 \u9762\u8bd5\u5b98 \uff1a\u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u4f7f\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60\u5462\uff1f \u5019\u9009\u4eba \uff1a \u597d\u7684\uff0c\u5176\u5b9e\u8fd9\u4e2a\u4e8b\u60c5\u5728\u963f\u91cc\u63d0\u4f9b\u7684\u6700\u65b0\u5f00\u53d1\u624b\u518c\u300aJava\u5f00\u53d1\u624b\u518c-\u5d69\u5c71\u7248\u300b\u4e2d\u4e5f\u63d0\u5230\u4e86 \u4e3b\u8981\u539f\u56e0\u662f\u5982\u679c\u4f7f\u7528Executors\u521b\u5efa\u7ebf\u7a0b\u6c60\u7684\u8bdd\uff0c\u5b83\u5141\u8bb8\u7684\u8bf7\u6c42\u961f\u5217\u9ed8\u8ba4\u957f\u5ea6\u662fInteger.MAX_VALUE\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u5806\u79ef\u5927\u91cf\u7684\u8bf7\u6c42\uff0c\u4ece\u800c\u5bfc\u81f4OOM\uff08\u5185\u5b58\u6ea2\u51fa\uff09\u3002 \u6240\u4ee5\uff0c\u6211\u4eec\u4e00\u822c\u63a8\u8350\u4f7f\u7528ThreadPoolExecutor\u6765\u521b\u5efa\u7ebf\u7a0b\u6c60\uff0c\u8fd9\u6837\u53ef\u4ee5\u660e\u786e\u89c4\u5b9a\u7ebf\u7a0b\u6c60\u7684\u53c2\u6570\uff0c\u907f\u514d\u8d44\u6e90\u7684\u8017\u5c3d\u3002","title":"6.3 \u7ebf\u7a0b\u6c60"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#64","text":"\u9762\u8bd5\u5b98 \uff1a\u5982\u679c\u63a7\u5236\u67d0\u4e00\u4e2a\u65b9\u6cd5\u5141\u8bb8\u5e76\u53d1\u8bbf\u95ee\u7ebf\u7a0b\u7684\u6570\u91cf\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u6211\u60f3\u4e00\u4e0b \u5728jdk\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2aSemaphore[sem\u0259f\u0254\u02d0r]\u7c7b\uff08\u4fe1\u53f7\u91cf\uff09 \u5b83\u63d0\u4f9b\u4e86\u4e24\u4e2a\u65b9\u6cd5\uff0csemaphore.acquire() \u8bf7\u6c42\u4fe1\u53f7\u91cf\uff0c\u53ef\u4ee5\u9650\u5236\u7ebf\u7a0b\u7684\u4e2a\u6570\uff0c\u662f\u4e00\u4e2a\u6b63\u6570\uff0c\u5982\u679c\u4fe1\u53f7\u91cf\u662f-1,\u5c31\u4ee3\u8868\u5df2\u7ecf\u7528\u5b8c\u4e86\u4fe1\u53f7\u91cf\uff0c\u5176\u4ed6\u7ebf\u7a0b\u9700\u8981\u963b\u585e\u4e86 \u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u662fsemaphore.release()\uff0c\u4ee3\u8868\u662f\u91ca\u653e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u6b64\u65f6\u4fe1\u53f7\u91cf\u7684\u4e2a\u6570+1 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u8be5\u5982\u4f55\u4fdd\u8bc1Java\u7a0b\u5e8f\u5728\u591a\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u5b89\u5168\u5462\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u521a\u624d\u8bb2\u8fc7\u4e86\u5bfc\u81f4\u7ebf\u7a0b\u5b89\u5168\u7684\u539f\u56e0\uff0c\u5982\u679c\u89e3\u51b3\u7684\u8bdd\uff0cjdk\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u5f88\u591a\u7684\u7c7b\u5e2e\u52a9\u6211\u4eec\u89e3\u51b3\u591a\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898\uff0c\u6bd4\u5982\uff1a JDK Atomic\u5f00\u5934\u7684\u539f\u5b50\u7c7b\u3001synchronized\u3001LOCK\uff0c\u53ef\u4ee5\u89e3\u51b3\u539f\u5b50\u6027\u95ee\u9898 synchronized\u3001volatile\u3001LOCK\uff0c\u53ef\u4ee5\u89e3\u51b3\u53ef\u89c1\u6027\u95ee\u9898 Happens-Before \u89c4\u5219\u53ef\u4ee5\u89e3\u51b3\u6709\u5e8f\u6027\u95ee\u9898 \u9762\u8bd5\u5b98 \uff1a\u4f60\u5728\u9879\u76ee\u4e2d\u54ea\u91cc\u7528\u4e86\u591a\u7ebf\u7a0b\uff1f \u5019\u9009\u4eba \uff1a \u55ef~~\uff0c\u6211\u60f3\u4e00\u4e0b\u5f53\u65f6\u7684\u573a\u666f[\u6839\u636e\u81ea\u5df1\u7b80\u5386\u4e0a\u7684\u6a21\u5757\u8bbe\u8ba1\u591a\u7ebf\u7a0b\u573a\u666f] \u53c2\u8003\u573a\u666f\u4e00\uff1a es\u6570\u636e\u6279\u91cf\u5bfc\u5165 \u5728\u6211\u4eec\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u628a\u6570\u636e\u91cf\u7684\u6570\u636e\u4e00\u6b21\u6027\u7684\u540c\u6b65\u5230es\u7d22\u5f15\u5e93\u4e2d\uff0c\u4f46\u662f\u5f53\u65f6\u7684\u6570\u636e\u597d\u50cf\u662f1000\u4e07\u5de6\u53f3\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u6570\u636e\u80af\u5b9a\u4e0d\u884c\uff08oom\u5f02\u5e38\uff09\uff0c\u5982\u679c\u5206\u6279\u6267\u884c\u7684\u8bdd\uff0c\u8017\u65f6\u4e5f\u592a\u4e45\u4e86\u3002\u6240\u4ee5\uff0c\u5f53\u65f6\u6211\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\u7684\u65b9\u5f0f\u5bfc\u5165\uff0c\u5229\u7528CountDownLatch+Future\u6765\u63a7\u5236\uff0c\u5c31\u80fd\u5927\u5927\u63d0\u5347\u5bfc\u5165\u7684\u65f6\u95f4\u3002 \u53c2\u8003\u573a\u666f\u4e8c\uff1a \u5728\u6211\u505a\u90a3\u4e2axx\u7535\u5546\u7f51\u7ad9\u7684\u65f6\u5019\uff0c\u91cc\u9762\u6709\u4e00\u4e2a\u6570\u636e\u6c47\u603b\u7684\u529f\u80fd\uff0c\u5728\u7528\u6237\u4e0b\u5355\u4e4b\u540e\u9700\u8981\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f\uff0c\u4e5f\u9700\u8981\u83b7\u5f97\u8ba2\u5355\u4e2d\u7684\u5546\u54c1\u8be6\u7ec6\u4fe1\u606f\uff08\u53ef\u80fd\u662f\u591a\u4e2a\uff09\uff0c\u8fd8\u9700\u8981\u67e5\u770b\u7269\u6d41\u53d1\u8d27\u4fe1\u606f\u3002\u56e0\u4e3a\u5b83\u4eec\u4e09\u4e2a\u5bf9\u5e94\u7684\u5206\u522b\u4e09\u4e2a\u5fae\u670d\u52a1\uff0c\u5982\u679c\u4e00\u4e2a\u4e00\u4e2a\u7684\u64cd\u4f5c\u7684\u8bdd\uff0c\u4e92\u76f8\u7b49\u5f85\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\u3002\u6240\u4ee5\uff0c\u6211\u5f53\u65f6\u5c31\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u7ebf\u7a0b\u6c60\uff0c\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u5904\u7406\uff0c\u6700\u7ec8\u518d\u6c47\u603b\u7ed3\u679c\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f53\u7136\u91cc\u9762\u9700\u8981\u7528\u5230Future\u6765\u83b7\u53d6\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e4b\u540e\u7684\u7ed3\u679c\u624d\u884c \u53c2\u8003\u573a\u666f\u4e09\uff1a \u300a\u9ed1\u9a6c\u5934\u6761\u300b\u9879\u76ee\u4e2d\u4f7f\u7528\u7684 \u6211\u5f53\u65f6\u505a\u4e86\u4e00\u4e2a\u6587\u7ae0\u641c\u7d22\u7684\u529f\u80fd\uff0c\u7528\u6237\u8f93\u5165\u5173\u952e\u5b57\u8981\u641c\u7d22\u6587\u7ae0\uff0c\u540c\u65f6\u9700\u8981\u4fdd\u5b58\u7528\u6237\u7684\u641c\u7d22\u8bb0\u5f55\uff08\u641c\u7d22\u5386\u53f2\uff09\uff0c\u8fd9\u5757\u6211\u8bbe\u8ba1\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u4e0d\u5f71\u54cd\u7528\u6237\u7684\u6b63\u5e38\u641c\u7d22\uff0c\u6211\u4eec\u91c7\u7528\u7684\u5f02\u6b65\u7684\u65b9\u5f0f\u8fdb\u884c\u4fdd\u5b58\u7684\uff0c\u4e3a\u4e86\u63d0\u5347\u6027\u80fd\uff0c\u6211\u4eec\u52a0\u5165\u4e86\u7ebf\u7a0b\u6c60\uff0c\u4e5f\u5c31\u8bf4\u5728\u8c03\u7528\u5f02\u6b65\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u4ece\u7ebf\u7a0b\u6c60\u4e2d\u83b7\u53d6\u7ebf\u7a0b\u4f7f\u7528","title":"6.4 \u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u95ee\u9898"},{"location":"heimajava/08-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%AF%87/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#65","text":"\u9762\u8bd5\u5b98 \uff1a\u8c08\u8c08\u4f60\u5bf9ThreadLocal\u7684\u7406\u89e3 \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u662f\u8fd9\u6837\u7684~~ ThreadLocal \u4e3b\u8981\u529f\u80fd\u6709\u4e24\u4e2a\uff0c\u7b2c\u4e00\u4e2a\u662f\u53ef\u4ee5\u5b9e\u73b0\u8d44\u6e90\u5bf9\u8c61\u7684\u7ebf\u7a0b\u9694\u79bb\uff0c\u8ba9\u6bcf\u4e2a\u7ebf\u7a0b\u5404\u7528\u5404\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u907f\u514d\u4e89\u7528\u5f15\u53d1\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\uff0c\u7b2c\u4e8c\u4e2a\u662f\u5b9e\u73b0\u4e86\u7ebf\u7a0b\u5185\u7684\u8d44\u6e90\u5171\u4eab \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u4f60\u77e5\u9053ThreadLocal\u7684\u5e95\u5c42\u539f\u7406\u5b9e\u73b0\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u77e5\u9053\u4e00\u4e9b~ \u5728ThreadLocal\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u4e00\u4e2a ThreadLocalMap \u7c7b\u578b\u7684\u6210\u5458\u53d8\u91cf\uff0c\u7528\u6765\u5b58\u50a8\u8d44\u6e90\u5bf9\u8c61 \u5f53\u6211\u4eec\u8c03\u7528 set \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u8d44\u6e90\u5bf9\u8c61\u4f5c\u4e3a value\uff0c\u653e\u5165\u5f53\u524d\u7ebf\u7a0b\u7684 ThreadLocalMap \u96c6\u5408\u4e2d \u5f53\u8c03\u7528 get \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u5230\u5f53\u524d\u7ebf\u7a0b\u4e2d\u67e5\u627e\u5173\u8054\u7684\u8d44\u6e90\u503c \u5f53\u8c03\u7528 remove \u65b9\u6cd5\uff0c\u5c31\u662f\u4ee5 ThreadLocal \u81ea\u5df1\u4f5c\u4e3a key\uff0c\u79fb\u9664\u5f53\u524d\u7ebf\u7a0b\u5173\u8054\u7684\u8d44\u6e90\u503c \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u5173\u4e8eThreadLocal\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u8fd9\u4e2a\u4e8b\u60c5\uff0c\u4e86\u89e3\u5417\uff1f \u5019\u9009\u4eba \uff1a \u55ef\uff0c\u6211\u4e4b\u524d\u770b\u8fc7\u6e90\u7801\uff0c\u6211\u60f3\u4e00\u4e0b~~ \u662f\u5e94\u4e3aThreadLocalMap \u4e2d\u7684 key \u88ab\u8bbe\u8ba1\u4e3a\u5f31\u5f15\u7528\uff0c\u5b83\u662f\u88ab\u52a8\u7684\u88abGC\u8c03\u7528\u91ca\u653ekey\uff0c\u4e0d\u8fc7\u5173\u952e\u7684\u662f\u53ea\u6709key\u53ef\u4ee5\u5f97\u5230\u5185\u5b58\u91ca\u653e\uff0c\u800cvalue\u4e0d\u4f1a\uff0c\u56e0\u4e3avalue\u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\u3002 \u5728\u4f7f\u7528ThreadLocal \u65f6\u90fd\u628a\u5b83\u4f5c\u4e3a\u9759\u6001\u53d8\u91cf\uff08\u5373\u5f3a\u5f15\u7528\uff09\uff0c\u56e0\u6b64\u65e0\u6cd5\u88ab\u52a8\u4f9d\u9760 GC \u56de\u6536\uff0c\u5efa\u8bae\u4e3b\u52a8\u7684remove \u91ca\u653e key\uff0c\u8fd9\u6837\u5c31\u80fd\u907f\u514d\u5185\u5b58\u6ea2\u51fa\u3002","title":"6.5 \u5176\u4ed6"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/","text":"JVM\u76f8\u5173\u9762\u8bd5\u9898 1 JVM\u7ec4\u6210 1.1 JVM\u7531\u90a3\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 JVM\u662f\u4ec0\u4e48 Java Virtual Machine Java\u7a0b\u5e8f\u7684\u8fd0\u884c\u73af\u5883\uff08java\u4e8c\u8fdb\u5236\u5b57\u8282\u7801\u7684\u8fd0\u884c\u73af\u5883\uff09 \u597d\u5904\uff1a \u4e00\u6b21\u7f16\u5199\uff0c\u5230\u5904\u8fd0\u884c \u81ea\u52a8\u5185\u5b58\u7ba1\u7406\uff0c\u5783\u573e\u56de\u6536\u673a\u5236 JVM\u7531\u54ea\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f \u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa JVM \u7684\u4e3b\u8981\u7ec4\u6210\u90e8\u5206 ClassLoader\uff08\u7c7b\u52a0\u8f7d\u5668\uff09 Runtime Data Area\uff08\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff0c\u5185\u5b58\u5206\u533a\uff09 Execution Engine\uff08\u6267\u884c\u5f15\u64ce\uff09 Native Method Library\uff08\u672c\u5730\u5e93\u63a5\u53e3\uff09 \u8fd0\u884c\u6d41\u7a0b\uff1a \uff081\uff09\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u628aJava\u4ee3\u7801\u8f6c\u6362\u4e3a\u5b57\u8282\u7801 \uff082\uff09\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff08Runtime Data Area\uff09\u628a\u5b57\u8282\u7801\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u5b57\u8282\u7801\u6587\u4ef6\u53ea\u662fJVM\u7684\u4e00\u5957\u6307\u4ee4\u96c6\u89c4\u8303\uff0c\u5e76\u4e0d\u80fd\u76f4\u63a5\u4ea4\u7ed9\u5e95\u5c42\u7cfb\u7edf\u53bb\u6267\u884c\uff0c\u800c\u662f\u6709\u6267\u884c\u5f15\u64ce\u8fd0\u884c \uff083\uff09\u6267\u884c\u5f15\u64ce\uff08Execution Engine\uff09\u5c06\u5b57\u8282\u7801\u7ffb\u8bd1\u4e3a\u5e95\u5c42\u7cfb\u7edf\u6307\u4ee4\uff0c\u518d\u4ea4\u7531CPU\u6267\u884c\u53bb\u6267\u884c\uff0c\u6b64\u65f6\u9700\u8981\u8c03\u7528\u5176\u4ed6\u8bed\u8a00\u7684\u672c\u5730\u5e93\u63a5\u53e3\uff08Native Method Library\uff09\u6765\u5b9e\u73b0\u6574\u4e2a\u7a0b\u5e8f\u7684\u529f\u80fd\u3002 1.2 \u4ec0\u4e48\u662f\u7a0b\u5e8f\u8ba1\u6570\u5668\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7a0b\u5e8f\u8ba1\u6570\u5668\uff1a\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u5185\u90e8\u4fdd\u5b58\u7684\u5b57\u8282\u7801\u7684\u884c\u53f7\u3002\u7528\u4e8e\u8bb0\u5f55\u6b63\u5728\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u7684\u5730\u5740\u3002 javap -verbose xx.class \u6253\u5370\u5806\u6808\u5927\u5c0f\uff0c\u5c40\u90e8\u53d8\u91cf\u7684\u6570\u91cf\u548c\u65b9\u6cd5\u7684\u53c2\u6570\u3002 \u200b java\u865a\u62df\u673a\u5bf9\u4e8e\u591a\u7ebf\u7a0b\u662f\u901a\u8fc7\u7ebf\u7a0b\u8f6e\u6d41\u5207\u6362\u5e76\u4e14\u5206\u914d\u7ebf\u7a0b\u6267\u884c\u65f6\u95f4\u3002\u5728\u4efb\u4f55\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u53ea\u4f1a\u5904\u7406\u6267\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u5f53\u524d\u88ab\u6267\u884c\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u5b83\u6240\u5206\u914d\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\u3010\u6302\u8d77\u3011\u3002\u5904\u7406\u5668\u4f1a\u5207\u6362\u5230\u53e6\u5916\u7684\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6765\u8fdb\u884c\u6267\u884c\u3002\u5e76\u4e14\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\uff0c\u63a5\u7740\u5904\u7406\u5668\u5c31\u4f1a\u53c8\u6765\u6267\u884c\u88ab\u6302\u8d77\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u3002 \u200b \u90a3\u4e48\u73b0\u5728\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\uff0c\u5f53\u524d\u5904\u7406\u5668\u5982\u4f55\u80fd\u591f\u77e5\u9053\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u88ab\u6302\u8d77\u7684\u7ebf\u7a0b\uff0c\u5b83\u4e0a\u4e00\u6b21\u6267\u884c\u5230\u4e86\u54ea\u91cc\uff1f\u90a3\u4e48\u8fd9\u65f6\u5c31\u9700\u8981\u4ece\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u6765\u56de\u53bb\u5230\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u4ed6\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u884c\u53f7\uff0c\u7136\u540e\u63a5\u7740\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002 \u200b \u7a0b\u5e8f\u8ba1\u6570\u5668\u662fJVM\u89c4\u8303\u4e2d\u552f\u4e00\u4e00\u4e2a\u6ca1\u6709\u89c4\u5b9a\u51fa\u73b0OOM\u7684\u533a\u57df\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7a7a\u95f4\u4e5f\u4e0d\u4f1a\u8fdb\u884cGC\u3002 1.3 \u4f60\u80fd\u7ed9\u6211\u8be6\u7ec6\u7684\u4ecb\u7ecdJava\u5806\u5417? \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df\uff1a\u4e3b\u8981\u7528\u6765\u4fdd\u5b58\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u6570\u7ec4\u7b49\uff0c\u5f53\u5806\u4e2d\u6ca1\u6709\u5185\u5b58\u7a7a\u95f4\u53ef\u5206\u914d\u7ed9\u5b9e\u4f8b\uff0c\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5219\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002 \u5e74\u8f7b\u4ee3\u88ab\u5212\u5206\u4e3a\u4e09\u90e8\u5206\uff0cEden\u533a\u548c\u4e24\u4e2a\u5927\u5c0f\u4e25\u683c\u76f8\u540c\u7684Survivor\u533a\uff0c\u6839\u636eJVM\u7684\u7b56\u7565\uff0c\u5728\u7ecf\u8fc7\u51e0\u6b21\u5783\u573e\u6536\u96c6\u540e\uff0c\u4efb\u7136\u5b58\u6d3b\u4e8eSurvivor\u7684\u5bf9\u8c61\u5c06\u88ab\u79fb\u52a8\u5230\u8001\u5e74\u4ee3\u533a\u95f4\u3002 \u8001\u5e74\u4ee3\u4e3b\u8981\u4fdd\u5b58\u751f\u547d\u5468\u671f\u957f\u7684\u5bf9\u8c61\uff0c\u4e00\u822c\u662f\u4e00\u4e9b\u8001\u7684\u5bf9\u8c61 \u5143\u7a7a\u95f4\u4fdd\u5b58\u7684\u7c7b\u4fe1\u606f\u3001\u9759\u6001\u53d8\u91cf\u3001\u5e38\u91cf\u3001\u7f16\u8bd1\u540e\u7684\u4ee3\u7801 \u200b \u4e3a\u4e86\u907f\u514d\u65b9\u6cd5\u533a\u51fa\u73b0OOM\uff0c\u6240\u4ee5\u5728java8\u4e2d\u5c06\u5806\u4e0a\u7684\u65b9\u6cd5\u533a\u3010\u6c38\u4e45\u4ee3\u3011\u7ed9\u79fb\u52a8\u5230\u4e86\u672c\u5730\u5185\u5b58\u4e0a\uff0c\u91cd\u65b0\u5f00\u8f9f\u4e86\u4e00\u5757\u7a7a\u95f4\uff0c\u53eb\u505a \u5143\u7a7a\u95f4 \u3002\u90a3\u4e48\u73b0\u5728\u5c31\u53ef\u4ee5\u907f\u514d\u6389OOM\u7684\u51fa\u73b0\u4e86\u3002 \u5143\u7a7a\u95f4(MetaSpace)\u4ecb\u7ecd \u200b \u5728 HotSpot JVM \u4e2d\uff0c\u6c38\u4e45\u4ee3\uff08 \u2248 \u65b9\u6cd5\u533a\uff09\u4e2d\u7528\u4e8e\u5b58\u653e\u7c7b\u548c\u65b9\u6cd5\u7684\u5143\u6570\u636e\u4ee5\u53ca\u5e38\u91cf\u6c60\uff0c\u6bd4\u5982Class \u548c Method\u3002\u6bcf\u5f53\u4e00\u4e2a\u7c7b\u521d\u6b21\u88ab\u52a0\u8f7d\u7684\u65f6\u5019\uff0c\u5b83\u7684\u5143\u6570\u636e\u90fd\u4f1a\u653e\u5230\u6c38\u4e45\u4ee3\u4e2d\u3002 \u200b \u6c38\u4e45\u4ee3\u662f\u6709\u5927\u5c0f\u9650\u5236\u7684\uff0c\u56e0\u6b64\u5982\u679c\u52a0\u8f7d\u7684\u7c7b\u592a\u591a\uff0c\u5f88\u6709\u53ef\u80fd\u5bfc\u81f4\u6c38\u4e45\u4ee3\u5185\u5b58\u6ea2\u51fa\uff0c\u5373OutOfMemoryError\uff0c\u4e3a\u6b64\u4e0d\u5f97\u4e0d\u5bf9\u865a\u62df\u673a\u505a\u8c03\u4f18\u3002 \u200b \u90a3\u4e48\uff0cJava 8 \u4e2d PermGen \u4e3a\u4ec0\u4e48\u88ab\u79fb\u51fa HotSpot JVM \u4e86\uff1f \u5b98\u7f51\u7ed9\u51fa\u4e86\u89e3\u91ca\uff1ahttp://openjdk.java.net/jeps/122 This is part of the JRockit and Hotspot convergence effort. JRockit customers do not need to configure the permanent generation (since JRockit does not have a permanent generation) and are accustomed to not configuring the permanent generation. \u79fb\u9664\u6c38\u4e45\u4ee3\u662f\u4e3a\u878d\u5408HotSpot JVM\u4e0e JRockit VM\u800c\u505a\u51fa\u7684\u52aa\u529b\uff0c\u56e0\u4e3aJRockit\u6ca1\u6709\u6c38\u4e45\u4ee3\uff0c\u4e0d\u9700\u8981\u914d\u7f6e\u6c38\u4e45\u4ee3\u3002 1\uff09\u7531\u4e8e PermGen \u5185\u5b58\u7ecf\u5e38\u4f1a\u6ea2\u51fa\uff0c\u5f15\u53d1OutOfMemoryError\uff0c\u56e0\u6b64 JVM \u7684\u5f00\u53d1\u8005\u5e0c\u671b\u8fd9\u4e00\u5757\u5185\u5b58\u53ef\u4ee5\u66f4\u7075\u6d3b\u5730\u88ab\u7ba1\u7406\uff0c\u4e0d\u8981\u518d\u7ecf\u5e38\u51fa\u73b0\u8fd9\u6837\u7684 OOM\u3002 2\uff09\u79fb\u9664 PermGen \u53ef\u4ee5\u4fc3\u8fdb HotSpot JVM \u4e0e JRockit VM \u7684\u878d\u5408\uff0c\u56e0\u4e3a JRockit \u6ca1\u6709\u6c38\u4e45\u4ee3\u3002 \u200b \u51c6\u786e\u6765\u8bf4\uff0cPerm \u533a\u4e2d\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u88ab\u79fb\u5230\u4e86\u5806\u5185\u5b58\u4e2d\u662f\u5728 Java7 \u4e4b\u540e\uff0cJava 8 \u65f6\uff0cPermGen \u88ab\u5143\u7a7a\u95f4\u4ee3\u66ff\uff0c\u5176\u4ed6\u5185\u5bb9\u6bd4\u5982 \u7c7b\u5143\u4fe1\u606f\u3001\u5b57\u6bb5\u3001\u9759\u6001\u5c5e\u6027\u3001\u65b9\u6cd5\u3001\u5e38\u91cf \u7b49\u90fd\u79fb\u52a8\u5230\u5143\u7a7a\u95f4\u533a\u3002\u6bd4\u5982 java/lang/Object \u7c7b\u5143\u4fe1\u606f\u3001\u9759\u6001\u5c5e\u6027 System.out\u3001\u6574\u578b\u5e38\u91cf\u7b49\u3002 \u200b \u5143\u7a7a\u95f4\u7684\u672c\u8d28\u548c\u6c38\u4e45\u4ee3\u7c7b\u4f3c\uff0c\u90fd\u662f\u5bf9 JVM \u89c4\u8303\u4e2d\u65b9\u6cd5\u533a\u7684\u5b9e\u73b0\u3002\u4e0d\u8fc7\u5143\u7a7a\u95f4\u4e0e\u6c38\u4e45\u4ee3\u4e4b\u95f4\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\uff1a\u5143\u7a7a\u95f4\u5e76\u4e0d\u5728\u865a\u62df\u673a\u4e2d\uff0c\u800c\u662f\u4f7f\u7528\u672c\u5730\u5185\u5b58\u3002\u56e0\u6b64\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5143\u7a7a\u95f4\u7684\u5927\u5c0f\u4ec5\u53d7\u672c\u5730\u5185\u5b58\u9650\u5236\u3002 1.4 \u4ec0\u4e48\u662f\u865a\u62df\u673a\u6808 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 Java Virtual machine Stacks (java \u865a\u62df\u673a\u6808) \u6bcf\u4e2a\u7ebf\u7a0b\u8fd0\u884c\u65f6\u6240\u9700\u8981\u7684\u5185\u5b58\uff0c\u79f0\u4e3a\u865a\u62df\u673a\u6808\uff0c\u5148\u8fdb\u540e\u51fa \u6bcf\u4e2a\u6808\u7531\u591a\u4e2a\u6808\u5e27\uff08frame\uff09\u7ec4\u6210\uff0c\u5bf9\u5e94\u7740\u6bcf\u6b21\u65b9\u6cd5\u8c03\u7528\u65f6\u6240\u5360\u7528\u7684\u5185\u5b58 \u6bcf\u4e2a\u7ebf\u7a0b\u53ea\u80fd\u6709\u4e00\u4e2a\u6d3b\u52a8\u6808\u5e27\uff0c\u5bf9\u5e94\u7740\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u90a3\u4e2a\u65b9\u6cd5 \u5783\u573e\u56de\u6536\u662f\u5426\u6d89\u53ca\u6808\u5185\u5b58\uff1f \u5783\u573e\u56de\u6536\u4e3b\u8981\u6307\u5c31\u662f\u5806\u5185\u5b58\uff0c\u5f53\u6808\u5e27\u5f39\u6808\u4ee5\u540e\uff0c\u5185\u5b58\u5c31\u4f1a\u91ca\u653e \u6808\u5185\u5b58\u5206\u914d\u8d8a\u5927\u8d8a\u597d\u5417\uff1f \u672a\u5fc5\uff0c\u9ed8\u8ba4\u7684\u6808\u5185\u5b58\u901a\u5e38\u4e3a1024k \u6808\u5e27\u8fc7\u5927\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u6570\u53d8\u5c11\uff0c\u4f8b\u5982\uff0c\u673a\u5668\u603b\u5185\u5b58\u4e3a512m\uff0c\u76ee\u524d\u80fd\u6d3b\u52a8\u7684\u7ebf\u7a0b\u6570\u5219\u4e3a512\u4e2a\uff0c\u5982\u679c\u628a\u6808\u5185\u5b58\u6539\u4e3a2048k\uff0c\u90a3\u4e48\u80fd\u6d3b\u52a8\u7684\u6808\u5e27\u5c31\u4f1a\u51cf\u534a \u65b9\u6cd5\u5185\u7684\u5c40\u90e8\u53d8\u91cf\u662f\u5426\u7ebf\u7a0b\u5b89\u5168\uff1f \u5982\u679c\u65b9\u6cd5\u5185\u5c40\u90e8\u53d8\u91cf\u6ca1\u6709\u9003\u79bb\u65b9\u6cd5\u7684\u4f5c\u7528\u8303\u56f4\uff0c\u5b83\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u5982\u679c\u662f\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u4e86\u5bf9\u8c61\uff0c\u5e76\u9003\u79bb\u65b9\u6cd5\u7684\u4f5c\u7528\u8303\u56f4\uff0c\u9700\u8981\u8003\u8651\u7ebf\u7a0b\u5b89\u5168 \u6bd4\u5982\u4ee5\u4e0b\u4ee3\u7801\uff1a \u6808\u5185\u5b58\u6ea2\u51fa\u60c5\u51b5 \u6808\u5e27\u8fc7\u591a\u5bfc\u81f4\u6808\u5185\u5b58\u6ea2\u51fa\uff0c\u5178\u578b\u95ee\u9898\uff1a\u9012\u5f52\u8c03\u7528 \u6808\u5e27\u8fc7\u5927\u5bfc\u81f4\u6808\u5185\u5b58\u6ea2\u51fa \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7ec4\u6210\u90e8\u5206\uff1a\u5806\u3001\u65b9\u6cd5\u533a\u3001\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668 1\u3001\u5806\u89e3\u51b3\u7684\u662f\u5bf9\u8c61\u5b9e\u4f8b\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u5783\u573e\u56de\u6536\u5668\u7ba1\u7406\u7684\u4e3b\u8981\u533a\u57df\u3002 2\u3001\u65b9\u6cd5\u533a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5806\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u5b58\u50a8\u5df2\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u3002 3\u3001\u6808\u89e3\u51b3\u7684\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u95ee\u9898\uff0c\u6808\u91cc\u9762\u5b58\u7684\u662f\u6808\u5e27\uff0c\u6808\u5e27\u91cc\u9762\u5b58\u7684\u662f\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\u3001\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002 4\u3001\u672c\u5730\u65b9\u6cd5\u6808\u4e0e\u6808\u529f\u80fd\u76f8\u540c\uff0c\u672c\u5730\u65b9\u6cd5\u6808\u6267\u884c\u7684\u662f\u672c\u5730\u65b9\u6cd5\uff0c\u4e00\u4e2aJava\u8c03\u7528\u975eJava\u4ee3\u7801\u7684\u63a5\u53e3\u3002 5\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\u5bc4\u5b58\u5668\uff09\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u5b58\u653e\u7684\u662f\u5f53\u524d\u7ebf\u7a0b\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u6570\u3002JVM\u5de5\u4f5c\u65f6\u5c31\u662f\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u4e2a\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u3002 1.5 \u80fd\u4e0d\u80fd\u89e3\u91ca\u4e00\u4e0b\u65b9\u6cd5\u533a\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 1.5.1 \u6982\u8ff0 \u65b9\u6cd5\u533a(Method Area)\u662f\u5404\u4e2a\u7ebf\u7a0b\u5171\u4eab\u7684\u5185\u5b58\u533a\u57df \u4e3b\u8981\u5b58\u50a8\u7c7b\u7684\u4fe1\u606f\u3001\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60 \u865a\u62df\u673a\u542f\u52a8\u7684\u65f6\u5019\u521b\u5efa\uff0c\u5173\u95ed\u865a\u62df\u673a\u65f6\u91ca\u653e \u5982\u679c\u65b9\u6cd5\u533a\u57df\u4e2d\u7684\u5185\u5b58\u65e0\u6cd5\u6ee1\u8db3\u5206\u914d\u8bf7\u6c42\uff0c\u5219\u4f1a\u629b\u51faOutOfMemoryError: Metaspace 1.5.2 \u5e38\u91cf\u6c60 \u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u5f20\u8868\uff0c\u865a\u62df\u673a\u6307\u4ee4\u6839\u636e\u8fd9\u5f20\u5e38\u91cf\u8868\u627e\u5230\u8981\u6267\u884c\u7684\u7c7b\u540d\u3001\u65b9\u6cd5\u540d\u3001\u53c2\u6570\u7c7b\u578b\u3001\u5b57\u9762\u91cf\u7b49\u4fe1\u606f \u67e5\u770b\u5b57\u8282\u7801\u7ed3\u6784\uff08\u7c7b\u7684\u57fa\u672c\u4fe1\u606f\u3001\u5e38\u91cf\u6c60\u3001\u65b9\u6cd5\u5b9a\u4e49\uff09 javap -v xx.class \u6bd4\u5982\u4e0b\u9762\u662f\u4e00\u4e2aApplication\u7c7b\u7684main\u65b9\u6cd5\u6267\u884c\uff0c\u6e90\u7801\u5982\u4e0b\uff1a public class Application { public static void main(String[] args) { System.out.println(\"hello world\"); } } \u627e\u5230\u7c7b\u5bf9\u5e94\u7684class\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u6267\u884c\u547d\u4ee4\uff1a javap -v Application.class \u67e5\u770b\u5b57\u8282\u7801\u7ed3\u6784 D:\\code\\jvm-demo\\target\\classes\\com\\heima\\jvm>javap -v Application.class Classfile /D:/code/jvm-demo/target/classes/com/heima/jvm/Application.class Last modified 2023-05-07; size 564 bytes //\u6700\u540e\u4fee\u6539\u7684\u65f6\u95f4 MD5 checksum c1b64ed6491b9a16c2baab5061c64f88 //\u7b7e\u540d Compiled from \"Application.java\" //\u4ece\u54ea\u4e2a\u6e90\u7801\u7f16\u8bd1 public class com.heima.jvm.Application //\u5305\u540d\uff0c\u7c7b\u540d minor version: 0 major version: 52 //jdk\u7248\u672c flags: ACC_PUBLIC, ACC_SUPER //\u4fee\u9970\u7b26 Constant pool: //\u5e38\u91cf\u6c60 #1 = Methodref #6.#20 // java/lang/Object.\"<init>\":()V #2 = Fieldref #21.#22 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #23 // hello world #4 = Methodref #24.#25 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #26 // com/heima/jvm/Application #6 = Class #27 // java/lang/Object #7 = Utf8 <init> #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 LocalVariableTable #12 = Utf8 this #13 = Utf8 Lcom/heima/jvm/Application; #14 = Utf8 main #15 = Utf8 ([Ljava/lang/String;)V #16 = Utf8 args #17 = Utf8 [Ljava/lang/String; #18 = Utf8 SourceFile #19 = Utf8 Application.java #20 = NameAndType #7:#8 // \"<init>\":()V #21 = Class #28 // java/lang/System #22 = NameAndType #29:#30 // out:Ljava/io/PrintStream; #23 = Utf8 hello world #24 = Class #31 // java/io/PrintStream #25 = NameAndType #32:#33 // println:(Ljava/lang/String;)V #26 = Utf8 com/heima/jvm/Application #27 = Utf8 java/lang/Object #28 = Utf8 java/lang/System #29 = Utf8 out #30 = Utf8 Ljava/io/PrintStream; #31 = Utf8 java/io/PrintStream #32 = Utf8 println #33 = Utf8 (Ljava/lang/String;)V { public com.heima.jvm.Application(); //\u6784\u9020\u65b9\u6cd5 descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 // Method java/lang/Object.\"<init>\":()V 4: return LineNumberTable: line 3: 0 LocalVariableTable: Start Length Slot Name Signature 0 5 0 this Lcom/heima/jvm/Application; public static void main(java.lang.String[]); //main\u65b9\u6cd5 descriptor: ([Ljava/lang/String;)V flags: ACC_PUBLIC, ACC_STATIC Code: stack=2, locals=1, args_size=1 0: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 3: ldc #3 // String hello world 5: invokevirtual #4 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 8: return LineNumberTable: line 7: 0 line 8: 8 LocalVariableTable: Start Length Slot Name Signature 0 9 0 args [Ljava/lang/String; } SourceFile: \"Application.java\" \u4e0b\u56fe\uff0c\u5de6\u4fa7\u662fmain\u65b9\u6cd5\u7684\u6307\u4ee4\u4fe1\u606f\uff0c\u53f3\u4fa7constant pool \u662f\u5e38\u91cf\u6c60 main\u65b9\u6cd5\u6309\u7167\u6307\u4ee4\u6267\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u5230\u5e38\u91cf\u6c60\u4e2d\u67e5\u8868\u7ffb\u8bd1\u627e\u5230\u5177\u4f53\u7684\u7c7b\u548c\u65b9\u6cd5\u5730\u5740\u53bb\u6267\u884c 1.5.3 \u8fd0\u884c\u65f6\u5e38\u91cf\u6c60 \u5e38\u91cf\u6c60\u662f *.class \u6587\u4ef6\u4e2d\u7684\uff0c\u5f53\u8be5\u7c7b\u88ab\u52a0\u8f7d\uff0c\u5b83\u7684\u5e38\u91cf\u6c60\u4fe1\u606f\u5c31\u4f1a\u653e\u5165\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff0c\u5e76\u628a\u91cc\u9762\u7684\u7b26\u53f7\u5730\u5740\u53d8\u4e3a\u771f\u5b9e\u5730\u5740 1.6 \u4f60\u542c\u8fc7\u76f4\u63a5\u5185\u5b58\u5417\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e0d\u53d7 JVM \u5185\u5b58\u56de\u6536\u7ba1\u7406\uff0c\u662f\u865a\u62df\u673a\u7684\u7cfb\u7edf\u5185\u5b58\uff0c\u5e38\u89c1\u4e8e NIO \u64cd\u4f5c\u65f6\uff0c\u7528\u4e8e\u6570\u636e\u7f13\u51b2\u533a\uff0c\u5206\u914d\u56de\u6536\u6210\u672c\u8f83\u9ad8\uff0c\u4f46\u8bfb\u5199\u6027\u80fd\u9ad8\uff0c\u4e0d\u53d7 JVM \u5185\u5b58\u56de\u6536\u7ba1\u7406 \u4e3e\u4f8b\uff1a \u9700\u6c42\uff0c\u5728\u672c\u5730\u7535\u8111\u4e2d\u7684\u4e00\u4e2a\u8f83\u5927\u7684\u6587\u4ef6\uff08\u8d85\u8fc7100m\uff09\u4ece\u4e00\u4e2a\u78c1\u76d8\u632a\u5230\u53e6\u5916\u4e00\u4e2a\u78c1\u76d8 \u4ee3\u7801\u5982\u4e0b\uff1a /** * \u6f14\u793a ByteBuffer \u4f5c\u7528 */ public class Demo1_9 { static final String FROM = \"E:\\\\\u7f16\u7a0b\u8d44\u6599\\\\\u7b2c\u4e09\u65b9\u6559\u5b66\u89c6\u9891\\\\youtube\\\\Getting Started with Spring Boot-sbPSjI4tt10.mp4\"; static final String TO = \"E:\\\\a.mp4\"; static final int _1Mb = 1024 * 1024; public static void main(String[] args) { io(); // io \u7528\u65f6\uff1a1535.586957 1766.963399 1359.240226 directBuffer(); // directBuffer \u7528\u65f6\uff1a479.295165 702.291454 562.56592 } private static void directBuffer() { long start = System.nanoTime(); try (FileChannel from = new FileInputStream(FROM).getChannel(); FileChannel to = new FileOutputStream(TO).getChannel(); ) { ByteBuffer bb = ByteBuffer.allocateDirect(_1Mb); while (true) { int len = from.read(bb); if (len == -1) { break; } bb.flip(); to.write(bb); bb.clear(); } } catch (IOException e) { e.printStackTrace(); } long end = System.nanoTime(); System.out.println(\"directBuffer \u7528\u65f6\uff1a\" + (end - start) / 1000_000.0); } private static void io() { long start = System.nanoTime(); try (FileInputStream from = new FileInputStream(FROM); FileOutputStream to = new FileOutputStream(TO); ) { byte[] buf = new byte[_1Mb]; while (true) { int len = from.read(buf); if (len == -1) { break; } to.write(buf, 0, len); } } catch (IOException e) { e.printStackTrace(); } long end = System.nanoTime(); System.out.println(\"io \u7528\u65f6\uff1a\" + (end - start) / 1000_000.0); } } \u53ef\u4ee5\u53d1\u73b0\uff0c\u4f7f\u7528\u4f20\u7edf\u7684IO\u7684\u65f6\u95f4\u8981\u6bd4NIO\u64cd\u4f5c\u7684\u65f6\u95f4\u957f\u4e86\u5f88\u591a\u4e86\uff0c\u4e5f\u5c31\u8bf4NIO\u7684\u8bfb\u6027\u80fd\u66f4\u597d\u3002 \u8fd9\u4e2a\u662f\u8ddf\u6211\u4eec\u7684JVM\u7684\u76f4\u63a5\u5185\u5b58\u662f\u6709\u4e00\u5b9a\u5173\u7cfb\uff0c\u5982\u4e0b\u56fe\uff0c\u662f\u4f20\u7edf\u963b\u585eIO\u7684\u6570\u636e\u4f20\u8f93\u6d41\u7a0b \u4e0b\u56fe\u662fNIO\u4f20\u8f93\u6570\u636e\u7684\u6d41\u7a0b\uff0c\u5728\u8fd9\u4e2a\u91cc\u9762\u4e3b\u8981\u4f7f\u7528\u5230\u4e86\u4e00\u4e2a\u76f4\u63a5\u5185\u5b58\uff0c\u4e0d\u9700\u8981\u5728\u5806\u4e2d\u5f00\u8f9f\u7a7a\u95f4\u8fdb\u884c\u6570\u636e\u7684\u62f7\u8d1d\uff0cjvm\u53ef\u4ee5\u76f4\u63a5\u64cd\u4f5c\u76f4\u63a5\u5185\u5b58\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u8bfb\u5199\u4f20\u8f93\u66f4\u5feb\u3002 1.7 \u5806\u6808\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 1\u3001\u6808\u5185\u5b58\u4e00\u822c\u4f1a\u7528\u6765\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u548c\u65b9\u6cd5\u8c03\u7528\uff0c\u4f46\u5806\u5185\u5b58\u662f\u7528\u6765\u5b58\u50a8Java\u5bf9\u8c61\u548c\u6570\u7ec4\u7684\u7684\u3002\u5806\u4f1aGC\u5783\u573e\u56de\u6536\uff0c\u800c\u6808\u4e0d\u4f1a\u3002 2\u3001\u6808\u5185\u5b58\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u800c\u5806\u5185\u5b58\u662f\u7ebf\u7a0b\u5171\u6709\u7684\u3002 3,\u3001\u4e24\u8005\u5f02\u5e38\u9519\u8bef\u4e0d\u540c\uff0c\u4f46\u5982\u679c\u6808\u5185\u5b58\u6216\u8005\u5806\u5185\u5b58\u4e0d\u8db3\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\u3002 \u6808\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.StackOverFlowError\u3002 \u5806\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.OutOfMemoryError\u3002 2 \u7c7b\u52a0\u8f7d\u5668 2.1 \u4ec0\u4e48\u662f\u7c7b\u52a0\u8f7d\u5668\uff0c\u7c7b\u52a0\u8f7d\u5668\u6709\u54ea\u4e9b? \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u8981\u60f3\u7406\u89e3\u7c7b\u52a0\u8f7d\u5668\u7684\u8bdd\uff0c\u52a1\u5fc5\u8981\u5148\u6e05\u695a\u5bf9\u4e8e\u4e00\u4e2aJava\u6587\u4ef6\uff0c\u5b83\u4ece\u7f16\u8bd1\u5230\u6267\u884c\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002 \u7c7b\u52a0\u8f7d\u5668\uff1a\u7528\u4e8e\u88c5\u8f7d\u5b57\u8282\u7801\u6587\u4ef6(.class\u6587\u4ef6) \u8fd0\u884c\u65f6\u6570\u636e\u533a\uff1a\u7528\u4e8e\u5206\u914d\u5b58\u50a8\u7a7a\u95f4 \u6267\u884c\u5f15\u64ce\uff1a\u6267\u884c\u5b57\u8282\u7801\u6587\u4ef6\u6216\u672c\u5730\u65b9\u6cd5 \u5783\u573e\u56de\u6536\u5668\uff1a\u7528\u4e8e\u5bf9JVM\u4e2d\u7684\u5783\u573e\u5185\u5bb9\u8fdb\u884c\u56de\u6536 \u7c7b\u52a0\u8f7d\u5668 JVM\u53ea\u4f1a\u8fd0\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u800c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5c06 \u5b57\u8282\u7801\u6587\u4ef6\u52a0\u8f7d\u5230JVM\u4e2d \uff0c\u4ece\u800c\u8ba9Java\u7a0b\u5e8f\u80fd\u591f\u542f\u52a8\u8d77\u6765\u3002\u73b0\u6709\u7684\u7c7b\u52a0\u8f7d\u5668\u57fa\u672c\u4e0a\u90fd\u662fjava.lang.ClassLoader\u7684\u5b50\u7c7b\uff0c\u8be5\u7c7b\u7684\u53ea\u8981\u804c\u8d23\u5c31\u662f\u7528\u4e8e\u5c06\u6307\u5b9a\u7684\u7c7b\u627e\u5230\u6216\u751f\u6210\u5bf9\u5e94\u7684\u5b57\u8282\u7801\u6587\u4ef6\uff0c\u540c\u65f6\u7c7b\u52a0\u8f7d\u5668\u8fd8\u4f1a\u8d1f\u8d23\u52a0\u8f7d\u7a0b\u5e8f\u6240\u9700\u8981\u7684\u8d44\u6e90 \u7c7b\u52a0\u8f7d\u5668\u79cd\u7c7b \u7c7b\u52a0\u8f7d\u5668\u6839\u636e\u5404\u81ea\u52a0\u8f7d\u8303\u56f4\u7684\u4e0d\u540c\uff0c\u5212\u5206\u4e3a\u56db\u79cd\u7c7b\u52a0\u8f7d\u5668\uff1a \u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(BootStrap ClassLoader)\uff1a \u8be5\u7c7b\u5e76\u4e0d\u7ee7\u627fClassLoader\u7c7b\uff0c\u5176\u662f\u7531C++\u7f16\u5199\u5b9e\u73b0\u3002\u7528\u4e8e\u52a0\u8f7d JAVA_HOME/jre/lib \u76ee\u5f55\u4e0b\u7684\u7c7b\u5e93\u3002 \u6269\u5c55\u7c7b\u52a0\u8f7d\u5668(ExtClassLoader)\uff1a \u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u52a0\u8f7d JAVA_HOME/jre/lib/ext \u76ee\u5f55\u4e2d\u7684\u7c7b\u5e93\u3002 \u5e94\u7528\u7c7b\u52a0\u8f7d\u5668(AppClassLoader)\uff1a \u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u7528\u4e8e\u52a0\u8f7d classPath \u4e0b\u7684\u7c7b\uff0c\u4e5f\u5c31\u662f\u52a0\u8f7d\u5f00\u53d1\u8005\u81ea\u5df1\u7f16\u5199\u7684Java\u7c7b\u3002 \u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\uff1a \u5f00\u53d1\u8005\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627fClassLoader\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u89c4\u5219\u3002 \u4e0a\u8ff0\u4e09\u79cd\u7c7b\u52a0\u8f7d\u5668\u7684\u5c42\u6b21\u7ed3\u6784\u5982\u4e0b\u5982\u4e0b\uff1a \u7c7b\u52a0\u8f7d\u5668\u7684\u4f53\u7cfb\u5e76\u4e0d\u662f\u201c\u7ee7\u627f\u201d\u4f53\u7cfb\uff0c\u800c\u662f \u59d4\u6d3e\u4f53\u7cfb \uff0c\u7c7b\u52a0\u8f7d\u5668\u9996\u5148\u4f1a\u5230\u81ea\u5df1\u7684parent\u4e2d\u67e5\u627e\u7c7b\u6216\u8005\u8d44\u6e90\uff0c\u5982\u679c\u627e\u4e0d\u5230\u624d\u4f1a\u5230\u81ea\u5df1\u672c\u5730\u67e5\u627e\u3002\u7c7b\u52a0\u8f7d\u5668\u7684\u59d4\u6258\u884c\u4e3a\u52a8\u673a\u662f\u4e3a\u4e86\u907f\u514d\u76f8\u540c\u7684\u7c7b\u88ab\u52a0\u8f7d\u591a\u6b21\u3002 2.2 \u4ec0\u4e48\u662f\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u5982\u679c\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u5728\u63a5\u5230\u52a0\u8f7d\u7c7b\u7684\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u4e0d\u4f1a\u81ea\u5df1\u5c1d\u8bd5\u53bb\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\uff0c\u800c\u662f\u628a\u8fd9\u4e2a\u8bf7\u6c42\u4efb\u52a1\u59d4\u6258\u7ed9\u7236\u7c7b\u52a0\u8f7d\u5668\u53bb\u5b8c\u6210\uff0c\u4f9d\u6b21\u9012\u5f52\uff0c\u5982\u679c\u7236\u7c7b\u52a0\u8f7d\u5668\u53ef\u4ee5\u5b8c\u6210\u7c7b\u52a0\u8f7d\u4efb\u52a1\uff0c\u5c31\u8fd4\u56de\u6210\u529f\uff1b\u53ea\u6709\u7236\u7c7b\u52a0\u8f7d\u5668\u65e0\u6cd5\u5b8c\u6210\u6b64\u52a0\u8f7d\u4efb\u52a1\u65f6\uff0c\u624d\u7531\u4e0b\u4e00\u7ea7\u53bb\u52a0\u8f7d\u3002 2.3 JVM\u4e3a\u4ec0\u4e48\u91c7\u7528\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \uff081\uff09\u901a\u8fc7\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236\u53ef\u4ee5\u907f\u514d\u67d0\u4e00\u4e2a\u7c7b\u88ab\u91cd\u590d\u52a0\u8f7d\uff0c\u5f53\u7236\u7c7b\u5df2\u7ecf\u52a0\u8f7d\u540e\u5219\u65e0\u9700\u91cd\u590d\u52a0\u8f7d\uff0c\u4fdd\u8bc1\u552f\u4e00\u6027\u3002 \uff082\uff09\u4e3a\u4e86\u5b89\u5168\uff0c\u4fdd\u8bc1\u7c7b\u5e93API\u4e0d\u4f1a\u88ab\u4fee\u6539 \u5728\u5de5\u7a0b\u4e2d\u65b0\u5efajava.lang\u5305\uff0c\u63a5\u7740\u5728\u8be5\u5305\u4e0b\u65b0\u5efaString\u7c7b\uff0c\u5e76\u5b9a\u4e49main\u51fd\u6570 public class String { public static void main(String[] args) { System.out.println(\"demo info\"); } } \u200b \u6b64\u65f6\u6267\u884cmain\u51fd\u6570\uff0c\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u5728\u7c7b java.lang.String \u4e2d\u627e\u4e0d\u5230 main \u65b9\u6cd5 \u200b \u51fa\u73b0\u8be5\u4fe1\u606f\u662f\u56e0\u4e3a\u7531\u53cc\u4eb2\u59d4\u6d3e\u7684\u673a\u5236\uff0cjava.lang.String\u7684\u5728\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(Bootstrap classLoader)\u5f97\u5230\u52a0\u8f7d\uff0c\u56e0\u4e3a\u5728\u6838\u5fc3jre\u5e93\u4e2d\u6709\u5176\u76f8\u540c\u540d\u5b57\u7684\u7c7b\u6587\u4ef6\uff0c\u4f46\u8be5\u7c7b\u4e2d\u5e76\u6ca1\u6709main\u65b9\u6cd5\u3002\u8fd9\u6837\u5c31\u80fd\u9632\u6b62\u6076\u610f\u7be1\u6539\u6838\u5fc3API\u5e93\u3002 2.4 \u8bf4\u4e00\u4e0b\u7c7b\u88c5\u8f7d\u7684\u6267\u884c\u8fc7\u7a0b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7c7b\u4ece\u52a0\u8f7d\u5230\u865a\u62df\u673a\u4e2d\u5f00\u59cb\uff0c\u76f4\u5230\u5378\u8f7d\u4e3a\u6b62\uff0c\u5b83\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5305\u62ec\u4e86\uff1a\u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u89e3\u6790\u3001\u521d\u59cb\u5316\u3001\u4f7f\u7528\u548c\u5378\u8f7d\u8fd97\u4e2a\u9636\u6bb5\u3002\u5176\u4e2d\uff0c\u9a8c\u8bc1\u3001\u51c6\u5907\u548c\u89e3\u6790\u8fd9\u4e09\u4e2a\u90e8\u5206\u7edf\u79f0\u4e3a\u8fde\u63a5\uff08linking\uff09\u3002 \u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u8be6\u89e3 1.\u52a0\u8f7d \u901a\u8fc7\u7c7b\u7684\u5168\u540d\uff0c\u83b7\u53d6\u7c7b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\u3002 \u89e3\u6790\u7c7b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\u4e3a\u65b9\u6cd5\u533a\u5185\u7684\u6570\u636e\u7ed3\u6784\uff08Java\u7c7b\u6a21\u578b\uff09 \u521b\u5efajava.lang.Class\u7c7b\u7684\u5b9e\u4f8b\uff0c\u8868\u793a\u8be5\u7c7b\u578b\u3002\u4f5c\u4e3a\u65b9\u6cd5\u533a\u8fd9\u4e2a\u7c7b\u7684\u5404\u79cd\u6570\u636e\u7684\u8bbf\u95ee\u5165\u53e3 2.\u9a8c\u8bc1 \u9a8c\u8bc1\u7c7b\u662f\u5426\u7b26\u5408JVM\u89c4\u8303\uff0c\u5b89\u5168\u6027\u68c0\u67e5 (1)\u6587\u4ef6\u683c\u5f0f\u9a8c\u8bc1:\u662f\u5426\u7b26\u5408Class\u6587\u4ef6\u7684\u89c4\u8303 (2)\u5143\u6570\u636e\u9a8c\u8bc1 \u8fd9\u4e2a\u7c7b\u662f\u5426\u6709\u7236\u7c7b\uff08\u9664\u4e86Object\u8fd9\u4e2a\u7c7b\u4e4b\u5916\uff0c\u5176\u4f59\u7684\u7c7b\u90fd\u5e94\u8be5\u6709\u7236\u7c7b\uff09 \u8fd9\u4e2a\u7c7b\u662f\u5426\u7ee7\u627f\uff08extends\uff09\u4e86\u88abfinal\u4fee\u9970\u8fc7\u7684\u7c7b\uff08\u88abfinal\u4fee\u9970\u8fc7\u7684\u7c7b\u8868\u793a\u7c7b\u4e0d\u80fd\u88ab\u7ee7\u627f\uff09 \u7c7b\u4e2d\u7684\u5b57\u6bb5\u3001\u65b9\u6cd5\u662f\u5426\u4e0e\u7236\u7c7b\u4ea7\u751f\u77db\u76fe\u3002\uff08\u88abfinal\u4fee\u9970\u8fc7\u7684\u65b9\u6cd5\u6216\u5b57\u6bb5\u662f\u4e0d\u80fd\u8986\u76d6\u7684\uff09 (3)\u5b57\u8282\u7801\u9a8c\u8bc1 \u4e3b\u8981\u7684\u76ee\u7684\u662f\u901a\u8fc7\u5bf9\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u7684\u5206\u6790\uff0c\u786e\u5b9a\u7a0b\u5e8f\u8bed\u4e49\u662f\u5408\u6cd5\u7684\u3001\u7b26\u5408\u903b\u8f91\u7684\u3002 (4)\u7b26\u53f7\u5f15\u7528\u9a8c\u8bc1\uff1a\u7b26\u53f7\u5f15\u7528\u4ee5\u4e00\u7ec4\u7b26\u53f7\u6765\u63cf\u8ff0\u6240\u5f15\u7528\u7684\u76ee\u6807\uff0c\u7b26\u53f7\u53ef\u4ee5\u662f\u4efb\u4f55\u5f62\u5f0f\u7684\u5b57\u9762\u91cf \u6bd4\u5982\uff1aint i = 3; \u5b57\u9762\u91cf\uff1a3 \u7b26\u53f7\u5f15\u7528\uff1ai 3.\u51c6\u5907 \u4e3a\u7c7b\u53d8\u91cf\u5206\u914d\u5185\u5b58\u5e76\u8bbe\u7f6e\u7c7b\u53d8\u91cf\u521d\u59cb\u503c static\u53d8\u91cf\uff0c\u5206\u914d\u7a7a\u95f4\u5728\u51c6\u5907\u9636\u6bb5\u5b8c\u6210\uff08\u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff09\uff0c\u8d4b\u503c\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5b8c\u6210 static\u53d8\u91cf\u662ffinal\u7684\u57fa\u672c\u7c7b\u578b\uff0c\u4ee5\u53ca\u5b57\u7b26\u4e32\u5e38\u91cf\uff0c\u503c\u5df2\u786e\u5b9a\uff0c\u8d4b\u503c\u5728\u51c6\u5907\u9636\u6bb5\u5b8c\u6210 static\u53d8\u91cf\u662ffinal\u7684\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u4e48\u8d4b\u503c\u4e5f\u4f1a\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5b8c\u6210 4.\u89e3\u6790 \u628a\u7c7b\u4e2d\u7684\u7b26\u53f7\u5f15\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u5f15\u7528 \u6bd4\u5982\uff1a\u65b9\u6cd5\u4e2d\u8c03\u7528\u4e86\u5176\u4ed6\u65b9\u6cd5\uff0c\u65b9\u6cd5\u540d\u53ef\u4ee5\u7406\u89e3\u4e3a\u7b26\u53f7\u5f15\u7528\uff0c\u800c\u76f4\u63a5\u5f15\u7528\u5c31\u662f\u4f7f\u7528\u6307\u9488\u76f4\u63a5\u6307\u5411\u65b9\u6cd5\u3002 5.\u521d\u59cb\u5316 \u5bf9\u7c7b\u7684\u9759\u6001\u53d8\u91cf\uff0c\u9759\u6001\u4ee3\u7801\u5757\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c \u5982\u679c\u521d\u59cb\u5316\u4e00\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u5176\u7236\u7c7b\u5c1a\u672a\u521d\u59cb\u5316\uff0c\u5219\u4f18\u5148\u521d\u59cb\u5316\u5176\u7236\u7c7b\u3002 \u5982\u679c\u540c\u65f6\u5305\u542b\u591a\u4e2a\u9759\u6001\u53d8\u91cf\u548c\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5219\u6309\u7167\u81ea\u4e0a\u800c\u4e0b\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002 6.\u4f7f\u7528 JVM \u5f00\u59cb\u4ece\u5165\u53e3\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7528\u6237\u7684\u7a0b\u5e8f\u4ee3\u7801 \u8c03\u7528\u9759\u6001\u7c7b\u6210\u5458\u4fe1\u606f\uff08\u6bd4\u5982\uff1a\u9759\u6001\u5b57\u6bb5\u3001\u9759\u6001\u65b9\u6cd5\uff09 \u4f7f\u7528new\u5173\u952e\u5b57\u4e3a\u5176\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b 7.\u5378\u8f7d \u5f53\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u540e\uff0cJVM \u4fbf\u5f00\u59cb\u9500\u6bc1\u521b\u5efa\u7684 Class \u5bf9\u8c61\uff0c\u6700\u540e\u8d1f\u8d23\u8fd0\u884c\u7684 JVM \u4e5f\u9000\u51fa\u5185\u5b58 3 \u5783\u573e\u6536\u56de 3.1 \u7b80\u8ff0Java\u5783\u573e\u56de\u6536\u673a\u5236\uff1f\uff08GC\u662f\u4ec0\u4e48\uff1f\u4e3a\u4ec0\u4e48\u8981GC\uff09 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e3a\u4e86\u8ba9\u7a0b\u5e8f\u5458\u66f4\u4e13\u6ce8\u4e8e\u4ee3\u7801\u7684\u5b9e\u73b0\uff0c\u800c\u4e0d\u7528\u8fc7\u591a\u7684\u8003\u8651\u5185\u5b58\u91ca\u653e\u7684\u95ee\u9898\uff0c\u6240\u4ee5\uff0c\u5728Java\u8bed\u8a00\u4e2d\uff0c\u6709\u4e86\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u719f\u6089\u7684GC(Garbage Collection)\u3002 \u6709\u4e86\u5783\u573e\u56de\u6536\u673a\u5236\u540e\uff0c\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u5173\u5fc3\u5185\u5b58\u7684\u7533\u8bf7\u5373\u53ef\uff0c\u5185\u5b58\u7684\u91ca\u653e\u7531\u7cfb\u7edf\u81ea\u52a8\u8bc6\u522b\u5b8c\u6210\u3002 \u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\uff0cGC\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u56de\u6536\u65f6\u673a \u6362\u53e5\u8bdd\u8bf4\uff0c\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u7684\u7b97\u6cd5\u5c31\u4f1a\u53d8\u5f97\u975e\u5e38\u91cd\u8981\u4e86\uff0c\u5982\u679c\u56e0\u4e3a\u7b97\u6cd5\u7684\u4e0d\u5408\u7406\uff0c\u5bfc\u81f4\u5185\u5b58\u8d44\u6e90\u4e00\u76f4\u6ca1\u6709\u91ca\u653e\uff0c\u540c\u6837\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u7684\u3002 \u5f53\u7136\uff0c\u9664\u4e86Java\u8bed\u8a00\uff0cC#\u3001Python\u7b49\u8bed\u8a00\u4e5f\u90fd\u6709\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\u3002 3.2 \u5bf9\u8c61\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u88ab\u5783\u573e\u5668\u56de\u6536 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7b80\u5355\u4e00\u53e5\u5c31\u662f\uff1a\u5982\u679c\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u6ca1\u6709\u4efb\u4f55\u7684\u5f15\u7528\u6307\u5411\u5b83\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u73b0\u5728\u5c31\u662f\u5783\u573e\uff0c\u5982\u679c\u5b9a\u4f4d\u4e86\u5783\u573e\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u3002 \u5982\u679c\u8981\u5b9a\u4f4d\u4ec0\u4e48\u662f\u5783\u573e\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u786e\u5b9a\uff0c\u7b2c\u4e00\u4e2a\u662f\u5f15\u7528\u8ba1\u6570\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5 3.2.1 \u5f15\u7528\u8ba1\u6570\u6cd5 \u4e00\u4e2a\u5bf9\u8c61\u88ab\u5f15\u7528\u4e86\u4e00\u6b21\uff0c\u5728\u5f53\u524d\u7684\u5bf9\u8c61\u5934\u4e0a\u9012\u589e\u4e00\u6b21\u5f15\u7528\u6b21\u6570\uff0c\u5982\u679c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u6b21\u6570\u4e3a0\uff0c\u4ee3\u8868\u8fd9\u4e2a\u5bf9\u8c61\u53ef\u56de\u6536 String demo = new String(\"123\"); String demo = null; \u5f53\u5bf9\u8c61\u95f4\u51fa\u73b0\u4e86\u5faa\u73af\u5f15\u7528\u7684\u8bdd\uff0c\u5219\u5f15\u7528\u8ba1\u6570\u6cd5\u5c31\u4f1a\u5931\u6548 \u5148\u6267\u884c\u53f3\u4fa7\u4ee3\u7801\u7684\u524d4\u884c\u4ee3\u7801 \u76ee\u524d\u4e0a\u65b9\u7684\u5f15\u7528\u5173\u7cfb\u548c\u8ba1\u6570\u90fd\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u4f46\u662f\uff0c\u5982\u679c\u4ee3\u7801\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u4e0b\u56fe \u867d\u7136a\u548cb\u90fd\u4e3anull\uff0c\u4f46\u662f\u7531\u4e8ea\u548cb\u5b58\u5728\u5faa\u73af\u5f15\u7528\uff0c\u8fd9\u6837a\u548cb\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u88ab\u56de\u6536\u3002 \u4f18\u70b9\uff1a \u5b9e\u65f6\u6027\u8f83\u9ad8\uff0c\u65e0\u9700\u7b49\u5230\u5185\u5b58\u4e0d\u591f\u7684\u65f6\u5019\uff0c\u624d\u5f00\u59cb\u56de\u6536\uff0c\u8fd0\u884c\u65f6\u6839\u636e\u5bf9\u8c61\u7684\u8ba1\u6570\u5668\u662f\u5426\u4e3a0\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u56de\u6536\u3002 \u5728\u5783\u573e\u56de\u6536\u8fc7\u7a0b\u4e2d\uff0c\u5e94\u7528\u65e0\u9700\u6302\u8d77\u3002\u5982\u679c\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u5185\u5b58\u4e0d\u8db3\uff0c\u5219\u7acb\u523b\u62a5OOM\u9519\u8bef\u3002 \u533a\u57df\u6027\uff0c\u66f4\u65b0\u5bf9\u8c61\u7684\u8ba1\u6570\u5668\u65f6\uff0c\u53ea\u662f\u5f71\u54cd\u5230\u8be5\u5bf9\u8c61\uff0c\u4e0d\u4f1a\u626b\u63cf\u5168\u90e8\u5bf9\u8c61\u3002 \u7f3a\u70b9\uff1a \u6bcf\u6b21\u5bf9\u8c61\u88ab\u5f15\u7528\u65f6\uff0c\u90fd\u9700\u8981\u53bb\u66f4\u65b0\u8ba1\u6570\u5668\uff0c\u6709\u4e00\u70b9\u65f6\u95f4\u5f00\u9500\u3002 \u6d6a\u8d39CPU\u8d44\u6e90 \uff0c\u5373\u4f7f\u5185\u5b58\u591f\u7528\uff0c\u4ecd\u7136\u5728\u8fd0\u884c\u65f6\u8fdb\u884c\u8ba1\u6570\u5668\u7684\u7edf\u8ba1\u3002 \u65e0\u6cd5\u89e3\u51b3\u5faa\u73af\u5f15\u7528\u95ee\u9898\uff0c\u4f1a\u5f15\u53d1\u5185\u5b58\u6cc4\u9732 \u3002\uff08\u6700\u5927\u7684\u7f3a\u70b9\uff09 3.2.2 \u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5 \u200b \u73b0\u5728\u7684\u865a\u62df\u673a\u91c7\u7528\u7684\u90fd\u662f\u901a\u8fc7\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u6765\u786e\u5b9a\u54ea\u4e9b\u5185\u5bb9\u662f\u5783\u573e\u3002 \u200b \u4f1a\u5b58\u5728\u4e00\u4e2a\u6839\u8282\u70b9\u3010GC Roots\u3011\uff0c\u5f15\u51fa\u5b83\u4e0b\u9762\u6307\u5411\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\uff0c\u518d\u4ee5\u4e0b\u4e00\u4e2a\u8282\u70b9\u8282\u70b9\u5f00\u59cb\u627e\u51fa\u5b83\u4e0b\u9762\u7684\u8282\u70b9\uff0c\u4f9d\u6b21\u5f80\u4e0b\u7c7b\u63a8\u3002\u76f4\u5230\u6240\u6709\u7684\u8282\u70b9\u5168\u90e8\u904d\u5386\u5b8c\u6bd5\u3002 \u6839\u5bf9\u8c61\u662f\u90a3\u4e9b\u80af\u5b9a\u4e0d\u80fd\u5f53\u505a\u5783\u573e\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u5c31\u53ef\u4ee5\u5f53\u505a\u6839\u5bf9\u8c61 \u5c40\u90e8\u53d8\u91cf\uff0c\u9759\u6001\u65b9\u6cd5\uff0c\u9759\u6001\u53d8\u91cf\uff0c\u7c7b\u4fe1\u606f \u6838\u5fc3\u662f\uff1a\u5224\u65ad\u67d0\u5bf9\u8c61\u662f\u5426\u4e0e\u6839\u5bf9\u8c61\u6709\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5f15\u7528\uff0c\u5982\u679c\u6ca1\u6709\u88ab\u5f15\u7528\uff0c\u5219\u53ef\u4ee5\u5f53\u505a\u5783\u573e\u56de\u6536 \u200b X,Y\u8fd9\u4e24\u4e2a\u8282\u70b9\u662f\u53ef\u56de\u6536\u7684\uff0c\u4f46\u662f \u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u7684\u88ab\u56de\u6536\uff01\uff01 \u5bf9\u8c61\u4e2d\u5b58\u5728\u4e00\u4e2a\u65b9\u6cd5\u3010finalize\u3011\u3002\u5f53\u5bf9\u8c61\u88ab\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u540e\uff0c\u5f53\u53d1\u751fGC\u65f6\uff0c\u9996\u5148 \u4f1a\u5224\u65ad\u8fd9\u4e2a\u5bf9\u8c61\u662f\u5426\u6267\u884c\u4e86finalize\u65b9\u6cd5 \uff0c\u5982\u679c\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u6ca1\u6709\u88ab\u6267\u884c\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u4f1a\u5148\u6765\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u63a5\u7740\u5728\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5f53\u524d\u8fd9\u4e2a\u5bf9\u8c61\u4e0eGC ROOTS\u4ea7\u751f\u5173\u8054\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0cGC\u4f1a\u518d\u6b21\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u53ef\u8fbe\uff0c\u5982\u679c\u4ecd\u7136\u4e0d\u53ef\u8fbe\uff0c\u5219\u4f1a\u8fdb\u884c\u56de\u6536\uff0c\u5982\u679c\u53ef\u8fbe\u4e86\uff0c\u5219\u4e0d\u4f1a\u8fdb\u884c\u56de\u6536\u3002 \u200b finalize\u65b9\u6cd5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u6765\u8bf4\uff0c\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u3002\u5982\u679c\u7b2c\u4e00\u6b21\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4e86\u5f53\u524d\u5bf9\u8c61\u4e0eRC ROOTS\u5173\u8054\uff0c\u90a3\u4e48\u8fd9\u4e00\u6b21\u4e0d\u4f1a\u8fdb\u884c\u56de\u6536\u3002 \u90a3\u4e48\u7b49\u5230\u8fd9\u4e2a\u5bf9\u8c61\u7b2c\u4e8c\u6b21\u88ab\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u65f6\uff0c\u90a3\u4e48\u8be5\u5bf9\u8c61\u7684finalize\u65b9\u6cd5\u5c31\u4e0d\u4f1a\u518d\u6b21\u6267\u884c\u4e86\u3002 GC ROOTS\uff1a \u865a\u62df\u673a\u6808\uff08\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\u8868\uff09\u4e2d\u5f15\u7528\u7684\u5bf9\u8c61 /** * demo\u662f\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\uff0c\u5f53 demo = null \u65f6\uff0c\u7531\u4e8e\u6b64\u65f6 demo \u5145\u5f53\u4e86 GC Root \u7684\u4f5c\u7528\uff0cdemo\u4e0e\u539f\u6765\u6307\u5411\u7684\u5b9e\u4f8b new Demo() \u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u5bf9\u8c61\u88ab\u56de\u6536\u3002 */ public class Demo { public static void main(String[] args) { Demo demo = new Demo(); demo = null; } } \u65b9\u6cd5\u533a\u4e2d\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\u7684\u5bf9\u8c61 /** * \u5f53\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf b = null \u65f6\uff0c\u7531\u4e8e b \u539f\u6765\u6307\u5411\u7684\u5bf9\u8c61\u4e0e GC Root (\u53d8\u91cf b) \u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u6240\u4ee5 b \u539f\u6765\u6307\u5411\u7684\u5bf9\u8c61\u4f1a\u88ab\u56de\u6536\uff0c\u800c\u7531\u4e8e\u6211\u4eec\u7ed9 a \u8d4b\u503c\u4e86\u53d8\u91cf\u7684\u5f15\u7528\uff0ca\u5728\u6b64\u65f6\u662f\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\uff0c\u5145\u5f53\u4e86 GC Root \u7684\u4f5c\u7528\uff0c\u5b83\u6307\u5411\u7684\u5bf9\u8c61\u4f9d\u7136\u5b58\u6d3b! */ public class Demo { public static Demo a; public static void main(String[] args) { Demo b = new Demo(); b.a = new Demo(); b = null; } } \u65b9\u6cd5\u533a\u4e2d\u5e38\u91cf\u5f15\u7528\u7684\u5bf9\u8c61 /** * \u5e38\u91cf a \u6307\u5411\u7684\u5bf9\u8c61\u5e76\u4e0d\u4f1a\u56e0\u4e3a demo \u6307\u5411\u7684\u5bf9\u8c61\u88ab\u56de\u6536\u800c\u56de\u6536 */ public class Demo { public static final Demo a = new Demo(); public static void main(String[] args) { Demo demo = new Demo(); demo = null; } } \u672c\u5730\u65b9\u6cd5\u6808\u4e2d JNI\uff08\u5373\u4e00\u822c\u8bf4\u7684 Native \u65b9\u6cd5\uff09\u5f15\u7528\u7684\u5bf9\u8c61 3.3 JVM \u5783\u573e\u56de\u6536\u7b97\u6cd5\u6709\u54ea\u4e9b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 3.3.1 \u6807\u8bb0\u6e05\u9664\u7b97\u6cd5 \u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\uff0c\u662f\u5c06\u5783\u573e\u56de\u6536\u5206\u4e3a2\u4e2a\u9636\u6bb5\uff0c\u5206\u522b\u662f \u6807\u8bb0\u548c\u6e05\u9664 \u3002 1.\u6839\u636e\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u5f97\u51fa\u7684\u5783\u573e\u8fdb\u884c\u6807\u8bb0 2.\u5bf9\u8fd9\u4e9b\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u7684\u5185\u5bb9\u8fdb\u884c\u5783\u573e\u56de\u6536 \u53ef\u4ee5\u770b\u5230\uff0c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u89e3\u51b3\u4e86\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5\u4e2d\u7684\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\uff0c\u6ca1\u6709\u4eceroot\u8282\u70b9\u5f15\u7528\u7684\u5bf9\u8c61\u90fd\u4f1a\u88ab\u56de\u6536\u3002 \u540c\u6837\uff0c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u4e5f\u662f\u6709\u7f3a\u70b9\u7684\uff1a \u6548\u7387\u8f83\u4f4e\uff0c \u6807\u8bb0\u548c\u6e05\u9664\u4e24\u4e2a\u52a8\u4f5c\u90fd\u9700\u8981\u904d\u5386\u6240\u6709\u7684\u5bf9\u8c61 \uff0c\u5e76\u4e14\u5728GC\u65f6\uff0c \u9700\u8981\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f \uff0c\u5bf9\u4e8e\u4ea4\u4e92\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u5e94\u7528\u800c\u8a00\u8fd9\u4e2a\u4f53\u9a8c\u662f\u975e\u5e38\u5dee\u7684\u3002 \uff08 \u91cd\u8981 \uff09\u901a\u8fc7\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u6e05\u7406\u51fa\u6765\u7684\u5185\u5b58\uff0c\u788e\u7247\u5316\u8f83\u4e3a\u4e25\u91cd\uff0c\u56e0\u4e3a\u88ab\u56de\u6536\u7684\u5bf9\u8c61\u53ef\u80fd\u5b58\u5728\u4e8e\u5185\u5b58\u7684\u5404\u4e2a\u89d2\u843d\uff0c\u6240\u4ee5\u6e05\u7406\u51fa\u6765\u7684\u5185\u5b58\u662f\u4e0d\u8fde\u8d2f\u7684\u3002 3.3.2 \u590d\u5236\u7b97\u6cd5 \u200b \u590d\u5236\u7b97\u6cd5\u7684\u6838\u5fc3\u5c31\u662f\uff0c \u5c06\u539f\u6709\u7684\u5185\u5b58\u7a7a\u95f4\u4e00\u5206\u4e3a\u4e8c\uff0c\u6bcf\u6b21\u53ea\u7528\u5176\u4e2d\u7684\u4e00\u5757 \uff0c\u5728\u5783\u573e\u56de\u6536\u65f6\uff0c\u5c06\u6b63\u5728\u4f7f\u7528\u7684\u5bf9\u8c61\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u7136\u540e\u5c06\u8be5\u5185\u5b58\u7a7a\u95f4\u6e05\u7a7a\uff0c\u4ea4\u6362\u4e24\u4e2a\u5185\u5b58\u7684\u89d2\u8272\uff0c\u5b8c\u6210\u5783\u573e\u7684\u56de\u6536\u3002 \u200b \u5982\u679c\u5185\u5b58\u4e2d\u7684\u5783\u573e\u5bf9\u8c61\u8f83\u591a\uff0c\u9700\u8981\u590d\u5236\u7684\u5bf9\u8c61\u5c31\u8f83\u5c11\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u9002\u5408\u4f7f\u7528\u8be5\u65b9\u5f0f\u5e76\u4e14\u6548\u7387\u6bd4\u8f83\u9ad8\uff0c\u53cd\u4e4b\uff0c\u5219\u4e0d\u9002\u5408\u3002 1\uff09\u5c06\u5185\u5b58\u533a\u57df\u5206\u6210\u4e24\u90e8\u5206\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5176\u4e2d\u4e00\u4e2a\u3002 2\uff09\u5f53\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u5c06\u6b63\u5728\u4f7f\u7528\u7684\u5185\u5b58\u533a\u57df\u4e2d\u7684\u5b58\u6d3b\u5bf9\u8c61\u79fb\u52a8\u5230\u672a\u4f7f\u7528\u7684\u5185\u5b58\u533a\u57df\u3002\u5f53\u79fb\u52a8\u5b8c\u5bf9\u8fd9\u90e8\u5206\u5185\u5b58\u533a\u57df\u4e00\u6b21\u6027\u6e05\u9664\u3002 3\uff09\u5468\u800c\u590d\u59cb\u3002 \u4f18\u70b9\uff1a \u5728\u5783\u573e\u5bf9\u8c61\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u6548\u7387\u8f83\u9ad8 \u6e05\u7406\u540e\uff0c\u5185\u5b58\u65e0\u788e\u7247 \u7f3a\u70b9\uff1a \u5206\u914d\u76842\u5757\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u540c\u4e00\u4e2a\u65f6\u523b\uff0c\u53ea\u80fd\u4f7f\u7528\u4e00\u534a\uff0c\u5185\u5b58\u4f7f\u7528\u7387\u8f83\u4f4e 3.3.3 \u6807\u8bb0\u6574\u7406\u7b97\u6cd5 \u200b \u6807\u8bb0\u538b\u7f29\u7b97\u6cd5\u662f\u5728\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u505a\u4e86\u4f18\u5316\u6539\u8fdb\u7684\u7b97\u6cd5\u3002\u548c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u4e00\u6837\uff0c\u4e5f\u662f\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u5bf9\u5bf9\u8c61\u7684\u5f15\u7528\u8fdb\u884c\u6807\u8bb0\uff0c\u5728\u6e05\u7406\u9636\u6bb5\uff0c\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u76f4\u63a5\u6e05\u7406\u53ef\u56de\u6536\u5bf9\u8c61\uff0c\u800c\u662f\u5c06\u5b58\u6d3b\u5bf9\u8c61\u90fd\u5411\u5185\u5b58\u53e6\u4e00\u7aef\u79fb\u52a8\uff0c\u7136\u540e\u6e05\u7406\u8fb9\u754c\u4ee5\u5916\u7684\u5783\u573e\uff0c\u4ece\u800c\u89e3\u51b3\u4e86\u788e\u7247\u5316\u7684\u95ee\u9898\u3002 1\uff09\u6807\u8bb0\u5783\u573e\u3002 2\uff09\u9700\u8981\u6e05\u9664\u5411\u53f3\u8fb9\u8d70\uff0c\u4e0d\u9700\u8981\u6e05\u9664\u7684\u5411\u5de6\u8fb9\u8d70\u3002 3\uff09\u6e05\u9664\u8fb9\u754c\u4ee5\u5916\u7684\u5783\u573e\u3002 \u4f18\u7f3a\u70b9\u540c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\uff0c\u89e3\u51b3\u4e86\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u7684\u788e\u7247\u5316\u7684\u95ee\u9898\uff0c\u540c\u65f6\uff0c\u6807\u8bb0\u538b\u7f29\u7b97\u6cd5\u591a\u4e86\u4e00\u6b65\uff0c\u5bf9\u8c61\u79fb\u52a8\u5185\u5b58\u4f4d\u7f6e\u7684\u6b65\u9aa4\uff0c\u5176\u6548\u7387\u4e5f\u6709\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\u3002 \u4e0e\u590d\u5236\u7b97\u6cd5\u5bf9\u6bd4\uff1a\u590d\u5236\u7b97\u6cd5\u6807\u8bb0\u5b8c\u5c31\u590d\u5236\uff0c\u4f46\u6807\u8bb0\u6574\u7406\u7b97\u6cd5\u5f97\u7b49\u628a\u6240\u6709\u5b58\u6d3b\u5bf9\u8c61\u90fd\u6807\u8bb0\u5b8c\u6bd5\uff0c\u518d\u8fdb\u884c\u6574\u7406 3.4 \u5206\u4ee3\u6536\u96c6\u7b97\u6cd5 3.4.1 \u6982\u8ff0 \u5728java8\u65f6\uff0c\u5806\u88ab\u5206\u4e3a\u4e86\u4e24\u4efd\uff1a \u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\u30101\uff1a2\u3011 \uff0c\u5728java7\u65f6\uff0c\u8fd8\u5b58\u5728\u4e00\u4e2a\u6c38\u4e45\u4ee3\u3002 \u5bf9\u4e8e\u65b0\u751f\u4ee3\uff0c\u5185\u90e8\u53c8\u88ab\u5206\u4e3a\u4e86\u4e09\u4e2a\u533a\u57df\u3002Eden\u533a\uff0cS0\u533a\uff0cS1\u533a\u30108\uff1a1\uff1a1\u3011 \u5f53\u5bf9\u65b0\u751f\u4ee3\u4ea7\u751fGC\uff1aMinorGC\u3010young GC\u3011 \u5f53\u5bf9\u8001\u5e74\u4ee3\u4ee3\u4ea7\u751fGC\uff1aMajor GC \u5f53\u5bf9\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\u4ea7\u751fFullGC\uff1a \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff0c \u5e94\u5c3d\u529b\u907f\u514d 3.4.2\u5de5\u4f5c\u673a\u5236 \u65b0\u521b\u5efa\u7684\u5bf9\u8c61\uff0c\u90fd\u4f1a\u5148\u5206\u914d\u5230eden\u533a \u5f53\u4f0a\u7538\u56ed\u5185\u5b58\u4e0d\u8db3\uff0c\u6807\u8bb0\u4f0a\u7538\u56ed\u4e0e from\uff08\u73b0\u9636\u6bb5\u6ca1\u6709\uff09\u7684\u5b58\u6d3b\u5bf9\u8c61 \u5c06\u5b58\u6d3b\u5bf9\u8c61\u91c7\u7528\u590d\u5236\u7b97\u6cd5\u590d\u5236\u5230 to \u4e2d\uff0c\u590d\u5236\u5b8c\u6bd5\u540e\uff0c\u4f0a\u7538\u56ed\u548c from \u5185\u5b58\u90fd\u5f97\u5230\u91ca\u653e \u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u540e\u4f0a\u7538\u56ed\u7684\u5185\u5b58\u53c8\u51fa\u73b0\u4e0d\u8db3\uff0c\u6807\u8bb0eden\u533a\u57dfto\u533a\u5b58\u6d3b\u7684\u5bf9\u8c61\uff0c\u5c06\u5b58\u6d3b\u7684\u5bf9\u8c61\u590d\u5236\u5230from\u533a \u5f53\u5e78\u5b58\u533a\u5bf9\u8c61\u71ac\u8fc7\u51e0\u6b21\u56de\u6536\uff08\u6700\u591a15\u6b21\uff09\uff0c\u664b\u5347\u5230\u8001\u5e74\u4ee3\uff08\u5e78\u5b58\u533a\u5185\u5b58\u4e0d\u8db3\u6216\u5927\u5bf9\u8c61\u4f1a\u5bfc\u81f4\u63d0\u524d\u664b\u5347\uff09 MinorGC\u3001 Mixed GC \u3001 FullGC\u7684\u533a\u522b\u662f\u4ec0\u4e48 MinorGC\u3010young GC\u3011\u53d1\u751f\u5728\u65b0\u751f\u4ee3\u7684\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u77ed\uff08STW\uff09 Mixed GC \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u90e8\u5206\u533a\u57df\u7684\u5783\u573e\u56de\u6536\uff0cG1 \u6536\u96c6\u5668\u7279\u6709 FullGC\uff1a \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff08STW\uff09\uff0c\u5e94\u5c3d\u529b\u907f\u514d\uff1f \u540d\u8bcd\u89e3\u91ca\uff1a STW\uff08Stop-The-World\uff09\uff1a\u6682\u505c\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u7ebf\u7a0b\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210 3.5 \u8bf4\u4e00\u4e0b JVM \u6709\u54ea\u4e9b\u5783\u573e\u56de\u6536\u5668\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u5728jvm\u4e2d\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u5783\u573e\u6536\u96c6\u5668\uff0c\u5305\u62ec\uff1a \u4e32\u884c\u5783\u573e\u6536\u96c6\u5668 \u5e76\u884c\u5783\u573e\u6536\u96c6\u5668 CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668 G1\u5783\u573e\u6536\u96c6\u5668 3.5.1 \u4e32\u884c\u5783\u573e\u6536\u96c6\u5668 Serial\u548cSerial Old\u4e32\u884c\u5783\u573e\u6536\u96c6\u5668\uff0c\u662f\u6307\u4f7f\u7528\u5355\u7ebf\u7a0b\u8fdb\u884c\u5783\u573e\u56de\u6536\uff0c\u5806\u5185\u5b58\u8f83\u5c0f\uff0c\u9002\u5408\u4e2a\u4eba\u7535\u8111 Serial \u4f5c\u7528\u4e8e\u65b0\u751f\u4ee3\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5 Serial Old \u4f5c\u7528\u4e8e\u8001\u5e74\u4ee3\uff0c\u91c7\u7528\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5 \u5783\u573e\u56de\u6536\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5de5\u4f5c\uff0c\u5e76\u4e14java\u5e94\u7528\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u8981\u6682\u505c\uff08STW\uff09\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210\u3002 3.5.2 \u5e76\u884c\u5783\u573e\u6536\u96c6\u5668 Parallel New\u548cParallel Old\u662f\u4e00\u4e2a\u5e76\u884c\u5783\u573e\u56de\u6536\u5668\uff0c JDK8\u9ed8\u8ba4\u4f7f\u7528\u6b64\u5783\u573e\u56de\u6536\u5668 Parallel New\u4f5c\u7528\u4e8e\u65b0\u751f\u4ee3\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5 Parallel Old\u4f5c\u7528\u4e8e\u8001\u5e74\u4ee3\uff0c\u91c7\u7528\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5 \u5783\u573e\u56de\u6536\u65f6\uff0c\u591a\u4e2a\u7ebf\u7a0b\u5728\u5de5\u4f5c\uff0c\u5e76\u4e14java\u5e94\u7528\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u8981\u6682\u505c\uff08STW\uff09\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210\u3002 3.5.2 CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668 CMS\u5168\u79f0 Concurrent Mark Sweep\uff0c\u662f\u4e00\u6b3e\u5e76\u53d1\u7684\u3001\u4f7f\u7528\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5\u7684\u5783\u573e\u56de\u6536\u5668\uff0c\u8be5\u56de\u6536\u5668\u662f\u9488\u5bf9\u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u7684\uff0c\u662f\u4e00\u6b3e\u4ee5\u83b7\u53d6\u6700\u77ed\u56de\u6536\u505c\u987f\u65f6\u95f4\u4e3a\u76ee\u6807\u7684\u6536\u96c6\u5668\uff0c\u505c\u987f\u65f6\u95f4\u77ed\uff0c\u7528\u6237\u4f53\u9a8c\u5c31\u597d\u3002\u5176\u6700\u5927\u7279\u70b9\u662f\u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u5e94\u7528\u4ecd\u7136\u80fd\u6b63\u5e38\u8fd0\u884c\u3002 3.6 \u8be6\u7ec6\u804a\u4e00\u4e0bG1\u5783\u573e\u56de\u6536\u5668 \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 3.6.1 \u6982\u8ff0 \u5e94\u7528\u4e8e\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c \u5728 JDK9 \u4e4b\u540e\u9ed8\u8ba4\u4f7f\u7528 G1 \u5212\u5206\u6210\u591a\u4e2a\u533a\u57df\uff0c\u6bcf\u4e2a\u533a\u57df\u90fd\u53ef\u4ee5\u5145\u5f53 eden\uff0csurvivor\uff0cold\uff0c humongous\uff0c\u5176\u4e2d humongous \u4e13\u4e3a\u5927\u5bf9\u8c61\u51c6\u5907 \u91c7\u7528\u590d\u5236\u7b97\u6cd5 \u54cd\u5e94\u65f6\u95f4\u4e0e\u541e\u5410\u91cf\u517c\u987e \u5206\u6210\u4e09\u4e2a\u9636\u6bb5\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u3001\u5e76\u53d1\u6807\u8bb0\u3001\u6df7\u5408\u6536\u96c6 \u5982\u679c\u5e76\u53d1\u5931\u8d25\uff08\u5373\u56de\u6536\u901f\u5ea6\u8d76\u4e0d\u4e0a\u521b\u5efa\u65b0\u5bf9\u8c61\u901f\u5ea6\uff09\uff0c\u4f1a\u89e6\u53d1 Full GC 3.6.2 Young Collection(\u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536) \u521d\u59cb\u65f6\uff0c\u6240\u6709\u533a\u57df\u90fd\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001 \u521b\u5efa\u4e86\u4e00\u4e9b\u5bf9\u8c61\uff0c\u6311\u51fa\u4e00\u4e9b\u7a7a\u95f2\u533a\u57df\u4f5c\u4e3a\u4f0a\u7538\u56ed\u533a\u5b58\u50a8\u8fd9\u4e9b\u5bf9\u8c61 \u5f53\u4f0a\u7538\u56ed\u9700\u8981\u5783\u573e\u56de\u6536\u65f6\uff0c\u6311\u51fa\u4e00\u4e2a\u7a7a\u95f2\u533a\u57df\u4f5c\u4e3a\u5e78\u5b58\u533a\uff0c\u7528\u590d\u5236\u7b97\u6cd5\u590d\u5236\u5b58\u6d3b\u5bf9\u8c61\uff0c\u9700\u8981\u6682\u505c\u7528\u6237\u7ebf\u7a0b \u968f\u7740\u65f6\u95f4\u6d41\u901d\uff0c\u4f0a\u7538\u56ed\u7684\u5185\u5b58\u53c8\u6709\u4e0d\u8db3 \u5c06\u4f0a\u7538\u56ed\u4ee5\u53ca\u4e4b\u524d\u5e78\u5b58\u533a\u4e2d\u7684\u5b58\u6d3b\u5bf9\u8c61\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5\uff0c\u590d\u5236\u5230\u65b0\u7684\u5e78\u5b58\u533a\uff0c\u5176\u4e2d\u8f83\u8001\u5bf9\u8c61\u664b\u5347\u81f3\u8001\u5e74\u4ee3 3.6.3 Young Collection + Concurrent Mark (\u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536+\u5e76\u53d1\u6807\u8bb0) \u5f53\u8001\u5e74\u4ee3\u5360\u7528\u5185\u5b58\u8d85\u8fc7\u9608\u503c(\u9ed8\u8ba4\u662f45%)\u540e\uff0c\u89e6\u53d1\u5e76\u53d1\u6807\u8bb0\uff0c\u8fd9\u65f6\u65e0\u9700\u6682\u505c\u7528\u6237\u7ebf\u7a0b \u5e76\u53d1\u6807\u8bb0\u4e4b\u540e\uff0c\u4f1a\u6709\u91cd\u65b0\u6807\u8bb0\u9636\u6bb5\u89e3\u51b3\u6f0f\u6807\u95ee\u9898\uff0c\u6b64\u65f6\u9700\u8981\u6682\u505c\u7528\u6237\u7ebf\u7a0b\u3002 \u8fd9\u4e9b\u90fd\u5b8c\u6210\u540e\u5c31\u77e5\u9053\u4e86\u8001\u5e74\u4ee3\u6709\u54ea\u4e9b\u5b58\u6d3b\u5bf9\u8c61\uff0c\u968f\u540e\u8fdb\u5165\u6df7\u5408\u6536\u96c6\u9636\u6bb5\u3002\u6b64\u65f6\u4e0d\u4f1a\u5bf9\u6240\u6709\u8001\u5e74\u4ee3\u533a\u57df\u8fdb\u884c\u56de\u6536\uff0c\u800c\u662f\u6839\u636e\u6682\u505c\u65f6\u95f4\u76ee\u6807\u4f18\u5148\u56de\u6536\u4ef7\u503c\u9ad8\uff08\u5b58\u6d3b\u5bf9\u8c61\u5c11\uff09\u7684\u533a\u57df\uff08\u8fd9\u4e5f\u662f Gabage First \u540d\u79f0\u7684\u7531\u6765\uff09\u3002 3.6.4 Mixed Collection (\u6df7\u5408\u5783\u573e\u56de\u6536) \u590d\u5236\u5b8c\u6210\uff0c\u5185\u5b58\u5f97\u5230\u91ca\u653e\u3002\u8fdb\u5165\u4e0b\u4e00\u8f6e\u7684\u65b0\u751f\u4ee3\u56de\u6536\u3001\u5e76\u53d1\u6807\u8bb0\u3001\u6df7\u5408\u6536\u96c6 \u5176\u4e2dH\u53eb\u505a\u5de8\u578b\u5bf9\u8c61\uff0c\u5982\u679c\u5bf9\u8c61\u975e\u5e38\u5927\uff0c\u4f1a\u5f00\u8f9f\u4e00\u5757\u8fde\u7eed\u7684\u7a7a\u95f4\u5b58\u50a8\u5de8\u578b\u5bf9\u8c61 3.7 \u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528\u7684\u533a\u522b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 3.7.1 \u5f3a\u5f15\u7528 \u5f3a\u5f15\u7528\uff1a\u53ea\u6709\u6240\u6709 GC Roots \u5bf9\u8c61\u90fd\u4e0d\u901a\u8fc7\u3010\u5f3a\u5f15\u7528\u3011\u5f15\u7528\u8be5\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u624d\u80fd\u88ab\u5783\u573e\u56de\u6536 User user = new User(); 3.7.2 \u8f6f\u5f15\u7528 \u8f6f\u5f15\u7528\uff1a\u4ec5\u6709\u8f6f\u5f15\u7528\u5f15\u7528\u8be5\u5bf9\u8c61\u65f6\uff0c\u5728\u5783\u573e\u56de\u6536\u540e\uff0c\u5185\u5b58\u4ecd\u4e0d\u8db3\u65f6\u4f1a\u518d\u6b21\u51fa\u53d1\u5783\u573e\u56de\u6536 User user = new User(); SoftReference softReference = new SoftReference(user); 3.7.3 \u5f31\u5f15\u7528 \u5f31\u5f15\u7528\uff1a\u4ec5\u6709\u5f31\u5f15\u7528\u5f15\u7528\u8be5\u5bf9\u8c61\u65f6\uff0c\u5728\u5783\u573e\u56de\u6536\u65f6\uff0c\u65e0\u8bba\u5185\u5b58\u662f\u5426\u5145\u8db3\uff0c\u90fd\u4f1a\u56de\u6536\u5f31\u5f15\u7528\u5bf9\u8c61 User user = new User(); WeakReference weakReference = new WeakReference(user); \u5ef6\u4f38\u8bdd\u9898\uff1aThreadLocal\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898 ThreadLocal\u7528\u7684\u5c31\u662f\u5f31\u5f15\u7528\uff0c\u770b\u4ee5\u4e0b\u6e90\u7801\uff1a static class Entry extends WeakReference<ThreadLocal<?>> { Object value; Entry(ThreadLocal<?> k, Object v) { super(k); value = v; //\u5f3a\u5f15\u7528\uff0c\u4e0d\u4f1a\u88ab\u56de\u6536 } } Entry \u7684key\u662f\u5f53\u524dThreadLocal\uff0cvalue\u503c\u662f\u6211\u4eec\u8981\u8bbe\u7f6e\u7684\u6570\u636e\u3002 WeakReference \u8868\u793a\u7684\u662f\u5f31\u5f15\u7528\uff0c\u5f53JVM\u8fdb\u884cGC\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u4e86\u53ea\u5177\u6709\u5f31\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4e0d\u7ba1\u5f53\u524d\u5185\u5b58\u7a7a\u95f4\u662f\u5426\u8db3\u591f\uff0c\u90fd\u4f1a\u56de\u6536\u5b83\u7684\u5185\u5b58\u3002\u4f46\u662f value \u662f\u5f3a\u5f15\u7528\uff0c\u5b83\u4e0d\u4f1a\u88ab\u56de\u6536\u6389\u3002 ThreadLocal\u4f7f\u7528\u5efa\u8bae\uff1a\u4f7f\u7528\u5b8c\u6bd5\u540e\u6ce8\u610f\u8c03\u7528\u6e05\u7406\u65b9\u6cd5\u3002 3.7.4 \u865a\u5f15\u7528 \u865a\u5f15\u7528\uff1a\u5fc5\u987b\u914d\u5408\u5f15\u7528\u961f\u5217\u4f7f\u7528\uff0c\u88ab\u5f15\u7528\u5bf9\u8c61\u56de\u6536\u65f6\uff0c\u4f1a\u5c06\u865a\u5f15\u7528\u5165\u961f\uff0c\u7531 Reference Handler \u7ebf\u7a0b\u8c03\u7528\u865a\u5f15\u7528\u76f8\u5173\u65b9\u6cd5\u91ca\u653e\u76f4\u63a5\u5185\u5b58 4 JVM\u5b9e\u8df5\uff08\u8c03\u4f18\uff09 4.1 JVM \u8c03\u4f18\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u54ea\u91cc\u8bbe\u7f6e\u53c2\u6570\u503c\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 4.1.1 tomcat\u7684\u8bbe\u7f6evm\u53c2\u6570 \u4fee\u6539TOMCAT_HOME/bin/catalina.sh\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe JAVA_OPTS=\"-Xms512m -Xmx1024m\" 4.1.2 springboot\u9879\u76eejar\u6587\u4ef6\u542f\u52a8 \u901a\u5e38\u5728linux\u7cfb\u7edf\u4e0b\u76f4\u63a5\u52a0\u53c2\u6570\u542f\u52a8springboot\u9879\u76ee nohup java -Xms512m -Xmx1024m -jar xxxx.jar --spring.profiles.active=prod & nohup : \u7528\u4e8e\u5728\u7cfb\u7edf\u540e\u53f0\u4e0d\u6302\u65ad\u5730\u8fd0\u884c\u547d\u4ee4\uff0c\u9000\u51fa\u7ec8\u7aef\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c \u53c2\u6570 & \uff1a\u8ba9\u547d\u4ee4\u5728\u540e\u53f0\u6267\u884c\uff0c\u7ec8\u7aef\u9000\u51fa\u540e\u547d\u4ee4\u4ecd\u65e7\u6267\u884c\u3002 4.2 \u7528\u7684 JVM \u8c03\u4f18\u7684\u53c2\u6570\u90fd\u6709\u54ea\u4e9b\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u200b \u5bf9\u4e8eJVM\u8c03\u4f18\uff0c\u4e3b\u8981\u5c31\u662f\u8c03\u6574\u5e74\u8f7b\u4ee3\u3001\u5e74\u8001\u5927\u3001\u5143\u7a7a\u95f4\u7684\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\u53ca\u4f7f\u7528\u7684\u5783\u573e\u56de\u6536\u5668\u7c7b\u578b\u3002 https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html 1\uff09\u8bbe\u7f6e\u5806\u7684\u521d\u59cb\u5927\u5c0f\u548c\u6700\u5927\u5927\u5c0f\uff0c\u4e3a\u4e86\u9632\u6b62\u5783\u573e\u6536\u96c6\u5668\u5728\u521d\u59cb\u5927\u5c0f\u3001\u6700\u5927\u5927\u5c0f\u4e4b\u95f4\u6536\u7f29\u5806\u800c\u4ea7\u751f\u989d\u5916\u7684\u65f6\u95f4\uff0c\u901a\u5e38\u628a\u6700\u5927\u3001\u521d\u59cb\u5927\u5c0f\u8bbe\u7f6e\u4e3a\u76f8\u540c\u7684\u503c\u3002 -Xms\uff1a\u8bbe\u7f6e\u5806\u7684\u521d\u59cb\u5316\u5927\u5c0f -Xmx\uff1a\u8bbe\u7f6e\u5806\u7684\u6700\u5927\u5927\u5c0f 2\uff09 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u548c\u4e24\u4e2aSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u4f8b\u3002\u8be5\u503c\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u5219\u9ed8\u8ba4\u6bd4\u4f8b\u4e3a8:1:1\u3002Java\u5b98\u65b9\u901a\u8fc7\u589e\u5927Eden\u533a\u7684\u5927\u5c0f\uff0c\u6765\u51cf\u5c11YGC\u53d1\u751f\u7684\u6b21\u6570\uff0c\u4f46\u6709\u65f6\u6211\u4eec\u53d1\u73b0\uff0c\u867d\u7136\u6b21\u6570\u51cf\u5c11\u4e86\uff0c\u4f46Eden\u533a\u6ee1 \u7684\u65f6\u5019\uff0c\u7531\u4e8e\u5360\u7528\u7684\u7a7a\u95f4\u8f83\u5927\uff0c\u5bfc\u81f4\u91ca\u653e\u7f13\u6162\uff0c\u6b64\u65f6STW\u7684\u65f6\u95f4\u8f83\u957f\uff0c\u56e0\u6b64\u9700\u8981\u6309\u7167\u7a0b\u5e8f\u60c5\u51b5\u53bb\u8c03\u4f18\u3002 -XXSurvivorRatio=3\uff0c\u8868\u793a\u5e74\u8f7b\u4ee3\u4e2d\u7684\u5206\u914d\u6bd4\u7387\uff1asurvivor:eden = 2:3 3\uff09\u5e74\u8f7b\u4ee3\u548c\u8001\u5e74\u4ee3\u9ed8\u8ba4\u6bd4\u4f8b\u4e3a1\uff1a2\u3002\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u4e8c\u8005\u7a7a\u95f4\u5927\u5c0f\u6bd4\u7387\u6765\u8bbe\u7f6e\u4e24\u8005\u7684\u5927\u5c0f\u3002 -XX:newSize \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u521d\u59cb\u5927\u5c0f -XX:MaxNewSize \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u6700\u5927\u5927\u5c0f\uff0c \u521d\u59cb\u5927\u5c0f\u548c\u6700\u5927\u5927\u5c0f\u4e24\u4e2a\u503c\u901a\u5e38\u76f8\u540c 4\uff09\u7ebf\u7a0b\u5806\u6808\u7684\u8bbe\u7f6e\uff1a \u6bcf\u4e2a\u7ebf\u7a0b\u9ed8\u8ba4\u4f1a\u5f00\u542f1M\u7684\u5806\u6808 \uff0c\u7528\u4e8e\u5b58\u653e\u6808\u5e27\u3001\u8c03\u7528\u53c2\u6570\u3001\u5c40\u90e8\u53d8\u91cf\u7b49\uff0c\u4f46\u4e00\u822c256K\u5c31\u591f\u7528\u3002\u901a\u5e38\u51cf\u5c11\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5806\u6808\uff0c\u53ef\u4ee5\u4ea7\u751f\u66f4\u591a\u7684\u7ebf\u7a0b\uff0c\u4f46\u8fd9\u5b9e\u9645\u4e0a\u8fd8\u53d7\u9650\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u3002 -Xss \u5bf9\u6bcf\u4e2a\u7ebf\u7a0bstack\u5927\u5c0f\u7684\u8c03\u6574,-Xss128k 5\uff09\u4e00\u822c\u6765\u8bf4\uff0c\u5f53survivor\u533a\u4e0d\u591f\u5927\u6216\u8005\u5360\u7528\u91cf\u8fbe\u523050%\uff0c\u5c31\u4f1a\u628a\u4e00\u4e9b\u5bf9\u8c61\u653e\u5230\u8001\u5e74\u533a\u3002\u901a\u8fc7\u8bbe\u7f6e\u5408\u7406\u7684eden\u533a\uff0csurvivor\u533a\u53ca\u4f7f\u7528\u7387\uff0c\u53ef\u4ee5\u5c06\u5e74\u8f7b\u5bf9\u8c61\u4fdd\u5b58\u5728\u5e74\u8f7b\u4ee3\uff0c\u4ece\u800c\u907f\u514dfull GC\uff0c\u4f7f\u7528-Xmn\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u5927\u5c0f 6\uff09\u7cfb\u7edfCPU\u6301\u7eed\u98d9\u9ad8\u7684\u8bdd\uff0c\u9996\u5148\u5148\u6392\u67e5\u4ee3\u7801\u95ee\u9898\uff0c\u5982\u679c\u4ee3\u7801\u6ca1\u95ee\u9898\uff0c\u5219\u54a8\u8be2\u8fd0\u7ef4\u6216\u8005\u4e91\u670d\u52a1\u5668\u4f9b\u5e94\u5546\uff0c\u901a\u5e38\u670d\u52a1\u5668\u91cd\u542f\u6216\u8005\u670d\u52a1\u5668\u8fc1\u79fb\u5373\u53ef\u89e3\u51b3\u3002 7\uff09\u5bf9\u4e8e\u5360\u7528\u5185\u5b58\u6bd4\u8f83\u591a\u7684\u5927\u5bf9\u8c61\uff0c\u4e00\u822c\u4f1a\u9009\u62e9\u5728\u8001\u5e74\u4ee3\u5206\u914d\u5185\u5b58\u3002\u5982\u679c\u5728\u5e74\u8f7b\u4ee3\u7ed9\u5927\u5bf9\u8c61\u5206\u914d\u5185\u5b58\uff0c\u5e74\u8f7b\u4ee3\u5185\u5b58\u4e0d\u591f\u4e86\uff0c\u5c31\u8981\u5728eden\u533a\u79fb\u52a8\u5927\u91cf\u5bf9\u8c61\u5230\u8001\u5e74\u4ee3\uff0c\u7136\u540e\u8fd9\u4e9b\u79fb\u52a8\u7684\u5bf9\u8c61\u53ef\u80fd\u5f88\u5feb\u6d88\u4ea1\uff0c\u56e0\u6b64\u5bfc\u81f4full GC\u3002\u901a\u8fc7\u8bbe\u7f6e\u53c2\u6570\uff1a-XX:PetenureSizeThreshold=1000000\uff0c\u5355\u4f4d\u4e3aB\uff0c\u6807\u660e\u5bf9\u8c61\u5927\u5c0f\u8d85\u8fc71M\u65f6\uff0c\u5728\u8001\u5e74\u4ee3(tenured)\u5206\u914d\u5185\u5b58\u7a7a\u95f4\u3002 8\uff09\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5e74\u8f7b\u5bf9\u8c61\u653e\u5728eden\u533a\uff0c\u5f53\u7b2c\u4e00\u6b21GC\u540e\uff0c\u5982\u679c\u5bf9\u8c61\u8fd8\u5b58\u6d3b\uff0c\u653e\u5230survivor\u533a\uff0c\u6b64\u540e\uff0c\u6bcfGC\u4e00\u6b21\uff0c\u5e74\u9f84\u589e\u52a01\uff0c\u5f53\u5bf9\u8c61\u7684\u5e74\u9f84\u8fbe\u5230\u9608\u503c\uff0c\u5c31\u88ab\u653e\u5230tenured\u8001\u5e74\u533a\u3002\u8fd9\u4e2a\u9608\u503c\u53ef\u4ee5\u540c\u6784-XX:MaxTenuringThreshold\u8bbe\u7f6e\u3002\u5982\u679c\u60f3\u8ba9\u5bf9\u8c61\u7559\u5728\u5e74\u8f7b\u4ee3\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6bd4\u8f83\u5927\u7684\u9608\u503c\u3002 \uff081\uff09-XX:+UseParallelGC:\u5e74\u8f7b\u4ee3\u4f7f\u7528\u5e76\u884c\u5783\u573e\u56de\u6536\u6536\u96c6\u5668\u3002\u8fd9\u662f\u4e00\u4e2a\u5173\u6ce8\u541e\u5410\u91cf\u7684\u6536\u96c6\u5668\uff0c\u53ef\u4ee5\u5c3d\u53ef\u80fd\u7684\u51cf\u5c11\u5783\u573e\u56de\u6536\u65f6\u95f4\u3002 \uff082\uff09-XX:+UseParallelOldGC:\u8bbe\u7f6e\u8001\u5e74\u4ee3\u4f7f\u7528\u5e76\u884c\u5783\u573e\u56de\u6536\u6536\u96c6\u5668\u3002 9\uff09\u5c1d\u8bd5\u4f7f\u7528\u5927\u7684\u5185\u5b58\u5206\u9875\uff1a\u4f7f\u7528\u5927\u7684\u5185\u5b58\u5206\u9875\u589e\u52a0CPU\u7684\u5185\u5b58\u5bfb\u5740\u80fd\u529b\uff0c\u4ece\u800c\u7cfb\u7edf\u7684\u6027\u80fd\u3002 -XX:+LargePageSizeInBytes \u8bbe\u7f6e\u5185\u5b58\u9875\u7684\u5927\u5c0f 10\uff09\u4f7f\u7528\u975e\u5360\u7528\u7684\u5783\u573e\u6536\u96c6\u5668\u3002 -XX:+UseConcMarkSweepGC\u8001\u5e74\u4ee3\u4f7f\u7528CMS\u6536\u96c6\u5668\u964d\u4f4e\u505c\u987f\u3002 4.3 \u8bf4\u4e00\u4e0b JVM \u8c03\u4f18\u7684\u5de5\u5177\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 4.3.1 \u547d\u4ee4\u5de5\u5177 4.3.1.1 jps\uff08Java Process Status\uff09 \u8f93\u51faJVM\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f(\u73b0\u5728\u4e00\u822c\u4f7f\u7528jconsole) 4.3.1.2 jstack \u67e5\u770bjava\u8fdb\u7a0b\u5185 \u7ebf\u7a0b\u7684\u5806\u6808 \u4fe1\u606f\u3002 jstack [option] <pid> java\u6848\u4f8b package com.heima.jvm; public class Application { public static void main(String[] args) throws InterruptedException { while (true){ Thread.sleep(1000); System.out.println(\"\u54c8\u54c8\u54c8\"); } } } \u4f7f\u7528jstack\u67e5\u770b\u8fdb\u884c\u5806\u6808\u8fd0\u884c\u4fe1\u606f 4.3.1.3 jmap \u7528\u4e8e\u751f\u6210\u5806\u8f6c\u5b58\u5feb\u7167 jmap [options] pid \u5185\u5b58\u6620\u50cf\u4fe1\u606f jmap -heap pid \u663e\u793aJava\u5806\u7684\u4fe1\u606f jmap -dump:format=b,file=heap.hprof pid \u200b format=b\u8868\u793a\u4ee5hprof\u4e8c\u8fdb\u5236\u683c\u5f0f\u8f6c\u50a8Java\u5806\u7684\u5185\u5b58 \u200b file= \u7528\u4e8e\u6307\u5b9a\u5feb\u7167dump\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u3002 \u4f8b\uff1a\u663e\u793a\u4e86\u67d0\u4e00\u4e2ajava\u8fd0\u884c\u7684\u5806\u4fe1\u606f C:\\Users\\yuhon>jmap -heap 53280 Attaching to process ID 53280, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.321-b07 using thread-local object allocation. Parallel GC with 8 thread(s) //\u5e76\u884c\u7684\u5783\u573e\u56de\u6536\u5668 Heap Configuration: //\u5806\u914d\u7f6e MinHeapFreeRatio = 0 //\u7a7a\u95f2\u5806\u7a7a\u95f4\u7684\u6700\u5c0f\u767e\u5206\u6bd4 MaxHeapFreeRatio = 100 //\u7a7a\u95f2\u5806\u7a7a\u95f4\u7684\u6700\u5927\u767e\u5206\u6bd4 MaxHeapSize = 8524922880 (8130.0MB) //\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c NewSize = 178257920 (170.0MB) //\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c MaxNewSize = 2841640960 (2710.0MB) //\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c OldSize = 356515840 (340.0MB) //\u8001\u5e74\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c NewRatio = 2 //\u65b0\u751f\u4ee3\u4e0e\u8001\u5e74\u4ee3\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\uff0c\u8868\u793a\u65b0\u751f\u4ee3\uff1a\u8001\u5e74\u4ee3=1\uff1a2 SurvivorRatio = 8 //\u4e24\u4e2aSurvivor\u533a\u548cEden\u533a\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\u4e3a8,\u8868\u793aS0:S1:Eden=1:1:8 MetaspaceSize = 21807104 (20.796875MB) //\u5143\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c CompressedClassSpaceSize = 1073741824 (1024.0MB) //\u538b\u7f29\u7c7b\u4f7f\u7528\u7a7a\u95f4\u5927\u5c0f MaxMetaspaceSize = 17592186044415 MB //\u5143\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c G1HeapRegionSize = 0 (0.0MB)//\u5728\u4f7f\u7528 G1 \u5783\u573e\u56de\u6536\u7b97\u6cd5\u65f6\uff0cJVM \u4f1a\u5c06 Heap \u7a7a\u95f4\u5206\u9694\u4e3a\u82e5\u5e72\u4e2a Region\uff0c\u8be5\u53c2\u6570\u7528\u6765\u6307\u5b9a\u6bcf\u4e2a Region \u7a7a\u95f4\u7684\u5927\u5c0f\u3002 Heap Usage: PS Young Generation Eden Space: //Eden\u4f7f\u7528\u60c5\u51b5 capacity = 134217728 (128.0MB) used = 10737496 (10.240074157714844MB) free = 123480232 (117.75992584228516MB) 8.000057935714722% used From Space: //Survivor-From \u4f7f\u7528\u60c5\u51b5 capacity = 22020096 (21.0MB) used = 0 (0.0MB) free = 22020096 (21.0MB) 0.0% used To Space: //Survivor-To \u4f7f\u7528\u60c5\u51b5 capacity = 22020096 (21.0MB) used = 0 (0.0MB) free = 22020096 (21.0MB) 0.0% used PS Old Generation //\u8001\u5e74\u4ee3 \u4f7f\u7528\u60c5\u51b5 capacity = 356515840 (340.0MB) used = 0 (0.0MB) free = 356515840 (340.0MB) 0.0% used 3185 interned Strings occupying 261264 bytes. 4.3.1.4 jhat \u7528\u4e8e\u5206\u6790jmap\u751f\u6210\u7684\u5806\u8f6c\u5b58\u5feb\u7167\uff08\u4e00\u822c\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u800c\u662f\u4f7f\u7528Ecplise Memory Analyzer\uff09 4.3.1.5 jstat \u662fJVM\u7edf\u8ba1\u76d1\u6d4b\u5de5\u5177\u3002\u53ef\u4ee5\u7528\u6765\u663e\u793a\u5783\u573e\u56de\u6536\u4fe1\u606f\u3001\u7c7b\u52a0\u8f7d\u4fe1\u606f\u3001\u65b0\u751f\u4ee3\u7edf\u8ba1\u4fe1\u606f\u7b49\u3002 \u5e38\u89c1\u53c2\u6570 \uff1a \u2460\u603b\u7ed3\u5783\u573e\u56de\u6536\u7edf\u8ba1 jstat -gcutil pid \u5b57\u6bb5 \u542b\u4e49 S0 \u5e78\u5b581\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b S1 \u5e78\u5b582\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b E \u4f0a\u7538\u56ed\u533a\u4f7f\u7528\u6bd4\u4f8b O \u8001\u5e74\u4ee3\u4f7f\u7528\u6bd4\u4f8b M \u5143\u6570\u636e\u533a\u4f7f\u7528\u6bd4\u4f8b CCS \u538b\u7f29\u4f7f\u7528\u6bd4\u4f8b YGC \u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 YGCT \u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536\u6d88\u8017\u65f6\u95f4 FGC \u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 FGCT \u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6d88\u8017\u65f6\u95f4 GCT \u5783\u573e\u56de\u6536\u6d88\u8017\u603b\u65f6\u95f4 \u2461\u5783\u573e\u56de\u6536\u7edf\u8ba1 jstat -gc pid 4.3.2 \u53ef\u89c6\u5316\u5de5\u5177 4.3.2.1 jconsole \u7528\u4e8e\u5bf9jvm\u7684\u5185\u5b58\uff0c\u7ebf\u7a0b\uff0c\u7c7b \u7684\u76d1\u63a7\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8e jmx \u7684 GUI \u6027\u80fd\u76d1\u63a7\u5de5\u5177 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jconsole.exe \u5c31\u884c \u53ef\u4ee5\u5185\u5b58\u3001\u7ebf\u7a0b\u3001\u7c7b\u7b49\u4fe1\u606f 4.3.2.2 VisualVM\uff1a\u6545\u969c\u5904\u7406\u5de5\u5177 \u80fd\u591f\u76d1\u63a7\u7ebf\u7a0b\uff0c\u5185\u5b58\u60c5\u51b5\uff0c\u67e5\u770b\u65b9\u6cd5\u7684CPU\u65f6\u95f4\u548c\u5185\u5b58\u4e2d\u7684\u5bf9 \u8c61\uff0c\u5df2\u88abGC\u7684\u5bf9\u8c61\uff0c\u53cd\u5411\u67e5\u770b\u5206\u914d\u7684\u5806\u6808 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jvisualvm.exe\u5c31\u884c \u76d1\u63a7\u7a0b\u5e8f\u8fd0\u884c\u60c5\u51b5 \u67e5\u770b\u8fd0\u884c\u4e2d\u7684dump \u67e5\u770b\u5806\u4e2d\u7684\u4fe1\u606f 4.4 java\u5185\u5b58\u6cc4\u9732\u7684\u6392\u67e5\u601d\u8def\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u539f\u56e0\uff1a \u5982\u679c\u7ebf\u7a0b\u8bf7\u6c42\u5206\u914d\u7684\u6808\u5bb9\u91cf\u8d85\u8fc7java\u865a\u62df\u673a\u6808\u5141\u8bb8\u7684\u6700\u5927\u5bb9\u91cf\u7684\u65f6\u5019\uff0cjava\u865a\u62df\u673a\u5c06\u629b\u51fa\u4e00\u4e2aStackOverFlowError\u5f02\u5e38 \u5982\u679cjava\u865a\u62df\u673a\u6808\u53ef\u4ee5\u52a8\u6001\u62d3\u5c55\uff0c\u5e76\u4e14\u6269\u5c55\u7684\u52a8\u4f5c\u5df2\u7ecf\u5c1d\u8bd5\u8fc7\uff0c\u4f46\u662f\u76ee\u524d\u65e0\u6cd5\u7533\u8bf7\u5230\u8db3\u591f\u7684\u5185\u5b58\u53bb\u5b8c\u6210\u62d3\u5c55\uff0c\u6216\u8005\u5728\u5efa\u7acb\u65b0\u7ebf\u7a0b\u7684\u65f6\u5019\u6ca1\u6709\u8db3\u591f\u7684\u5185\u5b58\u53bb\u521b\u5efa\u5bf9\u5e94\u7684\u865a\u62df\u673a\u6808\uff0c\u90a3java\u865a\u62df\u673a\u5c06\u4f1a\u629b\u51fa\u4e00\u4e2aOutOfMemoryError\u5f02\u5e38 \u5982\u679c\u4e00\u6b21\u52a0\u8f7d\u7684\u7c7b\u592a\u591a\uff0c\u5143\u7a7a\u95f4\u5185\u5b58\u4e0d\u8db3\uff0c\u5219\u4f1a\u62a5OutOfMemoryError: Metaspace 1\u3001\u901a\u8fc7jmap\u6307\u5b9a\u6253\u5370\u4ed6\u7684\u5185\u5b58\u5feb\u7167 dump \u6709\u7684\u60c5\u51b5\u662f\u5185\u5b58\u6ea2\u51fa\u4e4b\u540e\u7a0b\u5e8f\u5219\u4f1a\u76f4\u63a5\u4e2d\u65ad\uff0c\u800cjmap\u53ea\u80fd\u6253\u5370\u5728\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5efa\u8bae\u901a\u8fc7\u53c2\u6570\u7684\u65b9\u5f0f\u7684\u751f\u6210dump\u6587\u4ef6\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/app/dumps/ \u6307\u5b9a\u751f\u6210\u540e\u6587\u4ef6\u7684\u4fdd\u5b58\u76ee\u5f55 2\u3001\u901a\u8fc7\u5de5\u5177\uff0c VisualVM\uff08Ecplise MAT\uff09\u53bb\u5206\u6790 dump\u6587\u4ef6 VisualVM\u53ef\u4ee5\u52a0\u8f7d\u79bb\u7ebf\u7684dump\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe \u6587\u4ef6-->\u88c5\u5165--->\u9009\u62e9dump\u6587\u4ef6\u5373\u53ef\u67e5\u770b\u5806\u5feb\u7167\u4fe1\u606f \u5982\u679c\u662flinux\u7cfb\u7edf\u4e2d\u7684\u7a0b\u5e8f\uff0c\u5219\u9700\u8981\u628adump\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\uff08windows\u73af\u5883\uff09\u4e0b\uff0c\u6253\u5f00VisualVM\u5de5\u5177\u5206\u6790\u3002VisualVM\u76ee\u524d\u53ea\u652f\u6301\u5728windows\u73af\u5883\u4e0b\u8fd0\u884c\u53ef\u89c6\u5316 3\u3001\u901a\u8fc7\u67e5\u770b\u5806\u4fe1\u606f\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5927\u6982\u5b9a\u4f4d\u5185\u5b58\u6ea2\u51fa\u662f\u54ea\u884c\u4ee3\u7801\u51fa\u4e86\u95ee\u9898 4\u3001\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\uff0c\u901a\u8fc7\u9605\u8bfb\u4e0a\u4e0b\u6587\u7684\u60c5\u51b5\uff0c\u8fdb\u884c\u4fee\u590d\u5373\u53ef 4.5 CPU\u98d9\u9ad8\u6392\u67e5\u65b9\u6848\u4e0e\u601d\u8def\uff1f \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 1.\u4f7f\u7528top\u547d\u4ee4\u67e5\u770b\u5360\u7528cpu\u7684\u60c5\u51b5 2.\u901a\u8fc7top\u547d\u4ee4\u67e5\u770b\u540e\uff0c\u53ef\u4ee5\u67e5\u770b\u662f\u54ea\u4e00\u4e2a\u8fdb\u7a0b\u5360\u7528cpu\u8f83\u9ad8\uff0c\u4e0a\u56fe\u6240\u793a\u7684\u8fdb\u7a0b\u4e3a\uff1a30978 3.\u67e5\u770b\u5f53\u524d\u7ebf\u7a0b\u4e2d\u7684\u8fdb\u7a0b\u4fe1\u606f ps H -eo pid,tid,%cpu | grep 40940 pid \u8fdb\u884cid tid \u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0bid % cpu\u4f7f\u7528\u7387 4.\u901a\u8fc7\u4e0a\u56fe\u5206\u6790\uff0c\u5728\u8fdb\u7a0b30978\u4e2d\u7684\u7ebf\u7a0b30979\u5360\u7528cpu\u8f83\u9ad8 \u6ce8\u610f\uff1a\u4e0a\u8ff0\u7684\u7ebf\u7a0bid\u662f\u4e00\u4e2a\u5341\u8fdb\u5236\uff0c\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u7ebf\u7a0bid\u8f6c\u6362\u4e3a16\u8fdb\u5236\u624d\u884c\uff0c\u56e0\u4e3a\u901a\u5e38\u5728\u65e5\u5fd7\u4e2d\u5c55\u793a\u7684\u90fd\u662f16\u8fdb\u5236\u7684\u7ebf\u7a0bid\u540d\u79f0 \u8f6c\u6362\u65b9\u5f0f\uff1a \u5728linux\u4e2d\u6267\u884c\u547d\u4ee4 printf \"%x\\n\" 30979 5.\u53ef\u4ee5\u6839\u636e\u7ebf\u7a0b id \u627e\u5230\u6709\u95ee\u9898\u7684\u7ebf\u7a0b\uff0c\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u5230\u95ee\u9898\u4ee3\u7801\u7684\u6e90\u7801\u884c\u53f7 \u6267\u884c\u547d\u4ee4 jstack 30978 \u6b64\u5904\u662f\u8fdb\u7a0bid 5.\u9762\u8bd5\u73b0\u573a 5.1 JVM\u7ec4\u6210 \u9762\u8bd5\u5b98 \uff1aJVM\u7531\u90a3\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d\u7684~~ \u5728JVM\u4e2d\u5171\u6709\u56db\u5927\u90e8\u5206\uff0c\u5206\u522b\u662fClassLoader\uff08\u7c7b\u52a0\u8f7d\u5668\uff09\u3001Runtime Data Area\uff08\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff0c\u5185\u5b58\u5206\u533a\uff09\u3001Execution Engine\uff08\u6267\u884c\u5f15\u64ce\uff09\u3001Native Method Library\uff08\u672c\u5730\u5e93\u63a5\u53e3\uff09 \u5b83\u4eec\u7684\u8fd0\u884c\u6d41\u7a0b\u662f\uff1a \u7b2c\u4e00\uff0c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u628aJava\u4ee3\u7801\u8f6c\u6362\u4e3a\u5b57\u8282\u7801 \u7b2c\u4e8c\uff0c\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff08Runtime Data Area\uff09\u628a\u5b57\u8282\u7801\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u5b57\u8282\u7801\u6587\u4ef6\u53ea\u662fJVM\u7684\u4e00\u5957\u6307\u4ee4\u96c6\u89c4\u8303\uff0c\u5e76\u4e0d\u80fd\u76f4\u63a5\u4ea4\u7ed9\u5e95\u5c42\u7cfb\u7edf\u53bb\u6267\u884c\uff0c\u800c\u662f\u6709\u6267\u884c\u5f15\u64ce\u8fd0\u884c \u7b2c\u4e09\uff0c\u6267\u884c\u5f15\u64ce\uff08Execution Engine\uff09\u5c06\u5b57\u8282\u7801\u7ffb\u8bd1\u4e3a\u5e95\u5c42\u7cfb\u7edf\u6307\u4ee4\uff0c\u518d\u4ea4\u7531CPU\u6267\u884c\u53bb\u6267\u884c\uff0c\u6b64\u65f6\u9700\u8981\u8c03\u7528\u5176\u4ed6\u8bed\u8a00\u7684\u672c\u5730\u5e93\u63a5\u53e3\uff08Native Method Library\uff09\u6765\u5b9e\u73b0\u6574\u4e2a\u7a0b\u5e8f\u7684\u529f\u80fd\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u8be6\u7ec6\u8bf4\u4e00\u4e0b JVM \u8fd0\u884c\u65f6\u6570\u636e\u533a\u5417\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d~ \u8fd0\u884c\u65f6\u6570\u636e\u533a\u5305\u542b\u4e86\u5806\u3001\u65b9\u6cd5\u533a\u3001\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668\u8fd9\u51e0\u90e8\u5206\uff0c\u6bcf\u4e2a\u529f\u80fd\u4f5c\u7528\u4e0d\u4e00\u6837\u3002 \u5806\u89e3\u51b3\u7684\u662f\u5bf9\u8c61\u5b9e\u4f8b\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u5783\u573e\u56de\u6536\u5668\u7ba1\u7406\u7684\u4e3b\u8981\u533a\u57df\u3002 \u65b9\u6cd5\u533a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5806\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u5b58\u50a8\u5df2\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u3002 \u6808\u89e3\u51b3\u7684\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u95ee\u9898\uff0c\u6808\u91cc\u9762\u5b58\u7684\u662f\u6808\u5e27\uff0c\u6808\u5e27\u91cc\u9762\u5b58\u7684\u662f\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\u3001\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002 \u672c\u5730\u65b9\u6cd5\u6808\u4e0e\u6808\u529f\u80fd\u76f8\u540c\uff0c\u672c\u5730\u65b9\u6cd5\u6808\u6267\u884c\u7684\u662f\u672c\u5730\u65b9\u6cd5\uff0c\u4e00\u4e2aJava\u8c03\u7528\u975eJava\u4ee3\u7801\u7684\u63a5\u53e3\u3002 \u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\u5bc4\u5b58\u5668\uff09\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u5b58\u653e\u7684\u662f\u5f53\u524d\u7ebf\u7a0b\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u6570\u3002JVM\u5de5\u4f5c\u65f6\u5c31\u662f\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u4e2a\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u518d\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u7a0b\u5e8f\u8ba1\u6570\u5668\u7684\u4f5c\u7528\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837~~ java\u865a\u62df\u673a\u5bf9\u4e8e\u591a\u7ebf\u7a0b\u662f\u901a\u8fc7\u7ebf\u7a0b\u8f6e\u6d41\u5207\u6362\u5e76\u4e14\u5206\u914d\u7ebf\u7a0b\u6267\u884c\u65f6\u95f4\u3002\u5728\u4efb\u4f55\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u53ea\u4f1a\u5904\u7406\u6267\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u5f53\u524d\u88ab\u6267\u884c\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u5b83\u6240\u5206\u914d\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\u3010\u6302\u8d77\u3011\u3002\u5904\u7406\u5668\u4f1a\u5207\u6362\u5230\u53e6\u5916\u7684\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6765\u8fdb\u884c\u6267\u884c\u3002\u5e76\u4e14\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\uff0c\u63a5\u7740\u5904\u7406\u5668\u5c31\u4f1a\u53c8\u6765\u6267\u884c\u88ab\u6302\u8d77\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u3002\u8fd9\u65f6\u5019\u7a0b\u5e8f\u8ba1\u6570\u5668\u5c31\u8d77\u5230\u4e86\u5173\u952e\u4f5c\u7528\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\u5728\u6765\u56de\u5207\u6362\u7684\u7ebf\u7a0b\u4e2d\u8bb0\u5f55\u4ed6\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u884c\u53f7\uff0c\u7136\u540e\u63a5\u7740\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u4f60\u80fd\u7ed9\u6211\u8be6\u7ec6\u7684\u4ecb\u7ecdJava\u5806\u5417? \u5019\u9009\u4eba: \u597d\u7684~ Java\u4e2d\u7684\u5806\u672f\u8bed\u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df\u3002\u4e3b\u8981\u7528\u6765\u4fdd\u5b58 \u5bf9\u8c61\u5b9e\u4f8b\uff0c\u6570\u7ec4 \u7b49\uff0c\u5f53\u5806\u4e2d\u6ca1\u6709\u5185\u5b58\u7a7a\u95f4\u53ef\u5206\u914d\u7ed9\u5b9e\u4f8b\uff0c\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5219\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002 \u200b \u5728JAVA8\u4e2d\u5806\u5185\u4f1a\u5b58\u5728\u5e74\u8f7b\u4ee3\u3001\u8001\u5e74\u4ee3 \u200b 1\uff09Young\u533a\u88ab\u5212\u5206\u4e3a\u4e09\u90e8\u5206\uff0cEden\u533a\u548c\u4e24\u4e2a\u5927\u5c0f\u4e25\u683c\u76f8\u540c\u7684Survivor\u533a\uff0c\u5176\u4e2d\uff0cSurvivor\u533a\u95f4\u4e2d\uff0c\u67d0\u4e00\u65f6\u523b\u53ea\u6709\u5176\u4e2d\u4e00\u4e2a\u662f\u88ab\u4f7f\u7528\u7684\uff0c\u53e6\u5916\u4e00\u4e2a\u7559\u505a\u5783\u573e\u6536\u96c6\u65f6\u590d\u5236\u5bf9\u8c61\u7528\u3002\u5728Eden\u533a\u53d8\u6ee1\u7684\u65f6\u5019\uff0c GC\u5c31\u4f1a\u5c06\u5b58\u6d3b\u7684\u5bf9\u8c61\u79fb\u5230\u7a7a\u95f2\u7684Survivor\u533a\u95f4\u4e2d\uff0c\u6839\u636eJVM\u7684\u7b56\u7565\uff0c\u5728\u7ecf\u8fc7\u51e0\u6b21\u5783\u573e\u6536\u96c6\u540e\uff0c\u4efb\u7136\u5b58\u6d3b\u4e8eSurvivor\u7684\u5bf9\u8c61\u5c06\u88ab\u79fb\u52a8\u5230Tenured\u533a\u95f4\u3002 \u200b 2\uff09Tenured\u533a\u4e3b\u8981\u4fdd\u5b58\u751f\u547d\u5468\u671f\u957f\u7684\u5bf9\u8c61\uff0c\u4e00\u822c\u662f\u4e00\u4e9b\u8001\u7684\u5bf9\u8c61\uff0c\u5f53\u4e00\u4e9b\u5bf9\u8c61\u5728Young\u590d\u5236\u8f6c\u79fb\u4e00\u5b9a\u7684\u6b21\u6570\u4ee5\u540e\uff0c\u5bf9\u8c61\u5c31\u4f1a\u88ab\u8f6c\u79fb\u5230Tenured\u533a\u3002 \u9762\u8bd5\u5b98 \uff1a\u80fd\u4e0d\u80fd\u89e3\u91ca\u4e00\u4e0b\u65b9\u6cd5\u533a\uff1f \u5019\u9009\u4eba: \u597d\u7684~ \u4e0e\u865a\u62df\u673a\u6808\u7c7b\u4f3c\u3002\u672c\u5730\u65b9\u6cd5\u6808\u662f\u4e3a\u865a\u62df\u673a \u6267\u884c\u672c\u5730\u65b9\u6cd5\u65f6\u63d0\u4f9b\u670d\u52a1\u7684 \u3002\u4e0d\u9700\u8981\u8fdb\u884cGC\u3002\u672c\u5730\u65b9\u6cd5\u4e00\u822c\u662f\u7531\u5176\u4ed6\u8bed\u8a00\u7f16\u5199\u3002 \u9762\u8bd5\u5b98 \uff1a\u4f60\u542c\u8fc7\u76f4\u63a5\u5185\u5b58\u5417\uff1f \u5019\u9009\u4eba: \u55ef~~ \u5b83\u53c8\u53eb\u505a \u5806\u5916\u5185\u5b58 \uff0c \u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df \uff0c\u5728 Java 8 \u4e4b\u524d\u6709\u4e2a \u6c38\u4e45\u4ee3 \u7684\u6982\u5ff5\uff0c\u5b9e\u9645\u4e0a\u6307\u7684\u662f HotSpot \u865a\u62df\u673a\u4e0a\u7684\u6c38\u4e45\u4ee3\uff0c\u5b83\u7528\u6c38\u4e45\u4ee3\u5b9e\u73b0\u4e86 JVM \u89c4\u8303\u5b9a\u4e49\u7684\u65b9\u6cd5\u533a\u529f\u80fd\uff0c \u4e3b\u8981\u5b58\u50a8\u7c7b\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\uff0c\u9759\u6001\u53d8\u91cf \uff0c\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u4ee3\u7801\u7b49\uff0c\u8fd9\u90e8\u5206\u7531\u4e8e\u662f\u5728\u5806\u4e2d\u5b9e\u73b0\u7684\uff0c\u53d7 GC \u7684\u7ba1\u7406\uff0c\u4e0d\u8fc7\u7531\u4e8e\u6c38\u4e45\u4ee3\u6709 -XX:MaxPermSize \u7684\u4e0a\u9650\uff0c\u6240\u4ee5\u5982\u679c\u5927\u91cf\u52a8\u6001\u751f\u6210\u7c7b\uff08\u5c06\u7c7b\u4fe1\u606f\u653e\u5165\u6c38\u4e45\u4ee3\uff09\uff0c\u5f88\u5bb9\u6613\u9020\u6210 OOM\uff0c\u6709\u4eba\u8bf4\u53ef\u4ee5\u628a\u6c38\u4e45\u4ee3\u8bbe\u7f6e\u5f97\u8db3\u591f\u5927\uff0c\u4f46\u5f88\u96be\u786e\u5b9a\u4e00\u4e2a\u5408\u9002\u7684\u5927\u5c0f\uff0c\u53d7\u7c7b\u6570\u91cf\uff0c\u5e38\u91cf\u6570\u91cf\u7684\u591a\u5c11\u5f71\u54cd\u5f88\u5927\u3002 \u200b \u6240\u4ee5\u5728 Java 8 \u4e2d\u5c31\u628a\u65b9\u6cd5\u533a\u7684\u5b9e\u73b0\u79fb\u5230\u4e86\u672c\u5730\u5185\u5b58\u4e2d\u7684\u5143\u7a7a\u95f4\u4e2d\uff0c\u8fd9\u6837\u65b9\u6cd5\u533a\u5c31\u4e0d\u53d7 JVM \u7684\u63a7\u5236\u4e86,\u4e5f\u5c31\u4e0d\u4f1a\u8fdb\u884c GC\uff0c\u4e5f\u56e0\u6b64\u63d0\u5347\u4e86\u6027\u80fd\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u865a\u62df\u673a\u6808 \u5019\u9009\u4eba: \u865a\u62df\u673a\u6808\u662f\u63cf\u8ff0\u7684\u662f\u65b9\u6cd5\u6267\u884c\u65f6\u7684\u5185\u5b58\u6a21\u578b,\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u751f\u547d\u5468\u671f\u4e0e\u7ebf\u7a0b\u76f8\u540c,\u6bcf\u4e2a\u65b9\u6cd5\u88ab\u6267\u884c\u7684\u540c\u65f6\u4f1a\u521b\u5efa \u6808\u6862 \u3002\u4fdd\u5b58\u6267\u884c\u65b9\u6cd5\u65f6\u7684 \u5c40\u90e8\u53d8\u91cf\u3001\u52a8\u6001\u8fde\u63a5\u4fe1\u606f\u3001\u65b9\u6cd5\u8fd4\u56de\u5730\u5740\u4fe1\u606f \u7b49\u7b49\u3002\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7684\u65f6\u5019\u4f1a\u8fdb\u6808\uff0c\u65b9\u6cd5\u6267\u884c\u5b8c\u4f1a\u51fa\u6808\u3010\u76f8\u5f53\u4e8e\u6e05\u7a7a\u4e86\u6570\u636e\u3011\uff0c\u6240\u4ee5\u8fd9\u5757\u533a\u57df \u4e0d\u9700\u8981\u8fdb\u884c GC \u3002 \u9762\u8bd5\u5b98 \uff1a\u80fd\u8bf4\u4e00\u4e0b\u5806\u6808\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5417\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d\u7684\uff0c\u6709\u8fd9\u51e0\u4e2a\u533a\u522b \u7b2c\u4e00\uff0c\u6808\u5185\u5b58\u4e00\u822c\u4f1a\u7528\u6765\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u548c\u65b9\u6cd5\u8c03\u7528\uff0c\u4f46\u5806\u5185\u5b58\u662f\u7528\u6765\u5b58\u50a8Java\u5bf9\u8c61\u548c\u6570\u7ec4\u7684\u7684\u3002\u5806\u4f1aGC\u5783\u573e\u56de\u6536\uff0c\u800c\u6808\u4e0d\u4f1a\u3002 \u7b2c\u4e8c\u3001\u6808\u5185\u5b58\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u800c\u5806\u5185\u5b58\u662f\u7ebf\u7a0b\u5171\u6709\u7684\u3002 \u7b2c\u4e09\u3001\u4e24\u8005\u5f02\u5e38\u9519\u8bef\u4e0d\u540c\uff0c\u4f46\u5982\u679c\u6808\u5185\u5b58\u6216\u8005\u5806\u5185\u5b58\u4e0d\u8db3\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\u3002 \u6808\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.StackOverFlowError\u3002 \u5806\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.OutOfMemoryError\u3002 5.2 \u7c7b\u52a0\u8f7d\u5668 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7c7b\u52a0\u8f7d\u5668\uff0c\u7c7b\u52a0\u8f7d\u5668\u6709\u54ea\u4e9b? \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837\u7684 JVM\u53ea\u4f1a\u8fd0\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u800c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5c06 \u5b57\u8282\u7801\u6587\u4ef6\u52a0\u8f7d\u5230JVM\u4e2d \uff0c\u4ece\u800c\u8ba9Java\u7a0b\u5e8f\u80fd\u591f\u542f\u52a8\u8d77\u6765\u3002 \u5e38\u89c1\u7684\u7c7b\u52a0\u8f7d\u5668\u67094\u4e2a \u7b2c\u4e00\u4e2a\u662f\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(BootStrap ClassLoader)\uff1a\u5176\u662f\u7531C++\u7f16\u5199\u5b9e\u73b0\u3002\u7528\u4e8e\u52a0\u8f7dJAVA_HOME/jre/lib\u76ee\u5f55\u4e0b\u7684\u7c7b\u5e93\u3002 \u7b2c\u4e8c\u4e2a\u662f\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668(ExtClassLoader)\uff1a\u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u52a0\u8f7dJAVA_HOME/jre/lib/ext\u76ee\u5f55\u4e2d\u7684\u7c7b\u5e93\u3002 \u7b2c\u4e09\u4e2a\u662f\u5e94\u7528\u7c7b\u52a0\u8f7d\u5668(AppClassLoader)\uff1a\u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u7528\u4e8e\u52a0\u8f7dclassPath\u4e0b\u7684\u7c7b\uff0c\u4e5f\u5c31\u662f\u52a0\u8f7d\u5f00\u53d1\u8005\u81ea\u5df1\u7f16\u5199\u7684Java\u7c7b\u3002 \u7b2c\u56db\u4e2a\u662f\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\uff1a\u5f00\u53d1\u8005\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627fClassLoader\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u89c4\u5219\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b\u7c7b\u88c5\u8f7d\u7684\u6267\u884c\u8fc7\u7a0b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u8fd8\u662f\u633a\u591a\u7684\u3002 \u7c7b\u4ece\u52a0\u8f7d\u5230\u865a\u62df\u673a\u4e2d\u5f00\u59cb\uff0c\u76f4\u5230\u5378\u8f7d\u4e3a\u6b62\uff0c\u5b83\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5305\u62ec\u4e86\uff1a\u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u89e3\u6790\u3001\u521d\u59cb\u5316\u3001\u4f7f\u7528\u548c\u5378\u8f7d\u8fd97\u4e2a\u9636\u6bb5\u3002\u5176\u4e2d\uff0c\u9a8c\u8bc1\u3001\u51c6\u5907\u548c\u89e3\u6790\u8fd9\u4e09\u4e2a\u90e8\u5206\u7edf\u79f0\u4e3a\u8fde\u63a5\uff08linking\uff09 1.\u52a0\u8f7d\uff1a\u67e5\u627e\u548c\u5bfc\u5165class\u6587\u4ef6 2.\u9a8c\u8bc1\uff1a\u4fdd\u8bc1\u52a0\u8f7d\u7c7b\u7684\u51c6\u786e\u6027 3.\u51c6\u5907\uff1a\u4e3a\u7c7b\u53d8\u91cf\u5206\u914d\u5185\u5b58\u5e76\u8bbe\u7f6e\u7c7b\u53d8\u91cf\u521d\u59cb\u503c 4.\u89e3\u6790\uff1a\u628a\u7c7b\u4e2d\u7684\u7b26\u53f7\u5f15\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u5f15\u7528 5.\u521d\u59cb\u5316\uff1a\u5bf9\u7c7b\u7684\u9759\u6001\u53d8\u91cf\uff0c\u9759\u6001\u4ee3\u7801\u5757\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c 6.\u4f7f\u7528\uff1aJVM \u5f00\u59cb\u4ece\u5165\u53e3\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7528\u6237\u7684\u7a0b\u5e8f\u4ee3\u7801 7.\u5378\u8f7d\uff1a\u5f53\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u540e\uff0cJVM \u4fbf\u5f00\u59cb\u9500\u6bc1\u521b\u5efa\u7684 Class \u5bf9\u8c61\uff0c\u6700\u540e\u8d1f\u8d23\u8fd0\u884c\u7684 JVM \u4e5f\u9000\u51fa\u5185\u5b58 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u5b83\u662f\u662f\u8fd9\u6837\u7684\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u6536\u5230\u4e86\u7c7b\u52a0\u8f7d\u7684\u8bf7\u6c42\uff0c\u5b83\u9996\u5148\u4e0d\u4f1a\u81ea\u5df1\u5c1d\u8bd5\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\uff0c\u800c\u662f\u628a\u8fd9\u8bf7\u6c42\u59d4\u6d3e\u7ed9\u7236\u7c7b\u52a0\u8f7d\u5668\u53bb\u5b8c\u6210\uff0c\u6bcf\u4e00\u4e2a\u5c42\u6b21\u7684\u7c7b\u52a0\u8f7d\u5668\u90fd\u662f\u5982\u6b64\uff0c\u56e0\u6b64\u6240\u6709\u7684\u52a0\u8f7d\u8bf7\u6c42\u6700\u7ec8\u90fd\u5e94\u8be5\u4f20\u8bf4\u5230\u9876\u5c42\u7684\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u4e2d\uff0c\u53ea\u6709\u5f53\u7236\u7c7b\u52a0\u8f7d\u5668\u8fd4\u56de\u81ea\u5df1\u65e0\u6cd5\u5b8c\u6210\u8fd9\u4e2a\u52a0\u8f7d\u8bf7\u6c42\uff08\u5b83\u7684\u641c\u7d22\u8fd4\u56de\u4e2d\u6ca1\u6709\u627e\u5230\u6240\u9700\u7684\u7c7b\uff09\u65f6\uff0c\u5b50\u7c7b\u52a0\u8f7d\u5668\u624d\u4f1a\u5c1d\u8bd5\u81ea\u5df1\u53bb\u52a0\u8f7d \u9762\u8bd5\u5b98 \uff1aJVM\u4e3a\u4ec0\u4e48\u91c7\u7528\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236 \u5019\u9009\u4eba: \u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\u3002 \u7b2c\u4e00\u3001\u901a\u8fc7\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236\u53ef\u4ee5\u907f\u514d\u67d0\u4e00\u4e2a\u7c7b\u88ab\u91cd\u590d\u52a0\u8f7d\uff0c\u5f53\u7236\u7c7b\u5df2\u7ecf\u52a0\u8f7d\u540e\u5219\u65e0\u9700\u91cd\u590d\u52a0\u8f7d\uff0c\u4fdd\u8bc1\u552f\u4e00\u6027\u3002 \u7b2c\u4e8c\u3001\u4e3a\u4e86\u5b89\u5168\uff0c\u4fdd\u8bc1\u7c7b\u5e93API\u4e0d\u4f1a\u88ab\u4fee\u6539 5.3 \u5783\u573e\u56de\u6536 \u9762\u8bd5\u5b98 \uff1a\u7b80\u8ff0Java\u5783\u573e\u56de\u6536\u673a\u5236\uff1f\uff08GC\u662f\u4ec0\u4e48\uff1f\u4e3a\u4ec0\u4e48\u8981GC\uff09 \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837~~ \u4e3a\u4e86\u8ba9\u7a0b\u5e8f\u5458\u66f4\u4e13\u6ce8\u4e8e\u4ee3\u7801\u7684\u5b9e\u73b0\uff0c\u800c\u4e0d\u7528\u8fc7\u591a\u7684\u8003\u8651\u5185\u5b58\u91ca\u653e\u7684\u95ee\u9898\uff0c\u6240\u4ee5\uff0c\u5728Java\u8bed\u8a00\u4e2d\uff0c\u6709\u4e86\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u719f\u6089\u7684GC(Garbage Collection)\u3002 \u6709\u4e86\u5783\u573e\u56de\u6536\u673a\u5236\u540e\uff0c\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u5173\u5fc3\u5185\u5b58\u7684\u7533\u8bf7\u5373\u53ef\uff0c\u5185\u5b58\u7684\u91ca\u653e\u7531\u7cfb\u7edf\u81ea\u52a8\u8bc6\u522b\u5b8c\u6210\u3002 \u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\uff0cGC\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u56de\u6536\u65f6\u673a \u9762\u8bd5\u5b98 \uff1a\u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba: \u55ef\u55ef~ \u5f3a\u5f15\u7528\u6700\u4e3a\u666e\u901a\u7684\u5f15\u7528\u65b9\u5f0f\uff0c\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u6709\u7528\u4e14\u5fc5\u987b \u7684\u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5177\u6709\u5f3a\u5f15\u7528\uff0c\u5219GC\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\u3002\u5373\u4fbf\u5806\u4e2d\u5185\u5b58\u4e0d\u8db3\u4e86\uff0c\u5b81\u53ef\u51fa\u73b0OOM\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u56de\u6536 \u8f6f\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u6709\u7528\u4e14\u975e\u5fc5\u987b \u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u8f6f\u5f15\u7528\uff0c\u5728\u5185\u5b58\u7a7a\u95f4\u8db3\u591f\u7684\u60c5\u51b5\u4e0b\uff0cGC\u673a\u5236\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\uff0c\u800c\u5728\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u5219\u4f1a\u5728OOM\u5f02\u5e38\u51fa\u73b0\u4e4b\u95f4\u5bf9\u5176\u8fdb\u884c\u56de\u6536\u3002\u4f46\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3aGC\u7ebf\u7a0b\u4f18\u5148\u7ea7\u8f83\u4f4e\uff0c\u8f6f\u5f15\u7528\u5e76\u4e0d\u4f1a\u7acb\u5373\u88ab\u56de\u6536\u3002 \u5f31\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u53ef\u80fd\u6709\u7528\u4e14\u975e\u5fc5\u987b \u7684\u72b6\u6001\u3002\u5728GC\u7ebf\u7a0b\u626b\u63cf\u5185\u5b58\u533a\u57df\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u5f31\u5f15\u7528\uff0c\u5c31\u4f1a\u56de\u6536\u5230\u5f31\u5f15\u7528\u76f8\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u5f31\u5f15\u7528\u7684\u56de\u6536\uff0c\u65e0\u5173\u5185\u5b58\u533a\u57df\u662f\u5426\u8db3\u591f\uff0c\u4e00\u65e6\u53d1\u73b0\u5219\u4f1a\u88ab\u56de\u6536\u3002\u540c\u6837\u7684\uff0c\u56e0\u4e3aGC\u7ebf\u7a0b\u4f18\u5148\u7ea7\u8f83\u4f4e\uff0c\u6240\u4ee5\u5f31\u5f15\u7528\u4e5f\u5e76\u4e0d\u662f\u4f1a\u88ab\u7acb\u523b\u56de\u6536\u3002 \u865a\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u65e0\u7528 \u7684\u72b6\u6001\u3002\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u6709\u53ef\u80fd\u88ab\u5783\u573e\u56de\u6536\u3002\u865a\u5f15\u7528\u7684\u4f7f\u7528\u5fc5\u987b\u548c\u5f15\u7528\u961f\u5217Reference Queue\u8054\u5408\u4f7f\u7528 \u9762\u8bd5\u5b98 \uff1a\u5bf9\u8c61\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u88ab\u5783\u573e\u5668\u56de\u6536 \u5019\u9009\u4eba: \u601d\u8003\u4e00\u4f1a~~ \u5982\u679c\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u6ca1\u6709\u4efb\u4f55\u7684\u5f15\u7528\u6307\u5411\u5b83\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u73b0\u5728\u5c31\u662f\u5783\u573e\uff0c\u5982\u679c\u5b9a\u4f4d\u4e86\u5783\u573e\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u3002 \u5982\u679c\u8981\u5b9a\u4f4d\u4ec0\u4e48\u662f\u5783\u573e\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u786e\u5b9a\uff0c\u7b2c\u4e00\u4e2a\u662f\u5f15\u7528\u8ba1\u6570\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5 \u901a\u5e38\u90fd\u4f7f\u7528\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u6765\u786e\u5b9a\u662f\u4e0d\u662f\u5783\u573e \u9762\u8bd5\u5b98 \uff1a JVM \u5783\u573e\u56de\u6536\u7b97\u6cd5\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba: \u6211\u8bb0\u5f97\u4e00\u5171\u6709\u56db\u79cd\uff0c\u5206\u522b\u662f\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u3001\u590d\u5236\u7b97\u6cd5\u3001\u6807\u8bb0\u6574\u7406\u7b97\u6cd5\u3001\u5206\u4ee3\u56de\u6536 \u9762\u8bd5\u5b98 \uff1a \u4f60\u80fd\u8be6\u7ec6\u804a\u4e00\u4e0b\u5206\u4ee3\u56de\u6536\u5417\uff1f \u5019\u9009\u4eba: \u5173\u4e8e\u5206\u4ee3\u56de\u6536\u662f\u8fd9\u6837\u7684 \u5728java8\u65f6\uff0c\u5806\u88ab\u5206\u4e3a\u4e86\u4e24\u4efd\uff1a\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c\u5b83\u4eec\u9ed8\u8ba4\u7a7a\u95f4\u5360\u7528\u6bd4\u4f8b\u662f1:2 \u5bf9\u4e8e\u65b0\u751f\u4ee3\uff0c\u5185\u90e8\u53c8\u88ab\u5206\u4e3a\u4e86\u4e09\u4e2a\u533a\u57df\u3002Eden\u533a\uff0cS0\u533a\uff0cS1\u533a\u9ed8\u8ba4\u7a7a\u95f4\u5360\u7528\u6bd4\u4f8b\u662f8:1:1 \u5177\u4f53\u7684\u5de5\u4f5c\u673a\u5236\u662f\u6709\u4e9b\u60c5\u51b5\uff1a 1\uff09\u5f53\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u4f1a\u88ab\u5206\u914d\u5728\u65b0\u751f\u4ee3\u7684Eden\u533a\u3002\u5f53Eden\u533a\u8981\u6ee1\u4e86\u65f6\u5019\uff0c\u89e6\u53d1YoungGC\u3002 2\uff09\u5f53\u8fdb\u884cYoungGC\u540e\uff0c\u6b64\u65f6\u5728Eden\u533a\u5b58\u6d3b\u7684\u5bf9\u8c61\u88ab\u79fb\u52a8\u5230S0\u533a\uff0c\u5e76\u4e14 \u5f53\u524d\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01 \uff0c\u6e05\u7a7aEden\u533a\u3002 3\uff09\u5f53\u518d\u4e00\u6b21\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u628aEden\u533a\u4e2d\u5b58\u6d3b\u4e0b\u6765\u7684\u5bf9\u8c61\u548cS0\u4e2d\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u5230S1\u533a\u4e2d\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01\uff0c\u6e05\u7a7aEden\u533a\u548cS0\u533a\u3002 4\uff09\u5f53\u518d\u4e00\u6b21\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u628aEden\u533a\u4e2d\u5b58\u6d3b\u4e0b\u6765\u7684\u5bf9\u8c61\u548cS1\u4e2d\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u5230S0\u533a\u4e2d\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01\uff0c\u6e05\u7a7aEden\u533a\u548cS1\u533a\u3002 5\uff09\u5bf9\u8c61\u7684\u5e74\u9f84\u8fbe\u5230\u4e86\u67d0\u4e00\u4e2a\u9650\u5b9a\u7684\u503c\uff08 \u9ed8\u8ba415\u5c81 \uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u8fdb\u5165\u5230\u8001\u5e74\u4ee3\u4e2d\u3002 \u5f53\u7136\u4e5f\u6709\u7279\u6b8a\u60c5\u51b5\uff0c\u5982\u679c\u8fdb\u5165Eden\u533a\u7684\u662f\u4e00\u4e2a\u5927\u5bf9\u8c61\uff0c\u5728\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u76f4\u63a5\u5b58\u653e\u5230\u8001\u5e74\u4ee3 \u5f53\u8001\u5e74\u4ee3\u6ee1\u4e86\u4e4b\u540e\uff0c \u89e6\u53d1FullGC \u3002 FullGC\u540c\u65f6\u56de\u6536\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3 \uff0c\u5f53\u524d\u53ea\u4f1a\u5b58\u5728\u4e00\u4e2aFullGC\u7684\u7ebf\u7a0b\u8fdb\u884c\u6267\u884c\uff0c\u5176\u4ed6\u7684\u7ebf\u7a0b\u5168\u90e8\u4f1a\u88ab\u6302\u8d77\u3002 \u6211\u4eec\u5728\u7a0b\u5e8f\u4e2d\u8981\u5c3d\u91cf\u907f\u514dFullGC\u7684\u51fa\u73b0\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bb2\u4e00\u4e0b\u65b0\u751f\u4ee3\u3001\u8001\u5e74\u4ee3\u3001\u6c38\u4e45\u4ee3\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba: \u55ef\uff01\u662f\u8fd9\u6837\u7684\uff0c\u7b80\u5355\u8bf4\u5c31\u662f \u65b0\u751f\u4ee3 \u4e3b\u8981\u7528\u6765\u5b58\u653e\u65b0\u751f\u7684\u5bf9\u8c61\u3002 \u8001\u5e74\u4ee3 \u4e3b\u8981\u5b58\u653e\u5e94\u7528\u4e2d\u751f\u547d\u5468\u671f\u957f\u7684\u5185\u5b58\u5bf9\u8c61\u3002 \u6c38\u4e45\u4ee3 \u6307\u7684\u662f\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\u3002\u4e3b\u8981\u5b58\u653eClass\u548cMeta\uff08\u5143\u6570\u636e\uff09\u7684\u4fe1\u606f\u3002\u5728Java8\u4e2d\uff0c\u6c38\u4e45\u4ee3\u5df2\u7ecf\u88ab\u79fb\u9664\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u4e00\u4e2a\u79f0\u4e4b\u4e3a\u201c\u5143\u6570\u636e\u533a\u201d\uff08 \u5143\u7a7a\u95f4 \uff09\u7684\u533a\u57df\u3002\u5143\u7a7a\u95f4\u548c\u6c38\u4e45\u4ee3\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5143\u7a7a\u95f4\u4e0e\u6c38\u4e45\u4ee3\u4e4b\u95f4\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\uff1a\u5143\u7a7a\u95f4\u5e76\u4e0d\u5728\u865a\u62df\u673a\u4e2d\uff0c\u800c\u662f\u4f7f\u7528\u672c\u5730\u5185\u5b58\u3002\u56e0\u6b64\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5143\u7a7a\u95f4\u7684\u5927\u5c0f\u4ec5\u53d7\u672c\u5730\u5185\u5b58\u7684\u9650\u5236\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b JVM \u6709\u54ea\u4e9b\u5783\u573e\u56de\u6536\u5668\uff1f \u5019\u9009\u4eba: \u5728jvm\u4e2d\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u5783\u573e\u6536\u96c6\u5668\uff0c\u5305\u62ec\uff1a\u4e32\u884c\u5783\u573e\u6536\u96c6\u5668\u3001\u5e76\u884c\u5783\u573e\u6536\u96c6\u5668\uff08JDK8\u9ed8\u8ba4\uff09\u3001CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668\u3001G1\u5783\u573e\u6536\u96c6\u5668\uff08JDK9\u9ed8\u8ba4\uff09 \u9762\u8bd5\u5b98 \uff1aMinor GC\u3001Major GC\u3001Full GC\u662f\u4ec0\u4e48 \u5019\u9009\u4eba: \u55ef\uff0c\u5176\u5b9e\u5b83\u4eec\u6307\u7684\u662f\u4e0d\u540c\u4ee3\u4e4b\u95f4\u7684\u5783\u573e\u56de\u6536 Minor GC \u53d1\u751f\u5728\u65b0\u751f\u4ee3\u7684\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u77ed Major GC \u8001\u5e74\u4ee3\u533a\u57df\u7684\u5783\u573e\u56de\u6536\uff0c\u8001\u5e74\u4ee3\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u4f1a\u5148\u5c1d\u8bd5\u89e6\u53d1Minor GC\u3002Minor GC\u4e4b\u540e\u7a7a\u95f4\u8fd8\u4e0d\u8db3\uff0c\u5219\u4f1a\u89e6\u53d1Major GC\uff0cMajor GC\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6682\u505c\u65f6\u95f4\u957f Full GC \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff0c \u5e94\u5c3d\u529b\u907f\u514d 5.4 JVM\u5b9e\u8df5\uff08\u8c03\u4f18\uff09 \u9762\u8bd5\u5b98 \uff1aJVM \u8c03\u4f18\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u54ea\u91cc\u8bbe\u7f6e\u53c2\u6570\u503c\uff1f \u5019\u9009\u4eba: \u6211\u4eec\u5f53\u65f6\u7684\u9879\u76ee\u662fspringboot\u9879\u76ee\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u542f\u52a8\u7684\u65f6\u5019\uff0cjava -jar\u4e2d\u52a0\u5165\u53c2\u6570\u5c31\u884c\u4e86 \u9762\u8bd5\u5b98 \uff1a\u7528\u7684 JVM \u8c03\u4f18\u7684\u53c2\u6570\u90fd\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e9b\u53c2\u6570\u662f\u6bd4\u8f83\u591a\u7684 \u6211\u8bb0\u5f97\u5f53\u65f6\u6211\u4eec\u8bbe\u7f6e\u8fc7\u5806\u7684\u5927\u5c0f\uff0c\u50cf-Xms\u548c-Xmx \u8fd8\u6709\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u548c\u4e24\u4e2aSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u4f8b \u8fd8\u6709\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u4f7f\u7528\u54ea\u79cd\u5783\u573e\u56de\u6536\u5668\u7b49\u7b49\u3002\u5177\u4f53\u7684\u6307\u4ee4\u8fd8\u771f\u8bb0\u4e0d\u592a\u6e05\u695a\u3002 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u4f60\u4eec\u5e73\u65f6\u8c03\u8bd5 JVM\u90fd\u7528\u4e86\u54ea\u4e9b\u5de5\u5177\u5462\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u662f\u4f7f\u7528jdk\u81ea\u5e26\u7684\u4e00\u4e9b\u5de5\u5177\uff0c\u6bd4\u5982 jps \u8f93\u51faJVM\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f jstack\u67e5\u770bjava\u8fdb\u7a0b\u5185 \u7ebf\u7a0b\u7684\u5806\u6808 \u4fe1\u606f\u3002 jmap \u7528\u4e8e\u751f\u6210\u5806\u8f6c\u5b58\u5feb\u7167 jstat\u7528\u4e8eJVM\u7edf\u8ba1\u76d1\u6d4b\u5de5\u5177 \u8fd8\u6709\u4e00\u4e9b\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u50cfjconsole\u548cVisualVM\u7b49 \u9762\u8bd5\u5b98 \uff1a\u5047\u5982\u9879\u76ee\u4e2d\u4ea7\u751f\u4e86java\u5185\u5b58\u6cc4\u9732\uff0c\u4f60\u8bf4\u4e00\u4e0b\u4f60\u7684\u6392\u67e5\u601d\u8def\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e2a\u6211\u5728\u4e4b\u524d\u9879\u76ee\u6392\u67e5\u8fc7 \u7b2c\u4e00\u5462\u53ef\u4ee5\u901a\u8fc7jmap\u6307\u5b9a\u6253\u5370\u4ed6\u7684\u5185\u5b58\u5feb\u7167 dump\u6587\u4ef6\uff0c\u4e0d\u8fc7\u6709\u7684\u60c5\u51b5\u6253\u5370\u4e0d\u4e86\uff0c\u6211\u4eec\u4f1a\u8bbe\u7f6evm\u53c2\u6570\u8ba9\u7a0b\u5e8f\u81ea\u52a8\u751f\u6210dump\u6587\u4ef6 \u7b2c\u4e8c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\u53bb\u5206\u6790 dump\u6587\u4ef6\uff0cjdk\u81ea\u5e26\u7684VisualVM\u5c31\u53ef\u4ee5\u5206\u6790 \u7b2c\u4e09\uff0c\u901a\u8fc7\u67e5\u770b\u5806\u4fe1\u606f\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5927\u6982\u5b9a\u4f4d\u5185\u5b58\u6ea2\u51fa\u662f\u54ea\u884c\u4ee3\u7801\u51fa\u4e86\u95ee\u9898 \u7b2c\u56db\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\uff0c\u901a\u8fc7\u9605\u8bfb\u4e0a\u4e0b\u6587\u7684\u60c5\u51b5\uff0c\u8fdb\u884c\u4fee\u590d\u5373\u53ef \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u73b0\u5728\u518d\u6765\u8bf4\u4e00\u79cd\u60c5\u51b5\uff0c\u5c31\u662f\u8bf4\u670d\u52a1\u5668CPU\u6301\u7eed\u98d9\u9ad8\uff0c\u4f60\u7684\u6392\u67e5\u65b9\u6848\u4e0e\u601d\u8def\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u6211\u601d\u8003\u4e00\u4e0b~~ \u53ef\u4ee5\u8fd9\u4e48\u505a~~ \u7b2c\u4e00\u53ef\u4ee5\u4f7f\u7528\u4f7f\u7528top\u547d\u4ee4\u67e5\u770b\u5360\u7528cpu\u7684\u60c5\u51b5 \u7b2c\u4e8c\u901a\u8fc7top\u547d\u4ee4\u67e5\u770b\u540e\uff0c\u53ef\u4ee5\u67e5\u770b\u662f\u54ea\u4e00\u4e2a\u8fdb\u7a0b\u5360\u7528cpu\u8f83\u9ad8\uff0c\u8bb0\u5f55\u8fd9\u4e2a\u8fdb\u7a0bid \u7b2c\u4e09\u53ef\u4ee5\u901a\u8fc7ps \u67e5\u770b\u5f53\u524d\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u4fe1\u606f\uff0c\u770b\u770b\u54ea\u4e2a\u7ebf\u7a0b\u7684cpu\u5360\u7528\u8f83\u9ad8 \u7b2c\u56db\u53ef\u4ee5jstack\u547d\u4ee4\u6253\u5370\u8fdb\u884c\u7684id\uff0c\u627e\u5230\u8fd9\u4e2a\u7ebf\u7a0b\uff0c\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u95ee\u9898\u4ee3\u7801\u7684\u884c\u53f7","title":"JVM\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#jvm","text":"","title":"JVM\u76f8\u5173\u9762\u8bd5\u9898"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#1-jvm","text":"","title":"1 JVM\u7ec4\u6210"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#11-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 JVM\u662f\u4ec0\u4e48 Java Virtual Machine Java\u7a0b\u5e8f\u7684\u8fd0\u884c\u73af\u5883\uff08java\u4e8c\u8fdb\u5236\u5b57\u8282\u7801\u7684\u8fd0\u884c\u73af\u5883\uff09 \u597d\u5904\uff1a \u4e00\u6b21\u7f16\u5199\uff0c\u5230\u5904\u8fd0\u884c \u81ea\u52a8\u5185\u5b58\u7ba1\u7406\uff0c\u5783\u573e\u56de\u6536\u673a\u5236 JVM\u7531\u54ea\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f \u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fa JVM \u7684\u4e3b\u8981\u7ec4\u6210\u90e8\u5206 ClassLoader\uff08\u7c7b\u52a0\u8f7d\u5668\uff09 Runtime Data Area\uff08\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff0c\u5185\u5b58\u5206\u533a\uff09 Execution Engine\uff08\u6267\u884c\u5f15\u64ce\uff09 Native Method Library\uff08\u672c\u5730\u5e93\u63a5\u53e3\uff09 \u8fd0\u884c\u6d41\u7a0b\uff1a \uff081\uff09\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u628aJava\u4ee3\u7801\u8f6c\u6362\u4e3a\u5b57\u8282\u7801 \uff082\uff09\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff08Runtime Data Area\uff09\u628a\u5b57\u8282\u7801\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u5b57\u8282\u7801\u6587\u4ef6\u53ea\u662fJVM\u7684\u4e00\u5957\u6307\u4ee4\u96c6\u89c4\u8303\uff0c\u5e76\u4e0d\u80fd\u76f4\u63a5\u4ea4\u7ed9\u5e95\u5c42\u7cfb\u7edf\u53bb\u6267\u884c\uff0c\u800c\u662f\u6709\u6267\u884c\u5f15\u64ce\u8fd0\u884c \uff083\uff09\u6267\u884c\u5f15\u64ce\uff08Execution Engine\uff09\u5c06\u5b57\u8282\u7801\u7ffb\u8bd1\u4e3a\u5e95\u5c42\u7cfb\u7edf\u6307\u4ee4\uff0c\u518d\u4ea4\u7531CPU\u6267\u884c\u53bb\u6267\u884c\uff0c\u6b64\u65f6\u9700\u8981\u8c03\u7528\u5176\u4ed6\u8bed\u8a00\u7684\u672c\u5730\u5e93\u63a5\u53e3\uff08Native Method Library\uff09\u6765\u5b9e\u73b0\u6574\u4e2a\u7a0b\u5e8f\u7684\u529f\u80fd\u3002","title":"1.1 JVM\u7531\u90a3\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#12","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7a0b\u5e8f\u8ba1\u6570\u5668\uff1a\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u5185\u90e8\u4fdd\u5b58\u7684\u5b57\u8282\u7801\u7684\u884c\u53f7\u3002\u7528\u4e8e\u8bb0\u5f55\u6b63\u5728\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u7684\u5730\u5740\u3002 javap -verbose xx.class \u6253\u5370\u5806\u6808\u5927\u5c0f\uff0c\u5c40\u90e8\u53d8\u91cf\u7684\u6570\u91cf\u548c\u65b9\u6cd5\u7684\u53c2\u6570\u3002 \u200b java\u865a\u62df\u673a\u5bf9\u4e8e\u591a\u7ebf\u7a0b\u662f\u901a\u8fc7\u7ebf\u7a0b\u8f6e\u6d41\u5207\u6362\u5e76\u4e14\u5206\u914d\u7ebf\u7a0b\u6267\u884c\u65f6\u95f4\u3002\u5728\u4efb\u4f55\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u53ea\u4f1a\u5904\u7406\u6267\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u5f53\u524d\u88ab\u6267\u884c\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u5b83\u6240\u5206\u914d\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\u3010\u6302\u8d77\u3011\u3002\u5904\u7406\u5668\u4f1a\u5207\u6362\u5230\u53e6\u5916\u7684\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6765\u8fdb\u884c\u6267\u884c\u3002\u5e76\u4e14\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\uff0c\u63a5\u7740\u5904\u7406\u5668\u5c31\u4f1a\u53c8\u6765\u6267\u884c\u88ab\u6302\u8d77\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u3002 \u200b \u90a3\u4e48\u73b0\u5728\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\uff0c\u5f53\u524d\u5904\u7406\u5668\u5982\u4f55\u80fd\u591f\u77e5\u9053\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u88ab\u6302\u8d77\u7684\u7ebf\u7a0b\uff0c\u5b83\u4e0a\u4e00\u6b21\u6267\u884c\u5230\u4e86\u54ea\u91cc\uff1f\u90a3\u4e48\u8fd9\u65f6\u5c31\u9700\u8981\u4ece\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u6765\u56de\u53bb\u5230\u5f53\u524d\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u4ed6\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u884c\u53f7\uff0c\u7136\u540e\u63a5\u7740\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002 \u200b \u7a0b\u5e8f\u8ba1\u6570\u5668\u662fJVM\u89c4\u8303\u4e2d\u552f\u4e00\u4e00\u4e2a\u6ca1\u6709\u89c4\u5b9a\u51fa\u73b0OOM\u7684\u533a\u57df\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7a7a\u95f4\u4e5f\u4e0d\u4f1a\u8fdb\u884cGC\u3002","title":"1.2 \u4ec0\u4e48\u662f\u7a0b\u5e8f\u8ba1\u6570\u5668\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#13-java","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df\uff1a\u4e3b\u8981\u7528\u6765\u4fdd\u5b58\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u6570\u7ec4\u7b49\uff0c\u5f53\u5806\u4e2d\u6ca1\u6709\u5185\u5b58\u7a7a\u95f4\u53ef\u5206\u914d\u7ed9\u5b9e\u4f8b\uff0c\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5219\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002 \u5e74\u8f7b\u4ee3\u88ab\u5212\u5206\u4e3a\u4e09\u90e8\u5206\uff0cEden\u533a\u548c\u4e24\u4e2a\u5927\u5c0f\u4e25\u683c\u76f8\u540c\u7684Survivor\u533a\uff0c\u6839\u636eJVM\u7684\u7b56\u7565\uff0c\u5728\u7ecf\u8fc7\u51e0\u6b21\u5783\u573e\u6536\u96c6\u540e\uff0c\u4efb\u7136\u5b58\u6d3b\u4e8eSurvivor\u7684\u5bf9\u8c61\u5c06\u88ab\u79fb\u52a8\u5230\u8001\u5e74\u4ee3\u533a\u95f4\u3002 \u8001\u5e74\u4ee3\u4e3b\u8981\u4fdd\u5b58\u751f\u547d\u5468\u671f\u957f\u7684\u5bf9\u8c61\uff0c\u4e00\u822c\u662f\u4e00\u4e9b\u8001\u7684\u5bf9\u8c61 \u5143\u7a7a\u95f4\u4fdd\u5b58\u7684\u7c7b\u4fe1\u606f\u3001\u9759\u6001\u53d8\u91cf\u3001\u5e38\u91cf\u3001\u7f16\u8bd1\u540e\u7684\u4ee3\u7801 \u200b \u4e3a\u4e86\u907f\u514d\u65b9\u6cd5\u533a\u51fa\u73b0OOM\uff0c\u6240\u4ee5\u5728java8\u4e2d\u5c06\u5806\u4e0a\u7684\u65b9\u6cd5\u533a\u3010\u6c38\u4e45\u4ee3\u3011\u7ed9\u79fb\u52a8\u5230\u4e86\u672c\u5730\u5185\u5b58\u4e0a\uff0c\u91cd\u65b0\u5f00\u8f9f\u4e86\u4e00\u5757\u7a7a\u95f4\uff0c\u53eb\u505a \u5143\u7a7a\u95f4 \u3002\u90a3\u4e48\u73b0\u5728\u5c31\u53ef\u4ee5\u907f\u514d\u6389OOM\u7684\u51fa\u73b0\u4e86\u3002","title":"1.3 \u4f60\u80fd\u7ed9\u6211\u8be6\u7ec6\u7684\u4ecb\u7ecdJava\u5806\u5417?"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#metaspace","text":"\u200b \u5728 HotSpot JVM \u4e2d\uff0c\u6c38\u4e45\u4ee3\uff08 \u2248 \u65b9\u6cd5\u533a\uff09\u4e2d\u7528\u4e8e\u5b58\u653e\u7c7b\u548c\u65b9\u6cd5\u7684\u5143\u6570\u636e\u4ee5\u53ca\u5e38\u91cf\u6c60\uff0c\u6bd4\u5982Class \u548c Method\u3002\u6bcf\u5f53\u4e00\u4e2a\u7c7b\u521d\u6b21\u88ab\u52a0\u8f7d\u7684\u65f6\u5019\uff0c\u5b83\u7684\u5143\u6570\u636e\u90fd\u4f1a\u653e\u5230\u6c38\u4e45\u4ee3\u4e2d\u3002 \u200b \u6c38\u4e45\u4ee3\u662f\u6709\u5927\u5c0f\u9650\u5236\u7684\uff0c\u56e0\u6b64\u5982\u679c\u52a0\u8f7d\u7684\u7c7b\u592a\u591a\uff0c\u5f88\u6709\u53ef\u80fd\u5bfc\u81f4\u6c38\u4e45\u4ee3\u5185\u5b58\u6ea2\u51fa\uff0c\u5373OutOfMemoryError\uff0c\u4e3a\u6b64\u4e0d\u5f97\u4e0d\u5bf9\u865a\u62df\u673a\u505a\u8c03\u4f18\u3002 \u200b \u90a3\u4e48\uff0cJava 8 \u4e2d PermGen \u4e3a\u4ec0\u4e48\u88ab\u79fb\u51fa HotSpot JVM \u4e86\uff1f \u5b98\u7f51\u7ed9\u51fa\u4e86\u89e3\u91ca\uff1ahttp://openjdk.java.net/jeps/122 This is part of the JRockit and Hotspot convergence effort. JRockit customers do not need to configure the permanent generation (since JRockit does not have a permanent generation) and are accustomed to not configuring the permanent generation. \u79fb\u9664\u6c38\u4e45\u4ee3\u662f\u4e3a\u878d\u5408HotSpot JVM\u4e0e JRockit VM\u800c\u505a\u51fa\u7684\u52aa\u529b\uff0c\u56e0\u4e3aJRockit\u6ca1\u6709\u6c38\u4e45\u4ee3\uff0c\u4e0d\u9700\u8981\u914d\u7f6e\u6c38\u4e45\u4ee3\u3002 1\uff09\u7531\u4e8e PermGen \u5185\u5b58\u7ecf\u5e38\u4f1a\u6ea2\u51fa\uff0c\u5f15\u53d1OutOfMemoryError\uff0c\u56e0\u6b64 JVM \u7684\u5f00\u53d1\u8005\u5e0c\u671b\u8fd9\u4e00\u5757\u5185\u5b58\u53ef\u4ee5\u66f4\u7075\u6d3b\u5730\u88ab\u7ba1\u7406\uff0c\u4e0d\u8981\u518d\u7ecf\u5e38\u51fa\u73b0\u8fd9\u6837\u7684 OOM\u3002 2\uff09\u79fb\u9664 PermGen \u53ef\u4ee5\u4fc3\u8fdb HotSpot JVM \u4e0e JRockit VM \u7684\u878d\u5408\uff0c\u56e0\u4e3a JRockit \u6ca1\u6709\u6c38\u4e45\u4ee3\u3002 \u200b \u51c6\u786e\u6765\u8bf4\uff0cPerm \u533a\u4e2d\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u88ab\u79fb\u5230\u4e86\u5806\u5185\u5b58\u4e2d\u662f\u5728 Java7 \u4e4b\u540e\uff0cJava 8 \u65f6\uff0cPermGen \u88ab\u5143\u7a7a\u95f4\u4ee3\u66ff\uff0c\u5176\u4ed6\u5185\u5bb9\u6bd4\u5982 \u7c7b\u5143\u4fe1\u606f\u3001\u5b57\u6bb5\u3001\u9759\u6001\u5c5e\u6027\u3001\u65b9\u6cd5\u3001\u5e38\u91cf \u7b49\u90fd\u79fb\u52a8\u5230\u5143\u7a7a\u95f4\u533a\u3002\u6bd4\u5982 java/lang/Object \u7c7b\u5143\u4fe1\u606f\u3001\u9759\u6001\u5c5e\u6027 System.out\u3001\u6574\u578b\u5e38\u91cf\u7b49\u3002 \u200b \u5143\u7a7a\u95f4\u7684\u672c\u8d28\u548c\u6c38\u4e45\u4ee3\u7c7b\u4f3c\uff0c\u90fd\u662f\u5bf9 JVM \u89c4\u8303\u4e2d\u65b9\u6cd5\u533a\u7684\u5b9e\u73b0\u3002\u4e0d\u8fc7\u5143\u7a7a\u95f4\u4e0e\u6c38\u4e45\u4ee3\u4e4b\u95f4\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\uff1a\u5143\u7a7a\u95f4\u5e76\u4e0d\u5728\u865a\u62df\u673a\u4e2d\uff0c\u800c\u662f\u4f7f\u7528\u672c\u5730\u5185\u5b58\u3002\u56e0\u6b64\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5143\u7a7a\u95f4\u7684\u5927\u5c0f\u4ec5\u53d7\u672c\u5730\u5185\u5b58\u9650\u5236\u3002","title":"\u5143\u7a7a\u95f4(MetaSpace)\u4ecb\u7ecd"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#14","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 Java Virtual machine Stacks (java \u865a\u62df\u673a\u6808) \u6bcf\u4e2a\u7ebf\u7a0b\u8fd0\u884c\u65f6\u6240\u9700\u8981\u7684\u5185\u5b58\uff0c\u79f0\u4e3a\u865a\u62df\u673a\u6808\uff0c\u5148\u8fdb\u540e\u51fa \u6bcf\u4e2a\u6808\u7531\u591a\u4e2a\u6808\u5e27\uff08frame\uff09\u7ec4\u6210\uff0c\u5bf9\u5e94\u7740\u6bcf\u6b21\u65b9\u6cd5\u8c03\u7528\u65f6\u6240\u5360\u7528\u7684\u5185\u5b58 \u6bcf\u4e2a\u7ebf\u7a0b\u53ea\u80fd\u6709\u4e00\u4e2a\u6d3b\u52a8\u6808\u5e27\uff0c\u5bf9\u5e94\u7740\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u90a3\u4e2a\u65b9\u6cd5 \u5783\u573e\u56de\u6536\u662f\u5426\u6d89\u53ca\u6808\u5185\u5b58\uff1f \u5783\u573e\u56de\u6536\u4e3b\u8981\u6307\u5c31\u662f\u5806\u5185\u5b58\uff0c\u5f53\u6808\u5e27\u5f39\u6808\u4ee5\u540e\uff0c\u5185\u5b58\u5c31\u4f1a\u91ca\u653e \u6808\u5185\u5b58\u5206\u914d\u8d8a\u5927\u8d8a\u597d\u5417\uff1f \u672a\u5fc5\uff0c\u9ed8\u8ba4\u7684\u6808\u5185\u5b58\u901a\u5e38\u4e3a1024k \u6808\u5e27\u8fc7\u5927\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u6570\u53d8\u5c11\uff0c\u4f8b\u5982\uff0c\u673a\u5668\u603b\u5185\u5b58\u4e3a512m\uff0c\u76ee\u524d\u80fd\u6d3b\u52a8\u7684\u7ebf\u7a0b\u6570\u5219\u4e3a512\u4e2a\uff0c\u5982\u679c\u628a\u6808\u5185\u5b58\u6539\u4e3a2048k\uff0c\u90a3\u4e48\u80fd\u6d3b\u52a8\u7684\u6808\u5e27\u5c31\u4f1a\u51cf\u534a \u65b9\u6cd5\u5185\u7684\u5c40\u90e8\u53d8\u91cf\u662f\u5426\u7ebf\u7a0b\u5b89\u5168\uff1f \u5982\u679c\u65b9\u6cd5\u5185\u5c40\u90e8\u53d8\u91cf\u6ca1\u6709\u9003\u79bb\u65b9\u6cd5\u7684\u4f5c\u7528\u8303\u56f4\uff0c\u5b83\u662f\u7ebf\u7a0b\u5b89\u5168\u7684 \u5982\u679c\u662f\u5c40\u90e8\u53d8\u91cf\u5f15\u7528\u4e86\u5bf9\u8c61\uff0c\u5e76\u9003\u79bb\u65b9\u6cd5\u7684\u4f5c\u7528\u8303\u56f4\uff0c\u9700\u8981\u8003\u8651\u7ebf\u7a0b\u5b89\u5168 \u6bd4\u5982\u4ee5\u4e0b\u4ee3\u7801\uff1a \u6808\u5185\u5b58\u6ea2\u51fa\u60c5\u51b5 \u6808\u5e27\u8fc7\u591a\u5bfc\u81f4\u6808\u5185\u5b58\u6ea2\u51fa\uff0c\u5178\u578b\u95ee\u9898\uff1a\u9012\u5f52\u8c03\u7528 \u6808\u5e27\u8fc7\u5927\u5bfc\u81f4\u6808\u5185\u5b58\u6ea2\u51fa \u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7ec4\u6210\u90e8\u5206\uff1a\u5806\u3001\u65b9\u6cd5\u533a\u3001\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668 1\u3001\u5806\u89e3\u51b3\u7684\u662f\u5bf9\u8c61\u5b9e\u4f8b\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u5783\u573e\u56de\u6536\u5668\u7ba1\u7406\u7684\u4e3b\u8981\u533a\u57df\u3002 2\u3001\u65b9\u6cd5\u533a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5806\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u5b58\u50a8\u5df2\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u3002 3\u3001\u6808\u89e3\u51b3\u7684\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u95ee\u9898\uff0c\u6808\u91cc\u9762\u5b58\u7684\u662f\u6808\u5e27\uff0c\u6808\u5e27\u91cc\u9762\u5b58\u7684\u662f\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\u3001\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002 4\u3001\u672c\u5730\u65b9\u6cd5\u6808\u4e0e\u6808\u529f\u80fd\u76f8\u540c\uff0c\u672c\u5730\u65b9\u6cd5\u6808\u6267\u884c\u7684\u662f\u672c\u5730\u65b9\u6cd5\uff0c\u4e00\u4e2aJava\u8c03\u7528\u975eJava\u4ee3\u7801\u7684\u63a5\u53e3\u3002 5\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\u5bc4\u5b58\u5668\uff09\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u5b58\u653e\u7684\u662f\u5f53\u524d\u7ebf\u7a0b\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u6570\u3002JVM\u5de5\u4f5c\u65f6\u5c31\u662f\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u4e2a\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u3002","title":"1.4 \u4ec0\u4e48\u662f\u865a\u62df\u673a\u6808"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#15","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"1.5 \u80fd\u4e0d\u80fd\u89e3\u91ca\u4e00\u4e0b\u65b9\u6cd5\u533a\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#151","text":"\u65b9\u6cd5\u533a(Method Area)\u662f\u5404\u4e2a\u7ebf\u7a0b\u5171\u4eab\u7684\u5185\u5b58\u533a\u57df \u4e3b\u8981\u5b58\u50a8\u7c7b\u7684\u4fe1\u606f\u3001\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60 \u865a\u62df\u673a\u542f\u52a8\u7684\u65f6\u5019\u521b\u5efa\uff0c\u5173\u95ed\u865a\u62df\u673a\u65f6\u91ca\u653e \u5982\u679c\u65b9\u6cd5\u533a\u57df\u4e2d\u7684\u5185\u5b58\u65e0\u6cd5\u6ee1\u8db3\u5206\u914d\u8bf7\u6c42\uff0c\u5219\u4f1a\u629b\u51faOutOfMemoryError: Metaspace","title":"1.5.1 \u6982\u8ff0"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#152","text":"\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u5f20\u8868\uff0c\u865a\u62df\u673a\u6307\u4ee4\u6839\u636e\u8fd9\u5f20\u5e38\u91cf\u8868\u627e\u5230\u8981\u6267\u884c\u7684\u7c7b\u540d\u3001\u65b9\u6cd5\u540d\u3001\u53c2\u6570\u7c7b\u578b\u3001\u5b57\u9762\u91cf\u7b49\u4fe1\u606f \u67e5\u770b\u5b57\u8282\u7801\u7ed3\u6784\uff08\u7c7b\u7684\u57fa\u672c\u4fe1\u606f\u3001\u5e38\u91cf\u6c60\u3001\u65b9\u6cd5\u5b9a\u4e49\uff09 javap -v xx.class \u6bd4\u5982\u4e0b\u9762\u662f\u4e00\u4e2aApplication\u7c7b\u7684main\u65b9\u6cd5\u6267\u884c\uff0c\u6e90\u7801\u5982\u4e0b\uff1a public class Application { public static void main(String[] args) { System.out.println(\"hello world\"); } } \u627e\u5230\u7c7b\u5bf9\u5e94\u7684class\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u6267\u884c\u547d\u4ee4\uff1a javap -v Application.class \u67e5\u770b\u5b57\u8282\u7801\u7ed3\u6784 D:\\code\\jvm-demo\\target\\classes\\com\\heima\\jvm>javap -v Application.class Classfile /D:/code/jvm-demo/target/classes/com/heima/jvm/Application.class Last modified 2023-05-07; size 564 bytes //\u6700\u540e\u4fee\u6539\u7684\u65f6\u95f4 MD5 checksum c1b64ed6491b9a16c2baab5061c64f88 //\u7b7e\u540d Compiled from \"Application.java\" //\u4ece\u54ea\u4e2a\u6e90\u7801\u7f16\u8bd1 public class com.heima.jvm.Application //\u5305\u540d\uff0c\u7c7b\u540d minor version: 0 major version: 52 //jdk\u7248\u672c flags: ACC_PUBLIC, ACC_SUPER //\u4fee\u9970\u7b26 Constant pool: //\u5e38\u91cf\u6c60 #1 = Methodref #6.#20 // java/lang/Object.\"<init>\":()V #2 = Fieldref #21.#22 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #23 // hello world #4 = Methodref #24.#25 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #26 // com/heima/jvm/Application #6 = Class #27 // java/lang/Object #7 = Utf8 <init> #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 LocalVariableTable #12 = Utf8 this #13 = Utf8 Lcom/heima/jvm/Application; #14 = Utf8 main #15 = Utf8 ([Ljava/lang/String;)V #16 = Utf8 args #17 = Utf8 [Ljava/lang/String; #18 = Utf8 SourceFile #19 = Utf8 Application.java #20 = NameAndType #7:#8 // \"<init>\":()V #21 = Class #28 // java/lang/System #22 = NameAndType #29:#30 // out:Ljava/io/PrintStream; #23 = Utf8 hello world #24 = Class #31 // java/io/PrintStream #25 = NameAndType #32:#33 // println:(Ljava/lang/String;)V #26 = Utf8 com/heima/jvm/Application #27 = Utf8 java/lang/Object #28 = Utf8 java/lang/System #29 = Utf8 out #30 = Utf8 Ljava/io/PrintStream; #31 = Utf8 java/io/PrintStream #32 = Utf8 println #33 = Utf8 (Ljava/lang/String;)V { public com.heima.jvm.Application(); //\u6784\u9020\u65b9\u6cd5 descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 // Method java/lang/Object.\"<init>\":()V 4: return LineNumberTable: line 3: 0 LocalVariableTable: Start Length Slot Name Signature 0 5 0 this Lcom/heima/jvm/Application; public static void main(java.lang.String[]); //main\u65b9\u6cd5 descriptor: ([Ljava/lang/String;)V flags: ACC_PUBLIC, ACC_STATIC Code: stack=2, locals=1, args_size=1 0: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 3: ldc #3 // String hello world 5: invokevirtual #4 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 8: return LineNumberTable: line 7: 0 line 8: 8 LocalVariableTable: Start Length Slot Name Signature 0 9 0 args [Ljava/lang/String; } SourceFile: \"Application.java\" \u4e0b\u56fe\uff0c\u5de6\u4fa7\u662fmain\u65b9\u6cd5\u7684\u6307\u4ee4\u4fe1\u606f\uff0c\u53f3\u4fa7constant pool \u662f\u5e38\u91cf\u6c60 main\u65b9\u6cd5\u6309\u7167\u6307\u4ee4\u6267\u884c\u7684\u65f6\u5019\uff0c\u9700\u8981\u5230\u5e38\u91cf\u6c60\u4e2d\u67e5\u8868\u7ffb\u8bd1\u627e\u5230\u5177\u4f53\u7684\u7c7b\u548c\u65b9\u6cd5\u5730\u5740\u53bb\u6267\u884c","title":"1.5.2 \u5e38\u91cf\u6c60"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#153","text":"\u5e38\u91cf\u6c60\u662f *.class \u6587\u4ef6\u4e2d\u7684\uff0c\u5f53\u8be5\u7c7b\u88ab\u52a0\u8f7d\uff0c\u5b83\u7684\u5e38\u91cf\u6c60\u4fe1\u606f\u5c31\u4f1a\u653e\u5165\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff0c\u5e76\u628a\u91cc\u9762\u7684\u7b26\u53f7\u5730\u5740\u53d8\u4e3a\u771f\u5b9e\u5730\u5740","title":"1.5.3 \u8fd0\u884c\u65f6\u5e38\u91cf\u6c60"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#16","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e0d\u53d7 JVM \u5185\u5b58\u56de\u6536\u7ba1\u7406\uff0c\u662f\u865a\u62df\u673a\u7684\u7cfb\u7edf\u5185\u5b58\uff0c\u5e38\u89c1\u4e8e NIO \u64cd\u4f5c\u65f6\uff0c\u7528\u4e8e\u6570\u636e\u7f13\u51b2\u533a\uff0c\u5206\u914d\u56de\u6536\u6210\u672c\u8f83\u9ad8\uff0c\u4f46\u8bfb\u5199\u6027\u80fd\u9ad8\uff0c\u4e0d\u53d7 JVM \u5185\u5b58\u56de\u6536\u7ba1\u7406 \u4e3e\u4f8b\uff1a \u9700\u6c42\uff0c\u5728\u672c\u5730\u7535\u8111\u4e2d\u7684\u4e00\u4e2a\u8f83\u5927\u7684\u6587\u4ef6\uff08\u8d85\u8fc7100m\uff09\u4ece\u4e00\u4e2a\u78c1\u76d8\u632a\u5230\u53e6\u5916\u4e00\u4e2a\u78c1\u76d8 \u4ee3\u7801\u5982\u4e0b\uff1a /** * \u6f14\u793a ByteBuffer \u4f5c\u7528 */ public class Demo1_9 { static final String FROM = \"E:\\\\\u7f16\u7a0b\u8d44\u6599\\\\\u7b2c\u4e09\u65b9\u6559\u5b66\u89c6\u9891\\\\youtube\\\\Getting Started with Spring Boot-sbPSjI4tt10.mp4\"; static final String TO = \"E:\\\\a.mp4\"; static final int _1Mb = 1024 * 1024; public static void main(String[] args) { io(); // io \u7528\u65f6\uff1a1535.586957 1766.963399 1359.240226 directBuffer(); // directBuffer \u7528\u65f6\uff1a479.295165 702.291454 562.56592 } private static void directBuffer() { long start = System.nanoTime(); try (FileChannel from = new FileInputStream(FROM).getChannel(); FileChannel to = new FileOutputStream(TO).getChannel(); ) { ByteBuffer bb = ByteBuffer.allocateDirect(_1Mb); while (true) { int len = from.read(bb); if (len == -1) { break; } bb.flip(); to.write(bb); bb.clear(); } } catch (IOException e) { e.printStackTrace(); } long end = System.nanoTime(); System.out.println(\"directBuffer \u7528\u65f6\uff1a\" + (end - start) / 1000_000.0); } private static void io() { long start = System.nanoTime(); try (FileInputStream from = new FileInputStream(FROM); FileOutputStream to = new FileOutputStream(TO); ) { byte[] buf = new byte[_1Mb]; while (true) { int len = from.read(buf); if (len == -1) { break; } to.write(buf, 0, len); } } catch (IOException e) { e.printStackTrace(); } long end = System.nanoTime(); System.out.println(\"io \u7528\u65f6\uff1a\" + (end - start) / 1000_000.0); } } \u53ef\u4ee5\u53d1\u73b0\uff0c\u4f7f\u7528\u4f20\u7edf\u7684IO\u7684\u65f6\u95f4\u8981\u6bd4NIO\u64cd\u4f5c\u7684\u65f6\u95f4\u957f\u4e86\u5f88\u591a\u4e86\uff0c\u4e5f\u5c31\u8bf4NIO\u7684\u8bfb\u6027\u80fd\u66f4\u597d\u3002 \u8fd9\u4e2a\u662f\u8ddf\u6211\u4eec\u7684JVM\u7684\u76f4\u63a5\u5185\u5b58\u662f\u6709\u4e00\u5b9a\u5173\u7cfb\uff0c\u5982\u4e0b\u56fe\uff0c\u662f\u4f20\u7edf\u963b\u585eIO\u7684\u6570\u636e\u4f20\u8f93\u6d41\u7a0b \u4e0b\u56fe\u662fNIO\u4f20\u8f93\u6570\u636e\u7684\u6d41\u7a0b\uff0c\u5728\u8fd9\u4e2a\u91cc\u9762\u4e3b\u8981\u4f7f\u7528\u5230\u4e86\u4e00\u4e2a\u76f4\u63a5\u5185\u5b58\uff0c\u4e0d\u9700\u8981\u5728\u5806\u4e2d\u5f00\u8f9f\u7a7a\u95f4\u8fdb\u884c\u6570\u636e\u7684\u62f7\u8d1d\uff0cjvm\u53ef\u4ee5\u76f4\u63a5\u64cd\u4f5c\u76f4\u63a5\u5185\u5b58\uff0c\u4ece\u800c\u4f7f\u6570\u636e\u8bfb\u5199\u4f20\u8f93\u66f4\u5feb\u3002","title":"1.6 \u4f60\u542c\u8fc7\u76f4\u63a5\u5185\u5b58\u5417\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#17","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 1\u3001\u6808\u5185\u5b58\u4e00\u822c\u4f1a\u7528\u6765\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u548c\u65b9\u6cd5\u8c03\u7528\uff0c\u4f46\u5806\u5185\u5b58\u662f\u7528\u6765\u5b58\u50a8Java\u5bf9\u8c61\u548c\u6570\u7ec4\u7684\u7684\u3002\u5806\u4f1aGC\u5783\u573e\u56de\u6536\uff0c\u800c\u6808\u4e0d\u4f1a\u3002 2\u3001\u6808\u5185\u5b58\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u800c\u5806\u5185\u5b58\u662f\u7ebf\u7a0b\u5171\u6709\u7684\u3002 3,\u3001\u4e24\u8005\u5f02\u5e38\u9519\u8bef\u4e0d\u540c\uff0c\u4f46\u5982\u679c\u6808\u5185\u5b58\u6216\u8005\u5806\u5185\u5b58\u4e0d\u8db3\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\u3002 \u6808\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.StackOverFlowError\u3002 \u5806\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.OutOfMemoryError\u3002","title":"1.7 \u5806\u6808\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#2","text":"","title":"2 \u7c7b\u52a0\u8f7d\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#21","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u8981\u60f3\u7406\u89e3\u7c7b\u52a0\u8f7d\u5668\u7684\u8bdd\uff0c\u52a1\u5fc5\u8981\u5148\u6e05\u695a\u5bf9\u4e8e\u4e00\u4e2aJava\u6587\u4ef6\uff0c\u5b83\u4ece\u7f16\u8bd1\u5230\u6267\u884c\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002 \u7c7b\u52a0\u8f7d\u5668\uff1a\u7528\u4e8e\u88c5\u8f7d\u5b57\u8282\u7801\u6587\u4ef6(.class\u6587\u4ef6) \u8fd0\u884c\u65f6\u6570\u636e\u533a\uff1a\u7528\u4e8e\u5206\u914d\u5b58\u50a8\u7a7a\u95f4 \u6267\u884c\u5f15\u64ce\uff1a\u6267\u884c\u5b57\u8282\u7801\u6587\u4ef6\u6216\u672c\u5730\u65b9\u6cd5 \u5783\u573e\u56de\u6536\u5668\uff1a\u7528\u4e8e\u5bf9JVM\u4e2d\u7684\u5783\u573e\u5185\u5bb9\u8fdb\u884c\u56de\u6536 \u7c7b\u52a0\u8f7d\u5668 JVM\u53ea\u4f1a\u8fd0\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u800c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5c06 \u5b57\u8282\u7801\u6587\u4ef6\u52a0\u8f7d\u5230JVM\u4e2d \uff0c\u4ece\u800c\u8ba9Java\u7a0b\u5e8f\u80fd\u591f\u542f\u52a8\u8d77\u6765\u3002\u73b0\u6709\u7684\u7c7b\u52a0\u8f7d\u5668\u57fa\u672c\u4e0a\u90fd\u662fjava.lang.ClassLoader\u7684\u5b50\u7c7b\uff0c\u8be5\u7c7b\u7684\u53ea\u8981\u804c\u8d23\u5c31\u662f\u7528\u4e8e\u5c06\u6307\u5b9a\u7684\u7c7b\u627e\u5230\u6216\u751f\u6210\u5bf9\u5e94\u7684\u5b57\u8282\u7801\u6587\u4ef6\uff0c\u540c\u65f6\u7c7b\u52a0\u8f7d\u5668\u8fd8\u4f1a\u8d1f\u8d23\u52a0\u8f7d\u7a0b\u5e8f\u6240\u9700\u8981\u7684\u8d44\u6e90 \u7c7b\u52a0\u8f7d\u5668\u79cd\u7c7b \u7c7b\u52a0\u8f7d\u5668\u6839\u636e\u5404\u81ea\u52a0\u8f7d\u8303\u56f4\u7684\u4e0d\u540c\uff0c\u5212\u5206\u4e3a\u56db\u79cd\u7c7b\u52a0\u8f7d\u5668\uff1a \u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(BootStrap ClassLoader)\uff1a \u8be5\u7c7b\u5e76\u4e0d\u7ee7\u627fClassLoader\u7c7b\uff0c\u5176\u662f\u7531C++\u7f16\u5199\u5b9e\u73b0\u3002\u7528\u4e8e\u52a0\u8f7d JAVA_HOME/jre/lib \u76ee\u5f55\u4e0b\u7684\u7c7b\u5e93\u3002 \u6269\u5c55\u7c7b\u52a0\u8f7d\u5668(ExtClassLoader)\uff1a \u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u52a0\u8f7d JAVA_HOME/jre/lib/ext \u76ee\u5f55\u4e2d\u7684\u7c7b\u5e93\u3002 \u5e94\u7528\u7c7b\u52a0\u8f7d\u5668(AppClassLoader)\uff1a \u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u7528\u4e8e\u52a0\u8f7d classPath \u4e0b\u7684\u7c7b\uff0c\u4e5f\u5c31\u662f\u52a0\u8f7d\u5f00\u53d1\u8005\u81ea\u5df1\u7f16\u5199\u7684Java\u7c7b\u3002 \u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\uff1a \u5f00\u53d1\u8005\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627fClassLoader\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u89c4\u5219\u3002 \u4e0a\u8ff0\u4e09\u79cd\u7c7b\u52a0\u8f7d\u5668\u7684\u5c42\u6b21\u7ed3\u6784\u5982\u4e0b\u5982\u4e0b\uff1a \u7c7b\u52a0\u8f7d\u5668\u7684\u4f53\u7cfb\u5e76\u4e0d\u662f\u201c\u7ee7\u627f\u201d\u4f53\u7cfb\uff0c\u800c\u662f \u59d4\u6d3e\u4f53\u7cfb \uff0c\u7c7b\u52a0\u8f7d\u5668\u9996\u5148\u4f1a\u5230\u81ea\u5df1\u7684parent\u4e2d\u67e5\u627e\u7c7b\u6216\u8005\u8d44\u6e90\uff0c\u5982\u679c\u627e\u4e0d\u5230\u624d\u4f1a\u5230\u81ea\u5df1\u672c\u5730\u67e5\u627e\u3002\u7c7b\u52a0\u8f7d\u5668\u7684\u59d4\u6258\u884c\u4e3a\u52a8\u673a\u662f\u4e3a\u4e86\u907f\u514d\u76f8\u540c\u7684\u7c7b\u88ab\u52a0\u8f7d\u591a\u6b21\u3002","title":"2.1 \u4ec0\u4e48\u662f\u7c7b\u52a0\u8f7d\u5668\uff0c\u7c7b\u52a0\u8f7d\u5668\u6709\u54ea\u4e9b?"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#22","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u5982\u679c\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u5728\u63a5\u5230\u52a0\u8f7d\u7c7b\u7684\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u4e0d\u4f1a\u81ea\u5df1\u5c1d\u8bd5\u53bb\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\uff0c\u800c\u662f\u628a\u8fd9\u4e2a\u8bf7\u6c42\u4efb\u52a1\u59d4\u6258\u7ed9\u7236\u7c7b\u52a0\u8f7d\u5668\u53bb\u5b8c\u6210\uff0c\u4f9d\u6b21\u9012\u5f52\uff0c\u5982\u679c\u7236\u7c7b\u52a0\u8f7d\u5668\u53ef\u4ee5\u5b8c\u6210\u7c7b\u52a0\u8f7d\u4efb\u52a1\uff0c\u5c31\u8fd4\u56de\u6210\u529f\uff1b\u53ea\u6709\u7236\u7c7b\u52a0\u8f7d\u5668\u65e0\u6cd5\u5b8c\u6210\u6b64\u52a0\u8f7d\u4efb\u52a1\u65f6\uff0c\u624d\u7531\u4e0b\u4e00\u7ea7\u53bb\u52a0\u8f7d\u3002","title":"2.2 \u4ec0\u4e48\u662f\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#23-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \uff081\uff09\u901a\u8fc7\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236\u53ef\u4ee5\u907f\u514d\u67d0\u4e00\u4e2a\u7c7b\u88ab\u91cd\u590d\u52a0\u8f7d\uff0c\u5f53\u7236\u7c7b\u5df2\u7ecf\u52a0\u8f7d\u540e\u5219\u65e0\u9700\u91cd\u590d\u52a0\u8f7d\uff0c\u4fdd\u8bc1\u552f\u4e00\u6027\u3002 \uff082\uff09\u4e3a\u4e86\u5b89\u5168\uff0c\u4fdd\u8bc1\u7c7b\u5e93API\u4e0d\u4f1a\u88ab\u4fee\u6539 \u5728\u5de5\u7a0b\u4e2d\u65b0\u5efajava.lang\u5305\uff0c\u63a5\u7740\u5728\u8be5\u5305\u4e0b\u65b0\u5efaString\u7c7b\uff0c\u5e76\u5b9a\u4e49main\u51fd\u6570 public class String { public static void main(String[] args) { System.out.println(\"demo info\"); } } \u200b \u6b64\u65f6\u6267\u884cmain\u51fd\u6570\uff0c\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u5728\u7c7b java.lang.String \u4e2d\u627e\u4e0d\u5230 main \u65b9\u6cd5 \u200b \u51fa\u73b0\u8be5\u4fe1\u606f\u662f\u56e0\u4e3a\u7531\u53cc\u4eb2\u59d4\u6d3e\u7684\u673a\u5236\uff0cjava.lang.String\u7684\u5728\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(Bootstrap classLoader)\u5f97\u5230\u52a0\u8f7d\uff0c\u56e0\u4e3a\u5728\u6838\u5fc3jre\u5e93\u4e2d\u6709\u5176\u76f8\u540c\u540d\u5b57\u7684\u7c7b\u6587\u4ef6\uff0c\u4f46\u8be5\u7c7b\u4e2d\u5e76\u6ca1\u6709main\u65b9\u6cd5\u3002\u8fd9\u6837\u5c31\u80fd\u9632\u6b62\u6076\u610f\u7be1\u6539\u6838\u5fc3API\u5e93\u3002","title":"2.3 JVM\u4e3a\u4ec0\u4e48\u91c7\u7528\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#24","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u7c7b\u4ece\u52a0\u8f7d\u5230\u865a\u62df\u673a\u4e2d\u5f00\u59cb\uff0c\u76f4\u5230\u5378\u8f7d\u4e3a\u6b62\uff0c\u5b83\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5305\u62ec\u4e86\uff1a\u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u89e3\u6790\u3001\u521d\u59cb\u5316\u3001\u4f7f\u7528\u548c\u5378\u8f7d\u8fd97\u4e2a\u9636\u6bb5\u3002\u5176\u4e2d\uff0c\u9a8c\u8bc1\u3001\u51c6\u5907\u548c\u89e3\u6790\u8fd9\u4e09\u4e2a\u90e8\u5206\u7edf\u79f0\u4e3a\u8fde\u63a5\uff08linking\uff09\u3002 \u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u8be6\u89e3 1.\u52a0\u8f7d \u901a\u8fc7\u7c7b\u7684\u5168\u540d\uff0c\u83b7\u53d6\u7c7b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\u3002 \u89e3\u6790\u7c7b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\u4e3a\u65b9\u6cd5\u533a\u5185\u7684\u6570\u636e\u7ed3\u6784\uff08Java\u7c7b\u6a21\u578b\uff09 \u521b\u5efajava.lang.Class\u7c7b\u7684\u5b9e\u4f8b\uff0c\u8868\u793a\u8be5\u7c7b\u578b\u3002\u4f5c\u4e3a\u65b9\u6cd5\u533a\u8fd9\u4e2a\u7c7b\u7684\u5404\u79cd\u6570\u636e\u7684\u8bbf\u95ee\u5165\u53e3 2.\u9a8c\u8bc1 \u9a8c\u8bc1\u7c7b\u662f\u5426\u7b26\u5408JVM\u89c4\u8303\uff0c\u5b89\u5168\u6027\u68c0\u67e5 (1)\u6587\u4ef6\u683c\u5f0f\u9a8c\u8bc1:\u662f\u5426\u7b26\u5408Class\u6587\u4ef6\u7684\u89c4\u8303 (2)\u5143\u6570\u636e\u9a8c\u8bc1 \u8fd9\u4e2a\u7c7b\u662f\u5426\u6709\u7236\u7c7b\uff08\u9664\u4e86Object\u8fd9\u4e2a\u7c7b\u4e4b\u5916\uff0c\u5176\u4f59\u7684\u7c7b\u90fd\u5e94\u8be5\u6709\u7236\u7c7b\uff09 \u8fd9\u4e2a\u7c7b\u662f\u5426\u7ee7\u627f\uff08extends\uff09\u4e86\u88abfinal\u4fee\u9970\u8fc7\u7684\u7c7b\uff08\u88abfinal\u4fee\u9970\u8fc7\u7684\u7c7b\u8868\u793a\u7c7b\u4e0d\u80fd\u88ab\u7ee7\u627f\uff09 \u7c7b\u4e2d\u7684\u5b57\u6bb5\u3001\u65b9\u6cd5\u662f\u5426\u4e0e\u7236\u7c7b\u4ea7\u751f\u77db\u76fe\u3002\uff08\u88abfinal\u4fee\u9970\u8fc7\u7684\u65b9\u6cd5\u6216\u5b57\u6bb5\u662f\u4e0d\u80fd\u8986\u76d6\u7684\uff09 (3)\u5b57\u8282\u7801\u9a8c\u8bc1 \u4e3b\u8981\u7684\u76ee\u7684\u662f\u901a\u8fc7\u5bf9\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u7684\u5206\u6790\uff0c\u786e\u5b9a\u7a0b\u5e8f\u8bed\u4e49\u662f\u5408\u6cd5\u7684\u3001\u7b26\u5408\u903b\u8f91\u7684\u3002 (4)\u7b26\u53f7\u5f15\u7528\u9a8c\u8bc1\uff1a\u7b26\u53f7\u5f15\u7528\u4ee5\u4e00\u7ec4\u7b26\u53f7\u6765\u63cf\u8ff0\u6240\u5f15\u7528\u7684\u76ee\u6807\uff0c\u7b26\u53f7\u53ef\u4ee5\u662f\u4efb\u4f55\u5f62\u5f0f\u7684\u5b57\u9762\u91cf \u6bd4\u5982\uff1aint i = 3; \u5b57\u9762\u91cf\uff1a3 \u7b26\u53f7\u5f15\u7528\uff1ai 3.\u51c6\u5907 \u4e3a\u7c7b\u53d8\u91cf\u5206\u914d\u5185\u5b58\u5e76\u8bbe\u7f6e\u7c7b\u53d8\u91cf\u521d\u59cb\u503c static\u53d8\u91cf\uff0c\u5206\u914d\u7a7a\u95f4\u5728\u51c6\u5907\u9636\u6bb5\u5b8c\u6210\uff08\u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff09\uff0c\u8d4b\u503c\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5b8c\u6210 static\u53d8\u91cf\u662ffinal\u7684\u57fa\u672c\u7c7b\u578b\uff0c\u4ee5\u53ca\u5b57\u7b26\u4e32\u5e38\u91cf\uff0c\u503c\u5df2\u786e\u5b9a\uff0c\u8d4b\u503c\u5728\u51c6\u5907\u9636\u6bb5\u5b8c\u6210 static\u53d8\u91cf\u662ffinal\u7684\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u4e48\u8d4b\u503c\u4e5f\u4f1a\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5b8c\u6210 4.\u89e3\u6790 \u628a\u7c7b\u4e2d\u7684\u7b26\u53f7\u5f15\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u5f15\u7528 \u6bd4\u5982\uff1a\u65b9\u6cd5\u4e2d\u8c03\u7528\u4e86\u5176\u4ed6\u65b9\u6cd5\uff0c\u65b9\u6cd5\u540d\u53ef\u4ee5\u7406\u89e3\u4e3a\u7b26\u53f7\u5f15\u7528\uff0c\u800c\u76f4\u63a5\u5f15\u7528\u5c31\u662f\u4f7f\u7528\u6307\u9488\u76f4\u63a5\u6307\u5411\u65b9\u6cd5\u3002 5.\u521d\u59cb\u5316 \u5bf9\u7c7b\u7684\u9759\u6001\u53d8\u91cf\uff0c\u9759\u6001\u4ee3\u7801\u5757\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c \u5982\u679c\u521d\u59cb\u5316\u4e00\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u5176\u7236\u7c7b\u5c1a\u672a\u521d\u59cb\u5316\uff0c\u5219\u4f18\u5148\u521d\u59cb\u5316\u5176\u7236\u7c7b\u3002 \u5982\u679c\u540c\u65f6\u5305\u542b\u591a\u4e2a\u9759\u6001\u53d8\u91cf\u548c\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5219\u6309\u7167\u81ea\u4e0a\u800c\u4e0b\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002 6.\u4f7f\u7528 JVM \u5f00\u59cb\u4ece\u5165\u53e3\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7528\u6237\u7684\u7a0b\u5e8f\u4ee3\u7801 \u8c03\u7528\u9759\u6001\u7c7b\u6210\u5458\u4fe1\u606f\uff08\u6bd4\u5982\uff1a\u9759\u6001\u5b57\u6bb5\u3001\u9759\u6001\u65b9\u6cd5\uff09 \u4f7f\u7528new\u5173\u952e\u5b57\u4e3a\u5176\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b 7.\u5378\u8f7d \u5f53\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u540e\uff0cJVM \u4fbf\u5f00\u59cb\u9500\u6bc1\u521b\u5efa\u7684 Class \u5bf9\u8c61\uff0c\u6700\u540e\u8d1f\u8d23\u8fd0\u884c\u7684 JVM \u4e5f\u9000\u51fa\u5185\u5b58","title":"2.4 \u8bf4\u4e00\u4e0b\u7c7b\u88c5\u8f7d\u7684\u6267\u884c\u8fc7\u7a0b\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#3","text":"","title":"3 \u5783\u573e\u6536\u56de"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#31-javagcgc","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606 \u4e3a\u4e86\u8ba9\u7a0b\u5e8f\u5458\u66f4\u4e13\u6ce8\u4e8e\u4ee3\u7801\u7684\u5b9e\u73b0\uff0c\u800c\u4e0d\u7528\u8fc7\u591a\u7684\u8003\u8651\u5185\u5b58\u91ca\u653e\u7684\u95ee\u9898\uff0c\u6240\u4ee5\uff0c\u5728Java\u8bed\u8a00\u4e2d\uff0c\u6709\u4e86\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u719f\u6089\u7684GC(Garbage Collection)\u3002 \u6709\u4e86\u5783\u573e\u56de\u6536\u673a\u5236\u540e\uff0c\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u5173\u5fc3\u5185\u5b58\u7684\u7533\u8bf7\u5373\u53ef\uff0c\u5185\u5b58\u7684\u91ca\u653e\u7531\u7cfb\u7edf\u81ea\u52a8\u8bc6\u522b\u5b8c\u6210\u3002 \u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\uff0cGC\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u56de\u6536\u65f6\u673a \u6362\u53e5\u8bdd\u8bf4\uff0c\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u7684\u7b97\u6cd5\u5c31\u4f1a\u53d8\u5f97\u975e\u5e38\u91cd\u8981\u4e86\uff0c\u5982\u679c\u56e0\u4e3a\u7b97\u6cd5\u7684\u4e0d\u5408\u7406\uff0c\u5bfc\u81f4\u5185\u5b58\u8d44\u6e90\u4e00\u76f4\u6ca1\u6709\u91ca\u653e\uff0c\u540c\u6837\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u7684\u3002 \u5f53\u7136\uff0c\u9664\u4e86Java\u8bed\u8a00\uff0cC#\u3001Python\u7b49\u8bed\u8a00\u4e5f\u90fd\u6709\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\u3002","title":"3.1 \u7b80\u8ff0Java\u5783\u573e\u56de\u6536\u673a\u5236\uff1f\uff08GC\u662f\u4ec0\u4e48\uff1f\u4e3a\u4ec0\u4e48\u8981GC\uff09"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#32","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u7b80\u5355\u4e00\u53e5\u5c31\u662f\uff1a\u5982\u679c\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u6ca1\u6709\u4efb\u4f55\u7684\u5f15\u7528\u6307\u5411\u5b83\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u73b0\u5728\u5c31\u662f\u5783\u573e\uff0c\u5982\u679c\u5b9a\u4f4d\u4e86\u5783\u573e\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u3002 \u5982\u679c\u8981\u5b9a\u4f4d\u4ec0\u4e48\u662f\u5783\u573e\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u786e\u5b9a\uff0c\u7b2c\u4e00\u4e2a\u662f\u5f15\u7528\u8ba1\u6570\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5","title":"3.2 \u5bf9\u8c61\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u88ab\u5783\u573e\u5668\u56de\u6536"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#321","text":"\u4e00\u4e2a\u5bf9\u8c61\u88ab\u5f15\u7528\u4e86\u4e00\u6b21\uff0c\u5728\u5f53\u524d\u7684\u5bf9\u8c61\u5934\u4e0a\u9012\u589e\u4e00\u6b21\u5f15\u7528\u6b21\u6570\uff0c\u5982\u679c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u6b21\u6570\u4e3a0\uff0c\u4ee3\u8868\u8fd9\u4e2a\u5bf9\u8c61\u53ef\u56de\u6536 String demo = new String(\"123\"); String demo = null; \u5f53\u5bf9\u8c61\u95f4\u51fa\u73b0\u4e86\u5faa\u73af\u5f15\u7528\u7684\u8bdd\uff0c\u5219\u5f15\u7528\u8ba1\u6570\u6cd5\u5c31\u4f1a\u5931\u6548 \u5148\u6267\u884c\u53f3\u4fa7\u4ee3\u7801\u7684\u524d4\u884c\u4ee3\u7801 \u76ee\u524d\u4e0a\u65b9\u7684\u5f15\u7528\u5173\u7cfb\u548c\u8ba1\u6570\u90fd\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u4f46\u662f\uff0c\u5982\u679c\u4ee3\u7801\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u5982\u4e0b\u56fe \u867d\u7136a\u548cb\u90fd\u4e3anull\uff0c\u4f46\u662f\u7531\u4e8ea\u548cb\u5b58\u5728\u5faa\u73af\u5f15\u7528\uff0c\u8fd9\u6837a\u548cb\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u88ab\u56de\u6536\u3002 \u4f18\u70b9\uff1a \u5b9e\u65f6\u6027\u8f83\u9ad8\uff0c\u65e0\u9700\u7b49\u5230\u5185\u5b58\u4e0d\u591f\u7684\u65f6\u5019\uff0c\u624d\u5f00\u59cb\u56de\u6536\uff0c\u8fd0\u884c\u65f6\u6839\u636e\u5bf9\u8c61\u7684\u8ba1\u6570\u5668\u662f\u5426\u4e3a0\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u56de\u6536\u3002 \u5728\u5783\u573e\u56de\u6536\u8fc7\u7a0b\u4e2d\uff0c\u5e94\u7528\u65e0\u9700\u6302\u8d77\u3002\u5982\u679c\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u5185\u5b58\u4e0d\u8db3\uff0c\u5219\u7acb\u523b\u62a5OOM\u9519\u8bef\u3002 \u533a\u57df\u6027\uff0c\u66f4\u65b0\u5bf9\u8c61\u7684\u8ba1\u6570\u5668\u65f6\uff0c\u53ea\u662f\u5f71\u54cd\u5230\u8be5\u5bf9\u8c61\uff0c\u4e0d\u4f1a\u626b\u63cf\u5168\u90e8\u5bf9\u8c61\u3002 \u7f3a\u70b9\uff1a \u6bcf\u6b21\u5bf9\u8c61\u88ab\u5f15\u7528\u65f6\uff0c\u90fd\u9700\u8981\u53bb\u66f4\u65b0\u8ba1\u6570\u5668\uff0c\u6709\u4e00\u70b9\u65f6\u95f4\u5f00\u9500\u3002 \u6d6a\u8d39CPU\u8d44\u6e90 \uff0c\u5373\u4f7f\u5185\u5b58\u591f\u7528\uff0c\u4ecd\u7136\u5728\u8fd0\u884c\u65f6\u8fdb\u884c\u8ba1\u6570\u5668\u7684\u7edf\u8ba1\u3002 \u65e0\u6cd5\u89e3\u51b3\u5faa\u73af\u5f15\u7528\u95ee\u9898\uff0c\u4f1a\u5f15\u53d1\u5185\u5b58\u6cc4\u9732 \u3002\uff08\u6700\u5927\u7684\u7f3a\u70b9\uff09","title":"3.2.1 \u5f15\u7528\u8ba1\u6570\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#322","text":"\u200b \u73b0\u5728\u7684\u865a\u62df\u673a\u91c7\u7528\u7684\u90fd\u662f\u901a\u8fc7\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u6765\u786e\u5b9a\u54ea\u4e9b\u5185\u5bb9\u662f\u5783\u573e\u3002 \u200b \u4f1a\u5b58\u5728\u4e00\u4e2a\u6839\u8282\u70b9\u3010GC Roots\u3011\uff0c\u5f15\u51fa\u5b83\u4e0b\u9762\u6307\u5411\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\uff0c\u518d\u4ee5\u4e0b\u4e00\u4e2a\u8282\u70b9\u8282\u70b9\u5f00\u59cb\u627e\u51fa\u5b83\u4e0b\u9762\u7684\u8282\u70b9\uff0c\u4f9d\u6b21\u5f80\u4e0b\u7c7b\u63a8\u3002\u76f4\u5230\u6240\u6709\u7684\u8282\u70b9\u5168\u90e8\u904d\u5386\u5b8c\u6bd5\u3002 \u6839\u5bf9\u8c61\u662f\u90a3\u4e9b\u80af\u5b9a\u4e0d\u80fd\u5f53\u505a\u5783\u573e\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u5c31\u53ef\u4ee5\u5f53\u505a\u6839\u5bf9\u8c61 \u5c40\u90e8\u53d8\u91cf\uff0c\u9759\u6001\u65b9\u6cd5\uff0c\u9759\u6001\u53d8\u91cf\uff0c\u7c7b\u4fe1\u606f \u6838\u5fc3\u662f\uff1a\u5224\u65ad\u67d0\u5bf9\u8c61\u662f\u5426\u4e0e\u6839\u5bf9\u8c61\u6709\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5f15\u7528\uff0c\u5982\u679c\u6ca1\u6709\u88ab\u5f15\u7528\uff0c\u5219\u53ef\u4ee5\u5f53\u505a\u5783\u573e\u56de\u6536 \u200b X,Y\u8fd9\u4e24\u4e2a\u8282\u70b9\u662f\u53ef\u56de\u6536\u7684\uff0c\u4f46\u662f \u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u7684\u88ab\u56de\u6536\uff01\uff01 \u5bf9\u8c61\u4e2d\u5b58\u5728\u4e00\u4e2a\u65b9\u6cd5\u3010finalize\u3011\u3002\u5f53\u5bf9\u8c61\u88ab\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u540e\uff0c\u5f53\u53d1\u751fGC\u65f6\uff0c\u9996\u5148 \u4f1a\u5224\u65ad\u8fd9\u4e2a\u5bf9\u8c61\u662f\u5426\u6267\u884c\u4e86finalize\u65b9\u6cd5 \uff0c\u5982\u679c\u8fd9\u4e2a\u65b9\u6cd5\u8fd8\u6ca1\u6709\u88ab\u6267\u884c\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u4f1a\u5148\u6765\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u63a5\u7740\u5728\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5f53\u524d\u8fd9\u4e2a\u5bf9\u8c61\u4e0eGC ROOTS\u4ea7\u751f\u5173\u8054\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0cGC\u4f1a\u518d\u6b21\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u53ef\u8fbe\uff0c\u5982\u679c\u4ecd\u7136\u4e0d\u53ef\u8fbe\uff0c\u5219\u4f1a\u8fdb\u884c\u56de\u6536\uff0c\u5982\u679c\u53ef\u8fbe\u4e86\uff0c\u5219\u4e0d\u4f1a\u8fdb\u884c\u56de\u6536\u3002 \u200b finalize\u65b9\u6cd5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u6765\u8bf4\uff0c\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u3002\u5982\u679c\u7b2c\u4e00\u6b21\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u8bbe\u7f6e\u4e86\u5f53\u524d\u5bf9\u8c61\u4e0eRC ROOTS\u5173\u8054\uff0c\u90a3\u4e48\u8fd9\u4e00\u6b21\u4e0d\u4f1a\u8fdb\u884c\u56de\u6536\u3002 \u90a3\u4e48\u7b49\u5230\u8fd9\u4e2a\u5bf9\u8c61\u7b2c\u4e8c\u6b21\u88ab\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u65f6\uff0c\u90a3\u4e48\u8be5\u5bf9\u8c61\u7684finalize\u65b9\u6cd5\u5c31\u4e0d\u4f1a\u518d\u6b21\u6267\u884c\u4e86\u3002 GC ROOTS\uff1a \u865a\u62df\u673a\u6808\uff08\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\u8868\uff09\u4e2d\u5f15\u7528\u7684\u5bf9\u8c61 /** * demo\u662f\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\uff0c\u5f53 demo = null \u65f6\uff0c\u7531\u4e8e\u6b64\u65f6 demo \u5145\u5f53\u4e86 GC Root \u7684\u4f5c\u7528\uff0cdemo\u4e0e\u539f\u6765\u6307\u5411\u7684\u5b9e\u4f8b new Demo() \u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u5bf9\u8c61\u88ab\u56de\u6536\u3002 */ public class Demo { public static void main(String[] args) { Demo demo = new Demo(); demo = null; } } \u65b9\u6cd5\u533a\u4e2d\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\u7684\u5bf9\u8c61 /** * \u5f53\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf b = null \u65f6\uff0c\u7531\u4e8e b \u539f\u6765\u6307\u5411\u7684\u5bf9\u8c61\u4e0e GC Root (\u53d8\u91cf b) \u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u6240\u4ee5 b \u539f\u6765\u6307\u5411\u7684\u5bf9\u8c61\u4f1a\u88ab\u56de\u6536\uff0c\u800c\u7531\u4e8e\u6211\u4eec\u7ed9 a \u8d4b\u503c\u4e86\u53d8\u91cf\u7684\u5f15\u7528\uff0ca\u5728\u6b64\u65f6\u662f\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\uff0c\u5145\u5f53\u4e86 GC Root \u7684\u4f5c\u7528\uff0c\u5b83\u6307\u5411\u7684\u5bf9\u8c61\u4f9d\u7136\u5b58\u6d3b! */ public class Demo { public static Demo a; public static void main(String[] args) { Demo b = new Demo(); b.a = new Demo(); b = null; } } \u65b9\u6cd5\u533a\u4e2d\u5e38\u91cf\u5f15\u7528\u7684\u5bf9\u8c61 /** * \u5e38\u91cf a \u6307\u5411\u7684\u5bf9\u8c61\u5e76\u4e0d\u4f1a\u56e0\u4e3a demo \u6307\u5411\u7684\u5bf9\u8c61\u88ab\u56de\u6536\u800c\u56de\u6536 */ public class Demo { public static final Demo a = new Demo(); public static void main(String[] args) { Demo demo = new Demo(); demo = null; } } \u672c\u5730\u65b9\u6cd5\u6808\u4e2d JNI\uff08\u5373\u4e00\u822c\u8bf4\u7684 Native \u65b9\u6cd5\uff09\u5f15\u7528\u7684\u5bf9\u8c61","title":"3.2.2 \u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#33-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606","title":"3.3 JVM \u5783\u573e\u56de\u6536\u7b97\u6cd5\u6709\u54ea\u4e9b\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#331","text":"\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\uff0c\u662f\u5c06\u5783\u573e\u56de\u6536\u5206\u4e3a2\u4e2a\u9636\u6bb5\uff0c\u5206\u522b\u662f \u6807\u8bb0\u548c\u6e05\u9664 \u3002 1.\u6839\u636e\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u5f97\u51fa\u7684\u5783\u573e\u8fdb\u884c\u6807\u8bb0 2.\u5bf9\u8fd9\u4e9b\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u7684\u5185\u5bb9\u8fdb\u884c\u5783\u573e\u56de\u6536 \u53ef\u4ee5\u770b\u5230\uff0c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u89e3\u51b3\u4e86\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5\u4e2d\u7684\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\uff0c\u6ca1\u6709\u4eceroot\u8282\u70b9\u5f15\u7528\u7684\u5bf9\u8c61\u90fd\u4f1a\u88ab\u56de\u6536\u3002 \u540c\u6837\uff0c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u4e5f\u662f\u6709\u7f3a\u70b9\u7684\uff1a \u6548\u7387\u8f83\u4f4e\uff0c \u6807\u8bb0\u548c\u6e05\u9664\u4e24\u4e2a\u52a8\u4f5c\u90fd\u9700\u8981\u904d\u5386\u6240\u6709\u7684\u5bf9\u8c61 \uff0c\u5e76\u4e14\u5728GC\u65f6\uff0c \u9700\u8981\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f \uff0c\u5bf9\u4e8e\u4ea4\u4e92\u6027\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u5e94\u7528\u800c\u8a00\u8fd9\u4e2a\u4f53\u9a8c\u662f\u975e\u5e38\u5dee\u7684\u3002 \uff08 \u91cd\u8981 \uff09\u901a\u8fc7\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u6e05\u7406\u51fa\u6765\u7684\u5185\u5b58\uff0c\u788e\u7247\u5316\u8f83\u4e3a\u4e25\u91cd\uff0c\u56e0\u4e3a\u88ab\u56de\u6536\u7684\u5bf9\u8c61\u53ef\u80fd\u5b58\u5728\u4e8e\u5185\u5b58\u7684\u5404\u4e2a\u89d2\u843d\uff0c\u6240\u4ee5\u6e05\u7406\u51fa\u6765\u7684\u5185\u5b58\u662f\u4e0d\u8fde\u8d2f\u7684\u3002","title":"3.3.1 \u6807\u8bb0\u6e05\u9664\u7b97\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#332","text":"\u200b \u590d\u5236\u7b97\u6cd5\u7684\u6838\u5fc3\u5c31\u662f\uff0c \u5c06\u539f\u6709\u7684\u5185\u5b58\u7a7a\u95f4\u4e00\u5206\u4e3a\u4e8c\uff0c\u6bcf\u6b21\u53ea\u7528\u5176\u4e2d\u7684\u4e00\u5757 \uff0c\u5728\u5783\u573e\u56de\u6536\u65f6\uff0c\u5c06\u6b63\u5728\u4f7f\u7528\u7684\u5bf9\u8c61\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u7136\u540e\u5c06\u8be5\u5185\u5b58\u7a7a\u95f4\u6e05\u7a7a\uff0c\u4ea4\u6362\u4e24\u4e2a\u5185\u5b58\u7684\u89d2\u8272\uff0c\u5b8c\u6210\u5783\u573e\u7684\u56de\u6536\u3002 \u200b \u5982\u679c\u5185\u5b58\u4e2d\u7684\u5783\u573e\u5bf9\u8c61\u8f83\u591a\uff0c\u9700\u8981\u590d\u5236\u7684\u5bf9\u8c61\u5c31\u8f83\u5c11\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u9002\u5408\u4f7f\u7528\u8be5\u65b9\u5f0f\u5e76\u4e14\u6548\u7387\u6bd4\u8f83\u9ad8\uff0c\u53cd\u4e4b\uff0c\u5219\u4e0d\u9002\u5408\u3002 1\uff09\u5c06\u5185\u5b58\u533a\u57df\u5206\u6210\u4e24\u90e8\u5206\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5176\u4e2d\u4e00\u4e2a\u3002 2\uff09\u5f53\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u5c06\u6b63\u5728\u4f7f\u7528\u7684\u5185\u5b58\u533a\u57df\u4e2d\u7684\u5b58\u6d3b\u5bf9\u8c61\u79fb\u52a8\u5230\u672a\u4f7f\u7528\u7684\u5185\u5b58\u533a\u57df\u3002\u5f53\u79fb\u52a8\u5b8c\u5bf9\u8fd9\u90e8\u5206\u5185\u5b58\u533a\u57df\u4e00\u6b21\u6027\u6e05\u9664\u3002 3\uff09\u5468\u800c\u590d\u59cb\u3002 \u4f18\u70b9\uff1a \u5728\u5783\u573e\u5bf9\u8c61\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u6548\u7387\u8f83\u9ad8 \u6e05\u7406\u540e\uff0c\u5185\u5b58\u65e0\u788e\u7247 \u7f3a\u70b9\uff1a \u5206\u914d\u76842\u5757\u5185\u5b58\u7a7a\u95f4\uff0c\u5728\u540c\u4e00\u4e2a\u65f6\u523b\uff0c\u53ea\u80fd\u4f7f\u7528\u4e00\u534a\uff0c\u5185\u5b58\u4f7f\u7528\u7387\u8f83\u4f4e","title":"3.3.2 \u590d\u5236\u7b97\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#333","text":"\u200b \u6807\u8bb0\u538b\u7f29\u7b97\u6cd5\u662f\u5728\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u505a\u4e86\u4f18\u5316\u6539\u8fdb\u7684\u7b97\u6cd5\u3002\u548c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u4e00\u6837\uff0c\u4e5f\u662f\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0c\u5bf9\u5bf9\u8c61\u7684\u5f15\u7528\u8fdb\u884c\u6807\u8bb0\uff0c\u5728\u6e05\u7406\u9636\u6bb5\uff0c\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u76f4\u63a5\u6e05\u7406\u53ef\u56de\u6536\u5bf9\u8c61\uff0c\u800c\u662f\u5c06\u5b58\u6d3b\u5bf9\u8c61\u90fd\u5411\u5185\u5b58\u53e6\u4e00\u7aef\u79fb\u52a8\uff0c\u7136\u540e\u6e05\u7406\u8fb9\u754c\u4ee5\u5916\u7684\u5783\u573e\uff0c\u4ece\u800c\u89e3\u51b3\u4e86\u788e\u7247\u5316\u7684\u95ee\u9898\u3002 1\uff09\u6807\u8bb0\u5783\u573e\u3002 2\uff09\u9700\u8981\u6e05\u9664\u5411\u53f3\u8fb9\u8d70\uff0c\u4e0d\u9700\u8981\u6e05\u9664\u7684\u5411\u5de6\u8fb9\u8d70\u3002 3\uff09\u6e05\u9664\u8fb9\u754c\u4ee5\u5916\u7684\u5783\u573e\u3002 \u4f18\u7f3a\u70b9\u540c\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\uff0c\u89e3\u51b3\u4e86\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u7684\u788e\u7247\u5316\u7684\u95ee\u9898\uff0c\u540c\u65f6\uff0c\u6807\u8bb0\u538b\u7f29\u7b97\u6cd5\u591a\u4e86\u4e00\u6b65\uff0c\u5bf9\u8c61\u79fb\u52a8\u5185\u5b58\u4f4d\u7f6e\u7684\u6b65\u9aa4\uff0c\u5176\u6548\u7387\u4e5f\u6709\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\u3002 \u4e0e\u590d\u5236\u7b97\u6cd5\u5bf9\u6bd4\uff1a\u590d\u5236\u7b97\u6cd5\u6807\u8bb0\u5b8c\u5c31\u590d\u5236\uff0c\u4f46\u6807\u8bb0\u6574\u7406\u7b97\u6cd5\u5f97\u7b49\u628a\u6240\u6709\u5b58\u6d3b\u5bf9\u8c61\u90fd\u6807\u8bb0\u5b8c\u6bd5\uff0c\u518d\u8fdb\u884c\u6574\u7406","title":"3.3.3 \u6807\u8bb0\u6574\u7406\u7b97\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#34","text":"","title":"3.4 \u5206\u4ee3\u6536\u96c6\u7b97\u6cd5"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#341","text":"\u5728java8\u65f6\uff0c\u5806\u88ab\u5206\u4e3a\u4e86\u4e24\u4efd\uff1a \u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\u30101\uff1a2\u3011 \uff0c\u5728java7\u65f6\uff0c\u8fd8\u5b58\u5728\u4e00\u4e2a\u6c38\u4e45\u4ee3\u3002 \u5bf9\u4e8e\u65b0\u751f\u4ee3\uff0c\u5185\u90e8\u53c8\u88ab\u5206\u4e3a\u4e86\u4e09\u4e2a\u533a\u57df\u3002Eden\u533a\uff0cS0\u533a\uff0cS1\u533a\u30108\uff1a1\uff1a1\u3011 \u5f53\u5bf9\u65b0\u751f\u4ee3\u4ea7\u751fGC\uff1aMinorGC\u3010young GC\u3011 \u5f53\u5bf9\u8001\u5e74\u4ee3\u4ee3\u4ea7\u751fGC\uff1aMajor GC \u5f53\u5bf9\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\u4ea7\u751fFullGC\uff1a \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff0c \u5e94\u5c3d\u529b\u907f\u514d","title":"3.4.1 \u6982\u8ff0"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#342","text":"\u65b0\u521b\u5efa\u7684\u5bf9\u8c61\uff0c\u90fd\u4f1a\u5148\u5206\u914d\u5230eden\u533a \u5f53\u4f0a\u7538\u56ed\u5185\u5b58\u4e0d\u8db3\uff0c\u6807\u8bb0\u4f0a\u7538\u56ed\u4e0e from\uff08\u73b0\u9636\u6bb5\u6ca1\u6709\uff09\u7684\u5b58\u6d3b\u5bf9\u8c61 \u5c06\u5b58\u6d3b\u5bf9\u8c61\u91c7\u7528\u590d\u5236\u7b97\u6cd5\u590d\u5236\u5230 to \u4e2d\uff0c\u590d\u5236\u5b8c\u6bd5\u540e\uff0c\u4f0a\u7538\u56ed\u548c from \u5185\u5b58\u90fd\u5f97\u5230\u91ca\u653e \u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u540e\u4f0a\u7538\u56ed\u7684\u5185\u5b58\u53c8\u51fa\u73b0\u4e0d\u8db3\uff0c\u6807\u8bb0eden\u533a\u57dfto\u533a\u5b58\u6d3b\u7684\u5bf9\u8c61\uff0c\u5c06\u5b58\u6d3b\u7684\u5bf9\u8c61\u590d\u5236\u5230from\u533a \u5f53\u5e78\u5b58\u533a\u5bf9\u8c61\u71ac\u8fc7\u51e0\u6b21\u56de\u6536\uff08\u6700\u591a15\u6b21\uff09\uff0c\u664b\u5347\u5230\u8001\u5e74\u4ee3\uff08\u5e78\u5b58\u533a\u5185\u5b58\u4e0d\u8db3\u6216\u5927\u5bf9\u8c61\u4f1a\u5bfc\u81f4\u63d0\u524d\u664b\u5347\uff09 MinorGC\u3001 Mixed GC \u3001 FullGC\u7684\u533a\u522b\u662f\u4ec0\u4e48 MinorGC\u3010young GC\u3011\u53d1\u751f\u5728\u65b0\u751f\u4ee3\u7684\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u77ed\uff08STW\uff09 Mixed GC \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u90e8\u5206\u533a\u57df\u7684\u5783\u573e\u56de\u6536\uff0cG1 \u6536\u96c6\u5668\u7279\u6709 FullGC\uff1a \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff08STW\uff09\uff0c\u5e94\u5c3d\u529b\u907f\u514d\uff1f \u540d\u8bcd\u89e3\u91ca\uff1a STW\uff08Stop-The-World\uff09\uff1a\u6682\u505c\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u7ebf\u7a0b\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210","title":"3.4.2\u5de5\u4f5c\u673a\u5236"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#35-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u5728jvm\u4e2d\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u5783\u573e\u6536\u96c6\u5668\uff0c\u5305\u62ec\uff1a \u4e32\u884c\u5783\u573e\u6536\u96c6\u5668 \u5e76\u884c\u5783\u573e\u6536\u96c6\u5668 CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668 G1\u5783\u573e\u6536\u96c6\u5668","title":"3.5 \u8bf4\u4e00\u4e0b JVM \u6709\u54ea\u4e9b\u5783\u573e\u56de\u6536\u5668\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#351","text":"Serial\u548cSerial Old\u4e32\u884c\u5783\u573e\u6536\u96c6\u5668\uff0c\u662f\u6307\u4f7f\u7528\u5355\u7ebf\u7a0b\u8fdb\u884c\u5783\u573e\u56de\u6536\uff0c\u5806\u5185\u5b58\u8f83\u5c0f\uff0c\u9002\u5408\u4e2a\u4eba\u7535\u8111 Serial \u4f5c\u7528\u4e8e\u65b0\u751f\u4ee3\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5 Serial Old \u4f5c\u7528\u4e8e\u8001\u5e74\u4ee3\uff0c\u91c7\u7528\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5 \u5783\u573e\u56de\u6536\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5de5\u4f5c\uff0c\u5e76\u4e14java\u5e94\u7528\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u8981\u6682\u505c\uff08STW\uff09\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210\u3002","title":"3.5.1 \u4e32\u884c\u5783\u573e\u6536\u96c6\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#352","text":"Parallel New\u548cParallel Old\u662f\u4e00\u4e2a\u5e76\u884c\u5783\u573e\u56de\u6536\u5668\uff0c JDK8\u9ed8\u8ba4\u4f7f\u7528\u6b64\u5783\u573e\u56de\u6536\u5668 Parallel New\u4f5c\u7528\u4e8e\u65b0\u751f\u4ee3\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5 Parallel Old\u4f5c\u7528\u4e8e\u8001\u5e74\u4ee3\uff0c\u91c7\u7528\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5 \u5783\u573e\u56de\u6536\u65f6\uff0c\u591a\u4e2a\u7ebf\u7a0b\u5728\u5de5\u4f5c\uff0c\u5e76\u4e14java\u5e94\u7528\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u8981\u6682\u505c\uff08STW\uff09\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u7684\u5b8c\u6210\u3002","title":"3.5.2 \u5e76\u884c\u5783\u573e\u6536\u96c6\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#352-cms","text":"CMS\u5168\u79f0 Concurrent Mark Sweep\uff0c\u662f\u4e00\u6b3e\u5e76\u53d1\u7684\u3001\u4f7f\u7528\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5\u7684\u5783\u573e\u56de\u6536\u5668\uff0c\u8be5\u56de\u6536\u5668\u662f\u9488\u5bf9\u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u7684\uff0c\u662f\u4e00\u6b3e\u4ee5\u83b7\u53d6\u6700\u77ed\u56de\u6536\u505c\u987f\u65f6\u95f4\u4e3a\u76ee\u6807\u7684\u6536\u96c6\u5668\uff0c\u505c\u987f\u65f6\u95f4\u77ed\uff0c\u7528\u6237\u4f53\u9a8c\u5c31\u597d\u3002\u5176\u6700\u5927\u7279\u70b9\u662f\u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u5e94\u7528\u4ecd\u7136\u80fd\u6b63\u5e38\u8fd0\u884c\u3002","title":"3.5.2 CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#36-g1","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606","title":"3.6 \u8be6\u7ec6\u804a\u4e00\u4e0bG1\u5783\u573e\u56de\u6536\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#361","text":"\u5e94\u7528\u4e8e\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c \u5728 JDK9 \u4e4b\u540e\u9ed8\u8ba4\u4f7f\u7528 G1 \u5212\u5206\u6210\u591a\u4e2a\u533a\u57df\uff0c\u6bcf\u4e2a\u533a\u57df\u90fd\u53ef\u4ee5\u5145\u5f53 eden\uff0csurvivor\uff0cold\uff0c humongous\uff0c\u5176\u4e2d humongous \u4e13\u4e3a\u5927\u5bf9\u8c61\u51c6\u5907 \u91c7\u7528\u590d\u5236\u7b97\u6cd5 \u54cd\u5e94\u65f6\u95f4\u4e0e\u541e\u5410\u91cf\u517c\u987e \u5206\u6210\u4e09\u4e2a\u9636\u6bb5\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u3001\u5e76\u53d1\u6807\u8bb0\u3001\u6df7\u5408\u6536\u96c6 \u5982\u679c\u5e76\u53d1\u5931\u8d25\uff08\u5373\u56de\u6536\u901f\u5ea6\u8d76\u4e0d\u4e0a\u521b\u5efa\u65b0\u5bf9\u8c61\u901f\u5ea6\uff09\uff0c\u4f1a\u89e6\u53d1 Full GC","title":"3.6.1 \u6982\u8ff0"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#362-young-collection","text":"\u521d\u59cb\u65f6\uff0c\u6240\u6709\u533a\u57df\u90fd\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001 \u521b\u5efa\u4e86\u4e00\u4e9b\u5bf9\u8c61\uff0c\u6311\u51fa\u4e00\u4e9b\u7a7a\u95f2\u533a\u57df\u4f5c\u4e3a\u4f0a\u7538\u56ed\u533a\u5b58\u50a8\u8fd9\u4e9b\u5bf9\u8c61 \u5f53\u4f0a\u7538\u56ed\u9700\u8981\u5783\u573e\u56de\u6536\u65f6\uff0c\u6311\u51fa\u4e00\u4e2a\u7a7a\u95f2\u533a\u57df\u4f5c\u4e3a\u5e78\u5b58\u533a\uff0c\u7528\u590d\u5236\u7b97\u6cd5\u590d\u5236\u5b58\u6d3b\u5bf9\u8c61\uff0c\u9700\u8981\u6682\u505c\u7528\u6237\u7ebf\u7a0b \u968f\u7740\u65f6\u95f4\u6d41\u901d\uff0c\u4f0a\u7538\u56ed\u7684\u5185\u5b58\u53c8\u6709\u4e0d\u8db3 \u5c06\u4f0a\u7538\u56ed\u4ee5\u53ca\u4e4b\u524d\u5e78\u5b58\u533a\u4e2d\u7684\u5b58\u6d3b\u5bf9\u8c61\uff0c\u91c7\u7528\u590d\u5236\u7b97\u6cd5\uff0c\u590d\u5236\u5230\u65b0\u7684\u5e78\u5b58\u533a\uff0c\u5176\u4e2d\u8f83\u8001\u5bf9\u8c61\u664b\u5347\u81f3\u8001\u5e74\u4ee3","title":"3.6.2 Young Collection(\u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536)"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#363-young-collection-concurrent-mark","text":"\u5f53\u8001\u5e74\u4ee3\u5360\u7528\u5185\u5b58\u8d85\u8fc7\u9608\u503c(\u9ed8\u8ba4\u662f45%)\u540e\uff0c\u89e6\u53d1\u5e76\u53d1\u6807\u8bb0\uff0c\u8fd9\u65f6\u65e0\u9700\u6682\u505c\u7528\u6237\u7ebf\u7a0b \u5e76\u53d1\u6807\u8bb0\u4e4b\u540e\uff0c\u4f1a\u6709\u91cd\u65b0\u6807\u8bb0\u9636\u6bb5\u89e3\u51b3\u6f0f\u6807\u95ee\u9898\uff0c\u6b64\u65f6\u9700\u8981\u6682\u505c\u7528\u6237\u7ebf\u7a0b\u3002 \u8fd9\u4e9b\u90fd\u5b8c\u6210\u540e\u5c31\u77e5\u9053\u4e86\u8001\u5e74\u4ee3\u6709\u54ea\u4e9b\u5b58\u6d3b\u5bf9\u8c61\uff0c\u968f\u540e\u8fdb\u5165\u6df7\u5408\u6536\u96c6\u9636\u6bb5\u3002\u6b64\u65f6\u4e0d\u4f1a\u5bf9\u6240\u6709\u8001\u5e74\u4ee3\u533a\u57df\u8fdb\u884c\u56de\u6536\uff0c\u800c\u662f\u6839\u636e\u6682\u505c\u65f6\u95f4\u76ee\u6807\u4f18\u5148\u56de\u6536\u4ef7\u503c\u9ad8\uff08\u5b58\u6d3b\u5bf9\u8c61\u5c11\uff09\u7684\u533a\u57df\uff08\u8fd9\u4e5f\u662f Gabage First \u540d\u79f0\u7684\u7531\u6765\uff09\u3002","title":"3.6.3 Young Collection + Concurrent Mark (\u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536+\u5e76\u53d1\u6807\u8bb0)"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#364-mixed-collection","text":"\u590d\u5236\u5b8c\u6210\uff0c\u5185\u5b58\u5f97\u5230\u91ca\u653e\u3002\u8fdb\u5165\u4e0b\u4e00\u8f6e\u7684\u65b0\u751f\u4ee3\u56de\u6536\u3001\u5e76\u53d1\u6807\u8bb0\u3001\u6df7\u5408\u6536\u96c6 \u5176\u4e2dH\u53eb\u505a\u5de8\u578b\u5bf9\u8c61\uff0c\u5982\u679c\u5bf9\u8c61\u975e\u5e38\u5927\uff0c\u4f1a\u5f00\u8f9f\u4e00\u5757\u8fde\u7eed\u7684\u7a7a\u95f4\u5b58\u50a8\u5de8\u578b\u5bf9\u8c61","title":"3.6.4 Mixed Collection (\u6df7\u5408\u5783\u573e\u56de\u6536)"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#37","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"3.7 \u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528\u7684\u533a\u522b\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#371","text":"\u5f3a\u5f15\u7528\uff1a\u53ea\u6709\u6240\u6709 GC Roots \u5bf9\u8c61\u90fd\u4e0d\u901a\u8fc7\u3010\u5f3a\u5f15\u7528\u3011\u5f15\u7528\u8be5\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u624d\u80fd\u88ab\u5783\u573e\u56de\u6536 User user = new User();","title":"3.7.1 \u5f3a\u5f15\u7528"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#372","text":"\u8f6f\u5f15\u7528\uff1a\u4ec5\u6709\u8f6f\u5f15\u7528\u5f15\u7528\u8be5\u5bf9\u8c61\u65f6\uff0c\u5728\u5783\u573e\u56de\u6536\u540e\uff0c\u5185\u5b58\u4ecd\u4e0d\u8db3\u65f6\u4f1a\u518d\u6b21\u51fa\u53d1\u5783\u573e\u56de\u6536 User user = new User(); SoftReference softReference = new SoftReference(user);","title":"3.7.2 \u8f6f\u5f15\u7528"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#373","text":"\u5f31\u5f15\u7528\uff1a\u4ec5\u6709\u5f31\u5f15\u7528\u5f15\u7528\u8be5\u5bf9\u8c61\u65f6\uff0c\u5728\u5783\u573e\u56de\u6536\u65f6\uff0c\u65e0\u8bba\u5185\u5b58\u662f\u5426\u5145\u8db3\uff0c\u90fd\u4f1a\u56de\u6536\u5f31\u5f15\u7528\u5bf9\u8c61 User user = new User(); WeakReference weakReference = new WeakReference(user); \u5ef6\u4f38\u8bdd\u9898\uff1aThreadLocal\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898 ThreadLocal\u7528\u7684\u5c31\u662f\u5f31\u5f15\u7528\uff0c\u770b\u4ee5\u4e0b\u6e90\u7801\uff1a static class Entry extends WeakReference<ThreadLocal<?>> { Object value; Entry(ThreadLocal<?> k, Object v) { super(k); value = v; //\u5f3a\u5f15\u7528\uff0c\u4e0d\u4f1a\u88ab\u56de\u6536 } } Entry \u7684key\u662f\u5f53\u524dThreadLocal\uff0cvalue\u503c\u662f\u6211\u4eec\u8981\u8bbe\u7f6e\u7684\u6570\u636e\u3002 WeakReference \u8868\u793a\u7684\u662f\u5f31\u5f15\u7528\uff0c\u5f53JVM\u8fdb\u884cGC\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u4e86\u53ea\u5177\u6709\u5f31\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4e0d\u7ba1\u5f53\u524d\u5185\u5b58\u7a7a\u95f4\u662f\u5426\u8db3\u591f\uff0c\u90fd\u4f1a\u56de\u6536\u5b83\u7684\u5185\u5b58\u3002\u4f46\u662f value \u662f\u5f3a\u5f15\u7528\uff0c\u5b83\u4e0d\u4f1a\u88ab\u56de\u6536\u6389\u3002 ThreadLocal\u4f7f\u7528\u5efa\u8bae\uff1a\u4f7f\u7528\u5b8c\u6bd5\u540e\u6ce8\u610f\u8c03\u7528\u6e05\u7406\u65b9\u6cd5\u3002","title":"3.7.3 \u5f31\u5f15\u7528"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#374","text":"\u865a\u5f15\u7528\uff1a\u5fc5\u987b\u914d\u5408\u5f15\u7528\u961f\u5217\u4f7f\u7528\uff0c\u88ab\u5f15\u7528\u5bf9\u8c61\u56de\u6536\u65f6\uff0c\u4f1a\u5c06\u865a\u5f15\u7528\u5165\u961f\uff0c\u7531 Reference Handler \u7ebf\u7a0b\u8c03\u7528\u865a\u5f15\u7528\u76f8\u5173\u65b9\u6cd5\u91ca\u653e\u76f4\u63a5\u5185\u5b58","title":"3.7.4 \u865a\u5f15\u7528"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4-jvm","text":"","title":"4 JVM\u5b9e\u8df5\uff08\u8c03\u4f18\uff09"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#41-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606","title":"4.1 JVM \u8c03\u4f18\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u54ea\u91cc\u8bbe\u7f6e\u53c2\u6570\u503c\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#411-tomcatvm","text":"\u4fee\u6539TOMCAT_HOME/bin/catalina.sh\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe JAVA_OPTS=\"-Xms512m -Xmx1024m\"","title":"4.1.1 tomcat\u7684\u8bbe\u7f6evm\u53c2\u6570"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#412-springbootjar","text":"\u901a\u5e38\u5728linux\u7cfb\u7edf\u4e0b\u76f4\u63a5\u52a0\u53c2\u6570\u542f\u52a8springboot\u9879\u76ee nohup java -Xms512m -Xmx1024m -jar xxxx.jar --spring.profiles.active=prod & nohup : \u7528\u4e8e\u5728\u7cfb\u7edf\u540e\u53f0\u4e0d\u6302\u65ad\u5730\u8fd0\u884c\u547d\u4ee4\uff0c\u9000\u51fa\u7ec8\u7aef\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c \u53c2\u6570 & \uff1a\u8ba9\u547d\u4ee4\u5728\u540e\u53f0\u6267\u884c\uff0c\u7ec8\u7aef\u9000\u51fa\u540e\u547d\u4ee4\u4ecd\u65e7\u6267\u884c\u3002","title":"4.1.2 springboot\u9879\u76eejar\u6587\u4ef6\u542f\u52a8"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#42-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u200b \u5bf9\u4e8eJVM\u8c03\u4f18\uff0c\u4e3b\u8981\u5c31\u662f\u8c03\u6574\u5e74\u8f7b\u4ee3\u3001\u5e74\u8001\u5927\u3001\u5143\u7a7a\u95f4\u7684\u5185\u5b58\u7a7a\u95f4\u5927\u5c0f\u53ca\u4f7f\u7528\u7684\u5783\u573e\u56de\u6536\u5668\u7c7b\u578b\u3002 https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html 1\uff09\u8bbe\u7f6e\u5806\u7684\u521d\u59cb\u5927\u5c0f\u548c\u6700\u5927\u5927\u5c0f\uff0c\u4e3a\u4e86\u9632\u6b62\u5783\u573e\u6536\u96c6\u5668\u5728\u521d\u59cb\u5927\u5c0f\u3001\u6700\u5927\u5927\u5c0f\u4e4b\u95f4\u6536\u7f29\u5806\u800c\u4ea7\u751f\u989d\u5916\u7684\u65f6\u95f4\uff0c\u901a\u5e38\u628a\u6700\u5927\u3001\u521d\u59cb\u5927\u5c0f\u8bbe\u7f6e\u4e3a\u76f8\u540c\u7684\u503c\u3002 -Xms\uff1a\u8bbe\u7f6e\u5806\u7684\u521d\u59cb\u5316\u5927\u5c0f -Xmx\uff1a\u8bbe\u7f6e\u5806\u7684\u6700\u5927\u5927\u5c0f 2\uff09 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u548c\u4e24\u4e2aSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u4f8b\u3002\u8be5\u503c\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u5219\u9ed8\u8ba4\u6bd4\u4f8b\u4e3a8:1:1\u3002Java\u5b98\u65b9\u901a\u8fc7\u589e\u5927Eden\u533a\u7684\u5927\u5c0f\uff0c\u6765\u51cf\u5c11YGC\u53d1\u751f\u7684\u6b21\u6570\uff0c\u4f46\u6709\u65f6\u6211\u4eec\u53d1\u73b0\uff0c\u867d\u7136\u6b21\u6570\u51cf\u5c11\u4e86\uff0c\u4f46Eden\u533a\u6ee1 \u7684\u65f6\u5019\uff0c\u7531\u4e8e\u5360\u7528\u7684\u7a7a\u95f4\u8f83\u5927\uff0c\u5bfc\u81f4\u91ca\u653e\u7f13\u6162\uff0c\u6b64\u65f6STW\u7684\u65f6\u95f4\u8f83\u957f\uff0c\u56e0\u6b64\u9700\u8981\u6309\u7167\u7a0b\u5e8f\u60c5\u51b5\u53bb\u8c03\u4f18\u3002 -XXSurvivorRatio=3\uff0c\u8868\u793a\u5e74\u8f7b\u4ee3\u4e2d\u7684\u5206\u914d\u6bd4\u7387\uff1asurvivor:eden = 2:3 3\uff09\u5e74\u8f7b\u4ee3\u548c\u8001\u5e74\u4ee3\u9ed8\u8ba4\u6bd4\u4f8b\u4e3a1\uff1a2\u3002\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u4e8c\u8005\u7a7a\u95f4\u5927\u5c0f\u6bd4\u7387\u6765\u8bbe\u7f6e\u4e24\u8005\u7684\u5927\u5c0f\u3002 -XX:newSize \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u521d\u59cb\u5927\u5c0f -XX:MaxNewSize \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u6700\u5927\u5927\u5c0f\uff0c \u521d\u59cb\u5927\u5c0f\u548c\u6700\u5927\u5927\u5c0f\u4e24\u4e2a\u503c\u901a\u5e38\u76f8\u540c 4\uff09\u7ebf\u7a0b\u5806\u6808\u7684\u8bbe\u7f6e\uff1a \u6bcf\u4e2a\u7ebf\u7a0b\u9ed8\u8ba4\u4f1a\u5f00\u542f1M\u7684\u5806\u6808 \uff0c\u7528\u4e8e\u5b58\u653e\u6808\u5e27\u3001\u8c03\u7528\u53c2\u6570\u3001\u5c40\u90e8\u53d8\u91cf\u7b49\uff0c\u4f46\u4e00\u822c256K\u5c31\u591f\u7528\u3002\u901a\u5e38\u51cf\u5c11\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5806\u6808\uff0c\u53ef\u4ee5\u4ea7\u751f\u66f4\u591a\u7684\u7ebf\u7a0b\uff0c\u4f46\u8fd9\u5b9e\u9645\u4e0a\u8fd8\u53d7\u9650\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u3002 -Xss \u5bf9\u6bcf\u4e2a\u7ebf\u7a0bstack\u5927\u5c0f\u7684\u8c03\u6574,-Xss128k 5\uff09\u4e00\u822c\u6765\u8bf4\uff0c\u5f53survivor\u533a\u4e0d\u591f\u5927\u6216\u8005\u5360\u7528\u91cf\u8fbe\u523050%\uff0c\u5c31\u4f1a\u628a\u4e00\u4e9b\u5bf9\u8c61\u653e\u5230\u8001\u5e74\u533a\u3002\u901a\u8fc7\u8bbe\u7f6e\u5408\u7406\u7684eden\u533a\uff0csurvivor\u533a\u53ca\u4f7f\u7528\u7387\uff0c\u53ef\u4ee5\u5c06\u5e74\u8f7b\u5bf9\u8c61\u4fdd\u5b58\u5728\u5e74\u8f7b\u4ee3\uff0c\u4ece\u800c\u907f\u514dfull GC\uff0c\u4f7f\u7528-Xmn\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u7684\u5927\u5c0f 6\uff09\u7cfb\u7edfCPU\u6301\u7eed\u98d9\u9ad8\u7684\u8bdd\uff0c\u9996\u5148\u5148\u6392\u67e5\u4ee3\u7801\u95ee\u9898\uff0c\u5982\u679c\u4ee3\u7801\u6ca1\u95ee\u9898\uff0c\u5219\u54a8\u8be2\u8fd0\u7ef4\u6216\u8005\u4e91\u670d\u52a1\u5668\u4f9b\u5e94\u5546\uff0c\u901a\u5e38\u670d\u52a1\u5668\u91cd\u542f\u6216\u8005\u670d\u52a1\u5668\u8fc1\u79fb\u5373\u53ef\u89e3\u51b3\u3002 7\uff09\u5bf9\u4e8e\u5360\u7528\u5185\u5b58\u6bd4\u8f83\u591a\u7684\u5927\u5bf9\u8c61\uff0c\u4e00\u822c\u4f1a\u9009\u62e9\u5728\u8001\u5e74\u4ee3\u5206\u914d\u5185\u5b58\u3002\u5982\u679c\u5728\u5e74\u8f7b\u4ee3\u7ed9\u5927\u5bf9\u8c61\u5206\u914d\u5185\u5b58\uff0c\u5e74\u8f7b\u4ee3\u5185\u5b58\u4e0d\u591f\u4e86\uff0c\u5c31\u8981\u5728eden\u533a\u79fb\u52a8\u5927\u91cf\u5bf9\u8c61\u5230\u8001\u5e74\u4ee3\uff0c\u7136\u540e\u8fd9\u4e9b\u79fb\u52a8\u7684\u5bf9\u8c61\u53ef\u80fd\u5f88\u5feb\u6d88\u4ea1\uff0c\u56e0\u6b64\u5bfc\u81f4full GC\u3002\u901a\u8fc7\u8bbe\u7f6e\u53c2\u6570\uff1a-XX:PetenureSizeThreshold=1000000\uff0c\u5355\u4f4d\u4e3aB\uff0c\u6807\u660e\u5bf9\u8c61\u5927\u5c0f\u8d85\u8fc71M\u65f6\uff0c\u5728\u8001\u5e74\u4ee3(tenured)\u5206\u914d\u5185\u5b58\u7a7a\u95f4\u3002 8\uff09\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5e74\u8f7b\u5bf9\u8c61\u653e\u5728eden\u533a\uff0c\u5f53\u7b2c\u4e00\u6b21GC\u540e\uff0c\u5982\u679c\u5bf9\u8c61\u8fd8\u5b58\u6d3b\uff0c\u653e\u5230survivor\u533a\uff0c\u6b64\u540e\uff0c\u6bcfGC\u4e00\u6b21\uff0c\u5e74\u9f84\u589e\u52a01\uff0c\u5f53\u5bf9\u8c61\u7684\u5e74\u9f84\u8fbe\u5230\u9608\u503c\uff0c\u5c31\u88ab\u653e\u5230tenured\u8001\u5e74\u533a\u3002\u8fd9\u4e2a\u9608\u503c\u53ef\u4ee5\u540c\u6784-XX:MaxTenuringThreshold\u8bbe\u7f6e\u3002\u5982\u679c\u60f3\u8ba9\u5bf9\u8c61\u7559\u5728\u5e74\u8f7b\u4ee3\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6bd4\u8f83\u5927\u7684\u9608\u503c\u3002 \uff081\uff09-XX:+UseParallelGC:\u5e74\u8f7b\u4ee3\u4f7f\u7528\u5e76\u884c\u5783\u573e\u56de\u6536\u6536\u96c6\u5668\u3002\u8fd9\u662f\u4e00\u4e2a\u5173\u6ce8\u541e\u5410\u91cf\u7684\u6536\u96c6\u5668\uff0c\u53ef\u4ee5\u5c3d\u53ef\u80fd\u7684\u51cf\u5c11\u5783\u573e\u56de\u6536\u65f6\u95f4\u3002 \uff082\uff09-XX:+UseParallelOldGC:\u8bbe\u7f6e\u8001\u5e74\u4ee3\u4f7f\u7528\u5e76\u884c\u5783\u573e\u56de\u6536\u6536\u96c6\u5668\u3002 9\uff09\u5c1d\u8bd5\u4f7f\u7528\u5927\u7684\u5185\u5b58\u5206\u9875\uff1a\u4f7f\u7528\u5927\u7684\u5185\u5b58\u5206\u9875\u589e\u52a0CPU\u7684\u5185\u5b58\u5bfb\u5740\u80fd\u529b\uff0c\u4ece\u800c\u7cfb\u7edf\u7684\u6027\u80fd\u3002 -XX:+LargePageSizeInBytes \u8bbe\u7f6e\u5185\u5b58\u9875\u7684\u5927\u5c0f 10\uff09\u4f7f\u7528\u975e\u5360\u7528\u7684\u5783\u573e\u6536\u96c6\u5668\u3002 -XX:+UseConcMarkSweepGC\u8001\u5e74\u4ee3\u4f7f\u7528CMS\u6536\u96c6\u5668\u964d\u4f4e\u505c\u987f\u3002","title":"4.2 \u7528\u7684 JVM \u8c03\u4f18\u7684\u53c2\u6570\u90fd\u6709\u54ea\u4e9b\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#43-jvm","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606","title":"4.3 \u8bf4\u4e00\u4e0b JVM \u8c03\u4f18\u7684\u5de5\u5177\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#431","text":"","title":"4.3.1 \u547d\u4ee4\u5de5\u5177"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4311-jpsjava-process-status","text":"\u8f93\u51faJVM\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f(\u73b0\u5728\u4e00\u822c\u4f7f\u7528jconsole)","title":"4.3.1.1 jps\uff08Java Process Status\uff09"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4312-jstack","text":"\u67e5\u770bjava\u8fdb\u7a0b\u5185 \u7ebf\u7a0b\u7684\u5806\u6808 \u4fe1\u606f\u3002 jstack [option] <pid> java\u6848\u4f8b package com.heima.jvm; public class Application { public static void main(String[] args) throws InterruptedException { while (true){ Thread.sleep(1000); System.out.println(\"\u54c8\u54c8\u54c8\"); } } } \u4f7f\u7528jstack\u67e5\u770b\u8fdb\u884c\u5806\u6808\u8fd0\u884c\u4fe1\u606f","title":"4.3.1.2 jstack"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4313-jmap","text":"\u7528\u4e8e\u751f\u6210\u5806\u8f6c\u5b58\u5feb\u7167 jmap [options] pid \u5185\u5b58\u6620\u50cf\u4fe1\u606f jmap -heap pid \u663e\u793aJava\u5806\u7684\u4fe1\u606f jmap -dump:format=b,file=heap.hprof pid \u200b format=b\u8868\u793a\u4ee5hprof\u4e8c\u8fdb\u5236\u683c\u5f0f\u8f6c\u50a8Java\u5806\u7684\u5185\u5b58 \u200b file= \u7528\u4e8e\u6307\u5b9a\u5feb\u7167dump\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u3002 \u4f8b\uff1a\u663e\u793a\u4e86\u67d0\u4e00\u4e2ajava\u8fd0\u884c\u7684\u5806\u4fe1\u606f C:\\Users\\yuhon>jmap -heap 53280 Attaching to process ID 53280, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.321-b07 using thread-local object allocation. Parallel GC with 8 thread(s) //\u5e76\u884c\u7684\u5783\u573e\u56de\u6536\u5668 Heap Configuration: //\u5806\u914d\u7f6e MinHeapFreeRatio = 0 //\u7a7a\u95f2\u5806\u7a7a\u95f4\u7684\u6700\u5c0f\u767e\u5206\u6bd4 MaxHeapFreeRatio = 100 //\u7a7a\u95f2\u5806\u7a7a\u95f4\u7684\u6700\u5927\u767e\u5206\u6bd4 MaxHeapSize = 8524922880 (8130.0MB) //\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c NewSize = 178257920 (170.0MB) //\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c MaxNewSize = 2841640960 (2710.0MB) //\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c OldSize = 356515840 (340.0MB) //\u8001\u5e74\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c NewRatio = 2 //\u65b0\u751f\u4ee3\u4e0e\u8001\u5e74\u4ee3\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\uff0c\u8868\u793a\u65b0\u751f\u4ee3\uff1a\u8001\u5e74\u4ee3=1\uff1a2 SurvivorRatio = 8 //\u4e24\u4e2aSurvivor\u533a\u548cEden\u533a\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\u4e3a8,\u8868\u793aS0:S1:Eden=1:1:8 MetaspaceSize = 21807104 (20.796875MB) //\u5143\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c CompressedClassSpaceSize = 1073741824 (1024.0MB) //\u538b\u7f29\u7c7b\u4f7f\u7528\u7a7a\u95f4\u5927\u5c0f MaxMetaspaceSize = 17592186044415 MB //\u5143\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c G1HeapRegionSize = 0 (0.0MB)//\u5728\u4f7f\u7528 G1 \u5783\u573e\u56de\u6536\u7b97\u6cd5\u65f6\uff0cJVM \u4f1a\u5c06 Heap \u7a7a\u95f4\u5206\u9694\u4e3a\u82e5\u5e72\u4e2a Region\uff0c\u8be5\u53c2\u6570\u7528\u6765\u6307\u5b9a\u6bcf\u4e2a Region \u7a7a\u95f4\u7684\u5927\u5c0f\u3002 Heap Usage: PS Young Generation Eden Space: //Eden\u4f7f\u7528\u60c5\u51b5 capacity = 134217728 (128.0MB) used = 10737496 (10.240074157714844MB) free = 123480232 (117.75992584228516MB) 8.000057935714722% used From Space: //Survivor-From \u4f7f\u7528\u60c5\u51b5 capacity = 22020096 (21.0MB) used = 0 (0.0MB) free = 22020096 (21.0MB) 0.0% used To Space: //Survivor-To \u4f7f\u7528\u60c5\u51b5 capacity = 22020096 (21.0MB) used = 0 (0.0MB) free = 22020096 (21.0MB) 0.0% used PS Old Generation //\u8001\u5e74\u4ee3 \u4f7f\u7528\u60c5\u51b5 capacity = 356515840 (340.0MB) used = 0 (0.0MB) free = 356515840 (340.0MB) 0.0% used 3185 interned Strings occupying 261264 bytes.","title":"4.3.1.3 jmap"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4314-jhat","text":"\u7528\u4e8e\u5206\u6790jmap\u751f\u6210\u7684\u5806\u8f6c\u5b58\u5feb\u7167\uff08\u4e00\u822c\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u800c\u662f\u4f7f\u7528Ecplise Memory Analyzer\uff09","title":"4.3.1.4 jhat"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4315-jstat","text":"\u662fJVM\u7edf\u8ba1\u76d1\u6d4b\u5de5\u5177\u3002\u53ef\u4ee5\u7528\u6765\u663e\u793a\u5783\u573e\u56de\u6536\u4fe1\u606f\u3001\u7c7b\u52a0\u8f7d\u4fe1\u606f\u3001\u65b0\u751f\u4ee3\u7edf\u8ba1\u4fe1\u606f\u7b49\u3002 \u5e38\u89c1\u53c2\u6570 \uff1a \u2460\u603b\u7ed3\u5783\u573e\u56de\u6536\u7edf\u8ba1 jstat -gcutil pid \u5b57\u6bb5 \u542b\u4e49 S0 \u5e78\u5b581\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b S1 \u5e78\u5b582\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b E \u4f0a\u7538\u56ed\u533a\u4f7f\u7528\u6bd4\u4f8b O \u8001\u5e74\u4ee3\u4f7f\u7528\u6bd4\u4f8b M \u5143\u6570\u636e\u533a\u4f7f\u7528\u6bd4\u4f8b CCS \u538b\u7f29\u4f7f\u7528\u6bd4\u4f8b YGC \u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 YGCT \u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536\u6d88\u8017\u65f6\u95f4 FGC \u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 FGCT \u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6d88\u8017\u65f6\u95f4 GCT \u5783\u573e\u56de\u6536\u6d88\u8017\u603b\u65f6\u95f4 \u2461\u5783\u573e\u56de\u6536\u7edf\u8ba1 jstat -gc pid","title":"4.3.1.5 jstat"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#432","text":"","title":"4.3.2 \u53ef\u89c6\u5316\u5de5\u5177"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4321-jconsole","text":"\u7528\u4e8e\u5bf9jvm\u7684\u5185\u5b58\uff0c\u7ebf\u7a0b\uff0c\u7c7b \u7684\u76d1\u63a7\uff0c\u662f\u4e00\u4e2a\u57fa\u4e8e jmx \u7684 GUI \u6027\u80fd\u76d1\u63a7\u5de5\u5177 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jconsole.exe \u5c31\u884c \u53ef\u4ee5\u5185\u5b58\u3001\u7ebf\u7a0b\u3001\u7c7b\u7b49\u4fe1\u606f","title":"4.3.2.1 jconsole"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#4322-visualvm","text":"\u80fd\u591f\u76d1\u63a7\u7ebf\u7a0b\uff0c\u5185\u5b58\u60c5\u51b5\uff0c\u67e5\u770b\u65b9\u6cd5\u7684CPU\u65f6\u95f4\u548c\u5185\u5b58\u4e2d\u7684\u5bf9 \u8c61\uff0c\u5df2\u88abGC\u7684\u5bf9\u8c61\uff0c\u53cd\u5411\u67e5\u770b\u5206\u914d\u7684\u5806\u6808 \u6253\u5f00\u65b9\u5f0f\uff1ajava \u5b89\u88c5\u76ee\u5f55 bin\u76ee\u5f55\u4e0b \u76f4\u63a5\u542f\u52a8 jvisualvm.exe\u5c31\u884c \u76d1\u63a7\u7a0b\u5e8f\u8fd0\u884c\u60c5\u51b5 \u67e5\u770b\u8fd0\u884c\u4e2d\u7684dump \u67e5\u770b\u5806\u4e2d\u7684\u4fe1\u606f","title":"4.3.2.2 VisualVM\uff1a\u6545\u969c\u5904\u7406\u5de5\u5177"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#44-java","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 \u539f\u56e0\uff1a \u5982\u679c\u7ebf\u7a0b\u8bf7\u6c42\u5206\u914d\u7684\u6808\u5bb9\u91cf\u8d85\u8fc7java\u865a\u62df\u673a\u6808\u5141\u8bb8\u7684\u6700\u5927\u5bb9\u91cf\u7684\u65f6\u5019\uff0cjava\u865a\u62df\u673a\u5c06\u629b\u51fa\u4e00\u4e2aStackOverFlowError\u5f02\u5e38 \u5982\u679cjava\u865a\u62df\u673a\u6808\u53ef\u4ee5\u52a8\u6001\u62d3\u5c55\uff0c\u5e76\u4e14\u6269\u5c55\u7684\u52a8\u4f5c\u5df2\u7ecf\u5c1d\u8bd5\u8fc7\uff0c\u4f46\u662f\u76ee\u524d\u65e0\u6cd5\u7533\u8bf7\u5230\u8db3\u591f\u7684\u5185\u5b58\u53bb\u5b8c\u6210\u62d3\u5c55\uff0c\u6216\u8005\u5728\u5efa\u7acb\u65b0\u7ebf\u7a0b\u7684\u65f6\u5019\u6ca1\u6709\u8db3\u591f\u7684\u5185\u5b58\u53bb\u521b\u5efa\u5bf9\u5e94\u7684\u865a\u62df\u673a\u6808\uff0c\u90a3java\u865a\u62df\u673a\u5c06\u4f1a\u629b\u51fa\u4e00\u4e2aOutOfMemoryError\u5f02\u5e38 \u5982\u679c\u4e00\u6b21\u52a0\u8f7d\u7684\u7c7b\u592a\u591a\uff0c\u5143\u7a7a\u95f4\u5185\u5b58\u4e0d\u8db3\uff0c\u5219\u4f1a\u62a5OutOfMemoryError: Metaspace 1\u3001\u901a\u8fc7jmap\u6307\u5b9a\u6253\u5370\u4ed6\u7684\u5185\u5b58\u5feb\u7167 dump \u6709\u7684\u60c5\u51b5\u662f\u5185\u5b58\u6ea2\u51fa\u4e4b\u540e\u7a0b\u5e8f\u5219\u4f1a\u76f4\u63a5\u4e2d\u65ad\uff0c\u800cjmap\u53ea\u80fd\u6253\u5370\u5728\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5efa\u8bae\u901a\u8fc7\u53c2\u6570\u7684\u65b9\u5f0f\u7684\u751f\u6210dump\u6587\u4ef6\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/app/dumps/ \u6307\u5b9a\u751f\u6210\u540e\u6587\u4ef6\u7684\u4fdd\u5b58\u76ee\u5f55 2\u3001\u901a\u8fc7\u5de5\u5177\uff0c VisualVM\uff08Ecplise MAT\uff09\u53bb\u5206\u6790 dump\u6587\u4ef6 VisualVM\u53ef\u4ee5\u52a0\u8f7d\u79bb\u7ebf\u7684dump\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe \u6587\u4ef6-->\u88c5\u5165--->\u9009\u62e9dump\u6587\u4ef6\u5373\u53ef\u67e5\u770b\u5806\u5feb\u7167\u4fe1\u606f \u5982\u679c\u662flinux\u7cfb\u7edf\u4e2d\u7684\u7a0b\u5e8f\uff0c\u5219\u9700\u8981\u628adump\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\uff08windows\u73af\u5883\uff09\u4e0b\uff0c\u6253\u5f00VisualVM\u5de5\u5177\u5206\u6790\u3002VisualVM\u76ee\u524d\u53ea\u652f\u6301\u5728windows\u73af\u5883\u4e0b\u8fd0\u884c\u53ef\u89c6\u5316 3\u3001\u901a\u8fc7\u67e5\u770b\u5806\u4fe1\u606f\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5927\u6982\u5b9a\u4f4d\u5185\u5b58\u6ea2\u51fa\u662f\u54ea\u884c\u4ee3\u7801\u51fa\u4e86\u95ee\u9898 4\u3001\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\uff0c\u901a\u8fc7\u9605\u8bfb\u4e0a\u4e0b\u6587\u7684\u60c5\u51b5\uff0c\u8fdb\u884c\u4fee\u590d\u5373\u53ef","title":"4.4 java\u5185\u5b58\u6cc4\u9732\u7684\u6392\u67e5\u601d\u8def\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#45-cpu","text":"\u96be\u6613\u7a0b\u5ea6\uff1a\u2606\u2606\u2606\u2606 \u51fa\u73b0\u9891\u7387\uff1a\u2606\u2606\u2606\u2606 1.\u4f7f\u7528top\u547d\u4ee4\u67e5\u770b\u5360\u7528cpu\u7684\u60c5\u51b5 2.\u901a\u8fc7top\u547d\u4ee4\u67e5\u770b\u540e\uff0c\u53ef\u4ee5\u67e5\u770b\u662f\u54ea\u4e00\u4e2a\u8fdb\u7a0b\u5360\u7528cpu\u8f83\u9ad8\uff0c\u4e0a\u56fe\u6240\u793a\u7684\u8fdb\u7a0b\u4e3a\uff1a30978 3.\u67e5\u770b\u5f53\u524d\u7ebf\u7a0b\u4e2d\u7684\u8fdb\u7a0b\u4fe1\u606f ps H -eo pid,tid,%cpu | grep 40940 pid \u8fdb\u884cid tid \u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0bid % cpu\u4f7f\u7528\u7387 4.\u901a\u8fc7\u4e0a\u56fe\u5206\u6790\uff0c\u5728\u8fdb\u7a0b30978\u4e2d\u7684\u7ebf\u7a0b30979\u5360\u7528cpu\u8f83\u9ad8 \u6ce8\u610f\uff1a\u4e0a\u8ff0\u7684\u7ebf\u7a0bid\u662f\u4e00\u4e2a\u5341\u8fdb\u5236\uff0c\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u7ebf\u7a0bid\u8f6c\u6362\u4e3a16\u8fdb\u5236\u624d\u884c\uff0c\u56e0\u4e3a\u901a\u5e38\u5728\u65e5\u5fd7\u4e2d\u5c55\u793a\u7684\u90fd\u662f16\u8fdb\u5236\u7684\u7ebf\u7a0bid\u540d\u79f0 \u8f6c\u6362\u65b9\u5f0f\uff1a \u5728linux\u4e2d\u6267\u884c\u547d\u4ee4 printf \"%x\\n\" 30979 5.\u53ef\u4ee5\u6839\u636e\u7ebf\u7a0b id \u627e\u5230\u6709\u95ee\u9898\u7684\u7ebf\u7a0b\uff0c\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u5230\u95ee\u9898\u4ee3\u7801\u7684\u6e90\u7801\u884c\u53f7 \u6267\u884c\u547d\u4ee4 jstack 30978 \u6b64\u5904\u662f\u8fdb\u7a0bid","title":"4.5 CPU\u98d9\u9ad8\u6392\u67e5\u65b9\u6848\u4e0e\u601d\u8def\uff1f"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#5","text":"","title":"5.\u9762\u8bd5\u73b0\u573a"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#51-jvm","text":"\u9762\u8bd5\u5b98 \uff1aJVM\u7531\u90a3\u4e9b\u90e8\u5206\u7ec4\u6210\uff0c\u8fd0\u884c\u6d41\u7a0b\u662f\u4ec0\u4e48\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d\u7684~~ \u5728JVM\u4e2d\u5171\u6709\u56db\u5927\u90e8\u5206\uff0c\u5206\u522b\u662fClassLoader\uff08\u7c7b\u52a0\u8f7d\u5668\uff09\u3001Runtime Data Area\uff08\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff0c\u5185\u5b58\u5206\u533a\uff09\u3001Execution Engine\uff08\u6267\u884c\u5f15\u64ce\uff09\u3001Native Method Library\uff08\u672c\u5730\u5e93\u63a5\u53e3\uff09 \u5b83\u4eec\u7684\u8fd0\u884c\u6d41\u7a0b\u662f\uff1a \u7b2c\u4e00\uff0c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u628aJava\u4ee3\u7801\u8f6c\u6362\u4e3a\u5b57\u8282\u7801 \u7b2c\u4e8c\uff0c\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff08Runtime Data Area\uff09\u628a\u5b57\u8282\u7801\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u5b57\u8282\u7801\u6587\u4ef6\u53ea\u662fJVM\u7684\u4e00\u5957\u6307\u4ee4\u96c6\u89c4\u8303\uff0c\u5e76\u4e0d\u80fd\u76f4\u63a5\u4ea4\u7ed9\u5e95\u5c42\u7cfb\u7edf\u53bb\u6267\u884c\uff0c\u800c\u662f\u6709\u6267\u884c\u5f15\u64ce\u8fd0\u884c \u7b2c\u4e09\uff0c\u6267\u884c\u5f15\u64ce\uff08Execution Engine\uff09\u5c06\u5b57\u8282\u7801\u7ffb\u8bd1\u4e3a\u5e95\u5c42\u7cfb\u7edf\u6307\u4ee4\uff0c\u518d\u4ea4\u7531CPU\u6267\u884c\u53bb\u6267\u884c\uff0c\u6b64\u65f6\u9700\u8981\u8c03\u7528\u5176\u4ed6\u8bed\u8a00\u7684\u672c\u5730\u5e93\u63a5\u53e3\uff08Native Method Library\uff09\u6765\u5b9e\u73b0\u6574\u4e2a\u7a0b\u5e8f\u7684\u529f\u80fd\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u80fd\u8be6\u7ec6\u8bf4\u4e00\u4e0b JVM \u8fd0\u884c\u65f6\u6570\u636e\u533a\u5417\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d~ \u8fd0\u884c\u65f6\u6570\u636e\u533a\u5305\u542b\u4e86\u5806\u3001\u65b9\u6cd5\u533a\u3001\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668\u8fd9\u51e0\u90e8\u5206\uff0c\u6bcf\u4e2a\u529f\u80fd\u4f5c\u7528\u4e0d\u4e00\u6837\u3002 \u5806\u89e3\u51b3\u7684\u662f\u5bf9\u8c61\u5b9e\u4f8b\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u5783\u573e\u56de\u6536\u5668\u7ba1\u7406\u7684\u4e3b\u8981\u533a\u57df\u3002 \u65b9\u6cd5\u533a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u5806\u7684\u4e00\u90e8\u5206\uff0c\u7528\u4e8e\u5b58\u50a8\u5df2\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u3002 \u6808\u89e3\u51b3\u7684\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u95ee\u9898\uff0c\u6808\u91cc\u9762\u5b58\u7684\u662f\u6808\u5e27\uff0c\u6808\u5e27\u91cc\u9762\u5b58\u7684\u662f\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\u3001\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002 \u672c\u5730\u65b9\u6cd5\u6808\u4e0e\u6808\u529f\u80fd\u76f8\u540c\uff0c\u672c\u5730\u65b9\u6cd5\u6808\u6267\u884c\u7684\u662f\u672c\u5730\u65b9\u6cd5\uff0c\u4e00\u4e2aJava\u8c03\u7528\u975eJava\u4ee3\u7801\u7684\u63a5\u53e3\u3002 \u7a0b\u5e8f\u8ba1\u6570\u5668\uff08PC\u5bc4\u5b58\u5668\uff09\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e2d\u5b58\u653e\u7684\u662f\u5f53\u524d\u7ebf\u7a0b\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u6570\u3002JVM\u5de5\u4f5c\u65f6\u5c31\u662f\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u4e2a\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u3002 \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u4f60\u518d\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u7a0b\u5e8f\u8ba1\u6570\u5668\u7684\u4f5c\u7528\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837~~ java\u865a\u62df\u673a\u5bf9\u4e8e\u591a\u7ebf\u7a0b\u662f\u901a\u8fc7\u7ebf\u7a0b\u8f6e\u6d41\u5207\u6362\u5e76\u4e14\u5206\u914d\u7ebf\u7a0b\u6267\u884c\u65f6\u95f4\u3002\u5728\u4efb\u4f55\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u53ea\u4f1a\u5904\u7406\u6267\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u5f53\u524d\u88ab\u6267\u884c\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u5b83\u6240\u5206\u914d\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\u3010\u6302\u8d77\u3011\u3002\u5904\u7406\u5668\u4f1a\u5207\u6362\u5230\u53e6\u5916\u7684\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6765\u8fdb\u884c\u6267\u884c\u3002\u5e76\u4e14\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u65f6\u95f4\u7528\u5b8c\u4e86\uff0c\u63a5\u7740\u5904\u7406\u5668\u5c31\u4f1a\u53c8\u6765\u6267\u884c\u88ab\u6302\u8d77\u7684\u8fd9\u4e2a\u7ebf\u7a0b\u3002\u8fd9\u65f6\u5019\u7a0b\u5e8f\u8ba1\u6570\u5668\u5c31\u8d77\u5230\u4e86\u5173\u952e\u4f5c\u7528\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\u5728\u6765\u56de\u5207\u6362\u7684\u7ebf\u7a0b\u4e2d\u8bb0\u5f55\u4ed6\u4e0a\u4e00\u6b21\u6267\u884c\u7684\u884c\u53f7\uff0c\u7136\u540e\u63a5\u7740\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002 \u9762\u8bd5\u5b98 \uff1a\u4f60\u80fd\u7ed9\u6211\u8be6\u7ec6\u7684\u4ecb\u7ecdJava\u5806\u5417? \u5019\u9009\u4eba: \u597d\u7684~ Java\u4e2d\u7684\u5806\u672f\u8bed\u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df\u3002\u4e3b\u8981\u7528\u6765\u4fdd\u5b58 \u5bf9\u8c61\u5b9e\u4f8b\uff0c\u6570\u7ec4 \u7b49\uff0c\u5f53\u5806\u4e2d\u6ca1\u6709\u5185\u5b58\u7a7a\u95f4\u53ef\u5206\u914d\u7ed9\u5b9e\u4f8b\uff0c\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5219\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002 \u200b \u5728JAVA8\u4e2d\u5806\u5185\u4f1a\u5b58\u5728\u5e74\u8f7b\u4ee3\u3001\u8001\u5e74\u4ee3 \u200b 1\uff09Young\u533a\u88ab\u5212\u5206\u4e3a\u4e09\u90e8\u5206\uff0cEden\u533a\u548c\u4e24\u4e2a\u5927\u5c0f\u4e25\u683c\u76f8\u540c\u7684Survivor\u533a\uff0c\u5176\u4e2d\uff0cSurvivor\u533a\u95f4\u4e2d\uff0c\u67d0\u4e00\u65f6\u523b\u53ea\u6709\u5176\u4e2d\u4e00\u4e2a\u662f\u88ab\u4f7f\u7528\u7684\uff0c\u53e6\u5916\u4e00\u4e2a\u7559\u505a\u5783\u573e\u6536\u96c6\u65f6\u590d\u5236\u5bf9\u8c61\u7528\u3002\u5728Eden\u533a\u53d8\u6ee1\u7684\u65f6\u5019\uff0c GC\u5c31\u4f1a\u5c06\u5b58\u6d3b\u7684\u5bf9\u8c61\u79fb\u5230\u7a7a\u95f2\u7684Survivor\u533a\u95f4\u4e2d\uff0c\u6839\u636eJVM\u7684\u7b56\u7565\uff0c\u5728\u7ecf\u8fc7\u51e0\u6b21\u5783\u573e\u6536\u96c6\u540e\uff0c\u4efb\u7136\u5b58\u6d3b\u4e8eSurvivor\u7684\u5bf9\u8c61\u5c06\u88ab\u79fb\u52a8\u5230Tenured\u533a\u95f4\u3002 \u200b 2\uff09Tenured\u533a\u4e3b\u8981\u4fdd\u5b58\u751f\u547d\u5468\u671f\u957f\u7684\u5bf9\u8c61\uff0c\u4e00\u822c\u662f\u4e00\u4e9b\u8001\u7684\u5bf9\u8c61\uff0c\u5f53\u4e00\u4e9b\u5bf9\u8c61\u5728Young\u590d\u5236\u8f6c\u79fb\u4e00\u5b9a\u7684\u6b21\u6570\u4ee5\u540e\uff0c\u5bf9\u8c61\u5c31\u4f1a\u88ab\u8f6c\u79fb\u5230Tenured\u533a\u3002 \u9762\u8bd5\u5b98 \uff1a\u80fd\u4e0d\u80fd\u89e3\u91ca\u4e00\u4e0b\u65b9\u6cd5\u533a\uff1f \u5019\u9009\u4eba: \u597d\u7684~ \u4e0e\u865a\u62df\u673a\u6808\u7c7b\u4f3c\u3002\u672c\u5730\u65b9\u6cd5\u6808\u662f\u4e3a\u865a\u62df\u673a \u6267\u884c\u672c\u5730\u65b9\u6cd5\u65f6\u63d0\u4f9b\u670d\u52a1\u7684 \u3002\u4e0d\u9700\u8981\u8fdb\u884cGC\u3002\u672c\u5730\u65b9\u6cd5\u4e00\u822c\u662f\u7531\u5176\u4ed6\u8bed\u8a00\u7f16\u5199\u3002 \u9762\u8bd5\u5b98 \uff1a\u4f60\u542c\u8fc7\u76f4\u63a5\u5185\u5b58\u5417\uff1f \u5019\u9009\u4eba: \u55ef~~ \u5b83\u53c8\u53eb\u505a \u5806\u5916\u5185\u5b58 \uff0c \u7ebf\u7a0b\u5171\u4eab\u7684\u533a\u57df \uff0c\u5728 Java 8 \u4e4b\u524d\u6709\u4e2a \u6c38\u4e45\u4ee3 \u7684\u6982\u5ff5\uff0c\u5b9e\u9645\u4e0a\u6307\u7684\u662f HotSpot \u865a\u62df\u673a\u4e0a\u7684\u6c38\u4e45\u4ee3\uff0c\u5b83\u7528\u6c38\u4e45\u4ee3\u5b9e\u73b0\u4e86 JVM \u89c4\u8303\u5b9a\u4e49\u7684\u65b9\u6cd5\u533a\u529f\u80fd\uff0c \u4e3b\u8981\u5b58\u50a8\u7c7b\u7684\u4fe1\u606f\uff0c\u5e38\u91cf\uff0c\u9759\u6001\u53d8\u91cf \uff0c\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u4ee3\u7801\u7b49\uff0c\u8fd9\u90e8\u5206\u7531\u4e8e\u662f\u5728\u5806\u4e2d\u5b9e\u73b0\u7684\uff0c\u53d7 GC \u7684\u7ba1\u7406\uff0c\u4e0d\u8fc7\u7531\u4e8e\u6c38\u4e45\u4ee3\u6709 -XX:MaxPermSize \u7684\u4e0a\u9650\uff0c\u6240\u4ee5\u5982\u679c\u5927\u91cf\u52a8\u6001\u751f\u6210\u7c7b\uff08\u5c06\u7c7b\u4fe1\u606f\u653e\u5165\u6c38\u4e45\u4ee3\uff09\uff0c\u5f88\u5bb9\u6613\u9020\u6210 OOM\uff0c\u6709\u4eba\u8bf4\u53ef\u4ee5\u628a\u6c38\u4e45\u4ee3\u8bbe\u7f6e\u5f97\u8db3\u591f\u5927\uff0c\u4f46\u5f88\u96be\u786e\u5b9a\u4e00\u4e2a\u5408\u9002\u7684\u5927\u5c0f\uff0c\u53d7\u7c7b\u6570\u91cf\uff0c\u5e38\u91cf\u6570\u91cf\u7684\u591a\u5c11\u5f71\u54cd\u5f88\u5927\u3002 \u200b \u6240\u4ee5\u5728 Java 8 \u4e2d\u5c31\u628a\u65b9\u6cd5\u533a\u7684\u5b9e\u73b0\u79fb\u5230\u4e86\u672c\u5730\u5185\u5b58\u4e2d\u7684\u5143\u7a7a\u95f4\u4e2d\uff0c\u8fd9\u6837\u65b9\u6cd5\u533a\u5c31\u4e0d\u53d7 JVM \u7684\u63a7\u5236\u4e86,\u4e5f\u5c31\u4e0d\u4f1a\u8fdb\u884c GC\uff0c\u4e5f\u56e0\u6b64\u63d0\u5347\u4e86\u6027\u80fd\u3002 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u865a\u62df\u673a\u6808 \u5019\u9009\u4eba: \u865a\u62df\u673a\u6808\u662f\u63cf\u8ff0\u7684\u662f\u65b9\u6cd5\u6267\u884c\u65f6\u7684\u5185\u5b58\u6a21\u578b,\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u751f\u547d\u5468\u671f\u4e0e\u7ebf\u7a0b\u76f8\u540c,\u6bcf\u4e2a\u65b9\u6cd5\u88ab\u6267\u884c\u7684\u540c\u65f6\u4f1a\u521b\u5efa \u6808\u6862 \u3002\u4fdd\u5b58\u6267\u884c\u65b9\u6cd5\u65f6\u7684 \u5c40\u90e8\u53d8\u91cf\u3001\u52a8\u6001\u8fde\u63a5\u4fe1\u606f\u3001\u65b9\u6cd5\u8fd4\u56de\u5730\u5740\u4fe1\u606f \u7b49\u7b49\u3002\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7684\u65f6\u5019\u4f1a\u8fdb\u6808\uff0c\u65b9\u6cd5\u6267\u884c\u5b8c\u4f1a\u51fa\u6808\u3010\u76f8\u5f53\u4e8e\u6e05\u7a7a\u4e86\u6570\u636e\u3011\uff0c\u6240\u4ee5\u8fd9\u5757\u533a\u57df \u4e0d\u9700\u8981\u8fdb\u884c GC \u3002 \u9762\u8bd5\u5b98 \uff1a\u80fd\u8bf4\u4e00\u4e0b\u5806\u6808\u7684\u533a\u522b\u662f\u4ec0\u4e48\u5417\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u597d\u7684\uff0c\u6709\u8fd9\u51e0\u4e2a\u533a\u522b \u7b2c\u4e00\uff0c\u6808\u5185\u5b58\u4e00\u822c\u4f1a\u7528\u6765\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u548c\u65b9\u6cd5\u8c03\u7528\uff0c\u4f46\u5806\u5185\u5b58\u662f\u7528\u6765\u5b58\u50a8Java\u5bf9\u8c61\u548c\u6570\u7ec4\u7684\u7684\u3002\u5806\u4f1aGC\u5783\u573e\u56de\u6536\uff0c\u800c\u6808\u4e0d\u4f1a\u3002 \u7b2c\u4e8c\u3001\u6808\u5185\u5b58\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u800c\u5806\u5185\u5b58\u662f\u7ebf\u7a0b\u5171\u6709\u7684\u3002 \u7b2c\u4e09\u3001\u4e24\u8005\u5f02\u5e38\u9519\u8bef\u4e0d\u540c\uff0c\u4f46\u5982\u679c\u6808\u5185\u5b58\u6216\u8005\u5806\u5185\u5b58\u4e0d\u8db3\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\u3002 \u6808\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.StackOverFlowError\u3002 \u5806\u7a7a\u95f4\u4e0d\u8db3\uff1ajava.lang.OutOfMemoryError\u3002","title":"5.1 JVM\u7ec4\u6210"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#52","text":"\u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u7c7b\u52a0\u8f7d\u5668\uff0c\u7c7b\u52a0\u8f7d\u5668\u6709\u54ea\u4e9b? \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837\u7684 JVM\u53ea\u4f1a\u8fd0\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u800c\u7c7b\u52a0\u8f7d\u5668\uff08ClassLoader\uff09\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5c06 \u5b57\u8282\u7801\u6587\u4ef6\u52a0\u8f7d\u5230JVM\u4e2d \uff0c\u4ece\u800c\u8ba9Java\u7a0b\u5e8f\u80fd\u591f\u542f\u52a8\u8d77\u6765\u3002 \u5e38\u89c1\u7684\u7c7b\u52a0\u8f7d\u5668\u67094\u4e2a \u7b2c\u4e00\u4e2a\u662f\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668(BootStrap ClassLoader)\uff1a\u5176\u662f\u7531C++\u7f16\u5199\u5b9e\u73b0\u3002\u7528\u4e8e\u52a0\u8f7dJAVA_HOME/jre/lib\u76ee\u5f55\u4e0b\u7684\u7c7b\u5e93\u3002 \u7b2c\u4e8c\u4e2a\u662f\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668(ExtClassLoader)\uff1a\u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u52a0\u8f7dJAVA_HOME/jre/lib/ext\u76ee\u5f55\u4e2d\u7684\u7c7b\u5e93\u3002 \u7b2c\u4e09\u4e2a\u662f\u5e94\u7528\u7c7b\u52a0\u8f7d\u5668(AppClassLoader)\uff1a\u8be5\u7c7b\u662fClassLoader\u7684\u5b50\u7c7b\uff0c\u4e3b\u8981\u7528\u4e8e\u52a0\u8f7dclassPath\u4e0b\u7684\u7c7b\uff0c\u4e5f\u5c31\u662f\u52a0\u8f7d\u5f00\u53d1\u8005\u81ea\u5df1\u7f16\u5199\u7684Java\u7c7b\u3002 \u7b2c\u56db\u4e2a\u662f\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\uff1a\u5f00\u53d1\u8005\u81ea\u5b9a\u4e49\u7c7b\u7ee7\u627fClassLoader\uff0c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u89c4\u5219\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b\u7c7b\u88c5\u8f7d\u7684\u6267\u884c\u8fc7\u7a0b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u8fd8\u662f\u633a\u591a\u7684\u3002 \u7c7b\u4ece\u52a0\u8f7d\u5230\u865a\u62df\u673a\u4e2d\u5f00\u59cb\uff0c\u76f4\u5230\u5378\u8f7d\u4e3a\u6b62\uff0c\u5b83\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5305\u62ec\u4e86\uff1a\u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u89e3\u6790\u3001\u521d\u59cb\u5316\u3001\u4f7f\u7528\u548c\u5378\u8f7d\u8fd97\u4e2a\u9636\u6bb5\u3002\u5176\u4e2d\uff0c\u9a8c\u8bc1\u3001\u51c6\u5907\u548c\u89e3\u6790\u8fd9\u4e09\u4e2a\u90e8\u5206\u7edf\u79f0\u4e3a\u8fde\u63a5\uff08linking\uff09 1.\u52a0\u8f7d\uff1a\u67e5\u627e\u548c\u5bfc\u5165class\u6587\u4ef6 2.\u9a8c\u8bc1\uff1a\u4fdd\u8bc1\u52a0\u8f7d\u7c7b\u7684\u51c6\u786e\u6027 3.\u51c6\u5907\uff1a\u4e3a\u7c7b\u53d8\u91cf\u5206\u914d\u5185\u5b58\u5e76\u8bbe\u7f6e\u7c7b\u53d8\u91cf\u521d\u59cb\u503c 4.\u89e3\u6790\uff1a\u628a\u7c7b\u4e2d\u7684\u7b26\u53f7\u5f15\u7528\u8f6c\u6362\u4e3a\u76f4\u63a5\u5f15\u7528 5.\u521d\u59cb\u5316\uff1a\u5bf9\u7c7b\u7684\u9759\u6001\u53d8\u91cf\uff0c\u9759\u6001\u4ee3\u7801\u5757\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c 6.\u4f7f\u7528\uff1aJVM \u5f00\u59cb\u4ece\u5165\u53e3\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7528\u6237\u7684\u7a0b\u5e8f\u4ee3\u7801 7.\u5378\u8f7d\uff1a\u5f53\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u540e\uff0cJVM \u4fbf\u5f00\u59cb\u9500\u6bc1\u521b\u5efa\u7684 Class \u5bf9\u8c61\uff0c\u6700\u540e\u8d1f\u8d23\u8fd0\u884c\u7684 JVM \u4e5f\u9000\u51fa\u5185\u5b58 \u9762\u8bd5\u5b98 \uff1a\u4ec0\u4e48\u662f\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u5b83\u662f\u662f\u8fd9\u6837\u7684\u3002 \u5982\u679c\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u6536\u5230\u4e86\u7c7b\u52a0\u8f7d\u7684\u8bf7\u6c42\uff0c\u5b83\u9996\u5148\u4e0d\u4f1a\u81ea\u5df1\u5c1d\u8bd5\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\uff0c\u800c\u662f\u628a\u8fd9\u8bf7\u6c42\u59d4\u6d3e\u7ed9\u7236\u7c7b\u52a0\u8f7d\u5668\u53bb\u5b8c\u6210\uff0c\u6bcf\u4e00\u4e2a\u5c42\u6b21\u7684\u7c7b\u52a0\u8f7d\u5668\u90fd\u662f\u5982\u6b64\uff0c\u56e0\u6b64\u6240\u6709\u7684\u52a0\u8f7d\u8bf7\u6c42\u6700\u7ec8\u90fd\u5e94\u8be5\u4f20\u8bf4\u5230\u9876\u5c42\u7684\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u4e2d\uff0c\u53ea\u6709\u5f53\u7236\u7c7b\u52a0\u8f7d\u5668\u8fd4\u56de\u81ea\u5df1\u65e0\u6cd5\u5b8c\u6210\u8fd9\u4e2a\u52a0\u8f7d\u8bf7\u6c42\uff08\u5b83\u7684\u641c\u7d22\u8fd4\u56de\u4e2d\u6ca1\u6709\u627e\u5230\u6240\u9700\u7684\u7c7b\uff09\u65f6\uff0c\u5b50\u7c7b\u52a0\u8f7d\u5668\u624d\u4f1a\u5c1d\u8bd5\u81ea\u5df1\u53bb\u52a0\u8f7d \u9762\u8bd5\u5b98 \uff1aJVM\u4e3a\u4ec0\u4e48\u91c7\u7528\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236 \u5019\u9009\u4eba: \u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\u3002 \u7b2c\u4e00\u3001\u901a\u8fc7\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236\u53ef\u4ee5\u907f\u514d\u67d0\u4e00\u4e2a\u7c7b\u88ab\u91cd\u590d\u52a0\u8f7d\uff0c\u5f53\u7236\u7c7b\u5df2\u7ecf\u52a0\u8f7d\u540e\u5219\u65e0\u9700\u91cd\u590d\u52a0\u8f7d\uff0c\u4fdd\u8bc1\u552f\u4e00\u6027\u3002 \u7b2c\u4e8c\u3001\u4e3a\u4e86\u5b89\u5168\uff0c\u4fdd\u8bc1\u7c7b\u5e93API\u4e0d\u4f1a\u88ab\u4fee\u6539","title":"5.2 \u7c7b\u52a0\u8f7d\u5668"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#53","text":"\u9762\u8bd5\u5b98 \uff1a\u7b80\u8ff0Java\u5783\u573e\u56de\u6536\u673a\u5236\uff1f\uff08GC\u662f\u4ec0\u4e48\uff1f\u4e3a\u4ec0\u4e48\u8981GC\uff09 \u5019\u9009\u4eba: \u55ef\uff0c\u662f\u8fd9\u6837~~ \u4e3a\u4e86\u8ba9\u7a0b\u5e8f\u5458\u66f4\u4e13\u6ce8\u4e8e\u4ee3\u7801\u7684\u5b9e\u73b0\uff0c\u800c\u4e0d\u7528\u8fc7\u591a\u7684\u8003\u8651\u5185\u5b58\u91ca\u653e\u7684\u95ee\u9898\uff0c\u6240\u4ee5\uff0c\u5728Java\u8bed\u8a00\u4e2d\uff0c\u6709\u4e86\u81ea\u52a8\u7684\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u719f\u6089\u7684GC(Garbage Collection)\u3002 \u6709\u4e86\u5783\u573e\u56de\u6536\u673a\u5236\u540e\uff0c\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u5173\u5fc3\u5185\u5b58\u7684\u7533\u8bf7\u5373\u53ef\uff0c\u5185\u5b58\u7684\u91ca\u653e\u7531\u7cfb\u7edf\u81ea\u52a8\u8bc6\u522b\u5b8c\u6210\u3002 \u5728\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\uff0cGC\u4f1a\u91c7\u7528\u4e0d\u540c\u7684\u56de\u6536\u65f6\u673a \u9762\u8bd5\u5b98 \uff1a\u5f3a\u5f15\u7528\u3001\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u3001\u865a\u5f15\u7528\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba: \u55ef\u55ef~ \u5f3a\u5f15\u7528\u6700\u4e3a\u666e\u901a\u7684\u5f15\u7528\u65b9\u5f0f\uff0c\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u6709\u7528\u4e14\u5fc5\u987b \u7684\u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5177\u6709\u5f3a\u5f15\u7528\uff0c\u5219GC\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\u3002\u5373\u4fbf\u5806\u4e2d\u5185\u5b58\u4e0d\u8db3\u4e86\uff0c\u5b81\u53ef\u51fa\u73b0OOM\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u56de\u6536 \u8f6f\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u6709\u7528\u4e14\u975e\u5fc5\u987b \u72b6\u6001\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u8f6f\u5f15\u7528\uff0c\u5728\u5185\u5b58\u7a7a\u95f4\u8db3\u591f\u7684\u60c5\u51b5\u4e0b\uff0cGC\u673a\u5236\u5e76\u4e0d\u4f1a\u56de\u6536\u5b83\uff0c\u800c\u5728\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u5219\u4f1a\u5728OOM\u5f02\u5e38\u51fa\u73b0\u4e4b\u95f4\u5bf9\u5176\u8fdb\u884c\u56de\u6536\u3002\u4f46\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3aGC\u7ebf\u7a0b\u4f18\u5148\u7ea7\u8f83\u4f4e\uff0c\u8f6f\u5f15\u7528\u5e76\u4e0d\u4f1a\u7acb\u5373\u88ab\u56de\u6536\u3002 \u5f31\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u53ef\u80fd\u6709\u7528\u4e14\u975e\u5fc5\u987b \u7684\u72b6\u6001\u3002\u5728GC\u7ebf\u7a0b\u626b\u63cf\u5185\u5b58\u533a\u57df\u65f6\uff0c\u4e00\u65e6\u53d1\u73b0\u5f31\u5f15\u7528\uff0c\u5c31\u4f1a\u56de\u6536\u5230\u5f31\u5f15\u7528\u76f8\u5173\u8054\u7684\u5bf9\u8c61\u3002\u5bf9\u4e8e\u5f31\u5f15\u7528\u7684\u56de\u6536\uff0c\u65e0\u5173\u5185\u5b58\u533a\u57df\u662f\u5426\u8db3\u591f\uff0c\u4e00\u65e6\u53d1\u73b0\u5219\u4f1a\u88ab\u56de\u6536\u3002\u540c\u6837\u7684\uff0c\u56e0\u4e3aGC\u7ebf\u7a0b\u4f18\u5148\u7ea7\u8f83\u4f4e\uff0c\u6240\u4ee5\u5f31\u5f15\u7528\u4e5f\u5e76\u4e0d\u662f\u4f1a\u88ab\u7acb\u523b\u56de\u6536\u3002 \u865a\u5f15\u7528\u8868\u793a\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e \u65e0\u7528 \u7684\u72b6\u6001\u3002\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u6709\u53ef\u80fd\u88ab\u5783\u573e\u56de\u6536\u3002\u865a\u5f15\u7528\u7684\u4f7f\u7528\u5fc5\u987b\u548c\u5f15\u7528\u961f\u5217Reference Queue\u8054\u5408\u4f7f\u7528 \u9762\u8bd5\u5b98 \uff1a\u5bf9\u8c61\u4ec0\u4e48\u65f6\u5019\u53ef\u4ee5\u88ab\u5783\u573e\u5668\u56de\u6536 \u5019\u9009\u4eba: \u601d\u8003\u4e00\u4f1a~~ \u5982\u679c\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u6ca1\u6709\u4efb\u4f55\u7684\u5f15\u7528\u6307\u5411\u5b83\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u73b0\u5728\u5c31\u662f\u5783\u573e\uff0c\u5982\u679c\u5b9a\u4f4d\u4e86\u5783\u573e\uff0c\u5219\u6709\u53ef\u80fd\u4f1a\u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u3002 \u5982\u679c\u8981\u5b9a\u4f4d\u4ec0\u4e48\u662f\u5783\u573e\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u786e\u5b9a\uff0c\u7b2c\u4e00\u4e2a\u662f\u5f15\u7528\u8ba1\u6570\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u662f\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5 \u901a\u5e38\u90fd\u4f7f\u7528\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u6765\u786e\u5b9a\u662f\u4e0d\u662f\u5783\u573e \u9762\u8bd5\u5b98 \uff1a JVM \u5783\u573e\u56de\u6536\u7b97\u6cd5\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba: \u6211\u8bb0\u5f97\u4e00\u5171\u6709\u56db\u79cd\uff0c\u5206\u522b\u662f\u6807\u8bb0\u6e05\u9664\u7b97\u6cd5\u3001\u590d\u5236\u7b97\u6cd5\u3001\u6807\u8bb0\u6574\u7406\u7b97\u6cd5\u3001\u5206\u4ee3\u56de\u6536 \u9762\u8bd5\u5b98 \uff1a \u4f60\u80fd\u8be6\u7ec6\u804a\u4e00\u4e0b\u5206\u4ee3\u56de\u6536\u5417\uff1f \u5019\u9009\u4eba: \u5173\u4e8e\u5206\u4ee3\u56de\u6536\u662f\u8fd9\u6837\u7684 \u5728java8\u65f6\uff0c\u5806\u88ab\u5206\u4e3a\u4e86\u4e24\u4efd\uff1a\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c\u5b83\u4eec\u9ed8\u8ba4\u7a7a\u95f4\u5360\u7528\u6bd4\u4f8b\u662f1:2 \u5bf9\u4e8e\u65b0\u751f\u4ee3\uff0c\u5185\u90e8\u53c8\u88ab\u5206\u4e3a\u4e86\u4e09\u4e2a\u533a\u57df\u3002Eden\u533a\uff0cS0\u533a\uff0cS1\u533a\u9ed8\u8ba4\u7a7a\u95f4\u5360\u7528\u6bd4\u4f8b\u662f8:1:1 \u5177\u4f53\u7684\u5de5\u4f5c\u673a\u5236\u662f\u6709\u4e9b\u60c5\u51b5\uff1a 1\uff09\u5f53\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u4f1a\u88ab\u5206\u914d\u5728\u65b0\u751f\u4ee3\u7684Eden\u533a\u3002\u5f53Eden\u533a\u8981\u6ee1\u4e86\u65f6\u5019\uff0c\u89e6\u53d1YoungGC\u3002 2\uff09\u5f53\u8fdb\u884cYoungGC\u540e\uff0c\u6b64\u65f6\u5728Eden\u533a\u5b58\u6d3b\u7684\u5bf9\u8c61\u88ab\u79fb\u52a8\u5230S0\u533a\uff0c\u5e76\u4e14 \u5f53\u524d\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01 \uff0c\u6e05\u7a7aEden\u533a\u3002 3\uff09\u5f53\u518d\u4e00\u6b21\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u628aEden\u533a\u4e2d\u5b58\u6d3b\u4e0b\u6765\u7684\u5bf9\u8c61\u548cS0\u4e2d\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u5230S1\u533a\u4e2d\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01\uff0c\u6e05\u7a7aEden\u533a\u548cS0\u533a\u3002 4\uff09\u5f53\u518d\u4e00\u6b21\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u628aEden\u533a\u4e2d\u5b58\u6d3b\u4e0b\u6765\u7684\u5bf9\u8c61\u548cS1\u4e2d\u7684\u5bf9\u8c61\uff0c\u79fb\u52a8\u5230S0\u533a\u4e2d\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5e74\u9f84\u4f1a\u52a01\uff0c\u6e05\u7a7aEden\u533a\u548cS1\u533a\u3002 5\uff09\u5bf9\u8c61\u7684\u5e74\u9f84\u8fbe\u5230\u4e86\u67d0\u4e00\u4e2a\u9650\u5b9a\u7684\u503c\uff08 \u9ed8\u8ba415\u5c81 \uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4f1a\u8fdb\u5165\u5230\u8001\u5e74\u4ee3\u4e2d\u3002 \u5f53\u7136\u4e5f\u6709\u7279\u6b8a\u60c5\u51b5\uff0c\u5982\u679c\u8fdb\u5165Eden\u533a\u7684\u662f\u4e00\u4e2a\u5927\u5bf9\u8c61\uff0c\u5728\u89e6\u53d1YoungGC\u7684\u65f6\u5019\uff0c\u4f1a\u76f4\u63a5\u5b58\u653e\u5230\u8001\u5e74\u4ee3 \u5f53\u8001\u5e74\u4ee3\u6ee1\u4e86\u4e4b\u540e\uff0c \u89e6\u53d1FullGC \u3002 FullGC\u540c\u65f6\u56de\u6536\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3 \uff0c\u5f53\u524d\u53ea\u4f1a\u5b58\u5728\u4e00\u4e2aFullGC\u7684\u7ebf\u7a0b\u8fdb\u884c\u6267\u884c\uff0c\u5176\u4ed6\u7684\u7ebf\u7a0b\u5168\u90e8\u4f1a\u88ab\u6302\u8d77\u3002 \u6211\u4eec\u5728\u7a0b\u5e8f\u4e2d\u8981\u5c3d\u91cf\u907f\u514dFullGC\u7684\u51fa\u73b0\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bb2\u4e00\u4e0b\u65b0\u751f\u4ee3\u3001\u8001\u5e74\u4ee3\u3001\u6c38\u4e45\u4ee3\u7684\u533a\u522b\uff1f \u5019\u9009\u4eba: \u55ef\uff01\u662f\u8fd9\u6837\u7684\uff0c\u7b80\u5355\u8bf4\u5c31\u662f \u65b0\u751f\u4ee3 \u4e3b\u8981\u7528\u6765\u5b58\u653e\u65b0\u751f\u7684\u5bf9\u8c61\u3002 \u8001\u5e74\u4ee3 \u4e3b\u8981\u5b58\u653e\u5e94\u7528\u4e2d\u751f\u547d\u5468\u671f\u957f\u7684\u5185\u5b58\u5bf9\u8c61\u3002 \u6c38\u4e45\u4ee3 \u6307\u7684\u662f\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\u3002\u4e3b\u8981\u5b58\u653eClass\u548cMeta\uff08\u5143\u6570\u636e\uff09\u7684\u4fe1\u606f\u3002\u5728Java8\u4e2d\uff0c\u6c38\u4e45\u4ee3\u5df2\u7ecf\u88ab\u79fb\u9664\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u4e00\u4e2a\u79f0\u4e4b\u4e3a\u201c\u5143\u6570\u636e\u533a\u201d\uff08 \u5143\u7a7a\u95f4 \uff09\u7684\u533a\u57df\u3002\u5143\u7a7a\u95f4\u548c\u6c38\u4e45\u4ee3\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5143\u7a7a\u95f4\u4e0e\u6c38\u4e45\u4ee3\u4e4b\u95f4\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\uff1a\u5143\u7a7a\u95f4\u5e76\u4e0d\u5728\u865a\u62df\u673a\u4e2d\uff0c\u800c\u662f\u4f7f\u7528\u672c\u5730\u5185\u5b58\u3002\u56e0\u6b64\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5143\u7a7a\u95f4\u7684\u5927\u5c0f\u4ec5\u53d7\u672c\u5730\u5185\u5b58\u7684\u9650\u5236\u3002 \u9762\u8bd5\u5b98 \uff1a\u8bf4\u4e00\u4e0b JVM \u6709\u54ea\u4e9b\u5783\u573e\u56de\u6536\u5668\uff1f \u5019\u9009\u4eba: \u5728jvm\u4e2d\uff0c\u5b9e\u73b0\u4e86\u591a\u79cd\u5783\u573e\u6536\u96c6\u5668\uff0c\u5305\u62ec\uff1a\u4e32\u884c\u5783\u573e\u6536\u96c6\u5668\u3001\u5e76\u884c\u5783\u573e\u6536\u96c6\u5668\uff08JDK8\u9ed8\u8ba4\uff09\u3001CMS\uff08\u5e76\u53d1\uff09\u5783\u573e\u6536\u96c6\u5668\u3001G1\u5783\u573e\u6536\u96c6\u5668\uff08JDK9\u9ed8\u8ba4\uff09 \u9762\u8bd5\u5b98 \uff1aMinor GC\u3001Major GC\u3001Full GC\u662f\u4ec0\u4e48 \u5019\u9009\u4eba: \u55ef\uff0c\u5176\u5b9e\u5b83\u4eec\u6307\u7684\u662f\u4e0d\u540c\u4ee3\u4e4b\u95f4\u7684\u5783\u573e\u56de\u6536 Minor GC \u53d1\u751f\u5728\u65b0\u751f\u4ee3\u7684\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u77ed Major GC \u8001\u5e74\u4ee3\u533a\u57df\u7684\u5783\u573e\u56de\u6536\uff0c\u8001\u5e74\u4ee3\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u4f1a\u5148\u5c1d\u8bd5\u89e6\u53d1Minor GC\u3002Minor GC\u4e4b\u540e\u7a7a\u95f4\u8fd8\u4e0d\u8db3\uff0c\u5219\u4f1a\u89e6\u53d1Major GC\uff0cMajor GC\u901f\u5ea6\u6bd4\u8f83\u6162\uff0c\u6682\u505c\u65f6\u95f4\u957f Full GC \u65b0\u751f\u4ee3 + \u8001\u5e74\u4ee3\u5b8c\u6574\u5783\u573e\u56de\u6536\uff0c\u6682\u505c\u65f6\u95f4\u957f\uff0c \u5e94\u5c3d\u529b\u907f\u514d","title":"5.3 \u5783\u573e\u56de\u6536"},{"location":"heimajava/09-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AF%87/JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/#54-jvm","text":"\u9762\u8bd5\u5b98 \uff1aJVM \u8c03\u4f18\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u54ea\u91cc\u8bbe\u7f6e\u53c2\u6570\u503c\uff1f \u5019\u9009\u4eba: \u6211\u4eec\u5f53\u65f6\u7684\u9879\u76ee\u662fspringboot\u9879\u76ee\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u542f\u52a8\u7684\u65f6\u5019\uff0cjava -jar\u4e2d\u52a0\u5165\u53c2\u6570\u5c31\u884c\u4e86 \u9762\u8bd5\u5b98 \uff1a\u7528\u7684 JVM \u8c03\u4f18\u7684\u53c2\u6570\u90fd\u6709\u54ea\u4e9b\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e9b\u53c2\u6570\u662f\u6bd4\u8f83\u591a\u7684 \u6211\u8bb0\u5f97\u5f53\u65f6\u6211\u4eec\u8bbe\u7f6e\u8fc7\u5806\u7684\u5927\u5c0f\uff0c\u50cf-Xms\u548c-Xmx \u8fd8\u6709\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u548c\u4e24\u4e2aSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u4f8b \u8fd8\u6709\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u4f7f\u7528\u54ea\u79cd\u5783\u573e\u56de\u6536\u5668\u7b49\u7b49\u3002\u5177\u4f53\u7684\u6307\u4ee4\u8fd8\u771f\u8bb0\u4e0d\u592a\u6e05\u695a\u3002 \u9762\u8bd5\u5b98 \uff1a\u55ef\uff0c\u597d\u7684\uff0c\u4f60\u4eec\u5e73\u65f6\u8c03\u8bd5 JVM\u90fd\u7528\u4e86\u54ea\u4e9b\u5de5\u5177\u5462\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u662f\u4f7f\u7528jdk\u81ea\u5e26\u7684\u4e00\u4e9b\u5de5\u5177\uff0c\u6bd4\u5982 jps \u8f93\u51faJVM\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u72b6\u6001\u4fe1\u606f jstack\u67e5\u770bjava\u8fdb\u7a0b\u5185 \u7ebf\u7a0b\u7684\u5806\u6808 \u4fe1\u606f\u3002 jmap \u7528\u4e8e\u751f\u6210\u5806\u8f6c\u5b58\u5feb\u7167 jstat\u7528\u4e8eJVM\u7edf\u8ba1\u76d1\u6d4b\u5de5\u5177 \u8fd8\u6709\u4e00\u4e9b\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u50cfjconsole\u548cVisualVM\u7b49 \u9762\u8bd5\u5b98 \uff1a\u5047\u5982\u9879\u76ee\u4e2d\u4ea7\u751f\u4e86java\u5185\u5b58\u6cc4\u9732\uff0c\u4f60\u8bf4\u4e00\u4e0b\u4f60\u7684\u6392\u67e5\u601d\u8def\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u8fd9\u4e2a\u6211\u5728\u4e4b\u524d\u9879\u76ee\u6392\u67e5\u8fc7 \u7b2c\u4e00\u5462\u53ef\u4ee5\u901a\u8fc7jmap\u6307\u5b9a\u6253\u5370\u4ed6\u7684\u5185\u5b58\u5feb\u7167 dump\u6587\u4ef6\uff0c\u4e0d\u8fc7\u6709\u7684\u60c5\u51b5\u6253\u5370\u4e0d\u4e86\uff0c\u6211\u4eec\u4f1a\u8bbe\u7f6evm\u53c2\u6570\u8ba9\u7a0b\u5e8f\u81ea\u52a8\u751f\u6210dump\u6587\u4ef6 \u7b2c\u4e8c\uff0c\u53ef\u4ee5\u901a\u8fc7\u5de5\u5177\u53bb\u5206\u6790 dump\u6587\u4ef6\uff0cjdk\u81ea\u5e26\u7684VisualVM\u5c31\u53ef\u4ee5\u5206\u6790 \u7b2c\u4e09\uff0c\u901a\u8fc7\u67e5\u770b\u5806\u4fe1\u606f\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5927\u6982\u5b9a\u4f4d\u5185\u5b58\u6ea2\u51fa\u662f\u54ea\u884c\u4ee3\u7801\u51fa\u4e86\u95ee\u9898 \u7b2c\u56db\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4ee3\u7801\uff0c\u901a\u8fc7\u9605\u8bfb\u4e0a\u4e0b\u6587\u7684\u60c5\u51b5\uff0c\u8fdb\u884c\u4fee\u590d\u5373\u53ef \u9762\u8bd5\u5b98 \uff1a\u597d\u7684\uff0c\u90a3\u73b0\u5728\u518d\u6765\u8bf4\u4e00\u79cd\u60c5\u51b5\uff0c\u5c31\u662f\u8bf4\u670d\u52a1\u5668CPU\u6301\u7eed\u98d9\u9ad8\uff0c\u4f60\u7684\u6392\u67e5\u65b9\u6848\u4e0e\u601d\u8def\uff1f \u5019\u9009\u4eba: \u55ef\uff0c\u6211\u601d\u8003\u4e00\u4e0b~~ \u53ef\u4ee5\u8fd9\u4e48\u505a~~ \u7b2c\u4e00\u53ef\u4ee5\u4f7f\u7528\u4f7f\u7528top\u547d\u4ee4\u67e5\u770b\u5360\u7528cpu\u7684\u60c5\u51b5 \u7b2c\u4e8c\u901a\u8fc7top\u547d\u4ee4\u67e5\u770b\u540e\uff0c\u53ef\u4ee5\u67e5\u770b\u662f\u54ea\u4e00\u4e2a\u8fdb\u7a0b\u5360\u7528cpu\u8f83\u9ad8\uff0c\u8bb0\u5f55\u8fd9\u4e2a\u8fdb\u7a0bid \u7b2c\u4e09\u53ef\u4ee5\u901a\u8fc7ps \u67e5\u770b\u5f53\u524d\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u4fe1\u606f\uff0c\u770b\u770b\u54ea\u4e2a\u7ebf\u7a0b\u7684cpu\u5360\u7528\u8f83\u9ad8 \u7b2c\u56db\u53ef\u4ee5jstack\u547d\u4ee4\u6253\u5370\u8fdb\u884c\u7684id\uff0c\u627e\u5230\u8fd9\u4e2a\u7ebf\u7a0b\uff0c\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5b9a\u4f4d\u95ee\u9898\u4ee3\u7801\u7684\u884c\u53f7","title":"5.4 JVM\u5b9e\u8df5\uff08\u8c03\u4f18\uff09"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/","text":"10-\u4f01\u4e1a\u573a\u666f\u7bc7 \u8bbe\u8ba1\u6a21\u5f0f \u6280\u672f\u573a\u666f ELK\u642d\u5efa","title":"10-\u4f01\u4e1a\u573a\u666f\u7bc7"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/#10-","text":"\u8bbe\u8ba1\u6a21\u5f0f \u6280\u672f\u573a\u666f ELK\u642d\u5efa","title":"10-\u4f01\u4e1a\u573a\u666f\u7bc7"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","text":"\u9762\u8bd5\u4e13\u9898-\u8bbe\u8ba1\u6a21\u5f0f \u524d\u8a00 \u5728\u5e73\u65f6\u7684\u5f00\u53d1\u4e2d\uff0c\u6d89\u53ca\u5230\u8bbe\u8ba1\u6a21\u5f0f\u7684\u6709\u4e24\u5757\u5185\u5bb9\uff0c\u7b2c\u4e00\u4e2a\u662f\u6211\u4eec\u5e73\u65f6\u4f7f\u7528\u7684\u6846\u67b6\uff08\u6bd4\u5982spring\u3001mybatis\u7b49\uff09\uff0c\u7b2c\u4e8c\u4e2a\u662f\u6211\u4eec\u81ea\u5df1\u5f00\u53d1\u4e1a\u52a1\u4f7f\u7528\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002 \u9762\u8bd5\u5b98\u4e00\u822c\u6bd4\u8f83\u5173\u5fc3\u7684\u662f\u4f60\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6709\u6ca1\u6709\u4f7f\u7528\u8fc7\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6216\u8005\u4f60\u5728\u7b80\u5386\u4e0a\u5199\u4e86\u5173\u4e8e\u8bbe\u8ba1\u6a21\u5f0f\u7684\u63cf\u8ff0\uff0c\u90a3\u4e48\u8fd9\u6837\u6211\u4eec\u5c31\u9700\u8981\u91cd\u70b9\u5173\u5fc3\u81ea\u5df1\u5f00\u53d1\u4e2d\u7528\u8fc7\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002 \u5728\u5e73\u65f6\u7684\u4e1a\u52a1\u5f00\u53d1\u4e2d\uff0c\u5176\u5b9e\u771f\u6b63\u4f7f\u7528\u8bbe\u8ba1\u6a21\u5f0f\u7684\u573a\u666f\u5e76\u4e0d\u591a\uff0c\u867d\u7136\u8bbe\u8ba1\u53f7\u79f0\u670923\u79cd\u4e4b\u591a\uff08\u4e0d\u540c\u7684\u7eac\u5ea6\u53ef\u80fd\u4f1a\u66f4\u591a\uff09\uff0c\u4f46\u662f\u5728\u9879\u76ee\u6700\u5e38\u4f7f\u7528\u7684\u4e5f\u5c31\u51e0\u79cd\u800c\u5df2\uff0c\u5728\u9762\u8bd5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e00\u79cd\u6216\u4e24\u79cd\u5c31\u53ef\u4ee5\uff0c\u91cd\u70b9\u8981\u8bf4\u7684\u662f\uff1a\u5728\u4ec0\u4e48\u4e1a\u52a1\u573a\u666f\u4e0b\u4f7f\u7528\u4e86\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u4ec0\u4e48\u8bbe\u8ba1\u6a21\u5f0f\uff1f \u8fd9\u6b21\u9762\u8bd5\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e09\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff1a \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\uff08\u7b80\u5355\u5de5\u5382\u3001\u5de5\u5382\u65b9\u6cd5\u3001\u62bd\u8c61\u5de5\u5382\uff09 \u7b56\u7565\u6a21\u5f0f \u8d23\u4efb\u94fe\u6a21\u5f0f 1 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f 1.1 \u6982\u8ff0 \u9700\u6c42\uff1a\u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u5e97\u70b9\u9910\u7cfb\u7edf\u3002 \u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u7c7b\uff08Coffee\uff09\uff0c\u5e76\u5b9a\u4e49\u5176\u4e24\u4e2a\u5b50\u7c7b\uff08\u7f8e\u5f0f\u5496\u5561\u3010AmericanCoffee\u3011\u548c\u62ff\u94c1\u5496\u5561\u3010LatteCoffee\u3011\uff09\uff1b\u518d\u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u5e97\u7c7b\uff08CoffeeStore\uff09\uff0c\u5496\u5561\u5e97\u5177\u6709\u70b9\u5496\u5561\u7684\u529f\u80fd\u3002 \u5177\u4f53\u7c7b\u7684\u8bbe\u8ba1\u5982\u4e0b\uff1a 1.\u7c7b\u56fe\u4e2d\u7684\u7b26\u53f7 +\uff1a\u8868\u793apublic -\uff1a\u8868\u793aprivate \uff1a\u8868\u793aprotected 2.\u6cdb\u5316\u5173\u7cfb(\u7ee7\u627f)\u7528\u5e26\u7a7a\u5fc3\u4e09\u89d2\u7bad\u5934\u7684\u5b9e\u7ebf\u6765\u8868\u793a 3.\u4f9d\u8d56\u5173\u7cfb\u4f7f\u7528\u5e26\u7bad\u5934\u7684\u865a\u7ebf\u6765\u8868\u793a package com.itheima.factory.simple; public class CoffeeStore { public static void main(String[] args) { Coffee coffee = orderCoffee(\"latte\"); System.out.println(coffee.getName()); } public static Coffee orderCoffee(String type){ Coffee coffee = null; if(\"american\".equals(type)){ coffee = new AmericanCoffee(); }else if (\"latte\".equals(type)){ coffee = new LatteCoffee(); } //\u6dfb\u52a0\u914d\u6599 coffee.addMilk(); coffee.addSuqar(); return coffee; } } \u5728java\u4e2d\uff0c\u4e07\u7269\u7686\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u90fd\u9700\u8981\u521b\u5efa\uff0c\u5982\u679c\u521b\u5efa\u7684\u65f6\u5019\u76f4\u63a5new\u8be5\u5bf9\u8c61\uff0c\u5c31\u4f1a\u5bf9\u8be5\u5bf9\u8c61\u8026\u5408\u4e25\u91cd\uff0c\u5047\u5982\u6211\u4eec\u8981\u66f4\u6362\u5bf9\u8c61\uff0c\u6240\u6709new\u5bf9\u8c61\u7684\u5730\u65b9\u90fd\u9700\u8981\u4fee\u6539\u4e00\u904d\uff0c\u8fd9\u663e\u7136\u8fdd\u80cc\u4e86\u8f6f\u4ef6\u8bbe\u8ba1\u7684 \u5f00\u95ed\u539f\u5219 \u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528\u5de5\u5382\u6765\u751f\u4ea7\u5bf9\u8c61\uff0c\u6211\u4eec\u5c31\u53ea\u548c\u5de5\u5382\u6253\u4ea4\u9053\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f7b\u5e95\u548c\u5bf9\u8c61\u89e3\u8026\uff0c\u5982\u679c\u8981\u66f4\u6362\u5bf9\u8c61\uff0c\u76f4\u63a5\u5728\u5de5\u5382\u91cc\u66f4\u6362\u8be5\u5bf9\u8c61\u5373\u53ef\uff0c\u8fbe\u5230\u4e86\u4e0e\u5bf9\u8c61\u89e3\u8026\u7684\u76ee\u7684\uff1b\u6240\u4ee5\u8bf4\uff0c\u5de5\u5382\u6a21\u5f0f\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\uff1a \u89e3\u8026 \u3002 \u5f00\u95ed\u539f\u5219\uff1a \u5bf9\u6269\u5c55\u5f00\u653e\uff0c\u5bf9\u4fee\u6539\u5173\u95ed \u3002\u5728\u7a0b\u5e8f\u9700\u8981\u8fdb\u884c\u62d3\u5c55\u7684\u65f6\u5019\uff0c\u4e0d\u80fd\u53bb\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\uff0c\u5b9e\u73b0\u4e00\u4e2a\u70ed\u63d2\u62d4\u7684\u6548\u679c\u3002\u7b80\u8a00\u4e4b\uff0c\u662f\u4e3a\u4e86\u4f7f\u7a0b\u5e8f\u7684\u6269\u5c55\u6027\u597d\uff0c\u6613\u4e8e\u7ef4\u62a4\u548c\u5347\u7ea7\u3002 \u4e09\u79cd\u5de5\u5382 \u7b80\u5355\u5de5\u5382\u6a21\u5f0f \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f 1.2 \u7b80\u5355\u5de5\u5382\u6a21\u5f0f \u7b80\u5355\u5de5\u5382\u4e0d\u662f\u4e00\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u53cd\u800c\u6bd4\u8f83\u50cf\u662f\u4e00\u79cd\u7f16\u7a0b\u4e60\u60ef\u3002 1.2.1 \u7ed3\u6784 \u7b80\u5355\u5de5\u5382\u5305\u542b\u5982\u4e0b\u89d2\u8272\uff1a \u62bd\u8c61\u4ea7\u54c1 \uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\u3002 \u5177\u4f53\u4ea7\u54c1 \uff1a\u5b9e\u73b0\u6216\u8005\u7ee7\u627f\u62bd\u8c61\u4ea7\u54c1\u7684\u5b50\u7c7b \u5177\u4f53\u5de5\u5382 \uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u65b9\u6cd5\uff0c\u8c03\u7528\u8005\u901a\u8fc7\u8be5\u65b9\u6cd5\u6765\u83b7\u53d6\u4ea7\u54c1\u3002 1.2.2 \u5b9e\u73b0 \u73b0\u5728\u4f7f\u7528\u7b80\u5355\u5de5\u5382\u5bf9\u4e0a\u9762\u6848\u4f8b\u8fdb\u884c\u6539\u8fdb\uff0c\u7c7b\u56fe\u5982\u4e0b\uff1a \u5de5\u5382\u7c7b\u4ee3\u7801\u5982\u4e0b\uff1a public class SimpleCoffeeFactory { public Coffee createCoffee(String type) { Coffee coffee = null; if(\"americano\".equals(type)) { coffee = new AmericanoCoffee(); } else if(\"latte\".equals(type)) { coffee = new LatteCoffee(); } return coffee; } } \u5496\u5561\u5e97 package com.itheima.factory.simple; public class CoffeeStore { public Coffee orderCoffee(String type){ //\u901a\u8fc7\u5de5\u5382\u83b7\u5f97\u5bf9\u8c61\uff0c\u4e0d\u9700\u8981\u77e5\u9053\u5bf9\u8c61\u5b9e\u73b0\u7684\u7ec6\u8282 SimpleCoffeeFactory factory = new SimpleCoffeeFactory(); Coffee coffee = factory.createCoffee(type); //\u6dfb\u52a0\u914d\u6599 coffee.addMilk(); coffee.addSuqar(); return coffee; } } \u5de5\u5382\uff08factory\uff09\u5904\u7406\u521b\u5efa\u5bf9\u8c61\u7684\u7ec6\u8282\uff0c\u4e00\u65e6\u6709\u4e86SimpleCoffeeFactory\uff0cCoffeeStore\u7c7b\u4e2d\u7684orderCoffee()\u5c31\u53d8\u6210\u6b64\u5bf9\u8c61\u7684\u5ba2\u6237\uff0c\u540e\u671f\u5982\u679c\u9700\u8981Coffee\u5bf9\u8c61\u76f4\u63a5\u4ece\u5de5\u5382\u4e2d\u83b7\u53d6\u5373\u53ef\u3002\u8fd9\u6837\u4e5f\u5c31\u89e3\u9664\u4e86\u548cCoffee\u5b9e\u73b0\u7c7b\u7684\u8026\u5408\uff0c\u540c\u65f6\u53c8\u4ea7\u751f\u4e86\u65b0\u7684\u8026\u5408\uff0cCoffeeStore\u5bf9\u8c61\u548cSimpleCoffeeFactory\u5de5\u5382\u5bf9\u8c61\u7684\u8026\u5408\uff0c\u5de5\u5382\u5bf9\u8c61\u548c\u5546\u54c1\u5bf9\u8c61\u7684\u8026\u5408\u3002 \u540e\u671f\u5982\u679c\u518d\u52a0\u65b0\u54c1\u79cd\u7684\u5496\u5561\uff0c\u6211\u4eec\u52bf\u5fc5\u8981\u9700\u6c42\u4fee\u6539SimpleCoffeeFactory\u7684\u4ee3\u7801\uff0c\u8fdd\u53cd\u4e86\u5f00\u95ed\u539f\u5219\u3002\u5de5\u5382\u7c7b\u7684\u5ba2\u6237\u7aef\u53ef\u80fd\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u521b\u5efa\u7f8e\u56e2\u5916\u5356\u7b49\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\uff0c\u7701\u53bb\u5176\u4ed6\u7684\u4fee\u6539\u64cd\u4f5c\u3002 1.2.3 \u4f18\u7f3a\u70b9 \u4f18\u70b9\uff1a \u5c01\u88c5\u4e86\u521b\u5efa\u5bf9\u8c61\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u83b7\u53d6\u5bf9\u8c61\u3002\u628a\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u4e1a\u52a1\u903b\u8f91\u5c42\u5206\u5f00\uff0c\u8fd9\u6837\u4ee5\u540e\u5c31\u907f\u514d\u4e86\u4fee\u6539\u5ba2\u6237\u4ee3\u7801\uff0c\u5982\u679c\u8981\u5b9e\u73b0\u65b0\u4ea7\u54c1\u76f4\u63a5\u4fee\u6539\u5de5\u5382\u7c7b\uff0c\u800c\u4e0d\u9700\u8981\u5728\u539f\u4ee3\u7801\u4e2d\u4fee\u6539\uff0c\u8fd9\u6837\u5c31\u964d\u4f4e\u4e86\u5ba2\u6237\u4ee3\u7801\u4fee\u6539\u7684\u53ef\u80fd\u6027\uff0c\u66f4\u52a0\u5bb9\u6613\u6269\u5c55\u3002 \u7f3a\u70b9\uff1a \u589e\u52a0\u65b0\u4ea7\u54c1\u65f6\u8fd8\u662f\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\uff0c\u8fdd\u80cc\u4e86\u201c\u5f00\u95ed\u539f\u5219\u201d\u3002 1.2.4 \u6269\u5c55 \u9759\u6001\u5de5\u5382 \u5728\u5f00\u53d1\u4e2d\u4e5f\u6709\u4e00\u90e8\u5206\u4eba\u5c06\u5de5\u5382\u7c7b\u4e2d\u7684\u521b\u5efa\u5bf9\u8c61\u7684\u529f\u80fd\u5b9a\u4e49\u4e3a\u9759\u6001\u7684\uff0c\u8fd9\u4e2a\u5c31\u662f\u9759\u6001\u5de5\u5382\u6a21\u5f0f\uff0c\u5b83\u4e5f\u4e0d\u662f23\u79cd\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u7684\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public class SimpleCoffeeFactory { public static Coffee createCoffee(String type) { Coffee coffee = null; if(\"americano\".equals(type)) { coffee = new AmericanoCoffee(); } else if(\"latte\".equals(type)) { coffee = new LatteCoffee(); } return coffe; } } 1.3 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f \u9488\u5bf9\u4e0a\u4f8b\u4e2d\u7684\u7f3a\u70b9\uff0c\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u5c31\u53ef\u4ee5\u5b8c\u7f8e\u7684\u89e3\u51b3\uff0c\u5b8c\u5168\u9075\u5faa\u5f00\u95ed\u539f\u5219\u3002 1.3.1 \u6982\u5ff5 \u5b9a\u4e49\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5bf9\u8c61\u7684\u63a5\u53e3\uff0c\u8ba9\u5b50\u7c7b\u51b3\u5b9a\u5b9e\u4f8b\u5316\u54ea\u4e2a\u4ea7\u54c1\u7c7b\u5bf9\u8c61\u3002\u5de5\u5382\u65b9\u6cd5\u4f7f\u4e00\u4e2a\u4ea7\u54c1\u7c7b\u7684\u5b9e\u4f8b\u5316\u5ef6\u8fdf\u5230\u5176\u5de5\u5382\u7684\u5b50\u7c7b\u3002 1.3.2 \u7ed3\u6784 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\uff1a \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09\uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u63a5\u53e3\uff0c\u8c03\u7528\u8005\u901a\u8fc7\u5b83\u8bbf\u95ee\u5177\u4f53\u5de5\u5382\u7684\u5de5\u5382\u65b9\u6cd5\u6765\u521b\u5efa\u4ea7\u54c1\u3002 \u5177\u4f53\u5de5\u5382\uff08ConcreteFactory\uff09\uff1a\u4e3b\u8981\u662f\u5b9e\u73b0\u62bd\u8c61\u5de5\u5382\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5b8c\u6210\u5177\u4f53\u4ea7\u54c1\u7684\u521b\u5efa\u3002 \u62bd\u8c61\u4ea7\u54c1\uff08Product\uff09\uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\u3002 \u5177\u4f53\u4ea7\u54c1\uff08ConcreteProduct\uff09\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u4ea7\u54c1\u89d2\u8272\u6240\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u7531\u5177\u4f53\u5de5\u5382\u6765\u521b\u5efa\uff0c\u5b83\u540c\u5177\u4f53\u5de5\u5382\u4e4b\u95f4\u4e00\u4e00\u5bf9\u5e94\u3002 1.3.3 \u5b9e\u73b0 \u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u5bf9\u4e0a\u4f8b\u8fdb\u884c\u6539\u8fdb\uff0c\u7c7b\u56fe\u5982\u4e0b\uff1a \u6d41\u7a0b\uff1a \u4ee3\u7801\u5982\u4e0b\uff1a \u62bd\u8c61\u5de5\u5382\uff1a public interface CoffeeFactory { Coffee createCoffee(); } \u5177\u4f53\u5de5\u5382\uff1a public class LatteCoffeeFactory implements CoffeeFactory { public Coffee createCoffee() { return new LatteCoffee(); } } public class AmericanCoffeeFactory implements CoffeeFactory { public Coffee createCoffee() { return new AmericanCoffee(); } } \u5496\u5561\u5e97\u7c7b\uff1a public class CoffeeStore { private CoffeeFactory factory; public CoffeeStore(CoffeeFactory factory) { this.factory = factory; } public Coffee orderCoffee(String type) { Coffee coffee = factory.createCoffee(); coffee.addMilk(); coffee.addsugar(); return coffee; } } \u4ece\u4ee5\u4e0a\u7684\u7f16\u5199\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u5230\uff0c\u8981\u589e\u52a0\u4ea7\u54c1\u7c7b\u65f6\u4e5f\u8981\u76f8\u5e94\u5730\u589e\u52a0\u5de5\u5382\u7c7b\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\u4e86\uff0c\u8fd9\u6837\u5c31\u89e3\u51b3\u4e86\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u7f3a\u70b9\u3002 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u662f\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u8fdb\u4e00\u6b65\u62bd\u8c61\u3002\u7531\u4e8e\u4f7f\u7528\u4e86\u591a\u6001\u6027\uff0c\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u4fdd\u6301\u4e86\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u4f18\u70b9\uff0c\u800c\u4e14\u514b\u670d\u4e86\u5b83\u7684\u7f3a\u70b9\u3002 1.3.4 \u4f18\u7f3a\u70b9 \u4f18\u70b9\uff1a \u7528\u6237\u53ea\u9700\u8981\u77e5\u9053\u5177\u4f53\u5de5\u5382\u7684\u540d\u79f0\u5c31\u53ef\u5f97\u5230\u6240\u8981\u7684\u4ea7\u54c1\uff0c\u65e0\u987b\u77e5\u9053\u4ea7\u54c1\u7684\u5177\u4f53\u521b\u5efa\u8fc7\u7a0b\uff1b \u5728\u7cfb\u7edf\u589e\u52a0\u65b0\u7684\u4ea7\u54c1\u65f6\u53ea\u9700\u8981\u6dfb\u52a0\u5177\u4f53\u4ea7\u54c1\u7c7b\u548c\u5bf9\u5e94\u7684\u5177\u4f53\u5de5\u5382\u7c7b\uff0c\u65e0\u987b\u5bf9\u539f\u5de5\u5382\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\uff0c\u6ee1\u8db3\u5f00\u95ed\u539f\u5219\uff1b \u7f3a\u70b9\uff1a \u6bcf\u589e\u52a0\u4e00\u4e2a\u4ea7\u54c1\u5c31\u8981\u589e\u52a0\u4e00\u4e2a\u5177\u4f53\u4ea7\u54c1\u7c7b\u548c\u4e00\u4e2a\u5bf9\u5e94\u7684\u5177\u4f53\u5de5\u5382\u7c7b\uff0c\u8fd9\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\u3002 1.4 \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f \u524d\u9762\u4ecb\u7ecd\u7684\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u4e2d\u8003\u8651\u7684\u662f\u4e00\u7c7b\u4ea7\u54c1\u7684\u751f\u4ea7\uff0c\u5982\u755c\u7267\u573a\u53ea\u517b\u52a8\u7269\u3001\u7535\u89c6\u673a\u5382\u53ea\u751f\u4ea7\u7535\u89c6\u673a\u3001\u4f20\u667a\u64ad\u5ba2\u53ea\u57f9\u517b\u8ba1\u7b97\u673a\u8f6f\u4ef6\u4e13\u4e1a\u7684\u5b66\u751f\u7b49\u3002 \u8fd9\u4e9b\u5de5\u5382\u53ea\u751f\u4ea7\u540c\u79cd\u7c7b\u4ea7\u54c1\uff0c\u540c\u79cd\u7c7b\u4ea7\u54c1\u79f0\u4e3a\u540c\u7b49\u7ea7\u4ea7\u54c1\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u53ea\u8003\u8651\u751f\u4ea7\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\uff0c\u4f46\u662f\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\u8bb8\u591a\u5de5\u5382\u662f\u7efc\u5408\u578b\u7684\u5de5\u5382\uff0c\u80fd\u751f\u4ea7\u591a\u7b49\u7ea7\uff08\u79cd\u7c7b\uff09 \u7684\u4ea7\u54c1\uff0c\u5982\u7535\u5668\u5382\u65e2\u751f\u4ea7\u7535\u89c6\u673a\u53c8\u751f\u4ea7\u6d17\u8863\u673a\u6216\u7a7a\u8c03\uff0c\u5927\u5b66\u65e2\u6709\u8f6f\u4ef6\u4e13\u4e1a\u53c8\u6709\u751f\u7269\u4e13\u4e1a\u7b49\u3002 \u672c\u8282\u8981\u4ecb\u7ecd\u7684\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5c06\u8003\u8651\u591a\u7b49\u7ea7\u4ea7\u54c1\u7684\u751f\u4ea7\uff0c\u5c06\u540c\u4e00\u4e2a\u5177\u4f53\u5de5\u5382\u6240\u751f\u4ea7\u7684\u4f4d\u4e8e\u4e0d\u540c\u7b49\u7ea7\u7684\u4e00\u7ec4\u4ea7\u54c1\u79f0\u4e3a\u4e00\u4e2a\u4ea7\u54c1\u65cf\uff0c\u4e0b\u56fe\u6240\u793a \u4ea7\u54c1\u65cf\uff1a\u4e00\u4e2a\u54c1\u724c\u4e0b\u9762\u7684\u6240\u6709\u4ea7\u54c1\uff1b\u4f8b\u5982\u534e\u4e3a\u4e0b\u9762\u7684\u7535\u8111\u3001\u624b\u673a\u79f0\u4e3a\u534e\u4e3a\u7684\u4ea7\u54c1\u65cf\uff1b \u4ea7\u54c1\u7b49\u7ea7\uff1a\u591a\u4e2a\u54c1\u724c\u4e0b\u9762\u7684\u540c\u79cd\u4ea7\u54c1\uff1b\u4f8b\u5982\u534e\u4e3a\u548c\u5c0f\u7c73\u90fd\u6709\u624b\u673a\u7535\u8111\u4e3a\u4e00\u4e2a\u4ea7\u54c1\u7b49\u7ea7\uff1b 1.4.1 \u6982\u5ff5 \u662f\u4e00\u79cd\u4e3a\u8bbf\u95ee\u7c7b\u63d0\u4f9b\u4e00\u4e2a\u521b\u5efa\u4e00\u7ec4\u76f8\u5173\u6216\u76f8\u4e92\u4f9d\u8d56\u5bf9\u8c61\u7684\u63a5\u53e3\uff0c\u4e14\u8bbf\u95ee\u7c7b\u65e0\u987b\u6307\u5b9a\u6240\u8981\u4ea7\u54c1\u7684\u5177\u4f53\u7c7b\u5c31\u80fd\u5f97\u5230\u540c\u65cf\u7684\u4e0d\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\u7684\u6a21\u5f0f\u7ed3\u6784\u3002 \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u662f\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u7684\u5347\u7ea7\u7248\u672c\uff0c\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u53ea\u751f\u4ea7\u4e00\u4e2a\u7b49\u7ea7\u7684\u4ea7\u54c1\uff0c\u800c\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u53ef\u751f\u4ea7\u591a\u4e2a\u7b49\u7ea7\u7684\u4ea7\u54c1\u3002 \u4e00\u4e2a\u8d85\u7ea7\u5de5\u5382\u521b\u5efa\u5176\u4ed6\u5de5\u5382\u3002\u8be5\u8d85\u7ea7\u5de5\u5382\u53c8\u79f0\u4e3a\u5176\u4ed6\u5de5\u5382\u7684\u5de5\u5382 1.4.2 \u7ed3\u6784 \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\u5982\u4e0b\uff1a \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09\uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u63a5\u53e3\uff0c\u5b83\u5305\u542b\u591a\u4e2a\u521b\u5efa\u4ea7\u54c1\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u4e0d\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\u3002 \u5177\u4f53\u5de5\u5382\uff08Concrete Factory\uff09\uff1a\u4e3b\u8981\u662f\u5b9e\u73b0\u62bd\u8c61\u5de5\u5382\u4e2d\u7684\u591a\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u5b8c\u6210\u5177\u4f53\u4ea7\u54c1\u7684\u521b\u5efa\u3002 \u62bd\u8c61\u4ea7\u54c1\uff08Product\uff09\uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\uff0c\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u6709\u591a\u4e2a\u62bd\u8c61\u4ea7\u54c1\u3002 \u5177\u4f53\u4ea7\u54c1\uff08ConcreteProduct\uff09\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u4ea7\u54c1\u89d2\u8272\u6240\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u7531\u5177\u4f53\u5de5\u5382\u6765\u521b\u5efa\uff0c\u5b83 \u540c\u5177\u4f53\u5de5\u5382\u4e4b\u95f4\u662f\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\u3002 1.4.3 \u5b9e\u73b0 \u73b0\u5496\u5561\u5e97\u4e1a\u52a1\u53d1\u751f\u6539\u53d8\uff0c\u4e0d\u4ec5\u8981\u751f\u4ea7 \u5496\u5561 \u8fd8\u8981\u751f\u4ea7 \u751c\u70b9 \u540c\u4e00\u4e2a\u4ea7\u54c1\u7b49\u7ea7\uff08\u4ea7\u54c1\u5206\u7c7b\uff09 \u5496\u5561\uff1a\u62ff\u94c1\u5496\u5561\u3001\u7f8e\u5f0f\u5496\u5561 \u751c\u70b9\uff1a\u63d0\u62c9\u7c73\u82cf\u3001\u62b9\u8336\u6155\u65af \u540c\u4e00\u4e2a\u98ce\u5473\uff0c\u5c31\u662f\u540c\u4e00\u4e2a\u4ea7\u54c1\u65cf\uff08\u76f8\u5f53\u4e8e\u540c\u4e00\u4e2a\u54c1\u724c\uff09 \u7f8e\u5f0f\u98ce\u5473\uff1a\u7f8e\u5f0f\u5496\u5561\u3001\u62b9\u8336\u6155\u65af \u610f\u5927\u5229\u98ce\u5473\uff1a\u62ff\u94c1\u5496\u5561\u3001\u63d0\u62c9\u7c73\u82cf \u8981\u662f\u6309\u7167\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\uff0c\u9700\u8981\u5b9a\u4e49\u63d0\u62c9\u7c73\u82cf\u7c7b\u3001\u62b9\u8336\u6155\u65af\u7c7b\u3001\u63d0\u62c9\u7c73\u82cf\u5de5\u5382\u3001\u62b9\u8336\u6155\u65af\u5de5\u5382\u3001\u751c\u70b9\u5de5\u5382\u7c7b\uff0c\u5f88\u5bb9\u6613\u53d1\u751f\u7c7b\u7206\u70b8\u60c5\u51b5\u3002 \u6240\u4ee5\u8fd9\u4e2a\u6848\u4f8b\u53ef\u4ee5\u4f7f\u7528\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5b9e\u73b0\u3002\u7c7b\u56fe\u5982\u4e0b\uff1a \u5b9e\u73b0\u5173\u7cfb\u4f7f\u7528\u5e26\u7a7a\u5fc3\u4e09\u89d2\u7bad\u5934\u7684\u865a\u7ebf\u6765\u8868\u793a \u6574\u4f53\u8c03\u7528\u601d\u8def\uff1a 1.4.4 \u4f18\u7f3a\u70b9 \u4f18\u70b9\uff1a \u5f53\u4e00\u4e2a\u4ea7\u54c1\u65cf\u4e2d\u7684\u591a\u4e2a\u5bf9\u8c61\u88ab\u8bbe\u8ba1\u6210\u4e00\u8d77\u5de5\u4f5c\u65f6\uff0c\u5b83\u80fd\u4fdd\u8bc1\u5ba2\u6237\u7aef\u59cb\u7ec8\u53ea\u4f7f\u7528\u540c\u4e00\u4e2a\u4ea7\u54c1\u65cf\u4e2d\u7684\u5bf9\u8c61\u3002 \u7f3a\u70b9\uff1a \u5f53\u4ea7\u54c1\u65cf\u4e2d\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u4ea7\u54c1\u65f6\uff0c\u6240\u6709\u7684\u5de5\u5382\u7c7b\u90fd\u9700\u8981\u8fdb\u884c\u4fee\u6539\u3002 1.4.5 \u4f7f\u7528\u573a\u666f \u5f53\u9700\u8981\u521b\u5efa\u7684\u5bf9\u8c61\u662f\u4e00\u7cfb\u5217\u76f8\u4e92\u5173\u8054\u6216\u76f8\u4e92\u4f9d\u8d56\u7684\u4ea7\u54c1\u65cf\u65f6\uff0c\u5982\u7535\u5668\u5de5\u5382\u4e2d\u7684\u7535\u89c6\u673a\u3001\u6d17\u8863\u673a\u3001\u7a7a\u8c03\u7b49\u3002 \u7cfb\u7edf\u4e2d\u6709\u591a\u4e2a\u4ea7\u54c1\u65cf\uff0c\u4f46\u6bcf\u6b21\u53ea\u4f7f\u7528\u5176\u4e2d\u7684\u67d0\u4e00\u65cf\u4ea7\u54c1\u3002\u5982\u6709\u4eba\u53ea\u559c\u6b22\u7a7f\u67d0\u4e00\u4e2a\u54c1\u724c\u7684\u8863\u670d\u548c\u978b\u3002 \u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4ea7\u54c1\u7684\u7c7b\u5e93\uff0c\u4e14\u6240\u6709\u4ea7\u54c1\u7684\u63a5\u53e3\u76f8\u540c\uff0c\u5ba2\u6237\u7aef\u4e0d\u4f9d\u8d56\u4ea7\u54c1\u5b9e\u4f8b\u7684\u521b\u5efa\u7ec6\u8282\u548c\u5185\u90e8\u7ed3\u6784\u3002 \u5982\uff1a\u8f93\u5165\u6cd5\u6362\u76ae\u80a4\uff0c\u4e00\u6574\u5957\u4e00\u8d77\u6362\u3002\u751f\u6210\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u7a0b\u5e8f\u3002 2 \u7b56\u7565\u6a21\u5f0f 2.1 \u6982\u8ff0 \u5148\u770b\u4e0b\u9762\u7684\u56fe\u7247\uff0c\u6211\u4eec\u53bb\u65c5\u6e38\u9009\u62e9\u51fa\u884c\u6a21\u5f0f\u6709\u5f88\u591a\u79cd\uff0c\u53ef\u4ee5\u9a91\u81ea\u884c\u8f66\u3001\u53ef\u4ee5\u5750\u6c7d\u8f66\u3001\u53ef\u4ee5\u5750\u706b\u8f66\u3001\u53ef\u4ee5\u5750\u98de\u673a\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u7a0b\u5e8f\u733f\uff0c\u5f00\u53d1\u9700\u8981\u9009\u62e9\u4e00\u6b3e\u5f00\u53d1\u5de5\u5177\uff0c\u5f53\u7136\u53ef\u4ee5\u8fdb\u884c\u4ee3\u7801\u5f00\u53d1\u7684\u5de5\u5177\u6709\u5f88\u591a\uff0c\u53ef\u4ee5\u9009\u62e9Idea\u8fdb\u884c\u5f00\u53d1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528eclipse\u8fdb\u884c\u5f00\u53d1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u4e00\u4e9b\u5f00\u53d1\u5de5\u5177\u3002 \u5b9a\u4e49\uff1a \u200b \u8be5\u6a21\u5f0f\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7b97\u6cd5\uff0c\u5e76\u5c06\u6bcf\u4e2a\u7b97\u6cd5\u5c01\u88c5\u8d77\u6765\uff0c\u4f7f\u5b83\u4eec\u53ef\u4ee5\u76f8\u4e92\u66ff\u6362\uff0c\u4e14\u7b97\u6cd5\u7684\u53d8\u5316\u4e0d\u4f1a\u5f71\u54cd\u4f7f\u7528\u7b97\u6cd5\u7684\u5ba2\u6237\u3002\u7b56\u7565\u6a21\u5f0f\u5c5e\u4e8e\u5bf9\u8c61\u884c\u4e3a\u6a21\u5f0f\uff0c\u5b83\u901a\u8fc7\u5bf9\u7b97\u6cd5\u8fdb\u884c\u5c01\u88c5\uff0c\u628a\u4f7f\u7528\u7b97\u6cd5\u7684\u8d23\u4efb\u548c\u7b97\u6cd5\u7684\u5b9e\u73b0\u5206\u5272\u5f00\u6765\uff0c\u5e76\u59d4\u6d3e\u7ed9\u4e0d\u540c\u7684\u5bf9\u8c61\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u8fdb\u884c\u7ba1\u7406\u3002 2.2 \u7ed3\u6784 \u7b56\u7565\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\u5982\u4e0b\uff1a \u62bd\u8c61\u7b56\u7565\uff08Strategy\uff09\u7c7b\uff1a\u8fd9\u662f\u4e00\u4e2a\u62bd\u8c61\u89d2\u8272\uff0c\u901a\u5e38\u7531\u4e00\u4e2a\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\u5b9e\u73b0\u3002\u6b64\u89d2\u8272\u7ed9\u51fa\u6240\u6709\u7684\u5177\u4f53\u7b56\u7565\u7c7b\u6240\u9700\u7684\u63a5\u53e3\u3002 \u5177\u4f53\u7b56\u7565\uff08Concrete Strategy\uff09\u7c7b\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u7b56\u7565\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u63d0\u4f9b\u5177\u4f53\u7684\u7b97\u6cd5\u5b9e\u73b0\u6216\u884c\u4e3a\u3002 \u73af\u5883\uff08Context\uff09\u7c7b\uff1a\u6301\u6709\u4e00\u4e2a\u7b56\u7565\u7c7b\u7684\u5f15\u7528\uff0c\u6700\u7ec8\u7ed9\u5ba2\u6237\u7aef\u8c03\u7528\u3002 2.3 \u6848\u4f8b\u5b9e\u73b0 \u3010\u4f8b\u3011\u4fc3\u9500\u6d3b\u52a8 \u4e00\u5bb6\u767e\u8d27\u516c\u53f8\u5728\u5b9a\u5e74\u5ea6\u7684\u4fc3\u9500\u6d3b\u52a8\u3002\u9488\u5bf9\u4e0d\u540c\u7684\u8282\u65e5\uff08\u6625\u8282\u3001\u4e2d\u79cb\u8282\u3001\u5723\u8bde\u8282\uff09\u63a8\u51fa\u4e0d\u540c\u7684\u4fc3\u9500\u6d3b\u52a8\uff0c\u7531\u4fc3\u9500\u5458\u5c06\u4fc3\u9500\u6d3b\u52a8\u5c55\u793a\u7ed9\u5ba2\u6237\u3002\u7c7b\u56fe\u5982\u4e0b\uff1a \u805a\u5408\u5173\u7cfb\u53ef\u4ee5\u7528\u5e26\u7a7a\u5fc3\u83f1\u5f62\u7684\u5b9e\u7ebf\u6765\u8868\u793a \u4ee3\u7801\u5982\u4e0b\uff1a \u5b9a\u4e49\u767e\u8d27\u516c\u53f8\u6240\u6709\u4fc3\u9500\u6d3b\u52a8\u7684\u5171\u540c\u63a5\u53e3 public interface Strategy { void show(); } \u5b9a\u4e49\u5177\u4f53\u7b56\u7565\u89d2\u8272\uff08Concrete Strategy\uff09\uff1a\u6bcf\u4e2a\u8282\u65e5\u5177\u4f53\u7684\u4fc3\u9500\u6d3b\u52a8 //\u4e3a\u6625\u8282\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8A public class StrategyA implements Strategy { public void show() { System.out.println(\"\u4e70\u4e00\u9001\u4e00\"); } } //\u4e3a\u4e2d\u79cb\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8B public class StrategyB implements Strategy { public void show() { System.out.println(\"\u6ee1200\u5143\u51cf50\u5143\"); } } //\u4e3a\u5723\u8bde\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8C public class StrategyC implements Strategy { public void show() { System.out.println(\"\u6ee11000\u5143\u52a0\u4e00\u5143\u6362\u8d2d\u4efb\u610f200\u5143\u4ee5\u4e0b\u5546\u54c1\"); } } \u5b9a\u4e49\u73af\u5883\u89d2\u8272\uff08Context\uff09\uff1a\u7528\u4e8e\u8fde\u63a5\u4e0a\u4e0b\u6587\uff0c\u5373\u628a\u4fc3\u9500\u6d3b\u52a8\u63a8\u9500\u7ed9\u5ba2\u6237\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7406\u89e3\u4e3a\u9500\u552e\u5458 public class SalesMan { //\u6301\u6709\u62bd\u8c61\u7b56\u7565\u89d2\u8272\u7684\u5f15\u7528 private Strategy strategy; public SalesMan(Strategy strategy) { this.strategy = strategy; } //\u5411\u5ba2\u6237\u5c55\u793a\u4fc3\u9500\u6d3b\u52a8 public void salesManShow(){ strategy.show(); } } 2.4 \u7efc\u5408\u6848\u4f8b 2.4.1 \u6982\u8ff0 \u4e0b\u56fe\u662fgitee\u7684\u767b\u5f55\u7684\u5165\u53e3\uff0c\u5176\u4e2d\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8fdb\u884c\u767b\u5f55 \u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u767b\u5f55 \u5fae\u4fe1\u767b\u5f55 QQ\u767b\u5f55 .... 2.4.2 \u76ee\u524d\u5df2\u5b9e\u73b0\u7684\u4ee3\u7801 (1)\u767b\u5f55\u63a5\u53e3 \u8bf4\u660e \u8bf7\u6c42\u65b9\u5f0f POST \u8def\u5f84 /api/user/login \u53c2\u6570 LoginReq \u8fd4\u56de\u503c LoginResp \u8bf7\u6c42\u53c2\u6570\uff1aLoginReq @Data public class LoginReq { private String name; private String password; private String phone; private String validateCode;//\u624b\u673a\u9a8c\u8bc1\u7801 private String wxCode;//\u7528\u4e8e\u5fae\u4fe1\u767b\u5f55 /** * account : \u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55 * sms : \u624b\u673a\u9a8c\u8bc1\u7801\u767b\u5f55 * we_chat : \u5fae\u4fe1\u767b\u5f55 */ private String type; } \u54cd\u5e94\u53c2\u6570\uff1aLoginResp @Data public class LoginResp{ private Integer userId; private String userName; private String roleCode; private String token; //jwt\u4ee4\u724c private boolean success; } \u63a7\u5236\u5c42LoginController @RestController @RequestMapping(\"/api/user\") public class LoginController { @Autowired private UserService userService; @PostMapping(\"/login\") public LoginResp login(@RequestBody LoginReq loginReq){ return userService.login(loginReq); } } \u4e1a\u52a1\u5c42UserService @Service public class UserService { public LoginResp login(LoginReq loginReq){ if(loginReq.getType().equals(\"account\")){ System.out.println(\"\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\"); //\u6267\u884c\u7528\u6237\u5bc6\u7801\u767b\u5f55\u903b\u8f91 return new LoginResp(); }else if(loginReq.getType().equals(\"sms\")){ System.out.println(\"\u624b\u673a\u53f7\u9a8c\u8bc1\u7801\u767b\u5f55\"); //\u6267\u884c\u624b\u673a\u53f7\u9a8c\u8bc1\u7801\u767b\u5f55\u903b\u8f91 return new LoginResp(); }else if (loginReq.getType().equals(\"we_chat\")){ System.out.println(\"\u5fae\u4fe1\u767b\u5f55\"); //\u6267\u884c\u7528\u6237\u5fae\u4fe1\u767b\u5f55\u903b\u8f91 return new LoginResp(); } LoginResp loginResp = new LoginResp(); loginResp.setSuccess(false); System.out.println(\"\u767b\u5f55\u5931\u8d25\"); return loginResp; } } \u6ce8\u610f\uff1a\u6211\u4eec\u91cd\u70b9\u8bb2\u7684\u662f\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5e76\u4e0d\u662f\u767b\u5f55\u7684\u903b\u8f91\uff0c\u6240\u4ee5\u4ee5\u4e0a\u4ee3\u7801\u5e76\u6ca1\u6709\u771f\u6b63\u7684\u5b9e\u73b0\u767b\u5f55\u529f\u80fd (2)\u95ee\u9898\u5206\u6790 \u4e1a\u52a1\u5c42\u4ee3\u7801\u5927\u91cf\u4f7f\u7528\u5230\u4e86if...else\uff0c\u5728\u540e\u671f\u9605\u8bfb\u4ee3\u7801\u7684\u65f6\u5019\u4f1a\u975e\u5e38\u4e0d\u53cb\u597d\uff0c\u5927\u91cf\u4f7f\u7528if...else\u6027\u80fd\u4e5f\u4e0d\u9ad8 \u5982\u679c\u4e1a\u52a1\u53d1\u751f\u53d8\u66f4\uff0c\u6bd4\u5982\u73b0\u5728\u65b0\u589e\u4e86QQ\u767b\u5f55\u65b9\u5f0f\uff0c\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\uff0c\u8fdd\u53cd\u4e86\u5f00\u95ed\u539f\u5219 \u89e3\u51b3\uff1a \u4f7f\u7528 \u5de5\u5382\u65b9\u6cd5\u8bbe\u8ba1\u6a21\u5f0f+\u7b56\u7565\u6a21\u5f0f \u89e3\u51b3 2.4.3 \u4ee3\u7801\u6539\u9020\uff08\u5de5\u5382+\u7b56\u7565\uff09 \uff081\uff09\u6574\u4f53\u601d\u8def \u6539\u9020\u4e4b\u540e\uff0c\u4e0d\u5728service\u4e2d\u5199\u4e1a\u52a1\u903b\u8f91\uff0c\u8ba9service\u8c03\u7528\u5de5\u5382\uff0c\u7136\u540e\u901a\u8fc7service\u4f20\u9012\u4e0d\u540c\u7684\u53c2\u6570\u6765\u83b7\u53d6\u4e0d\u540c\u7684\u767b\u5f55\u7b56\u7565\uff08\u767b\u5f55\u65b9\u5f0f\uff09 \uff082\uff09\u5177\u4f53\u5b9e\u73b0 \u62bd\u8c61\u7b56\u7565\u7c7b\uff1aUserGranter /** * \u62bd\u8c61\u7b56\u7565\u7c7b */ public interface UserGranter{ /** * \u83b7\u53d6\u6570\u636e * @param loginReq \u4f20\u5165\u7684\u53c2\u6570 * @return map\u503c */ LoginResp login(LoginReq loginReq); } \u5177\u4f53\u7684\u7b56\u7565\uff1aAccountGranter\u3001SmsGranter\u3001WeChatGranter /** * \u7b56\u7565\uff1a\u8d26\u53f7\u767b\u5f55 **/ @Component public class AccountGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u8d26\u53f7\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } /** * \u7b56\u7565:\u77ed\u4fe1\u767b\u5f55 */ @Component public class SmsGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u77ed\u4fe1\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } /** * \u7b56\u7565:\u5fae\u4fe1\u767b\u5f55 */ @Component public class WeChatGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u5fae\u4fe1\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } \u5de5\u7a0b\u7c7b\uff1aUserLoginFactory /** * \u64cd\u4f5c\u7b56\u7565\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u7c7b \u5de5\u5177\u7c7b * \u5c06\u7b56\u7565\u6574\u5408\u8d77\u6765 \u65b9\u4fbf\u7ba1\u7406 */ @Component public class UserLoginFactory implements ApplicationContextAware { private static Map<String, UserGranter> granterPool = new ConcurrentHashMap<>(); @Autowired private LoginTypeConfig loginTypeConfig; /** * \u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b56\u7565\u4fe1\u606f\u5b58\u50a8\u5230map\u4e2d * { * account:accountGranter, * sms:smsGranter, * we_chat:weChatGranter * } * * @param applicationContext * @throws BeansException */ @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException { loginTypeConfig.getTypes().forEach((k, y) -> { granterPool.put(k, (UserGranter) applicationContext.getBean(y)); }); } /** * \u5bf9\u5916\u63d0\u4f9b\u83b7\u53d6\u5177\u4f53\u7b56\u7565 * * @param grantType \u7528\u6237\u7684\u767b\u5f55\u65b9\u5f0f\uff0c\u9700\u8981\u8ddf\u914d\u7f6e\u6587\u4ef6\u4e2d\u5339\u914d * @return \u5177\u4f53\u7b56\u7565 */ public UserGranter getGranter(String grantType) { UserGranter tokenGranter = granterPool.get(grantType); return tokenGranter; } } \u5728application.yml\u6587\u4ef6\u4e2d\u65b0\u589e\u81ea\u5b9a\u4e49\u914d\u7f6e login: types: account: accountGranter sms: smsGranter we_chat: weChatGranter \u65b0\u589e\u8bfb\u53d6\u6570\u636e\u914d\u7f6e\u7c7b Getter @Setter @Configuration @ConfigurationProperties(prefix = \"login\") public class LoginTypeConfig { private Map<String,String> types; } \u6539\u9020service\u4ee3\u7801 @Service public class UserService { @Autowired private UserLoginFactory factory; public LoginResp login(LoginReq loginReq){ UserGranter granter = factory.getGranter(loginReq.getType()); if(granter == null){ LoginResp loginResp = new LoginResp(); loginResp.setSuccess(false); return loginResp; } LoginResp loginResp = granter.login(loginReq); return loginResp; } } \u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u4f7f\u7528\u4e86\u8bbe\u8ba1\u6a21\u5f0f\u4e4b\u540e\uff0c\u4e1a\u52a1\u5c42\u7684\u4ee3\u7801\u5c31\u6e05\u723d\u591a\u4e86\uff0c\u5982\u679c\u540e\u671f\u6709\u65b0\u7684\u9700\u6c42\u6539\u52a8\uff0c\u6bd4\u5982\u52a0\u5165\u4e86QQ\u767b\u5f55\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\u5bf9\u5e94\u7684\u7b56\u7565\u5c31\u53ef\u4ee5\uff0c\u65e0\u9700\u518d\u6539\u52a8\u4e1a\u52a1\u5c42\u4ee3\u7801\u3002 2.4.4 \u4e3e\u4e00\u53cd\u4e09 \u5176\u5b9e\u50cf\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u5728\u65e5\u5e38\u5f00\u53d1\u4e2d\u975e\u5e38\u5e38\u89c1\uff0c\u573a\u666f\u6709\u5f88\u591a\uff0c\u4ee5\u4e0b\u7684\u60c5\u666f\u90fd\u53ef\u4ee5\u4f7f\u7528\u5de5\u5382\u6a21\u5f0f+\u7b56\u7565\u6a21\u5f0f\u89e3\u51b3\u6bd4\u5982\uff1a \u8ba2\u5355\u7684\u652f\u4ed8\u7b56\u7565 \u652f\u4ed8\u5b9d\u652f\u4ed8 \u5fae\u4fe1\u652f\u4ed8 \u94f6\u884c\u5361\u652f\u4ed8 \u73b0\u91d1\u652f\u4ed8 \u89e3\u6790\u4e0d\u540c\u7c7b\u578bexcel xls\u683c\u5f0f xlsx\u683c\u5f0f \u6253\u6298\u4fc3\u9500 \u6ee1300\u51439\u6298 \u6ee1500\u51438\u6298 \u6ee11000\u51437\u6298 \u7269\u6d41\u8fd0\u8d39\u9636\u68af\u8ba1\u7b97 5kg\u4ee5\u4e0b 5kg-10kg 10kg-20kg 20kg\u4ee5\u4e0a \u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a \u53ea\u8981\u4ee3\u7801\u4e2d\u6709\u5197\u957f\u7684 if-else \u6216 switch \u5206\u652f\u5224\u65ad\u90fd\u53ef\u4ee5\u91c7\u7528\u7b56\u7565\u6a21\u5f0f\u4f18\u5316 3 \u8d23\u4efb\u94fe\u8bbe\u8ba1\u6a21\u5f0f 3.1 \u6982\u8ff0 \u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u5e38\u5e38\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u4e8b\u4f8b\uff1a\u4e00\u4e2a\u8bf7\u6c42\u6709\u591a\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u5904\u7406\uff0c\u4f46\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5904\u7406\u6761\u4ef6\u6216\u6743\u9650\u4e0d\u540c\u3002\u4f8b\u5982\uff0c\u516c\u53f8\u5458\u5de5\u8bf7\u5047\uff0c\u53ef\u6279\u5047\u7684\u9886\u5bfc\u6709\u90e8\u95e8\u8d1f\u8d23\u4eba\u3001\u526f\u603b\u7ecf\u7406\u3001\u603b\u7ecf\u7406\u7b49\uff0c\u4f46\u6bcf\u4e2a\u9886\u5bfc\u80fd\u6279\u51c6\u7684\u5929\u6570\u4e0d\u540c\uff0c\u5458\u5de5\u5fc5\u987b\u6839\u636e\u81ea\u5df1\u8981\u8bf7\u5047\u7684\u5929\u6570\u53bb\u627e\u4e0d\u540c\u7684\u9886\u5bfc\u7b7e\u540d\uff0c\u4e5f\u5c31\u662f\u8bf4\u5458\u5de5\u5fc5\u987b\u8bb0\u4f4f\u6bcf\u4e2a\u9886\u5bfc\u7684\u59d3\u540d\u3001\u7535\u8bdd\u548c\u5730\u5740\u7b49\u4fe1\u606f\uff0c\u8fd9\u589e\u52a0\u4e86\u96be\u5ea6\u3002\u8fd9\u6837\u7684\u4f8b\u5b50\u8fd8\u6709\u5f88\u591a\uff0c\u5982\u627e\u9886\u5bfc\u51fa\u5dee\u62a5\u9500\u3001\u751f\u6d3b\u4e2d\u7684\u201c\u51fb\u9f13\u4f20\u82b1\u201d\u6e38\u620f\u7b49\u3002 \u5b9a\u4e49\uff1a \u53c8\u540d\u804c\u8d23\u94fe\u6a21\u5f0f\uff0c\u4e3a\u4e86\u907f\u514d\u8bf7\u6c42\u53d1\u9001\u8005\u4e0e\u591a\u4e2a\u8bf7\u6c42\u5904\u7406\u8005\u8026\u5408\u5728\u4e00\u8d77\uff0c\u5c06\u6240\u6709\u8bf7\u6c42\u7684\u5904\u7406\u8005\u901a\u8fc7\u524d\u4e00\u5bf9\u8c61\u8bb0\u4f4f\u5176\u4e0b\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u800c\u8fde\u6210\u4e00\u6761\u94fe\uff1b\u5f53\u6709\u8bf7\u6c42\u53d1\u751f\u65f6\uff0c\u53ef\u5c06\u8bf7\u6c42\u6cbf\u7740\u8fd9\u6761\u94fe\u4f20\u9012\uff0c\u76f4\u5230\u6709\u5bf9\u8c61\u5904\u7406\u5b83\u4e3a\u6b62\u3002 \u6bd4\u8f83\u5e38\u89c1\u7684springmvc\u4e2d\u7684\u62e6\u622a\u5668\uff0cweb\u5f00\u53d1\u4e2d\u7684filter\u8fc7\u6ee4\u5668 3.2 \u7ed3\u6784 \u804c\u8d23\u94fe\u6a21\u5f0f\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u89d2\u8272: \u62bd\u8c61\u5904\u7406\u8005\uff08Handler\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u4e00\u4e2a\u5904\u7406\u8bf7\u6c42\u7684\u63a5\u53e3\uff0c\u5305\u542b\u62bd\u8c61\u5904\u7406\u65b9\u6cd5\u548c\u4e00\u4e2a\u540e\u7ee7\u8fde\u63a5\u3002 \u5177\u4f53\u5904\u7406\u8005\uff08Concrete Handler\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u5904\u7406\u8005\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u5224\u65ad\u80fd\u5426\u5904\u7406\u672c\u6b21\u8bf7\u6c42\uff0c\u5982\u679c\u53ef\u4ee5\u5904\u7406\u8bf7\u6c42\u5219\u5904\u7406\uff0c\u5426\u5219\u5c06\u8be5\u8bf7\u6c42\u8f6c\u7ed9\u5b83\u7684\u540e\u7ee7\u8005\u3002 \u5ba2\u6237\u7c7b\uff08Client\uff09\u89d2\u8272\uff1a\u521b\u5efa\u5904\u7406\u94fe\uff0c\u5e76\u5411\u94fe\u5934\u7684\u5177\u4f53\u5904\u7406\u8005\u5bf9\u8c61\u63d0\u4ea4\u8bf7\u6c42\uff0c\u5b83\u4e0d\u5173\u5fc3\u5904\u7406\u7ec6\u8282\u548c\u8bf7\u6c42\u7684\u4f20\u9012\u8fc7\u7a0b\u3002 3.2 \u6848\u4f8b\u5b9e\u73b0 \u5904\u7406\u8ba2\u5355\u7684\u64cd\u4f5c \u7c7b\u56fe\uff1a \u4ee3\u7801\uff1a \u62bd\u8c61\u5904\u7406\u8005 package com.itheima.designpattern.chain; /** * \u62bd\u8c61\u5904\u7406\u8005 */ public abstract class Handler { protected Handler handler; public void setNext(Handler handler) { this.handler = handler; } /** * \u5904\u7406\u8fc7\u7a0b * \u9700\u8981\u5b50\u7c7b\u8fdb\u884c\u5b9e\u73b0 */ public abstract void process(OrderInfo order); } \u8ba2\u5355\u4fe1\u606f\u7c7b\uff1a package com.itheima.designpattern.chain; import java.math.BigDecimal; public class OrderInfo { private String productId; private String userId; private BigDecimal amount; public String getProductId() { return productId; } public void setProductId(String productId) { this.productId = productId; } public String getUserId() { return userId; } public void setUserId(String userId) { this.userId = userId; } public BigDecimal getAmount() { return amount; } public void setAmount(BigDecimal amount) { this.amount = amount; } } \u5177\u4f53\u5904\u7406\u8005\uff1a /** * \u8ba2\u5355\u6821\u9a8c */ public class OrderValidition extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u6821\u9a8c\u8ba2\u5355\u57fa\u672c\u4fe1\u606f\"); //\u6821\u9a8c handler.process(order); } } /** * \u8865\u5145\u8ba2\u5355\u4fe1\u606f */ public class OrderFill extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8865\u5145\u8ba2\u5355\u4fe1\u606f\"); handler.process(order); } } /** * \u8ba1\u7b97\u91d1\u989d */ public class OrderAmountCalcuate extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8ba1\u7b97\u91d1\u989d-\u4f18\u60e0\u5238\u3001VIP\u3001\u6d3b\u52a8\u6253\u6298\"); handler.process(order); } } /** * \u8ba2\u5355\u5165\u5e93 */ public class OrderCreate extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8ba2\u5355\u5165\u5e93\"); } } \u5ba2\u6237\u7c7b\uff1a public class Application { public static void main(String[] args) { //\u68c0\u9a8c\u8ba2\u5355 Handler orderValidition = new OrderValidition(); //\u8865\u5145\u8ba2\u5355\u4fe1\u606f Handler orderFill = new OrderFill(); //\u8ba2\u5355\u7b97\u4ef7 Handler orderAmountCalcuate = new OrderAmountCalcuate(); //\u8ba2\u5355\u843d\u5e93 Handler orderCreate = new OrderCreate(); //\u8bbe\u7f6e\u8d23\u4efb\u94fe\u8def orderValidition.setNext(orderFill); orderFill.setNext(orderAmountCalcuate); orderAmountCalcuate.setNext(orderCreate); //\u5f00\u59cb\u6267\u884c orderValidition.process(new OrderInfo()); } } 3.3 \u4f18\u7f3a\u70b9 \u4f18\u70b9 \u964d\u4f4e\u4e86\u5bf9\u8c61\u4e4b\u95f4\u7684\u8026\u5408\u5ea6 \u8be5\u6a21\u5f0f\u964d\u4f4e\u4e86\u8bf7\u6c42\u53d1\u9001\u8005\u548c\u63a5\u6536\u8005\u7684\u8026\u5408\u5ea6\u3002 \u589e\u5f3a\u4e86\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027 \u53ef\u4ee5\u6839\u636e\u9700\u8981\u589e\u52a0\u65b0\u7684\u8bf7\u6c42\u5904\u7406\u7c7b\uff0c\u6ee1\u8db3\u5f00\u95ed\u539f\u5219\u3002 \u589e\u5f3a\u4e86\u7ed9\u5bf9\u8c61\u6307\u6d3e\u804c\u8d23\u7684\u7075\u6d3b\u6027 \u5f53\u5de5\u4f5c\u6d41\u7a0b\u53d1\u751f\u53d8\u5316\uff0c\u53ef\u4ee5\u52a8\u6001\u5730\u6539\u53d8\u94fe\u5185\u7684\u6210\u5458\u6216\u8005\u4fee\u6539\u5b83\u4eec\u7684\u6b21\u5e8f\uff0c\u4e5f\u53ef\u52a8\u6001\u5730\u65b0\u589e\u6216\u8005\u5220\u9664\u8d23\u4efb\u3002 \u8d23\u4efb\u94fe\u7b80\u5316\u4e86\u5bf9\u8c61\u4e4b\u95f4\u7684\u8fde\u63a5 \u4e00\u4e2a\u5bf9\u8c61\u53ea\u9700\u4fdd\u6301\u4e00\u4e2a\u6307\u5411\u5176\u540e\u7ee7\u8005\u7684\u5f15\u7528\uff0c\u4e0d\u9700\u4fdd\u6301\u5176\u4ed6\u6240\u6709\u5904\u7406\u8005\u7684\u5f15\u7528\uff0c\u8fd9\u907f\u514d\u4e86\u4f7f\u7528\u4f17\u591a\u7684 if \u6216\u8005 if\u00b7\u00b7\u00b7else \u8bed\u53e5\u3002 \u8d23\u4efb\u5206\u62c5 \u6bcf\u4e2a\u7c7b\u53ea\u9700\u8981\u5904\u7406\u81ea\u5df1\u8be5\u5904\u7406\u7684\u5de5\u4f5c\uff0c\u4e0d\u80fd\u5904\u7406\u7684\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u5bf9\u8c61\u5b8c\u6210\uff0c\u660e\u786e\u5404\u7c7b\u7684\u8d23\u4efb\u8303\u56f4\uff0c\u7b26\u5408\u7c7b\u7684\u5355\u4e00\u804c\u8d23\u539f\u5219\u3002 \u7f3a\u70b9\uff1a \u4e0d\u80fd\u4fdd\u8bc1\u6bcf\u4e2a\u8bf7\u6c42\u4e00\u5b9a\u88ab\u5904\u7406\u3002\u7531\u4e8e\u4e00\u4e2a\u8bf7\u6c42\u6ca1\u6709\u660e\u786e\u7684\u63a5\u6536\u8005\uff0c\u6240\u4ee5\u4e0d\u80fd\u4fdd\u8bc1\u5b83\u4e00\u5b9a\u4f1a\u88ab\u5904\u7406\uff0c\u8be5\u8bf7\u6c42\u53ef\u80fd\u4e00\u76f4\u4f20\u5230\u94fe\u7684\u672b\u7aef\u90fd\u5f97\u4e0d\u5230\u5904\u7406\u3002 \u5bf9\u6bd4\u8f83\u957f\u7684\u804c\u8d23\u94fe\uff0c\u8bf7\u6c42\u7684\u5904\u7406\u53ef\u80fd\u6d89\u53ca\u591a\u4e2a\u5904\u7406\u5bf9\u8c61\uff0c\u7cfb\u7edf\u6027\u80fd\u5c06\u53d7\u5230\u4e00\u5b9a\u5f71\u54cd\u3002 \u804c\u8d23\u94fe\u5efa\u7acb\u7684\u5408\u7406\u6027\u8981\u9760\u5ba2\u6237\u7aef\u6765\u4fdd\u8bc1\uff0c\u589e\u52a0\u4e86\u5ba2\u6237\u7aef\u7684\u590d\u6742\u6027\uff0c\u53ef\u80fd\u4f1a\u7531\u4e8e\u804c\u8d23\u94fe\u7684\u9519\u8bef\u8bbe\u7f6e\u800c\u5bfc\u81f4\u7cfb\u7edf\u51fa\u9519\uff0c\u5982\u53ef\u80fd\u4f1a\u9020\u6210\u5faa\u73af\u8c03\u7528\u3002 3.4 \u4e3e\u4e00\u53cd\u4e09 \u5185\u5bb9\u5ba1\u6838\uff08\u89c6\u9891\u3001\u6587\u7ae0\u3001\u8bfe\u7a0b\u2026.\uff09 \u8ba2\u5355\u521b\u5efa \u7b80\u6613\u6d41\u7a0b\u5ba1\u6279","title":"\u9762\u8bd5\u4e13\u9898-\u8bbe\u8ba1\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-","text":"","title":"\u9762\u8bd5\u4e13\u9898-\u8bbe\u8ba1\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#_1","text":"\u5728\u5e73\u65f6\u7684\u5f00\u53d1\u4e2d\uff0c\u6d89\u53ca\u5230\u8bbe\u8ba1\u6a21\u5f0f\u7684\u6709\u4e24\u5757\u5185\u5bb9\uff0c\u7b2c\u4e00\u4e2a\u662f\u6211\u4eec\u5e73\u65f6\u4f7f\u7528\u7684\u6846\u67b6\uff08\u6bd4\u5982spring\u3001mybatis\u7b49\uff09\uff0c\u7b2c\u4e8c\u4e2a\u662f\u6211\u4eec\u81ea\u5df1\u5f00\u53d1\u4e1a\u52a1\u4f7f\u7528\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002 \u9762\u8bd5\u5b98\u4e00\u822c\u6bd4\u8f83\u5173\u5fc3\u7684\u662f\u4f60\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6709\u6ca1\u6709\u4f7f\u7528\u8fc7\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6216\u8005\u4f60\u5728\u7b80\u5386\u4e0a\u5199\u4e86\u5173\u4e8e\u8bbe\u8ba1\u6a21\u5f0f\u7684\u63cf\u8ff0\uff0c\u90a3\u4e48\u8fd9\u6837\u6211\u4eec\u5c31\u9700\u8981\u91cd\u70b9\u5173\u5fc3\u81ea\u5df1\u5f00\u53d1\u4e2d\u7528\u8fc7\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002 \u5728\u5e73\u65f6\u7684\u4e1a\u52a1\u5f00\u53d1\u4e2d\uff0c\u5176\u5b9e\u771f\u6b63\u4f7f\u7528\u8bbe\u8ba1\u6a21\u5f0f\u7684\u573a\u666f\u5e76\u4e0d\u591a\uff0c\u867d\u7136\u8bbe\u8ba1\u53f7\u79f0\u670923\u79cd\u4e4b\u591a\uff08\u4e0d\u540c\u7684\u7eac\u5ea6\u53ef\u80fd\u4f1a\u66f4\u591a\uff09\uff0c\u4f46\u662f\u5728\u9879\u76ee\u6700\u5e38\u4f7f\u7528\u7684\u4e5f\u5c31\u51e0\u79cd\u800c\u5df2\uff0c\u5728\u9762\u8bd5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e00\u79cd\u6216\u4e24\u79cd\u5c31\u53ef\u4ee5\uff0c\u91cd\u70b9\u8981\u8bf4\u7684\u662f\uff1a\u5728\u4ec0\u4e48\u4e1a\u52a1\u573a\u666f\u4e0b\u4f7f\u7528\u4e86\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u4ec0\u4e48\u8bbe\u8ba1\u6a21\u5f0f\uff1f \u8fd9\u6b21\u9762\u8bd5\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e09\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff1a \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\uff08\u7b80\u5355\u5de5\u5382\u3001\u5de5\u5382\u65b9\u6cd5\u3001\u62bd\u8c61\u5de5\u5382\uff09 \u7b56\u7565\u6a21\u5f0f \u8d23\u4efb\u94fe\u6a21\u5f0f","title":"\u524d\u8a00"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#1","text":"","title":"1 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#11","text":"\u9700\u6c42\uff1a\u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u5e97\u70b9\u9910\u7cfb\u7edf\u3002 \u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u7c7b\uff08Coffee\uff09\uff0c\u5e76\u5b9a\u4e49\u5176\u4e24\u4e2a\u5b50\u7c7b\uff08\u7f8e\u5f0f\u5496\u5561\u3010AmericanCoffee\u3011\u548c\u62ff\u94c1\u5496\u5561\u3010LatteCoffee\u3011\uff09\uff1b\u518d\u8bbe\u8ba1\u4e00\u4e2a\u5496\u5561\u5e97\u7c7b\uff08CoffeeStore\uff09\uff0c\u5496\u5561\u5e97\u5177\u6709\u70b9\u5496\u5561\u7684\u529f\u80fd\u3002 \u5177\u4f53\u7c7b\u7684\u8bbe\u8ba1\u5982\u4e0b\uff1a 1.\u7c7b\u56fe\u4e2d\u7684\u7b26\u53f7 +\uff1a\u8868\u793apublic -\uff1a\u8868\u793aprivate","title":"1.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#protected","text":"2.\u6cdb\u5316\u5173\u7cfb(\u7ee7\u627f)\u7528\u5e26\u7a7a\u5fc3\u4e09\u89d2\u7bad\u5934\u7684\u5b9e\u7ebf\u6765\u8868\u793a 3.\u4f9d\u8d56\u5173\u7cfb\u4f7f\u7528\u5e26\u7bad\u5934\u7684\u865a\u7ebf\u6765\u8868\u793a package com.itheima.factory.simple; public class CoffeeStore { public static void main(String[] args) { Coffee coffee = orderCoffee(\"latte\"); System.out.println(coffee.getName()); } public static Coffee orderCoffee(String type){ Coffee coffee = null; if(\"american\".equals(type)){ coffee = new AmericanCoffee(); }else if (\"latte\".equals(type)){ coffee = new LatteCoffee(); } //\u6dfb\u52a0\u914d\u6599 coffee.addMilk(); coffee.addSuqar(); return coffee; } } \u5728java\u4e2d\uff0c\u4e07\u7269\u7686\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u90fd\u9700\u8981\u521b\u5efa\uff0c\u5982\u679c\u521b\u5efa\u7684\u65f6\u5019\u76f4\u63a5new\u8be5\u5bf9\u8c61\uff0c\u5c31\u4f1a\u5bf9\u8be5\u5bf9\u8c61\u8026\u5408\u4e25\u91cd\uff0c\u5047\u5982\u6211\u4eec\u8981\u66f4\u6362\u5bf9\u8c61\uff0c\u6240\u6709new\u5bf9\u8c61\u7684\u5730\u65b9\u90fd\u9700\u8981\u4fee\u6539\u4e00\u904d\uff0c\u8fd9\u663e\u7136\u8fdd\u80cc\u4e86\u8f6f\u4ef6\u8bbe\u8ba1\u7684 \u5f00\u95ed\u539f\u5219 \u3002\u5982\u679c\u6211\u4eec\u4f7f\u7528\u5de5\u5382\u6765\u751f\u4ea7\u5bf9\u8c61\uff0c\u6211\u4eec\u5c31\u53ea\u548c\u5de5\u5382\u6253\u4ea4\u9053\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f7b\u5e95\u548c\u5bf9\u8c61\u89e3\u8026\uff0c\u5982\u679c\u8981\u66f4\u6362\u5bf9\u8c61\uff0c\u76f4\u63a5\u5728\u5de5\u5382\u91cc\u66f4\u6362\u8be5\u5bf9\u8c61\u5373\u53ef\uff0c\u8fbe\u5230\u4e86\u4e0e\u5bf9\u8c61\u89e3\u8026\u7684\u76ee\u7684\uff1b\u6240\u4ee5\u8bf4\uff0c\u5de5\u5382\u6a21\u5f0f\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\uff1a \u89e3\u8026 \u3002 \u5f00\u95ed\u539f\u5219\uff1a \u5bf9\u6269\u5c55\u5f00\u653e\uff0c\u5bf9\u4fee\u6539\u5173\u95ed \u3002\u5728\u7a0b\u5e8f\u9700\u8981\u8fdb\u884c\u62d3\u5c55\u7684\u65f6\u5019\uff0c\u4e0d\u80fd\u53bb\u4fee\u6539\u539f\u6709\u7684\u4ee3\u7801\uff0c\u5b9e\u73b0\u4e00\u4e2a\u70ed\u63d2\u62d4\u7684\u6548\u679c\u3002\u7b80\u8a00\u4e4b\uff0c\u662f\u4e3a\u4e86\u4f7f\u7a0b\u5e8f\u7684\u6269\u5c55\u6027\u597d\uff0c\u6613\u4e8e\u7ef4\u62a4\u548c\u5347\u7ea7\u3002 \u4e09\u79cd\u5de5\u5382 \u7b80\u5355\u5de5\u5382\u6a21\u5f0f \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f","title":"\uff1a\u8868\u793aprotected"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#12","text":"\u7b80\u5355\u5de5\u5382\u4e0d\u662f\u4e00\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u53cd\u800c\u6bd4\u8f83\u50cf\u662f\u4e00\u79cd\u7f16\u7a0b\u4e60\u60ef\u3002","title":"1.2 \u7b80\u5355\u5de5\u5382\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#121","text":"\u7b80\u5355\u5de5\u5382\u5305\u542b\u5982\u4e0b\u89d2\u8272\uff1a \u62bd\u8c61\u4ea7\u54c1 \uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\u3002 \u5177\u4f53\u4ea7\u54c1 \uff1a\u5b9e\u73b0\u6216\u8005\u7ee7\u627f\u62bd\u8c61\u4ea7\u54c1\u7684\u5b50\u7c7b \u5177\u4f53\u5de5\u5382 \uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u65b9\u6cd5\uff0c\u8c03\u7528\u8005\u901a\u8fc7\u8be5\u65b9\u6cd5\u6765\u83b7\u53d6\u4ea7\u54c1\u3002","title":"1.2.1 \u7ed3\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#122","text":"\u73b0\u5728\u4f7f\u7528\u7b80\u5355\u5de5\u5382\u5bf9\u4e0a\u9762\u6848\u4f8b\u8fdb\u884c\u6539\u8fdb\uff0c\u7c7b\u56fe\u5982\u4e0b\uff1a \u5de5\u5382\u7c7b\u4ee3\u7801\u5982\u4e0b\uff1a public class SimpleCoffeeFactory { public Coffee createCoffee(String type) { Coffee coffee = null; if(\"americano\".equals(type)) { coffee = new AmericanoCoffee(); } else if(\"latte\".equals(type)) { coffee = new LatteCoffee(); } return coffee; } } \u5496\u5561\u5e97 package com.itheima.factory.simple; public class CoffeeStore { public Coffee orderCoffee(String type){ //\u901a\u8fc7\u5de5\u5382\u83b7\u5f97\u5bf9\u8c61\uff0c\u4e0d\u9700\u8981\u77e5\u9053\u5bf9\u8c61\u5b9e\u73b0\u7684\u7ec6\u8282 SimpleCoffeeFactory factory = new SimpleCoffeeFactory(); Coffee coffee = factory.createCoffee(type); //\u6dfb\u52a0\u914d\u6599 coffee.addMilk(); coffee.addSuqar(); return coffee; } } \u5de5\u5382\uff08factory\uff09\u5904\u7406\u521b\u5efa\u5bf9\u8c61\u7684\u7ec6\u8282\uff0c\u4e00\u65e6\u6709\u4e86SimpleCoffeeFactory\uff0cCoffeeStore\u7c7b\u4e2d\u7684orderCoffee()\u5c31\u53d8\u6210\u6b64\u5bf9\u8c61\u7684\u5ba2\u6237\uff0c\u540e\u671f\u5982\u679c\u9700\u8981Coffee\u5bf9\u8c61\u76f4\u63a5\u4ece\u5de5\u5382\u4e2d\u83b7\u53d6\u5373\u53ef\u3002\u8fd9\u6837\u4e5f\u5c31\u89e3\u9664\u4e86\u548cCoffee\u5b9e\u73b0\u7c7b\u7684\u8026\u5408\uff0c\u540c\u65f6\u53c8\u4ea7\u751f\u4e86\u65b0\u7684\u8026\u5408\uff0cCoffeeStore\u5bf9\u8c61\u548cSimpleCoffeeFactory\u5de5\u5382\u5bf9\u8c61\u7684\u8026\u5408\uff0c\u5de5\u5382\u5bf9\u8c61\u548c\u5546\u54c1\u5bf9\u8c61\u7684\u8026\u5408\u3002 \u540e\u671f\u5982\u679c\u518d\u52a0\u65b0\u54c1\u79cd\u7684\u5496\u5561\uff0c\u6211\u4eec\u52bf\u5fc5\u8981\u9700\u6c42\u4fee\u6539SimpleCoffeeFactory\u7684\u4ee3\u7801\uff0c\u8fdd\u53cd\u4e86\u5f00\u95ed\u539f\u5219\u3002\u5de5\u5382\u7c7b\u7684\u5ba2\u6237\u7aef\u53ef\u80fd\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u521b\u5efa\u7f8e\u56e2\u5916\u5356\u7b49\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\uff0c\u7701\u53bb\u5176\u4ed6\u7684\u4fee\u6539\u64cd\u4f5c\u3002","title":"1.2.2 \u5b9e\u73b0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#123","text":"\u4f18\u70b9\uff1a \u5c01\u88c5\u4e86\u521b\u5efa\u5bf9\u8c61\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u76f4\u63a5\u83b7\u53d6\u5bf9\u8c61\u3002\u628a\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u4e1a\u52a1\u903b\u8f91\u5c42\u5206\u5f00\uff0c\u8fd9\u6837\u4ee5\u540e\u5c31\u907f\u514d\u4e86\u4fee\u6539\u5ba2\u6237\u4ee3\u7801\uff0c\u5982\u679c\u8981\u5b9e\u73b0\u65b0\u4ea7\u54c1\u76f4\u63a5\u4fee\u6539\u5de5\u5382\u7c7b\uff0c\u800c\u4e0d\u9700\u8981\u5728\u539f\u4ee3\u7801\u4e2d\u4fee\u6539\uff0c\u8fd9\u6837\u5c31\u964d\u4f4e\u4e86\u5ba2\u6237\u4ee3\u7801\u4fee\u6539\u7684\u53ef\u80fd\u6027\uff0c\u66f4\u52a0\u5bb9\u6613\u6269\u5c55\u3002 \u7f3a\u70b9\uff1a \u589e\u52a0\u65b0\u4ea7\u54c1\u65f6\u8fd8\u662f\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\uff0c\u8fdd\u80cc\u4e86\u201c\u5f00\u95ed\u539f\u5219\u201d\u3002","title":"1.2.3 \u4f18\u7f3a\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#124","text":"\u9759\u6001\u5de5\u5382 \u5728\u5f00\u53d1\u4e2d\u4e5f\u6709\u4e00\u90e8\u5206\u4eba\u5c06\u5de5\u5382\u7c7b\u4e2d\u7684\u521b\u5efa\u5bf9\u8c61\u7684\u529f\u80fd\u5b9a\u4e49\u4e3a\u9759\u6001\u7684\uff0c\u8fd9\u4e2a\u5c31\u662f\u9759\u6001\u5de5\u5382\u6a21\u5f0f\uff0c\u5b83\u4e5f\u4e0d\u662f23\u79cd\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u7684\u3002\u4ee3\u7801\u5982\u4e0b\uff1a public class SimpleCoffeeFactory { public static Coffee createCoffee(String type) { Coffee coffee = null; if(\"americano\".equals(type)) { coffee = new AmericanoCoffee(); } else if(\"latte\".equals(type)) { coffee = new LatteCoffee(); } return coffe; } }","title":"1.2.4 \u6269\u5c55"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#13","text":"\u9488\u5bf9\u4e0a\u4f8b\u4e2d\u7684\u7f3a\u70b9\uff0c\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u5c31\u53ef\u4ee5\u5b8c\u7f8e\u7684\u89e3\u51b3\uff0c\u5b8c\u5168\u9075\u5faa\u5f00\u95ed\u539f\u5219\u3002","title":"1.3 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#131","text":"\u5b9a\u4e49\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5bf9\u8c61\u7684\u63a5\u53e3\uff0c\u8ba9\u5b50\u7c7b\u51b3\u5b9a\u5b9e\u4f8b\u5316\u54ea\u4e2a\u4ea7\u54c1\u7c7b\u5bf9\u8c61\u3002\u5de5\u5382\u65b9\u6cd5\u4f7f\u4e00\u4e2a\u4ea7\u54c1\u7c7b\u7684\u5b9e\u4f8b\u5316\u5ef6\u8fdf\u5230\u5176\u5de5\u5382\u7684\u5b50\u7c7b\u3002","title":"1.3.1 \u6982\u5ff5"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#132","text":"\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\uff1a \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09\uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u63a5\u53e3\uff0c\u8c03\u7528\u8005\u901a\u8fc7\u5b83\u8bbf\u95ee\u5177\u4f53\u5de5\u5382\u7684\u5de5\u5382\u65b9\u6cd5\u6765\u521b\u5efa\u4ea7\u54c1\u3002 \u5177\u4f53\u5de5\u5382\uff08ConcreteFactory\uff09\uff1a\u4e3b\u8981\u662f\u5b9e\u73b0\u62bd\u8c61\u5de5\u5382\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5b8c\u6210\u5177\u4f53\u4ea7\u54c1\u7684\u521b\u5efa\u3002 \u62bd\u8c61\u4ea7\u54c1\uff08Product\uff09\uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\u3002 \u5177\u4f53\u4ea7\u54c1\uff08ConcreteProduct\uff09\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u4ea7\u54c1\u89d2\u8272\u6240\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u7531\u5177\u4f53\u5de5\u5382\u6765\u521b\u5efa\uff0c\u5b83\u540c\u5177\u4f53\u5de5\u5382\u4e4b\u95f4\u4e00\u4e00\u5bf9\u5e94\u3002","title":"1.3.2 \u7ed3\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#133","text":"\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u5bf9\u4e0a\u4f8b\u8fdb\u884c\u6539\u8fdb\uff0c\u7c7b\u56fe\u5982\u4e0b\uff1a \u6d41\u7a0b\uff1a \u4ee3\u7801\u5982\u4e0b\uff1a \u62bd\u8c61\u5de5\u5382\uff1a public interface CoffeeFactory { Coffee createCoffee(); } \u5177\u4f53\u5de5\u5382\uff1a public class LatteCoffeeFactory implements CoffeeFactory { public Coffee createCoffee() { return new LatteCoffee(); } } public class AmericanCoffeeFactory implements CoffeeFactory { public Coffee createCoffee() { return new AmericanCoffee(); } } \u5496\u5561\u5e97\u7c7b\uff1a public class CoffeeStore { private CoffeeFactory factory; public CoffeeStore(CoffeeFactory factory) { this.factory = factory; } public Coffee orderCoffee(String type) { Coffee coffee = factory.createCoffee(); coffee.addMilk(); coffee.addsugar(); return coffee; } } \u4ece\u4ee5\u4e0a\u7684\u7f16\u5199\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u5230\uff0c\u8981\u589e\u52a0\u4ea7\u54c1\u7c7b\u65f6\u4e5f\u8981\u76f8\u5e94\u5730\u589e\u52a0\u5de5\u5382\u7c7b\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u5de5\u5382\u7c7b\u7684\u4ee3\u7801\u4e86\uff0c\u8fd9\u6837\u5c31\u89e3\u51b3\u4e86\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u7f3a\u70b9\u3002 \u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u662f\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u8fdb\u4e00\u6b65\u62bd\u8c61\u3002\u7531\u4e8e\u4f7f\u7528\u4e86\u591a\u6001\u6027\uff0c\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u4fdd\u6301\u4e86\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\u7684\u4f18\u70b9\uff0c\u800c\u4e14\u514b\u670d\u4e86\u5b83\u7684\u7f3a\u70b9\u3002","title":"1.3.3 \u5b9e\u73b0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#134","text":"\u4f18\u70b9\uff1a \u7528\u6237\u53ea\u9700\u8981\u77e5\u9053\u5177\u4f53\u5de5\u5382\u7684\u540d\u79f0\u5c31\u53ef\u5f97\u5230\u6240\u8981\u7684\u4ea7\u54c1\uff0c\u65e0\u987b\u77e5\u9053\u4ea7\u54c1\u7684\u5177\u4f53\u521b\u5efa\u8fc7\u7a0b\uff1b \u5728\u7cfb\u7edf\u589e\u52a0\u65b0\u7684\u4ea7\u54c1\u65f6\u53ea\u9700\u8981\u6dfb\u52a0\u5177\u4f53\u4ea7\u54c1\u7c7b\u548c\u5bf9\u5e94\u7684\u5177\u4f53\u5de5\u5382\u7c7b\uff0c\u65e0\u987b\u5bf9\u539f\u5de5\u5382\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\uff0c\u6ee1\u8db3\u5f00\u95ed\u539f\u5219\uff1b \u7f3a\u70b9\uff1a \u6bcf\u589e\u52a0\u4e00\u4e2a\u4ea7\u54c1\u5c31\u8981\u589e\u52a0\u4e00\u4e2a\u5177\u4f53\u4ea7\u54c1\u7c7b\u548c\u4e00\u4e2a\u5bf9\u5e94\u7684\u5177\u4f53\u5de5\u5382\u7c7b\uff0c\u8fd9\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\u3002","title":"1.3.4 \u4f18\u7f3a\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#14","text":"\u524d\u9762\u4ecb\u7ecd\u7684\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u4e2d\u8003\u8651\u7684\u662f\u4e00\u7c7b\u4ea7\u54c1\u7684\u751f\u4ea7\uff0c\u5982\u755c\u7267\u573a\u53ea\u517b\u52a8\u7269\u3001\u7535\u89c6\u673a\u5382\u53ea\u751f\u4ea7\u7535\u89c6\u673a\u3001\u4f20\u667a\u64ad\u5ba2\u53ea\u57f9\u517b\u8ba1\u7b97\u673a\u8f6f\u4ef6\u4e13\u4e1a\u7684\u5b66\u751f\u7b49\u3002 \u8fd9\u4e9b\u5de5\u5382\u53ea\u751f\u4ea7\u540c\u79cd\u7c7b\u4ea7\u54c1\uff0c\u540c\u79cd\u7c7b\u4ea7\u54c1\u79f0\u4e3a\u540c\u7b49\u7ea7\u4ea7\u54c1\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u53ea\u8003\u8651\u751f\u4ea7\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\uff0c\u4f46\u662f\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\u8bb8\u591a\u5de5\u5382\u662f\u7efc\u5408\u578b\u7684\u5de5\u5382\uff0c\u80fd\u751f\u4ea7\u591a\u7b49\u7ea7\uff08\u79cd\u7c7b\uff09 \u7684\u4ea7\u54c1\uff0c\u5982\u7535\u5668\u5382\u65e2\u751f\u4ea7\u7535\u89c6\u673a\u53c8\u751f\u4ea7\u6d17\u8863\u673a\u6216\u7a7a\u8c03\uff0c\u5927\u5b66\u65e2\u6709\u8f6f\u4ef6\u4e13\u4e1a\u53c8\u6709\u751f\u7269\u4e13\u4e1a\u7b49\u3002 \u672c\u8282\u8981\u4ecb\u7ecd\u7684\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5c06\u8003\u8651\u591a\u7b49\u7ea7\u4ea7\u54c1\u7684\u751f\u4ea7\uff0c\u5c06\u540c\u4e00\u4e2a\u5177\u4f53\u5de5\u5382\u6240\u751f\u4ea7\u7684\u4f4d\u4e8e\u4e0d\u540c\u7b49\u7ea7\u7684\u4e00\u7ec4\u4ea7\u54c1\u79f0\u4e3a\u4e00\u4e2a\u4ea7\u54c1\u65cf\uff0c\u4e0b\u56fe\u6240\u793a \u4ea7\u54c1\u65cf\uff1a\u4e00\u4e2a\u54c1\u724c\u4e0b\u9762\u7684\u6240\u6709\u4ea7\u54c1\uff1b\u4f8b\u5982\u534e\u4e3a\u4e0b\u9762\u7684\u7535\u8111\u3001\u624b\u673a\u79f0\u4e3a\u534e\u4e3a\u7684\u4ea7\u54c1\u65cf\uff1b \u4ea7\u54c1\u7b49\u7ea7\uff1a\u591a\u4e2a\u54c1\u724c\u4e0b\u9762\u7684\u540c\u79cd\u4ea7\u54c1\uff1b\u4f8b\u5982\u534e\u4e3a\u548c\u5c0f\u7c73\u90fd\u6709\u624b\u673a\u7535\u8111\u4e3a\u4e00\u4e2a\u4ea7\u54c1\u7b49\u7ea7\uff1b","title":"1.4 \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#141","text":"\u662f\u4e00\u79cd\u4e3a\u8bbf\u95ee\u7c7b\u63d0\u4f9b\u4e00\u4e2a\u521b\u5efa\u4e00\u7ec4\u76f8\u5173\u6216\u76f8\u4e92\u4f9d\u8d56\u5bf9\u8c61\u7684\u63a5\u53e3\uff0c\u4e14\u8bbf\u95ee\u7c7b\u65e0\u987b\u6307\u5b9a\u6240\u8981\u4ea7\u54c1\u7684\u5177\u4f53\u7c7b\u5c31\u80fd\u5f97\u5230\u540c\u65cf\u7684\u4e0d\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\u7684\u6a21\u5f0f\u7ed3\u6784\u3002 \u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u662f\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u7684\u5347\u7ea7\u7248\u672c\uff0c\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\u53ea\u751f\u4ea7\u4e00\u4e2a\u7b49\u7ea7\u7684\u4ea7\u54c1\uff0c\u800c\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u53ef\u751f\u4ea7\u591a\u4e2a\u7b49\u7ea7\u7684\u4ea7\u54c1\u3002 \u4e00\u4e2a\u8d85\u7ea7\u5de5\u5382\u521b\u5efa\u5176\u4ed6\u5de5\u5382\u3002\u8be5\u8d85\u7ea7\u5de5\u5382\u53c8\u79f0\u4e3a\u5176\u4ed6\u5de5\u5382\u7684\u5de5\u5382","title":"1.4.1 \u6982\u5ff5"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#142","text":"\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\u5982\u4e0b\uff1a \u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09\uff1a\u63d0\u4f9b\u4e86\u521b\u5efa\u4ea7\u54c1\u7684\u63a5\u53e3\uff0c\u5b83\u5305\u542b\u591a\u4e2a\u521b\u5efa\u4ea7\u54c1\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u4e0d\u540c\u7b49\u7ea7\u7684\u4ea7\u54c1\u3002 \u5177\u4f53\u5de5\u5382\uff08Concrete Factory\uff09\uff1a\u4e3b\u8981\u662f\u5b9e\u73b0\u62bd\u8c61\u5de5\u5382\u4e2d\u7684\u591a\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u5b8c\u6210\u5177\u4f53\u4ea7\u54c1\u7684\u521b\u5efa\u3002 \u62bd\u8c61\u4ea7\u54c1\uff08Product\uff09\uff1a\u5b9a\u4e49\u4e86\u4ea7\u54c1\u7684\u89c4\u8303\uff0c\u63cf\u8ff0\u4e86\u4ea7\u54c1\u7684\u4e3b\u8981\u7279\u6027\u548c\u529f\u80fd\uff0c\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u6709\u591a\u4e2a\u62bd\u8c61\u4ea7\u54c1\u3002 \u5177\u4f53\u4ea7\u54c1\uff08ConcreteProduct\uff09\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u4ea7\u54c1\u89d2\u8272\u6240\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u7531\u5177\u4f53\u5de5\u5382\u6765\u521b\u5efa\uff0c\u5b83 \u540c\u5177\u4f53\u5de5\u5382\u4e4b\u95f4\u662f\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\u3002","title":"1.4.2 \u7ed3\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#143","text":"\u73b0\u5496\u5561\u5e97\u4e1a\u52a1\u53d1\u751f\u6539\u53d8\uff0c\u4e0d\u4ec5\u8981\u751f\u4ea7 \u5496\u5561 \u8fd8\u8981\u751f\u4ea7 \u751c\u70b9 \u540c\u4e00\u4e2a\u4ea7\u54c1\u7b49\u7ea7\uff08\u4ea7\u54c1\u5206\u7c7b\uff09 \u5496\u5561\uff1a\u62ff\u94c1\u5496\u5561\u3001\u7f8e\u5f0f\u5496\u5561 \u751c\u70b9\uff1a\u63d0\u62c9\u7c73\u82cf\u3001\u62b9\u8336\u6155\u65af \u540c\u4e00\u4e2a\u98ce\u5473\uff0c\u5c31\u662f\u540c\u4e00\u4e2a\u4ea7\u54c1\u65cf\uff08\u76f8\u5f53\u4e8e\u540c\u4e00\u4e2a\u54c1\u724c\uff09 \u7f8e\u5f0f\u98ce\u5473\uff1a\u7f8e\u5f0f\u5496\u5561\u3001\u62b9\u8336\u6155\u65af \u610f\u5927\u5229\u98ce\u5473\uff1a\u62ff\u94c1\u5496\u5561\u3001\u63d0\u62c9\u7c73\u82cf \u8981\u662f\u6309\u7167\u5de5\u5382\u65b9\u6cd5\u6a21\u5f0f\uff0c\u9700\u8981\u5b9a\u4e49\u63d0\u62c9\u7c73\u82cf\u7c7b\u3001\u62b9\u8336\u6155\u65af\u7c7b\u3001\u63d0\u62c9\u7c73\u82cf\u5de5\u5382\u3001\u62b9\u8336\u6155\u65af\u5de5\u5382\u3001\u751c\u70b9\u5de5\u5382\u7c7b\uff0c\u5f88\u5bb9\u6613\u53d1\u751f\u7c7b\u7206\u70b8\u60c5\u51b5\u3002 \u6240\u4ee5\u8fd9\u4e2a\u6848\u4f8b\u53ef\u4ee5\u4f7f\u7528\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u5b9e\u73b0\u3002\u7c7b\u56fe\u5982\u4e0b\uff1a \u5b9e\u73b0\u5173\u7cfb\u4f7f\u7528\u5e26\u7a7a\u5fc3\u4e09\u89d2\u7bad\u5934\u7684\u865a\u7ebf\u6765\u8868\u793a \u6574\u4f53\u8c03\u7528\u601d\u8def\uff1a","title":"1.4.3 \u5b9e\u73b0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#144","text":"\u4f18\u70b9\uff1a \u5f53\u4e00\u4e2a\u4ea7\u54c1\u65cf\u4e2d\u7684\u591a\u4e2a\u5bf9\u8c61\u88ab\u8bbe\u8ba1\u6210\u4e00\u8d77\u5de5\u4f5c\u65f6\uff0c\u5b83\u80fd\u4fdd\u8bc1\u5ba2\u6237\u7aef\u59cb\u7ec8\u53ea\u4f7f\u7528\u540c\u4e00\u4e2a\u4ea7\u54c1\u65cf\u4e2d\u7684\u5bf9\u8c61\u3002 \u7f3a\u70b9\uff1a \u5f53\u4ea7\u54c1\u65cf\u4e2d\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u4ea7\u54c1\u65f6\uff0c\u6240\u6709\u7684\u5de5\u5382\u7c7b\u90fd\u9700\u8981\u8fdb\u884c\u4fee\u6539\u3002","title":"1.4.4 \u4f18\u7f3a\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#145","text":"\u5f53\u9700\u8981\u521b\u5efa\u7684\u5bf9\u8c61\u662f\u4e00\u7cfb\u5217\u76f8\u4e92\u5173\u8054\u6216\u76f8\u4e92\u4f9d\u8d56\u7684\u4ea7\u54c1\u65cf\u65f6\uff0c\u5982\u7535\u5668\u5de5\u5382\u4e2d\u7684\u7535\u89c6\u673a\u3001\u6d17\u8863\u673a\u3001\u7a7a\u8c03\u7b49\u3002 \u7cfb\u7edf\u4e2d\u6709\u591a\u4e2a\u4ea7\u54c1\u65cf\uff0c\u4f46\u6bcf\u6b21\u53ea\u4f7f\u7528\u5176\u4e2d\u7684\u67d0\u4e00\u65cf\u4ea7\u54c1\u3002\u5982\u6709\u4eba\u53ea\u559c\u6b22\u7a7f\u67d0\u4e00\u4e2a\u54c1\u724c\u7684\u8863\u670d\u548c\u978b\u3002 \u7cfb\u7edf\u4e2d\u63d0\u4f9b\u4e86\u4ea7\u54c1\u7684\u7c7b\u5e93\uff0c\u4e14\u6240\u6709\u4ea7\u54c1\u7684\u63a5\u53e3\u76f8\u540c\uff0c\u5ba2\u6237\u7aef\u4e0d\u4f9d\u8d56\u4ea7\u54c1\u5b9e\u4f8b\u7684\u521b\u5efa\u7ec6\u8282\u548c\u5185\u90e8\u7ed3\u6784\u3002 \u5982\uff1a\u8f93\u5165\u6cd5\u6362\u76ae\u80a4\uff0c\u4e00\u6574\u5957\u4e00\u8d77\u6362\u3002\u751f\u6210\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u7a0b\u5e8f\u3002","title":"1.4.5 \u4f7f\u7528\u573a\u666f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#2","text":"","title":"2 \u7b56\u7565\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#21","text":"\u5148\u770b\u4e0b\u9762\u7684\u56fe\u7247\uff0c\u6211\u4eec\u53bb\u65c5\u6e38\u9009\u62e9\u51fa\u884c\u6a21\u5f0f\u6709\u5f88\u591a\u79cd\uff0c\u53ef\u4ee5\u9a91\u81ea\u884c\u8f66\u3001\u53ef\u4ee5\u5750\u6c7d\u8f66\u3001\u53ef\u4ee5\u5750\u706b\u8f66\u3001\u53ef\u4ee5\u5750\u98de\u673a\u3002 \u4f5c\u4e3a\u4e00\u4e2a\u7a0b\u5e8f\u733f\uff0c\u5f00\u53d1\u9700\u8981\u9009\u62e9\u4e00\u6b3e\u5f00\u53d1\u5de5\u5177\uff0c\u5f53\u7136\u53ef\u4ee5\u8fdb\u884c\u4ee3\u7801\u5f00\u53d1\u7684\u5de5\u5177\u6709\u5f88\u591a\uff0c\u53ef\u4ee5\u9009\u62e9Idea\u8fdb\u884c\u5f00\u53d1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528eclipse\u8fdb\u884c\u5f00\u53d1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u4e00\u4e9b\u5f00\u53d1\u5de5\u5177\u3002 \u5b9a\u4e49\uff1a \u200b \u8be5\u6a21\u5f0f\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7b97\u6cd5\uff0c\u5e76\u5c06\u6bcf\u4e2a\u7b97\u6cd5\u5c01\u88c5\u8d77\u6765\uff0c\u4f7f\u5b83\u4eec\u53ef\u4ee5\u76f8\u4e92\u66ff\u6362\uff0c\u4e14\u7b97\u6cd5\u7684\u53d8\u5316\u4e0d\u4f1a\u5f71\u54cd\u4f7f\u7528\u7b97\u6cd5\u7684\u5ba2\u6237\u3002\u7b56\u7565\u6a21\u5f0f\u5c5e\u4e8e\u5bf9\u8c61\u884c\u4e3a\u6a21\u5f0f\uff0c\u5b83\u901a\u8fc7\u5bf9\u7b97\u6cd5\u8fdb\u884c\u5c01\u88c5\uff0c\u628a\u4f7f\u7528\u7b97\u6cd5\u7684\u8d23\u4efb\u548c\u7b97\u6cd5\u7684\u5b9e\u73b0\u5206\u5272\u5f00\u6765\uff0c\u5e76\u59d4\u6d3e\u7ed9\u4e0d\u540c\u7684\u5bf9\u8c61\u5bf9\u8fd9\u4e9b\u7b97\u6cd5\u8fdb\u884c\u7ba1\u7406\u3002","title":"2.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#22","text":"\u7b56\u7565\u6a21\u5f0f\u7684\u4e3b\u8981\u89d2\u8272\u5982\u4e0b\uff1a \u62bd\u8c61\u7b56\u7565\uff08Strategy\uff09\u7c7b\uff1a\u8fd9\u662f\u4e00\u4e2a\u62bd\u8c61\u89d2\u8272\uff0c\u901a\u5e38\u7531\u4e00\u4e2a\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\u5b9e\u73b0\u3002\u6b64\u89d2\u8272\u7ed9\u51fa\u6240\u6709\u7684\u5177\u4f53\u7b56\u7565\u7c7b\u6240\u9700\u7684\u63a5\u53e3\u3002 \u5177\u4f53\u7b56\u7565\uff08Concrete Strategy\uff09\u7c7b\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u7b56\u7565\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u63d0\u4f9b\u5177\u4f53\u7684\u7b97\u6cd5\u5b9e\u73b0\u6216\u884c\u4e3a\u3002 \u73af\u5883\uff08Context\uff09\u7c7b\uff1a\u6301\u6709\u4e00\u4e2a\u7b56\u7565\u7c7b\u7684\u5f15\u7528\uff0c\u6700\u7ec8\u7ed9\u5ba2\u6237\u7aef\u8c03\u7528\u3002","title":"2.2 \u7ed3\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#23","text":"\u3010\u4f8b\u3011\u4fc3\u9500\u6d3b\u52a8 \u4e00\u5bb6\u767e\u8d27\u516c\u53f8\u5728\u5b9a\u5e74\u5ea6\u7684\u4fc3\u9500\u6d3b\u52a8\u3002\u9488\u5bf9\u4e0d\u540c\u7684\u8282\u65e5\uff08\u6625\u8282\u3001\u4e2d\u79cb\u8282\u3001\u5723\u8bde\u8282\uff09\u63a8\u51fa\u4e0d\u540c\u7684\u4fc3\u9500\u6d3b\u52a8\uff0c\u7531\u4fc3\u9500\u5458\u5c06\u4fc3\u9500\u6d3b\u52a8\u5c55\u793a\u7ed9\u5ba2\u6237\u3002\u7c7b\u56fe\u5982\u4e0b\uff1a \u805a\u5408\u5173\u7cfb\u53ef\u4ee5\u7528\u5e26\u7a7a\u5fc3\u83f1\u5f62\u7684\u5b9e\u7ebf\u6765\u8868\u793a \u4ee3\u7801\u5982\u4e0b\uff1a \u5b9a\u4e49\u767e\u8d27\u516c\u53f8\u6240\u6709\u4fc3\u9500\u6d3b\u52a8\u7684\u5171\u540c\u63a5\u53e3 public interface Strategy { void show(); } \u5b9a\u4e49\u5177\u4f53\u7b56\u7565\u89d2\u8272\uff08Concrete Strategy\uff09\uff1a\u6bcf\u4e2a\u8282\u65e5\u5177\u4f53\u7684\u4fc3\u9500\u6d3b\u52a8 //\u4e3a\u6625\u8282\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8A public class StrategyA implements Strategy { public void show() { System.out.println(\"\u4e70\u4e00\u9001\u4e00\"); } } //\u4e3a\u4e2d\u79cb\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8B public class StrategyB implements Strategy { public void show() { System.out.println(\"\u6ee1200\u5143\u51cf50\u5143\"); } } //\u4e3a\u5723\u8bde\u51c6\u5907\u7684\u4fc3\u9500\u6d3b\u52a8C public class StrategyC implements Strategy { public void show() { System.out.println(\"\u6ee11000\u5143\u52a0\u4e00\u5143\u6362\u8d2d\u4efb\u610f200\u5143\u4ee5\u4e0b\u5546\u54c1\"); } } \u5b9a\u4e49\u73af\u5883\u89d2\u8272\uff08Context\uff09\uff1a\u7528\u4e8e\u8fde\u63a5\u4e0a\u4e0b\u6587\uff0c\u5373\u628a\u4fc3\u9500\u6d3b\u52a8\u63a8\u9500\u7ed9\u5ba2\u6237\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7406\u89e3\u4e3a\u9500\u552e\u5458 public class SalesMan { //\u6301\u6709\u62bd\u8c61\u7b56\u7565\u89d2\u8272\u7684\u5f15\u7528 private Strategy strategy; public SalesMan(Strategy strategy) { this.strategy = strategy; } //\u5411\u5ba2\u6237\u5c55\u793a\u4fc3\u9500\u6d3b\u52a8 public void salesManShow(){ strategy.show(); } }","title":"2.3 \u6848\u4f8b\u5b9e\u73b0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#24","text":"","title":"2.4 \u7efc\u5408\u6848\u4f8b"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#241","text":"\u4e0b\u56fe\u662fgitee\u7684\u767b\u5f55\u7684\u5165\u53e3\uff0c\u5176\u4e2d\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8fdb\u884c\u767b\u5f55 \u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55 \u77ed\u4fe1\u9a8c\u8bc1\u7801\u767b\u5f55 \u5fae\u4fe1\u767b\u5f55 QQ\u767b\u5f55 ....","title":"2.4.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#242","text":"(1)\u767b\u5f55\u63a5\u53e3 \u8bf4\u660e \u8bf7\u6c42\u65b9\u5f0f POST \u8def\u5f84 /api/user/login \u53c2\u6570 LoginReq \u8fd4\u56de\u503c LoginResp \u8bf7\u6c42\u53c2\u6570\uff1aLoginReq @Data public class LoginReq { private String name; private String password; private String phone; private String validateCode;//\u624b\u673a\u9a8c\u8bc1\u7801 private String wxCode;//\u7528\u4e8e\u5fae\u4fe1\u767b\u5f55 /** * account : \u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55 * sms : \u624b\u673a\u9a8c\u8bc1\u7801\u767b\u5f55 * we_chat : \u5fae\u4fe1\u767b\u5f55 */ private String type; } \u54cd\u5e94\u53c2\u6570\uff1aLoginResp @Data public class LoginResp{ private Integer userId; private String userName; private String roleCode; private String token; //jwt\u4ee4\u724c private boolean success; } \u63a7\u5236\u5c42LoginController @RestController @RequestMapping(\"/api/user\") public class LoginController { @Autowired private UserService userService; @PostMapping(\"/login\") public LoginResp login(@RequestBody LoginReq loginReq){ return userService.login(loginReq); } } \u4e1a\u52a1\u5c42UserService @Service public class UserService { public LoginResp login(LoginReq loginReq){ if(loginReq.getType().equals(\"account\")){ System.out.println(\"\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\"); //\u6267\u884c\u7528\u6237\u5bc6\u7801\u767b\u5f55\u903b\u8f91 return new LoginResp(); }else if(loginReq.getType().equals(\"sms\")){ System.out.println(\"\u624b\u673a\u53f7\u9a8c\u8bc1\u7801\u767b\u5f55\"); //\u6267\u884c\u624b\u673a\u53f7\u9a8c\u8bc1\u7801\u767b\u5f55\u903b\u8f91 return new LoginResp(); }else if (loginReq.getType().equals(\"we_chat\")){ System.out.println(\"\u5fae\u4fe1\u767b\u5f55\"); //\u6267\u884c\u7528\u6237\u5fae\u4fe1\u767b\u5f55\u903b\u8f91 return new LoginResp(); } LoginResp loginResp = new LoginResp(); loginResp.setSuccess(false); System.out.println(\"\u767b\u5f55\u5931\u8d25\"); return loginResp; } } \u6ce8\u610f\uff1a\u6211\u4eec\u91cd\u70b9\u8bb2\u7684\u662f\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5e76\u4e0d\u662f\u767b\u5f55\u7684\u903b\u8f91\uff0c\u6240\u4ee5\u4ee5\u4e0a\u4ee3\u7801\u5e76\u6ca1\u6709\u771f\u6b63\u7684\u5b9e\u73b0\u767b\u5f55\u529f\u80fd (2)\u95ee\u9898\u5206\u6790 \u4e1a\u52a1\u5c42\u4ee3\u7801\u5927\u91cf\u4f7f\u7528\u5230\u4e86if...else\uff0c\u5728\u540e\u671f\u9605\u8bfb\u4ee3\u7801\u7684\u65f6\u5019\u4f1a\u975e\u5e38\u4e0d\u53cb\u597d\uff0c\u5927\u91cf\u4f7f\u7528if...else\u6027\u80fd\u4e5f\u4e0d\u9ad8 \u5982\u679c\u4e1a\u52a1\u53d1\u751f\u53d8\u66f4\uff0c\u6bd4\u5982\u73b0\u5728\u65b0\u589e\u4e86QQ\u767b\u5f55\u65b9\u5f0f\uff0c\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\uff0c\u8fdd\u53cd\u4e86\u5f00\u95ed\u539f\u5219 \u89e3\u51b3\uff1a \u4f7f\u7528 \u5de5\u5382\u65b9\u6cd5\u8bbe\u8ba1\u6a21\u5f0f+\u7b56\u7565\u6a21\u5f0f \u89e3\u51b3","title":"2.4.2 \u76ee\u524d\u5df2\u5b9e\u73b0\u7684\u4ee3\u7801"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#243","text":"\uff081\uff09\u6574\u4f53\u601d\u8def \u6539\u9020\u4e4b\u540e\uff0c\u4e0d\u5728service\u4e2d\u5199\u4e1a\u52a1\u903b\u8f91\uff0c\u8ba9service\u8c03\u7528\u5de5\u5382\uff0c\u7136\u540e\u901a\u8fc7service\u4f20\u9012\u4e0d\u540c\u7684\u53c2\u6570\u6765\u83b7\u53d6\u4e0d\u540c\u7684\u767b\u5f55\u7b56\u7565\uff08\u767b\u5f55\u65b9\u5f0f\uff09 \uff082\uff09\u5177\u4f53\u5b9e\u73b0 \u62bd\u8c61\u7b56\u7565\u7c7b\uff1aUserGranter /** * \u62bd\u8c61\u7b56\u7565\u7c7b */ public interface UserGranter{ /** * \u83b7\u53d6\u6570\u636e * @param loginReq \u4f20\u5165\u7684\u53c2\u6570 * @return map\u503c */ LoginResp login(LoginReq loginReq); } \u5177\u4f53\u7684\u7b56\u7565\uff1aAccountGranter\u3001SmsGranter\u3001WeChatGranter /** * \u7b56\u7565\uff1a\u8d26\u53f7\u767b\u5f55 **/ @Component public class AccountGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u8d26\u53f7\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } /** * \u7b56\u7565:\u77ed\u4fe1\u767b\u5f55 */ @Component public class SmsGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u77ed\u4fe1\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } /** * \u7b56\u7565:\u5fae\u4fe1\u767b\u5f55 */ @Component public class WeChatGranter implements UserGranter{ @Override public LoginResp login(LoginReq loginReq) { System.out.println(\"\u767b\u5f55\u65b9\u5f0f\u4e3a\u5fae\u4fe1\u767b\u5f55\" + loginReq); // TODO // \u6267\u884c\u4e1a\u52a1\u64cd\u4f5c return new LoginResp(); } } \u5de5\u7a0b\u7c7b\uff1aUserLoginFactory /** * \u64cd\u4f5c\u7b56\u7565\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u7c7b \u5de5\u5177\u7c7b * \u5c06\u7b56\u7565\u6574\u5408\u8d77\u6765 \u65b9\u4fbf\u7ba1\u7406 */ @Component public class UserLoginFactory implements ApplicationContextAware { private static Map<String, UserGranter> granterPool = new ConcurrentHashMap<>(); @Autowired private LoginTypeConfig loginTypeConfig; /** * \u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b56\u7565\u4fe1\u606f\u5b58\u50a8\u5230map\u4e2d * { * account:accountGranter, * sms:smsGranter, * we_chat:weChatGranter * } * * @param applicationContext * @throws BeansException */ @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException { loginTypeConfig.getTypes().forEach((k, y) -> { granterPool.put(k, (UserGranter) applicationContext.getBean(y)); }); } /** * \u5bf9\u5916\u63d0\u4f9b\u83b7\u53d6\u5177\u4f53\u7b56\u7565 * * @param grantType \u7528\u6237\u7684\u767b\u5f55\u65b9\u5f0f\uff0c\u9700\u8981\u8ddf\u914d\u7f6e\u6587\u4ef6\u4e2d\u5339\u914d * @return \u5177\u4f53\u7b56\u7565 */ public UserGranter getGranter(String grantType) { UserGranter tokenGranter = granterPool.get(grantType); return tokenGranter; } } \u5728application.yml\u6587\u4ef6\u4e2d\u65b0\u589e\u81ea\u5b9a\u4e49\u914d\u7f6e login: types: account: accountGranter sms: smsGranter we_chat: weChatGranter \u65b0\u589e\u8bfb\u53d6\u6570\u636e\u914d\u7f6e\u7c7b Getter @Setter @Configuration @ConfigurationProperties(prefix = \"login\") public class LoginTypeConfig { private Map<String,String> types; } \u6539\u9020service\u4ee3\u7801 @Service public class UserService { @Autowired private UserLoginFactory factory; public LoginResp login(LoginReq loginReq){ UserGranter granter = factory.getGranter(loginReq.getType()); if(granter == null){ LoginResp loginResp = new LoginResp(); loginResp.setSuccess(false); return loginResp; } LoginResp loginResp = granter.login(loginReq); return loginResp; } } \u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u4f7f\u7528\u4e86\u8bbe\u8ba1\u6a21\u5f0f\u4e4b\u540e\uff0c\u4e1a\u52a1\u5c42\u7684\u4ee3\u7801\u5c31\u6e05\u723d\u591a\u4e86\uff0c\u5982\u679c\u540e\u671f\u6709\u65b0\u7684\u9700\u6c42\u6539\u52a8\uff0c\u6bd4\u5982\u52a0\u5165\u4e86QQ\u767b\u5f55\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\u5bf9\u5e94\u7684\u7b56\u7565\u5c31\u53ef\u4ee5\uff0c\u65e0\u9700\u518d\u6539\u52a8\u4e1a\u52a1\u5c42\u4ee3\u7801\u3002","title":"2.4.3 \u4ee3\u7801\u6539\u9020\uff08\u5de5\u5382+\u7b56\u7565\uff09"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#244","text":"\u5176\u5b9e\u50cf\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u5728\u65e5\u5e38\u5f00\u53d1\u4e2d\u975e\u5e38\u5e38\u89c1\uff0c\u573a\u666f\u6709\u5f88\u591a\uff0c\u4ee5\u4e0b\u7684\u60c5\u666f\u90fd\u53ef\u4ee5\u4f7f\u7528\u5de5\u5382\u6a21\u5f0f+\u7b56\u7565\u6a21\u5f0f\u89e3\u51b3\u6bd4\u5982\uff1a \u8ba2\u5355\u7684\u652f\u4ed8\u7b56\u7565 \u652f\u4ed8\u5b9d\u652f\u4ed8 \u5fae\u4fe1\u652f\u4ed8 \u94f6\u884c\u5361\u652f\u4ed8 \u73b0\u91d1\u652f\u4ed8 \u89e3\u6790\u4e0d\u540c\u7c7b\u578bexcel xls\u683c\u5f0f xlsx\u683c\u5f0f \u6253\u6298\u4fc3\u9500 \u6ee1300\u51439\u6298 \u6ee1500\u51438\u6298 \u6ee11000\u51437\u6298 \u7269\u6d41\u8fd0\u8d39\u9636\u68af\u8ba1\u7b97 5kg\u4ee5\u4e0b 5kg-10kg 10kg-20kg 20kg\u4ee5\u4e0a \u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a \u53ea\u8981\u4ee3\u7801\u4e2d\u6709\u5197\u957f\u7684 if-else \u6216 switch \u5206\u652f\u5224\u65ad\u90fd\u53ef\u4ee5\u91c7\u7528\u7b56\u7565\u6a21\u5f0f\u4f18\u5316","title":"2.4.4 \u4e3e\u4e00\u53cd\u4e09"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#3","text":"","title":"3 \u8d23\u4efb\u94fe\u8bbe\u8ba1\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#31","text":"\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u5e38\u5e38\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u4e8b\u4f8b\uff1a\u4e00\u4e2a\u8bf7\u6c42\u6709\u591a\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u5904\u7406\uff0c\u4f46\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5904\u7406\u6761\u4ef6\u6216\u6743\u9650\u4e0d\u540c\u3002\u4f8b\u5982\uff0c\u516c\u53f8\u5458\u5de5\u8bf7\u5047\uff0c\u53ef\u6279\u5047\u7684\u9886\u5bfc\u6709\u90e8\u95e8\u8d1f\u8d23\u4eba\u3001\u526f\u603b\u7ecf\u7406\u3001\u603b\u7ecf\u7406\u7b49\uff0c\u4f46\u6bcf\u4e2a\u9886\u5bfc\u80fd\u6279\u51c6\u7684\u5929\u6570\u4e0d\u540c\uff0c\u5458\u5de5\u5fc5\u987b\u6839\u636e\u81ea\u5df1\u8981\u8bf7\u5047\u7684\u5929\u6570\u53bb\u627e\u4e0d\u540c\u7684\u9886\u5bfc\u7b7e\u540d\uff0c\u4e5f\u5c31\u662f\u8bf4\u5458\u5de5\u5fc5\u987b\u8bb0\u4f4f\u6bcf\u4e2a\u9886\u5bfc\u7684\u59d3\u540d\u3001\u7535\u8bdd\u548c\u5730\u5740\u7b49\u4fe1\u606f\uff0c\u8fd9\u589e\u52a0\u4e86\u96be\u5ea6\u3002\u8fd9\u6837\u7684\u4f8b\u5b50\u8fd8\u6709\u5f88\u591a\uff0c\u5982\u627e\u9886\u5bfc\u51fa\u5dee\u62a5\u9500\u3001\u751f\u6d3b\u4e2d\u7684\u201c\u51fb\u9f13\u4f20\u82b1\u201d\u6e38\u620f\u7b49\u3002 \u5b9a\u4e49\uff1a \u53c8\u540d\u804c\u8d23\u94fe\u6a21\u5f0f\uff0c\u4e3a\u4e86\u907f\u514d\u8bf7\u6c42\u53d1\u9001\u8005\u4e0e\u591a\u4e2a\u8bf7\u6c42\u5904\u7406\u8005\u8026\u5408\u5728\u4e00\u8d77\uff0c\u5c06\u6240\u6709\u8bf7\u6c42\u7684\u5904\u7406\u8005\u901a\u8fc7\u524d\u4e00\u5bf9\u8c61\u8bb0\u4f4f\u5176\u4e0b\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u800c\u8fde\u6210\u4e00\u6761\u94fe\uff1b\u5f53\u6709\u8bf7\u6c42\u53d1\u751f\u65f6\uff0c\u53ef\u5c06\u8bf7\u6c42\u6cbf\u7740\u8fd9\u6761\u94fe\u4f20\u9012\uff0c\u76f4\u5230\u6709\u5bf9\u8c61\u5904\u7406\u5b83\u4e3a\u6b62\u3002 \u6bd4\u8f83\u5e38\u89c1\u7684springmvc\u4e2d\u7684\u62e6\u622a\u5668\uff0cweb\u5f00\u53d1\u4e2d\u7684filter\u8fc7\u6ee4\u5668","title":"3.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#32","text":"\u804c\u8d23\u94fe\u6a21\u5f0f\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u89d2\u8272: \u62bd\u8c61\u5904\u7406\u8005\uff08Handler\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u4e00\u4e2a\u5904\u7406\u8bf7\u6c42\u7684\u63a5\u53e3\uff0c\u5305\u542b\u62bd\u8c61\u5904\u7406\u65b9\u6cd5\u548c\u4e00\u4e2a\u540e\u7ee7\u8fde\u63a5\u3002 \u5177\u4f53\u5904\u7406\u8005\uff08Concrete Handler\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u5904\u7406\u8005\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u5224\u65ad\u80fd\u5426\u5904\u7406\u672c\u6b21\u8bf7\u6c42\uff0c\u5982\u679c\u53ef\u4ee5\u5904\u7406\u8bf7\u6c42\u5219\u5904\u7406\uff0c\u5426\u5219\u5c06\u8be5\u8bf7\u6c42\u8f6c\u7ed9\u5b83\u7684\u540e\u7ee7\u8005\u3002 \u5ba2\u6237\u7c7b\uff08Client\uff09\u89d2\u8272\uff1a\u521b\u5efa\u5904\u7406\u94fe\uff0c\u5e76\u5411\u94fe\u5934\u7684\u5177\u4f53\u5904\u7406\u8005\u5bf9\u8c61\u63d0\u4ea4\u8bf7\u6c42\uff0c\u5b83\u4e0d\u5173\u5fc3\u5904\u7406\u7ec6\u8282\u548c\u8bf7\u6c42\u7684\u4f20\u9012\u8fc7\u7a0b\u3002","title":"3.2 \u7ed3\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#32_1","text":"\u5904\u7406\u8ba2\u5355\u7684\u64cd\u4f5c \u7c7b\u56fe\uff1a \u4ee3\u7801\uff1a \u62bd\u8c61\u5904\u7406\u8005 package com.itheima.designpattern.chain; /** * \u62bd\u8c61\u5904\u7406\u8005 */ public abstract class Handler { protected Handler handler; public void setNext(Handler handler) { this.handler = handler; } /** * \u5904\u7406\u8fc7\u7a0b * \u9700\u8981\u5b50\u7c7b\u8fdb\u884c\u5b9e\u73b0 */ public abstract void process(OrderInfo order); } \u8ba2\u5355\u4fe1\u606f\u7c7b\uff1a package com.itheima.designpattern.chain; import java.math.BigDecimal; public class OrderInfo { private String productId; private String userId; private BigDecimal amount; public String getProductId() { return productId; } public void setProductId(String productId) { this.productId = productId; } public String getUserId() { return userId; } public void setUserId(String userId) { this.userId = userId; } public BigDecimal getAmount() { return amount; } public void setAmount(BigDecimal amount) { this.amount = amount; } } \u5177\u4f53\u5904\u7406\u8005\uff1a /** * \u8ba2\u5355\u6821\u9a8c */ public class OrderValidition extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u6821\u9a8c\u8ba2\u5355\u57fa\u672c\u4fe1\u606f\"); //\u6821\u9a8c handler.process(order); } } /** * \u8865\u5145\u8ba2\u5355\u4fe1\u606f */ public class OrderFill extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8865\u5145\u8ba2\u5355\u4fe1\u606f\"); handler.process(order); } } /** * \u8ba1\u7b97\u91d1\u989d */ public class OrderAmountCalcuate extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8ba1\u7b97\u91d1\u989d-\u4f18\u60e0\u5238\u3001VIP\u3001\u6d3b\u52a8\u6253\u6298\"); handler.process(order); } } /** * \u8ba2\u5355\u5165\u5e93 */ public class OrderCreate extends Handler { @Override public void process(OrderInfo order) { System.out.println(\"\u8ba2\u5355\u5165\u5e93\"); } } \u5ba2\u6237\u7c7b\uff1a public class Application { public static void main(String[] args) { //\u68c0\u9a8c\u8ba2\u5355 Handler orderValidition = new OrderValidition(); //\u8865\u5145\u8ba2\u5355\u4fe1\u606f Handler orderFill = new OrderFill(); //\u8ba2\u5355\u7b97\u4ef7 Handler orderAmountCalcuate = new OrderAmountCalcuate(); //\u8ba2\u5355\u843d\u5e93 Handler orderCreate = new OrderCreate(); //\u8bbe\u7f6e\u8d23\u4efb\u94fe\u8def orderValidition.setNext(orderFill); orderFill.setNext(orderAmountCalcuate); orderAmountCalcuate.setNext(orderCreate); //\u5f00\u59cb\u6267\u884c orderValidition.process(new OrderInfo()); } }","title":"3.2 \u6848\u4f8b\u5b9e\u73b0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#33","text":"\u4f18\u70b9 \u964d\u4f4e\u4e86\u5bf9\u8c61\u4e4b\u95f4\u7684\u8026\u5408\u5ea6 \u8be5\u6a21\u5f0f\u964d\u4f4e\u4e86\u8bf7\u6c42\u53d1\u9001\u8005\u548c\u63a5\u6536\u8005\u7684\u8026\u5408\u5ea6\u3002 \u589e\u5f3a\u4e86\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027 \u53ef\u4ee5\u6839\u636e\u9700\u8981\u589e\u52a0\u65b0\u7684\u8bf7\u6c42\u5904\u7406\u7c7b\uff0c\u6ee1\u8db3\u5f00\u95ed\u539f\u5219\u3002 \u589e\u5f3a\u4e86\u7ed9\u5bf9\u8c61\u6307\u6d3e\u804c\u8d23\u7684\u7075\u6d3b\u6027 \u5f53\u5de5\u4f5c\u6d41\u7a0b\u53d1\u751f\u53d8\u5316\uff0c\u53ef\u4ee5\u52a8\u6001\u5730\u6539\u53d8\u94fe\u5185\u7684\u6210\u5458\u6216\u8005\u4fee\u6539\u5b83\u4eec\u7684\u6b21\u5e8f\uff0c\u4e5f\u53ef\u52a8\u6001\u5730\u65b0\u589e\u6216\u8005\u5220\u9664\u8d23\u4efb\u3002 \u8d23\u4efb\u94fe\u7b80\u5316\u4e86\u5bf9\u8c61\u4e4b\u95f4\u7684\u8fde\u63a5 \u4e00\u4e2a\u5bf9\u8c61\u53ea\u9700\u4fdd\u6301\u4e00\u4e2a\u6307\u5411\u5176\u540e\u7ee7\u8005\u7684\u5f15\u7528\uff0c\u4e0d\u9700\u4fdd\u6301\u5176\u4ed6\u6240\u6709\u5904\u7406\u8005\u7684\u5f15\u7528\uff0c\u8fd9\u907f\u514d\u4e86\u4f7f\u7528\u4f17\u591a\u7684 if \u6216\u8005 if\u00b7\u00b7\u00b7else \u8bed\u53e5\u3002 \u8d23\u4efb\u5206\u62c5 \u6bcf\u4e2a\u7c7b\u53ea\u9700\u8981\u5904\u7406\u81ea\u5df1\u8be5\u5904\u7406\u7684\u5de5\u4f5c\uff0c\u4e0d\u80fd\u5904\u7406\u7684\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u5bf9\u8c61\u5b8c\u6210\uff0c\u660e\u786e\u5404\u7c7b\u7684\u8d23\u4efb\u8303\u56f4\uff0c\u7b26\u5408\u7c7b\u7684\u5355\u4e00\u804c\u8d23\u539f\u5219\u3002 \u7f3a\u70b9\uff1a \u4e0d\u80fd\u4fdd\u8bc1\u6bcf\u4e2a\u8bf7\u6c42\u4e00\u5b9a\u88ab\u5904\u7406\u3002\u7531\u4e8e\u4e00\u4e2a\u8bf7\u6c42\u6ca1\u6709\u660e\u786e\u7684\u63a5\u6536\u8005\uff0c\u6240\u4ee5\u4e0d\u80fd\u4fdd\u8bc1\u5b83\u4e00\u5b9a\u4f1a\u88ab\u5904\u7406\uff0c\u8be5\u8bf7\u6c42\u53ef\u80fd\u4e00\u76f4\u4f20\u5230\u94fe\u7684\u672b\u7aef\u90fd\u5f97\u4e0d\u5230\u5904\u7406\u3002 \u5bf9\u6bd4\u8f83\u957f\u7684\u804c\u8d23\u94fe\uff0c\u8bf7\u6c42\u7684\u5904\u7406\u53ef\u80fd\u6d89\u53ca\u591a\u4e2a\u5904\u7406\u5bf9\u8c61\uff0c\u7cfb\u7edf\u6027\u80fd\u5c06\u53d7\u5230\u4e00\u5b9a\u5f71\u54cd\u3002 \u804c\u8d23\u94fe\u5efa\u7acb\u7684\u5408\u7406\u6027\u8981\u9760\u5ba2\u6237\u7aef\u6765\u4fdd\u8bc1\uff0c\u589e\u52a0\u4e86\u5ba2\u6237\u7aef\u7684\u590d\u6742\u6027\uff0c\u53ef\u80fd\u4f1a\u7531\u4e8e\u804c\u8d23\u94fe\u7684\u9519\u8bef\u8bbe\u7f6e\u800c\u5bfc\u81f4\u7cfb\u7edf\u51fa\u9519\uff0c\u5982\u53ef\u80fd\u4f1a\u9020\u6210\u5faa\u73af\u8c03\u7528\u3002","title":"3.3 \u4f18\u7f3a\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/01-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#34","text":"\u5185\u5bb9\u5ba1\u6838\uff08\u89c6\u9891\u3001\u6587\u7ae0\u3001\u8bfe\u7a0b\u2026.\uff09 \u8ba2\u5355\u521b\u5efa \u7b80\u6613\u6d41\u7a0b\u5ba1\u6279","title":"3.4 \u4e3e\u4e00\u53cd\u4e09"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/","text":"\u5e38\u89c1\u6280\u672f\u573a\u666f 1.\u5355\u70b9\u767b\u5f55\u8fd9\u5757\u600e\u4e48\u5b9e\u73b0\u7684 1.1 \u6982\u8ff0 \u5355\u70b9\u767b\u5f55\u7684\u82f1\u6587\u540d\u53eb\u505a\uff1aSingle Sign On\uff08\u7b80\u79f0 SSO \uff09,\u53ea\u9700\u8981\u767b\u5f55\u4e00\u6b21\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u4fe1\u4efb\u7684\u5e94\u7528\u7cfb\u7edf \u5728 \u4ee5\u524d \u7684\u65f6\u5019\uff0c\u4e00\u822c\u6211\u4eec\u5c31 \u5355\u7cfb\u7edf \uff0c\u6240\u6709\u7684\u529f\u80fd\u90fd\u5728\u540c\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u3002 \u5355\u4f53\u7cfb\u7edf\u7684session\u5171\u4eab \u767b\u5f55 \uff1a\u5c06\u7528\u6237\u4fe1\u606f\u4fdd\u5b58\u5728Session\u5bf9\u8c61\u4e2d \u5982\u679c\u5728Session\u5bf9\u8c61\u4e2d\u80fd\u67e5\u5230\uff0c\u8bf4\u660e\u5df2\u7ecf\u767b\u5f55 \u5982\u679c\u5728Session\u5bf9\u8c61\u4e2d\u67e5\u4e0d\u5230\uff0c\u8bf4\u660e\u6ca1\u767b\u5f55\uff08\u6216\u8005\u5df2\u7ecf\u9000\u51fa\u4e86\u767b\u5f55\uff09 \u6ce8\u9500\uff08\u9000\u51fa\u767b\u5f55\uff09 \uff1a\u4eceSession\u4e2d\u5220\u9664\u7528\u6237\u7684\u4fe1\u606f \u540e\u6765\uff0c\u6211\u4eec\u4e3a\u4e86 \u5408\u7406\u5229\u7528\u8d44\u6e90\u548c\u964d\u4f4e\u8026\u5408\u6027 \uff0c\u4e8e\u662f\u628a\u5355\u7cfb\u7edf \u62c6\u5206 \u6210\u591a\u4e2a\u5b50\u7cfb\u7edf\u3002 \u591a\u7cfb\u7edf\u5373\u53ef\u80fd\u6709\u591a\u4e2aTomcat\uff0c\u800cSession\u662f\u4f9d\u8d56\u5f53\u524d\u7cfb\u7edf\u7684Tomcat\uff0c\u6240\u4ee5\u7cfb\u7edfA\u7684Session\u548c\u7cfb\u7edfB\u7684Session\u662f \u4e0d\u5171\u4eab \u7684\u3002 \u89e3\u51b3\u7cfb\u7edf\u4e4b\u95f4Session\u4e0d\u5171\u4eab\u95ee\u9898\u6709\u4e00\u4e0b\u51e0\u79cd\u65b9\u6848\uff1a Tomcat\u96c6\u7fa4Session\u5168\u5c40\u590d\u5236\uff08\u6700\u591a\u652f\u63015\u53f0tomcat\uff0c\u4e0d\u63a8\u8350\u4f7f\u7528\uff09 JWT(\u5e38\u89c1) Oauth2 CAS \u81ea\u5df1\u5b9e\u73b0\uff08redis+token\uff09 1.2 JWT\u89e3\u51b3\u5355\u70b9\u767b\u5f55 \u73b0\u5728\u6709\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u7b80\u5355\u67b6\u6784\uff0c\u5982\u56fe\uff1a \u4f7f\u7528jwt\u89e3\u51b3\u5355\u70b9\u767b\u5f55\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a 1.3 \u56de\u7b54\u8981\u70b9 1\uff0c\u5148\u89e3\u91ca\u4ec0\u4e48\u662f\u5355\u70b9\u767b\u5f55 \u5355\u70b9\u767b\u5f55\u7684\u82f1\u6587\u540d\u53eb\u505a\uff1aSingle Sign On\uff08\u7b80\u79f0 SSO \uff09 2\uff0c\u4ecb\u7ecd\u81ea\u5df1\u9879\u76ee\u4e2d\u6d89\u53ca\u5230\u7684\u5355\u70b9\u767b\u5f55\uff08\u5373\u4f7f\u6ca1\u6d89\u53ca\u8fc7\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u5b9e\u73b0\u7684\u601d\u8def\uff09 3\uff0c\u4ecb\u7ecd\u5355\u70b9\u767b\u5f55\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4ee5JWT\u4e3a\u4f8b \u200b I. \u7528\u6237\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\uff0c\u4f1a\u5728\u7f51\u5173\u5224\u65adtoken\u662f\u5426\u6709\u6548 \u200b II. \u5982\u679ctoken\u65e0\u6548\u5219\u4f1a\u8fd4\u56de401\uff08\u8ba4\u8bc1\u5931\u8d25\uff09\u524d\u7aef\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762 \u200b III. \u7528\u6237\u53d1\u9001\u767b\u5f55\u8bf7\u6c42\uff0c\u8fd4\u56de\u6d4f\u89c8\u5668\u4e00\u4e2atoken\uff0c\u6d4f\u89c8\u5668\u628atoken\u4fdd\u5b58\u5230cookie \u200b IV. \u518d\u53bb\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u643a\u5e26token\uff0c\u7531\u7f51\u5173\u7edf\u4e00\u9a8c\u8bc1\u540e\u8def\u7531\u5230\u76ee\u6807\u670d\u52a1 2.\u6743\u9650\u8ba4\u8bc1\u662f\u5982\u4f55\u5b9e\u73b0\u7684 2.1 \u6982\u8ff0 \u540e\u53f0\u7684\u7ba1\u7406\u7cfb\u7edf\uff0c\u66f4\u6ce8\u91cd\u6743\u9650\u63a7\u5236\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662fRBAC\u6a21\u578b\u6765\u6307\u5bfc\u5b9e\u73b0\u6743\u9650 RBAC(Role-Based Access Control)\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 3\u4e2a\u57fa\u7840\u90e8\u5206\u7ec4\u6210\uff1a\u7528\u6237\u3001\u89d2\u8272\u3001\u6743\u9650 \u5177\u4f53\u5b9e\u73b0 5\u5f20\u8868\uff08\u7528\u6237\u8868\u3001\u89d2\u8272\u8868\u3001\u6743\u9650\u8868\u3001\u7528\u6237\u89d2\u8272\u4e2d\u95f4\u8868\u3001\u89d2\u8272\u6743\u9650\u4e2d\u95f4\u8868\uff09 7\u5f20\u8868\uff08\u7528\u6237\u8868\u3001\u89d2\u8272\u8868\u3001\u6743\u9650\u8868\u3001\u83dc\u5355\u8868\u3001\u7528\u6237\u89d2\u8272\u4e2d\u95f4\u8868\u3001\u89d2\u8272\u6743\u9650\u4e2d\u95f4\u8868\u3001\u6743\u9650\u83dc\u5355\u4e2d\u95f4\u8868\uff09 2.2 RBAC\u6743\u9650\u6a21\u578b \u6700\u5e38\u89c1\u76845\u5f20\u8868\u7684\u5173\u7cfb \u6570\u636e\u6d41\u8f6c \u5f20\u4e09\u5177\u6709\u4ec0\u4e48\u6743\u9650\u5462\uff1f \u6d41\u7a0b\uff1a\u5f20\u4e09\u767b\u5f55\u7cfb\u7edf---> \u67e5\u8be2\u5f20\u4e09\u62e5\u6709\u7684\u89d2\u8272\u5217\u8868--->\u518d\u6839\u636e\u89d2\u8272\u67e5\u8be2\u62e5\u6709\u7684\u6743\u9650 \u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\uff0c\u4e5f\u4f1a\u4f7f\u7528\u6743\u9650\u6846\u67b6\u5b8c\u6210\u6743\u9650\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u5e76\u4e14\u8bbe\u7f6e\u591a\u79cd\u7c92\u5ea6\uff0c\u5e38\u89c1\u7684\u6846\u67b6\u6709\uff1a Apache shiro Spring security\uff08\u63a8\u8350\uff09 2.3 \u56de\u7b54\u8981\u70b9 \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u7684\u5f00\u53d1\u7ecf\u9a8c \u4ecb\u7ecdRBAC\u6743\u9650\u6a21\u578b5\u5f20\u8868\u7684\u5173\u7cfb\uff08\u7528\u6237\u3001\u89d2\u8272\u3001\u6743\u9650\uff09 \u6743\u9650\u6846\u67b6\uff1aSpring security 3.\u4e0a\u4f20\u6570\u636e\u7684\u5b89\u5168\u6027\u4f60\u4eec\u600e\u4e48\u63a7\u5236\uff1f 3.1 \u6982\u8ff0 \u8fd9\u91cc\u7684\u5b89\u5168\u6027\uff0c\u4e3b\u8981\u8bf4\u7684\u662f\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\u540e\u53f0\uff0c\u9700\u8981\u7ecf\u8fc7\u7f51\u7edc\u4f20\u8f93\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u5b89\u5168\u7684\u95ee\u9898 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08\u6216\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u7ed9\u524d\u7aef\u4e00\u4e2a\u516c\u94a5\u8ba9\u4ed6\u628a\u6570\u636e\u52a0\u5bc6\u540e\u4f20\u5230\u540e\u53f0\uff0c\u540e\u53f0\u8d1f\u8d23\u89e3\u5bc6\u540e\u5904\u7406\u6570\u636e 3.2 \u5bf9\u79f0\u52a0\u5bc6 \u6587\u4ef6\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u94a5\uff0c\u5373\u52a0\u5bc6\u5bc6\u94a5\u4e5f\u53ef\u4ee5\u7528\u4f5c\u89e3\u5bc6\u5bc6\u94a5 \u6570\u636e\u53d1\u4fe1\u65b9\u5c06\u660e\u6587\u548c\u52a0\u5bc6\u5bc6\u94a5\u4e00\u8d77\u7ecf\u8fc7\u7279\u6b8a\u7684\u52a0\u5bc6\u7b97\u6cd5\u5904\u7406\u540e\uff0c\u4f7f\u5176\u53d8\u6210\u590d\u6742\u7684\u52a0\u5bc6\u5bc6\u6587\u53d1\u9001\u51fa\u53bb\uff0c \u6536\u4fe1\u65b9\u6536\u5230\u5bc6\u6587\u540e\uff0c\u82e5\u60f3\u89e3\u8bfb\u51fa\u539f\u6587\uff0c\u5219\u9700\u8981\u4f7f\u7528\u52a0\u5bc6\u65f6\u7528\u7684\u5bc6\u94a5\u4ee5\u53ca\u76f8\u540c\u52a0\u5bc6\u7b97\u6cd5\u7684\u9006\u7b97\u6cd5\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u624d\u80fd\u4f7f\u5176\u56de\u590d\u6210\u53ef\u8bfb\u660e\u6587\u3002 \u5728\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u4e2d\uff0c\u4f7f\u7528\u7684\u5bc6\u94a5\u53ea\u6709\u4e00\u4e2a\uff0c\u6536\u53d1\u53cc\u65b9\u90fd\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u94a5\uff0c\u8fd9\u5c31\u9700\u8981\u89e3\u5bc6\u65b9\u4e8b\u5148\u77e5\u9053\u52a0\u5bc6\u5bc6\u94a5\u3002 \u4f18\u70b9: \u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f18\u70b9\u662f\u7b97\u6cd5\u516c\u5f00\u3001\u8ba1\u7b97\u91cf\u5c0f\u3001\u52a0\u5bc6\u901f\u5ea6\u5feb\u3001\u52a0\u5bc6\u6548\u7387\u9ad8\u3002 \u7f3a\u70b9: \u6ca1\u6709\u975e\u5bf9\u79f0\u52a0\u5bc6\u5b89\u5168. \u7528\u9014\uff1a \u4e00\u822c\u7528\u4e8e\u4fdd\u5b58\u7528\u6237\u624b\u673a\u53f7\u3001\u8eab\u4efd\u8bc1\u7b49\u654f\u611f\u4f46\u80fd\u89e3\u5bc6\u7684\u4fe1\u606f\u3002 \u5e38\u89c1\u7684\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6709 : AES\u3001DES\u30013DES\u3001Blowfish\u3001IDEA\u3001RC4\u3001RC5\u3001RC6\u3001HS256 3.3 \u975e\u5bf9\u79f0\u52a0\u5bc6 \u4e24\u4e2a\u5bc6\u94a5\uff1a\u516c\u5f00\u5bc6\u94a5\uff08publickey\uff09\u548c\u79c1\u6709\u5bc6\u94a5\uff0c\u516c\u6709\u5bc6\u94a5\u52a0\u5bc6\uff0c\u79c1\u6709\u5bc6\u94a5\u89e3\u5bc6 \u89e3\u91ca: \u540c\u65f6\u751f\u6210\u4e24\u628a\u5bc6\u94a5\uff1a\u79c1\u94a5\u548c\u516c\u94a5\uff0c\u79c1\u94a5\u9690\u79d8\u4fdd\u5b58\uff0c\u516c\u94a5\u53ef\u4ee5\u4e0b\u53d1\u7ed9\u4fe1\u4efb\u5ba2\u6237\u7aef. \u52a0\u5bc6\u4e0e\u89e3\u5bc6: \u79c1\u94a5\u52a0\u5bc6\uff0c\u6301\u6709\u516c\u94a5\u624d\u53ef\u4ee5\u89e3\u5bc6 \u516c\u94a5\u52a0\u5bc6\uff0c\u6301\u6709\u79c1\u94a5\u624d\u53ef\u89e3\u5bc6 \u7b7e\u540d: \u79c1\u94a5\u7b7e\u540d, \u6301\u6709\u516c\u94a5\u8fdb\u884c\u9a8c\u8bc1\u662f\u5426\u88ab\u7be1\u6539\u8fc7. **\u4f18\u70b9: ** \u975e\u5bf9\u79f0\u52a0\u5bc6\u4e0e\u5bf9\u79f0\u52a0\u5bc6\u76f8\u6bd4\uff0c\u5176\u5b89\u5168\u6027\u66f4\u597d\uff1b \u7f3a\u70b9: \u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u7f3a\u70b9\u662f\u52a0\u5bc6\u548c\u89e3\u5bc6\u82b1\u8d39\u65f6\u95f4\u957f\u3001\u901f\u5ea6\u6162\uff0c\u53ea\u9002\u5408\u5bf9\u5c11\u91cf\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\u3002 \u7528\u9014\uff1a \u4e00\u822c\u7528\u4e8e\u7b7e\u540d\u548c\u8ba4\u8bc1\u3002\u79c1\u94a5\u670d\u52a1\u5668\u4fdd\u5b58, \u7528\u6765\u52a0\u5bc6, \u516c\u94a5\u5ba2\u6237\u62ff\u7740\u7528\u4e8e\u5bf9\u4e8e\u4ee4\u724c\u6216\u8005\u7b7e\u540d\u7684\u89e3\u5bc6\u6216\u8005\u6821\u9a8c\u4f7f\u7528. \u5e38\u89c1\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6709\uff1a RSA\u3001DSA\uff08\u6570\u5b57\u7b7e\u540d\u7528\uff09\u3001ECC\uff08\u79fb\u52a8\u8bbe\u5907\u7528\uff09\u3001RS256 (\u91c7\u7528SHA-256 \u7684 RSA \u7b7e\u540d) 3.4 \u56de\u7b54\u8981\u70b9 \u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08\u6216\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u7ed9\u524d\u7aef\u4e00\u4e2a\u516c\u94a5\u8ba9\u4ed6\u628a\u6570\u636e\u52a0\u5bc6\u540e\u4f20\u5230\u540e\u53f0\uff0c\u540e\u53f0\u89e3\u5bc6\u540e\u5904\u7406\u6570\u636e \u4f20\u8f93\u7684\u6570\u636e\u5f88\u5927\u5efa\u8bae\u4f7f\u7528\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4e0d\u8fc7\u4e0d\u80fd\u4fdd\u5b58\u654f\u611f\u4fe1\u606f \u4f20\u8f93\u7684\u6570\u636e\u8f83\u5c0f\uff0c\u8981\u6c42\u5b89\u5168\u6027\u9ad8\uff0c\u5efa\u8bae\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6 4.\u4f60\u8d1f\u8d23\u9879\u76ee\u7684\u65f6\u5019\u9047\u5230\u4e86\u54ea\u4e9b\u6bd4\u8f83\u68d8\u624b\u7684\u95ee\u9898 \u8fd9\u4e2a\u9762\u8bd5\u9898\u4e3b\u8981\u8003\u5bdf\u7684\u662f\uff0c \u4f60\u662f\u5426\u6709\u8fc7\u5f00\u53d1\u7ecf\u9a8c \u662f\u5426\u662f\u6838\u5fc3\u5f00\u53d1\u4eba\u5458 \u67094\u4e2a\u65b9\u9762\u53ef\u4ee5\u56de\u7b54\uff0c\u53ea\u8981\u6311\u51fa\u4e00\u4e2a\u56de\u7b54\u5c31\u884c\u4e86 \uff081\uff09\u8bbe\u8ba1\u6a21\u5f0f \u5de5\u5382\u6a21\u5f0f+\u7b56\u7565 \u8d23\u4efb\u94fe\u6a21\u5f0f \u56de\u7b54\u601d\u8def 1\uff0c\u4ec0\u4e48\u80cc\u666f\uff08\u6280\u672f\u95ee\u9898\uff09 2\uff0c\u8fc7\u7a0b\uff08\u89e3\u51b3\u95ee\u9898\u7684\u8fc7\u7a0b\uff09 3\uff0c\u6700\u7ec8\u843d\u5730\u65b9\u6848 \u4e3e\u4f8b\uff1a \u2460\uff1a\u4ecb\u7ecd\u767b\u5f55\u4e1a\u52a1\uff08\u4e00\u5f00\u59cb\u6ca1\u6709\u7528\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6240\u6709\u7684\u767b\u5f55\u65b9\u5f0f\u90fd\u67d4\u548c\u5728\u4e00\u4e2a\u4e1a\u52a1\u7c7b\u4e2d\uff0c\u4e0d\u8fc7\uff0c\u53d1\u73b0\u9700\u6c42\u7ecf\u5e38\u6539\uff09 \u2461\uff1a\u767b\u5f55\u65b9\u5f0f\u7ecf\u5e38\u4f1a\u589e\u52a0\u6216\u66f4\u6362\uff0c\u6bcf\u6b21\u90fd\u8981\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\uff0c\u6240\u4ee5\uff0c\u7ecf\u8fc7\u6211\u7684\u8bbe\u8ba1\uff0c\u4f7f\u7528\u4e86\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u548c\u7b56\u7565\u6a21\u5f0f\uff0c\u89e3\u51b3\u4e86\uff0c\u7ecf\u5e38\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\u7684\u95ee\u9898 \u2462\uff1a\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u5de5\u5382\u6a21\u5f0f\u548c\u7b56\u7565\u6a21\u5f0f\uff08\u53c2\u8003\u524d\u9762\u8bbe\u8ba1\u6a21\u5f0f\u7684\u8bfe\u7a0b\uff09 \uff082\uff09\u7ebf\u4e0aBUG CPU\u98d9\u9ad8 \u5185\u5b58\u6cc4\u6f0f \u7ebf\u7a0b\u6b7b\u9501 .... \u56de\u7b54\u65b9\u5f0f\u53c2\u8003\u4e0a\u9762\u7684\u56de\u7b54\u601d\u8def\uff0c\u5177\u4f53\u95ee\u9898\u53ef\u4ee5\u53c2\u8003\u524d\u9762\u7684\u8bfe\u7a0b\uff08JVM\u548c\u591a\u7ebf\u7a0b\u76f8\u5173\u7684\u9762\u8bd5\u9898\uff09 \uff083\uff09\u8c03\u4f18 \u6162\u63a5\u53e3 \u6162SQL \u7f13\u5b58\u65b9\u6848 \uff084\uff09\u7ec4\u4ef6\u5c01\u88c5 \u5206\u5e03\u5f0f\u9501 \u63a5\u53e3\u5e42\u7b49 \u5206\u5e03\u5f0f\u4e8b\u52a1 \u652f\u4ed8\u901a\u7528 5.\u4f60\u4eec\u9879\u76ee\u4e2d\u65e5\u5fd7\u600e\u4e48\u91c7\u96c6\u7684 5.1 \u95ee\u9898 1\uff0c\u4e3a\u4ec0\u4e48\u8981\u91c7\u96c6\u65e5\u5fd7\uff1f \u65e5\u5fd7\u662f\u5b9a\u4f4d\u7cfb\u7edf\u95ee\u9898\u7684\u91cd\u8981\u624b\u6bb5\uff0c\u53ef\u4ee5\u6839\u636e\u65e5\u5fd7\u4fe1\u606f\u5feb\u901f\u5b9a\u4f4d\u7cfb\u7edf\u4e2d\u7684\u95ee\u9898 2\uff0c\u91c7\u96c6\u65e5\u5fd7\u7684\u65b9\u5f0f\u6709\u54ea\u4e9b? ELK\uff1a\u5373Elasticsearch\u3001Logstash\u548cKibana\u4e09\u4e2a\u8f6f\u4ef6\u7684\u9996\u5b57\u6bcd \u5e38\u89c4\u91c7\u96c6\uff1a\u6309\u5929\u4fdd\u5b58\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6 5.2 ELK\u57fa\u672c\u67b6\u6784 ELK\u5373Elasticsearch\u3001Logstash\u548cKibana\u4e09\u4e2a\u5f00\u6e90\u8f6f\u4ef6\u7684\u7f29\u5199 Elasticsearch Elasticsearch \u5168\u6587\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce\uff0c\u5bf9\u5927\u5bb9\u91cf\u7684\u6570\u636e\u8fdb\u884c\u63a5\u8fd1\u5b9e\u65f6\u7684\u5b58\u50a8\u3001\u641c\u7d22\u548c\u5206\u6790\u64cd\u4f5c\u3002 Logstash Logstash\u662f\u4e00\u4e2a\u6570\u636e\u6536\u96c6\u5f15\u64ce\uff0c\u5b83\u53ef\u4ee5\u52a8\u6001\u7684\u4ece\u5404\u79cd\u6570\u636e\u6e90\u641c\u96c6\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3001\u5206\u6790\u548c\u7edf\u4e00\u683c\u5f0f\u7b49\u64cd\u4f5c\uff0c\u5e76\u5c06\u8f93\u51fa\u7ed3\u679c\u5b58\u50a8\u5230\u6307\u5b9a\u4f4d\u7f6e\u4e0a Kibana Kibana\u662f\u4e00\u4e2a\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\uff0c\u901a\u5e38\u4e0eElasticsearch\u914d\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u5bf9\u5176\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u641c\u7d22\u3001\u5206\u6790\uff0c\u5e76\u4e14\u4ee5\u7edf\u8ba1\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u793a\u3002 5.3 \u53c2\u8003\u56de\u7b54 \u6211\u4eec\u642d\u5efa\u4e86ELK\u65e5\u5fd7\u91c7\u96c6\u7cfb\u7edf \u4ecb\u7ecdELK\u7684\u4e09\u4e2a\u7ec4\u4ef6\uff1a Elasticsearch\u662f\u5168\u6587\u641c\u7d22\u5206\u6790\u5f15\u64ce\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u5b58\u50a8\u3001\u641c\u7d22\u3001\u5206\u6790 Logstash\u662f\u4e00\u4e2a\u6570\u636e\u6536\u96c6\u5f15\u64ce\uff0c\u53ef\u4ee5\u52a8\u6001\u6536\u96c6\u6570\u636e\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3001\u5206\u6790\uff0c\u5c06\u6570\u636e\u5b58\u50a8\u5230\u6307\u5b9a\u7684\u4f4d\u7f6e Kibana\u662f\u4e00\u4e2a\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\uff0c\u914d\u5408Elasticsearch\u5bf9\u6570\u636e\u8fdb\u884c\u641c\u7d22\uff0c\u5206\u6790\uff0c\u56fe\u8868\u5316\u5c55\u793a 6.\u67e5\u770b\u65e5\u5fd7\u7684\u547d\u4ee4 \u76ee\u524d\u91c7\u96c6\u65e5\u5fd7\u7684\u65b9\u5f0f\uff1a\u6309\u5929\u4fdd\u5b58\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6 \u4e5f\u53ef\u4ee5\u5728logback\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u65e5\u5fd7\u7684\u76ee\u5f55\u548c\u540d\u5b57 \u9700\u8981\u638c\u63e1\u7684Linux\u4e2d\u7684\u65e5\u5fd7\uff1a \u5b9e\u65f6\u76d1\u63a7\u65e5\u5fd7\u7684\u53d8\u5316 \u5b9e\u65f6\u76d1\u63a7\u67d0\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u53d8\u5316\uff1atail -f xx.log\uff1b\u5b9e\u65f6\u76d1\u63a7\u65e5\u5fd7\u6700\u540e100\u884c\u65e5\u5fd7\uff1a tail \u2013n 100 -f xx.log \u6309\u7167\u884c\u53f7\u67e5\u8be2 \u67e5\u8be2\u65e5\u5fd7\u5c3e\u90e8\u6700\u540e100\u884c\u65e5\u5fd7\uff1atail \u2013 n 100 xx.log \u67e5\u8be2\u65e5\u5fd7\u5934\u90e8\u5f00\u59cb100\u884c\u65e5\u5fd7\uff1ahead \u2013n 100 xx.log \u67e5\u8be2\u67d0\u4e00\u4e2a\u65e5\u5fd7\u884c\u53f7\u533a\u95f4\uff1acat -n xx.log | tail -n +100 | head -n 100 (\u67e5\u8be2100\u884c\u81f3200\u884c\u7684\u65e5\u5fd7) \u6309\u7167\u5173\u952e\u5b57\u627e\u65e5\u5fd7\u7684\u4fe1\u606f \u67e5\u8be2\u65e5\u5fd7\u6587\u4ef6\u4e2d\u5305\u542bdebug\u7684\u65e5\u5fd7\u884c\u53f7\uff1acat -n xx.log | grep \"debug\" \u6309\u7167\u65e5\u671f\u67e5\u8be2 sed -n '/2023-05-18 14:22:31.070/,/ 2023-05-18 14:27:14.158/p\u2019xx.log \u65e5\u5fd7\u592a\u591a\uff0c\u5904\u7406\u65b9\u5f0f \u5206\u9875\u67e5\u8be2\u65e5\u5fd7\u4fe1\u606f\uff1acat -n xx.log |grep \"debug\" | more \u7b5b\u9009\u8fc7\u6ee4\u4ee5\u540e\uff0c\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\uff1acat -n xx.log | grep \"debug\" >debug.txt 7.\u751f\u4ea7\u95ee\u9898\u600e\u4e48\u6392\u67e5 \u5df2\u7ecf\u4e0a\u7ebf\u7684bug\u6392\u67e5\u7684\u601d\u8def\uff1a 1\uff0c\u5148\u5206\u6790\u65e5\u5fd7\uff0c\u901a\u5e38\u5728\u4e1a\u52a1\u4e2d\u90fd\u4f1a\u6709\u65e5\u5fd7\u7684\u8bb0\u5f55\uff0c\u6216\u8005\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff0c\u6216\u8005\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\uff0c\u7136\u540e\u5b9a\u4f4d\u95ee\u9898 2\uff0c\u8fdc\u7a0bdebug(\u901a\u5e38\u516c\u53f8\u7684\u6b63\u5f0f\u73af\u5883\uff08\u751f\u4ea7\u73af\u5883\uff09\u662f\u4e0d\u5141\u8bb8\u8fdc\u7a0bdebug\u7684\u3002\u4e00\u822c\u8fdc\u7a0bdebug\u90fd\u662f\u516c\u53f8\u7684\u6d4b\u8bd5\u73af\u5883\uff0c\u65b9\u4fbf\u8c03\u8bd5\u4ee3\u7801) \u8fdc\u7a0bdebug\u914d\u7f6e \u524d\u63d0\u6761\u4ef6\uff1a \u8fdc\u7a0b\u7684\u4ee3\u7801\u548c\u672c\u5730\u7684\u4ee3\u7801\u8981\u4fdd\u6301\u4e00\u81f4 1.\u8fdc\u7a0b\u4ee3\u7801\u9700\u8981\u914d\u7f6e\u542f\u52a8\u53c2\u6570\uff0c\u628a\u9879\u76ee\u6253\u5305\u653e\u5230\u670d\u52a1\u5668\u540e\u542f\u52a8\u9879\u76ee\u7684\u53c2\u6570\uff1a java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 project-1.0-SNAPSHOT.jar -agentlib:jdwp \u662f\u901a\u77e5JVM\u4f7f\u7528(java debug wire protocol)\u6765\u8fd0\u884c\u8c03\u8bd5\u73af\u5883 transport=dt_socket \u8c03\u8bd5\u6570\u636e\u7684\u4f20\u9001\u65b9\u5f0f server=y \u53c2\u6570\u662f\u6307\u662f\u5426\u652f\u6301\u5728server\u6a21\u5f0f suspend=n \u662f\u5426\u5728\u8c03\u8bd5\u5ba2\u6237\u7aef\u5efa\u7acb\u8d77\u6765\u540e\uff0c\u518d\u6267\u884cJVM\u3002 address=5005 \u8c03\u8bd5\u7aef\u53e3\u8bbe\u7f6e\u4e3a5005\uff0c\u5176\u5b83\u7aef\u53e3\u4e5f\u53ef\u4ee5 2.idea\u4e2d\u8bbe\u7f6e\u8fdc\u7a0bdebug\uff0c\u627e\u5230idea\u4e2d\u7684 Edit Configurations... idea\u4e2d\u542f\u52a8\u8fdc\u7a0bdebug \u8bbf\u95ee\u8fdc\u7a0b\u670d\u52a1\u5668\uff0c\u5728\u672c\u5730\u4ee3\u7801\u4e2d\u6253\u65ad\u70b9\u5373\u53ef\u8c03\u8bd5\u8fdc\u7a0b 8.\u600e\u4e48\u5feb\u901f\u5b9a\u4f4d\u7cfb\u7edf\u7684\u74f6\u9888 \u538b\u6d4b\uff08\u6027\u80fd\u6d4b\u8bd5\uff09\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\u6d4b\u8bc4\u7cfb\u7edf\u7684\u538b\u529b \u538b\u6d4b\u76ee\u7684\uff1a\u7ed9\u51fa\u7cfb\u7edf\u5f53\u524d\u7684\u6027\u80fd\u72b6\u51b5\uff1b\u5b9a\u4f4d\u7cfb\u7edf\u6027\u80fd\u74f6\u9888\u6216\u6f5c\u5728\u6027\u80fd\u74f6\u9888 \u6307\u6807\uff1a\u54cd\u5e94\u65f6\u95f4\u3001 QPS\u3001\u5e76\u53d1\u6570\u3001\u541e\u5410\u91cf\u3001 CPU\u5229\u7528\u7387\u3001\u5185\u5b58\u4f7f\u7528\u7387\u3001\u78c1\u76d8IO\u3001\u9519\u8bef\u7387 \u538b\u6d4b\u5de5\u5177\uff1aLoadRunner\u3001Apache Jmeter \u2026 \u540e\u7aef\u5de5\u7a0b\u5e08\uff1a\u6839\u636e\u538b\u6d4b\u7684\u7ed3\u679c\u8fdb\u884c\u89e3\u51b3\u6216\u8c03\u4f18\uff08\u63a5\u53e3\u6162\u3001\u4ee3\u7801\u62a5\u9519\u3001\u5e76\u53d1\u8fbe\u4e0d\u5230\u8981\u6c42\u2026\uff09 \u76d1\u63a7\u5de5\u5177\u3001\u94fe\u8def\u8ffd\u8e2a\u5de5\u5177\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u540e\u76d1\u63a7 \u76d1\u63a7\u5de5\u5177\uff1aPrometheus+Grafana \u94fe\u8def\u8ffd\u8e2a\u5de5\u5177\uff1askywalking\u3001Zipkin \u7ebf\u4e0a\u8bca\u65ad\u5de5\u5177Arthas(\u963f\u5c14\u8428\u65af)\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u540e\u76d1\u63a7\u3001\u6392\u67e5 \u5b98\u7f51\uff1ahttps://arthas.aliyun.com/ \u6838\u5fc3\u529f\u80fd\uff1a","title":"\u5e38\u89c1\u6280\u672f\u573a\u666f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#_1","text":"","title":"\u5e38\u89c1\u6280\u672f\u573a\u666f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#1","text":"","title":"1.\u5355\u70b9\u767b\u5f55\u8fd9\u5757\u600e\u4e48\u5b9e\u73b0\u7684"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#11","text":"\u5355\u70b9\u767b\u5f55\u7684\u82f1\u6587\u540d\u53eb\u505a\uff1aSingle Sign On\uff08\u7b80\u79f0 SSO \uff09,\u53ea\u9700\u8981\u767b\u5f55\u4e00\u6b21\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709\u4fe1\u4efb\u7684\u5e94\u7528\u7cfb\u7edf \u5728 \u4ee5\u524d \u7684\u65f6\u5019\uff0c\u4e00\u822c\u6211\u4eec\u5c31 \u5355\u7cfb\u7edf \uff0c\u6240\u6709\u7684\u529f\u80fd\u90fd\u5728\u540c\u4e00\u4e2a\u7cfb\u7edf\u4e0a\u3002 \u5355\u4f53\u7cfb\u7edf\u7684session\u5171\u4eab \u767b\u5f55 \uff1a\u5c06\u7528\u6237\u4fe1\u606f\u4fdd\u5b58\u5728Session\u5bf9\u8c61\u4e2d \u5982\u679c\u5728Session\u5bf9\u8c61\u4e2d\u80fd\u67e5\u5230\uff0c\u8bf4\u660e\u5df2\u7ecf\u767b\u5f55 \u5982\u679c\u5728Session\u5bf9\u8c61\u4e2d\u67e5\u4e0d\u5230\uff0c\u8bf4\u660e\u6ca1\u767b\u5f55\uff08\u6216\u8005\u5df2\u7ecf\u9000\u51fa\u4e86\u767b\u5f55\uff09 \u6ce8\u9500\uff08\u9000\u51fa\u767b\u5f55\uff09 \uff1a\u4eceSession\u4e2d\u5220\u9664\u7528\u6237\u7684\u4fe1\u606f \u540e\u6765\uff0c\u6211\u4eec\u4e3a\u4e86 \u5408\u7406\u5229\u7528\u8d44\u6e90\u548c\u964d\u4f4e\u8026\u5408\u6027 \uff0c\u4e8e\u662f\u628a\u5355\u7cfb\u7edf \u62c6\u5206 \u6210\u591a\u4e2a\u5b50\u7cfb\u7edf\u3002 \u591a\u7cfb\u7edf\u5373\u53ef\u80fd\u6709\u591a\u4e2aTomcat\uff0c\u800cSession\u662f\u4f9d\u8d56\u5f53\u524d\u7cfb\u7edf\u7684Tomcat\uff0c\u6240\u4ee5\u7cfb\u7edfA\u7684Session\u548c\u7cfb\u7edfB\u7684Session\u662f \u4e0d\u5171\u4eab \u7684\u3002 \u89e3\u51b3\u7cfb\u7edf\u4e4b\u95f4Session\u4e0d\u5171\u4eab\u95ee\u9898\u6709\u4e00\u4e0b\u51e0\u79cd\u65b9\u6848\uff1a Tomcat\u96c6\u7fa4Session\u5168\u5c40\u590d\u5236\uff08\u6700\u591a\u652f\u63015\u53f0tomcat\uff0c\u4e0d\u63a8\u8350\u4f7f\u7528\uff09 JWT(\u5e38\u89c1) Oauth2 CAS \u81ea\u5df1\u5b9e\u73b0\uff08redis+token\uff09","title":"1.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#12-jwt","text":"\u73b0\u5728\u6709\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u7b80\u5355\u67b6\u6784\uff0c\u5982\u56fe\uff1a \u4f7f\u7528jwt\u89e3\u51b3\u5355\u70b9\u767b\u5f55\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a","title":"1.2 JWT\u89e3\u51b3\u5355\u70b9\u767b\u5f55"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#13","text":"1\uff0c\u5148\u89e3\u91ca\u4ec0\u4e48\u662f\u5355\u70b9\u767b\u5f55 \u5355\u70b9\u767b\u5f55\u7684\u82f1\u6587\u540d\u53eb\u505a\uff1aSingle Sign On\uff08\u7b80\u79f0 SSO \uff09 2\uff0c\u4ecb\u7ecd\u81ea\u5df1\u9879\u76ee\u4e2d\u6d89\u53ca\u5230\u7684\u5355\u70b9\u767b\u5f55\uff08\u5373\u4f7f\u6ca1\u6d89\u53ca\u8fc7\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u5b9e\u73b0\u7684\u601d\u8def\uff09 3\uff0c\u4ecb\u7ecd\u5355\u70b9\u767b\u5f55\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4ee5JWT\u4e3a\u4f8b \u200b I. \u7528\u6237\u8bbf\u95ee\u5176\u4ed6\u7cfb\u7edf\uff0c\u4f1a\u5728\u7f51\u5173\u5224\u65adtoken\u662f\u5426\u6709\u6548 \u200b II. \u5982\u679ctoken\u65e0\u6548\u5219\u4f1a\u8fd4\u56de401\uff08\u8ba4\u8bc1\u5931\u8d25\uff09\u524d\u7aef\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762 \u200b III. \u7528\u6237\u53d1\u9001\u767b\u5f55\u8bf7\u6c42\uff0c\u8fd4\u56de\u6d4f\u89c8\u5668\u4e00\u4e2atoken\uff0c\u6d4f\u89c8\u5668\u628atoken\u4fdd\u5b58\u5230cookie \u200b IV. \u518d\u53bb\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u643a\u5e26token\uff0c\u7531\u7f51\u5173\u7edf\u4e00\u9a8c\u8bc1\u540e\u8def\u7531\u5230\u76ee\u6807\u670d\u52a1","title":"1.3 \u56de\u7b54\u8981\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#2","text":"","title":"2.\u6743\u9650\u8ba4\u8bc1\u662f\u5982\u4f55\u5b9e\u73b0\u7684"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#21","text":"\u540e\u53f0\u7684\u7ba1\u7406\u7cfb\u7edf\uff0c\u66f4\u6ce8\u91cd\u6743\u9650\u63a7\u5236\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662fRBAC\u6a21\u578b\u6765\u6307\u5bfc\u5b9e\u73b0\u6743\u9650 RBAC(Role-Based Access Control)\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236 3\u4e2a\u57fa\u7840\u90e8\u5206\u7ec4\u6210\uff1a\u7528\u6237\u3001\u89d2\u8272\u3001\u6743\u9650 \u5177\u4f53\u5b9e\u73b0 5\u5f20\u8868\uff08\u7528\u6237\u8868\u3001\u89d2\u8272\u8868\u3001\u6743\u9650\u8868\u3001\u7528\u6237\u89d2\u8272\u4e2d\u95f4\u8868\u3001\u89d2\u8272\u6743\u9650\u4e2d\u95f4\u8868\uff09 7\u5f20\u8868\uff08\u7528\u6237\u8868\u3001\u89d2\u8272\u8868\u3001\u6743\u9650\u8868\u3001\u83dc\u5355\u8868\u3001\u7528\u6237\u89d2\u8272\u4e2d\u95f4\u8868\u3001\u89d2\u8272\u6743\u9650\u4e2d\u95f4\u8868\u3001\u6743\u9650\u83dc\u5355\u4e2d\u95f4\u8868\uff09","title":"2.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#22-rbac","text":"\u6700\u5e38\u89c1\u76845\u5f20\u8868\u7684\u5173\u7cfb \u6570\u636e\u6d41\u8f6c \u5f20\u4e09\u5177\u6709\u4ec0\u4e48\u6743\u9650\u5462\uff1f \u6d41\u7a0b\uff1a\u5f20\u4e09\u767b\u5f55\u7cfb\u7edf---> \u67e5\u8be2\u5f20\u4e09\u62e5\u6709\u7684\u89d2\u8272\u5217\u8868--->\u518d\u6839\u636e\u89d2\u8272\u67e5\u8be2\u62e5\u6709\u7684\u6743\u9650 \u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\uff0c\u4e5f\u4f1a\u4f7f\u7528\u6743\u9650\u6846\u67b6\u5b8c\u6210\u6743\u9650\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u5e76\u4e14\u8bbe\u7f6e\u591a\u79cd\u7c92\u5ea6\uff0c\u5e38\u89c1\u7684\u6846\u67b6\u6709\uff1a Apache shiro Spring security\uff08\u63a8\u8350\uff09","title":"2.2 RBAC\u6743\u9650\u6a21\u578b"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#23","text":"\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u7684\u5f00\u53d1\u7ecf\u9a8c \u4ecb\u7ecdRBAC\u6743\u9650\u6a21\u578b5\u5f20\u8868\u7684\u5173\u7cfb\uff08\u7528\u6237\u3001\u89d2\u8272\u3001\u6743\u9650\uff09 \u6743\u9650\u6846\u67b6\uff1aSpring security","title":"2.3 \u56de\u7b54\u8981\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#3","text":"","title":"3.\u4e0a\u4f20\u6570\u636e\u7684\u5b89\u5168\u6027\u4f60\u4eec\u600e\u4e48\u63a7\u5236\uff1f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#31","text":"\u8fd9\u91cc\u7684\u5b89\u5168\u6027\uff0c\u4e3b\u8981\u8bf4\u7684\u662f\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\u540e\u53f0\uff0c\u9700\u8981\u7ecf\u8fc7\u7f51\u7edc\u4f20\u8f93\uff0c\u6709\u53ef\u80fd\u4f1a\u51fa\u73b0\u5b89\u5168\u7684\u95ee\u9898 \u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08\u6216\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u7ed9\u524d\u7aef\u4e00\u4e2a\u516c\u94a5\u8ba9\u4ed6\u628a\u6570\u636e\u52a0\u5bc6\u540e\u4f20\u5230\u540e\u53f0\uff0c\u540e\u53f0\u8d1f\u8d23\u89e3\u5bc6\u540e\u5904\u7406\u6570\u636e","title":"3.1 \u6982\u8ff0"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#32","text":"\u6587\u4ef6\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u94a5\uff0c\u5373\u52a0\u5bc6\u5bc6\u94a5\u4e5f\u53ef\u4ee5\u7528\u4f5c\u89e3\u5bc6\u5bc6\u94a5 \u6570\u636e\u53d1\u4fe1\u65b9\u5c06\u660e\u6587\u548c\u52a0\u5bc6\u5bc6\u94a5\u4e00\u8d77\u7ecf\u8fc7\u7279\u6b8a\u7684\u52a0\u5bc6\u7b97\u6cd5\u5904\u7406\u540e\uff0c\u4f7f\u5176\u53d8\u6210\u590d\u6742\u7684\u52a0\u5bc6\u5bc6\u6587\u53d1\u9001\u51fa\u53bb\uff0c \u6536\u4fe1\u65b9\u6536\u5230\u5bc6\u6587\u540e\uff0c\u82e5\u60f3\u89e3\u8bfb\u51fa\u539f\u6587\uff0c\u5219\u9700\u8981\u4f7f\u7528\u52a0\u5bc6\u65f6\u7528\u7684\u5bc6\u94a5\u4ee5\u53ca\u76f8\u540c\u52a0\u5bc6\u7b97\u6cd5\u7684\u9006\u7b97\u6cd5\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u624d\u80fd\u4f7f\u5176\u56de\u590d\u6210\u53ef\u8bfb\u660e\u6587\u3002 \u5728\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u4e2d\uff0c\u4f7f\u7528\u7684\u5bc6\u94a5\u53ea\u6709\u4e00\u4e2a\uff0c\u6536\u53d1\u53cc\u65b9\u90fd\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u94a5\uff0c\u8fd9\u5c31\u9700\u8981\u89e3\u5bc6\u65b9\u4e8b\u5148\u77e5\u9053\u52a0\u5bc6\u5bc6\u94a5\u3002 \u4f18\u70b9: \u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f18\u70b9\u662f\u7b97\u6cd5\u516c\u5f00\u3001\u8ba1\u7b97\u91cf\u5c0f\u3001\u52a0\u5bc6\u901f\u5ea6\u5feb\u3001\u52a0\u5bc6\u6548\u7387\u9ad8\u3002 \u7f3a\u70b9: \u6ca1\u6709\u975e\u5bf9\u79f0\u52a0\u5bc6\u5b89\u5168. \u7528\u9014\uff1a \u4e00\u822c\u7528\u4e8e\u4fdd\u5b58\u7528\u6237\u624b\u673a\u53f7\u3001\u8eab\u4efd\u8bc1\u7b49\u654f\u611f\u4f46\u80fd\u89e3\u5bc6\u7684\u4fe1\u606f\u3002 \u5e38\u89c1\u7684\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6709 : AES\u3001DES\u30013DES\u3001Blowfish\u3001IDEA\u3001RC4\u3001RC5\u3001RC6\u3001HS256","title":"3.2 \u5bf9\u79f0\u52a0\u5bc6"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#33","text":"\u4e24\u4e2a\u5bc6\u94a5\uff1a\u516c\u5f00\u5bc6\u94a5\uff08publickey\uff09\u548c\u79c1\u6709\u5bc6\u94a5\uff0c\u516c\u6709\u5bc6\u94a5\u52a0\u5bc6\uff0c\u79c1\u6709\u5bc6\u94a5\u89e3\u5bc6 \u89e3\u91ca: \u540c\u65f6\u751f\u6210\u4e24\u628a\u5bc6\u94a5\uff1a\u79c1\u94a5\u548c\u516c\u94a5\uff0c\u79c1\u94a5\u9690\u79d8\u4fdd\u5b58\uff0c\u516c\u94a5\u53ef\u4ee5\u4e0b\u53d1\u7ed9\u4fe1\u4efb\u5ba2\u6237\u7aef. \u52a0\u5bc6\u4e0e\u89e3\u5bc6: \u79c1\u94a5\u52a0\u5bc6\uff0c\u6301\u6709\u516c\u94a5\u624d\u53ef\u4ee5\u89e3\u5bc6 \u516c\u94a5\u52a0\u5bc6\uff0c\u6301\u6709\u79c1\u94a5\u624d\u53ef\u89e3\u5bc6 \u7b7e\u540d: \u79c1\u94a5\u7b7e\u540d, \u6301\u6709\u516c\u94a5\u8fdb\u884c\u9a8c\u8bc1\u662f\u5426\u88ab\u7be1\u6539\u8fc7. **\u4f18\u70b9: ** \u975e\u5bf9\u79f0\u52a0\u5bc6\u4e0e\u5bf9\u79f0\u52a0\u5bc6\u76f8\u6bd4\uff0c\u5176\u5b89\u5168\u6027\u66f4\u597d\uff1b \u7f3a\u70b9: \u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u7f3a\u70b9\u662f\u52a0\u5bc6\u548c\u89e3\u5bc6\u82b1\u8d39\u65f6\u95f4\u957f\u3001\u901f\u5ea6\u6162\uff0c\u53ea\u9002\u5408\u5bf9\u5c11\u91cf\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\u3002 \u7528\u9014\uff1a \u4e00\u822c\u7528\u4e8e\u7b7e\u540d\u548c\u8ba4\u8bc1\u3002\u79c1\u94a5\u670d\u52a1\u5668\u4fdd\u5b58, \u7528\u6765\u52a0\u5bc6, \u516c\u94a5\u5ba2\u6237\u62ff\u7740\u7528\u4e8e\u5bf9\u4e8e\u4ee4\u724c\u6216\u8005\u7b7e\u540d\u7684\u89e3\u5bc6\u6216\u8005\u6821\u9a8c\u4f7f\u7528. \u5e38\u89c1\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6709\uff1a RSA\u3001DSA\uff08\u6570\u5b57\u7b7e\u540d\u7528\uff09\u3001ECC\uff08\u79fb\u52a8\u8bbe\u5907\u7528\uff09\u3001RS256 (\u91c7\u7528SHA-256 \u7684 RSA \u7b7e\u540d)","title":"3.3 \u975e\u5bf9\u79f0\u52a0\u5bc6"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#34","text":"\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08\u6216\u5bf9\u79f0\u52a0\u5bc6\uff09\uff0c\u7ed9\u524d\u7aef\u4e00\u4e2a\u516c\u94a5\u8ba9\u4ed6\u628a\u6570\u636e\u52a0\u5bc6\u540e\u4f20\u5230\u540e\u53f0\uff0c\u540e\u53f0\u89e3\u5bc6\u540e\u5904\u7406\u6570\u636e \u4f20\u8f93\u7684\u6570\u636e\u5f88\u5927\u5efa\u8bae\u4f7f\u7528\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4e0d\u8fc7\u4e0d\u80fd\u4fdd\u5b58\u654f\u611f\u4fe1\u606f \u4f20\u8f93\u7684\u6570\u636e\u8f83\u5c0f\uff0c\u8981\u6c42\u5b89\u5168\u6027\u9ad8\uff0c\u5efa\u8bae\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6","title":"3.4 \u56de\u7b54\u8981\u70b9"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#4","text":"\u8fd9\u4e2a\u9762\u8bd5\u9898\u4e3b\u8981\u8003\u5bdf\u7684\u662f\uff0c \u4f60\u662f\u5426\u6709\u8fc7\u5f00\u53d1\u7ecf\u9a8c \u662f\u5426\u662f\u6838\u5fc3\u5f00\u53d1\u4eba\u5458 \u67094\u4e2a\u65b9\u9762\u53ef\u4ee5\u56de\u7b54\uff0c\u53ea\u8981\u6311\u51fa\u4e00\u4e2a\u56de\u7b54\u5c31\u884c\u4e86 \uff081\uff09\u8bbe\u8ba1\u6a21\u5f0f \u5de5\u5382\u6a21\u5f0f+\u7b56\u7565 \u8d23\u4efb\u94fe\u6a21\u5f0f \u56de\u7b54\u601d\u8def 1\uff0c\u4ec0\u4e48\u80cc\u666f\uff08\u6280\u672f\u95ee\u9898\uff09 2\uff0c\u8fc7\u7a0b\uff08\u89e3\u51b3\u95ee\u9898\u7684\u8fc7\u7a0b\uff09 3\uff0c\u6700\u7ec8\u843d\u5730\u65b9\u6848 \u4e3e\u4f8b\uff1a \u2460\uff1a\u4ecb\u7ecd\u767b\u5f55\u4e1a\u52a1\uff08\u4e00\u5f00\u59cb\u6ca1\u6709\u7528\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6240\u6709\u7684\u767b\u5f55\u65b9\u5f0f\u90fd\u67d4\u548c\u5728\u4e00\u4e2a\u4e1a\u52a1\u7c7b\u4e2d\uff0c\u4e0d\u8fc7\uff0c\u53d1\u73b0\u9700\u6c42\u7ecf\u5e38\u6539\uff09 \u2461\uff1a\u767b\u5f55\u65b9\u5f0f\u7ecf\u5e38\u4f1a\u589e\u52a0\u6216\u66f4\u6362\uff0c\u6bcf\u6b21\u90fd\u8981\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\uff0c\u6240\u4ee5\uff0c\u7ecf\u8fc7\u6211\u7684\u8bbe\u8ba1\uff0c\u4f7f\u7528\u4e86\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u548c\u7b56\u7565\u6a21\u5f0f\uff0c\u89e3\u51b3\u4e86\uff0c\u7ecf\u5e38\u4fee\u6539\u4e1a\u52a1\u5c42\u4ee3\u7801\u7684\u95ee\u9898 \u2462\uff1a\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u5de5\u5382\u6a21\u5f0f\u548c\u7b56\u7565\u6a21\u5f0f\uff08\u53c2\u8003\u524d\u9762\u8bbe\u8ba1\u6a21\u5f0f\u7684\u8bfe\u7a0b\uff09 \uff082\uff09\u7ebf\u4e0aBUG CPU\u98d9\u9ad8 \u5185\u5b58\u6cc4\u6f0f \u7ebf\u7a0b\u6b7b\u9501 .... \u56de\u7b54\u65b9\u5f0f\u53c2\u8003\u4e0a\u9762\u7684\u56de\u7b54\u601d\u8def\uff0c\u5177\u4f53\u95ee\u9898\u53ef\u4ee5\u53c2\u8003\u524d\u9762\u7684\u8bfe\u7a0b\uff08JVM\u548c\u591a\u7ebf\u7a0b\u76f8\u5173\u7684\u9762\u8bd5\u9898\uff09 \uff083\uff09\u8c03\u4f18 \u6162\u63a5\u53e3 \u6162SQL \u7f13\u5b58\u65b9\u6848 \uff084\uff09\u7ec4\u4ef6\u5c01\u88c5 \u5206\u5e03\u5f0f\u9501 \u63a5\u53e3\u5e42\u7b49 \u5206\u5e03\u5f0f\u4e8b\u52a1 \u652f\u4ed8\u901a\u7528","title":"4.\u4f60\u8d1f\u8d23\u9879\u76ee\u7684\u65f6\u5019\u9047\u5230\u4e86\u54ea\u4e9b\u6bd4\u8f83\u68d8\u624b\u7684\u95ee\u9898"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#5","text":"","title":"5.\u4f60\u4eec\u9879\u76ee\u4e2d\u65e5\u5fd7\u600e\u4e48\u91c7\u96c6\u7684"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#51","text":"1\uff0c\u4e3a\u4ec0\u4e48\u8981\u91c7\u96c6\u65e5\u5fd7\uff1f \u65e5\u5fd7\u662f\u5b9a\u4f4d\u7cfb\u7edf\u95ee\u9898\u7684\u91cd\u8981\u624b\u6bb5\uff0c\u53ef\u4ee5\u6839\u636e\u65e5\u5fd7\u4fe1\u606f\u5feb\u901f\u5b9a\u4f4d\u7cfb\u7edf\u4e2d\u7684\u95ee\u9898 2\uff0c\u91c7\u96c6\u65e5\u5fd7\u7684\u65b9\u5f0f\u6709\u54ea\u4e9b? ELK\uff1a\u5373Elasticsearch\u3001Logstash\u548cKibana\u4e09\u4e2a\u8f6f\u4ef6\u7684\u9996\u5b57\u6bcd \u5e38\u89c4\u91c7\u96c6\uff1a\u6309\u5929\u4fdd\u5b58\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6","title":"5.1 \u95ee\u9898"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#52-elk","text":"ELK\u5373Elasticsearch\u3001Logstash\u548cKibana\u4e09\u4e2a\u5f00\u6e90\u8f6f\u4ef6\u7684\u7f29\u5199 Elasticsearch Elasticsearch \u5168\u6587\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce\uff0c\u5bf9\u5927\u5bb9\u91cf\u7684\u6570\u636e\u8fdb\u884c\u63a5\u8fd1\u5b9e\u65f6\u7684\u5b58\u50a8\u3001\u641c\u7d22\u548c\u5206\u6790\u64cd\u4f5c\u3002 Logstash Logstash\u662f\u4e00\u4e2a\u6570\u636e\u6536\u96c6\u5f15\u64ce\uff0c\u5b83\u53ef\u4ee5\u52a8\u6001\u7684\u4ece\u5404\u79cd\u6570\u636e\u6e90\u641c\u96c6\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3001\u5206\u6790\u548c\u7edf\u4e00\u683c\u5f0f\u7b49\u64cd\u4f5c\uff0c\u5e76\u5c06\u8f93\u51fa\u7ed3\u679c\u5b58\u50a8\u5230\u6307\u5b9a\u4f4d\u7f6e\u4e0a Kibana Kibana\u662f\u4e00\u4e2a\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\uff0c\u901a\u5e38\u4e0eElasticsearch\u914d\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u5bf9\u5176\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u641c\u7d22\u3001\u5206\u6790\uff0c\u5e76\u4e14\u4ee5\u7edf\u8ba1\u56fe\u6807\u7684\u5f62\u5f0f\u5c55\u793a\u3002","title":"5.2 ELK\u57fa\u672c\u67b6\u6784"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#53","text":"\u6211\u4eec\u642d\u5efa\u4e86ELK\u65e5\u5fd7\u91c7\u96c6\u7cfb\u7edf \u4ecb\u7ecdELK\u7684\u4e09\u4e2a\u7ec4\u4ef6\uff1a Elasticsearch\u662f\u5168\u6587\u641c\u7d22\u5206\u6790\u5f15\u64ce\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u5b58\u50a8\u3001\u641c\u7d22\u3001\u5206\u6790 Logstash\u662f\u4e00\u4e2a\u6570\u636e\u6536\u96c6\u5f15\u64ce\uff0c\u53ef\u4ee5\u52a8\u6001\u6536\u96c6\u6570\u636e\uff0c\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3001\u5206\u6790\uff0c\u5c06\u6570\u636e\u5b58\u50a8\u5230\u6307\u5b9a\u7684\u4f4d\u7f6e Kibana\u662f\u4e00\u4e2a\u6570\u636e\u5206\u6790\u548c\u53ef\u89c6\u5316\u5e73\u53f0\uff0c\u914d\u5408Elasticsearch\u5bf9\u6570\u636e\u8fdb\u884c\u641c\u7d22\uff0c\u5206\u6790\uff0c\u56fe\u8868\u5316\u5c55\u793a","title":"5.3 \u53c2\u8003\u56de\u7b54"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#6","text":"\u76ee\u524d\u91c7\u96c6\u65e5\u5fd7\u7684\u65b9\u5f0f\uff1a\u6309\u5929\u4fdd\u5b58\u5230\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6 \u4e5f\u53ef\u4ee5\u5728logback\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u65e5\u5fd7\u7684\u76ee\u5f55\u548c\u540d\u5b57 \u9700\u8981\u638c\u63e1\u7684Linux\u4e2d\u7684\u65e5\u5fd7\uff1a \u5b9e\u65f6\u76d1\u63a7\u65e5\u5fd7\u7684\u53d8\u5316 \u5b9e\u65f6\u76d1\u63a7\u67d0\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u53d8\u5316\uff1atail -f xx.log\uff1b\u5b9e\u65f6\u76d1\u63a7\u65e5\u5fd7\u6700\u540e100\u884c\u65e5\u5fd7\uff1a tail \u2013n 100 -f xx.log \u6309\u7167\u884c\u53f7\u67e5\u8be2 \u67e5\u8be2\u65e5\u5fd7\u5c3e\u90e8\u6700\u540e100\u884c\u65e5\u5fd7\uff1atail \u2013 n 100 xx.log \u67e5\u8be2\u65e5\u5fd7\u5934\u90e8\u5f00\u59cb100\u884c\u65e5\u5fd7\uff1ahead \u2013n 100 xx.log \u67e5\u8be2\u67d0\u4e00\u4e2a\u65e5\u5fd7\u884c\u53f7\u533a\u95f4\uff1acat -n xx.log | tail -n +100 | head -n 100 (\u67e5\u8be2100\u884c\u81f3200\u884c\u7684\u65e5\u5fd7) \u6309\u7167\u5173\u952e\u5b57\u627e\u65e5\u5fd7\u7684\u4fe1\u606f \u67e5\u8be2\u65e5\u5fd7\u6587\u4ef6\u4e2d\u5305\u542bdebug\u7684\u65e5\u5fd7\u884c\u53f7\uff1acat -n xx.log | grep \"debug\" \u6309\u7167\u65e5\u671f\u67e5\u8be2 sed -n '/2023-05-18 14:22:31.070/,/ 2023-05-18 14:27:14.158/p\u2019xx.log \u65e5\u5fd7\u592a\u591a\uff0c\u5904\u7406\u65b9\u5f0f \u5206\u9875\u67e5\u8be2\u65e5\u5fd7\u4fe1\u606f\uff1acat -n xx.log |grep \"debug\" | more \u7b5b\u9009\u8fc7\u6ee4\u4ee5\u540e\uff0c\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\uff1acat -n xx.log | grep \"debug\" >debug.txt","title":"6.\u67e5\u770b\u65e5\u5fd7\u7684\u547d\u4ee4"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#7","text":"\u5df2\u7ecf\u4e0a\u7ebf\u7684bug\u6392\u67e5\u7684\u601d\u8def\uff1a 1\uff0c\u5148\u5206\u6790\u65e5\u5fd7\uff0c\u901a\u5e38\u5728\u4e1a\u52a1\u4e2d\u90fd\u4f1a\u6709\u65e5\u5fd7\u7684\u8bb0\u5f55\uff0c\u6216\u8005\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff0c\u6216\u8005\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\uff0c\u7136\u540e\u5b9a\u4f4d\u95ee\u9898 2\uff0c\u8fdc\u7a0bdebug(\u901a\u5e38\u516c\u53f8\u7684\u6b63\u5f0f\u73af\u5883\uff08\u751f\u4ea7\u73af\u5883\uff09\u662f\u4e0d\u5141\u8bb8\u8fdc\u7a0bdebug\u7684\u3002\u4e00\u822c\u8fdc\u7a0bdebug\u90fd\u662f\u516c\u53f8\u7684\u6d4b\u8bd5\u73af\u5883\uff0c\u65b9\u4fbf\u8c03\u8bd5\u4ee3\u7801) \u8fdc\u7a0bdebug\u914d\u7f6e \u524d\u63d0\u6761\u4ef6\uff1a \u8fdc\u7a0b\u7684\u4ee3\u7801\u548c\u672c\u5730\u7684\u4ee3\u7801\u8981\u4fdd\u6301\u4e00\u81f4 1.\u8fdc\u7a0b\u4ee3\u7801\u9700\u8981\u914d\u7f6e\u542f\u52a8\u53c2\u6570\uff0c\u628a\u9879\u76ee\u6253\u5305\u653e\u5230\u670d\u52a1\u5668\u540e\u542f\u52a8\u9879\u76ee\u7684\u53c2\u6570\uff1a java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 project-1.0-SNAPSHOT.jar -agentlib:jdwp \u662f\u901a\u77e5JVM\u4f7f\u7528(java debug wire protocol)\u6765\u8fd0\u884c\u8c03\u8bd5\u73af\u5883 transport=dt_socket \u8c03\u8bd5\u6570\u636e\u7684\u4f20\u9001\u65b9\u5f0f server=y \u53c2\u6570\u662f\u6307\u662f\u5426\u652f\u6301\u5728server\u6a21\u5f0f suspend=n \u662f\u5426\u5728\u8c03\u8bd5\u5ba2\u6237\u7aef\u5efa\u7acb\u8d77\u6765\u540e\uff0c\u518d\u6267\u884cJVM\u3002 address=5005 \u8c03\u8bd5\u7aef\u53e3\u8bbe\u7f6e\u4e3a5005\uff0c\u5176\u5b83\u7aef\u53e3\u4e5f\u53ef\u4ee5 2.idea\u4e2d\u8bbe\u7f6e\u8fdc\u7a0bdebug\uff0c\u627e\u5230idea\u4e2d\u7684 Edit Configurations... idea\u4e2d\u542f\u52a8\u8fdc\u7a0bdebug \u8bbf\u95ee\u8fdc\u7a0b\u670d\u52a1\u5668\uff0c\u5728\u672c\u5730\u4ee3\u7801\u4e2d\u6253\u65ad\u70b9\u5373\u53ef\u8c03\u8bd5\u8fdc\u7a0b","title":"7.\u751f\u4ea7\u95ee\u9898\u600e\u4e48\u6392\u67e5"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/02-%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/%E5%B8%B8%E8%A7%81%E6%8A%80%E6%9C%AF%E5%9C%BA%E6%99%AF/#8","text":"\u538b\u6d4b\uff08\u6027\u80fd\u6d4b\u8bd5\uff09\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u524d\u6d4b\u8bc4\u7cfb\u7edf\u7684\u538b\u529b \u538b\u6d4b\u76ee\u7684\uff1a\u7ed9\u51fa\u7cfb\u7edf\u5f53\u524d\u7684\u6027\u80fd\u72b6\u51b5\uff1b\u5b9a\u4f4d\u7cfb\u7edf\u6027\u80fd\u74f6\u9888\u6216\u6f5c\u5728\u6027\u80fd\u74f6\u9888 \u6307\u6807\uff1a\u54cd\u5e94\u65f6\u95f4\u3001 QPS\u3001\u5e76\u53d1\u6570\u3001\u541e\u5410\u91cf\u3001 CPU\u5229\u7528\u7387\u3001\u5185\u5b58\u4f7f\u7528\u7387\u3001\u78c1\u76d8IO\u3001\u9519\u8bef\u7387 \u538b\u6d4b\u5de5\u5177\uff1aLoadRunner\u3001Apache Jmeter \u2026 \u540e\u7aef\u5de5\u7a0b\u5e08\uff1a\u6839\u636e\u538b\u6d4b\u7684\u7ed3\u679c\u8fdb\u884c\u89e3\u51b3\u6216\u8c03\u4f18\uff08\u63a5\u53e3\u6162\u3001\u4ee3\u7801\u62a5\u9519\u3001\u5e76\u53d1\u8fbe\u4e0d\u5230\u8981\u6c42\u2026\uff09 \u76d1\u63a7\u5de5\u5177\u3001\u94fe\u8def\u8ffd\u8e2a\u5de5\u5177\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u540e\u76d1\u63a7 \u76d1\u63a7\u5de5\u5177\uff1aPrometheus+Grafana \u94fe\u8def\u8ffd\u8e2a\u5de5\u5177\uff1askywalking\u3001Zipkin \u7ebf\u4e0a\u8bca\u65ad\u5de5\u5177Arthas(\u963f\u5c14\u8428\u65af)\uff0c\u9879\u76ee\u4e0a\u7ebf\u4e4b\u540e\u76d1\u63a7\u3001\u6392\u67e5 \u5b98\u7f51\uff1ahttps://arthas.aliyun.com/ \u6838\u5fc3\u529f\u80fd\uff1a","title":"8.\u600e\u4e48\u5feb\u901f\u5b9a\u4f4d\u7cfb\u7edf\u7684\u74f6\u9888"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/","text":"ELK\u642d\u5efa \u524d\u8a00 1.\u9700\u8981\u51c6\u5907\u4e00\u53f0linux\u670d\u52a1\u5668\uff08\u6700\u597d\u662fCentOS7\uff09,\u5185\u5b58\u81f3\u5c114g\u4ee5\u4e0a\uff08\u4e09\u4e2a\u7ec4\u4ef6\u90fd\u6bd4\u8f83\u5360\u7528\u5185\u5b58\uff09 2.\u9700\u8981\u6709docker\u4f7f\u7528\u7ecf\u9a8c 1 docker\u5b89\u88c5ElasticSearch \u8fd9\u91cc\u5148\u521b\u5efa\u4e00\u4e2a\u7f51\u7edc\uff1a\u56e0\u4e3a\u6211\u4eec\u8fd8\u9700\u8981\u90e8\u7f72kibana\u5bb9\u5668\u3001logstash\u5bb9\u5668\uff0c\u9700\u8981\u8ba9\u8fd9\u4e9b\u5bb9\u5668\u4e92\u8054\u3002 docker network create elk-net \u8fd9\u91ccElasticSearch\u91c7\u7528\u7684\u662f7.12.1\u7248\u672c \u5728docker\u4e2d\u641c\u7d22\u548c\u4e0b\u8f7d\u5bf9\u5e94\u7684\u955c\u50cf #\u641c\u7d22\u955c\u50cf docker search elasticsearch #\u4e0b\u8f7d\u955c\u50cf docker pull elasticsearch:7.12.1 \u6709\u4e86\u955c\u50cf\u4ee5\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u5bf9\u5e94\u7684\u5bb9\u5668\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a docker run -d \\ --name es \\ -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\ -e \"discovery.type=single-node\" \\ -v es-data:/usr/share/elasticsearch/data \\ -v es-plugins:/usr/share/elasticsearch/plugins \\ --privileged \\ --network elk-net \\ -p 9200:9200 \\ -p 9300:9300 \\ elasticsearch:7.12.1 \u547d\u4ee4\u89e3\u91ca\uff1a -e \"cluster.name=es-docker-cluster\" \uff1a\u8bbe\u7f6e\u96c6\u7fa4\u540d\u79f0 -e \"http.host=0.0.0.0\" \uff1a\u76d1\u542c\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u5916\u7f51\u8bbf\u95ee -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \uff1a\u5185\u5b58\u5927\u5c0f -e \"discovery.type=single-node\" \uff1a\u975e\u96c6\u7fa4\u6a21\u5f0f -v es-data:/usr/share/elasticsearch/data \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u6570\u636e\u76ee\u5f55 -v es-logs:/usr/share/elasticsearch/logs \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u65e5\u5fd7\u76ee\u5f55 -v es-plugins:/usr/share/elasticsearch/plugins \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u63d2\u4ef6\u76ee\u5f55 --privileged \uff1a\u6388\u4e88\u903b\u8f91\u5377\u8bbf\u95ee\u6743 --network elk-net \uff1a\u52a0\u5165\u4e00\u4e2a\u540d\u4e3aes-net\u7684\u7f51\u7edc\u4e2d -p 9200:9200 \uff1a\u7aef\u53e3\u6620\u5c04\u914d\u7f6e \u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\uff1ahttp://192.168.200.130:9200 (\u6309\u7167\u81ea\u5df1\u7684ip\u8bbf\u95ee)\u5373\u53ef\u770b\u5230elasticsearch\u7684\u54cd\u5e94\u7ed3\u679c\uff1a 2 docker\u5b89\u88c5kibana \u521b\u5efa\u5bb9\u5668(\u5982\u679c\u4e0d\u63d0\u524d\u4e0b\u8f7d\u597d\uff0c\u5728\u521b\u5efa\u5bb9\u5668\u65f6\uff0c\u4f1a\u5148\u4e0b\u8f7d\uff0c\u7136\u540e\u521b\u5efa\u5bb9\u5668) docker run -d \\ --name kibana \\ -e ELASTICSEARCH_HOSTS=http://es:9200 \\ -e \"I18N_LOCALE=zh-CN\" \\ --network=elk-net \\ -p 5601:5601 \\ kibana:7.12.1 --network elk-net \uff1a\u52a0\u5165\u4e00\u4e2a\u540d\u4e3aes-net\u7684\u7f51\u7edc\u4e2d\uff0c\u4e0eelasticsearch\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e2d -e ELASTICSEARCH_HOSTS=http://es:9200\" \uff1a\u8bbe\u7f6eelasticsearch\u7684\u5730\u5740\uff0c\u56e0\u4e3akibana\u5df2\u7ecf\u4e0eelasticsearch\u5728\u4e00\u4e2a\u7f51\u7edc\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u5bb9\u5668\u540d\u76f4\u63a5\u8bbf\u95eeelasticsearch -p 5601:5601 \uff1a\u7aef\u53e3\u6620\u5c04\u914d\u7f6e \u6b64\u65f6\uff0c\u5728\u6d4f\u89c8\u5668\u8f93\u5165\u5730\u5740\u8bbf\u95ee\uff1ahttp://192.168.200.130:5601\uff0c\u5373\u53ef\u770b\u5230\u7ed3\u679c 3 docker\u5b89\u88c5logstash 3.1 \u521b\u5efa\u5bb9\u5668 docker run -d -p 5044:5044 -p 9600:9600 --name logstash --network=elk-net logstash:7.12.1 3.2 \u4fee\u6539\u914d\u7f6e 3.2.1 \u8bbe\u7f6eES\u7684\u5730\u5740 \u521b\u5efa\u5b8c\u5bb9\u5668\u4e4b\u540e\uff0c\u9700\u8981\u5728\u5bb9\u5668\u4fee\u6539\u4e00\u4e9b\u914d\u7f6e #\u8fdb\u5165\u5bb9\u5668 docker exec -it logstash /bin/bash \u627e\u5230config\u76ee\u5f55\u4e2d\u7684logstatsh.yml\u6587\u4ef6 \u4fee\u6539\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u8bbe\u7f6ees\u670d\u52a1\u7684\u5730\u5740\uff0c\u5982\u4e0b http.host: \"0.0.0.0\" xpack.monitoring.elasticsearch.hosts: [ \"http://192.168.200.130:9200\" ] #\u8bbe\u7f6e\u8ddfes\u7684\u670d\u52a1\u5730\u5740 3.2.2 \u8bbe\u7f6elogstash\u6536\u96c6\u65e5\u5fd7\u7684\u8f93\u5165\u548c\u8f93\u51fa \u8fdb\u5165\u5bb9\u5668 #\u8fdb\u5165\u5bb9\u5668 docker exec -it logstash /bin/bash \u627e\u5230pipeline\u76ee\u5f55\u4e2d\u7684logstatsh.conf\u6587\u4ef6 \u4fee\u6539\u5982\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6570\u636e\u8f93\u5165\u7684\u65b9\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u628a\u6570\u636e\u5b58\u653e\u5230\u54ea\u91cc input { tcp { mode => \"server\" host => \"0.0.0.0\" # \u5141\u8bb8\u4efb\u610f\u4e3b\u673a\u53d1\u9001\u65e5\u5fd7 port => 5044 codec => json_lines # \u6570\u636e\u683c\u5f0f } } output { elasticsearch { hosts => [\"http://192.168.200.130:9200\"] # ElasticSearch \u7684\u5730\u5740\u548c\u7aef\u53e3 index => \"log-%{+YYYY.MM.dd}\" # \u6307\u5b9a\u7d22\u5f15\u540d,\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u6307\u5b9a\u547d\u540d codec => \"json\" } stdout { codec => rubydebug } } \u4fee\u6539\u5b8c\u6240\u6709\u7684\u914d\u7f6e\u540e\uff0c\u9700\u8981\u91cd\u542flogstash\u5bb9\u5668 docker restart logstash 4 \u5e94\u7528\u7cfb\u7edf\u5bf9\u63a5logstash \u5728\u9879\u76ee\u7684pom\u6587\u4ef6\u4e2d\u6dfb\u52a0\u65b0\u7684\u4f9d\u8d56 <dependency> <groupId>net.logstash.logback</groupId> <artifactId>logstash-logback-encoder</artifactId> <version>6.6</version> </dependency> \u76ee\u524d\uff0c\u6211\u4eec\u91c7\u7528\u7684logback\u6765\u91c7\u96c6\u65e5\u5fd7\u8fdb\u884c\u4e0a\u62a5\u7ed9logstash \u9700\u8981\u5728resources\u76ee\u5f55\u4e2d\u65b0\u589e\u4e00\u4e2a\u6587\u4ef6logback-spring.xml(\u6ce8\u610f\u547d\u540d\uff0c\u4e0d\u8981\u4fee\u6539) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <configuration> <include resource=\"org/springframework/boot/logging/logback/base.xml\" /> <springProperty scope=\"context\" name=\"springAppName\" source=\"spring.application.name\"/> <springProperty scope=\"context\" name=\"serverPort\" source=\"server.port\"/> <appender name=\"LOGSTASH\" class=\"net.logstash.logback.appender.LogstashTcpSocketAppender\"> <!--logstash\u7684\u670d\u52a1\u5730\u5740\u548c\u7aef\u53e3\uff0c\u53ef\u4ee5\u5b9e\u9645\u60c5\u51b5\u8bbe\u7f6e--> <destination>192.168.200.130:5044</destination> <!-- \u65e5\u5fd7\u8f93\u51fa\u7f16\u7801 --> <encoder charset=\"UTF-8\" class=\"net.logstash.logback.encoder.LogstashEncoder\"> <providers> <timestamp> <timeZone>UTC</timeZone> </timestamp> <pattern> <pattern> { <!--\u5e94\u7528\u540d\u79f0 --> \"app\": \"${springAppName}_${serverPort}\", <!--\u6253\u5370\u65f6\u95f4 --> \"timestamp\": \"%d{yyyy-MM-dd HH:mm:ss.SSS}\", <!--\u7ebf\u7a0b\u540d\u79f0 --> \"thread\": \"%thread\", <!--\u65e5\u5fd7\u7ea7\u522b --> \"level\": \"%level\", <!--\u65e5\u5fd7\u540d\u79f0 --> \"logger_name\": \"%logger\", <!--\u65e5\u5fd7\u4fe1\u606f --> \"message\": \"%msg\", <!--\u65e5\u5fd7\u5806\u6808 --> \"stack_trace\": \"%exception\" } </pattern> </pattern> </providers> </encoder> </appender> <!--\u5b9a\u4e49\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u50a8\u5730\u5740,\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84--> <property name=\"LOG_HOME\" value=\"/home/logs\"/> <!-- \u6309\u7167\u6bcf\u5929\u751f\u6210\u65e5\u5fd7\u6587\u4ef6 --> <appender name=\"FILE\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"> <rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"> <!--\u65e5\u5fd7\u6587\u4ef6\u8f93\u51fa\u7684\u6587\u4ef6\u540d--> <fileNamePattern>${LOG_HOME}/${springAppName}-${serverPort}-%d{yyyy-MM-dd}.log</fileNamePattern> </rollingPolicy> <encoder> <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern> </encoder> </appender> <root level=\"INFO\"> <appender-ref ref=\"LOGSTASH\" /> <appender-ref ref=\"FILE\" /> <appender-ref ref=\"CONSOLE\" /> </root> </configuration> \u4e5f\u53ef\u4ee5\u5728\u4e13\u95e8\u5728application.yml\u6587\u4ef6\u4e2d\u8bbe\u7f6elogback\u914d\u7f6e\u7684\u76ee\u5f55 logging: config: classpath:logback-spring.xml 5 ELK\u57fa\u672c\u4f7f\u7528 5.1 \u67e5\u770b\u7d22\u5f15\u6587\u4ef6 \u5bf9\u63a5\u9879\u76ee\u4e4b\u540e\uff0c\u53ef\u4ee5\u542f\u52a8\u9879\u76ee\uff0c\u4ea7\u751f\u4e00\u4e9b\u65e5\u5fd7\u6570\u636e \u7136\u540e\u6253\u5f00kibana\uff0c\u627e\u5230\u7d22\u5f15\u7ba1\u7406 \u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u5df2\u521b\u5efa\u7684\u65e5\u5fd7\u7d22\u5f15 5.2 \u6dfb\u52a0\u7d22\u5f15\u6a21\u5f0f \u5982\u679c\u60f3\u7528kibana\u65b9\u4fbf\u7684\u67e5\u770b\u65e5\u5fd7\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u6dfb\u52a0\u7d22\u5f15\u6a21\u5f0f\uff0c\u5982\u4e0b\u56fe \u70b9\u51fb\u521b\u5efa\u7d22\u5f15\u6a21\u5f0f\uff0c\u8f93\u5165\u60f3\u8981\u7ba1\u7406\u7684\u7d22\u5f15\u540d\u79f0 \u70b9\u51fb\u4e0b\u4e00\u6b65\uff0c\u6dfb\u52a0\u7b5b\u9009\u7684\u5b57\u6bb5\uff0c\u4e00\u822c\u90fd\u662f\u65f6\u95f4\u6233\u5b57\u6bb5\uff0c\u6700\u540e\u70b9\u51fb\u521b\u5efa\u7d22\u5f15\u6a21\u5f0f 5.3 \u68c0\u7d22\u65e5\u5fd7 \u6253\u5f00Discover \u68c0\u7d22\u65e5\u5fd7\uff0c\u9009\u62e9\u4e0d\u540c\u7684\u7d22\u5f15\uff0c\u53ef\u4ee5\u6309\u7167\u4e0d\u540c\u7684\u5b57\u6bb5\u68c0\u7d22\uff0c\u6216\u8005\u5728\u8f93\u5165\u6846\u76f4\u63a5\u8f93\u5165\u5185\u5bb9\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684","title":"ELK\u642d\u5efa"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#elk","text":"","title":"ELK\u642d\u5efa"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#_1","text":"1.\u9700\u8981\u51c6\u5907\u4e00\u53f0linux\u670d\u52a1\u5668\uff08\u6700\u597d\u662fCentOS7\uff09,\u5185\u5b58\u81f3\u5c114g\u4ee5\u4e0a\uff08\u4e09\u4e2a\u7ec4\u4ef6\u90fd\u6bd4\u8f83\u5360\u7528\u5185\u5b58\uff09 2.\u9700\u8981\u6709docker\u4f7f\u7528\u7ecf\u9a8c","title":"\u524d\u8a00"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#1-dockerelasticsearch","text":"\u8fd9\u91cc\u5148\u521b\u5efa\u4e00\u4e2a\u7f51\u7edc\uff1a\u56e0\u4e3a\u6211\u4eec\u8fd8\u9700\u8981\u90e8\u7f72kibana\u5bb9\u5668\u3001logstash\u5bb9\u5668\uff0c\u9700\u8981\u8ba9\u8fd9\u4e9b\u5bb9\u5668\u4e92\u8054\u3002 docker network create elk-net \u8fd9\u91ccElasticSearch\u91c7\u7528\u7684\u662f7.12.1\u7248\u672c \u5728docker\u4e2d\u641c\u7d22\u548c\u4e0b\u8f7d\u5bf9\u5e94\u7684\u955c\u50cf #\u641c\u7d22\u955c\u50cf docker search elasticsearch #\u4e0b\u8f7d\u955c\u50cf docker pull elasticsearch:7.12.1 \u6709\u4e86\u955c\u50cf\u4ee5\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u5bf9\u5e94\u7684\u5bb9\u5668\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a docker run -d \\ --name es \\ -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\ -e \"discovery.type=single-node\" \\ -v es-data:/usr/share/elasticsearch/data \\ -v es-plugins:/usr/share/elasticsearch/plugins \\ --privileged \\ --network elk-net \\ -p 9200:9200 \\ -p 9300:9300 \\ elasticsearch:7.12.1 \u547d\u4ee4\u89e3\u91ca\uff1a -e \"cluster.name=es-docker-cluster\" \uff1a\u8bbe\u7f6e\u96c6\u7fa4\u540d\u79f0 -e \"http.host=0.0.0.0\" \uff1a\u76d1\u542c\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u5916\u7f51\u8bbf\u95ee -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \uff1a\u5185\u5b58\u5927\u5c0f -e \"discovery.type=single-node\" \uff1a\u975e\u96c6\u7fa4\u6a21\u5f0f -v es-data:/usr/share/elasticsearch/data \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u6570\u636e\u76ee\u5f55 -v es-logs:/usr/share/elasticsearch/logs \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u65e5\u5fd7\u76ee\u5f55 -v es-plugins:/usr/share/elasticsearch/plugins \uff1a\u6302\u8f7d\u903b\u8f91\u5377\uff0c\u7ed1\u5b9aes\u7684\u63d2\u4ef6\u76ee\u5f55 --privileged \uff1a\u6388\u4e88\u903b\u8f91\u5377\u8bbf\u95ee\u6743 --network elk-net \uff1a\u52a0\u5165\u4e00\u4e2a\u540d\u4e3aes-net\u7684\u7f51\u7edc\u4e2d -p 9200:9200 \uff1a\u7aef\u53e3\u6620\u5c04\u914d\u7f6e \u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165\uff1ahttp://192.168.200.130:9200 (\u6309\u7167\u81ea\u5df1\u7684ip\u8bbf\u95ee)\u5373\u53ef\u770b\u5230elasticsearch\u7684\u54cd\u5e94\u7ed3\u679c\uff1a","title":"1 docker\u5b89\u88c5ElasticSearch"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#2-dockerkibana","text":"\u521b\u5efa\u5bb9\u5668(\u5982\u679c\u4e0d\u63d0\u524d\u4e0b\u8f7d\u597d\uff0c\u5728\u521b\u5efa\u5bb9\u5668\u65f6\uff0c\u4f1a\u5148\u4e0b\u8f7d\uff0c\u7136\u540e\u521b\u5efa\u5bb9\u5668) docker run -d \\ --name kibana \\ -e ELASTICSEARCH_HOSTS=http://es:9200 \\ -e \"I18N_LOCALE=zh-CN\" \\ --network=elk-net \\ -p 5601:5601 \\ kibana:7.12.1 --network elk-net \uff1a\u52a0\u5165\u4e00\u4e2a\u540d\u4e3aes-net\u7684\u7f51\u7edc\u4e2d\uff0c\u4e0eelasticsearch\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e2d -e ELASTICSEARCH_HOSTS=http://es:9200\" \uff1a\u8bbe\u7f6eelasticsearch\u7684\u5730\u5740\uff0c\u56e0\u4e3akibana\u5df2\u7ecf\u4e0eelasticsearch\u5728\u4e00\u4e2a\u7f51\u7edc\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u5bb9\u5668\u540d\u76f4\u63a5\u8bbf\u95eeelasticsearch -p 5601:5601 \uff1a\u7aef\u53e3\u6620\u5c04\u914d\u7f6e \u6b64\u65f6\uff0c\u5728\u6d4f\u89c8\u5668\u8f93\u5165\u5730\u5740\u8bbf\u95ee\uff1ahttp://192.168.200.130:5601\uff0c\u5373\u53ef\u770b\u5230\u7ed3\u679c","title":"2 docker\u5b89\u88c5kibana"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#3-dockerlogstash","text":"","title":"3 docker\u5b89\u88c5logstash"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#31","text":"docker run -d -p 5044:5044 -p 9600:9600 --name logstash --network=elk-net logstash:7.12.1","title":"3.1 \u521b\u5efa\u5bb9\u5668"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#32","text":"","title":"3.2 \u4fee\u6539\u914d\u7f6e"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#321-es","text":"\u521b\u5efa\u5b8c\u5bb9\u5668\u4e4b\u540e\uff0c\u9700\u8981\u5728\u5bb9\u5668\u4fee\u6539\u4e00\u4e9b\u914d\u7f6e #\u8fdb\u5165\u5bb9\u5668 docker exec -it logstash /bin/bash \u627e\u5230config\u76ee\u5f55\u4e2d\u7684logstatsh.yml\u6587\u4ef6 \u4fee\u6539\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u8bbe\u7f6ees\u670d\u52a1\u7684\u5730\u5740\uff0c\u5982\u4e0b http.host: \"0.0.0.0\" xpack.monitoring.elasticsearch.hosts: [ \"http://192.168.200.130:9200\" ] #\u8bbe\u7f6e\u8ddfes\u7684\u670d\u52a1\u5730\u5740","title":"3.2.1 \u8bbe\u7f6eES\u7684\u5730\u5740"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#322-logstash","text":"\u8fdb\u5165\u5bb9\u5668 #\u8fdb\u5165\u5bb9\u5668 docker exec -it logstash /bin/bash \u627e\u5230pipeline\u76ee\u5f55\u4e2d\u7684logstatsh.conf\u6587\u4ef6 \u4fee\u6539\u5982\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6570\u636e\u8f93\u5165\u7684\u65b9\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u628a\u6570\u636e\u5b58\u653e\u5230\u54ea\u91cc input { tcp { mode => \"server\" host => \"0.0.0.0\" # \u5141\u8bb8\u4efb\u610f\u4e3b\u673a\u53d1\u9001\u65e5\u5fd7 port => 5044 codec => json_lines # \u6570\u636e\u683c\u5f0f } } output { elasticsearch { hosts => [\"http://192.168.200.130:9200\"] # ElasticSearch \u7684\u5730\u5740\u548c\u7aef\u53e3 index => \"log-%{+YYYY.MM.dd}\" # \u6307\u5b9a\u7d22\u5f15\u540d,\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u6307\u5b9a\u547d\u540d codec => \"json\" } stdout { codec => rubydebug } } \u4fee\u6539\u5b8c\u6240\u6709\u7684\u914d\u7f6e\u540e\uff0c\u9700\u8981\u91cd\u542flogstash\u5bb9\u5668 docker restart logstash","title":"3.2.2 \u8bbe\u7f6elogstash\u6536\u96c6\u65e5\u5fd7\u7684\u8f93\u5165\u548c\u8f93\u51fa"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#4-logstash","text":"\u5728\u9879\u76ee\u7684pom\u6587\u4ef6\u4e2d\u6dfb\u52a0\u65b0\u7684\u4f9d\u8d56 <dependency> <groupId>net.logstash.logback</groupId> <artifactId>logstash-logback-encoder</artifactId> <version>6.6</version> </dependency> \u76ee\u524d\uff0c\u6211\u4eec\u91c7\u7528\u7684logback\u6765\u91c7\u96c6\u65e5\u5fd7\u8fdb\u884c\u4e0a\u62a5\u7ed9logstash \u9700\u8981\u5728resources\u76ee\u5f55\u4e2d\u65b0\u589e\u4e00\u4e2a\u6587\u4ef6logback-spring.xml(\u6ce8\u610f\u547d\u540d\uff0c\u4e0d\u8981\u4fee\u6539) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <configuration> <include resource=\"org/springframework/boot/logging/logback/base.xml\" /> <springProperty scope=\"context\" name=\"springAppName\" source=\"spring.application.name\"/> <springProperty scope=\"context\" name=\"serverPort\" source=\"server.port\"/> <appender name=\"LOGSTASH\" class=\"net.logstash.logback.appender.LogstashTcpSocketAppender\"> <!--logstash\u7684\u670d\u52a1\u5730\u5740\u548c\u7aef\u53e3\uff0c\u53ef\u4ee5\u5b9e\u9645\u60c5\u51b5\u8bbe\u7f6e--> <destination>192.168.200.130:5044</destination> <!-- \u65e5\u5fd7\u8f93\u51fa\u7f16\u7801 --> <encoder charset=\"UTF-8\" class=\"net.logstash.logback.encoder.LogstashEncoder\"> <providers> <timestamp> <timeZone>UTC</timeZone> </timestamp> <pattern> <pattern> { <!--\u5e94\u7528\u540d\u79f0 --> \"app\": \"${springAppName}_${serverPort}\", <!--\u6253\u5370\u65f6\u95f4 --> \"timestamp\": \"%d{yyyy-MM-dd HH:mm:ss.SSS}\", <!--\u7ebf\u7a0b\u540d\u79f0 --> \"thread\": \"%thread\", <!--\u65e5\u5fd7\u7ea7\u522b --> \"level\": \"%level\", <!--\u65e5\u5fd7\u540d\u79f0 --> \"logger_name\": \"%logger\", <!--\u65e5\u5fd7\u4fe1\u606f --> \"message\": \"%msg\", <!--\u65e5\u5fd7\u5806\u6808 --> \"stack_trace\": \"%exception\" } </pattern> </pattern> </providers> </encoder> </appender> <!--\u5b9a\u4e49\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u50a8\u5730\u5740,\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84--> <property name=\"LOG_HOME\" value=\"/home/logs\"/> <!-- \u6309\u7167\u6bcf\u5929\u751f\u6210\u65e5\u5fd7\u6587\u4ef6 --> <appender name=\"FILE\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"> <rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"> <!--\u65e5\u5fd7\u6587\u4ef6\u8f93\u51fa\u7684\u6587\u4ef6\u540d--> <fileNamePattern>${LOG_HOME}/${springAppName}-${serverPort}-%d{yyyy-MM-dd}.log</fileNamePattern> </rollingPolicy> <encoder> <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern> </encoder> </appender> <root level=\"INFO\"> <appender-ref ref=\"LOGSTASH\" /> <appender-ref ref=\"FILE\" /> <appender-ref ref=\"CONSOLE\" /> </root> </configuration> \u4e5f\u53ef\u4ee5\u5728\u4e13\u95e8\u5728application.yml\u6587\u4ef6\u4e2d\u8bbe\u7f6elogback\u914d\u7f6e\u7684\u76ee\u5f55 logging: config: classpath:logback-spring.xml","title":"4 \u5e94\u7528\u7cfb\u7edf\u5bf9\u63a5logstash"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#5-elk","text":"","title":"5 ELK\u57fa\u672c\u4f7f\u7528"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#51","text":"\u5bf9\u63a5\u9879\u76ee\u4e4b\u540e\uff0c\u53ef\u4ee5\u542f\u52a8\u9879\u76ee\uff0c\u4ea7\u751f\u4e00\u4e9b\u65e5\u5fd7\u6570\u636e \u7136\u540e\u6253\u5f00kibana\uff0c\u627e\u5230\u7d22\u5f15\u7ba1\u7406 \u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u5df2\u521b\u5efa\u7684\u65e5\u5fd7\u7d22\u5f15","title":"5.1 \u67e5\u770b\u7d22\u5f15\u6587\u4ef6"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#52","text":"\u5982\u679c\u60f3\u7528kibana\u65b9\u4fbf\u7684\u67e5\u770b\u65e5\u5fd7\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u6dfb\u52a0\u7d22\u5f15\u6a21\u5f0f\uff0c\u5982\u4e0b\u56fe \u70b9\u51fb\u521b\u5efa\u7d22\u5f15\u6a21\u5f0f\uff0c\u8f93\u5165\u60f3\u8981\u7ba1\u7406\u7684\u7d22\u5f15\u540d\u79f0 \u70b9\u51fb\u4e0b\u4e00\u6b65\uff0c\u6dfb\u52a0\u7b5b\u9009\u7684\u5b57\u6bb5\uff0c\u4e00\u822c\u90fd\u662f\u65f6\u95f4\u6233\u5b57\u6bb5\uff0c\u6700\u540e\u70b9\u51fb\u521b\u5efa\u7d22\u5f15\u6a21\u5f0f","title":"5.2 \u6dfb\u52a0\u7d22\u5f15\u6a21\u5f0f"},{"location":"heimajava/10-%E4%BC%81%E4%B8%9A%E5%9C%BA%E6%99%AF%E7%AF%87/ELK%E6%90%AD%E5%BB%BA/ELK%E6%90%AD%E5%BB%BA/#53","text":"\u6253\u5f00Discover \u68c0\u7d22\u65e5\u5fd7\uff0c\u9009\u62e9\u4e0d\u540c\u7684\u7d22\u5f15\uff0c\u53ef\u4ee5\u6309\u7167\u4e0d\u540c\u7684\u5b57\u6bb5\u68c0\u7d22\uff0c\u6216\u8005\u5728\u8f93\u5165\u6846\u76f4\u63a5\u8f93\u5165\u5185\u5bb9\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684","title":"5.3 \u68c0\u7d22\u65e5\u5fd7"},{"location":"redis/","text":"\u5b66 Redis","title":"\u5b66 Redis"},{"location":"redis/#redis","text":"","title":"\u5b66 Redis"},{"location":"redis/redis-langfei/","text":"\u8f6c\u81ea\uff1a \u6d6a\u98deyes - Redis\u6781\u7b80\u5165\u95e8\uff1a\u7eaf\u5c0f\u767d\u6210\u957f\u4e3a\u5927\u767d\uff0c\u53ea\u97004\u4e2a\u534a\u5c0f\u65f6~ \u6559\u5b66\u76ee\u6807 1>\u4e86\u89e3NoSQL\u6982\u5ff5 2>\u4e86\u89e3Redis\u6982\u5ff5\uff0c\u5b9a\u4f4d\uff0c\u4f18\u70b9\uff0c\u7f3a\u70b9 3>\u638c\u63e1Redis\u5e38\u7528\u4e94\u5927\u7c7b\u578b 4>\u638c\u63e1Redis Key \u4e0eValue\u503c\u8bbe\u8ba1 5>\u638c\u63e1Redis\u5168\u5c40\u547d\u4ee4 6>\u638c\u63e1Redis \u5b89\u5168\u4e0e\u4e8b\u52a1\u64cd\u4f5c 7>\u4e86\u89e3Redis\u6301\u4e45\u5316\u7b56\u7565 8>\u4e86\u89e3Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e0e\u8fc7\u671fKey\u6e05\u7406 9>\u638c\u63e1Java\u96c6\u6210Redis\u64cd\u4f5c 10>\u5b8c\u6210\u7efc\u5408\u6848\u4f8b\u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u8ba4\u8bc6 Redis \u6570\u636e\u5e93\u5206\u7c7b \u76ee\u524d\u6570\u636e\u5e93\u5206\uff1a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0e\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93 \u5e38\u7528\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff1a Oracle\uff0c MySQL \uff0cSqlServer\uff0cDB2 \u5e38\u7528\u7684\u975e\u5173\u7cfb\u6570\u636e\u5e93\uff1a Redis \uff0cMongoDB\uff0cElasticSearch\uff0c Hbase\uff0cNeo4j \u90a3\u5565\u662f\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5462\uff1f\u6b64\u5904\u6d89\u53ca\u5230\u65b0\u540d\u8bcd\uff1aNoSQL NoSQL \u6700\u5e38\u89c1\u7684\u89e3\u91ca\u662f\u201cnon-relational\u201d\uff0c \u201cNot Only SQL\u201d\u4e5f\u88ab\u5f88\u591a\u4eba\u63a5\u53d7\u3002NoSQL\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6982\u5ff5\uff0c\u6cdb\u6307\u975e\u5173\u7cfb\u578b\u7684\u6570\u636e\u5e93\uff0c\u533a\u522b\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u5b83\u4eec\u4e0d\u4fdd\u8bc1\u5173\u7cfb\u6570\u636e\u7684ACID\u7279\u6027\u3002\u8be6\u60c5\u89c1\uff1a\u767e\u5ea6\u767e\u79d1\uff1ahttps://baike.baidu.com/item/NoSQL/8828247?fr=aladdin \u7ecf\u5178\u6848\u4f8b * NoSQL\u5206\u7c7b * \u4ec0\u4e48\u662fRedis Redis\u7b80\u4ecb \u662f\u4ee5key-value\u5f62\u5f0f\u5b58\u50a8,\u548c\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0d\u4e00\u6837.\u4e0d\u4e00\u5b9a\u9075\u5faa\u4f20\u7edf\u6570\u636e\u5e93\u7684\u4e00\u4e9b\u57fa\u672c\u8981\u6c42.(\u975e\u5173\u7cfb\u578b\u7684,\u5206\u5e03\u5f0f\u7684,\u5f00\u6e90\u7684,\u6c34\u5e73\u53ef\u62d3\u5c55\u7684) \u4f18\u70b9: \u5bf9\u6570\u636e\u9ad8\u5e76\u53d1\u8bfb\u5199 (\u76f4\u63a5\u662f\u5185\u5b58\u4e2d\u8fdb\u884c\u8bfb\u5199\u7684) \u5bf9\u6d77\u91cf\u6570\u636e\u7684\u9ad8\u6548\u7387\u5b58\u50a8\u548c\u8bbf\u95ee \u5bf9\u6570\u636e\u7684\u53ef\u62d3\u5c55\u6027\u548c\u9ad8\u53ef\u7528\u6027. \u5355\u7ebf\u7a0b\u64cd\u4f5c ,\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u64cd\u4f5c,\u6ca1\u6709\u5e76\u53d1\u76f8\u5173\u95ee\u9898(redis 6) \u7f3a\u70b9: redis(ACID\u5904\u7406\u975e\u5e38\u7b80\u5355) \u65e0\u6cd5\u505a\u592a\u590d\u6742\u7684\u5173\u7cfb\u6570\u636e\u5e93\u6a21\u578b * \u8c01\u5728\u7528Redis \u6bd4\u8f83\u8457\u540d\u7684\u516c\u53f8\u6709\uff1a github\u3001blizzard\u3001stackoverflow\u3001flickr \u56fd\u5185 \u65b0\u6d6a\u5fae\u535a\uff08\u5168\u7403\u6700\u5927\u7684redis\u96c6\u7fa4\uff09\u30102017\u3011 2200+\u4ebf commands/day 5000\u4ebfRead/day 500\u4ebfWrite/day 18TB+ Memory 500+ Servers in 6 IDC 2000+instances \u6dd8\u5b9d \u817e\u8baf\u5fae\u535a \u600e\u4e48\u5b66redis redis\u5728\u7ebf\u5165\u95e8 \uff1a http://try.redis.io/ redis \u4e2d\u6587\u8d44\u6599\u7ad9\uff1a http://www.redis.cn/ https://www.runoob.com/redis/redis-tutorial.html Redis\u7684\u5b89\u88c5 \u9898\u5916\u8bdd\uff1a Redis\u662f\u4f7f\u7528C\u5199\u7684\u7a0b\u5e8f\uff0c\u76ee\u524d\u4e3b\u6d41\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b98\u65b9\u4e0d\u63d0\u4f9bWindow\u7248\uff0c\u6700\u65b0\u7684Redis\u7248\uff1aRedis7.x \u5b98\u7f51\u4e0b\u8f7d\uff1ahttps://redis.io/download/ Redis \u7684Window\u7248\u662f\u5fae\u8f6f\u516c\u53f8\u81ea\u884c\u79fb\u690d\u7684\uff0c\u76ee\u524d\u6700\u65b0\u7248\uff1aRedis-x64-3.2.100 window\u7248\uff1ahttps://github.com/microsoftarchive/redis/releases/tag/win-3.2.100 \u65b0\u7248\u63a7\u7684\u540c\u5b66\uff1a 1>\u8d2d\u4e70\u963f\u91cc\u4e91Redis https://www.aliyun.com/minisite/goods?taskPkg=amb618all&pkgSid=442814&recordId=4183761&userCode=sd4xtwwm 2>\u8d2d\u4e70\u963f\u91cc\u4e91ECS \u8d2d\u4e70\u670d\u52a1\u5668\uff0c\u81ea\u5df1\u642d\u5efa\u6700\u65b0\u7248\u7684Redis 3>\u5b89\u88c5\u865a\u62df\u673a\uff1aLinux\uff0c\u518d\u5b89\u88c5\u6700\u65b0\u7248Redis \u8fd9\u4e2a\uff0c\u9879\u76ee\u4e09\u8bb2Linux\u64cd\u4f5c\u7cfb\u7edf\u65f6\u518d\u6559\u3002 \u670d\u52a1\u7aef \u7248\u672c\uff1aRedis-x64-3.2.100.msi \u50bb\u74dc\u5f0f\u5b89\u88c5,\u4e0b\u4e00\u6b65,\u4e0b\u4e00\u6b65\u5c31\u53ef\u4ee5\u4e86 \u6ce8\u610f\uff1a\u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf\u4e2d * \u6ce8\u610f\uff1a\u9ed8\u8ba4\u7aef\u53e3 * \u6ce8\u610f\uff1a\u6700\u5927\u5185\u5b58 * \u6d4b\u8bd5\u662f\u5426\u6210\u529f * * \u5ba2\u6237\u7aef --redisclient \u6253\u5f00CMD\u547d\u4ee4\u6846\uff0c\u8f93\u5165\u547d\u4ee4\uff1a java -jar redisclient.jar \u5ba2\u6237\u7aef --RedisDesktopClient \u5ba2\u6237\u7aef --rdm \u6570\u636e\u7c7b\u578b \u6982\u51b5 Redis\u652f\u6301\u7684\u5b58\u50a8\u6570\u636e\u7c7b\u578b\u6709\u5f88\u591a\uff1a \u5e38\u7528\uff1a string \uff08\u5b57\u7b26\u4e32\uff09\uff0c hash \uff08\u54c8\u5e0c\uff09\uff0c list \uff08\u5217\u8868\uff09\uff0c set \uff08\u96c6\u5408\uff09\u53ca zset (sorted set\uff1a\u6709\u5e8f\u96c6\u5408) \u4e0d\u5e38\u7528\uff1aHyperLogLog\uff0cBitmap(\u4f4d\u56fe)\uff0cBloom Filter(\u5e03\u9686\u8fc7\u6ee4\u5668)\uff0cGeospatial(\u5730\u7406\u4f4d\u7f6e) \uff0cModule(\u6a21\u5757)\uff0c Streams(\u6d41\u4fe1\u606f) \u6b64\u5904\u91cd\u70b9\u8bb2\u89e3\u5e38\u7528\u7684\u7c7b\u578b\u3002 \u547d\u4ee4\u683c\u5f0f \u7c7b\u578b\u547d\u4ee4 key \u53c2\u6570\u6570\u636e set name dafei \u64cd\u4f5c\u5efa\u8bae Redis\u64cd\u4f5c\u6709\u70b9\u7c7b\u4f3cJava\u7684Map\u96c6\u5408\uff0c\u90fd\u662fkey-value\u5f62\u5f0f\u5b58\u50a8\u6570\u636e\uff0c\u5728\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u8fdb\u884c\u7c7b\u6bd4\u3002 \u53e6\u5916Redis\u4e2d\u7684key\u5927\u90e8\u5206\u4e3aString\u7c7b\u578b\uff0cvalue\u503c\u6839\u636e\u7f13\u5b58\u6570\u636e\u7ed3\u6784\u53ef\u4ee5\u9009\u7528\uff1astring\uff0chash\uff0clist\uff0cset\uff0czset\u7b49\u7c7b\u578b\u3002 \u6ce8\u610f\uff1a\u4e0b\u9762\u8bb2\u7684\u5404\u79cd\u7c7b\u578b\uff0c\u8868\u8ff0\u7684\u662f\u7f13\u5b58\u6570\u636e\u7684value\u7c7b\u578b\u3002 String\u7c7b\u578b String\u7c7b\u578b\u5305\u542b\u591a\u79cd\u7c7b\u578b\u7684\u7279\u6b8a\u7c7b\u578b\uff0c\u5e76\u4e14\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff0c\u5176\u503c\u53ef\u4ee5\u662f\u6570\u503c\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map map \u5728Redis\u5185\u5bb9\u6570\u636e\u5b58\u50a8\u7ed3\u6784\uff1a * \u5e38\u7528\u7684\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b set key value \u5c06key-value\u7f13\u5b58redis\u4e2d set name dafei get key \u4eceredis\u4e2d\u83b7\u53d6key\u5bf9\u5e94value\u503c get name incr key \u5c06key\u5bf9\u5e94value\u503c + 1 incr age decr key \u5c06key\u5bf9\u5e94value\u503c-1 decr age setex key seconds value \u5c06key-value\u7f13\u5b58\u5230redis\u4e2d\uff0cseconds \u79d2\u540e\u5931\u6548 setex sex 10 man ttl key \u67e5\u770bkey\u5b58\u6d3b\u65f6\u95f4 ttl sex del key \u4eceredis\u4e2d\u5220\u9664key del name setnx key value \u5982\u679ckey\u5df2\u7ecf\u5b58\uff0c\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5982\u679ckey\u4e0d\u5b58\uff0c\u76f4\u63a5\u6dfb\u52a0 setnx name xiaofei \u975e\u5e38\u7528\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b incrby key increment \u7ed9key\u5bf9\u5e94\u503c\u52a0increment incrby age 10 mset k1 v1 k2 v2.... \u6279\u91cf\u6dfb\u52a0k1v1 k2v2 key value\u5bf9 mset name dafei age 18 mget k1 k2.... \u6279\u91cf\u83b7\u53d6k1, k2\u7684\u503c mget name age append key value \u5728key\u5bf9\u5e94\u7684value\u503c\u4e2d\u62fc+value append name yes setrange key offset value \u4fee\u6539key\u5bf9\u5e94\u7684value\u503c,\u66ff\u6362\u4e3a\u6307\u5b9avalue,\u51b2offset\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb setrange name 2 xx \u5e94\u7528\u573a\u666f 1>\u8ba1\u6570\u5668 \u5982\uff1a\u89c6\u9891\u64ad\u653e\u6570\u7cfb\u7edf\u5c31\u662f\u4f7f\u7528redis\u4f5c\u4e3a\u89c6\u9891\u64ad\u653e\u6570\u8ba1\u6570\u7684\u57fa\u7840\u7ec4\u4ef6\u3002 incr viewnum 1 2>\u5171\u4eabsession \u51fa\u4e8e\u8d1f\u8f7d\u5747\u8861\u7684\u8003\u8651\uff0c\u5206\u5e03\u5f0f\u670d\u52a1\u4f1a\u5c06\u7528\u6237\u4fe1\u606f\u7684\u8bbf\u95ee\u5747\u8861\u5230\u4e0d\u540c\u670d\u52a1\u5668\u4e0a\uff0c\u7528\u6237\u5237\u65b0\u4e00\u6b21\u8bbf\u95ee\u53ef\u80fd\u4f1a\u9700\u8981\u91cd\u65b0\u767b\u5f55\uff0c\u4e3a\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528redis\u5c06\u7528\u6237session\u96c6\u4e2d\u7ba1\u7406\uff0c \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u53ea\u8981\u4fdd\u8bc1redis\u7684\u9ad8\u53ef\u7528\u548c\u6269\u5c55\u6027\u7684\uff0c\u6bcf\u6b21\u83b7\u53d6\u7528\u6237\u66f4\u65b0\u6216\u67e5\u8be2\u767b\u5f55\u4fe1\u606f\u90fd\u76f4\u63a5\u4eceredis\u4e2d\u96c6\u4e2d\u83b7\u53d6\u3002 user_login_info:uid---->{\"id\":1, \"name\":\"dafei\", \"age\":18} Hash\u7c7b\u578b Hash\u7c7b\u578b\u662fString\u7c7b\u578b\u7684field\u548cvalue\u7684\u6620\u5c04\u8868\uff0c\u6216\u8005\u8bf4\u662f\u4e00\u4e2aString\u96c6\u5408\u3002\u5b83\u7279\u522b\u9002\u5408\u5b58\u50a8\u5bf9\u8c61\uff0c\u76f8\u6bd4\u8f83\u800c\u8a00\uff0c\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5b58\u50a8\u5728Hash\u7c7b\u578b\u91cc\u8981\u6bd4\u5b58\u50a8\u5728String\u7c7b\u578b\u91cc\u5360\u7528\u66f4\u5c11\u7684\u5185\u5b58\u7a7a\u95f4\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map > map * \u5e38\u7528\u7684\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b hset key field value \u5c06field value\u5bf9\u7f13\u5b58\u5230redis\u4e2dhash\u4e2d\uff0c\u952e\u503c\u4e3akey hset user name dafei hget key field \u4ecekey\u5bf9\u5e94hash\u5217\u8868\u4e2d\u83b7\u53d6field\u5b57\u6bb5 hget user name hexists key field \u5224\u65adkey\u5bf9\u5e94\u7684hash\u5217\u8868\u662f\u5426\u5b58\u5728 field\u5b57\u6bb5 hexists user age hdel key field \u5220\u9664key\u5bf9\u5e94hash\u5217\u8868\u4e2dfield\u5b57\u6bb5 hdel user age hincrby key field increment \u7ed9key\u5bf9\u5e94hash\u5217\u8868\u4e2dfield\u5b57\u6bb5 + increment hincrby user age 10 hlen key \u67e5\u770bkey\u5bf9\u5e94\u7684hash\u5217\u8868field\u7684\u6570\u91cf hlen user hkeys key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u6240\u6709\u7684field\u503c hkeys user hvals key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u6240\u6709\u7684field\u5bf9\u5e94\u7684value\u503c kvals user hgetall key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u4e2d\u6240\u6709\u7684field\u53ca\u5176\u5bf9\u5e94\u7684value\u503c hgetall user \u5e94\u7528\u573a\u666f Hash\u7ed3\u6784\u76f8\u5bf9\u4e8e\u5b57\u7b26\u4e32\u5e8f\u5217\u5316\u7f13\u5b58\u4fe1\u606f\u66f4\u52a0\u76f4\u89c2\uff0c\u5e76\u4e14\u5728\u66f4\u65b0\u64cd\u4f5c\u4e0a\u66f4\u52a0\u4fbf\u6377\u3002 \u5171\u4eabsession\u8bbe\u8ba1 public class User{ private String userame; private String password; private int age; } \u767b\u5f55\u7528\u6237\uff1a User user = new User(\"dafei\", \"666\", 18); \u767b\u5f55\u7f13\u5b58\uff1a key\uff1a user_token value\uff1a new User(\"dafei\", \"666\", 18) ---------------------------------------------------------------------------------------------- \u65b9\u68481\uff1a \u5c06user\u5bf9\u8c61\u8f6c\u6362json\u683c\u5f0f\u5b57\u7b26\u4e32\u5b58redis \u3010\u4fa7\u91cd\u4e8e\u67e5\uff0c \u6539\u975e\u5e38\u9ebb\u70e6\u3011 key value --------------------------------------------------------------------------------------------- user_token \uff1a \"{name:dafei, age:18, password:666}\" \u65b9\u68482\uff1a \u5c06user\u5bf9\u8c61\u8f6c\u6362hash\u5bf9\u8c61\u5b58redis\u3010\u4fa7\u91cd\u4e8e\u6539\uff0c\u67e5\u8be2\u76f8\u5bf9\u9ebb\u70e6\u3011 key value --------------------------------------------------------------------------------------------- user_token \uff1a { \u200b name\uff1addafei \u200b age \uff1a 18 \u200b password\uff1a 666 \u200b } List\u7c7b\u578b Redis\u4e2d\u7684List\u7c7b\u4f3cJava\u4e2d\u7684Queue,\u4e5f\u53ef\u4ee5\u5f53\u505aList\u6765\u7528. List\u7c7b\u578b\u662f\u4e00\u4e2a\u94fe\u8868\u7ed3\u6784\u7684\u96c6\u5408\uff0c\u5176\u4e3b\u8981\u529f\u80fd\u6709push\u3001pop\u3001\u83b7\u53d6\u5143\u7d20\u7b49\uff0c\u66f4\u8be6\u7ec6\u7684\u8bf4,List\u7c7b\u578b\u662f\u4e00\u4e2a\u53cc\u7aef\u94fe\u8868\u7684\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u76f8\u5173\u64cd\u4f5c\u8fdb\u884c\u96c6\u5408\u7684\u5934\u90e8\u6216\u8005\u5c3e\u90e8\u6dfb\u52a0\u5220\u9664\u5143\u7d20\uff0cList\u7684\u8bbe\u8ba1\u975e\u5e38\u7b80\u5355\u7cbe\u5de7\uff0c\u5373\u53ef\u4ee5\u4f5c\u4e3a\u6808,\u53c8\u53ef\u4ee5\u4f5c\u4e3a\u961f\u5217\uff0c\u6ee1\u8db3\u7edd\u5927\u591a\u6570\u9700\u6c42. \u7c7b\u4f3cJava\u4e2d\uff1a Map map * \u5e38\u7528\u7684\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b rpush key value \u4ece\u53f3\u8fb9\u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0value\u503c rpush hobby java lrange key start stop \u4ece\u5de6\u8fb9\u5f00\u59cb\u5217\u8868key\u96c6\u5408\uff0c\u4ecestart\u4f4d\u7f6e\u5f00\u59cb\uff0cstop\u4f4d\u7f6e\u7ed3\u675f lrange hobby 0 -1 lpush key value \u4ece\u5de6\u8fb9\u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0value\u503c lpush hobby c++ lpop key \u5f39\u51fakey\u96c6\u5408\u4e2d\u6700\u5de6\u8fb9\u7684\u6570\u636e lpop hobby rpop key \u5f39\u51fakey\u96c6\u5408\u4e2d\u6700\u53f3\u8fb9\u7684\u6570\u636e rpop hobby llen key \u83b7\u53d6\u5217\u8868\u957f\u5ea6 llen hooby \u975e\u5e38\u7528\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b linsert key before pivot value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5728pivot\u503c\u4e4b\u524d\u63d2\u5165value linsert hobby before java c# linsert key after pivot value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5728pivot\u503c\u4e4b\u540e\u63d2\u5165value linsert hobby after java c# lset key index value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u66f4\u65b0\u7d22\u5f15index\u4f4d\u7f6e\u503c\u4e3avalue lset hobby 1 go lrem key count value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5220\u9664 count\u4e2a value\u503c lrem hobby 3 go ltrim key start stop \u64cd\u4f5ckey\u96c6\u5408\uff0c\u4ecestart\u5230stop\u622a\u53d6\u81ea\u5217\u8868 ltrim hobby 2 4 lindex key index \u64cd\u4f5ckey\u96c6\u5408\uff0c\u83b7\u53d6\u7d22\u5f15\u4e3aindex\u4f4d\u7f6e\u7684\u6570\u636e lindex hobby 1 \u5e94\u7528\u573a\u666f 1>\u7528\u6237\u6536\u85cf\u6587\u7ae0\u5217\u8868\uff1a key\uff1auser_favor_article_list value: [aid1, aid2, aid3......] Set\u7c7b\u578b Set\u96c6\u5408\u662fString\u7c7b\u578b\u7684\u65e0\u5e8f\u96c6\u5408,set\u662f\u901a\u8fc7HashTable\u5b9e\u73b0\u7684\uff0c\u5bf9\u96c6\u5408\u6211\u4eec\u53ef\u4ee5\u53d6 \u4ea4\u96c6\u3001\u5e76\u96c6\u3001\u5dee\u96c6\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map map * \u5e38\u7528\u7684\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b sadd key members [....] \u5f80key \u96c6\u5408\u4e2d\u6dfb\u52a0member\u5143\u7d20 sadd myset a b c smembers key \u904d\u5386key\u96c6\u5408\u4e2d\u6240\u6709\u7684\u5143\u7d20 smembers myset srem key members [....] \u5220\u9664key\u96c6\u5408\u4e2dmembers\u5143\u7d20 srem myset a spop key count \u4ecekey\u96c6\u5408\u4e2d\u968f\u673a\u5f39\u51facount\u4e2a\u5143\u7d20 spop myset 1 \u975e\u5e38\u7528\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b sdiff key1 key2 \u8fd4\u56dekey1\u4e2d\u7279\u6709\u7684\u5143\u7d20(\u5dee\u96c6) sdiff key1 key2 sidiffstore dest key1 key2 \u8fd4\u56dekey1\u4e2d\u7279\u6709\u7684\u5143\u7d20\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sidiffstore dest key1 key2 sinter key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u4ea4\u96c6 sinter key1 key2 sinterstore dest key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u4ea4\u96c6\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sinterstore dest key1 key2 sunion key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u5e76\u96c6 sunion key1 key2 sunionstore dest key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sunionstore dest key1 key2 smove source destination member \u5c06source\u96c6\u5408\u4e2dmember\u5143\u7d20\u79fb\u52a8\u5230destination\u96c6\u5408\u4e2d smove key1 key2 aa sismember key member \u5224\u65admember\u5143\u7d20\u662f\u5426\u5728key\u96c6\u5408\u4e2d sismember key1 aa srandmember key count \u968f\u673a\u83b7\u53d6set\u96c6\u5408\u4e2dcount \u4e2a\u5143\u7d20 srandmember key1 1 \u5e94\u7528\u573a\u666f 1\uff0c\u53bb\u91cd\uff1b 2\uff0c\u62bd\u5956; \u200b 1\uff1a\u51c6\u5907\u4e00\u4e2a\u62bd\u5956\u6c60:sadd luckydraw 1 2 3 4 5 6 7 8 9 10 11 12 13 \u200b 2\uff1a\u62bd3\u4e2a\u4e09\u7b49\u5956:spop luckydraw 3 \u200b 3\uff1a\u62bd2\u4e2a\u4e8c\u7b49\u5956:spop luckydraw 2 \u200b 4\uff1a\u62bd1\u4e2a:\u4e00\u7b49\u5956:spop luckydraw 1 Sorted set \u7c7b\u578b Sorted set \u4e5f\u79f0Zset\u7c7b\u578b\uff0c\u662f\u4e00\u79cd\u5177\u6709\u6392\u5e8f\u6548\u679c\u7684set\u96c6\u5408\u3002\u5b83\u8ddfset\u96c6\u5408\u4e00\u6837\u4e5f\u662f string \u7c7b\u578b\u5143\u7d20\u7684\u96c6\u5408\uff0c\u4e14\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u6210\u5458\u3002\u5e76\u4e14\u8981\u6c42\u6bcf\u4e2a\u5143\u7d20\u90fd\u4f1a\u5173\u8054\u4e00\u4e2adouble \u7c7b\u578b\u7684\u5206\u6570\u3002\u540e\u7eed\u53ef\u4ee5\u901a\u8fc7\u5206\u6570\u6765\u4e3a\u96c6\u5408\u4e2d\u7684\u6210\u5458\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u7684\u6392\u5e8f\u3002 Sorted set\u96c6\u5408\u662f\u901a\u8fc7\u54c8\u5e0c\u8868\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u6dfb\u52a0\uff0c\u5220\u9664\uff0c\u67e5\u627e\u7684\u590d\u6742\u5ea6\u90fd\u662f O(1)\u3002 \u96c6\u5408\u4e2d\u6700\u5927\u7684\u6210\u5458\u6570\u4e3a 232 - 1 (4294967295, \u6bcf\u4e2a\u96c6\u5408\u53ef\u5b58\u50a840\u591a\u4ebf\u4e2a\u6210\u5458)\u3002 \u6570\u636e\u7f13\u5b58\u7ed3\u6784\uff1a * \u5e38\u7528\u7684\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b zadd key score member \u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0member\u5143\u7d20\uff0c\u5206\u6570\u4e3ascore zadd players 100 a zincrby key increment member \u5c06key\u96c6\u5408\u4e2d\u7684member\u5143\u7d20 \u5206\u6570 + increment zadd players 100 a zrange key start stop [withscores] \u5c06key\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u6309\u5206\u6570\u5347\u5e8f\u6392\u5217 [\u663e\u5f0f\u5206\u6570] zrange players 0 -1 withscores zrevrange key start stop [withscores] \u5c06key\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u6309\u5206\u6570\u964d\u5e8f\u6392\u5217 [\u663e\u5f0f\u5206\u6570] zrevrange players 0 -1 withscores zrank key member \u8fd4\u56demember\u5143\u7d20\u5728key\u7ed3\u5408\u4e2d\u7684\u6b63\u5e8f\u6392\u540d zrank players a zrevrank key member \u8fd4\u56demember\u5143\u7d20\u5728key\u7ed3\u5408\u4e2d\u7684\u5012\u5e8f\u6392\u540d zrevrank players a zcard key \u8fd4\u56dekey\u96c6\u5408\u5143\u7d20\u4e2a\u6570 zcard players \u975e\u5e38\u7528\u547d\u4ee4 \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b zrangebyscore key min max [withscores] \u6309[min, max) \u5206\u6570\u8303\u56f4\u8fd4\u56dekey\u96c6\u5408\u4e2d\u5143\u7d20(\u6b63\u5e8f) zrangebyscore players 200 300 withscores zrevrangebyscore key min max [withscores] \u6309[min, max) \u5206\u6570\u8303\u56f4\u8fd4\u56dekey\u96c6\u5408\u4e2d\u5143\u7d20(\u5012\u5e8f) zrevrangebyscore players 200 300 withscores zrem key member \u5220\u9664key\u96c6\u5408\u4e2dmember\u5143\u7d20\u4e0e\u5206\u6570 zrem players a zremrangebyscore key min max withscores \u6309[min, max) \u5206\u6570\u8303\u56f4\u5220\u9664key\u96c6\u5408\u4e2d\u5143\u7d20 zremrangebyscore players 200 300 withscores zremrangebyrank key start stop \u5220\u9664key\u96c6\u5408\u6b63\u5e8f\u6392\u540d\u843d\u5728[start, stop) \u8303\u56f4\u5143\u7d20 zremrangebyrank players 10 20 zcount key min max \u6309\u7167\u5206\u6570\u8303\u56f4[min, max]\u7edf\u8ba1key\u96c6\u5408\u4e2d\u5143\u7d20\u4e2a\u6570 zcount players 100 300 \u5e94\u7528\u573a\u666f \u6392\u884c\u699c\uff1a\u6709\u5e8f\u96c6\u5408\u7ecf\u5178\u4f7f\u7528\u573a\u666f\u3002\u4f8b\u5982\u89c6\u9891\u7f51\u7ad9\u9700\u8981\u5bf9\u7528\u6237\u4e0a\u4f20\u7684\u89c6\u9891\u505a\u6392\u884c\u699c\uff0c\u699c\u5355\u7ef4\u62a4\u53ef\u80fd\u662f\u591a\u65b9\u9762\uff1a\u6309\u7167\u65f6\u95f4\u3001\u6309\u7167\u64ad\u653e\u91cf\u3001\u6309\u7167\u83b7\u5f97\u7684\u8d5e\u6570\u7b49\u3002 \u7c7b\u578b\u603b\u7ed3 \u4e00\u4e2a\u95ee\u9898\uff0cRedis\u5728\u9879\u76ee\u4e2d\u5982\u4f55\u4f7f\u7528\uff1f \u601d\u8003\u70b9\uff1a 1>\u9879\u76ee\u662f\u5426\u9700\u8981\u4f7f\u7528\u5230\u7f13\u5b58\uff1f\u4f7f\u7528 2>\u4f7f\u7528\u7f13\u5b58\u662f\u5426\u9009\u7528Redis\uff1f\u9009\u7528 3>\u4f7f\u7528Redis\u90a3\u8be5\u600e\u4e48\u8bbe\u8ba1Key-Value\u503c\uff1f \u8fd9\u91cc\u91cd\u70b9\u8ba8\u8bbaRedis\u7684KV\u5bf9\u7684\u8bbe\u8ba1\u3002 Value\u8bbe\u8ba1 \u5148\u8bf4value\u503c\u7684\u8bbe\u8ba1\u5176\u5b9e\u5c31\u662fvalue\u7c7b\u578b\u9009\u7528\uff1a String\uff0c Hash\uff0c List\uff0c Set\uff0c Sort Set \u4e00\u822c\u8003\u8651\uff1a \u662f\u5426\u9700\u8981\u6392\u5e8f\uff1f\u8981\u4f7f\u7528Sort Set \u7f13\u5b58\u7684\u6570\u636e\u662f\u591a\u4e2a\u503c\u8fd8\u662f\u5355\u4e2a\u503c\uff0c \u591a\u4e2a\u503c\uff1a\u5141\u8bb8\u91cd\u590d\u9009List \u4e0d\u5141\u8bb8\u91cd\u590d\u9009\u62e9Set \u5355\u4e2a\u503c\uff1a\u7b80\u5355\u503c\u9009\u62e9String\uff0c \u5bf9\u8c61\u503c\u9009\u62e9Hash \u4e00\u79cd\u53d6\u5de7\u7684\u65b9\u5f0f\uff1a \u662f\u5426\u9700\u8981\u6392\u5e8f\uff1f\u8981\u4f7f\u7528Sort Set \u5269\u4e0b\u4f7f\u7528String \u64cd\u4f5c\u65b9\u5f0f\uff1a \u6240\u6709value\u4e4b\u540e\u90fd\u8f6c\u6362\u6210json\u683c\u5f0f\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u7f13\u5b58\u5230Redis\uff0c\u539f\u56e0\uff1aJava\u64cd\u4f5c\u65b9\u4fbf\uff0c\u51cf\u5c11\u6cdb\u578b\u64cd\u4f5c\u9ebb\u70e6 \u6bd4\u5982\uff1a List<String>list = ... Set<String> set = .... Map<String, Object> map = .... List<Object> list = redis\u5bf9\u8c61.getList Set<Object> set =redis\u5bf9\u8c61.getSet Map<Object, Object> map = redis\u5bf9\u8c61.getMap \u4e0d\u7ba1\u5b58\u653e\u5565\u6570\u636e\u7c7b\u578b\uff0c\u4ecereds\u4e2d\u83b7\u53d6\u51fa\u6765\u90fd\u662fObject\u7c7b\u578b\uff0c\u540e\u7eed\u5bf9\u8c61\u5f3a\u5236\u8f6c\u6362\u9ebb\u70e6\uff0c\u5e72\u8106\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u3002 Key\u8bbe\u8ba1 Redis \u7684key \u8bbe\u8ba1\u8bb2\u7a764\u4e2a\u6027\uff1a \u552f\u4e00\u6027 Redis \u7c7b\u4f3cMap\u96c6\u5408\uff0ckey\u5fc5\u987b\u4fdd\u8bc1\u552f\u4e00\uff0c\u7f13\u5b58\u540c\u4e00\u4e2akey\u65f6\uff0c\u540e\u8005\u4f1a\u8986\u76d6\u524d\u8005\uff0c\u6240\u6709\u5fc5\u987b\u8981\u6c42\u552f\u4e00\uff0c\u90a3\u5982\u4f55\u4fdd\u8bc1\u552f\u4e00\u5462\uff1f \u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff1a \u4f7f\u7528\u7f13\u5b58\u6570\u636e\u7684\u4e3b\u952e\u4f5c\u4e3akey \u3002 \u6bd4\u5982\uff1a\u7f13\u5b58\u5458\u5de5\u4fe1\u606f key value ---------------------------------------------------------------- 1 \u5458\u5de51 2 \u5458\u5de52 \u5176\u4e2d\u76841\uff0c 2 \u662f\u5458\u5de5\u7684id \u53ef\u8bfb\u6027 \u53ef\u8bfb\u6027\u662f\u4fdd\u8bc1Redis\u7684key\u80fd\u505a\u5230\u89c1\u540d\u77e5\u610f\uff0c\u4e0a\u9762\u7684\u5458\u5de5id1\uff0c \u5458\u5de5id2 \u867d\u8bf4\u80fd\u4fdd\u8bc1key\u552f\u4e00\uff0c\u4f46\u53ef\u8bfb\u6027\u975e\u5e38\u5dee\uff0c\u7ef4\u62a4key\u65f6\uff0c\u65e0\u6cd5\u4ece\uff0c 1\uff0c 2\u4e2d\u5feb\u901f\u5224\u65ad\u8be5key\u5bf9\u5e94value\u503c\u3002\u6240\u4ee5\u4e00\u4e00\u822c\u5728\u4fdd\u8bc1key\u552f\u4e00\u7684\u524d\u63d0\u4e0b\uff0c\u7ed9key\u52a0\u4e0a\u524d\u7f00\uff1a key value ---------------------------------------------------------------- employee_info:id1 \u5458\u5de51 employee_info:id2 \u5458\u5de52 employee_info:id1 employee_info:id2 \u8fd9\u6837\u5b50\u8bbe\u8ba1key\uff0c\u53ef\u8bfb\u6027\u5c31\u597d\u591a\u4e86\u3002 \u53ef\u8bfb\u6027\u524d\u7f00\u7684\u8bbe\u8ba1\u89c4\u8303\u5343\u5947\u767e\u602a\uff0c\u6211\u4e2a\u4eba\u6bd4\u8f83\u63a8\u5d07\u7684\uff1a \u666e\u901a\u5355\u503c key value ---------------------------------------------------------------- employe_info:id1 \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u7c7b\u4f3c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u8bbe\u8ba1 \u8868\u540d:\u4e3b\u952e\u540d:\u4e3b\u952e\u503c:\u5217\u540d key value ---------------------------------------------------------------- employee : id : 1:info \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u901a\u7528\u73a9\u6cd5 \u4e1a\u52a1\u6a21\u5757\u540d:\u4e1a\u52a1\u903b\u8f91\u542b\u4e49:\u5176\u4ed6:value\u7c7b\u578b key value ----------------------------------------------------------------------- employee :base.info:id1:hash \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u4e1a\u52a1\u6a21\u5757\u540d \uff1a\u8868\u793a\u8be5key\u5c5e\u4e8e\u54ea\u4e2a\u529f\u80fd\u6a21\u5757 \u4e1a\u52a1\u903b\u8f91\u542b\u4e49\u6bb5 \uff1a\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528 . \u5206\u5f00\uff0c \u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u8868\u793a \u200b \u6bd4\u5982\uff1a\u7f13\u5b58\u5458\u5de5\u6743\u9650 \u200b employee:auth.permission:id1:set \u5458\u5de5\u6743\u9650\u96c6\u5408 \u5176\u4ed6 \uff1a\u4e00\u822c\u8bbe\u7f6e\u552f\u4e00\u6807\u8bc6\uff0c\u6bd4\u5982\u4e3b\u952e value\u7c7b\u578b \uff1akey\u5bf9\u5e94value\u7c7b\u578b\u503c\uff0c\u63d0\u9ad8\u53ef\u8bfb\u6027\u3002 \u7075\u6d3b\u6027 --\u9879\u76ee\u4e8c\u91cd\u70b9\u8bb2 \u8fd9\u4e2a\u96be\u4ecb\u7ecd\uff0c\u4e00\u822ckey\u4fdd\u8bc1\u552f\u4e00\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e3b\u952e\uff0c\u6709\u7684\u4f7f\u7528\uff0c\u4e00\u4e2a\u4e3b\u952e\u4e0d\u80fd\u8868\u8fbe\u51fa\u5168\u90e8\u610f\u601d\uff0c\u53ef\u4ee5\u4f7f\u7528\u8054\u5408\u4e3b\u952e\u3002 \u6bd4\u5982\uff1a id\u4e3a1\u7684\u670b\u53cb\u5708\u4e0bid\u4e3aA\u7684\u8bc4\u8bba\u3002 key value ----------------------------------------------------------------------- post:1:reply:A \u8bc4\u8bba\u5185\u5bb9 post:1:reply:B \u8bc4\u8bba\u5185\u5bb9 \u65f6\u6548\u6027 Redis key\u4e00\u5b9a\u8981\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002\u8981\u8ddf\u81ea\u5df1\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u9700\u8981\u5bf9key\u8bbe\u7f6e\u5408\u7406\u7684\u8fc7\u671f\u65f6\u95f4\u3002\u53ef\u4ee5\u5728\u5199\u5165key\u65f6\uff0c\u5c31\u8981\u8ffd\u52a0\u8fc7\u671f\u65f6\u95f4\uff1b\u4e5f\u53ef\u4ee5\u5728\u6309\u7167\u9700\u8981\u52a8\u6001\u8bbe\u7f6e\u3002 \u8fd9\u91cc\u8981\u6ce8\u610f\uff1a \u4e0d\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u8fd9\u79cdkey\u4e3a\u6c38\u4e45key\uff0c\u4f1a\u4e00\u76f4\u5360\u7528\u5185\u5b58\u4e0d\u91ca\u653e\uff0c\u65f6\u95f4\u4e45\u4e86\uff0c\u6570\u91cf\u4e00\u591a\uff0c\u5c31\u5bb9\u6613\u8fbe\u5230\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e0a\u9650\uff0c\u5bfc\u81f4\u5b95\u673a\uff0c\u5f00\u53d1\u65f6\u4e00\u822c\u914d\u5408Key\u8fc7\u671f\u7b56\u7565\u4f7f\u7528\u54e6\u3002 key\u7684\u65f6\u6548\u6027\u8bbe\u7f6e\uff0c\u5fc5\u987b\u6839\u636e\u4e1a\u52a1\u573a\u666f\u8fdb\u884c\u8bc4\u4f30\uff0c\u8bbe\u7f6e\u5408\u7406\u6709\u6548\u671f\uff1b Redis\u5168\u5c40\u547d\u4ee4 \u5168\u5c40\u547d\u4ee4\u9488\u5bf9\u7684\u662f\u6240\u6709\u7684key\uff0c\u5927\u90e8\u5206\u7528\u6765\u505a\u8fd0\u7ef4\uff0c\u505a\u7ba1\u7406\u7684 \u5e38\u7528\u7684\u5168\u5c40key \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b keys pattern \u6309\u7167pattern \u5339\u914d\u89c4\u5219\uff0c\u5217\u8868redis\u4e2d\u6240\u6709\u7684key keys xxx:* exists key \u5224\u65adkey\u662f\u5426\u5b58\u5728 exists name expire key seconds \u7ed9key\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u8d85\u65f6\uff1aseconds expire name 10 persist key \u53d6\u6d88key\u8fc7\u671f\u65f6\u95f4 persist name select index \u5207\u6362\u6570\u636e\u5e93\uff0c\u9ed8\u8ba4\u662f\u7b2c0\u4e2a\uff0c\u5171\u6709\u30100,15\u3011\u4e2a select 0 move key db \u4ece\u5f53\u524d\u6570\u636e\u5e93\u5c06key\u79fb\u52a8\u5230\u6307\u5b9adb\u5e93 move name 1 randomkey \u968f\u673a\u8fd4\u56de\u4e00\u4e2akey randomkey rename key newkey \u5c06key\u6539\u540d\u4e3anewkey rename name newname echo message \u6253\u5370message\u4fe1\u606f echo message dbsize \u67e5\u770bkey\u4e2a\u6570 dbsize info \u67e5\u770bredis\u6570\u636e\u5e93\u4fe1\u606f info config get * \u67e5\u770b\u6240\u6709redis\u914d\u7f6e\u4fe1\u606f config get * flushdb \u6e05\u7a7a\u5f53\u524d\u6570\u636e\u5e93 flushdb flushall \u6e05\u7a7a\u6240\u6709\u6570\u636e\u5e93 flushall Redis\u5b89\u5168\u6027 \u56e0\u4e3aRedis\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u6240\u4ee5\u5728\u4e00\u53f0\u6bd4\u8f83\u597d\u7684\u670d\u52a1\u5668\u4e0b,\u4e00\u4e2a\u5916\u90e8\u7528\u6237\u5728\u4e00\u79d2\u5185\u53ef\u4ee5\u8fdb\u884c15w\u6b21\u7684\u5bc6\u7801\u5c1d\u8bd5\uff0c\u8fd9\u610f\u5473\u4f60\u9700\u8981\u8bbe\u5b9a\u975e\u5e38\u5f3a\u5927\u7684\u5bc6\u7801\u6765\u65b9\u5f0f\u66b4\u529b\u7834\u89e3\u3002\u6b64\u65f6\u5c31\u9700\u8981\u5bf9Redis\u8fdb\u884c\u5bc6\u7801\u8bbe\u7f6e\u5566\u3002 Linux\u7cfb\u7edf \u7f16\u8f91 redis.conf\u6587\u4ef6\uff0c\u627e\u5230\u4e0b\u9762\u8fdb\u884c\u4fdd\u5b58\u4fee\u6539 requirepass \u81ea\u5b9a\u4e49\u5bc6\u7801 \u91cd\u542fRedis\u670d\u52a1\uff0c\u8bbf\u95ee\u65f6\uff0c\u4f7f\u7528\u5e26\u5bc6\u7801\u7684\u547d\u4ee4\uff1a redis-cli -a \u81ea\u5b9a\u4e49\u5bc6\u7801 \u5426\u5219\u4f1a\u63d0\u793a\uff1a (error)NOAUTH Authentication required. Window\u7cfb\u7edf \u8ddfLinux\u7cfb\u7edf\u4e00\u6837\uff0c\u533a\u522b\u662f\uff0cwindow\u7cfb\u7edf\u7684\u6587\u4ef6\u662f redis.window-service.config Redis\u4e8b\u52a1[\u62d3\u5c55] \u4e00\u4e2a\u4e8b\u52a1\u4ece\u5f00\u59cb\u5230\u6267\u884c\u4f1a\u7ecf\u5386\u4ee5\u4e0b\u4e09\u4e2a\u9636\u6bb5\uff1a \u5f00\u59cb\u4e8b\u52a1\u3002 \u547d\u4ee4\u5165\u961f\u3002 \u6267\u884c\u4e8b\u52a1\u3002 \u501f\u7528\uff1a\u83dc\u9e1f\u6559\u7a0b\u4e2d\u4f8b\u5b50 \u5b83\u5148\u4ee5 MULTI \u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\uff0c \u7136\u540e\u5c06\u591a\u4e2a\u547d\u4ee4\u5165\u961f\u5230\u4e8b\u52a1\u4e2d\uff0c \u6700\u540e\u7531 EXEC \u547d\u4ee4\u89e6\u53d1\u4e8b\u52a1\uff0c \u4e00\u5e76\u6267\u884c\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u547d\u4ee4\uff1a redis 127.0.0.1:6379> MULTI OK redis 127.0.0.1:6379> SET book-name \"Mastering C++ in 21 days\" QUEUED redis 127.0.0.1:6379> GET book-name QUEUED redis 127.0.0.1:6379> SADD tag \"C++\" \"Programming\" \"Mastering Series\" QUEUED redis 127.0.0.1:6379> SMEMBERS tag QUEUED redis 127.0.0.1:6379> EXEC 1) OK 2) \"Mastering C++ in 21 days\" 3) (integer) 3 4) 1) \"Mastering Series\" 2) \"C++\" 3) \"Programming\" \u5355\u4e2a Redis \u547d\u4ee4\u7684\u6267\u884c\u662f\u539f\u5b50\u6027\u7684\uff0c\u4f46 Redis \u6ca1\u6709\u5728\u4e8b\u52a1\u4e0a\u589e\u52a0\u4efb\u4f55\u7ef4\u6301\u539f\u5b50\u6027\u7684\u673a\u5236\uff0c\u6240\u4ee5 Redis \u4e8b\u52a1\u7684\u6267\u884c\u5e76\u4e0d\u662f\u539f\u5b50\u6027\u7684\u3002 Redis\u4e8b\u52a1\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a \u6253\u5305\u7684\u6279\u91cf\u6267\u884c\u811a\u672c \uff0c\u4f46\u6279\u91cf\u6307\u4ee4\u5e76\u975e\u539f\u5b50\u5316\u7684\u64cd\u4f5c\uff0c\u4e2d\u95f4\u67d0\u6761\u6307\u4ee4\u7684\u5931\u8d25\u4e0d\u4f1a\u5bfc\u81f4\u524d\u9762\u5df2\u505a\u6307\u4ee4\u7684\u56de\u6eda\uff0c\u4e5f\u4e0d\u4f1a\u9020\u6210\u540e\u7eed\u7684\u6307\u4ee4\u4e0d\u505a\u3002 127.0.0.1:6379> multi OK 127.0.0.1:6379(TX)> set name dafei QUEUED 127.0.0.1:6379(TX)> set age 18 QUEUED 127.0.0.1:6379(TX)> incr age QUEUED 127.0.0.1:6379(TX)> incr name QUEUED 127.0.0.1:6379(TX)> get age QUEUED 127.0.0.1:6379(TX)> get name QUEUED 127.0.0.1:6379(TX)> exec 1) OK 2) OK 3) (integer) 19 4) (error) ERR value is not an integer or out of range 5) \"19\" 6) \"dafei\" 127.0.0.1:6379> Redis \u4e8b\u52a1\u53ef\u4ee5\u4e00\u6b21\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c \u5e76\u4e14\u5e26\u6709\u4ee5\u4e0b\u4e09\u4e2a\u91cd\u8981\u7684\u4fdd\u8bc1\uff1a \u6279\u91cf\u64cd\u4f5c\u5728\u53d1\u9001 EXEC \u547d\u4ee4\u524d\u88ab\u653e\u5165\u961f\u5217\u7f13\u5b58\u3002 \u6536\u5230 EXEC \u547d\u4ee4\u540e\u8fdb\u5165\u4e8b\u52a1\u6267\u884c\uff0c\u4e8b\u52a1\u4e2d\u4efb\u610f\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff0c\u5176\u4f59\u7684\u547d\u4ee4\u4f9d\u7136\u88ab\u6267\u884c\u3002 \u5728\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\uff0c\u5176\u4ed6\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u547d\u4ee4\u8bf7\u6c42\u4e0d\u4f1a\u63d2\u5165\u5230\u4e8b\u52a1\u6267\u884c\u547d\u4ee4\u5e8f\u5217\u4e2d\u3002 Redis\u6301\u4e45\u5316\u673a\u5236[\u62d3\u5c55] \u5f15\u8a00 \u5148\u6765\u4e00\u4e2a\u5c0f\u5b9e\u9a8c\uff0c\u5927\u5bb6\u53ef\u4ee5\u4e00\u8d77\u5b9e\u73b0\u4e00\u4e0b \u6b65\u9aa41\uff1a\u5728Redis\u4e2d\u6dfb\u52a02\u4e2akey-value\u5bf9 127.0.0.1:6379> set aa aa OK 127.0.0.1:6379> set bb bb OK 127.0.0.1:6379> keys * \u6b65\u9aa42\uff1a\u91cd\u542fRedis \u670d\u52a1\u5668\uff0c\u5728\u6267\u884ckeys * \u89c2\u5bdf\u6570\u636e \u6b65\u9aa43\uff1a\u5206\u6790\u7ed3\u679c \u4f1a\u51fa\u73b0\u4e00\u4e0b\u51e0\u79cd\u7ed3\u679c\uff1a \u4e4b\u524d\u7684key\u5728\uff0caa bb \u90fd\u5728\uff08\u6700\u7406\u60f3\u7684\u7ed3\u679c\uff09 \u4e4b\u524d\u7684key\u5728\uff0caa\u4e5f\u5728\uff0cbb\u4e0d\u89c1\u4e86 \u4e4b\u524d\u7684key\u5728\uff0caa\uff0c bb \u4e0d\u5728 \u4e4b\u524d\u7684key\uff0c aa\uff0c bb \u90fd\u4e0d\u5728\u4e86\uff08\u6700\u574f\u7684\u7ed3\u679c\uff09 \u601d\u8003\uff1a \u4e3a\u5565\u4f1a\u8fd9\u6837\uff1f\u4ee5\u6211\u4eec\u5bf9\u5185\u5b58\u7684\u64cd\u4f5c\u7406\u89e3\uff0c\u6309\u9053\u7406\u91cd\u542f\u4e4b\u540e\u6570\u636e\u5e94\u8be5\u5168\u4e22\u5931\u4e86\uff0c\u4e3a\u5565Redis \u53ef\u80fd\u4e22\u5931\uff0c\u4e5f\u53ef\u80fd\u4e0d\u4e22\u5931\uff0c\u4e3a\u4f55\uff1f \u8fd9\u91cc\u5c31\u6d89\u53ca\u5230Redis\u7684\u6301\u4e45\u5316\u673a\u5236\u4e86\u3002 * Redis\u6301\u4e45\u5316\u673a\u5236\u76ee\u524d\u4ee5\u540e3\u79cd\uff0c\u5206\u522b\u4e3a\uff1a 1> \u5feb\u7167\u65b9\u5f0f \uff08RDB, Redis DataBase\uff09 2> \u6587\u4ef6\u8ffd\u52a0\u65b9\u5f0f \uff08AOF, Append Only File\uff09 3> \u6df7\u5408\u6301\u4e45\u5316\u65b9\u5f0f \uff08Redis4\u7248\u672c\u4e4b\u540e\uff09 RDB\u65b9\u5f0f Snapshotting(\u5feb\u7167)\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u5c06\u5185\u5b58\u6570\u636e\u4e2d\u4ee5\u5feb\u7167\u7684\u65b9\u5f0f\u5199\u5165\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u4e3adump.rdb\u3002\u89e6\u53d1RDB\u6301\u4e45\u5316\u8fc7\u7a0b\u5206\u624b\u52a8\u89e6\u53d1\u4e0e\u81ea\u52a8\u89e6\u53d1\u3002 \u89e6\u53d1\u673a\u5236 \u624b\u52a8\u89e6\u53d1 \u4f7f\u7528save\u547d\u4ee4\uff1a\u4f1a\u963b\u585e\u5f53\u524dRedis\u670d\u52a1\u5668\uff0c\u77e5\u9053RDB\u8fc7\u7a0b\u5b8c\u6210\u4e3a\u4e3b\uff0c\u5982\u679c\u5185\u5b58\u6570\u636e\u8f83\u591a\uff0c\u4f1a\u9020\u6210\u957f\u65f6\u95f4\u963b\u585e\uff0c\u5f71\u54cd\u5176\u4ed6\u547d\u4ee4\u7684\u4f7f\u7528\uff0c\u4e0d\u5efa\u8bae\u8f7b\u6613\u4f7f\u7528 \u4f7f\u7528bgsave\u547d\u4ee4\uff1aRedis\u8fdb\u7a0b\u6267\u884cfork\u6307\u4ee4\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u7531\u5b50\u8fdb\u7a0b\u5b9e\u73b0RDB\u6301\u4e45\u5316\uff0c\u6709\u9700\u8981\u65f6\u5efa\u8bae\u4f7f\u7528bgsave\u547d\u4ee4\u3002 \u81ea\u52a8\u89e6\u53d1 \u4f7f\u7528save\u76f8\u5173\u914d\u7f6e\uff0c\u683c\u5f0f\uff1a save m n \u8868\u793am\u79d2\u5185\u6570\u636e\u96c6\u5b58\u5728n\u6b21\u4fee\u6539\u65f6\u4f1a\u81ea\u52a8\u89e6\u53d1bgsave\u547d\u4ee4\u3002 save 900 1 #900\u79d2\u5185\u5982\u679c\u8d85\u8fc71\u4e2aKey\u88ab\u4fee\u6539\u5219\u53d1\u8d77\u5feb\u7167\u4fdd\u5b58 save 300 10 #300\u79d2\u5185\u5982\u679c\u8d85\u8fc710\u4e2akey\u88ab\u4fee\u6539,\u5219\u53d1\u8d77\u5feb\u7167\u4fdd\u5b58 save 60 10000 * \u4f18\u70b9 RDB\u5feb\u7167\u6587\u4ef6\u662f\u4e00\u4e2a\u7d27\u51d1\u538b\u7f29\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u975e\u5e38\u4f7f\u7528\u7528\u4e8e\u5907\u4efd\uff0c\u5168\u91cf\u590d\u5236\u7b49\u573a\u666f\u3002\u5f00\u53d1\u4e2d\u53ef\u4ee5\u6309\u7167\u6bcf6\u5c0f\u65f6\u6267\u884c\u4e00\u6b21bgsave\u5907\u4efd\uff0c\u7528\u4e8e\u5bb9\u707e\u5907\u4efd\u3002 Redis\u52a0\u8f7dRDB\u6062\u590d\u6570\u636e\u8fdc\u8fdc\u5feb\u4e8eAOF\u65b9\u5f0f \u7f3a\u70b9 RDB\u65e0\u6cd5\u505a\u5230\u5b9e\u65f6\u6301\u4e45\u5316/\u79d2\u7ea7\u6301\u4e45\u5316\uff0c\u6bcf\u6b21bgsave\u65f6\u90fd\u9700\u8981fork\u5b50\u8fdb\u7a0b\uff0c\u9891\u7e41\u6267\u884c\u6709\u65f6\u95f4\u6210\u672c\u3002 RDB\u5feb\u7167\u6587\u4ef6\u4e0d\u540c\u7248\u672c\u683c\u5f0f\u4e0d\u4e00\u6837\uff0c\u5bb9\u6613\u5f15\u8d77\u517c\u5bb9\u95ee\u9898\u3002 AOF\u65b9\u5f0f AOF\u4e0eRDB\u4e0d\u4e00\u6837\uff0c\u5b83\u662f\u4e00\u72ec\u7acb\u65e5\u5fd7\u7684\u65b9\u5f0f\u8bb0\u5f55\u6bcf\u6b21\u5199\u547d\u4ee4\uff0c\u91cd\u542f\u65f6\u518d\u91cd\u65b0\u6267\u884cAOF\u6587\u4ef6\u4e2d\u547d\u4ee4\u8fbe\u5230\u6062\u590d\u6570\u636e\u7684\u76ee\u7684\u3002\u89e3\u51b3\u4e86\u6570\u636e\u6301\u4e45\u5316\u7684\u5b9e\u65f6\u6027\u7684\u95ee\u9898\u3002 Redis\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u9700\u8981\u4f7f\u7528\u65f6\uff0c\u9700\u8981\u914d\u7f6e\uff1a appendonly yes AOF \u67093\u79cd\u6587\u4ef6\u540c\u6b65\u7b56\u7565 \u7b56\u7565 \u89e3\u91ca appendfsync always \u6536\u5230\u547d\u4ee4\u5c31\u7acb\u5373\u5199\u5230\u78c1\u76d8,\u6548\u7387\u6700\u6162.\u4f46\u662f\u80fd\u4fdd\u8bc1\u5b8c\u5168\u7684\u6301\u4e45\u5316 appendfsync everysec \u6bcf\u79d2\u5199\u5165\u78c1\u76d8\u4e00\u6b21,\u5728\u6027\u80fd\u548c\u6301\u4e45\u5316\u65b9\u9762\u505a\u4e86\u5f88\u597d\u7684\u6298\u4e2d appendfsync no \u5b8c\u5168\u4ee5\u4f9d\u8d56os\uff0c\u4e00\u822c\u540c\u6b65\u5468\u671f\u662f30\u79d2 * \u4f18\u70b9 AOF\u65b9\u5f0f\u6570\u636e\u5b89\u5168\u6027\u66f4\u9ad8\uff0c\u914d\u7f6e\u5f97\u5f53\uff0c\u6700\u591a\u635f\u59311\u79d2\u7684\u6570\u636e\u91cf \u5728\u4e0d\u5c0f\u5fc3\u6267\u884cflushall\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7AOF\u65b9\u5f0f\u6062\u590d(\u5220\u9664\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u5373\u53ef) AOF \u65e5\u5fd7\u662f\u4e00\u4e2a\u589e\u91cf\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e0d\u4f1a\u5b58\u5728\u65ad\u7535\u65f6\u51fa\u73b0\u635f\u574f\u95ee\u9898\u3002\u5373\u4f7f\u51fa\u73b0\u95ee\u9898\uff0credis-check-aof \u5de5\u5177\u4e5f\u80fd\u591f\u8f7b\u677e\u4fee\u590d\u5b83\u3002 \u5f53 AOF \u53d8\u5f97\u592a\u5927\u65f6\uff0cRedis \u80fd\u591f\u5728\u540e\u53f0\u81ea\u52a8\u91cd\u5199 AOF \u7f3a\u70b9 \u76f8\u540c\u6570\u636e\u91cf\u6765\u8bf4\uff0cAOF\u6587\u4ef6\u4f53\u79ef\u901a\u5e38\u5927\u4e8eRDB\u6587\u4ef6 \u6570\u636e\u6301\u4e45\u5316\u6027\u80fd\u4e0a\u6765\u8bf4\uff0cAOF \u6bd4 RDB \u6162 RDB-AOF\u6df7\u5408\u65b9\u5f0f \u6df7\u5408\u6301\u4e45\u5316\u662f\u7ed3\u5408\u4e86 RDB \u548c AOF \u7684\u4f18\u70b9\uff0c\u5728\u5199\u5165\u7684\u65f6\u5019\uff0c\u5148\u628a\u5f53\u524d\u7684\u6570\u636e\u4ee5 RDB \u7684\u5f62\u5f0f\u5199\u5165\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u518d\u5c06\u540e\u7eed\u7684\u64cd\u4f5c\u547d\u4ee4\u4ee5 AOF \u7684\u683c\u5f0f\u5b58\u5165\u6587\u4ef6\u3002\u5373\u4ee5 RDB \u4f5c\u4e3a\u5168\u91cf\u5907\u4efd\uff0cAOF \u4f5c\u4e3a\u589e\u91cf\u5907\u4efd\uff0c\u6765\u63d0\u9ad8\u5907\u4efd\u6548\u7387\u3002\u8fd9\u6837\u65e2\u80fd\u4fdd\u8bc1 Redis \u91cd\u542f\u65f6\u7684\u901f\u5ea6\uff0c\u53c8\u80fd\u9632\u6b62\u6570\u636e\u4e22\u5931\u7684\u98ce\u9669\uff0c \u8fd9\u5c31\u662f Redis 4.0 \u4e4b\u540e\u63a8\u51fa\u7684 RDB-AOF \u6df7\u5408\u6301\u4e45\u5316\u6a21\u5f0f\uff0c\u5176\u4f5c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u6765\u4f7f\u7528 \u3002 \u6301\u4e45\u5316\u673a\u5236\u9009\u62e9 \u5982\u679c\u5bf9\u6570\u636e\u5b89\u5168\u6027\u6709\u975e\u5e38\u9ad8\u7684\u8981\u6c42\uff0c\u5efa\u8bae RDB \u548c AOF \u540c\u65f6\u542f\u7528\u3002 \u5982\u679c\u5bf9\u6570\u636e\u5b89\u5168\u6027\u8981\u6c42\u4e0d\u662f\u5f88\u9ad8\uff0c\u80fd\u591f\u5bb9\u5fcd\u6570\u636e\u7684\u4e22\u5931\uff0c\u5efa\u8bae\u5355\u72ec\u4f7f\u7528 RDB\u3002 \u4e0d\u63a8\u8350\u5355\u72ec\u4f7f\u7528 AOF\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fdb\u884c\u6570\u636e\u5e93\u5907\u4efd\u3001\u66f4\u5feb\u91cd\u542f\u4ee5\u53ca AOF \u5f15\u64ce\u4e2d\u51fa\u73b0\u9519\u8bef\u7684\u60c5\u51b5\u6765\u8bf4\uff0cRDB \u662f\u66f4\u597d\u7684\u9009\u62e9\u3002 \u5982\u679c\u6ca1\u7279\u6b8a\u8981\u6c42\uff0cRedis\u53c8\u662f4.x\u7248\u672c\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u9009\u62e9RDB-AOF\u6df7\u5408\u65b9\u5f0f\u3002 \u5982\u679c\u4e0d\u662f\u6df7\u5408\u6a21\u5f0f\uff0c\u800c\u662f\u666e\u901a\u7684RDB\u4e0eAOF\u4e00\u8d77\u542f\u52a8\u65f6\uff0cRedis\u52a0\u8f7d\u6570\u636e\u6267\u884c\u6d41\u7a0b * Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236[\u62d3\u5c55] \u5f15\u8a00 Redis \u542f\u52a8\u4f1a\u52a0\u8f7d\u4e00\u4e2a\u914d\u7f6e\uff1a maxmemory <byte> //\u5185\u5b58\u4e0a\u9650 \u9ed8\u8ba4\u503c\u4e3a 0 (window\u7248\u7684\u9650\u5236\u4e3a100M)\uff0c\u8868\u793a\u9ed8\u8ba4\u8bbe\u7f6eRedis\u5185\u5b58\u4e0a\u9650\u3002\u4f46\u662f\u771f\u5b9e\u5f00\u53d1\u8fd8\u662f\u9700\u8981\u63d0\u524d\u8bc4\u4f30key\u7684\u4f53\u91cf\uff0c\u63d0\u524d\u8bbe\u7f6e\u597d\u5185\u5bb9\u4e0a\u9650\u3002 \u6b64\u65f6\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5f00\u53d1\u4e2d\uff0c\u5728\u8bbe\u7f6e\u5b8c\u5185\u5b58\u4e0a\u9650\u4e4b\u540e\uff0c\u5982\u679cRedis key\u8fbe\u5230\u4e0a\u9650\u4e86\uff0c\u8be5\u600e\u4e48\u529e\uff1f\u8fd9\u5c31\u8bbe\u7f6e\u5230Redis\u7684\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e86\u3002 \u5185\u5b58\u6dd8\u6c70\u7b97\u6cd5 Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e5f\u53ef\u4ee5\u79f0\u4e4b\u4e3akey\u5185\u5377\u673a\u5236\uff0c\u5f53\u8d44\u6e90\u4e0d\u8db3\u65f6\uff0c\u8be5\u5982\u4f55\u9009\u62e9\uff1f \u5e38\u89c1\u7684\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u5206\u4e3a\u56db\u5927\u7c7b\uff1a LRU\uff1a LRU\u662fLeast recently used\uff0c\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u610f\u601d\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u8be5\u7b97\u6cd5\u8ba4\u4e3a\uff0c\u4f60\u957f\u671f\u4e0d\u7528\u7684\u6570\u636e\uff0c\u90a3\u4e48\u88ab\u518d\u6b21\u8bbf\u95ee\u7684\u6982\u7387\u4e5f\u5c31\u5f88\u5c0f\u4e86\uff0c\u6dd8\u6c70\u7684\u6570\u636e\u4e3a\u6700\u957f\u65f6\u95f4\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u4ec5\u4e0e\u65f6\u95f4\u76f8\u5173\u3002 LFU\uff1a LFU\u662fLeast Frequently Used\uff0c\u6700\u4e0d\u7ecf\u5e38\u4f7f\u7528\u7684\u610f\u601d\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u6dd8\u6c70\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u4e0e\u9891\u6b21\u548c\u65f6\u95f4\u76f8\u5173\u3002 TTL\uff1a Redis\u4e2d\uff0c\u6709\u7684\u6570\u636e\u662f\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\uff0c\u800c\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u8fd9\u90e8\u5206\u6570\u636e\uff0c\u5c31\u662f\u8be5\u7b97\u6cd5\u8981\u89e3\u51b3\u7684\u5bf9\u8c61\u3002\u5982\u679c\u4f60\u5feb\u8fc7\u671f\u4e86\uff0c\u4e0d\u597d\u610f\u601d\uff0c\u6211\u5185\u5b58\u73b0\u5728\u4e0d\u591f\u4e86\uff0c\u53cd\u6b63\u4f60\u4e5f\u8981\u9000\u4f11\u4e86\uff0c\u63d0\u524d\u9001\u4f60\u4e00\u7a0b\uff0c\u628a\u4f60\u5e72\u6389\u5427\u3002 \u968f\u673a\u6dd8\u6c70\uff1a\u751f\u6b7b\u6709\u547d\uff0c\u5bcc\u8d35\u5728\u5929\uff0c\u662f\u5426\u88ab\u5e72\u6389\uff0c\u5168\u51ed\u5929\u610f\u4e86\u3002 Redis\u6dd8\u6c70\u7b56\u7565 Redis \u901a\u8fc7\u914d\u7f6e maxmemroy-policy \u6765\u914d\u7f6e\u6307\u5b9a\u5177\u4f53\u7684\u6dd8\u6c70\u673a\u5236\uff0c\u53ef\u4f9b\u9009\u62e9\u7684\u503c\u6709\uff1a \u901a\u8fc7maxmemroy-policy\u53ef\u4ee5\u914d\u7f6e\u5177\u4f53\u7684\u6dd8\u6c70\u673a\u5236\uff0c\u770b\u4e86\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u8bf4\u53ea\u67096\u79cd\uff0c\u5176\u5b9e\u67098\u79cd\uff0c\u53ef\u4ee5\u770bRedis5.0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0a\u9762\u6709\u8bf4\u660e\uff1a volatile-lru -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff08\u88ab\u8bbf\u95ee\u5230\uff09\u7684\u6570\u636e\u5e72\u6389\u3002 volatile-ttl -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u5373\u5c06\u8fc7\u671f\u7684\u6570\u636e\u5e72\u6389\u3002 volatile-random -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u8fdb\u884c\u65e0\u5dee\u522b\u653b\u51fb\uff0c\u968f\u673a\u5e72\u6389\u6570\u636e\u3002 volatile-lfu -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u5e72\u6389\u3002 allkeys-lru ->\u4e0e\u7b2c1\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 allkeys-lfu -> \u4e0e\u7b2c4\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 allkeys-random -> \u4e0e\u7b2c3\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 no-enviction -> \u4ec0\u4e48\u90fd\u4e0d\u5e72\uff0c\u62a5\u9519\uff0c\u544a\u8bc9\u4f60\u5185\u5b58\u4e0d\u8db3\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931 \u7cfb\u7edf\u9ed8\u8ba4\u9009\u62e9\uff1a noenviction \u8fc7\u671fKey\u5904\u7406[\u62d3\u5c55] \u63a5\u4e0b\u8ba8\u8bba\u4e00\u4e2a\u95ee\u9898\uff1aRedis\u7684key\u8fc7\u671f\u4e86\uff0c\u8be5\u5982\u4f55\u6e05\u7406\u95ee\u9898\u3002 Redis\u7ed9\u51fa3\u79cd\u5b9e\u73b0\u65b9\u6848\uff1a \u60f0\u6027\u5220\u9664 \uff1a\u5f53\u8bbf\u95eeKey\u65f6\uff0c\u624d\u53bb\u5224\u65ad\u5b83\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\uff0c\u76f4\u63a5\u5e72\u6389\u3002\u8fd9\u79cd\u65b9\u5f0f\u5bf9CPU\u5f88\u53cb\u597d\uff0c\u4f46\u662f\u4e00\u4e2akey\u5982\u679c\u957f\u671f\u4e0d\u7528\uff0c\u4e00\u76f4\u5b58\u5728\u5185\u5b58\u91cc\uff0c\u4f1a\u9020\u6210\u5185\u5b58\u6d6a\u8d39\u3002 \u5b9a\u65f6\u5220\u9664 \uff1a\u8bbe\u7f6e\u952e\u7684\u8fc7\u671f\u65f6\u95f4\u7684\u540c\u65f6\uff0c\u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5f53\u5230\u8fbe\u8fc7\u671f\u65f6\u95f4\u70b9\uff0c\u7acb\u5373\u6267\u884c\u5bf9Key\u7684\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5bf9CPU\u4e0d\u53cb\u597d\uff0c\u5f97\u989d\u5916\u8ba9\u51faCPU\u7ef4\u62a4\u5b9a\u65f6\u5668\u3002 \u5b9a\u671f\u5220\u9664 \uff1a\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u4e00\u6b21\u68c0\u67e5\uff0c\u5220\u9664\u91cc\u9762\u7684\u8fc7\u671fKey\uff0c\u81f3\u4e8e\u8981\u5220\u9664\u591a\u5c11\u8fc7\u671fKey\uff0c\u68c0\u67e5\u591a\u5c11\u6570\u636e\uff0c\u5219\u7531\u7b97\u6cd5\u51b3\u5b9a\u3002 Redis\u670d\u52a1\u5668\u5b9e\u9645\u4f7f\u7528\u7684\u662f\u60f0\u6027\u5220\u9664\u548c\u5b9a\u671f\u5220\u9664\u4e24\u79cd\u7b56\u7565\uff1a\u901a\u8fc7\u914d\u5408\u4f7f\u7528\u8fd9\u4e24\u79cd\u5220\u9664\u7b56\u7565\uff0c\u53ef\u4ee5\u5f88\u597d\u5730\u5728\u5408\u7406\u4f7f\u7528CPU\u548c\u907f\u514d\u6d6a\u8d39\u5185\u5b58\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002 Redis\u7f16\u7a0b \u6982\u51b5 Redis\u7f16\u7a0b\u5c31\u662f\u4f7f\u7528\u7f16\u7a0b\u65b9\u5f0f\u64cd\u4f5cRedis\uff0c\u5f53\u524dRedis\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u6709\uff1ahttps://redis.io/docs/clients/ \u8fd9\u91cc\u4ee5Java\u4e3a\u5f00\u53d1\u8bed\u8a00\uff0c\u9009\u62e9Java\u70b9\u51fb\u8fdb\u53bb java\u5b9e\u73b0\u64cd\u4f5cRedis\u7684\u5ba2\u6237\u7aef\u6709\u5f88\u591a\uff0c\u5176\u4e2d\u540d\u6c14\u6700\u9ad8\u7684\uff1a Redisson \uff0c Jedis \uff0c lettuce 3\u4e2a\u5ba2\u6237\u7aef\uff0c\u5176\u4e2dJedis\uff0clettuce\u4fa7\u91cd\u4e8e\u5355\u4f8bRedis \u6570\u636e\u5e93\u7684 CRUD\uff08\u589e\u5220\u6539\u67e5\uff09\uff0cRedisson \u4fa7\u91cd\u4e8e\u5206\u5e03\u5f0f\u5f00\u53d1\u3002\u5f53\u524d\u91cd\u70b9\u8bb2\u89e3Jedis\u4e0elettuce\u7684\u4f7f\u7528\uff0c\u540e\u7eed\u6709\u673a\u4f1a\u518d\u91cd\u70b9\u8bb2\u89e3Redisson\u4f7f\u7528\u3002 Jedis \u9879\u76ee\u4f7f\u7528\u7684SpringBoot\uff0c\u6240\u4ee5\u91cd\u70b9\u8bb2\u89e3SpringBoot\u7ee7\u627fJedis \u6b65\u9aa41\uff1a\u5efa\u9879\u76ee\uff0c\u5bfc\u5165\u4f9d\u8d56 <parent> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-parent</artifactId> <version>2.4.3</version> <relativePath/> <!-- lookup parent from repository --> </parent> <dependencies> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter</artifactId> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-test</artifactId> <scope>test</scope> </dependency> <dependency> <groupId>redis.clients</groupId> <artifactId>jedis</artifactId> </dependency> <dependency> <groupId>org.projectlombok</groupId> <artifactId>lombok</artifactId> </dependency> </dependencies> \u6b65\u9aa42\uff1a\u5bfc\u5165\u914d\u7f6e\u6587\u4ef6 #redis\u914d\u7f6e--jedis\u7248 jedis: pool: #redis\u670d\u52a1\u5668\u7684IP host: localhost #redis\u670d\u52a1\u5668\u7684Port port: 6379 #\u6570\u636e\u5e93\u5bc6\u7801 password: #\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 timeout: 7200 #\u6700\u5927\u6d3b\u52a8\u5bf9\u8c61\u6570 maxTotall: 100 #\u6700\u5927\u80fd\u591f\u4fdd\u6301idel\u72b6\u6001\u7684\u5bf9\u8c61\u6570 maxIdle: 100 #\u6700\u5c0f\u80fd\u591f\u4fdd\u6301idel\u72b6\u6001\u7684\u5bf9\u8c61\u6570 minIdle: 50 #\u5f53\u6c60\u5185\u6ca1\u6709\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u6700\u5927\u7b49\u5f85\u65f6\u95f4 maxWaitMillis: 10000 #\u5f53\u8c03\u7528borrow Object\u65b9\u6cd5\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5 testOnBorrow: true #\u5f53\u8c03\u7528return Object\u65b9\u6cd5\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5 testOnReturn: true #\u201c\u7a7a\u95f2\u94fe\u63a5\u201d\u68c0\u6d4b\u7ebf\u7a0b\uff0c\u68c0\u6d4b\u7684\u5468\u671f\uff0c\u6beb\u79d2\u6570\u3002\u5982\u679c\u4e3a\u8d1f\u503c\uff0c\u8868\u793a\u4e0d\u8fd0\u884c\u201c\u68c0\u6d4b\u7ebf\u7a0b\u201d\u3002\u9ed8\u8ba4\u4e3a-1. timeBetweenEvictionRunsMillis: 30000 #\u5411\u8c03\u7528\u8005\u8f93\u51fa\u201c\u94fe\u63a5\u201d\u5bf9\u8c61\u65f6\uff0c\u662f\u5426\u68c0\u6d4b\u5b83\u7684\u7a7a\u95f2\u8d85\u65f6\uff1b testWhileIdle: true # \u5bf9\u4e8e\u201c\u7a7a\u95f2\u94fe\u63a5\u201d\u68c0\u6d4b\u7ebf\u7a0b\u800c\u8a00\uff0c\u6bcf\u6b21\u68c0\u6d4b\u7684\u94fe\u63a5\u8d44\u6e90\u7684\u4e2a\u6570\u3002\u9ed8\u8ba4\u4e3a3. numTestsPerEvictionRun: 50 \u6b65\u9aa43\uff1a\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6 @Component @ConfigurationProperties(prefix = \"jedis.pool\") @Getter @Setter public class JedisProperties { private int maxTotall; private int maxIdle; private int minIdle; private int maxWaitMillis; private boolean testOnBorrow; private boolean testOnReturn; private int timeBetweenEvictionRunsMillis; private boolean testWhileIdle; private int numTestsPerEvictionRun; private String host; private String password; private int port; private int timeout; } \u6b65\u9aa44\uff1a\u7f16\u5199Jedis\u914d\u7f6e\u7c7b @Configuration public class JedisConfig { /** * jedis\u8fde\u63a5\u6c60 * @param jedisProperties * @return */ @Bean public JedisPool jedisPool(JedisProperties jedisProperties) { JedisPoolConfig config = new JedisPoolConfig(); config.setMaxTotal(jedisProperties.getMaxTotall()); config.setMaxIdle(jedisProperties.getMaxIdle()); config.setMinIdle(jedisProperties.getMinIdle()); config.setMaxWait(Duration.ofMillis(jedisProperties.getMaxWaitMillis())); config.setTestOnBorrow(jedisProperties.isTestOnBorrow()); config.setTestOnReturn(jedisProperties.isTestOnReturn()); config.setTimeBetweenEvictionRuns(Duration.ofMillis(jedisProperties.getTimeBetweenEvictionRunsMillis())); config.setTestWhileIdle(jedisProperties.isTestWhileIdle()); config.setNumTestsPerEvictionRun(jedisProperties.getNumTestsPerEvictionRun()); if (StringUtils.hasText(jedisProperties.getPassword())) { return new JedisPool(config, jedisProperties.getHost(), jedisProperties.getPort(), jedisProperties.getTimeout(), jedisProperties.getPassword()); } return new JedisPool(config, jedisProperties.getHost(), jedisProperties.getPort(), jedisProperties.getTimeout()); } } \u6b65\u9aa45\uff1a\u7f16\u5199\u6d4b\u8bd5\u7c7b\uff0c\u5b9e\u73b0\u6d4b\u8bd5 @SpringBootTest public class JedisTest { @Autowired private JedisPool jedisPool; @Test public void testConnection(){ System.out.println(jedisPool); Jedis jedis = jedisPool.getResource(); //\u9700\u6c42\uff1a\u5f80redis\u4e2d\u6dfb\u52a0kv\u5bf9\uff1a name\uff1adafei jedis.set(\"name\", \"dafei\"); System.out.println(jedis.get(\"name\")); jedis.close(); } } \u64cd\u4f5c\u6280\u5de7\uff1ajedis\u4e2d\u65b9\u6cd5\u8ddfRedis\u4e2d\u547d\u4ee4\u4e00\u6837 Lettuce Lettuce \u4e4b\u6240\u4ee5\u80fd\u6d41\u884c\uff0c\u56e0\u4e3a\u5b83\u62b1\u4e86\u6839\u597d\u5927\u817f-Spring-data\u3002Spring-data-redis\u5e95\u5c42\u5c31\u5c01\u88c5\u4e86Lettuce\uff0c\u63a5\u4e0b\u6765\u770b\u4e0bSpringboot\u7248\u7684lettuce\u5b9e\u73b0\u3002 \u6b65\u9aa41\uff1a\u5bfc\u5165\u4f9d\u8d56 <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-data-redis</artifactId> </dependency> \u6b65\u9aa42\uff1aRedis\u914d\u7f6e spring: redis: host: 127.0.0.1 port: 6379 password: admin \u6b65\u9aa43\uff1a\u7f16\u5199\u6d4b\u8bd5\u7c7b\uff0c\u5b9e\u73b0\u6d4b\u8bd5 @SpringBootTest public class LettureTest { @Autowired //\u7ea6\u5b9a\uff1a // \u64cd\u4f5credis\u7684key \u662f\u5b57\u7b26\u4e32 // value\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u5143\u7d20 private StringRedisTemplate template; @Test public void testRedis(){ //name\uff1adafei template.opsForValue().set(\"name\", \"dafei\"); System.out.println(template.opsForValue().get(\"name\")); // \u64cd\u4f5cstring //template.opsForValue().xx(); // \u64cd\u4f5chash //template.opsForHash().xx(); // \u64cd\u4f5clist //template.opsForList().xx(); // \u64cd\u4f5cset //template.opsForSet().xx(); // \u64cd\u4f5czset //template.opsForZSet().xx(); //spring-data-redis \u65b9\u6cd5\u662fredis \u547d\u4ee4\u5168\u79f0 //template.opsForList().rightPush() //rpush //\u5168\u5c40\u547d\u4ee4\u5728template\u7c7b\u4e0a //template.keys(\"*\"); } } \u64cd\u4f5c\u6280\u5de7\uff1aLettuce\u4e2d\u65b9\u6cd5\u8ddfRedis\u4e2d\u547d\u4ee4\u5168\u79f0 \u5c0f\u6848\u4f8b \u7c7b\u4f3c\u6548\u679c\uff1ahttps://www.mafengwo.cn/gonglve/ziyouxing/2339.html *","title":"redis-\u6d6a\u98deyes"},{"location":"redis/redis-langfei/#_1","text":"1>\u4e86\u89e3NoSQL\u6982\u5ff5 2>\u4e86\u89e3Redis\u6982\u5ff5\uff0c\u5b9a\u4f4d\uff0c\u4f18\u70b9\uff0c\u7f3a\u70b9 3>\u638c\u63e1Redis\u5e38\u7528\u4e94\u5927\u7c7b\u578b 4>\u638c\u63e1Redis Key \u4e0eValue\u503c\u8bbe\u8ba1 5>\u638c\u63e1Redis\u5168\u5c40\u547d\u4ee4 6>\u638c\u63e1Redis \u5b89\u5168\u4e0e\u4e8b\u52a1\u64cd\u4f5c 7>\u4e86\u89e3Redis\u6301\u4e45\u5316\u7b56\u7565 8>\u4e86\u89e3Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e0e\u8fc7\u671fKey\u6e05\u7406 9>\u638c\u63e1Java\u96c6\u6210Redis\u64cd\u4f5c 10>\u5b8c\u6210\u7efc\u5408\u6848\u4f8b\u8bbe\u8ba1\u4e0e\u5b9e\u73b0","title":"\u6559\u5b66\u76ee\u6807"},{"location":"redis/redis-langfei/#redis","text":"","title":"\u8ba4\u8bc6 Redis"},{"location":"redis/redis-langfei/#_2","text":"\u76ee\u524d\u6570\u636e\u5e93\u5206\uff1a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0e\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93 \u5e38\u7528\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff1a Oracle\uff0c MySQL \uff0cSqlServer\uff0cDB2 \u5e38\u7528\u7684\u975e\u5173\u7cfb\u6570\u636e\u5e93\uff1a Redis \uff0cMongoDB\uff0cElasticSearch\uff0c Hbase\uff0cNeo4j \u90a3\u5565\u662f\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5462\uff1f\u6b64\u5904\u6d89\u53ca\u5230\u65b0\u540d\u8bcd\uff1aNoSQL NoSQL \u6700\u5e38\u89c1\u7684\u89e3\u91ca\u662f\u201cnon-relational\u201d\uff0c \u201cNot Only SQL\u201d\u4e5f\u88ab\u5f88\u591a\u4eba\u63a5\u53d7\u3002NoSQL\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6982\u5ff5\uff0c\u6cdb\u6307\u975e\u5173\u7cfb\u578b\u7684\u6570\u636e\u5e93\uff0c\u533a\u522b\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u5b83\u4eec\u4e0d\u4fdd\u8bc1\u5173\u7cfb\u6570\u636e\u7684ACID\u7279\u6027\u3002\u8be6\u60c5\u89c1\uff1a\u767e\u5ea6\u767e\u79d1\uff1ahttps://baike.baidu.com/item/NoSQL/8828247?fr=aladdin \u7ecf\u5178\u6848\u4f8b *","title":"\u6570\u636e\u5e93\u5206\u7c7b"},{"location":"redis/redis-langfei/#nosql","text":"*","title":"NoSQL\u5206\u7c7b"},{"location":"redis/redis-langfei/#redis_1","text":"","title":"\u4ec0\u4e48\u662fRedis"},{"location":"redis/redis-langfei/#redis_2","text":"\u662f\u4ee5key-value\u5f62\u5f0f\u5b58\u50a8,\u548c\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0d\u4e00\u6837.\u4e0d\u4e00\u5b9a\u9075\u5faa\u4f20\u7edf\u6570\u636e\u5e93\u7684\u4e00\u4e9b\u57fa\u672c\u8981\u6c42.(\u975e\u5173\u7cfb\u578b\u7684,\u5206\u5e03\u5f0f\u7684,\u5f00\u6e90\u7684,\u6c34\u5e73\u53ef\u62d3\u5c55\u7684) \u4f18\u70b9: \u5bf9\u6570\u636e\u9ad8\u5e76\u53d1\u8bfb\u5199 (\u76f4\u63a5\u662f\u5185\u5b58\u4e2d\u8fdb\u884c\u8bfb\u5199\u7684) \u5bf9\u6d77\u91cf\u6570\u636e\u7684\u9ad8\u6548\u7387\u5b58\u50a8\u548c\u8bbf\u95ee \u5bf9\u6570\u636e\u7684\u53ef\u62d3\u5c55\u6027\u548c\u9ad8\u53ef\u7528\u6027. \u5355\u7ebf\u7a0b\u64cd\u4f5c ,\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u64cd\u4f5c,\u6ca1\u6709\u5e76\u53d1\u76f8\u5173\u95ee\u9898(redis 6) \u7f3a\u70b9: redis(ACID\u5904\u7406\u975e\u5e38\u7b80\u5355) \u65e0\u6cd5\u505a\u592a\u590d\u6742\u7684\u5173\u7cfb\u6570\u636e\u5e93\u6a21\u578b *","title":"Redis\u7b80\u4ecb"},{"location":"redis/redis-langfei/#redis_3","text":"\u6bd4\u8f83\u8457\u540d\u7684\u516c\u53f8\u6709\uff1a github\u3001blizzard\u3001stackoverflow\u3001flickr \u56fd\u5185 \u65b0\u6d6a\u5fae\u535a\uff08\u5168\u7403\u6700\u5927\u7684redis\u96c6\u7fa4\uff09\u30102017\u3011 2200+\u4ebf commands/day 5000\u4ebfRead/day 500\u4ebfWrite/day 18TB+ Memory 500+ Servers in 6 IDC 2000+instances \u6dd8\u5b9d \u817e\u8baf\u5fae\u535a","title":"\u8c01\u5728\u7528Redis"},{"location":"redis/redis-langfei/#redis_4","text":"redis\u5728\u7ebf\u5165\u95e8 \uff1a http://try.redis.io/ redis \u4e2d\u6587\u8d44\u6599\u7ad9\uff1a http://www.redis.cn/ https://www.runoob.com/redis/redis-tutorial.html","title":"\u600e\u4e48\u5b66redis"},{"location":"redis/redis-langfei/#redis_5","text":"\u9898\u5916\u8bdd\uff1a Redis\u662f\u4f7f\u7528C\u5199\u7684\u7a0b\u5e8f\uff0c\u76ee\u524d\u4e3b\u6d41\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b98\u65b9\u4e0d\u63d0\u4f9bWindow\u7248\uff0c\u6700\u65b0\u7684Redis\u7248\uff1aRedis7.x \u5b98\u7f51\u4e0b\u8f7d\uff1ahttps://redis.io/download/ Redis \u7684Window\u7248\u662f\u5fae\u8f6f\u516c\u53f8\u81ea\u884c\u79fb\u690d\u7684\uff0c\u76ee\u524d\u6700\u65b0\u7248\uff1aRedis-x64-3.2.100 window\u7248\uff1ahttps://github.com/microsoftarchive/redis/releases/tag/win-3.2.100 \u65b0\u7248\u63a7\u7684\u540c\u5b66\uff1a 1>\u8d2d\u4e70\u963f\u91cc\u4e91Redis https://www.aliyun.com/minisite/goods?taskPkg=amb618all&pkgSid=442814&recordId=4183761&userCode=sd4xtwwm 2>\u8d2d\u4e70\u963f\u91cc\u4e91ECS \u8d2d\u4e70\u670d\u52a1\u5668\uff0c\u81ea\u5df1\u642d\u5efa\u6700\u65b0\u7248\u7684Redis 3>\u5b89\u88c5\u865a\u62df\u673a\uff1aLinux\uff0c\u518d\u5b89\u88c5\u6700\u65b0\u7248Redis \u8fd9\u4e2a\uff0c\u9879\u76ee\u4e09\u8bb2Linux\u64cd\u4f5c\u7cfb\u7edf\u65f6\u518d\u6559\u3002","title":"Redis\u7684\u5b89\u88c5"},{"location":"redis/redis-langfei/#_3","text":"\u7248\u672c\uff1aRedis-x64-3.2.100.msi \u50bb\u74dc\u5f0f\u5b89\u88c5,\u4e0b\u4e00\u6b65,\u4e0b\u4e00\u6b65\u5c31\u53ef\u4ee5\u4e86 \u6ce8\u610f\uff1a\u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf\u4e2d * \u6ce8\u610f\uff1a\u9ed8\u8ba4\u7aef\u53e3 * \u6ce8\u610f\uff1a\u6700\u5927\u5185\u5b58 * \u6d4b\u8bd5\u662f\u5426\u6210\u529f * *","title":"\u670d\u52a1\u7aef"},{"location":"redis/redis-langfei/#-redisclient","text":"\u6253\u5f00CMD\u547d\u4ee4\u6846\uff0c\u8f93\u5165\u547d\u4ee4\uff1a java -jar redisclient.jar","title":"\u5ba2\u6237\u7aef--redisclient"},{"location":"redis/redis-langfei/#-redisdesktopclient","text":"","title":"\u5ba2\u6237\u7aef--RedisDesktopClient"},{"location":"redis/redis-langfei/#-rdm","text":"","title":"\u5ba2\u6237\u7aef--rdm"},{"location":"redis/redis-langfei/#_4","text":"","title":"\u6570\u636e\u7c7b\u578b"},{"location":"redis/redis-langfei/#_5","text":"Redis\u652f\u6301\u7684\u5b58\u50a8\u6570\u636e\u7c7b\u578b\u6709\u5f88\u591a\uff1a \u5e38\u7528\uff1a string \uff08\u5b57\u7b26\u4e32\uff09\uff0c hash \uff08\u54c8\u5e0c\uff09\uff0c list \uff08\u5217\u8868\uff09\uff0c set \uff08\u96c6\u5408\uff09\u53ca zset (sorted set\uff1a\u6709\u5e8f\u96c6\u5408) \u4e0d\u5e38\u7528\uff1aHyperLogLog\uff0cBitmap(\u4f4d\u56fe)\uff0cBloom Filter(\u5e03\u9686\u8fc7\u6ee4\u5668)\uff0cGeospatial(\u5730\u7406\u4f4d\u7f6e) \uff0cModule(\u6a21\u5757)\uff0c Streams(\u6d41\u4fe1\u606f) \u6b64\u5904\u91cd\u70b9\u8bb2\u89e3\u5e38\u7528\u7684\u7c7b\u578b\u3002 \u547d\u4ee4\u683c\u5f0f \u7c7b\u578b\u547d\u4ee4 key \u53c2\u6570\u6570\u636e set name dafei \u64cd\u4f5c\u5efa\u8bae Redis\u64cd\u4f5c\u6709\u70b9\u7c7b\u4f3cJava\u7684Map\u96c6\u5408\uff0c\u90fd\u662fkey-value\u5f62\u5f0f\u5b58\u50a8\u6570\u636e\uff0c\u5728\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u8fdb\u884c\u7c7b\u6bd4\u3002 \u53e6\u5916Redis\u4e2d\u7684key\u5927\u90e8\u5206\u4e3aString\u7c7b\u578b\uff0cvalue\u503c\u6839\u636e\u7f13\u5b58\u6570\u636e\u7ed3\u6784\u53ef\u4ee5\u9009\u7528\uff1astring\uff0chash\uff0clist\uff0cset\uff0czset\u7b49\u7c7b\u578b\u3002 \u6ce8\u610f\uff1a\u4e0b\u9762\u8bb2\u7684\u5404\u79cd\u7c7b\u578b\uff0c\u8868\u8ff0\u7684\u662f\u7f13\u5b58\u6570\u636e\u7684value\u7c7b\u578b\u3002","title":"\u6982\u51b5"},{"location":"redis/redis-langfei/#string","text":"String\u7c7b\u578b\u5305\u542b\u591a\u79cd\u7c7b\u578b\u7684\u7279\u6b8a\u7c7b\u578b\uff0c\u5e76\u4e14\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff0c\u5176\u503c\u53ef\u4ee5\u662f\u6570\u503c\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map map \u5728Redis\u5185\u5bb9\u6570\u636e\u5b58\u50a8\u7ed3\u6784\uff1a *","title":"String\u7c7b\u578b"},{"location":"redis/redis-langfei/#_6","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b set key value \u5c06key-value\u7f13\u5b58redis\u4e2d set name dafei get key \u4eceredis\u4e2d\u83b7\u53d6key\u5bf9\u5e94value\u503c get name incr key \u5c06key\u5bf9\u5e94value\u503c + 1 incr age decr key \u5c06key\u5bf9\u5e94value\u503c-1 decr age setex key seconds value \u5c06key-value\u7f13\u5b58\u5230redis\u4e2d\uff0cseconds \u79d2\u540e\u5931\u6548 setex sex 10 man ttl key \u67e5\u770bkey\u5b58\u6d3b\u65f6\u95f4 ttl sex del key \u4eceredis\u4e2d\u5220\u9664key del name setnx key value \u5982\u679ckey\u5df2\u7ecf\u5b58\uff0c\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5982\u679ckey\u4e0d\u5b58\uff0c\u76f4\u63a5\u6dfb\u52a0 setnx name xiaofei","title":"\u5e38\u7528\u7684\u547d\u4ee4"},{"location":"redis/redis-langfei/#_7","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b incrby key increment \u7ed9key\u5bf9\u5e94\u503c\u52a0increment incrby age 10 mset k1 v1 k2 v2.... \u6279\u91cf\u6dfb\u52a0k1v1 k2v2 key value\u5bf9 mset name dafei age 18 mget k1 k2.... \u6279\u91cf\u83b7\u53d6k1, k2\u7684\u503c mget name age append key value \u5728key\u5bf9\u5e94\u7684value\u503c\u4e2d\u62fc+value append name yes setrange key offset value \u4fee\u6539key\u5bf9\u5e94\u7684value\u503c,\u66ff\u6362\u4e3a\u6307\u5b9avalue,\u51b2offset\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb setrange name 2 xx","title":"\u975e\u5e38\u7528\u547d\u4ee4"},{"location":"redis/redis-langfei/#_8","text":"1>\u8ba1\u6570\u5668 \u5982\uff1a\u89c6\u9891\u64ad\u653e\u6570\u7cfb\u7edf\u5c31\u662f\u4f7f\u7528redis\u4f5c\u4e3a\u89c6\u9891\u64ad\u653e\u6570\u8ba1\u6570\u7684\u57fa\u7840\u7ec4\u4ef6\u3002 incr viewnum 1 2>\u5171\u4eabsession \u51fa\u4e8e\u8d1f\u8f7d\u5747\u8861\u7684\u8003\u8651\uff0c\u5206\u5e03\u5f0f\u670d\u52a1\u4f1a\u5c06\u7528\u6237\u4fe1\u606f\u7684\u8bbf\u95ee\u5747\u8861\u5230\u4e0d\u540c\u670d\u52a1\u5668\u4e0a\uff0c\u7528\u6237\u5237\u65b0\u4e00\u6b21\u8bbf\u95ee\u53ef\u80fd\u4f1a\u9700\u8981\u91cd\u65b0\u767b\u5f55\uff0c\u4e3a\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528redis\u5c06\u7528\u6237session\u96c6\u4e2d\u7ba1\u7406\uff0c \u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u53ea\u8981\u4fdd\u8bc1redis\u7684\u9ad8\u53ef\u7528\u548c\u6269\u5c55\u6027\u7684\uff0c\u6bcf\u6b21\u83b7\u53d6\u7528\u6237\u66f4\u65b0\u6216\u67e5\u8be2\u767b\u5f55\u4fe1\u606f\u90fd\u76f4\u63a5\u4eceredis\u4e2d\u96c6\u4e2d\u83b7\u53d6\u3002 user_login_info:uid---->{\"id\":1, \"name\":\"dafei\", \"age\":18}","title":"\u5e94\u7528\u573a\u666f"},{"location":"redis/redis-langfei/#hash","text":"Hash\u7c7b\u578b\u662fString\u7c7b\u578b\u7684field\u548cvalue\u7684\u6620\u5c04\u8868\uff0c\u6216\u8005\u8bf4\u662f\u4e00\u4e2aString\u96c6\u5408\u3002\u5b83\u7279\u522b\u9002\u5408\u5b58\u50a8\u5bf9\u8c61\uff0c\u76f8\u6bd4\u8f83\u800c\u8a00\uff0c\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5b58\u50a8\u5728Hash\u7c7b\u578b\u91cc\u8981\u6bd4\u5b58\u50a8\u5728String\u7c7b\u578b\u91cc\u5360\u7528\u66f4\u5c11\u7684\u5185\u5b58\u7a7a\u95f4\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map > map *","title":"Hash\u7c7b\u578b"},{"location":"redis/redis-langfei/#_9","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b hset key field value \u5c06field value\u5bf9\u7f13\u5b58\u5230redis\u4e2dhash\u4e2d\uff0c\u952e\u503c\u4e3akey hset user name dafei hget key field \u4ecekey\u5bf9\u5e94hash\u5217\u8868\u4e2d\u83b7\u53d6field\u5b57\u6bb5 hget user name hexists key field \u5224\u65adkey\u5bf9\u5e94\u7684hash\u5217\u8868\u662f\u5426\u5b58\u5728 field\u5b57\u6bb5 hexists user age hdel key field \u5220\u9664key\u5bf9\u5e94hash\u5217\u8868\u4e2dfield\u5b57\u6bb5 hdel user age hincrby key field increment \u7ed9key\u5bf9\u5e94hash\u5217\u8868\u4e2dfield\u5b57\u6bb5 + increment hincrby user age 10 hlen key \u67e5\u770bkey\u5bf9\u5e94\u7684hash\u5217\u8868field\u7684\u6570\u91cf hlen user hkeys key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u6240\u6709\u7684field\u503c hkeys user hvals key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u6240\u6709\u7684field\u5bf9\u5e94\u7684value\u503c kvals user hgetall key \u83b7\u53d6key\u5bf9\u5e94\u7684hash\u5217\u8868\u4e2d\u6240\u6709\u7684field\u53ca\u5176\u5bf9\u5e94\u7684value\u503c hgetall user","title":"\u5e38\u7528\u7684\u547d\u4ee4"},{"location":"redis/redis-langfei/#_10","text":"Hash\u7ed3\u6784\u76f8\u5bf9\u4e8e\u5b57\u7b26\u4e32\u5e8f\u5217\u5316\u7f13\u5b58\u4fe1\u606f\u66f4\u52a0\u76f4\u89c2\uff0c\u5e76\u4e14\u5728\u66f4\u65b0\u64cd\u4f5c\u4e0a\u66f4\u52a0\u4fbf\u6377\u3002 \u5171\u4eabsession\u8bbe\u8ba1 public class User{ private String userame; private String password; private int age; } \u767b\u5f55\u7528\u6237\uff1a User user = new User(\"dafei\", \"666\", 18); \u767b\u5f55\u7f13\u5b58\uff1a key\uff1a user_token value\uff1a new User(\"dafei\", \"666\", 18) ---------------------------------------------------------------------------------------------- \u65b9\u68481\uff1a \u5c06user\u5bf9\u8c61\u8f6c\u6362json\u683c\u5f0f\u5b57\u7b26\u4e32\u5b58redis \u3010\u4fa7\u91cd\u4e8e\u67e5\uff0c \u6539\u975e\u5e38\u9ebb\u70e6\u3011 key value --------------------------------------------------------------------------------------------- user_token \uff1a \"{name:dafei, age:18, password:666}\" \u65b9\u68482\uff1a \u5c06user\u5bf9\u8c61\u8f6c\u6362hash\u5bf9\u8c61\u5b58redis\u3010\u4fa7\u91cd\u4e8e\u6539\uff0c\u67e5\u8be2\u76f8\u5bf9\u9ebb\u70e6\u3011 key value --------------------------------------------------------------------------------------------- user_token \uff1a { \u200b name\uff1addafei \u200b age \uff1a 18 \u200b password\uff1a 666 \u200b }","title":"\u5e94\u7528\u573a\u666f"},{"location":"redis/redis-langfei/#list","text":"Redis\u4e2d\u7684List\u7c7b\u4f3cJava\u4e2d\u7684Queue,\u4e5f\u53ef\u4ee5\u5f53\u505aList\u6765\u7528. List\u7c7b\u578b\u662f\u4e00\u4e2a\u94fe\u8868\u7ed3\u6784\u7684\u96c6\u5408\uff0c\u5176\u4e3b\u8981\u529f\u80fd\u6709push\u3001pop\u3001\u83b7\u53d6\u5143\u7d20\u7b49\uff0c\u66f4\u8be6\u7ec6\u7684\u8bf4,List\u7c7b\u578b\u662f\u4e00\u4e2a\u53cc\u7aef\u94fe\u8868\u7684\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u76f8\u5173\u64cd\u4f5c\u8fdb\u884c\u96c6\u5408\u7684\u5934\u90e8\u6216\u8005\u5c3e\u90e8\u6dfb\u52a0\u5220\u9664\u5143\u7d20\uff0cList\u7684\u8bbe\u8ba1\u975e\u5e38\u7b80\u5355\u7cbe\u5de7\uff0c\u5373\u53ef\u4ee5\u4f5c\u4e3a\u6808,\u53c8\u53ef\u4ee5\u4f5c\u4e3a\u961f\u5217\uff0c\u6ee1\u8db3\u7edd\u5927\u591a\u6570\u9700\u6c42. \u7c7b\u4f3cJava\u4e2d\uff1a Map map *","title":"List\u7c7b\u578b"},{"location":"redis/redis-langfei/#_11","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b rpush key value \u4ece\u53f3\u8fb9\u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0value\u503c rpush hobby java lrange key start stop \u4ece\u5de6\u8fb9\u5f00\u59cb\u5217\u8868key\u96c6\u5408\uff0c\u4ecestart\u4f4d\u7f6e\u5f00\u59cb\uff0cstop\u4f4d\u7f6e\u7ed3\u675f lrange hobby 0 -1 lpush key value \u4ece\u5de6\u8fb9\u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0value\u503c lpush hobby c++ lpop key \u5f39\u51fakey\u96c6\u5408\u4e2d\u6700\u5de6\u8fb9\u7684\u6570\u636e lpop hobby rpop key \u5f39\u51fakey\u96c6\u5408\u4e2d\u6700\u53f3\u8fb9\u7684\u6570\u636e rpop hobby llen key \u83b7\u53d6\u5217\u8868\u957f\u5ea6 llen hooby","title":"\u5e38\u7528\u7684\u547d\u4ee4"},{"location":"redis/redis-langfei/#_12","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b linsert key before pivot value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5728pivot\u503c\u4e4b\u524d\u63d2\u5165value linsert hobby before java c# linsert key after pivot value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5728pivot\u503c\u4e4b\u540e\u63d2\u5165value linsert hobby after java c# lset key index value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u66f4\u65b0\u7d22\u5f15index\u4f4d\u7f6e\u503c\u4e3avalue lset hobby 1 go lrem key count value \u64cd\u4f5ckey\u96c6\u5408\uff0c\u5220\u9664 count\u4e2a value\u503c lrem hobby 3 go ltrim key start stop \u64cd\u4f5ckey\u96c6\u5408\uff0c\u4ecestart\u5230stop\u622a\u53d6\u81ea\u5217\u8868 ltrim hobby 2 4 lindex key index \u64cd\u4f5ckey\u96c6\u5408\uff0c\u83b7\u53d6\u7d22\u5f15\u4e3aindex\u4f4d\u7f6e\u7684\u6570\u636e lindex hobby 1","title":"\u975e\u5e38\u7528\u547d\u4ee4"},{"location":"redis/redis-langfei/#_13","text":"1>\u7528\u6237\u6536\u85cf\u6587\u7ae0\u5217\u8868\uff1a key\uff1auser_favor_article_list value: [aid1, aid2, aid3......]","title":"\u5e94\u7528\u573a\u666f"},{"location":"redis/redis-langfei/#set","text":"Set\u96c6\u5408\u662fString\u7c7b\u578b\u7684\u65e0\u5e8f\u96c6\u5408,set\u662f\u901a\u8fc7HashTable\u5b9e\u73b0\u7684\uff0c\u5bf9\u96c6\u5408\u6211\u4eec\u53ef\u4ee5\u53d6 \u4ea4\u96c6\u3001\u5e76\u96c6\u3001\u5dee\u96c6\u3002 \u7c7b\u4f3cJava\u4e2d\uff1a Map map *","title":"Set\u7c7b\u578b"},{"location":"redis/redis-langfei/#_14","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b sadd key members [....] \u5f80key \u96c6\u5408\u4e2d\u6dfb\u52a0member\u5143\u7d20 sadd myset a b c smembers key \u904d\u5386key\u96c6\u5408\u4e2d\u6240\u6709\u7684\u5143\u7d20 smembers myset srem key members [....] \u5220\u9664key\u96c6\u5408\u4e2dmembers\u5143\u7d20 srem myset a spop key count \u4ecekey\u96c6\u5408\u4e2d\u968f\u673a\u5f39\u51facount\u4e2a\u5143\u7d20 spop myset 1","title":"\u5e38\u7528\u7684\u547d\u4ee4"},{"location":"redis/redis-langfei/#_15","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b sdiff key1 key2 \u8fd4\u56dekey1\u4e2d\u7279\u6709\u7684\u5143\u7d20(\u5dee\u96c6) sdiff key1 key2 sidiffstore dest key1 key2 \u8fd4\u56dekey1\u4e2d\u7279\u6709\u7684\u5143\u7d20\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sidiffstore dest key1 key2 sinter key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u4ea4\u96c6 sinter key1 key2 sinterstore dest key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u4ea4\u96c6\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sinterstore dest key1 key2 sunion key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u5e76\u96c6 sunion key1 key2 sunionstore dest key1 key2 \u8fd4\u56dekey1\u8ddfkey2\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u7f13\u5b58\u5230dest\u96c6\u5408\u4e2d sunionstore dest key1 key2 smove source destination member \u5c06source\u96c6\u5408\u4e2dmember\u5143\u7d20\u79fb\u52a8\u5230destination\u96c6\u5408\u4e2d smove key1 key2 aa sismember key member \u5224\u65admember\u5143\u7d20\u662f\u5426\u5728key\u96c6\u5408\u4e2d sismember key1 aa srandmember key count \u968f\u673a\u83b7\u53d6set\u96c6\u5408\u4e2dcount \u4e2a\u5143\u7d20 srandmember key1 1","title":"\u975e\u5e38\u7528\u547d\u4ee4"},{"location":"redis/redis-langfei/#_16","text":"1\uff0c\u53bb\u91cd\uff1b 2\uff0c\u62bd\u5956; \u200b 1\uff1a\u51c6\u5907\u4e00\u4e2a\u62bd\u5956\u6c60:sadd luckydraw 1 2 3 4 5 6 7 8 9 10 11 12 13 \u200b 2\uff1a\u62bd3\u4e2a\u4e09\u7b49\u5956:spop luckydraw 3 \u200b 3\uff1a\u62bd2\u4e2a\u4e8c\u7b49\u5956:spop luckydraw 2 \u200b 4\uff1a\u62bd1\u4e2a:\u4e00\u7b49\u5956:spop luckydraw 1","title":"\u5e94\u7528\u573a\u666f"},{"location":"redis/redis-langfei/#sorted-set","text":"Sorted set \u4e5f\u79f0Zset\u7c7b\u578b\uff0c\u662f\u4e00\u79cd\u5177\u6709\u6392\u5e8f\u6548\u679c\u7684set\u96c6\u5408\u3002\u5b83\u8ddfset\u96c6\u5408\u4e00\u6837\u4e5f\u662f string \u7c7b\u578b\u5143\u7d20\u7684\u96c6\u5408\uff0c\u4e14\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u6210\u5458\u3002\u5e76\u4e14\u8981\u6c42\u6bcf\u4e2a\u5143\u7d20\u90fd\u4f1a\u5173\u8054\u4e00\u4e2adouble \u7c7b\u578b\u7684\u5206\u6570\u3002\u540e\u7eed\u53ef\u4ee5\u901a\u8fc7\u5206\u6570\u6765\u4e3a\u96c6\u5408\u4e2d\u7684\u6210\u5458\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u7684\u6392\u5e8f\u3002 Sorted set\u96c6\u5408\u662f\u901a\u8fc7\u54c8\u5e0c\u8868\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u6dfb\u52a0\uff0c\u5220\u9664\uff0c\u67e5\u627e\u7684\u590d\u6742\u5ea6\u90fd\u662f O(1)\u3002 \u96c6\u5408\u4e2d\u6700\u5927\u7684\u6210\u5458\u6570\u4e3a 232 - 1 (4294967295, \u6bcf\u4e2a\u96c6\u5408\u53ef\u5b58\u50a840\u591a\u4ebf\u4e2a\u6210\u5458)\u3002 \u6570\u636e\u7f13\u5b58\u7ed3\u6784\uff1a *","title":"Sorted set \u7c7b\u578b"},{"location":"redis/redis-langfei/#_17","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b zadd key score member \u5f80key\u96c6\u5408\u4e2d\u6dfb\u52a0member\u5143\u7d20\uff0c\u5206\u6570\u4e3ascore zadd players 100 a zincrby key increment member \u5c06key\u96c6\u5408\u4e2d\u7684member\u5143\u7d20 \u5206\u6570 + increment zadd players 100 a zrange key start stop [withscores] \u5c06key\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u6309\u5206\u6570\u5347\u5e8f\u6392\u5217 [\u663e\u5f0f\u5206\u6570] zrange players 0 -1 withscores zrevrange key start stop [withscores] \u5c06key\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u6309\u5206\u6570\u964d\u5e8f\u6392\u5217 [\u663e\u5f0f\u5206\u6570] zrevrange players 0 -1 withscores zrank key member \u8fd4\u56demember\u5143\u7d20\u5728key\u7ed3\u5408\u4e2d\u7684\u6b63\u5e8f\u6392\u540d zrank players a zrevrank key member \u8fd4\u56demember\u5143\u7d20\u5728key\u7ed3\u5408\u4e2d\u7684\u5012\u5e8f\u6392\u540d zrevrank players a zcard key \u8fd4\u56dekey\u96c6\u5408\u5143\u7d20\u4e2a\u6570 zcard players","title":"\u5e38\u7528\u7684\u547d\u4ee4"},{"location":"redis/redis-langfei/#_18","text":"\u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b zrangebyscore key min max [withscores] \u6309[min, max) \u5206\u6570\u8303\u56f4\u8fd4\u56dekey\u96c6\u5408\u4e2d\u5143\u7d20(\u6b63\u5e8f) zrangebyscore players 200 300 withscores zrevrangebyscore key min max [withscores] \u6309[min, max) \u5206\u6570\u8303\u56f4\u8fd4\u56dekey\u96c6\u5408\u4e2d\u5143\u7d20(\u5012\u5e8f) zrevrangebyscore players 200 300 withscores zrem key member \u5220\u9664key\u96c6\u5408\u4e2dmember\u5143\u7d20\u4e0e\u5206\u6570 zrem players a zremrangebyscore key min max withscores \u6309[min, max) \u5206\u6570\u8303\u56f4\u5220\u9664key\u96c6\u5408\u4e2d\u5143\u7d20 zremrangebyscore players 200 300 withscores zremrangebyrank key start stop \u5220\u9664key\u96c6\u5408\u6b63\u5e8f\u6392\u540d\u843d\u5728[start, stop) \u8303\u56f4\u5143\u7d20 zremrangebyrank players 10 20 zcount key min max \u6309\u7167\u5206\u6570\u8303\u56f4[min, max]\u7edf\u8ba1key\u96c6\u5408\u4e2d\u5143\u7d20\u4e2a\u6570 zcount players 100 300","title":"\u975e\u5e38\u7528\u547d\u4ee4"},{"location":"redis/redis-langfei/#_19","text":"\u6392\u884c\u699c\uff1a\u6709\u5e8f\u96c6\u5408\u7ecf\u5178\u4f7f\u7528\u573a\u666f\u3002\u4f8b\u5982\u89c6\u9891\u7f51\u7ad9\u9700\u8981\u5bf9\u7528\u6237\u4e0a\u4f20\u7684\u89c6\u9891\u505a\u6392\u884c\u699c\uff0c\u699c\u5355\u7ef4\u62a4\u53ef\u80fd\u662f\u591a\u65b9\u9762\uff1a\u6309\u7167\u65f6\u95f4\u3001\u6309\u7167\u64ad\u653e\u91cf\u3001\u6309\u7167\u83b7\u5f97\u7684\u8d5e\u6570\u7b49\u3002","title":"\u5e94\u7528\u573a\u666f"},{"location":"redis/redis-langfei/#_20","text":"\u4e00\u4e2a\u95ee\u9898\uff0cRedis\u5728\u9879\u76ee\u4e2d\u5982\u4f55\u4f7f\u7528\uff1f \u601d\u8003\u70b9\uff1a 1>\u9879\u76ee\u662f\u5426\u9700\u8981\u4f7f\u7528\u5230\u7f13\u5b58\uff1f\u4f7f\u7528 2>\u4f7f\u7528\u7f13\u5b58\u662f\u5426\u9009\u7528Redis\uff1f\u9009\u7528 3>\u4f7f\u7528Redis\u90a3\u8be5\u600e\u4e48\u8bbe\u8ba1Key-Value\u503c\uff1f \u8fd9\u91cc\u91cd\u70b9\u8ba8\u8bbaRedis\u7684KV\u5bf9\u7684\u8bbe\u8ba1\u3002","title":"\u7c7b\u578b\u603b\u7ed3"},{"location":"redis/redis-langfei/#value","text":"\u5148\u8bf4value\u503c\u7684\u8bbe\u8ba1\u5176\u5b9e\u5c31\u662fvalue\u7c7b\u578b\u9009\u7528\uff1a String\uff0c Hash\uff0c List\uff0c Set\uff0c Sort Set \u4e00\u822c\u8003\u8651\uff1a \u662f\u5426\u9700\u8981\u6392\u5e8f\uff1f\u8981\u4f7f\u7528Sort Set \u7f13\u5b58\u7684\u6570\u636e\u662f\u591a\u4e2a\u503c\u8fd8\u662f\u5355\u4e2a\u503c\uff0c \u591a\u4e2a\u503c\uff1a\u5141\u8bb8\u91cd\u590d\u9009List \u4e0d\u5141\u8bb8\u91cd\u590d\u9009\u62e9Set \u5355\u4e2a\u503c\uff1a\u7b80\u5355\u503c\u9009\u62e9String\uff0c \u5bf9\u8c61\u503c\u9009\u62e9Hash \u4e00\u79cd\u53d6\u5de7\u7684\u65b9\u5f0f\uff1a \u662f\u5426\u9700\u8981\u6392\u5e8f\uff1f\u8981\u4f7f\u7528Sort Set \u5269\u4e0b\u4f7f\u7528String \u64cd\u4f5c\u65b9\u5f0f\uff1a \u6240\u6709value\u4e4b\u540e\u90fd\u8f6c\u6362\u6210json\u683c\u5f0f\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u7f13\u5b58\u5230Redis\uff0c\u539f\u56e0\uff1aJava\u64cd\u4f5c\u65b9\u4fbf\uff0c\u51cf\u5c11\u6cdb\u578b\u64cd\u4f5c\u9ebb\u70e6 \u6bd4\u5982\uff1a List<String>list = ... Set<String> set = .... Map<String, Object> map = .... List<Object> list = redis\u5bf9\u8c61.getList Set<Object> set =redis\u5bf9\u8c61.getSet Map<Object, Object> map = redis\u5bf9\u8c61.getMap \u4e0d\u7ba1\u5b58\u653e\u5565\u6570\u636e\u7c7b\u578b\uff0c\u4ecereds\u4e2d\u83b7\u53d6\u51fa\u6765\u90fd\u662fObject\u7c7b\u578b\uff0c\u540e\u7eed\u5bf9\u8c61\u5f3a\u5236\u8f6c\u6362\u9ebb\u70e6\uff0c\u5e72\u8106\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u3002","title":"Value\u8bbe\u8ba1"},{"location":"redis/redis-langfei/#key","text":"Redis \u7684key \u8bbe\u8ba1\u8bb2\u7a764\u4e2a\u6027\uff1a","title":"Key\u8bbe\u8ba1"},{"location":"redis/redis-langfei/#_21","text":"Redis \u7c7b\u4f3cMap\u96c6\u5408\uff0ckey\u5fc5\u987b\u4fdd\u8bc1\u552f\u4e00\uff0c\u7f13\u5b58\u540c\u4e00\u4e2akey\u65f6\uff0c\u540e\u8005\u4f1a\u8986\u76d6\u524d\u8005\uff0c\u6240\u6709\u5fc5\u987b\u8981\u6c42\u552f\u4e00\uff0c\u90a3\u5982\u4f55\u4fdd\u8bc1\u552f\u4e00\u5462\uff1f \u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff1a \u4f7f\u7528\u7f13\u5b58\u6570\u636e\u7684\u4e3b\u952e\u4f5c\u4e3akey \u3002 \u6bd4\u5982\uff1a\u7f13\u5b58\u5458\u5de5\u4fe1\u606f key value ---------------------------------------------------------------- 1 \u5458\u5de51 2 \u5458\u5de52 \u5176\u4e2d\u76841\uff0c 2 \u662f\u5458\u5de5\u7684id","title":"\u552f\u4e00\u6027"},{"location":"redis/redis-langfei/#_22","text":"\u53ef\u8bfb\u6027\u662f\u4fdd\u8bc1Redis\u7684key\u80fd\u505a\u5230\u89c1\u540d\u77e5\u610f\uff0c\u4e0a\u9762\u7684\u5458\u5de5id1\uff0c \u5458\u5de5id2 \u867d\u8bf4\u80fd\u4fdd\u8bc1key\u552f\u4e00\uff0c\u4f46\u53ef\u8bfb\u6027\u975e\u5e38\u5dee\uff0c\u7ef4\u62a4key\u65f6\uff0c\u65e0\u6cd5\u4ece\uff0c 1\uff0c 2\u4e2d\u5feb\u901f\u5224\u65ad\u8be5key\u5bf9\u5e94value\u503c\u3002\u6240\u4ee5\u4e00\u4e00\u822c\u5728\u4fdd\u8bc1key\u552f\u4e00\u7684\u524d\u63d0\u4e0b\uff0c\u7ed9key\u52a0\u4e0a\u524d\u7f00\uff1a key value ---------------------------------------------------------------- employee_info:id1 \u5458\u5de51 employee_info:id2 \u5458\u5de52 employee_info:id1 employee_info:id2 \u8fd9\u6837\u5b50\u8bbe\u8ba1key\uff0c\u53ef\u8bfb\u6027\u5c31\u597d\u591a\u4e86\u3002 \u53ef\u8bfb\u6027\u524d\u7f00\u7684\u8bbe\u8ba1\u89c4\u8303\u5343\u5947\u767e\u602a\uff0c\u6211\u4e2a\u4eba\u6bd4\u8f83\u63a8\u5d07\u7684\uff1a \u666e\u901a\u5355\u503c key value ---------------------------------------------------------------- employe_info:id1 \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u7c7b\u4f3c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u8bbe\u8ba1 \u8868\u540d:\u4e3b\u952e\u540d:\u4e3b\u952e\u503c:\u5217\u540d key value ---------------------------------------------------------------- employee : id : 1:info \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u901a\u7528\u73a9\u6cd5 \u4e1a\u52a1\u6a21\u5757\u540d:\u4e1a\u52a1\u903b\u8f91\u542b\u4e49:\u5176\u4ed6:value\u7c7b\u578b key value ----------------------------------------------------------------------- employee :base.info:id1:hash \u5458\u5de5\u5bf9\u8c61\u4fe1\u606f \u4e1a\u52a1\u6a21\u5757\u540d \uff1a\u8868\u793a\u8be5key\u5c5e\u4e8e\u54ea\u4e2a\u529f\u80fd\u6a21\u5757 \u4e1a\u52a1\u903b\u8f91\u542b\u4e49\u6bb5 \uff1a\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528 . \u5206\u5f00\uff0c \u5177\u4f53\u4e1a\u52a1\u903b\u8f91\u8868\u793a \u200b \u6bd4\u5982\uff1a\u7f13\u5b58\u5458\u5de5\u6743\u9650 \u200b employee:auth.permission:id1:set \u5458\u5de5\u6743\u9650\u96c6\u5408 \u5176\u4ed6 \uff1a\u4e00\u822c\u8bbe\u7f6e\u552f\u4e00\u6807\u8bc6\uff0c\u6bd4\u5982\u4e3b\u952e value\u7c7b\u578b \uff1akey\u5bf9\u5e94value\u7c7b\u578b\u503c\uff0c\u63d0\u9ad8\u53ef\u8bfb\u6027\u3002","title":"\u53ef\u8bfb\u6027"},{"location":"redis/redis-langfei/#-","text":"\u8fd9\u4e2a\u96be\u4ecb\u7ecd\uff0c\u4e00\u822ckey\u4fdd\u8bc1\u552f\u4e00\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e3b\u952e\uff0c\u6709\u7684\u4f7f\u7528\uff0c\u4e00\u4e2a\u4e3b\u952e\u4e0d\u80fd\u8868\u8fbe\u51fa\u5168\u90e8\u610f\u601d\uff0c\u53ef\u4ee5\u4f7f\u7528\u8054\u5408\u4e3b\u952e\u3002 \u6bd4\u5982\uff1a id\u4e3a1\u7684\u670b\u53cb\u5708\u4e0bid\u4e3aA\u7684\u8bc4\u8bba\u3002 key value ----------------------------------------------------------------------- post:1:reply:A \u8bc4\u8bba\u5185\u5bb9 post:1:reply:B \u8bc4\u8bba\u5185\u5bb9","title":"\u7075\u6d3b\u6027--\u9879\u76ee\u4e8c\u91cd\u70b9\u8bb2"},{"location":"redis/redis-langfei/#_23","text":"Redis key\u4e00\u5b9a\u8981\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002\u8981\u8ddf\u81ea\u5df1\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u9700\u8981\u5bf9key\u8bbe\u7f6e\u5408\u7406\u7684\u8fc7\u671f\u65f6\u95f4\u3002\u53ef\u4ee5\u5728\u5199\u5165key\u65f6\uff0c\u5c31\u8981\u8ffd\u52a0\u8fc7\u671f\u65f6\u95f4\uff1b\u4e5f\u53ef\u4ee5\u5728\u6309\u7167\u9700\u8981\u52a8\u6001\u8bbe\u7f6e\u3002 \u8fd9\u91cc\u8981\u6ce8\u610f\uff1a \u4e0d\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u8fd9\u79cdkey\u4e3a\u6c38\u4e45key\uff0c\u4f1a\u4e00\u76f4\u5360\u7528\u5185\u5b58\u4e0d\u91ca\u653e\uff0c\u65f6\u95f4\u4e45\u4e86\uff0c\u6570\u91cf\u4e00\u591a\uff0c\u5c31\u5bb9\u6613\u8fbe\u5230\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e0a\u9650\uff0c\u5bfc\u81f4\u5b95\u673a\uff0c\u5f00\u53d1\u65f6\u4e00\u822c\u914d\u5408Key\u8fc7\u671f\u7b56\u7565\u4f7f\u7528\u54e6\u3002 key\u7684\u65f6\u6548\u6027\u8bbe\u7f6e\uff0c\u5fc5\u987b\u6839\u636e\u4e1a\u52a1\u573a\u666f\u8fdb\u884c\u8bc4\u4f30\uff0c\u8bbe\u7f6e\u5408\u7406\u6709\u6548\u671f\uff1b","title":"\u65f6\u6548\u6027"},{"location":"redis/redis-langfei/#redis_6","text":"\u5168\u5c40\u547d\u4ee4\u9488\u5bf9\u7684\u662f\u6240\u6709\u7684key\uff0c\u5927\u90e8\u5206\u7528\u6765\u505a\u8fd0\u7ef4\uff0c\u505a\u7ba1\u7406\u7684 \u5e38\u7528\u7684\u5168\u5c40key \u547d\u4ee4\u683c\u5f0f \u529f\u80fd \u6848\u4f8b keys pattern \u6309\u7167pattern \u5339\u914d\u89c4\u5219\uff0c\u5217\u8868redis\u4e2d\u6240\u6709\u7684key keys xxx:* exists key \u5224\u65adkey\u662f\u5426\u5b58\u5728 exists name expire key seconds \u7ed9key\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u8d85\u65f6\uff1aseconds expire name 10 persist key \u53d6\u6d88key\u8fc7\u671f\u65f6\u95f4 persist name select index \u5207\u6362\u6570\u636e\u5e93\uff0c\u9ed8\u8ba4\u662f\u7b2c0\u4e2a\uff0c\u5171\u6709\u30100,15\u3011\u4e2a select 0 move key db \u4ece\u5f53\u524d\u6570\u636e\u5e93\u5c06key\u79fb\u52a8\u5230\u6307\u5b9adb\u5e93 move name 1 randomkey \u968f\u673a\u8fd4\u56de\u4e00\u4e2akey randomkey rename key newkey \u5c06key\u6539\u540d\u4e3anewkey rename name newname echo message \u6253\u5370message\u4fe1\u606f echo message dbsize \u67e5\u770bkey\u4e2a\u6570 dbsize info \u67e5\u770bredis\u6570\u636e\u5e93\u4fe1\u606f info config get * \u67e5\u770b\u6240\u6709redis\u914d\u7f6e\u4fe1\u606f config get * flushdb \u6e05\u7a7a\u5f53\u524d\u6570\u636e\u5e93 flushdb flushall \u6e05\u7a7a\u6240\u6709\u6570\u636e\u5e93 flushall","title":"Redis\u5168\u5c40\u547d\u4ee4"},{"location":"redis/redis-langfei/#redis_7","text":"\u56e0\u4e3aRedis\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u6240\u4ee5\u5728\u4e00\u53f0\u6bd4\u8f83\u597d\u7684\u670d\u52a1\u5668\u4e0b,\u4e00\u4e2a\u5916\u90e8\u7528\u6237\u5728\u4e00\u79d2\u5185\u53ef\u4ee5\u8fdb\u884c15w\u6b21\u7684\u5bc6\u7801\u5c1d\u8bd5\uff0c\u8fd9\u610f\u5473\u4f60\u9700\u8981\u8bbe\u5b9a\u975e\u5e38\u5f3a\u5927\u7684\u5bc6\u7801\u6765\u65b9\u5f0f\u66b4\u529b\u7834\u89e3\u3002\u6b64\u65f6\u5c31\u9700\u8981\u5bf9Redis\u8fdb\u884c\u5bc6\u7801\u8bbe\u7f6e\u5566\u3002 Linux\u7cfb\u7edf \u7f16\u8f91 redis.conf\u6587\u4ef6\uff0c\u627e\u5230\u4e0b\u9762\u8fdb\u884c\u4fdd\u5b58\u4fee\u6539 requirepass \u81ea\u5b9a\u4e49\u5bc6\u7801 \u91cd\u542fRedis\u670d\u52a1\uff0c\u8bbf\u95ee\u65f6\uff0c\u4f7f\u7528\u5e26\u5bc6\u7801\u7684\u547d\u4ee4\uff1a redis-cli -a \u81ea\u5b9a\u4e49\u5bc6\u7801 \u5426\u5219\u4f1a\u63d0\u793a\uff1a (error)NOAUTH Authentication required. Window\u7cfb\u7edf \u8ddfLinux\u7cfb\u7edf\u4e00\u6837\uff0c\u533a\u522b\u662f\uff0cwindow\u7cfb\u7edf\u7684\u6587\u4ef6\u662f redis.window-service.config","title":"Redis\u5b89\u5168\u6027"},{"location":"redis/redis-langfei/#redis_8","text":"\u4e00\u4e2a\u4e8b\u52a1\u4ece\u5f00\u59cb\u5230\u6267\u884c\u4f1a\u7ecf\u5386\u4ee5\u4e0b\u4e09\u4e2a\u9636\u6bb5\uff1a \u5f00\u59cb\u4e8b\u52a1\u3002 \u547d\u4ee4\u5165\u961f\u3002 \u6267\u884c\u4e8b\u52a1\u3002 \u501f\u7528\uff1a\u83dc\u9e1f\u6559\u7a0b\u4e2d\u4f8b\u5b50 \u5b83\u5148\u4ee5 MULTI \u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\uff0c \u7136\u540e\u5c06\u591a\u4e2a\u547d\u4ee4\u5165\u961f\u5230\u4e8b\u52a1\u4e2d\uff0c \u6700\u540e\u7531 EXEC \u547d\u4ee4\u89e6\u53d1\u4e8b\u52a1\uff0c \u4e00\u5e76\u6267\u884c\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u547d\u4ee4\uff1a redis 127.0.0.1:6379> MULTI OK redis 127.0.0.1:6379> SET book-name \"Mastering C++ in 21 days\" QUEUED redis 127.0.0.1:6379> GET book-name QUEUED redis 127.0.0.1:6379> SADD tag \"C++\" \"Programming\" \"Mastering Series\" QUEUED redis 127.0.0.1:6379> SMEMBERS tag QUEUED redis 127.0.0.1:6379> EXEC 1) OK 2) \"Mastering C++ in 21 days\" 3) (integer) 3 4) 1) \"Mastering Series\" 2) \"C++\" 3) \"Programming\" \u5355\u4e2a Redis \u547d\u4ee4\u7684\u6267\u884c\u662f\u539f\u5b50\u6027\u7684\uff0c\u4f46 Redis \u6ca1\u6709\u5728\u4e8b\u52a1\u4e0a\u589e\u52a0\u4efb\u4f55\u7ef4\u6301\u539f\u5b50\u6027\u7684\u673a\u5236\uff0c\u6240\u4ee5 Redis \u4e8b\u52a1\u7684\u6267\u884c\u5e76\u4e0d\u662f\u539f\u5b50\u6027\u7684\u3002 Redis\u4e8b\u52a1\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a \u6253\u5305\u7684\u6279\u91cf\u6267\u884c\u811a\u672c \uff0c\u4f46\u6279\u91cf\u6307\u4ee4\u5e76\u975e\u539f\u5b50\u5316\u7684\u64cd\u4f5c\uff0c\u4e2d\u95f4\u67d0\u6761\u6307\u4ee4\u7684\u5931\u8d25\u4e0d\u4f1a\u5bfc\u81f4\u524d\u9762\u5df2\u505a\u6307\u4ee4\u7684\u56de\u6eda\uff0c\u4e5f\u4e0d\u4f1a\u9020\u6210\u540e\u7eed\u7684\u6307\u4ee4\u4e0d\u505a\u3002 127.0.0.1:6379> multi OK 127.0.0.1:6379(TX)> set name dafei QUEUED 127.0.0.1:6379(TX)> set age 18 QUEUED 127.0.0.1:6379(TX)> incr age QUEUED 127.0.0.1:6379(TX)> incr name QUEUED 127.0.0.1:6379(TX)> get age QUEUED 127.0.0.1:6379(TX)> get name QUEUED 127.0.0.1:6379(TX)> exec 1) OK 2) OK 3) (integer) 19 4) (error) ERR value is not an integer or out of range 5) \"19\" 6) \"dafei\" 127.0.0.1:6379> Redis \u4e8b\u52a1\u53ef\u4ee5\u4e00\u6b21\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c \u5e76\u4e14\u5e26\u6709\u4ee5\u4e0b\u4e09\u4e2a\u91cd\u8981\u7684\u4fdd\u8bc1\uff1a \u6279\u91cf\u64cd\u4f5c\u5728\u53d1\u9001 EXEC \u547d\u4ee4\u524d\u88ab\u653e\u5165\u961f\u5217\u7f13\u5b58\u3002 \u6536\u5230 EXEC \u547d\u4ee4\u540e\u8fdb\u5165\u4e8b\u52a1\u6267\u884c\uff0c\u4e8b\u52a1\u4e2d\u4efb\u610f\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff0c\u5176\u4f59\u7684\u547d\u4ee4\u4f9d\u7136\u88ab\u6267\u884c\u3002 \u5728\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\uff0c\u5176\u4ed6\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u547d\u4ee4\u8bf7\u6c42\u4e0d\u4f1a\u63d2\u5165\u5230\u4e8b\u52a1\u6267\u884c\u547d\u4ee4\u5e8f\u5217\u4e2d\u3002","title":"Redis\u4e8b\u52a1[\u62d3\u5c55]"},{"location":"redis/redis-langfei/#redis_9","text":"","title":"Redis\u6301\u4e45\u5316\u673a\u5236[\u62d3\u5c55]"},{"location":"redis/redis-langfei/#_24","text":"\u5148\u6765\u4e00\u4e2a\u5c0f\u5b9e\u9a8c\uff0c\u5927\u5bb6\u53ef\u4ee5\u4e00\u8d77\u5b9e\u73b0\u4e00\u4e0b \u6b65\u9aa41\uff1a\u5728Redis\u4e2d\u6dfb\u52a02\u4e2akey-value\u5bf9 127.0.0.1:6379> set aa aa OK 127.0.0.1:6379> set bb bb OK 127.0.0.1:6379> keys * \u6b65\u9aa42\uff1a\u91cd\u542fRedis \u670d\u52a1\u5668\uff0c\u5728\u6267\u884ckeys * \u89c2\u5bdf\u6570\u636e \u6b65\u9aa43\uff1a\u5206\u6790\u7ed3\u679c \u4f1a\u51fa\u73b0\u4e00\u4e0b\u51e0\u79cd\u7ed3\u679c\uff1a \u4e4b\u524d\u7684key\u5728\uff0caa bb \u90fd\u5728\uff08\u6700\u7406\u60f3\u7684\u7ed3\u679c\uff09 \u4e4b\u524d\u7684key\u5728\uff0caa\u4e5f\u5728\uff0cbb\u4e0d\u89c1\u4e86 \u4e4b\u524d\u7684key\u5728\uff0caa\uff0c bb \u4e0d\u5728 \u4e4b\u524d\u7684key\uff0c aa\uff0c bb \u90fd\u4e0d\u5728\u4e86\uff08\u6700\u574f\u7684\u7ed3\u679c\uff09 \u601d\u8003\uff1a \u4e3a\u5565\u4f1a\u8fd9\u6837\uff1f\u4ee5\u6211\u4eec\u5bf9\u5185\u5b58\u7684\u64cd\u4f5c\u7406\u89e3\uff0c\u6309\u9053\u7406\u91cd\u542f\u4e4b\u540e\u6570\u636e\u5e94\u8be5\u5168\u4e22\u5931\u4e86\uff0c\u4e3a\u5565Redis \u53ef\u80fd\u4e22\u5931\uff0c\u4e5f\u53ef\u80fd\u4e0d\u4e22\u5931\uff0c\u4e3a\u4f55\uff1f \u8fd9\u91cc\u5c31\u6d89\u53ca\u5230Redis\u7684\u6301\u4e45\u5316\u673a\u5236\u4e86\u3002 * Redis\u6301\u4e45\u5316\u673a\u5236\u76ee\u524d\u4ee5\u540e3\u79cd\uff0c\u5206\u522b\u4e3a\uff1a 1> \u5feb\u7167\u65b9\u5f0f \uff08RDB, Redis DataBase\uff09 2> \u6587\u4ef6\u8ffd\u52a0\u65b9\u5f0f \uff08AOF, Append Only File\uff09 3> \u6df7\u5408\u6301\u4e45\u5316\u65b9\u5f0f \uff08Redis4\u7248\u672c\u4e4b\u540e\uff09","title":"\u5f15\u8a00"},{"location":"redis/redis-langfei/#rdb","text":"Snapshotting(\u5feb\u7167)\u9ed8\u8ba4\u65b9\u5f0f\uff0c\u5c06\u5185\u5b58\u6570\u636e\u4e2d\u4ee5\u5feb\u7167\u7684\u65b9\u5f0f\u5199\u5165\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u4e3adump.rdb\u3002\u89e6\u53d1RDB\u6301\u4e45\u5316\u8fc7\u7a0b\u5206\u624b\u52a8\u89e6\u53d1\u4e0e\u81ea\u52a8\u89e6\u53d1\u3002","title":"RDB\u65b9\u5f0f"},{"location":"redis/redis-langfei/#_25","text":"\u624b\u52a8\u89e6\u53d1 \u4f7f\u7528save\u547d\u4ee4\uff1a\u4f1a\u963b\u585e\u5f53\u524dRedis\u670d\u52a1\u5668\uff0c\u77e5\u9053RDB\u8fc7\u7a0b\u5b8c\u6210\u4e3a\u4e3b\uff0c\u5982\u679c\u5185\u5b58\u6570\u636e\u8f83\u591a\uff0c\u4f1a\u9020\u6210\u957f\u65f6\u95f4\u963b\u585e\uff0c\u5f71\u54cd\u5176\u4ed6\u547d\u4ee4\u7684\u4f7f\u7528\uff0c\u4e0d\u5efa\u8bae\u8f7b\u6613\u4f7f\u7528 \u4f7f\u7528bgsave\u547d\u4ee4\uff1aRedis\u8fdb\u7a0b\u6267\u884cfork\u6307\u4ee4\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u7531\u5b50\u8fdb\u7a0b\u5b9e\u73b0RDB\u6301\u4e45\u5316\uff0c\u6709\u9700\u8981\u65f6\u5efa\u8bae\u4f7f\u7528bgsave\u547d\u4ee4\u3002 \u81ea\u52a8\u89e6\u53d1 \u4f7f\u7528save\u76f8\u5173\u914d\u7f6e\uff0c\u683c\u5f0f\uff1a save m n \u8868\u793am\u79d2\u5185\u6570\u636e\u96c6\u5b58\u5728n\u6b21\u4fee\u6539\u65f6\u4f1a\u81ea\u52a8\u89e6\u53d1bgsave\u547d\u4ee4\u3002 save 900 1 #900\u79d2\u5185\u5982\u679c\u8d85\u8fc71\u4e2aKey\u88ab\u4fee\u6539\u5219\u53d1\u8d77\u5feb\u7167\u4fdd\u5b58 save 300 10 #300\u79d2\u5185\u5982\u679c\u8d85\u8fc710\u4e2akey\u88ab\u4fee\u6539,\u5219\u53d1\u8d77\u5feb\u7167\u4fdd\u5b58 save 60 10000 *","title":"\u89e6\u53d1\u673a\u5236"},{"location":"redis/redis-langfei/#_26","text":"RDB\u5feb\u7167\u6587\u4ef6\u662f\u4e00\u4e2a\u7d27\u51d1\u538b\u7f29\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u975e\u5e38\u4f7f\u7528\u7528\u4e8e\u5907\u4efd\uff0c\u5168\u91cf\u590d\u5236\u7b49\u573a\u666f\u3002\u5f00\u53d1\u4e2d\u53ef\u4ee5\u6309\u7167\u6bcf6\u5c0f\u65f6\u6267\u884c\u4e00\u6b21bgsave\u5907\u4efd\uff0c\u7528\u4e8e\u5bb9\u707e\u5907\u4efd\u3002 Redis\u52a0\u8f7dRDB\u6062\u590d\u6570\u636e\u8fdc\u8fdc\u5feb\u4e8eAOF\u65b9\u5f0f","title":"\u4f18\u70b9"},{"location":"redis/redis-langfei/#_27","text":"RDB\u65e0\u6cd5\u505a\u5230\u5b9e\u65f6\u6301\u4e45\u5316/\u79d2\u7ea7\u6301\u4e45\u5316\uff0c\u6bcf\u6b21bgsave\u65f6\u90fd\u9700\u8981fork\u5b50\u8fdb\u7a0b\uff0c\u9891\u7e41\u6267\u884c\u6709\u65f6\u95f4\u6210\u672c\u3002 RDB\u5feb\u7167\u6587\u4ef6\u4e0d\u540c\u7248\u672c\u683c\u5f0f\u4e0d\u4e00\u6837\uff0c\u5bb9\u6613\u5f15\u8d77\u517c\u5bb9\u95ee\u9898\u3002","title":"\u7f3a\u70b9"},{"location":"redis/redis-langfei/#aof","text":"AOF\u4e0eRDB\u4e0d\u4e00\u6837\uff0c\u5b83\u662f\u4e00\u72ec\u7acb\u65e5\u5fd7\u7684\u65b9\u5f0f\u8bb0\u5f55\u6bcf\u6b21\u5199\u547d\u4ee4\uff0c\u91cd\u542f\u65f6\u518d\u91cd\u65b0\u6267\u884cAOF\u6587\u4ef6\u4e2d\u547d\u4ee4\u8fbe\u5230\u6062\u590d\u6570\u636e\u7684\u76ee\u7684\u3002\u89e3\u51b3\u4e86\u6570\u636e\u6301\u4e45\u5316\u7684\u5b9e\u65f6\u6027\u7684\u95ee\u9898\u3002 Redis\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u9700\u8981\u4f7f\u7528\u65f6\uff0c\u9700\u8981\u914d\u7f6e\uff1a appendonly yes AOF \u67093\u79cd\u6587\u4ef6\u540c\u6b65\u7b56\u7565 \u7b56\u7565 \u89e3\u91ca appendfsync always \u6536\u5230\u547d\u4ee4\u5c31\u7acb\u5373\u5199\u5230\u78c1\u76d8,\u6548\u7387\u6700\u6162.\u4f46\u662f\u80fd\u4fdd\u8bc1\u5b8c\u5168\u7684\u6301\u4e45\u5316 appendfsync everysec \u6bcf\u79d2\u5199\u5165\u78c1\u76d8\u4e00\u6b21,\u5728\u6027\u80fd\u548c\u6301\u4e45\u5316\u65b9\u9762\u505a\u4e86\u5f88\u597d\u7684\u6298\u4e2d appendfsync no \u5b8c\u5168\u4ee5\u4f9d\u8d56os\uff0c\u4e00\u822c\u540c\u6b65\u5468\u671f\u662f30\u79d2 *","title":"AOF\u65b9\u5f0f"},{"location":"redis/redis-langfei/#_28","text":"AOF\u65b9\u5f0f\u6570\u636e\u5b89\u5168\u6027\u66f4\u9ad8\uff0c\u914d\u7f6e\u5f97\u5f53\uff0c\u6700\u591a\u635f\u59311\u79d2\u7684\u6570\u636e\u91cf \u5728\u4e0d\u5c0f\u5fc3\u6267\u884cflushall\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7AOF\u65b9\u5f0f\u6062\u590d(\u5220\u9664\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u5373\u53ef) AOF \u65e5\u5fd7\u662f\u4e00\u4e2a\u589e\u91cf\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e0d\u4f1a\u5b58\u5728\u65ad\u7535\u65f6\u51fa\u73b0\u635f\u574f\u95ee\u9898\u3002\u5373\u4f7f\u51fa\u73b0\u95ee\u9898\uff0credis-check-aof \u5de5\u5177\u4e5f\u80fd\u591f\u8f7b\u677e\u4fee\u590d\u5b83\u3002 \u5f53 AOF \u53d8\u5f97\u592a\u5927\u65f6\uff0cRedis \u80fd\u591f\u5728\u540e\u53f0\u81ea\u52a8\u91cd\u5199 AOF","title":"\u4f18\u70b9"},{"location":"redis/redis-langfei/#_29","text":"\u76f8\u540c\u6570\u636e\u91cf\u6765\u8bf4\uff0cAOF\u6587\u4ef6\u4f53\u79ef\u901a\u5e38\u5927\u4e8eRDB\u6587\u4ef6 \u6570\u636e\u6301\u4e45\u5316\u6027\u80fd\u4e0a\u6765\u8bf4\uff0cAOF \u6bd4 RDB \u6162","title":"\u7f3a\u70b9"},{"location":"redis/redis-langfei/#rdb-aof","text":"\u6df7\u5408\u6301\u4e45\u5316\u662f\u7ed3\u5408\u4e86 RDB \u548c AOF \u7684\u4f18\u70b9\uff0c\u5728\u5199\u5165\u7684\u65f6\u5019\uff0c\u5148\u628a\u5f53\u524d\u7684\u6570\u636e\u4ee5 RDB \u7684\u5f62\u5f0f\u5199\u5165\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u518d\u5c06\u540e\u7eed\u7684\u64cd\u4f5c\u547d\u4ee4\u4ee5 AOF \u7684\u683c\u5f0f\u5b58\u5165\u6587\u4ef6\u3002\u5373\u4ee5 RDB \u4f5c\u4e3a\u5168\u91cf\u5907\u4efd\uff0cAOF \u4f5c\u4e3a\u589e\u91cf\u5907\u4efd\uff0c\u6765\u63d0\u9ad8\u5907\u4efd\u6548\u7387\u3002\u8fd9\u6837\u65e2\u80fd\u4fdd\u8bc1 Redis \u91cd\u542f\u65f6\u7684\u901f\u5ea6\uff0c\u53c8\u80fd\u9632\u6b62\u6570\u636e\u4e22\u5931\u7684\u98ce\u9669\uff0c \u8fd9\u5c31\u662f Redis 4.0 \u4e4b\u540e\u63a8\u51fa\u7684 RDB-AOF \u6df7\u5408\u6301\u4e45\u5316\u6a21\u5f0f\uff0c\u5176\u4f5c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u6765\u4f7f\u7528 \u3002","title":"RDB-AOF\u6df7\u5408\u65b9\u5f0f"},{"location":"redis/redis-langfei/#_30","text":"\u5982\u679c\u5bf9\u6570\u636e\u5b89\u5168\u6027\u6709\u975e\u5e38\u9ad8\u7684\u8981\u6c42\uff0c\u5efa\u8bae RDB \u548c AOF \u540c\u65f6\u542f\u7528\u3002 \u5982\u679c\u5bf9\u6570\u636e\u5b89\u5168\u6027\u8981\u6c42\u4e0d\u662f\u5f88\u9ad8\uff0c\u80fd\u591f\u5bb9\u5fcd\u6570\u636e\u7684\u4e22\u5931\uff0c\u5efa\u8bae\u5355\u72ec\u4f7f\u7528 RDB\u3002 \u4e0d\u63a8\u8350\u5355\u72ec\u4f7f\u7528 AOF\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fdb\u884c\u6570\u636e\u5e93\u5907\u4efd\u3001\u66f4\u5feb\u91cd\u542f\u4ee5\u53ca AOF \u5f15\u64ce\u4e2d\u51fa\u73b0\u9519\u8bef\u7684\u60c5\u51b5\u6765\u8bf4\uff0cRDB \u662f\u66f4\u597d\u7684\u9009\u62e9\u3002 \u5982\u679c\u6ca1\u7279\u6b8a\u8981\u6c42\uff0cRedis\u53c8\u662f4.x\u7248\u672c\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u9009\u62e9RDB-AOF\u6df7\u5408\u65b9\u5f0f\u3002 \u5982\u679c\u4e0d\u662f\u6df7\u5408\u6a21\u5f0f\uff0c\u800c\u662f\u666e\u901a\u7684RDB\u4e0eAOF\u4e00\u8d77\u542f\u52a8\u65f6\uff0cRedis\u52a0\u8f7d\u6570\u636e\u6267\u884c\u6d41\u7a0b *","title":"\u6301\u4e45\u5316\u673a\u5236\u9009\u62e9"},{"location":"redis/redis-langfei/#redis_10","text":"","title":"Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236[\u62d3\u5c55]"},{"location":"redis/redis-langfei/#_31","text":"Redis \u542f\u52a8\u4f1a\u52a0\u8f7d\u4e00\u4e2a\u914d\u7f6e\uff1a maxmemory <byte> //\u5185\u5b58\u4e0a\u9650 \u9ed8\u8ba4\u503c\u4e3a 0 (window\u7248\u7684\u9650\u5236\u4e3a100M)\uff0c\u8868\u793a\u9ed8\u8ba4\u8bbe\u7f6eRedis\u5185\u5b58\u4e0a\u9650\u3002\u4f46\u662f\u771f\u5b9e\u5f00\u53d1\u8fd8\u662f\u9700\u8981\u63d0\u524d\u8bc4\u4f30key\u7684\u4f53\u91cf\uff0c\u63d0\u524d\u8bbe\u7f6e\u597d\u5185\u5bb9\u4e0a\u9650\u3002 \u6b64\u65f6\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5f00\u53d1\u4e2d\uff0c\u5728\u8bbe\u7f6e\u5b8c\u5185\u5b58\u4e0a\u9650\u4e4b\u540e\uff0c\u5982\u679cRedis key\u8fbe\u5230\u4e0a\u9650\u4e86\uff0c\u8be5\u600e\u4e48\u529e\uff1f\u8fd9\u5c31\u8bbe\u7f6e\u5230Redis\u7684\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e86\u3002","title":"\u5f15\u8a00"},{"location":"redis/redis-langfei/#_32","text":"Redis\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u4e5f\u53ef\u4ee5\u79f0\u4e4b\u4e3akey\u5185\u5377\u673a\u5236\uff0c\u5f53\u8d44\u6e90\u4e0d\u8db3\u65f6\uff0c\u8be5\u5982\u4f55\u9009\u62e9\uff1f \u5e38\u89c1\u7684\u5185\u5b58\u6dd8\u6c70\u673a\u5236\u5206\u4e3a\u56db\u5927\u7c7b\uff1a LRU\uff1a LRU\u662fLeast recently used\uff0c\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u610f\u601d\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u6700\u8fd1\u6700\u5c11\u8bbf\u95ee\u7684\u6570\u636e\uff0c\u8be5\u7b97\u6cd5\u8ba4\u4e3a\uff0c\u4f60\u957f\u671f\u4e0d\u7528\u7684\u6570\u636e\uff0c\u90a3\u4e48\u88ab\u518d\u6b21\u8bbf\u95ee\u7684\u6982\u7387\u4e5f\u5c31\u5f88\u5c0f\u4e86\uff0c\u6dd8\u6c70\u7684\u6570\u636e\u4e3a\u6700\u957f\u65f6\u95f4\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u4ec5\u4e0e\u65f6\u95f4\u76f8\u5173\u3002 LFU\uff1a LFU\u662fLeast Frequently Used\uff0c\u6700\u4e0d\u7ecf\u5e38\u4f7f\u7528\u7684\u610f\u601d\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u6dd8\u6c70\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u4e0e\u9891\u6b21\u548c\u65f6\u95f4\u76f8\u5173\u3002 TTL\uff1a Redis\u4e2d\uff0c\u6709\u7684\u6570\u636e\u662f\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\uff0c\u800c\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u8fd9\u90e8\u5206\u6570\u636e\uff0c\u5c31\u662f\u8be5\u7b97\u6cd5\u8981\u89e3\u51b3\u7684\u5bf9\u8c61\u3002\u5982\u679c\u4f60\u5feb\u8fc7\u671f\u4e86\uff0c\u4e0d\u597d\u610f\u601d\uff0c\u6211\u5185\u5b58\u73b0\u5728\u4e0d\u591f\u4e86\uff0c\u53cd\u6b63\u4f60\u4e5f\u8981\u9000\u4f11\u4e86\uff0c\u63d0\u524d\u9001\u4f60\u4e00\u7a0b\uff0c\u628a\u4f60\u5e72\u6389\u5427\u3002 \u968f\u673a\u6dd8\u6c70\uff1a\u751f\u6b7b\u6709\u547d\uff0c\u5bcc\u8d35\u5728\u5929\uff0c\u662f\u5426\u88ab\u5e72\u6389\uff0c\u5168\u51ed\u5929\u610f\u4e86\u3002","title":"\u5185\u5b58\u6dd8\u6c70\u7b97\u6cd5"},{"location":"redis/redis-langfei/#redis_11","text":"Redis \u901a\u8fc7\u914d\u7f6e maxmemroy-policy \u6765\u914d\u7f6e\u6307\u5b9a\u5177\u4f53\u7684\u6dd8\u6c70\u673a\u5236\uff0c\u53ef\u4f9b\u9009\u62e9\u7684\u503c\u6709\uff1a \u901a\u8fc7maxmemroy-policy\u53ef\u4ee5\u914d\u7f6e\u5177\u4f53\u7684\u6dd8\u6c70\u673a\u5236\uff0c\u770b\u4e86\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u8bf4\u53ea\u67096\u79cd\uff0c\u5176\u5b9e\u67098\u79cd\uff0c\u53ef\u4ee5\u770bRedis5.0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0a\u9762\u6709\u8bf4\u660e\uff1a volatile-lru -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff08\u88ab\u8bbf\u95ee\u5230\uff09\u7684\u6570\u636e\u5e72\u6389\u3002 volatile-ttl -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u5373\u5c06\u8fc7\u671f\u7684\u6570\u636e\u5e72\u6389\u3002 volatile-random -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u8fdb\u884c\u65e0\u5dee\u522b\u653b\u51fb\uff0c\u968f\u673a\u5e72\u6389\u6570\u636e\u3002 volatile-lfu -> \u627e\u51fa\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u6570\u636e\u96c6\uff0c\u5c06\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u5e72\u6389\u3002 allkeys-lru ->\u4e0e\u7b2c1\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 allkeys-lfu -> \u4e0e\u7b2c4\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 allkeys-random -> \u4e0e\u7b2c3\u4e2a\u5dee\u4e0d\u591a\uff0c\u6570\u636e\u96c6\u4ece\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6570\u636e\u53d8\u4e3a\u5168\u4f53\u6570\u636e\u3002 no-enviction -> \u4ec0\u4e48\u90fd\u4e0d\u5e72\uff0c\u62a5\u9519\uff0c\u544a\u8bc9\u4f60\u5185\u5b58\u4e0d\u8db3\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u53ef\u4ee5\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931 \u7cfb\u7edf\u9ed8\u8ba4\u9009\u62e9\uff1a noenviction","title":"Redis\u6dd8\u6c70\u7b56\u7565"},{"location":"redis/redis-langfei/#key_1","text":"\u63a5\u4e0b\u8ba8\u8bba\u4e00\u4e2a\u95ee\u9898\uff1aRedis\u7684key\u8fc7\u671f\u4e86\uff0c\u8be5\u5982\u4f55\u6e05\u7406\u95ee\u9898\u3002 Redis\u7ed9\u51fa3\u79cd\u5b9e\u73b0\u65b9\u6848\uff1a \u60f0\u6027\u5220\u9664 \uff1a\u5f53\u8bbf\u95eeKey\u65f6\uff0c\u624d\u53bb\u5224\u65ad\u5b83\u662f\u5426\u8fc7\u671f\uff0c\u5982\u679c\u8fc7\u671f\uff0c\u76f4\u63a5\u5e72\u6389\u3002\u8fd9\u79cd\u65b9\u5f0f\u5bf9CPU\u5f88\u53cb\u597d\uff0c\u4f46\u662f\u4e00\u4e2akey\u5982\u679c\u957f\u671f\u4e0d\u7528\uff0c\u4e00\u76f4\u5b58\u5728\u5185\u5b58\u91cc\uff0c\u4f1a\u9020\u6210\u5185\u5b58\u6d6a\u8d39\u3002 \u5b9a\u65f6\u5220\u9664 \uff1a\u8bbe\u7f6e\u952e\u7684\u8fc7\u671f\u65f6\u95f4\u7684\u540c\u65f6\uff0c\u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5f53\u5230\u8fbe\u8fc7\u671f\u65f6\u95f4\u70b9\uff0c\u7acb\u5373\u6267\u884c\u5bf9Key\u7684\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5bf9CPU\u4e0d\u53cb\u597d\uff0c\u5f97\u989d\u5916\u8ba9\u51faCPU\u7ef4\u62a4\u5b9a\u65f6\u5668\u3002 \u5b9a\u671f\u5220\u9664 \uff1a\u9694\u4e00\u6bb5\u65f6\u95f4\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u4e00\u6b21\u68c0\u67e5\uff0c\u5220\u9664\u91cc\u9762\u7684\u8fc7\u671fKey\uff0c\u81f3\u4e8e\u8981\u5220\u9664\u591a\u5c11\u8fc7\u671fKey\uff0c\u68c0\u67e5\u591a\u5c11\u6570\u636e\uff0c\u5219\u7531\u7b97\u6cd5\u51b3\u5b9a\u3002 Redis\u670d\u52a1\u5668\u5b9e\u9645\u4f7f\u7528\u7684\u662f\u60f0\u6027\u5220\u9664\u548c\u5b9a\u671f\u5220\u9664\u4e24\u79cd\u7b56\u7565\uff1a\u901a\u8fc7\u914d\u5408\u4f7f\u7528\u8fd9\u4e24\u79cd\u5220\u9664\u7b56\u7565\uff0c\u53ef\u4ee5\u5f88\u597d\u5730\u5728\u5408\u7406\u4f7f\u7528CPU\u548c\u907f\u514d\u6d6a\u8d39\u5185\u5b58\u4e4b\u95f4\u53d6\u5f97\u5e73\u8861\u3002","title":"\u8fc7\u671fKey\u5904\u7406[\u62d3\u5c55]"},{"location":"redis/redis-langfei/#redis_12","text":"","title":"Redis\u7f16\u7a0b"},{"location":"redis/redis-langfei/#_33","text":"Redis\u7f16\u7a0b\u5c31\u662f\u4f7f\u7528\u7f16\u7a0b\u65b9\u5f0f\u64cd\u4f5cRedis\uff0c\u5f53\u524dRedis\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u6709\uff1ahttps://redis.io/docs/clients/ \u8fd9\u91cc\u4ee5Java\u4e3a\u5f00\u53d1\u8bed\u8a00\uff0c\u9009\u62e9Java\u70b9\u51fb\u8fdb\u53bb java\u5b9e\u73b0\u64cd\u4f5cRedis\u7684\u5ba2\u6237\u7aef\u6709\u5f88\u591a\uff0c\u5176\u4e2d\u540d\u6c14\u6700\u9ad8\u7684\uff1a Redisson \uff0c Jedis \uff0c lettuce 3\u4e2a\u5ba2\u6237\u7aef\uff0c\u5176\u4e2dJedis\uff0clettuce\u4fa7\u91cd\u4e8e\u5355\u4f8bRedis \u6570\u636e\u5e93\u7684 CRUD\uff08\u589e\u5220\u6539\u67e5\uff09\uff0cRedisson \u4fa7\u91cd\u4e8e\u5206\u5e03\u5f0f\u5f00\u53d1\u3002\u5f53\u524d\u91cd\u70b9\u8bb2\u89e3Jedis\u4e0elettuce\u7684\u4f7f\u7528\uff0c\u540e\u7eed\u6709\u673a\u4f1a\u518d\u91cd\u70b9\u8bb2\u89e3Redisson\u4f7f\u7528\u3002","title":"\u6982\u51b5"},{"location":"redis/redis-langfei/#jedis","text":"\u9879\u76ee\u4f7f\u7528\u7684SpringBoot\uff0c\u6240\u4ee5\u91cd\u70b9\u8bb2\u89e3SpringBoot\u7ee7\u627fJedis \u6b65\u9aa41\uff1a\u5efa\u9879\u76ee\uff0c\u5bfc\u5165\u4f9d\u8d56 <parent> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-parent</artifactId> <version>2.4.3</version> <relativePath/> <!-- lookup parent from repository --> </parent> <dependencies> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter</artifactId> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-test</artifactId> <scope>test</scope> </dependency> <dependency> <groupId>redis.clients</groupId> <artifactId>jedis</artifactId> </dependency> <dependency> <groupId>org.projectlombok</groupId> <artifactId>lombok</artifactId> </dependency> </dependencies> \u6b65\u9aa42\uff1a\u5bfc\u5165\u914d\u7f6e\u6587\u4ef6 #redis\u914d\u7f6e--jedis\u7248 jedis: pool: #redis\u670d\u52a1\u5668\u7684IP host: localhost #redis\u670d\u52a1\u5668\u7684Port port: 6379 #\u6570\u636e\u5e93\u5bc6\u7801 password: #\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 timeout: 7200 #\u6700\u5927\u6d3b\u52a8\u5bf9\u8c61\u6570 maxTotall: 100 #\u6700\u5927\u80fd\u591f\u4fdd\u6301idel\u72b6\u6001\u7684\u5bf9\u8c61\u6570 maxIdle: 100 #\u6700\u5c0f\u80fd\u591f\u4fdd\u6301idel\u72b6\u6001\u7684\u5bf9\u8c61\u6570 minIdle: 50 #\u5f53\u6c60\u5185\u6ca1\u6709\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u6700\u5927\u7b49\u5f85\u65f6\u95f4 maxWaitMillis: 10000 #\u5f53\u8c03\u7528borrow Object\u65b9\u6cd5\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5 testOnBorrow: true #\u5f53\u8c03\u7528return Object\u65b9\u6cd5\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5 testOnReturn: true #\u201c\u7a7a\u95f2\u94fe\u63a5\u201d\u68c0\u6d4b\u7ebf\u7a0b\uff0c\u68c0\u6d4b\u7684\u5468\u671f\uff0c\u6beb\u79d2\u6570\u3002\u5982\u679c\u4e3a\u8d1f\u503c\uff0c\u8868\u793a\u4e0d\u8fd0\u884c\u201c\u68c0\u6d4b\u7ebf\u7a0b\u201d\u3002\u9ed8\u8ba4\u4e3a-1. timeBetweenEvictionRunsMillis: 30000 #\u5411\u8c03\u7528\u8005\u8f93\u51fa\u201c\u94fe\u63a5\u201d\u5bf9\u8c61\u65f6\uff0c\u662f\u5426\u68c0\u6d4b\u5b83\u7684\u7a7a\u95f2\u8d85\u65f6\uff1b testWhileIdle: true # \u5bf9\u4e8e\u201c\u7a7a\u95f2\u94fe\u63a5\u201d\u68c0\u6d4b\u7ebf\u7a0b\u800c\u8a00\uff0c\u6bcf\u6b21\u68c0\u6d4b\u7684\u94fe\u63a5\u8d44\u6e90\u7684\u4e2a\u6570\u3002\u9ed8\u8ba4\u4e3a3. numTestsPerEvictionRun: 50 \u6b65\u9aa43\uff1a\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6 @Component @ConfigurationProperties(prefix = \"jedis.pool\") @Getter @Setter public class JedisProperties { private int maxTotall; private int maxIdle; private int minIdle; private int maxWaitMillis; private boolean testOnBorrow; private boolean testOnReturn; private int timeBetweenEvictionRunsMillis; private boolean testWhileIdle; private int numTestsPerEvictionRun; private String host; private String password; private int port; private int timeout; } \u6b65\u9aa44\uff1a\u7f16\u5199Jedis\u914d\u7f6e\u7c7b @Configuration public class JedisConfig { /** * jedis\u8fde\u63a5\u6c60 * @param jedisProperties * @return */ @Bean public JedisPool jedisPool(JedisProperties jedisProperties) { JedisPoolConfig config = new JedisPoolConfig(); config.setMaxTotal(jedisProperties.getMaxTotall()); config.setMaxIdle(jedisProperties.getMaxIdle()); config.setMinIdle(jedisProperties.getMinIdle()); config.setMaxWait(Duration.ofMillis(jedisProperties.getMaxWaitMillis())); config.setTestOnBorrow(jedisProperties.isTestOnBorrow()); config.setTestOnReturn(jedisProperties.isTestOnReturn()); config.setTimeBetweenEvictionRuns(Duration.ofMillis(jedisProperties.getTimeBetweenEvictionRunsMillis())); config.setTestWhileIdle(jedisProperties.isTestWhileIdle()); config.setNumTestsPerEvictionRun(jedisProperties.getNumTestsPerEvictionRun()); if (StringUtils.hasText(jedisProperties.getPassword())) { return new JedisPool(config, jedisProperties.getHost(), jedisProperties.getPort(), jedisProperties.getTimeout(), jedisProperties.getPassword()); } return new JedisPool(config, jedisProperties.getHost(), jedisProperties.getPort(), jedisProperties.getTimeout()); } } \u6b65\u9aa45\uff1a\u7f16\u5199\u6d4b\u8bd5\u7c7b\uff0c\u5b9e\u73b0\u6d4b\u8bd5 @SpringBootTest public class JedisTest { @Autowired private JedisPool jedisPool; @Test public void testConnection(){ System.out.println(jedisPool); Jedis jedis = jedisPool.getResource(); //\u9700\u6c42\uff1a\u5f80redis\u4e2d\u6dfb\u52a0kv\u5bf9\uff1a name\uff1adafei jedis.set(\"name\", \"dafei\"); System.out.println(jedis.get(\"name\")); jedis.close(); } } \u64cd\u4f5c\u6280\u5de7\uff1ajedis\u4e2d\u65b9\u6cd5\u8ddfRedis\u4e2d\u547d\u4ee4\u4e00\u6837","title":"Jedis"},{"location":"redis/redis-langfei/#lettuce","text":"Lettuce \u4e4b\u6240\u4ee5\u80fd\u6d41\u884c\uff0c\u56e0\u4e3a\u5b83\u62b1\u4e86\u6839\u597d\u5927\u817f-Spring-data\u3002Spring-data-redis\u5e95\u5c42\u5c31\u5c01\u88c5\u4e86Lettuce\uff0c\u63a5\u4e0b\u6765\u770b\u4e0bSpringboot\u7248\u7684lettuce\u5b9e\u73b0\u3002 \u6b65\u9aa41\uff1a\u5bfc\u5165\u4f9d\u8d56 <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-data-redis</artifactId> </dependency> \u6b65\u9aa42\uff1aRedis\u914d\u7f6e spring: redis: host: 127.0.0.1 port: 6379 password: admin \u6b65\u9aa43\uff1a\u7f16\u5199\u6d4b\u8bd5\u7c7b\uff0c\u5b9e\u73b0\u6d4b\u8bd5 @SpringBootTest public class LettureTest { @Autowired //\u7ea6\u5b9a\uff1a // \u64cd\u4f5credis\u7684key \u662f\u5b57\u7b26\u4e32 // value\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u5143\u7d20 private StringRedisTemplate template; @Test public void testRedis(){ //name\uff1adafei template.opsForValue().set(\"name\", \"dafei\"); System.out.println(template.opsForValue().get(\"name\")); // \u64cd\u4f5cstring //template.opsForValue().xx(); // \u64cd\u4f5chash //template.opsForHash().xx(); // \u64cd\u4f5clist //template.opsForList().xx(); // \u64cd\u4f5cset //template.opsForSet().xx(); // \u64cd\u4f5czset //template.opsForZSet().xx(); //spring-data-redis \u65b9\u6cd5\u662fredis \u547d\u4ee4\u5168\u79f0 //template.opsForList().rightPush() //rpush //\u5168\u5c40\u547d\u4ee4\u5728template\u7c7b\u4e0a //template.keys(\"*\"); } } \u64cd\u4f5c\u6280\u5de7\uff1aLettuce\u4e2d\u65b9\u6cd5\u8ddfRedis\u4e2d\u547d\u4ee4\u5168\u79f0","title":"Lettuce"},{"location":"redis/redis-langfei/#_34","text":"\u7c7b\u4f3c\u6548\u679c\uff1ahttps://www.mafengwo.cn/gonglve/ziyouxing/2339.html *","title":"\u5c0f\u6848\u4f8b"}]}