!function(t){var i={};function a(n){if(i[n])return i[n].exports;var e=i[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=t,a.c=i,a.d=function(n,e,t){a.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},a.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)a.d(t,i,function(n){return e[n]}.bind(null,i));return t},a.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return a.d(e,"a",e),e},a.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},a.p="",a(a.s="./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/sui.js")}({"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Button/Button.js":
/*!*********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Button/Button.js ***!
  \*********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Button; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:51 PM\n */\n\n/**\n * button控件\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Button(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable',\n      color: $(dom).attr('color') || 'btn-primary',\n      // 按钮颜色\n      content: $(dom).attr('content') || '确定',\n      // 按钮文字\n      custom: $(dom).attr('custom') || '',\n      // 触发事件的自定义代码\n      properties: {\n        mspPreview: $(el).attr('mspPreview') || false\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    var viewHtml = '<button class=\"btn' + \" \" + config.color + '\">' + config.content + '</button>';\n    $(dom).html(viewHtml);\n    $(dom).addClass('isBtn');\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    } else {\n      $(dom).css(\"display\", \"inline-block\");\n    }\n\n    var mode = SUI.Util.getQueryString('mode');\n\n    if (mode == 'print') {\n      $(dom).hide();\n    }\n\n    $(dom).find('button').on('click', function () {\n      var custom = new Function(config.custom);\n      custom();\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Button/Button.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/ChildTitle/ChildTitle.js":
/*!*****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/ChildTitle/ChildTitle.js ***!
  \*****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ChildTitle; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:17 AM\n */\n\n/**\n * 副标题\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction ChildTitle(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/ChildTitle/ChildTitle.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DataTable/DataTable.js":
/*!***************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DataTable/DataTable.js ***!
  \***************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Datatable; });\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:58 PM\n */\n\n/**\n ** Datatable\n **/\nfunction Datatable(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value,\n      columns,\n      mobile;\n  dom.zoo = this;\n  var $table,\n      $tableHead,\n      $tableBody,\n      $addBtn,\n      readyCalls = [],\n      componentIdList = [];\n  var isMobile = SUI.Util.browserType() === 'phone';\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    var that = this;\n    config = val;\n    readyCalls = [];\n\n    if ((!$.isPlainObject(config.dataTable) || !config.dataTable.columns) && !config.ajaxsource) {\n      return;\n    }\n\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n\n    var _value = config.value || [];\n\n    var mode = config.mode || \"view\";\n    var isEmpty = config.isEmpty || \"false\";\n\n    if (!isMobile && SUI.Util.getQueryString('mode') == 'print') {\n      if ($(dom).parents('td')[0].tagName === 'TD') {\n        $(dom).parents('td').eq(0).css('padding', '1px');\n      }\n    }\n\n    function getExcelHtml() {\n      var excelHtml = '<a class=\"btn btn-sm btn-primary  tpl_download\" onclick=\"return false\" >下载模板</a>\\\n                    <div class=\"sui-fileupload\" mode=\"editable\" buttonText=\"上传excel\" ext=\"*.xls;\" uploadurl=\"false\" uploadaddress=\"workflow/resolveExcel.jsp\" style=\"display: inline-block;\"></div>\\\n                    <iframe class=\"tpl_excel_file\" style=\"display:none\"></iframe>';\n      return excelHtml;\n    }\n\n    function dataFormat(columns, tableValue) {\n      $.each(columns, function (i, v) {\n        if (v.component[\"class\"].indexOf('multiselect') > -1) {\n          $.each(tableValue, function (j, v2) {\n            v2[v.component.name] = v2[v.component.name];\n          });\n        } else if (v.component[\"class\"].indexOf('date') > -1) {\n          var format = v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd') || 'yyyy-MM-DD';\n          $.each(tableValue, function (j, v2) {\n            v2[v.component.name] = timestampToTime(v2[v.component.name], format);\n          });\n        }\n      });\n      return tableValue;\n    }\n\n    function timestampToTime(timestamp, format) {\n      var date = new Date(timestamp);\n\n      if (date == 'Invalid Date') {\n        return timestamp;\n      }\n\n      var Y = date.getFullYear() + '-';\n      var M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';\n      var D = date.getDate() + ' ';\n      var h = date.getHours() + ':';\n      var m = date.getMinutes() + ':';\n      var s = date.getSeconds();\n\n      switch (format) {\n        case 'yyyy-MM-dd':\n          return Y + M + D;\n\n        case 'yyyy-MM':\n          return Y + M;\n\n        case 'yyyy-MM-dd HH:mm':\n          return Y + M + D + h + m;\n\n        case 'yyyy-MM-dd HH:mm:ss':\n          return Y + M + D + h + m + s;\n\n        default:\n          return Y + M + D;\n      }\n    }\n\n    function getColumnsList(columns) {\n      var columnsList = [];\n\n      if (columns && columns.length) {\n        $.each(columns, function (i, v) {\n          var componet = 'defult';\n          var format = \"\";\n\n          if (v.title.indexOf('span') > -1) {\n            v.title = v.title.substring(v.title.indexOf('/') + 6, v.title.length);\n          }\n\n          if (v.component[\"class\"].indexOf('multiselect') > -1) {\n            componet = 'checkbox';\n          } else if (v.component[\"class\"].indexOf('date') > -1) {\n            componet = 'date';\n\n            if (v.component[\"class\"] == 'sui-daterange') {\n              format = JSON.stringify([v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd'), v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd')]);\n            } else if (v.component[\"class\"] == 'sui-daterangepicker') {\n              format = v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd') + ' - ' + v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd');\n            } else {\n              format = v.component.format.replace(/Y/g, 'y').replace(/D/g, 'd');\n            }\n          } else if (v.component[\"class\"].indexOf('selectpersonneltool') > -1) {\n            componet = 'person';\n            format = '[{\"id\":\"10001\",\"name\":\"测试人员\",\"type\":\"emp\",\"orginfo\":\"1001,科技部门 \",\"title\":\"测试人员(10001)\"}]';\n          } else if (v.component[\"class\"].indexOf('selectmechanismtool') > -1) {\n            componet = 'org';\n            format = '';\n          }\n\n          var col = {\n            name: v.component.name,\n            title: v.title,\n            componet: componet,\n            format: format\n          };\n          columnsList.push(col);\n        });\n      }\n\n      return columnsList;\n    }\n\n    function getColumns(callback) {\n      var instance = this;\n\n      if (config.ajaxsource) {\n        $.ajax({\n          url: config.ajaxsource,\n          type: 'get',\n          dataType: 'json',\n          success: function success(data) {\n            config.dataTable = data;\n            callback.call(instance);\n          }\n        });\n      } else {\n        callback.call(instance);\n      }\n    }\n\n    function buildTable() {\n      mobile = config.dataTable.mobile && $(window).width() < 480 && mode !== \"editable\";\n      columns = config.dataTable.columns;\n      var isKeepPcOnPhone = config.isKeepPcOnPhone;\n      var emptyHtml = '<div class=\"buttonList\">' + '<a class=\"btn btn-sm btn-primary file_empty\" style=\"margin-right: 5px;\">清空</a>' + '</div>';\n      var emptyHtml_phone = '<a class=\"btn btn-sm btn-primary file_empty\" style=\"margin-right: 5px;\">清空</a>';\n\n      if (mobile) {\n        $table = $('<div class=\"datatable-wrapper\" />');\n        $tableBody = $('<div class=\"datatable-body\" />');\n\n        if (mode == \"editable\" && !config.noactions) {\n          config.actions = true;\n        }\n\n        $table.append($tableBody);\n\n        if (mode == 'editable') {\n          $(dom).html($table).addClass('sui-component-mobile');\n\n          if (isMobile) {// if($(dom).find('.buttonList').length){\n            //     if(!$(dom).find('.file_empty').length){\n            //         $(dom).find('.buttonList').append(emptyHtml_phone);\n            //     }\n            // }else{\n            //     $(dom).append('<div class=\"buttonList button-list-phone\"></div>');\n            //     if(!$(dom).find('.file_empty').length){\n            //         $(dom).find('.buttonList').append(emptyHtml_phone);\n            //     }\n            // }\n          } else {\n            if (isEmpty === 'true') {\n              $($table).before(emptyHtml);\n            } else {\n              $($table).before('<div class=\"buttonList\"></div>');\n            }\n          }\n        } else {\n          $(dom).html($table).addClass('sui-component-mobile');\n        }\n\n        $(dom).parentsUntil('.form-tr').last().removeClass('col-xs-12 col-xs-6');\n      } else {\n        var tableAttrs = $.extend(true, {\n          'class': \"table table-bordered\"\n        }, config.dataTable.attrs);\n        var $tableWrap = $('<div class=\"datatable-wrapper\" />').css({\n          'overflow': 'auto'\n        });\n        $table = $(\"<table />\", tableAttrs);\n        $tableHead = $(\"<thead />\");\n        $tableBody = $(\"<tbody />\");\n        var $headTr = $('<tr />');\n        $.each(columns, function (index, column) {\n          if (column.attrs && column.attrs.width && ['0', '0%'].indexOf(column.attrs.width) !== -1 || column.component[\"class\"] === 'sui-hide' || column.component[\"class\"] === 'sui-include') {\n            $headTr.append($('<th />').css('display', 'none'));\n          } else {\n            if (column.title.indexOf(\"span\") === -1) {\n              // 可编辑状态下，若设置为必填，列名上会添加一个红色的*\n              var colValidate = column.component.validate;\n              var validate = colValidate;\n\n              if (colValidate && typeof colValidate === 'string') {\n                validate = SUI.Util.parseJSON(colValidate, true);\n              }\n\n              if (validate && _typeof(validate) === 'object' && validate.require) {\n                var star = '*';\n                column.title = star + column.title;\n                column.title = column.title.split(star).join('<span class=\"only-mark\">' + star + '</span>');\n              }\n            }\n\n            var th = '<th>' + '<div style=\"width: ' + (column.attrs ? column.attrs.width ? column.attrs.width : '' : '') + 'px;\">' + column.title + '</div>' + '</th>';\n            $headTr.append(th);\n          }\n        });\n\n        if (mode == \"editable\" && !config.noactions) {\n          if (isMobile) {\n            if (config.allowSort == 'true') {\n              $headTr.append('<th class=\"' + (isMobile && !isKeepPcOnPhone ? 'datatable-float-phone' : '') + '\"><div class=\"datatable-handle\">操作</div></th>');\n\n              if (isMobile && isKeepPcOnPhone) {\n                $headTr.find('.datatable-handle').css('width', '136px');\n              }\n            } else {\n              $headTr.append('<th class=\"' + (isMobile && !isKeepPcOnPhone ? 'datatable-float-phone' : '') + '\"><div class=\"datatable-handle\">操作</div></th>');\n\n              if (isMobile && isKeepPcOnPhone) {\n                $headTr.find('.datatable-handle').css('width', '80px');\n              }\n            }\n          } else {\n            if (config.allowSort == 'true') {\n              $headTr.append('<th class=\"' + (isMobile && !isKeepPcOnPhone ? 'datatable-float-phone' : '') + '\"><div style=\"width:136px\">操作</div></th>');\n            } else {\n              $headTr.append('<th class=\"' + (isMobile && !isKeepPcOnPhone ? 'datatable-float-phone' : '') + '\"><div style=\"width:80px\">操作</div></th>');\n            }\n          }\n        }\n\n        $tableHead.html($headTr);\n        $table.append($tableHead).append($tableBody);\n\n        if (mode == 'editable') {\n          $(dom).html($tableWrap.html($table));\n\n          if (isMobile) {// if($(dom).find('.buttonList').length){\n            //     if(!$(dom).find('.file_empty').length){\n            //         $(dom).find('.buttonList').append(emptyHtml_phone);\n            //     }\n            // }else{\n            //     $(dom).append('<div class=\"buttonList button-list-phone\"></div>');\n            //     if(!$(dom).find('.file_empty').length){\n            //         $(dom).find('.buttonList').append(emptyHtml_phone);\n            //     }\n            // }\n          } else {\n            if (isEmpty === 'true') {\n              $($tableWrap).before(emptyHtml);\n            } else {\n              $($table).before('<div class=\"buttonList\"></div>');\n            }\n          }\n        } else {\n          $(dom).html($tableWrap.html($table));\n        }\n      }\n\n      if (isMobile && !isKeepPcOnPhone) {\n        var widowWidth = $(window).width();\n        $(dom).find('.datatable-wrapper').css('width', widowWidth);\n      }\n\n      if (mode == 'editable') {\n        //支持导入\n        var emptyButton = $(dom).find('.file_empty');\n        emptyButton.unbind('click').click(function () {\n          //清除删除验证提示\n          $tableBody.children().find('[aria-describedby]').each(function () {\n            $('#' + $(this).attr('aria-describedby')).remove();\n          });\n          $(dom).sui().setValue([]);\n        });\n\n        if (config.isSupportImport == 'true') {\n          $(dom).find('.buttonList').append(getExcelHtml());\n          SUI.init($.noop(), $(dom));\n          var upload_el = $(dom).find('.excel_uploadfile');\n          var download = $(dom).find('.tpl_download');\n          download.click(function () {\n            $.ajax({\n              url: 'com.sudytech.portalone.base.mspplus.mspplus.DownloadExcelTemplate.biz.ext',\n              type: 'get',\n              data: {\n                columns: JSON.stringify(getColumnsList(config.dataTable.columns)),\n                tableName: config.properties.name\n              },\n              success: function success(data) {\n                if (data.out) {\n                  // 兼容qq浏览器\n                  var $form = $('<form method=\"GET\"></form>');\n                  $form.attr('action', data.out);\n                  $form.appendTo($('body'));\n                  $form.submit();\n                }\n              },\n              error: function error(err) {\n                layer.alert('请求失败，请联系管理员！');\n              }\n            });\n          });\n          var uploadSuccess = $(dom).find('.sui-fileupload');\n          uploadSuccess.unbind('uploadExcelSuccess').on(\"uploadExcelSuccess\", function (e, data) {\n            if (data.resultCode == 0) {\n              var tableValue = data.resultVal;\n\n              if (!tableValue || tableValue.length === 0) {\n                layer.alert('在表格中没有找到符合条件的数据，请检查表格！');\n              } else {\n                var originalValue = JSON.parse($(dom).sui().getValue());\n                var concatValue = originalValue.concat(dataFormat(config.dataTable.columns, tableValue));\n                $(dom).sui().setValue(concatValue, false, true);\n              }\n            }\n          });\n        }\n      }\n\n      if (mode === \"hide\") {\n        $(dom).hide();\n      }\n\n      config.onTableReady = true;\n      this.setValue(_value, true);\n\n      for (var i = 0; i < readyCalls.length; i++) {\n        typeof readyCalls[i] === \"function\" && readyCalls[i].call(this, config);\n      }\n    }\n\n    getColumns.call(this, buildTable);\n\n    if (isMobile) {\n      if ($(dom).parent('.cm-show-inline-content').length) {\n        $(dom).css({\n          \"width\": \"100%\",\n          \"background\": \"#ffffff\"\n        });\n        $(dom).parent().parent().css({\n          \"padding\": \"0\",\n          \"background\": \"#eaeaea\"\n        });\n        $(dom).parent().parent().find('.cm-show-inline-title').css('padding', '12px 15px');\n      } else if ($(dom).parent('.cm-show-vertical-center').length) {\n        $(dom).parent().css('padding', '0');\n      }\n    }\n  };\n\n  this.getValue = function (js) {\n    var _value = [];\n    $(\".table-row\", $tableBody).each(function (index, el) {\n      var item = {};\n      $(\"[isui=true]\", el).each(function (index, _el) {\n        var weigetValue = _el.zoo.getValue(js);\n\n        if (_el.className.indexOf('sui-date') > -1 && _el.className.indexOf('sui-daterange') === -1 || _el.className.indexOf('sui-daterangepicker') > -1) {\n          weigetValue = SUI.Util.getTimePrecision(weigetValue);\n        } else if (_el.className.indexOf('sui-daterange') > -1) {\n          if (js) {\n            if ($(_el).attr('name2')) {\n              var name1 = $(_el).attr('name');\n              var name2 = $(_el).attr('name2');\n              var val1 = SUI.Util.getTimePrecision(weigetValue[name1]);\n              var val2 = SUI.Util.getTimePrecision(weigetValue[name2]);\n            } else {\n              var val1 = SUI.Util.getTimePrecision(weigetValue[0]);\n              var val2 = SUI.Util.getTimePrecision(weigetValue[1]);\n            }\n          } else {\n            if ($(_el).attr('name2')) {\n              var name1 = $(_el).attr('name');\n              var name2 = $(_el).attr('name2');\n              var val1 = SUI.Util.getTimePrecision(weigetValue[name1]);\n              var val2 = SUI.Util.getTimePrecision(weigetValue[name2]);\n            } else {\n              var val1 = SUI.Util.getTimePrecision(JSON.parse(weigetValue)[0]);\n              var val2 = SUI.Util.getTimePrecision(JSON.parse(weigetValue)[1]);\n            }\n          } // weigetValue = \"[\" + '\\\"' +val1 + '\\\"' + \",\" + '\\\"' + val2 + '\\\"' + \"]\";\n\n\n          if ($(_el).attr('name2')) {\n            item[$(_el).attr('name2').replace(/trid-\\S+/, \"\")] = val2;\n            weigetValue = val1;\n          } else {\n            weigetValue = \"[\" + '\\\"' + val1 + '\\\"' + \",\" + '\\\"' + val2 + '\\\"' + \"]\";\n          }\n        }\n\n        if ($.isArray(weigetValue)) {\n          weigetValue = JSON.stringify(weigetValue);\n        }\n\n        item[$(_el).attr('name').replace(/trid-\\S+/, \"\")] = weigetValue;\n      });\n\n      _value.push(item);\n    });\n    return js ? _value : SUI.Util.toJsonString(_value);\n  };\n\n  this.setValue = function (val, isValidate, isexcel) {\n    var isValidate = isValidate || false;\n\n    var _value = val || [];\n\n    if (!$.isArray(_value)) {\n      _value = SUI.Util.parseJSON(_value);\n    }\n\n    value = _value.concat([]);\n    config.value = value;\n\n    if (isMaxRows()) {\n      value.splice(config.maxrows, value.length - config.maxrows);\n    }\n\n    if (config.onTableReady) {\n      render(value, true, isValidate, isexcel);\n    } else {\n      readyCalls.push(function () {\n        render(_value, true, isValidate, isexcel);\n      });\n    }\n  };\n\n  this.addRow = function (data) {\n    if (config.unaddable) return layer.msg('不可增加数据', {\n      icon: 0\n    });\n    if (_typeof(data) !== \"object\") return layer.msg('表格数据为对象或对象数组', {\n      icon: 0\n    });\n\n    if (!$.isArray(data)) {\n      data = [data];\n    }\n\n    for (var i = 0; i < data.length; i++) {\n      if (!addTr(data[i])) break;\n    }\n  };\n\n  this.delRow = function (index) {\n    if (config.undeletable) return layer.msg('不可删除数据', {\n      icon: 0\n    });\n    if (typeof index === \"undefined\") index = value.length - 1;\n\n    if ($(\"tr#\" + index, dom).length) {\n      var index = $(\"tr#\" + index, dom).index();\n    }\n\n    delTr(index);\n  };\n\n  this.validate = function (isChange) {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    if (isChange == 'submit') {\n      if (!_validate('submit')) {\n        return false;\n      }\n    } else {\n      if (!isChange && !_validate()) {\n        return false;\n      }\n    }\n\n    var validate = config.validate;\n\n    var _value = this.getValue(true);\n\n    var result = SUI.Util.validate.call(dom, validate, _value);\n\n    if (!value || !value.length) {\n      $(dom).addClass(SUI.Util.validateClass(result));\n    } else {\n      if (_value && _value.length < config.minrows) {\n        var mintip = '最少添加' + config.minrows + '条数据';\n        $(dom).popover({\n          html: true,\n          content: mintip,\n          trigger: \"manual\",\n          template: SUI.Util.popTpl.tip,\n          placement: \"top\"\n        });\n        $(dom).popover(\"show\");\n        $(dom).on('click', function () {\n          $(dom).popover(\"hide\");\n        }); // layer.msg('最少添加' + config.minrows + '条数据', {icon: 0,time:5000});\n\n        result = false;\n      }\n    }\n\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\")\n      },\n      value: SUI.Util.parseJSON($(el).attr(\"value\"), true),\n      dataTable: SUI.dataTable($(el).attr(\"dataTable\")).value,\n      maxrows: Number($(el).attr(\"maxrows\") || \"0\"),\n      minrows: Number($(el).attr(\"minrows\") || \"0\"),\n      addButton: $(el).attr('addButton') || \"\",\n      onRenderRow: SUI.dataTable($(el).attr(\"onRenderRow\")).value,\n      unaddable: $(el).attr(\"unaddable\") == \"true\",\n      undeletable: $(el).attr(\"undeletable\") == \"true\",\n      noactions: $(el).attr(\"noactions\") == \"true\",\n      ajaxsource: $(el).attr('ajaxsource') || '',\n      allowSort: $(el).attr('allowSort') || 'false',\n      isSupportImport: $(el).attr('isSupportImport') || 'false',\n      isEmpty: $(el).attr('isempty') || 'false',\n      isKeepPcOnPhone: $(el).attr('isKeepPcOnPhone') == 'true' ? true : false //在移动端是否保持老版样式渲染\n\n    };\n    return _data;\n  }\n\n  function _validate(isSubmit) {\n    var result = true;\n    $(\"[isui=true]\", $tableBody).each(function (index, el) {\n      if (nopass(el, isSubmit)) {\n        result = false;\n      }\n    });\n    return result;\n  }\n\n  function isMaxRows() {\n    var addedLength = $tableBody.children().length;\n    return config.maxrows && addedLength >= config.maxrows;\n  }\n\n  function isMinRows() {\n    var addedLength = $tableBody.children().length;\n    return config.minrows && addedLength <= config.minrows;\n  }\n\n  function render(data, resetValue, isValidate, isexcel) {\n    /*if(!data || !data.length){\n        return;\n    }*/\n    //zhangxiang说的，liufei让改的\n    if (resetValue && $tableBody) {\n      $tableBody.empty();\n    }\n\n    addBtn(data);\n\n    if (!$.isArray(data)) {\n      return;\n    }\n\n    var errorData = [];\n    $.each(data, function (index, item) {\n      var $tr = buildTr(item);\n      $tableBody.append($tr);\n      SUI.init($.noop, $tr);\n      var errorIndex = index + 1; //对dataTable控件中的控件进行setValue\n\n      try {\n        $(\"[isui=true]\", $tr).each(function (index, _el) {\n          for (var nameKey in item) {\n            if ($(_el).attr('name').replace(/trid-\\S+/, \"\") === nameKey) {\n              var _elName = $(\"div[name=\" + $(_el).attr('name') + \"]\");\n\n              if (_elName.sui() instanceof Array) {\n                for (var k = 0; k < _elName.sui().length; k++) {\n                  if (_elName.hasClass('sui-hide') || _elName.hasClass('sui-input')) {\n                    var initvaluetype = _elName.attr('initvaluetype');\n\n                    var r_value = '';\n\n                    switch (initvaluetype) {\n                      case 'userInfo':\n                        //用户信息\n                        var initValue = _elName.attr('initvalue');\n\n                        r_value = Coreplus.getContext(initValue) || '';\n                        break;\n\n                      case 'customCode':\n                        //用户信息\n                        var customCode = _elName.attr('customCode').replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\n').replace(/&semicolon;/g, '\\;');\n\n                        var evalRun = function evalRun(code) {\n                          return eval('(function(){' + code + '})()');\n                        };\n\n                        r_value = evalRun(customCode);\n                        break;\n\n                      case 'serviceTable':\n                        var initdisplayname = _elName.attr('initdisplayname');\n\n                        var initfield = _elName.attr('initfield');\n\n                        r_value = Coreplus.getBusinessData(initdisplayname)[initfield];\n                        break;\n\n                      default:\n                        r_value = _elName.attr('suivalue') || '';\n                        break;\n                    }\n\n                    if (isValidate) {\n                      if (item[nameKey]) {\n                        r_value = item[nameKey];\n                      }\n\n                      _elName.sui()[k].setValue(r_value, isValidate);\n                    } else {\n                      if (item[nameKey]) {\n                        r_value = item[nameKey];\n                      }\n\n                      _elName.sui()[k].setValue(r_value);\n                    }\n                  } else {\n                    if (isValidate) {\n                      if (_elName.hasClass('sui-daterange') && _elName.attr('name2') && item[name2]) {\n                        var date_value = {};\n\n                        var name2 = _elName.attr('name2');\n\n                        date_value[nameKey] = item[nameKey];\n                        date_value[name2] = item[name2];\n\n                        _elName.sui().setValue(date_value, isValidate);\n                      } else {\n                        _elName.sui()[k].setValue(item[nameKey], isValidate);\n                      }\n                    } else if (_elName.hasClass('sui-select')) {\n                      var datamethod = _elName.attr('datamethod');\n\n                      if (datamethod == 'entity') {\n                        var initDisplayName = _elName.attr('initdisplayname');\n\n                        var name = _elName.attr('name');\n\n                        var entity = {};\n\n                        if (item[nameKey]) {\n                          entity[nameKey] = item[nameKey];\n                        }\n\n                        Coreplus.processServiceTableData(entity, true, initDisplayName, name, false, true);\n                      } else {\n                        var _s_value = '';\n\n                        if (item[nameKey]) {\n                          _s_value = item[nameKey];\n\n                          if (isValidate) {\n                            _elName.sui().setValue(_s_value, isValidate);\n                          } else {\n                            _elName.sui().setValue(_s_value);\n                          }\n                        }\n                      }\n                    } else {\n                      if (_elName.hasClass('sui-daterange') && _elName.attr('name2') && item[name2]) {\n                        var date_value = {};\n\n                        var name2 = _elName.attr('name2');\n\n                        date_value[nameKey] = item[nameKey];\n                        date_value[name2] = item[name2];\n\n                        _elName.sui().setValue(date_value);\n                      } else {\n                        _elName.sui()[k].setValue(item[nameKey]);\n                      }\n                    }\n                  }\n                }\n              } else {\n                if (_elName.hasClass('sui-hide') || _elName.hasClass('sui-input')) {\n                  var initvaluetype = _elName.attr('initvaluetype');\n\n                  var r_value = '';\n\n                  switch (initvaluetype) {\n                    case 'userInfo':\n                      //用户信息\n                      var initValue = _elName.attr('initvalue');\n\n                      r_value = Coreplus.getContext(initValue) || '';\n                      break;\n\n                    case 'customCode':\n                      //用户信息\n                      var customCode = _elName.attr('customCode').replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\n').replace(/&semicolon;/g, '\\;');\n\n                      var evalRun = function evalRun(code) {\n                        return eval('(function(){' + code + '})()');\n                      };\n\n                      r_value = evalRun(customCode);\n                      break;\n\n                    case 'serviceTable':\n                      var initdisplayname = _elName.attr('initdisplayname');\n\n                      var initfield = _elName.attr('initfield');\n\n                      r_value = Coreplus.getBusinessData(initdisplayname)[initfield];\n                      break;\n\n                    default:\n                      r_value = _elName.attr('suivalue') || '';\n                      break;\n                  }\n\n                  if (isValidate) {\n                    if (item[nameKey]) {\n                      r_value = item[nameKey];\n                    }\n\n                    _elName.sui().setValue(r_value, isValidate);\n                  } else {\n                    if (item[nameKey]) {\n                      r_value = item[nameKey];\n                    }\n\n                    _elName.sui().setValue(r_value);\n                  }\n                } else if (_elName.hasClass('sui-select')) {\n                  var datamethod = _elName.attr('datamethod');\n\n                  if (datamethod == 'entity') {\n                    var initDisplayName = _elName.attr('initdisplayname');\n\n                    var name = _elName.attr('name');\n\n                    var entity = {};\n\n                    if (item[nameKey]) {\n                      entity[nameKey] = item[nameKey];\n                    }\n\n                    Coreplus.processServiceTableData(entity, true, initDisplayName, name, false, true);\n                  } else {\n                    var _s_value = '';\n\n                    if (item[nameKey]) {\n                      _s_value = item[nameKey];\n\n                      if (isValidate) {\n                        _elName.sui().setValue(_s_value, isValidate);\n                      } else {\n                        _elName.sui().setValue(_s_value);\n                      }\n                    }\n                  }\n                } else {\n                  if (_elName.hasClass('sui-daterange') && _elName.attr('name2') && item[name2]) {\n                    var date_value = {};\n\n                    var name2 = _elName.attr('name2');\n\n                    date_value[nameKey] = item[nameKey];\n                    date_value[name2] = item[name2];\n\n                    if (isValidate) {\n                      _elName.sui().setValue(date_value, isValidate);\n                    } else {\n                      _elName.sui().setValue(date_value);\n                    }\n                  } else {\n                    if (isValidate) {\n                      _elName.sui().setValue(item[nameKey], isValidate);\n                    } else {\n                      _elName.sui().setValue(item[nameKey]);\n                    }\n                  }\n                }\n              }\n            }\n          }\n        });\n\n        if (typeof config.onRenderRow === \"function\") {\n          config.onRenderRow.call(dom, $tr[0], item);\n        }\n      } catch (e) {\n        errorData.push(errorIndex);\n        console.log(e);\n      }\n    });\n\n    if (errorData.length && isexcel) {\n      var indexList = errorData.join(',');\n      layer.alert('表格中第' + indexList + '条数据格式有误，请检查excel中数据！');\n    }\n  }\n\n  function addBtn(data) {\n    var isKeepPcOnPhone = config.isKeepPcOnPhone;\n\n    if (config.mode == 'editable') {\n      if (isMobile) {\n        if (isKeepPcOnPhone) {\n          if (!value.length && !(data && data.length)) {\n            $addBtn = $('<tr />');\n            var $td = $('<td align=\"center\" colspan=\"' + (columns.length + 1) + '\"/>');\n            var $add = $('<a class=\"btn btn-default\">' + config.addButton + '</a>');\n            $addBtn.append($td.append($add));\n            $tableBody.html($addBtn);\n            $add.on('click', function (event) {\n              event.preventDefault();\n              addTr('', true, isMobile);\n            });\n          } else {\n            $addBtn && $addBtn.remove();\n          }\n        } else {\n          $addBtn = $('<div class=\"datatable-add-phone\" />');\n          $addBtn.html(config.addButton);\n\n          if ($(dom).find('.buttonList').length) {\n            if (!$(dom).find('.datatable-add-phone').length) {\n              $(dom).find('.buttonList').append($addBtn);\n            }\n          } else {\n            $(dom).append('<div class=\"buttonList button-list-phone\"></div>');\n\n            if (!$(dom).find('.datatable-add-phone').length) {\n              $(dom).find('.buttonList').append($addBtn);\n            }\n          }\n\n          $addBtn.on('click', function (event) {\n            event.stopPropagation();\n            event.preventDefault();\n            addTr('', true, isMobile);\n          });\n        }\n      } else {\n        if (!value.length && !(data && data.length)) {\n          $addBtn = $('<tr />');\n          var $td = $('<td align=\"center\" colspan=\"' + (columns.length + 1) + '\"/>');\n          var $add = $('<a class=\"btn btn-default\">' + config.addButton + '</a>');\n          $addBtn.append($td.append($add));\n          $tableBody.html($addBtn);\n          $add.on('click', function (event) {\n            event.preventDefault();\n            addTr('', true, isMobile);\n          });\n        } else {\n          $addBtn && $addBtn.remove();\n        }\n      }\n    }\n  }\n\n  function delTr(index) {\n    if (isMinRows()) {\n      if (isMobile) {\n        layer.msg('最少添加' + config.minrows + '条数据');\n      } else {\n        layer.msg('最少添加' + config.minrows + '条数据', {\n          icon: 0\n        });\n      }\n\n      return false;\n    }\n\n    var item = value[index];\n\n    if (item) {\n      if (typeof config.onDeleteRow === \"function\") {\n        config.onDeleteRow.call(dom, $tableBody.children().eq(index)[0], item);\n      } // 清除删除行验证提示\n\n\n      $tableBody.children().eq(index).find('[aria-describedby]').each(function () {\n        $('#' + $(this).attr('aria-describedby')).remove();\n      });\n      $tableBody.children().eq(index).fadeOut('300', function () {\n        value.splice(index, 1);\n        $(this).remove();\n        $(dom).trigger('change');\n        addBtn(); // var dataValue = $(dom).sui().getValue(true);\n        // //清除删除验证提示\n        // $tableBody.children().find('[aria-describedby]').each(function () {\n        //     $('#'+$(this).attr('aria-describedby')).remove()\n        // });\n        // if(dataValue.length){\n        //     $(dom).sui().setValue(dataValue,true);\n        // }\n        // var dataValue = $(dom).sui().getValue(true);\n        // 清除删除验证提示\n        // $tableBody.children().find('[aria-describedby]').each(function () {\n        //     $('#'+$(this).attr('aria-describedby')).remove()\n        // });\n        // if(dataValue.length){\n        //     $(dom).sui().setValue(dataValue,true);\n        // }\n      });\n    }\n  }\n\n  function upTr(index) {\n    if (index === 0) return;\n    var data = getOneRowData(index);\n    var $newTr = buildTr(data);\n    value[index] = value.splice(index - 1, 1, value[index])[0];\n    var $currentTr = $tableBody.children().eq(index),\n        $prevTr = $tableBody.children().eq(index - 1); // $prevTr.before($currentTr.clone(true))\n\n    $prevTr.before($newTr);\n    SUI.init($.noop, $newTr);\n    $currentTr.remove();\n    $(dom).trigger('change');\n  }\n\n  function getOneRowData(index) {\n    var $currentTr = $tableBody.children().eq(index),\n        item = {};\n    $(\"[isui=true]\", $currentTr).each(function (index, _el) {\n      item[$(_el).attr('name').replace(/trid-\\S+/, \"\")] = _el.zoo.getValue();\n    });\n    return item;\n  }\n\n  function downTr(index) {\n    var rowLength = $tableBody.children().length;\n    if (index === rowLength - 1) return;\n    var data = getOneRowData(index);\n    var $newTr = buildTr(data);\n    value[index] = value.splice(index + 1, 1, value[index])[0];\n    var $currentTr = $tableBody.children().eq(index),\n        $afterTr = $tableBody.children().eq(index + 1); // $afterTr.after($currentTr.clone(true))\n\n    $afterTr.after($newTr);\n    SUI.init($.noop, $newTr);\n    $currentTr.remove();\n    $(dom).trigger('change');\n  }\n\n  function nopass(el, isSubmit) {\n    var conf = el.zoo.getConfig();\n    var mode = !conf || !conf.mode ? 'view' : 'editable';\n\n    if (el.zoo.type == 'daterange') {\n      return mode === \"editable\" && !el.zoo.validate(isSubmit);\n    } else {\n      return mode === \"editable\" && !el.zoo.validate();\n    }\n  }\n\n  function addTr(_data, isValidate, isMobile) {\n    var isKeepPcOnPhone = config.isKeepPcOnPhone;\n\n    if (isMaxRows()) {\n      if (isMobile) {\n        layer.msg('最多添加' + config.maxrows + '条数据');\n      } else {\n        layer.msg('最多添加' + config.maxrows + '条数据', {\n          icon: 0\n        });\n      }\n\n      return false;\n    }\n\n    if (isMobile && config.mode == 'editable' && !isKeepPcOnPhone) {\n      config.mobileMode = true;\n      createTable();\n    } else {\n      var data = _data || getRowData();\n\n      render([data], '', isValidate);\n      value.push(data);\n      $(dom).removeClass(SUI.Util.validateClass()).trigger('change');\n    }\n\n    return true;\n  }\n\n  function createTable(rowData, index) {\n    var mobile_mode = $('style').attr('mobile_mode') || 1;\n    var columns = config.dataTable.columns;\n\n    if (columns.length) {\n      var tableName = '修改详情';\n      var name = 'modal_' + (config.properties.name || '');\n      var modalHtml = $('<div class=\"ui-modal modal datatable-modal fade ' + name + '\"><div class=\"ui-modal-cnt\"></div></div>');\n      var headHtml = $('<header class=\"ui-modal-hd ui-border-b ui-header\"><div><span class=\"go-back\"></span>' + tableName + '</div><i class=\"ui-modal-close\" ></i></header>');\n      var contentHtml = $('<div class=\"ui-modal-bd\"><div class=\"sui-form\"></div></div>');\n      var btnHtml = $('<div class=\"ui-footer\"><a class=\"btn btn-primary table-confirm\">确认</a><a class=\"btn btn-primary table-delete\">关闭</a></div>');\n      $.each(columns, function (i, c) {\n        var cHtml = '';\n        c.component.sui = true;\n\n        if (mobile_mode == 2) {\n          if (c.component[\"class\"] == 'sui-hide') {\n            cHtml = $('<div class=\"cm-content\" style=\"display: none;\">' + '                            <div class=\"cm-show-block cm-show-vertical-center\">' + '                                <div>' + c.title + '</div>' + '                            </div>' + '                            <div class=\"cm-show-row\">' + '                            <div class=\"cm-show-block cm-show-vertical-center component-box\">' + '                            </div>' + '                            </div>' + '                        </div>');\n          } else {\n            cHtml = $('<div class=\"cm-content\">' + '                            <div class=\"cm-show-block cm-show-vertical-center\">' + '                                <div>' + c.title + '</div>' + '                            </div>' + '                            <div class=\"cm-show-row\">' + '                            <div class=\"cm-show-block cm-show-vertical-center component-box\">' + '                            </div>' + '                            </div>' + '                        </div>');\n          }\n        } else {\n          if (c.component[\"class\"] == 'sui-hide') {\n            cHtml = $('<div class=\"cm-show-row\"><div class=\"cm-show-inline cm-show-vertical-center\" style=\"display: none;\">' + '                            <div class=\"cm-show-inline-title\">' + '                                <div>' + c.title + '</div>' + '                            </div>' + '                            <div class=\"cm-show-inline-content\">' + '                            </div>' + '                        </div></div>');\n          } else {\n            cHtml = $('<div class=\"cm-show-row\"><div class=\"cm-show-inline cm-show-vertical-center\">' + '                            <div class=\"cm-show-inline-title\">' + '                                <div>' + c.title + '</div>' + '                            </div>' + '                            <div class=\"cm-show-inline-content component-box\">' + '                            </div>' + '                        </div></div>');\n          }\n        }\n\n        if (c.component && (c.component[\"class\"].indexOf('sui-select') > -1 || c.component[\"class\"].indexOf('sui-multiselect') > -1)) {\n          if (c.component && (c.component.selectStyle == 'radio' || c.component.selectStyle == 'checkbox')) {\n            c.component.selectStyle = 'select';\n          }\n        }\n\n        var componentHtml = $('<div />', SUI.Util.propString(c.component));\n\n        if (c.component[\"class\"].indexOf('sui-fileupload') > -1 || c.component[\"class\"].indexOf('sui-newfileupload') > -1 || c.component[\"class\"].indexOf('sui-editor') > -1) {\n          cHtml = $('<div class=\"cm-show-row\"><div class=\"cm-show-block cm-show-vertical-center cm-show-inline-title datatable-show-title-special\">' + c.title + '</div><div class=\"cm-show-block cm-show-vertical-center datatable-show-content-special\"><div class=\"component-box\"></div></div></div>');\n        }\n\n        cHtml.find('.component-box').html(componentHtml);\n        contentHtml.find('.sui-form').append(cHtml);\n      });\n      contentHtml.append(btnHtml);\n\n      if ($('body').find('.' + name).length) {\n        $('body').find('.' + name).remove();\n      }\n\n      SUI.init($.noop(), contentHtml);\n      modalHtml.find('.ui-modal-cnt').append(headHtml);\n      modalHtml.find('.ui-modal-cnt').append(contentHtml);\n      $('body').append(modalHtml);\n      var input_hide = contentHtml.find('[sui=\"true\"]');\n\n      if (input_hide.length) {\n        $.each(input_hide, function (i, v) {\n          if ($(v).hasClass('sui-input') || $(v).hasClass('sui-hide')) {\n            var initvaluetype = $(v).attr('initvaluetype');\n            var r_value = '';\n\n            switch (initvaluetype) {\n              case 'userInfo':\n                //用户信息\n                var initValue = $(v).attr('initvalue');\n                r_value = Coreplus.getContext(initValue) || '';\n                break;\n\n              case 'customCode':\n                //用户信息\n                var customCode = $(v).attr('customCode').replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\n').replace(/&semicolon;/g, '\\;');\n\n                var evalRun = function evalRun(code) {\n                  return eval('(function(){' + code + '})()');\n                };\n\n                r_value = evalRun(customCode);\n                break;\n\n              case 'serviceTable':\n                var initdisplayname = $(v).attr('initdisplayname');\n                var initfield = $(v).attr('initfield');\n                r_value = Coreplus.getBusinessData(initdisplayname)[initfield];\n                break;\n\n              default:\n                r_value = $(v).attr('suivalue') || '';\n                break;\n            }\n\n            $(v).sui().setValue(r_value);\n          }\n        });\n      }\n\n      if (rowData) {\n        $('.' + name).find('.sui-form').sui().setValue(rowData);\n      }\n\n      $('.table-confirm', $('.' + name)).click(function () {\n        if (!$('.' + name).find('.sui-form').sui().validate()) {\n          return;\n        }\n\n        var currentData = $('.' + name).find('.sui-form').sui().getValue();\n        delete currentData._ext;\n        var tableData = JSON.parse($(dom).sui().getValue());\n\n        if (index || index == 0) {\n          tableData[index] = currentData;\n          $(dom).sui().setValue(tableData);\n        } else {\n          var concatValue = tableData.concat(currentData);\n          $(dom).sui().setValue(concatValue);\n        }\n\n        $('.' + name).find('.sui-form').remove();\n        $('.' + name).modal('hide');\n      });\n      $('.table-delete', $('.' + name)).click(function () {\n        $('.' + name).find('.sui-form').remove();\n        $('.' + name).modal('hide');\n      });\n      $('.go-back', $('.' + name)).click(function () {\n        $('.' + name).find('.sui-form').remove();\n        $('.' + name).modal('hide');\n      });\n      $('.' + name).modal('show');\n    }\n  }\n\n  function getRowData() {\n    var data = {};\n    $.each(columns, function (index, column) {\n      var component = $.extend(true, {}, column.component);\n\n      if (\"value\" in component) {\n        data[component.name] = component.value;\n      }\n\n      if (component[\"class\"] == 'sui-hide' || component[\"class\"] == 'sui-select') {\n        data[component.name] = '';\n      }\n    });\n    return data;\n  }\n\n  function buildTr(_data) {\n    var data = _data || {};\n    var id = 'trid-' + Number(new Date());\n    var $tr = $('<' + (mobile ? \"div\" : \"tr\") + ' class=\"table-row\" id=\"' + id + '\" />');\n    var mode = config.mode || \"view\";\n    var mobileMode = config.mobileMode || false;\n    var tdGroups = [];\n    var trNum = $(dom).find('table tbody tr').length;\n    var isKeepPcOnPhone = config.isKeepPcOnPhone;\n\n    if (mobile) {\n      trNum = $(dom).find('.datatable-wrapper .datatable-body .table-row').length;\n    }\n\n    $.each(columns, function (index, column) {\n      if (mobile && column.attrs) {\n        column.attrs.width = undefined;\n      }\n\n      var $td = $('<' + (mobile ? \"div\" : \"td\") + ' />', column.attrs);\n      var component = $.extend(true, {}, column.component, {\n        isui: true,\n        mode: isMobile ? 'readOnly' : mobileMode ? 'readOnly' : mode == \"editable\" ? column.component.mode : mode\n      });\n      component.name += 'trid-' + trNum + config.properties.name;\n\n      if (typeof data[column.component.name] !== \"undefined\") {\n        if (column.component[\"class\"] == 'sui-daterange' && column.component.name2) {\n          if (typeof data[column.component.name2] !== \"undefined\") {\n            var date_name2 = data[column.component.name2] !== null ? data[column.component.name2] : '';\n            var date_name = data[column.component.name] !== null ? data[column.component.name] : '';\n            var key_name = column.component.name,\n                key_name2 = column.component.name2;\n            var dateRangeValue = {};\n            dateRangeValue[key_name] = date_name;\n            dateRangeValue[key_name2] = date_name2;\n            component.value = dateRangeValue;\n          } else {\n            // 兼容之前已经不对的数据\n            component.value = data[column.component.name] !== null ? data[column.component.name] : '';\n          }\n        } else {\n          component.value = data[column.component.name] !== null ? data[column.component.name] : '';\n        }\n      }\n\n      var $component = $('<div />', SUI.Util.propString(component));\n\n      if (column.attrs && column.attrs.width && ['0', '0%'].indexOf(column.attrs.width) !== -1 || column.component[\"class\"] === 'sui-hide' || column.component[\"class\"] === 'sui-include') {\n        $td.hide();\n      }\n\n      if (mobile) {\n        if (column.role && column.role == \"title\") {\n          $td.addClass('table-col-title');\n        } else {\n          $td.append('<span class=\"table-col-label\">' + column.title + '：</span>');\n        }\n\n        $td.addClass('table-col clearfix').append($component);\n\n        if (column.role && column.role === \"group\") {\n          tdGroups.push($td);\n        } else {\n          $tr.append($td);\n        }\n      } else {\n        $td.addClass('table-col').html($component).css({\n          'vertical-align': 'middle'\n        });\n        $tr.append($td);\n      }\n    });\n\n    if (tdGroups && tdGroups.length) {\n      var $trGroup = $('<div class=\"datatable-col-flex clearfix\" />');\n      $.each(tdGroups, function (index, $td) {\n        $trGroup.append($td);\n      });\n\n      if ($tr.find('.table-col-title').length) {\n        $tr.find('.table-col-title').after($trGroup);\n      } else {\n        $tr.prepend($trGroup);\n      }\n    }\n\n    if (mode == \"editable\" && !config.noactions) {\n      var actionSuffix = '-trid-' + trNum + config.properties.name;\n      var $action = $('<' + (mobile ? \"div\" : \"td\") + ' class=\"table-col-actions ' + (isMobile && !isKeepPcOnPhone ? 'datatable-float-phone datatable-show-btnlist' : '') + '\"  style=\"vertical-align:middle;\"/>');\n      var mark = mobile ? \"div\" : \"td\";\n\n      if (isMobile && !isKeepPcOnPhone) {\n        var showMoreHtml = $('<div class=\"datatable-more-phone\"></div>');\n        var tipHtml = $('<div class=\"tips-phone tips-hide\">' + '<div class=\"tips-content\"></div>' + '<span class=\"tips-out\"></span>' + '<span class=\"tips-in\"></span>' + '</div>');\n        var $editBtn = $('<div class=\"datatable-btnlist datatable-edit-phone\">' + '<span class=\"datatable-icon-edit\"></span>' + '<span class=\"\">修改</span>' + '</div>');\n        var $delBtn = $('<div class=\"datatable-btnlist datatable-del-phone\">' + '<span class=\"datatable-icon-del\"></span>' + '<span class=\"\">删除</span>' + '</div>');\n        var $upBtn = $('<div class=\"datatable-btnlist datatable-up-phone\">' + '<span class=\"datatable-icon-up\"></span>' + '<span class=\"\">上移</span>' + '</div>');\n        var $downBtn = $('<div class=\"datatable-btnlist datatable-down-phone\">' + '<span class=\"datatable-icon-down\"></span>' + '<span class=\"\">下移</span>' + '</div>');\n        tipHtml.find('.tips-content').append($editBtn);\n\n        if (!config.undeletable) {\n          tipHtml.find('.tips-content').append($delBtn);\n        }\n\n        if (config.allowSort === 'true') {\n          tipHtml.find('.tips-content').append($upBtn);\n          tipHtml.find('.tips-content').append($downBtn);\n        }\n\n        $action.html(showMoreHtml);\n        $tr.append($action);\n        $action.unbind('click').on('click', function (e) {\n          e.stopPropagation();\n          var index = $(this).parents('tr').index();\n          $(dom).attr('handleindex', index);\n          var top = 40;\n\n          if (index == 0 || index) {\n            var childList = $(this).parents('tbody').eq(0).children();\n\n            for (var i = 0; i <= index; i++) {\n              if (i == index) {\n                var trIndexHeight = childList.eq(i).height();\n                top += (trIndexHeight > 50 ? 50 + (trIndexHeight - 50) / 2 : 50) - 8;\n              } else {\n                top += childList.eq(i).height();\n              }\n            }\n          }\n\n          if ($(dom).find('.tips-phone').length) {\n            var tips_phone = $(dom).find('.tips-phone');\n\n            if (tips_phone.hasClass('tips-hide')) {\n              tips_phone.removeClass('tips-hide').show();\n            } else {\n              tips_phone.addClass('tips-hide').hide();\n            }\n          } else {\n            $(dom).append(tipHtml);\n          }\n\n          $(document).unbind('click').on('click', function () {\n            if ($(dom).find('.tips-phone').length) {\n              var tips_phone = $(dom).find('.tips-phone');\n\n              if (!tips_phone.hasClass('tips-hide')) {\n                tips_phone.addClass('tips-hide').hide();\n              }\n            }\n          });\n          $(dom).find('.tips-phone').css({\n            \"top\": top,\n            \"right\": \"4px\"\n          });\n          $delBtn.unbind('click').on('click', function (event) {\n            var handleIndex = parseInt($(dom).attr('handleindex'));\n            $(dom).find('.tips-phone').hide();\n            event.stopPropagation();\n            delTr(handleIndex);\n          });\n          $upBtn.unbind('click').on('click', function (e) {\n            var handleIndex = parseInt($(dom).attr('handleindex'));\n            $(dom).find('.tips-phone').hide();\n            upTr(handleIndex);\n          });\n          $downBtn.unbind('click').on('click', function (e) {\n            var handleIndex = parseInt($(dom).attr('handleindex'));\n            $(dom).find('.tips-phone').hide();\n            downTr(handleIndex);\n          });\n          $editBtn.unbind('click').on('click', function (e) {\n            var handleIndex = parseInt($(dom).attr('handleindex'));\n            $(dom).find('.tips-phone').hide();\n            var value = JSON.parse($(dom).sui().getValue())[handleIndex];\n            createTable(value, handleIndex);\n          });\n        });\n      } else {\n        var $delBtn = $('<a class=\"table-tr-btn table-deltr-btn\"><i class=\"fa fa-minus-circle\" id=\"deltr-btn' + actionSuffix + '\"></i></a>');\n        var $addBtn = $('<a class=\"table-tr-btn table-addtr-btn\"><i class=\"fa fa-plus-circle\" id=\"addtr-btn' + actionSuffix + '\"></i></a>');\n        var $editBtn = $('<a class=\"table-tr-btn table-addtr-btn\"><i class=\"fa fa-edit\" id=\"edit-btn' + actionSuffix + '\"></i></a>');\n        var $upBtn = $('<a class=\"table-tr-btn table-deltr-btn\"><i class=\"fa fa-arrow-circle-up\" aria-hidden=\"true\" id=\"up-btn' + actionSuffix + '\"></i></a>');\n        var $downBtn = $('<a class=\"table-tr-btn table-deltr-btn\"><i class=\"fa fa-arrow-circle-down\" aria-hidden=\"true\" id=\"down-btn' + actionSuffix + '\"></i></a>');\n        !config.undeletable && $action.append($delBtn);\n        !config.unaddable && $action.append($addBtn);\n\n        if (isMobile) {\n          !config.unaddable && $action.append($editBtn);\n        }\n\n        if (config.allowSort === 'true') {\n          $action.append($upBtn).append($downBtn);\n        }\n\n        $tr.append($action);\n        $delBtn.on('click', function (event) {\n          event.stopPropagation();\n          var index = $(this).parents('tr').index();\n          delTr(index);\n        });\n        $addBtn.on('click', function (event) {\n          event.stopPropagation();\n          addTr('', true, isMobile);\n        });\n        $upBtn.on('click', function (e) {\n          var index = $(this).parents('tr').index();\n          upTr(index);\n        });\n        $downBtn.on('click', function (e) {\n          var index = $(this).parents('tr').index();\n          downTr(index);\n        });\n        $editBtn.on('click', function () {\n          var index = $(this).parents('tr').index();\n          var value = JSON.parse($(dom).sui().getValue())[index];\n          createTable(value, index);\n        });\n      }\n    }\n\n    return $tr;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DataTable/DataTable.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Date/Date.js":
/*!*****************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Date/Date.js ***!
  \*****************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DateSingle; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:19 PM\n */\n\n/***\n *** Date组件\n ***/\nfunction DateSingle(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value;\n  dom.zoo = this;\n  var $input, $tpl, dateRange;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    var parseData = val;\n\n    var require = parseData.validate && parseData.validate.require ? '<span class=\"text-red\">*</span>' : '';\n\n    var title = parseData.properties.title || \"\";\n    var name = parseData.properties.name || \"\";\n    var suffix = '<div class=\"input-group-addon\">' + '<i class=\"fa fa-calendar\"></i>' + '</div>';\n    var isMobile = SUI.Util.browserType() === 'phone';\n\n    if (isMobile && wf2.isNewInPhone) {\n      suffix = '<span class=\"org-arrow\"></span>';\n    }\n\n    var template = '<div class=\"input-group date date-picker ' + (isMobile && wf2.isNewInPhone ? \"date-phone\" : \"\") + '\">' + '<input name=\"' + name + '\" ' + (isMobile && wf2.isNewInPhone ? \"placeholder='请选择'\" : \"\") + ' type=\"text\" class=\"form-control \" value=\"' + parseData.value + '\" />' + suffix + '</div>';\n    var $html = $(template);\n    $(dom).html($html);\n    $input = $(\"input\", dom);\n    var mode = config.mode || 'view';\n\n    var _date = SUI.Util.validDateStr(config.value, parseData.format); // 获取当前时间\n\n\n    var nowDate = new Date(+new Date() + 8 * 3600 * 1000).toISOString().replace(/T/g, ' ').replace(/\\.[\\d]{3}Z/, '');\n    nowDate = SUI.Util.validDateStr(nowDate, parseData.format); // var readOnlyVal;\n    // ( config.initEmpty==='false'&&config.value.length===0 ) ? readOnlyVal = '' : readOnlyVal = nowDate.validate\n\n    if (mode == \"readOnly\" || mode == \"view\") {\n      $html.hide();\n\n      if (config.initEmpty === 'false' && config.value.length === 0) {\n        // $input.val('');\n        _date = \"\";\n      } else if (config.initEmpty === 'true' && config.value.length === 0) {\n        _date = nowDate.validate;\n        $input.val(nowDate.validate);\n      } else {\n        _date = config.value;\n        $input.val(config.value);\n      }\n\n      $tpl = $('<div class=\"value-text\" />');\n      $tpl.html('<span class=\"value\" id=\"vaue_' + name + '\">' + _date + '</span>');\n      $input.attr(\"readOnly\", \"readOnly\");\n      $(dom).addClass('form-readOnly').append($tpl);\n    }\n\n    if (mode == \"editable\") {\n      $input.removeAttr(\"readOnly\");\n      $(dom).removeClass('form-readOnly');\n\n      if (parseData.setDateRange == 'before') {\n        parseData.dateRange = {\n          maxDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == 'after') {\n        parseData.dateRange = {\n          minDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == 'custom') {\n        var customCode = $(dom).attr('customCode') || '';\n        customCode = customCode.replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\n').replace(/&semicolon;/g, '\\;');\n\n        try {\n          var dateRangeData = eval('(function(){' + customCode + '})()');\n          parseData.dateRange = dateRangeData || {};\n        } catch (error) {\n          console.log('日期范围自定义代码错误');\n        }\n      }\n\n      var opt = $.extend(true, {}, {\n        startDate: _date.date,\n        singleDatePicker: true,\n        // timePicker: $(dom).hasClass('datetime'),\n        timePicker: /HH/.test(parseData.format),\n        timePickerSeconds: /ss/.test(parseData.format),\n        timePickerIncrement: parseData.minStep,\n        locale: {\n          format: parseData.format,\n          cancelLabel: '清空'\n        },\n        dateName: name\n      }, parseData.dateRange || {});\n      $(\".date-picker\", dom).daterangepicker(opt);\n      $(\".date-picker\", dom).on('beforeshow.daterangepicker', function (e, date) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1) {\n          var dateDom = $(date.container[0]).find('.calendar-table');\n\n          if (dateDom.length) {\n            $.each(dateDom, function (i, dom) {\n              $(dom).remove();\n            });\n          }\n        }\n      });\n\n      if (config.value === undefined) {\n        config.value = \"\";\n      }\n\n      if (config.initEmpty === 'false' && config.value.length === 0) {\n        $input.val('');\n      } else if (config.initEmpty === 'true' && config.value.length === 0) {\n        $input.val(nowDate.validate);\n      } else {\n        $input.val(config.value);\n      }\n\n      dateRange = $(\".date-picker\", dom).data('daterangepicker');\n\n      if (!config.inputFree) {\n        $(\"input\", dom).attr(\"readonly\", \"readonly\");\n      }\n\n      $(\".date-picker\", dom).on('cancel.daterangepicker', function (ev, picker) {\n        $input.val('');\n      });\n    }\n\n    if (mode == \"hide\") {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    return $input.val();\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n    /*根据format格式 设置*/\n\n    var startDate = SUI.Util.validDateStr(val, config.format);\n    value = startDate.validate;\n\n    if (isValidate) {\n      $input.val(value);\n    } else {\n      $input.val(value).trigger(\"change\");\n    }\n\n    if (config.mode === \"editable\") {\n      //var startDate = SUI.Util.validDateStr(value, config.format);\n      dateRange && dateRange.startDate && (dateRange.startDate = startDate.date);\n      dateRange && dateRange.endDate && (dateRange.endDate = startDate.date);\n    } //var startDate = SUI.Util.validDateStr(value, config.format);\n\n\n    $tpl && $(\".value\", $tpl).html(value);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\")\n      },\n      value: $(el).attr(\"value\") || \"\",\n      suffix: $(el).attr(\"suffix\") || \"\",\n      format: $(el).attr(\"format\") || \"YYYY-MM-DD\",\n      minStep: Number($(el).attr(\"minStep\") || \"1\"),\n      dateRange: SUI.Util.parseJSON($(el).attr(\"dateRange\"), true),\n      inputFree: $(el).attr(\"inputFree\") === \"true\",\n      initEmpty: $(el).attr(\"initEmpty\") || 'false',\n      setDateRange: $(el).attr('setDateRange') || '无',\n      customCode: $(el).attr('customCode') || ''\n    };\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Date/Date.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRange/DateRange.js":
/*!***************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRange/DateRange.js ***!
  \***************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return DateRange; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:22 PM\n */\n\n/***\n *** DateRange 起止日期组件\n ***/\nfunction DateRange(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value;\n  dom.zoo = this;\n  $(dom).addClass(\'clearfix\');\n  var $start, $end, $tpl, startDateRange, endDateRange;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    var parseData = config;\n\n    var require = parseData.validate && parseData.validate.require ? \'<span class="text-red">*</span>\' : \'\';\n\n    var title = parseData.properties.title || "";\n    var name = parseData.properties.name || "";\n    this.name2 = parseData.properties.name2 || "";\n    var name2 = parseData.properties.name2 || "";\n    var startDate = \'\',\n        endDate = \'\';\n\n    if (name2 && config.value[name2]) {\n      startDate = config.value[name.replace(/trid-\\S+/, "")];\n      endDate = config.value[name2];\n    } else {\n      startDate = config.value[0];\n      endDate = config.value[1];\n    }\n\n    startDate = SUI.Util.validDateStr(startDate, parseData.format);\n    endDate = SUI.Util.validDateStr(endDate, parseData.format);\n    var suffix = \'<div class="input-group-addon">\' + \'<i class="fa fa-calendar"></i>\' + \'</div>\';\n    var isMobile = SUI.Util.browserType() === \'phone\';\n\n    if (isMobile && wf2.isNewInPhone) {\n      suffix = \'\';\n    }\n\n    var hasSuffix = " input-group date date-picker";\n    var template = \'<div class="item-col col-xs-5">\' + \'<div class="date-start\' + hasSuffix + \'">\' + \'<input type="text" \' + (isMobile && wf2.isNewInPhone ? "placeholder=\'请选择\'" : "") + \' value="\' + startDate.validate + \'" class="form-control">\' + suffix + \'</div></div>\' + \'<div class="item-col col-xs-2 text-center">至</div>\' + \'<div class="item-col col-xs-5">\' + \'<div class="date-end\' + hasSuffix + \'">\' + \'<input type="text" \' + (isMobile && wf2.isNewInPhone ? "placeholder=\'请选择\'" : "") + \' value="\' + endDate.validate + \'" class="form-control">\' + suffix + \'</div></div>\' + \'<input class="target-input" type="hidden" name="\' + name + \'" value="\' + parseData.value + \'" />\';\n    var $html = $(template);\n    $(dom).html($html);\n    $(dom).find(\'.item-col\').css(\'padding\', 0);\n    $start = $(".date-start input", dom);\n    $end = $(".date-end input", dom);\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      $html.hide();\n      $tpl = $(\'<div class="value-text" />\');\n\n      if (config.initEmpty === \'true\' && config.value.length === 0) {\n        $start.val("");\n        $end.val("");\n        $tpl.html(\'<span class="value" id="value_\' + name + \'1"></span> 至 <span class="value" id="value_\' + name + \'2"></span>\');\n        $tpl.hide();\n      } else {\n        $tpl.html(\'<span class="value" id="value_\' + name + \'1">\' + startDate.validate + \'</span> 至 <span class="value" id="value_\' + name + \'2">\' + endDate.validate + \'</span>\');\n      }\n\n      $(dom).addClass(\'form-readOnly\').append($tpl);\n      $start.attr("readOnly", "readOnly");\n      $end.attr("readOnly", "readOnly");\n    }\n\n    if (mode == "editable") {\n      $(dom).removeClass(\'form-readOnly\');\n      var nowDate = new Date(+new Date() + 8 * 3600 * 1000).toISOString().replace(/T/g, \' \').replace(/\\.[\\d]{3}Z/, \'\');\n      nowDate = SUI.Util.validDateStr(nowDate, parseData.format);\n\n      if (parseData.setDateRange == \'before\') {\n        parseData.dateRange = {\n          maxDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == \'after\') {\n        parseData.dateRange = {\n          minDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == \'custom\') {\n        var customCode = $(dom).attr(\'customCode\') || \'\';\n        customCode = customCode.replace(/&#39;/g, "\\\'").replace(/&#34;/g, "\\"").replace(/&#8629;/g, \'\\n\').replace(/&semicolon;/g, \'\\;\');\n\n        try {\n          var dateRangeData = eval(\'(function(){\' + customCode + \'})()\');\n          parseData.dateRange = dateRangeData || {};\n        } catch (error) {\n          console.log(\'日期范围自定义代码错误\');\n        }\n      }\n\n      var opt = $.extend(true, {}, {\n        startDate: startDate.date,\n        endDate: endDate.date,\n        singleDatePicker: true,\n        // timePicker: $(dom).hasClass(\'datetime\'),\n        timePicker: /HH/.test(parseData.format),\n        timePickerSeconds: /ss/.test(parseData.format),\n        timePickerIncrement: parseData.minStep,\n        locale: {\n          format: parseData.format,\n          resetLabel: \'重置\',\n          applyLabel: \'确定\',\n          cancelLabel: \'清空\'\n        }\n      }, parseData.dateRange || {});\n      $(".date-picker.date-start", dom).daterangepicker($.extend(true, {}, opt, {\n        startDate: startDate.date,\n        dateName: name + \'daterange_start\'\n      }));\n      $(".date-picker.date-end", dom).daterangepicker($.extend(true, {}, opt, {\n        startDate: endDate.date,\n        dateName: name + \'daterange_end\'\n      }));\n\n      if (config.initEmpty === \'true\' && config.value.length === 0) {\n        $start.val("");\n        $end.val("");\n      }\n\n      startDateRange = $(".date-picker.date-start", dom).data(\'daterangepicker\');\n      endDateRange = $(".date-picker.date-end", dom).data(\'daterangepicker\');\n      var rangeStart = $(".date-picker.date-start", dom).data("daterangepicker"),\n          rangeEnd = $(".date-picker.date-end", dom).data("daterangepicker");\n      $(".date-picker.date-start", dom).on(\'beforeshow.daterangepicker\', function (e, start) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf(\'yyyy\') == -1 && parseData.format.indexOf(\'YYYY\') == -1 && parseData.format.indexOf(\'MM\') == -1 && parseData.format.indexOf(\'DD\') == -1) {\n          var dateDom = $(start.container[0]).find(\'.calendar-table\');\n\n          if (dateDom.length) {\n            $.each(dateDom, function (i, dom) {\n              $(dom).remove();\n            });\n          }\n        }\n\n        var endVal = $end.val();\n\n        if (!endVal) {\n          start.maxDate = start.options.maxDate ? moment(start.options.maxDate) : false;\n          start.startDate = start.startDate ? start.startDate : start.options.minDate ? moment(start.options.minDate) : start.startDate;\n          start.oldStartDate = start.startDate ? start.startDate : start.options.minDate ? moment(start.options.minDate) : start.startDate;\n          start.endDate = start.endDate ? start.endDate : start.options.minDate ? moment(start.options.minDate) : start.endDate;\n          start.oldEndDate = start.endDate ? start.endDate : start.options.minDate ? moment(start.options.minDate) : start.oldEndDate;\n        }\n      });\n      $(".date-picker.date-start", dom).on("show.daterangepicker", function (e, start) {\n        if (!config.timeRange) {\n          rangeEnd.minDate = start.startDate.clone();\n          if (start.startDate.valueOf() > rangeEnd.startDate.valueOf()) rangeEnd.setStartDate(start.startDate.clone());\n        } else {\n          var _end = _timeRange(rangeEnd.startDate, start.startDate, true);\n\n          _end.change && rangeEnd.setStartDate(_end.date);\n        }\n      });\n      $(".date-picker.date-end", dom).on(\'beforeshow.daterangepicker\', function (e, end) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf(\'HH\') == 0) {\n          var dateDom = $(end.container[0]).find(\'.calendar-table\');\n\n          if (dateDom.length) {\n            $.each(dateDom, function (i, dom) {\n              $(dom).remove();\n            });\n          }\n        }\n\n        var startVal = $start.val();\n\n        if (!startVal) {\n          end.minDate = end.options.minDate ? moment(end.options.minDate) : false;\n          end.startDate = end.startDate ? end.startDate : end.options.minDate ? moment(end.options.minDate) : end.startDate;\n          end.oldStartDate = end.startDate ? end.startDate : end.options.minDate ? moment(end.options.minDate) : end.oldStartDate;\n          end.endDate = end.endDate ? end.endDate : end.options.minDate ? moment(end.options.minDate) : end.endDate;\n          end.oldEndDate = end.endDate ? end.endDate : end.options.minDate ? moment(end.options.minDate) : end.oldEndDate;\n        }\n      });\n      $(".date-picker.date-end", dom).on("show.daterangepicker", function (e, end) {\n        if (!config.timeRange) {\n          rangeStart.maxDate = end.startDate.clone();\n          if (end.startDate.valueOf() < rangeStart.startDate.valueOf()) rangeStart.setStartDate(end.startDate.clone());\n        } else {\n          var _start = _timeRange(rangeStart.startDate, end.startDate);\n\n          _start.change && rangeStart.setStartDate(_start.date);\n        }\n      });\n      $(".date-picker.date-start", dom).on("apply.daterangepicker", function (e, start) {\n        if (!config.timeRange) {\n          rangeEnd.minDate = start.startDate.clone();\n          if (start.startDate.valueOf() > rangeEnd.startDate.valueOf()) rangeEnd.setStartDate(start.startDate.clone());\n        } else {\n          var _end = _timeRange(rangeEnd.startDate, start.startDate, true);\n\n          _end.change && rangeEnd.setStartDate(_end.date);\n        }\n      });\n      $(".date-picker.date-end", dom).on("apply.daterangepicker", function (e, end) {\n        if (!config.timeRange) {\n          rangeStart.maxDate = end.startDate.clone();\n          if (end.startDate.valueOf() < rangeStart.startDate.valueOf()) rangeStart.setStartDate(end.startDate.clone());\n        } else {\n          var _start = _timeRange(rangeStart.startDate, end.startDate);\n\n          _start.change && rangeStart.setStartDate(_start.date);\n        }\n      });\n      $(".date-picker.date-start", dom).on("cancel.daterangepicker", function (e, start) {\n        $start.val("");\n      });\n      $(".date-picker.date-end", dom).on("cancel.daterangepicker", function (e, start) {\n        $end.val("");\n      });\n\n      if (!config.inputFree) {\n        $("input", dom).attr("readonly", "readonly");\n      }\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function (js) {\n    if (this.name2) {\n      var vals = {};\n      vals[this.name] = $start.val();\n      vals[this.name2] = $end.val();\n      return js ? vals : SUI.Util.toJsonString(vals);\n    }\n\n    var vals = [$start.val(), $end.val()];\n    return js ? vals : SUI.Util.toJsonString(vals);\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n    value = val || ["", ""];\n\n    if (typeof value == "string") {\n      value = SUI.Util.parseJSON(val, true);\n    }\n\n    if (this.name2 && value[this.name2]) {\n      value = [value[this.name], value[this.name2]];\n    }\n    /*根据format格式 设置*/\n\n\n    value[0] = SUI.Util.validDateStr(value[0], config.format).validate;\n    value[1] = SUI.Util.validDateStr(value[1], config.format).validate;\n\n    if (isValidate) {\n      $start.val(value[0]);\n      $end.val(value[1]);\n    } else {\n      $start.val(value[0]).trigger("change");\n      $end.val(value[1]).trigger("change");\n    }\n\n    if (config.mode == "editable") {\n      var startDate = SUI.Util.validDateStr(value[0], config.format),\n          endDate = SUI.Util.validDateStr(value[1], config.format);\n      startDateRange.startDate = startDate.date;\n      endDateRange.startDate = endDate.date; // 解决回填数据后先打开右边选择日期还能选择开始日期之前的问题\n\n      startDateRange.maxDate = endDateRange.startDate.clone();\n      endDateRange.minDate = startDateRange.startDate.clone();\n    }\n\n    $tpl && $(".value", $tpl).eq(0).html(value[0]);\n    $tpl && $(".value", $tpl).eq(1).html(value[1]);\n\n    if (value[0]) {\n      $tpl && $tpl.show();\n    } else {\n      $tpl && $tpl.hide();\n    } // 解决重置之后 会留有上此操作记录的问题\n\n\n    if (config.mode == \'editable\') {\n      if (value[0] == "" || value[1] == "") {\n        var rangeStart = $(".date-picker.date-start", dom).data("daterangepicker"),\n            rangeEnd = $(".date-picker.date-end", dom).data("daterangepicker");\n        rangeStart.minDate = false;\n        rangeStart.maxDate = false;\n        rangeStart.endDate._d = new Date();\n      }\n    }\n  };\n\n  this.validate = function (isSubmit) {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    if (isSubmit != \'submit\') {\n      var daterange_value = JSON.parse($(dom).sui().getValue());\n      var nameValue = \'\',\n          name2Value = \'\';\n\n      if ($(dom).sui().name2) {\n        nameValue = daterange_value[$(dom).sui().name];\n        name2Value = daterange_value[$(dom).sui().name2];\n      } else {\n        nameValue = daterange_value[0];\n        name2Value = daterange_value[1];\n      }\n\n      if (!(!nameValue && !name2Value)) {\n        return;\n      }\n    }\n\n    var validate = config.validate;\n    var result = SUI.Util.validate.call(dom, validate, $start.val()) && SUI.Util.validate.call(dom, validate, $end.val());\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr("mode"),\n      validate: SUI.Util.parseJSON($(el).attr("validate"), true),\n      properties: {\n        title: $(el).attr("title"),\n        name: $(el).attr("name"),\n        name2: $(el).attr("name2") || ""\n      },\n      value: SUI.Util.parseJSON($(el).attr("value") || "[]", true),\n      suffix: $(el).attr("suffix") || "",\n      format: $(el).attr("format") || "YYYY-MM-DD",\n      minStep: Number($(el).attr("minStep") || "1"),\n      timeRange: $(el).attr("timeRange") === "true" ? true : false,\n      dateRange: SUI.Util.parseJSON($(el).attr("dateRange"), true),\n      inputFree: $(el).attr("inputFree") === "true",\n      initEmpty: $(el).attr("initEmpty") || \'true\',\n      setDateRange: $(el).attr(\'setDateRange\') || \'无\',\n      customCode: $(el).attr(\'customCode\') || \'\'\n    };\n    return _data;\n  }\n\n  function _timeRange(date1, date2, end) {\n    var out = {\n      date: date1.clone(),\n      change: false\n    };\n\n    if (date1.year() != date2.year()) {\n      out.date = date1.clone().year(date2.year());\n    }\n\n    if (date1.dayOfYear() != date2.dayOfYear()) {\n      out.date = date1.clone().dayOfYear(date2.dayOfYear());\n    }\n\n    if (end && out.date.valueOf() < date2.valueOf()) {\n      out.date = date2.clone();\n    }\n\n    if (!end && out.date.valueOf() > date2.valueOf()) {\n      out.date = date2.clone();\n    }\n\n    if (out.date.valueOf() != date1.valueOf()) out.change = true;\n    return out;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRange/DateRange.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRangePicker/DateRangePicker.js":
/*!***************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRangePicker/DateRangePicker.js ***!
  \***************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DateRangePicker; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:34 PM\n */\n\n/***\n *** DateRangepicker 日期范围组件\n ***/\nfunction DateRangePicker(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value,\n      sep = \" - \";\n  dom.zoo = this;\n  var $input, $tpl, datePicker;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    var parseData = config;\n\n    var require = parseData.validate && parseData.validate.require ? '<span class=\"text-red\">*</span>' : '';\n\n    var title = parseData.properties.title || \"\";\n    var name = parseData.properties.name || \"\";\n    var name2 = parseData.properties.name2 || '';\n\n    if (name2.length) {\n      this.name2 = name2;\n    }\n\n    var vals = config.value.split(sep);\n    var startDate = SUI.Util.validDateStr(vals[0], parseData.format),\n        endDate = SUI.Util.validDateStr(vals[1], parseData.format),\n        rangeVal = \"\";\n    if (startDate.validate && endDate.validate) rangeVal = startDate.validate + sep + endDate.validate;\n    var suffix = '<div class=\"input-group-addon\">' + '<i class=\"fa fa-calendar\"></i>' + '</div>';\n    var isMobile = SUI.Util.browserType() === 'phone';\n\n    if (isMobile && wf2.isNewInPhone) {\n      suffix = '<span class=\"org-arrow\"></span>';\n    }\n\n    var hasSuffix = \" input-group date-picker\";\n    var template = '<div class=\"' + hasSuffix + ' ' + (isMobile && wf2.isNewInPhone ? \"date-range-picker-phone\" : \"\") + '\">' + '<input name=\"' + name + '-' + name2 + '\" ' + (isMobile && wf2.isNewInPhone ? \"placeholder='请选择'\" : \"\") + ' type=\"text\" class=\"form-control\" value=\"' + rangeVal + '\" />' + suffix + '</div>';\n    var $html = $(template);\n    $(dom).html($html);\n    $input = $(\"input\", dom);\n    var mode = config.mode || 'view';\n\n    if (mode == \"readOnly\" || mode == \"view\") {\n      $html.hide();\n      $tpl = $('<div class=\"value-text\" />');\n      $tpl.html('<span class=\"value\" id=\"value_' + name + '\">' + rangeVal + '</span>');\n      $input.attr(\"readOnly\", \"readOnly\");\n      $(dom).addClass('form-readOnly').append($tpl);\n    }\n\n    if (mode == \"editable\") {\n      $input.removeAttr(\"readOnly\");\n      $(dom).removeClass('form-readOnly');\n      var nowDate = new Date(+new Date() + 8 * 3600 * 1000).toISOString().replace(/T/g, ' ').replace(/\\.[\\d]{3}Z/, '');\n      nowDate = SUI.Util.validDateStr(nowDate, parseData.format);\n\n      if (parseData.setDateRange == 'before') {\n        parseData.dateRange = {\n          maxDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == 'after') {\n        parseData.dateRange = {\n          minDate: nowDate.validate\n        };\n      } else if (parseData.setDateRange == 'custom') {\n        var customCode = $(dom).attr('customCode') || '';\n        customCode = customCode.replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\n').replace(/&semicolon;/g, '\\;');\n\n        try {\n          var dateRangeData = eval('(function(){' + customCode + '})()');\n          parseData.dateRange = dateRangeData || {};\n        } catch (error) {\n          console.log('日期范围自定义代码错误');\n        }\n      }\n\n      var opt = $.extend(true, {}, {\n        startDate: startDate.date,\n        endDate: endDate.date,\n        singleDatePicker: false,\n        timePicker: /HH/.test(parseData.format),\n        timePickerSeconds: /ss/.test(parseData.format),\n        timePickerIncrement: parseData.minStep,\n        locale: {\n          format: parseData.format,\n          cancelLabel: '清空'\n        },\n        dateName: name\n      }, parseData.dateRange || {});\n      $(\".date-picker\", dom).daterangepicker(opt);\n      datePicker = $(\".date-picker\", dom).data('daterangepicker');\n\n      if (!config.inputFree) {\n        $(\"input\", dom).attr(\"readonly\", \"readonly\");\n      }\n\n      $(\".date-picker\", dom).on('cancel.daterangepicker', function () {\n        $(dom).sui().setValue('');\n      });\n      $(\".date-picker\", dom).on('beforeshow.daterangepicker', function (e, date) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1) {\n          var dateDom = $(date.container[0]).find('.calendar-table');\n          $(date.container[0]).find('.daterangepicker_input input').hide();\n          $(date.container[0]).find('.daterangepicker_input .glyphicon-calendar').hide();\n\n          if (dateDom.length) {\n            $.each(dateDom, function (i, dom) {\n              $(dom).remove();\n            });\n          }\n\n          if (isMobile) {\n            $(date.container[0]).find('.calendar.right').show();\n          }\n        }\n\n        var val = $input.val();\n\n        if (!val) {\n          date.endDate = date.startDate ? date.startDate : date.endDate;\n\n          if (date.oldEndDate) {\n            date.oldEndDate = date.startDate ? date.startDate : date.oldEndDate;\n          }\n\n          if (date.oldStartDate) {\n            date.oldStartDate = date.startDate ? date.startDate : date.oldStartDate;\n          }\n        }\n      });\n      $(\".date-picker\", dom).on('show.daterangepicker', function (e, date) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1) {\n          if (isMobile) {\n            $(date.container[0]).find('.calendar.right').find('.calendar-time .calendar-time-selectors .show-end').remove();\n            $(date.container[0]).find('.calendar.left').find('.calendar-time .calendar-time-selectors .show-start').remove();\n            $(date.container[0]).find('.calendar.right').find('.calendar-time .calendar-time-selectors').prepend('<span class=\"show-end\">结束：</span>');\n            $(date.container[0]).find('.calendar.left').find('.calendar-time .calendar-time-selectors').prepend('<span class=\"show-start\">开始：</span>');\n          }\n        }\n      });\n      $(\".date-picker\", dom).on('valueChange.daterangepicker', function (e, date) {\n        if (/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1) {\n          if (isMobile) {\n            $(date.container[0]).find('.calendar.right').find('.calendar-time .calendar-time-selectors .show-end').remove();\n            $(date.container[0]).find('.calendar.left').find('.calendar-time .calendar-time-selectors .show-start').remove();\n            $(date.container[0]).find('.calendar.right').find('.calendar-time .calendar-time-selectors').prepend('<span class=\"show-end\">结束：</span>');\n            $(date.container[0]).find('.calendar.left').find('.calendar-time .calendar-time-selectors').prepend('<span class=\"show-start\">开始：</span>');\n          }\n        }\n      });\n    }\n\n    if (mode == \"hide\") {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    var val = $input.val();\n\n    if (config.properties.name2.length) {\n      var vals = val.split(sep);\n      var out = {};\n      out[config.properties.name] = vals[0] ? $.trim(vals[0]) : '';\n      out[config.properties.name2] = vals[1] ? $.trim(vals[1]) : '';\n      return SUI.Util.toJsonString(out);\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n    value = val || [\"\", \"\"];\n\n    if (value.indexOf(\"[\") == -1 && !$.isArray(value)) {\n      var a = [];\n      a.push(value);\n      value = a;\n    } else {\n      if (typeof value == \"string\") {\n        value = SUI.Util.parseJSON(val, true);\n      }\n    }\n\n    if (this.name2 && value[this.name2]) {\n      value = [value[this.name], value[this.name2]];\n    }\n\n    if (config.mode === \"editable\") {\n      var startDate = SUI.Util.validDateStr(value[0], config.format),\n          endDate = SUI.Util.validDateStr(value[1], config.format);\n      datePicker.startDate = startDate.date.isValid() ? startDate.date : datePicker.startDate;\n      datePicker.endDate = endDate.date.isValid() ? endDate.date : datePicker.endDate;\n    }\n\n    if (value.join(sep) == ',' || value.join(sep) == \" - \") {\n      value = '';\n    } else {\n      value = value.join(sep);\n    }\n\n    if (isValidate) {\n      $input.val(value);\n    } else {\n      $input.val(value).trigger('change');\n    }\n\n    $tpl && $(\".value\", $tpl).html(value);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\"),\n        name2: $(el).attr('name2') || ''\n      },\n      value: $(el).attr(\"value\") || \"\",\n      suffix: $(el).attr(\"suffix\") || \"\",\n      format: $(el).attr(\"format\") || \"YYYY-MM-DD\",\n      minStep: Number($(el).attr(\"minStep\") || \"1\"),\n      dateRange: SUI.Util.parseJSON($(el).attr(\"dateRange\"), true),\n      inputFree: $(el).attr(\"inputFree\") === \"true\",\n      setDateRange: $(el).attr('setDateRange') || '无',\n      customCode: $(el).attr('customCode') || ''\n    };\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRangePicker/DateRangePicker.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Editor/Editor.js":
/*!*********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Editor/Editor.js ***!
  \*********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Editor; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 4:08 PM\n */\n\n/**\n **    Editor编辑器\n ***/\nfunction Editor(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value;\n  dom.zoo = this;\n  var $textarea, editor;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    config.value = this.getValue();\n    return config;\n  };\n\n  this.getEditor = function () {\n    return editor;\n  };\n\n  this.setConfig = function (val) {\n    var that = this;\n    config = val;\n\n    if (!window.wangEditor) {\n      return $(dom).html(\'<p class="text-danger"><i class="glyphicon glyphicon-info-sign"></i> 检查【wangEditor插件】</p>\');\n    }\n\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n\n    var require = config.validate && config.validate.require ? \'<span class="text-red">*</span>\' : \'\';\n\n    var title = config.properties.title || "";\n    var name = config.properties.name || "";\n    var placeholder = config.placeholder;\n    var _value = config.value;\n    $textarea = $(\'<textarea name="\' + name + \'" />\').html(\'<p>\' + config.placeholder + \'</p>\').hide();\n    $(dom).html($textarea);\n\n    if (config.editorHeight) {\n      $textarea.height(config.editorHeight);\n    } else {\n      $textarea.attr(\'rows\', config.rows);\n    }\n\n    editor = new wangEditor($textarea[0]);\n    editor.config = $.extend(true, {}, editor.config, {\n      mapAk: config.mapAk || \'YN79qK7VCGEOBTNzFEX0v5ej\',\n      printLog: false,\n      menuFixed: false,\n      zindex: Number(new Date()) * 10,\n      uploadImgUrl: config.uploadImgUrl || SUI.settings().wangEditor().uploadImgUrl,\n      uploadImgFileName: \'Filedata\'\n    });\n    editor.config.menus = _editorMenus(config.editorTools);\n    editor.config.emotions = $.extend(true, {\n      "default": {\n        title: "默认",\n        data: __basePath + \'_libs/plugins/wangEditor/js/emotions.default.data\'\n      }\n    }, editor.config.emotions);\n\n    editor.config.uploadImgFns.onload = function (resultText, xhr) {\n      var originalName = editor.uploadImgOriginalName || \'\';\n      var result = $.parseJSON(resultText);\n      var fileName = result.fileName.split(".")[0];\n      editor.command(null, \'insertHtml\', \'<img src="\' + result.compressUrl + \'" alt="\' + fileName + \'" style="max-width:100%;"/>\');\n    };\n\n    editor.create();\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      $textarea.attr(\'readonly\', \'readonly\');\n      $(dom).addClass(\'form-readOnly\');\n      editor.disable();\n    }\n\n    if (mode == "editable") {\n      $textarea.removeAttr(\'readonly\');\n      $(dom).removeClass(\'form-readOnly\');\n      editor.enable();\n\n      editor.onchange = function () {\n        value = that.getValue();\n        var trueValue = that.getValue(true);\n\n        if (config.maxlength && trueValue.length > config.maxlength) {\n          value = trueValue.substring(0, config.maxlength);\n          that.setValue(value);\n        }\n\n        $(dom).trigger(\'change\');\n      };\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    _value && this.setValue(_value);\n  };\n\n  this.getValue = function (text) {\n    var action = text ? "text" : "html";\n    var val = editor.$txt[action]();\n\n    if (/^(<p>(<br>|&nbsp;|\\s)+<\\/p>)+$/ig.test(val)) {\n      val = \'\';\n    } else if (/^(<p><\\/p><p>(<br>|&nbsp;|\\s)+<\\/p>)+$/ig.test(val)) {\n      val = \'\';\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val) {\n    value = val;\n    editor.$txt.html(val);\n  };\n\n  this.validate = function (isTrigger) {\n    if (isTrigger) {\n      return;\n    }\n\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var val = this.getValue(validate.forText);\n    var result = SUI.Util.validate.call(dom, validate, val);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr("mode"),\n      validate: SUI.Util.parseJSON($(el).attr("validate"), true),\n      properties: {\n        title: $(el).attr("title"),\n        name: $(el).attr("name")\n      },\n      value: $(el).attr("value") || "",\n      maxlength: Number($(el).attr("maxlength") || "0"),\n      rows: Number($(el).attr("rows") || "3"),\n      placeholder: $(el).attr("placeholder") || "",\n      mapAk: $(el).attr("mapAk") || "",\n      editorTools: $(el).attr("editorTools") || "default",\n      editorHeight: $(el).attr("editorHeight") || "",\n      canFullScreen: $(el).attr("canFullScreen") == "false" ? false : true,\n      viewSource: $(el).attr("viewSource") == "false" ? false : true,\n      resizeable: $(el).attr("resizeable") == "true",\n      uploadImgUrl: $(el).attr("uploadImgUrl")\n    };\n\n    if (_data.maxlength && _data.validate) {\n      _data.validate.max = _data.validate.max || _data.maxlength;\n    }\n\n    return _data;\n  }\n\n  function _editorMenus(type) {\n    var menus = SUI.settings().wangEditor().menus;\n\n    if (!type || type == "default") {\n      // menus = menus.slice(0, 10);\n      menus = menus.slice(0);\n    }\n\n    if (type == "extend") {\n      // menus = menus.slice(0, 20);\n      menus = menus.slice(0);\n    }\n\n    if (type == "advanced") {\n      menus = menus.slice(0);\n    }\n\n    if (config.viewSource) {\n      menus.push(\'source\', \'|\');\n    }\n\n    if (config.canFullScreen) {\n      menus.push(\'fullscreen\', \'|\');\n    }\n\n    return menus;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Editor/Editor.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Error/Error.js":
/*!*******************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Error/Error.js ***!
  \*******************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Error; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:23 AM\n */\n\n/**\n * 文本-错误\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Error(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Error/Error.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FieldTitle/FieldTitle.js":
/*!*****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FieldTitle/FieldTitle.js ***!
  \*****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FieldTitle; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:18 AM\n */\n\n/**\n * 字段标题\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction FieldTitle(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    content = config.prefix + content + config.suffix; // 移动端去除字段标题冒号\n\n    if (SUI.Util.browserType() === 'phone' && content && (content.substring(content.length - 1, content.length) == '：' || content.substring(content.length - 1, content.length) == ':')) {\n      content = content.substring(0, content.length - 1);\n    }\n\n    $(dom).find('span').text(content);\n\n    if (SUI.Util.browserType() === 'phone') {\n      if (!$(dom).parent().find('.only-mark').length) {\n        $(dom).find('span').css('padding-left', '13px');\n      }\n    }\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FieldTitle/FieldTitle.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Fileupload/FileUpload.js":
/*!*****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Fileupload/FileUpload.js ***!
  \*****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FileUploadOld; });\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:54 PM\n */\n\n/**\n ** FileUploadOld 旧版上传控件\n */\nfunction FileUploadOld(bind) {\n  var value, config;\n  var dom = bind || $(\'<div></div>\').get(0);\n  dom.zoo = this;\n  var items, controlId, photos, btnId, uploadDo, editExt, tempFileId;\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    uploadDo = {\n      canEdit: config.properties.canEdit,\n      canUpload: config.properties.canUpload,\n      canDelete: config.properties.canDelete,\n      canCreate: config.properties.canCreate\n    };\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      uploadDo.canEdit = false;\n      uploadDo.canUpload = false;\n      uploadDo.canDelete = false;\n    }\n\n    if (mode == "editable") {\n      uploadDo.canUpload = true;\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    render();\n    this.setValue(config.value);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.getValue = function (js) {\n    if (!value || !value.length) {\n      return \'\';\n    }\n\n    if (config.properties.multi == "true") {\n      return js ? value : value.length ? SUI.Util.toJsonString(value) : "";\n    } else {\n      return value[0];\n    }\n  };\n\n  function lazyLoading() {\n    var tasks = [];\n\n    this.run = function (id, task) {\n      tasks.push(task);\n      setTimeout(function () {\n        var temp = tasks;\n        tasks = [];\n\n        if (temp.length < 1) {\n          return;\n        }\n\n        var ids = [];\n        $.each(temp, function (i, t) {\n          ids.push(t.id);\n        });\n        $.ajax({\n          type: "POST",\n          url: SUI.settings().uploadify().getFile,\n          data: SUI.Util.toJsonString({\n            entity: {\n              __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n              id: key,\n              ids: ids\n            }\n          }),\n          contentType: "text/json",\n          success: function success(data) {\n            $.each(temp, function (i, task) {\n              task.exe(data);\n            });\n          }\n        });\n      }, 200);\n    };\n  }\n\n  function loadOneFile(fileId) {\n    var itemContent = \'<div data-key="\' + fileId + \'"></div>\';\n    items.append(itemContent);\n    $.ajax({\n      type: "POST",\n      url: SUI.settings().uploadify().getFile,\n      data: SUI.Util.toJsonString({\n        entity: {\n          __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n          id: fileId\n        }\n      }),\n      contentType: "text/json",\n      success: function success(data) {\n        var extend2 = data.value.extend2;\n\n        if (data.value.fileType == ".jpg" || data.value.fileType == ".jpeg" || data.value.fileType == ".gif" || data.value.fileType == ".bmp" || data.value.fileType == ".pdf") {\n          extend2 = data.value.id;\n        }\n\n        var item = createFileItem(fileId, data.value.fileName, data.value.fileLength, true, null, extend2, false, data.value.hascompress);\n        var itemContent = items.find(\'[data-key="\' + fileId + \'"]\');\n\n        if (itemContent.length > 0) {\n          itemContent.html(item);\n        }\n\n        onchange();\n      },\n      error: function error() {\n        items.empty();\n      }\n    });\n  }\n\n  this.setValue = function (val) {\n    var mode = config.mode || "view";\n    items.empty();\n    photos.data = [];\n    config.value = val;\n\n    if (val) {\n      var fileKeys;\n\n      if (config.properties.multi == "true") {\n        fileKeys = SUI.Util.parseJSON(val, true);\n      } else {\n        fileKeys = [val];\n\n        try {\n          fileKeys = SUI.Util.parseJSON(val, true);\n        } catch (err) {\n          fileKeys = [val];\n        }\n      }\n\n      value = fileKeys;\n\n      for (var i in value) {\n        loadOneFile(value[i]);\n      }\n    } else {\n      value = val;\n      items.html(mode == "editable" ? config.placeholder : config.emptyText);\n    }\n  };\n\n  this.getExt = function () {\n    var cur = this.getValue(true);\n    var ary = [];\n    var changeName = config.properties.changeName;\n\n    if (!changeName) {\n      changeName = "";\n    }\n\n    var oldValue = wf2.entity && wf2.entity[name];\n    var isdraft = SUI.Util.getQueryString(\'draftId\');\n\n    if (oldValue == cur && !isdraft) {\n      return false;\n    } //多选\n\n\n    if (config.properties.multi == "true") {\n      var srcAry = JSON.parse(config.value || "[]").concat([]);\n      var curAry = (cur || []).concat([]);\n\n      var contains = function contains(item, collect) {\n        var contains = false;\n        $.each(collect, function (i, d) {\n          if (d == item) {\n            contains = true;\n          }\n        });\n        return contains;\n      }; //双向比较\n\n\n      $.each(srcAry, function (i, item) {\n        if (!contains(item, curAry)) {\n          ary[ary.length] = {\n            value: item,\n            op: "delete"\n          };\n        }\n      });\n      $.each(curAry, function (i, item) {\n        if (!contains(item, srcAry)) {\n          ary[ary.length] = {\n            value: item,\n            op: "insert"\n          };\n        }\n      });\n\n      if (!ary.length) {\n        if (cur.length) {\n          $.each(cur, function (i, item) {\n            ary[ary.length] = {\n              value: item,\n              op: "insert"\n            };\n          });\n        }\n      }\n\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName\n      };\n    } else {\n      if (cur) {\n        ary[ary.length] = {\n          value: cur,\n          op: "insert"\n        };\n      } else {\n        if (config.value) {\n          ary[ary.length] = {\n            value: config.value,\n            op: "delete"\n          };\n        }\n      }\n\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName\n      };\n    }\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue(true);\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr("mode");\n    temp.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      canEdit: element.attr("canEdit") == "true" ? true : false,\n      //默认不可编辑\n      canUpload: element.attr("canUpload") !== "false",\n      canDelete: element.attr("canDelete") !== "false",\n      canCreate: element.attr("canCreate") == "true",\n      multi: element.attr("multi"),\n      max: (element.attr("max") || 5) - 0,\n      ext: element.attr("ext"),\n      // \'*.gif; *.jpg; *.png\' 使用分号分割\n      preview: element.attr("preview") == "false" ? false : true,\n      //默认可以预览\n      previewWidth: Number(element.attr("previewWidth") || "0"),\n      previewShadeClose: element.attr("previewShadeClose") == "true",\n      previewStyle: element.attr("previewStyle") || "",\n      buttonText: element.attr("buttonText") || "上传",\n      buttonWidth: Number(element.attr("buttonWidth") || "60"),\n      fileSizeLimit: Number(element.attr("fileSizeLimit") || "0"),\n      changeName: element.attr("changeName"),\n      existFileAlert: element.attr(\'existFileAlert\') == "false" ? false : true,\n      coverExistFile: element.attr(\'coverExistFile\') == "true",\n      uploadurl: element.attr(\'uploadurl\') == "false" ? "false" : "true",\n      uploadAddress: element.attr(\'uploadAddress\'),\n      accept: element.attr(\'accept\') || \'image/*\'\n    };\n    temp.placeholder = element.attr("placeholder") || "";\n    temp.emptyText = element.attr("emptyText") || "";\n    temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    temp.value = element.attr("value") || "";\n    return temp;\n  };\n\n  this.getTempFileId = function () {\n    return tempFileId;\n  };\n\n  this.getResultData = function () {\n    return resultData;\n  };\n\n  function render() {\n    var require = config.validate && config.validate.require ? "*" : "";\n\n    var html = \'\';\n    html += \'<div class="file-items"></div>\' + \'<div class="wf-fileQueue"></div>\' + \'<input class="wf-fileControl" type="file"\' + (config.properties && config.properties.accept ? checkFormat(config.properties.ext) ? \' accept="\' + config.properties.accept + \'"\' : \'\' : \'\') + \' multiple="false" style="display:none"/>\';\n    $(dom).html(html);\n    var div = $(dom);\n    var params = config.properties;\n    var control = div.find(".wf-fileControl");\n    var id = "_upload" + SUI.Util.getSequence("fileUpload");\n    btnId = "btn" + id;\n    controlId = id;\n    control.attr("id", id);\n    var queue = div.find(".wf-fileQueue");\n    var queueID = "queue" + id;\n    queue.attr("id", queueID);\n    var resultData;\n    items = div.find(".file-items");\n    photos = {\n      title: params.title,\n      id: Number(new Date()),\n      start: 0,\n      data: []\n    };\n    var cloneCtrl = null;\n\n    var resetControl = function resetControl(formData) {\n      if (formData) {\n        control[0].value = "";\n      } else {\n        var control2 = cloneCtrl.clone(true, false);\n        control.replaceWith(control2);\n        control = control2;\n      }\n\n      control.removeClass(\'uploading\');\n    };\n\n    if (uploadDo.canUpload) {\n      var isMobile = SUI.Util.browserType() == "phone";\n      var mobileBtn = \'\';\n\n      if (isMobile && wf2.isNewInPhone) {\n        mobileBtn = $(\'<div class="upload-add" id="\' + btnId + \'"></div>\');\n      } else {\n        mobileBtn = $(\'<div class="btn btn-sm btn-primary btn-uploadify-mobile" id="\' + btnId + \'" />\').css({\n          "position": "relative",\n          "overflow": "hidden"\n        });\n      }\n\n      control.on(\'click\', function (event) {\n        if (control.hasClass(\'uploading\')) {\n          event.preventDefault();\n          layer.alert(\'请稍后，正在上传文件...\');\n          return false;\n        }\n      });\n      var ajaxUp = window.FormData;\n\n      if (ajaxUp) {\n        control.show();\n\n        if (isMobile && wf2.isNewInPhone) {\n          control.addClass("upload-file-btn").css({\n            position: \'absolute\',\n            width: 45,\n            height: 45,\n            opacity: 0,\n            "z-index": 99\n          }).wrap(mobileBtn);\n          control.after(\'<span class="upload-add-icon"></span>\');\n        } else {\n          control.addClass("upload-file-btn").css({\n            position: \'absolute\',\n            width: 1000,\n            height: 32,\n            fontSize: \'100px\',\n            top: -2,\n            bottom: 0,\n            right: -2,\n            opacity: 0\n          }).wrap(mobileBtn);\n          control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n        }\n\n        var loadingView = $(\'<div class="upload-loading" />\');\n        div.append(loadingView);\n\n        var uploadAction = function uploadAction(fileName, existFile) {\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          } // if ( !checkMaxFileSize(control) ) {\n          //     layer.alert("上传失败，上传文件不得超过20M", {\n          //         title: \'提示\',\n          //         closeBtn: 0\n          //     });\n          //     return resetControl(true);\n          // }\n          //\n          // if ( !checkMaxFileSize(control) ) {\n          //     layer.alert("上传失败，上传文件不得超过20M", {\n          //         title: \'提示\',\n          //         closeBtn: 0\n          //     });\n          //     return resetControl(true);\n          // }\n\n\n          if (!checkFileSize(control, params.fileSizeLimit)) {\n            layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          }\n\n          if (control.hasClass(\'uploading\')) {\n            return layer.alert(\'请稍后，正在上传文件...\');\n          }\n\n          control.addClass(\'uploading\');\n          var formData = new FormData();\n          var settings = SUI.settings().uploadify({}); //formData.append("a", "");\n          //formData.append("","");\n\n          formData.append("Filedata", control.get(0).files[0]);\n          loadingView.html("正在上传……");\n          var uploadaddress = settings.uploader;\n\n          if (config.properties.uploadurl == \'false\') {\n            uploadaddress = __basePath + config.properties.uploadAddress;\n          }\n\n          $.ajax({\n            url: uploadaddress,\n            type: \'POST\',\n            data: formData,\n            xhr: function xhr() {\n              //获取ajaxSettings中的xhr对象，为它的upload属性绑定progress事件的处理函数\n              var myXhr = $.ajaxSettings.xhr();\n\n              if (myXhr.upload) {\n                //检查upload属性是否存在\n                //绑定progress事件的回调函数\n                myXhr.upload.addEventListener(\'progress\', function (e) {\n                  if (e.lengthComputable) {\n                    var percent = e.loaded / e.total * 100;\n                    percent = percent + "";\n                    percent = percent.substring(0, 4);\n                    loadingView.html("正在上传…… " + percent + "%");\n                  }\n                }, false);\n              }\n\n              return myXhr; //xhr对象返回给jQuery使用\n            },\n            processData: false,\n            //必须false才会避开jQuery对 formdata 的默认处理\n            contentType: false,\n            // 必须false才会自动加上正确的Content-Type\n            success: function success(data) {\n              if (config.properties.uploadurl == \'false\') {\n                control.removeClass(\'uploading\');\n                control.parent().next().hide();\n                data = $.parseJSON(data);\n                $(dom).trigger("uploadExcelSuccess", [data]);\n              } else {\n                $(dom).attr("absolutPath", JSON.parse(data).absolutPath);\n                loadingView.empty();\n                resultData = $.parseJSON(data);\n\n                if (resultData.error) {\n                  var errorInfo = resultData.error;\n\n                  if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                    if (errorInfo.lastIndexOf("maximum") > 0) {\n                      var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                      maximum = maximum / 1024 / 1024;\n                      errorInfo = "上传文件不得超过" + maximum + "M";\n                    } else {\n                      errorInfo = "文件大小超过系统限制";\n                    }\n                  }\n\n                  layer.alert("上传失败，" + errorInfo, {\n                    title: \'提示\',\n                    closeBtn: 0\n                  });\n                } else {\n                  if (resultData.hascompress && resultData.hascompress == \'1\') {\n                    // var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile,null,true,resultData.hascompress,resultData.compressUrl,resultData.url);\n                    var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile, null, true, resultData.hascompress, resultData.url, resultData.url);\n                  } else {\n                    var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile, null);\n                  }\n\n                  items.append(item);\n                  onchange();\n                  $(dom).trigger("onUploadSuccess", [resultData]);\n                }\n              }\n            },\n            error: function error(responseStr) {\n              loadingView.empty();\n              var errorInfo = responseStr;\n\n              if (_typeof(errorInfo) == "object") {\n                errorInfo = "请检查网络设置";\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                title: \'提示\',\n                closeBtn: 0\n              });\n            },\n            complete: function complete() {\n              // reset input, 再次上传相同无法触发change事件，导致无法上传已上传过的文件\n              return resetControl(true);\n            }\n          });\n        };\n\n        control.on("change", function () {\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl(true);\n          }\n\n          var existFile = checkFileExists(fileName);\n\n          if (existFile) {\n            if (params.coverExistFile) {\n              layer.confirm(\'存在同名文件，是否覆盖原文件？\', {\n                icon: 0,\n                title: \'提示\'\n              }, function (index) {\n                layer.close(index);\n                uploadAction(fileName, existFile);\n              }, function () {\n                return resetControl(true);\n              });\n            } else {\n              layer.alert(\'文件已存在\');\n              return resetControl(true);\n            }\n          } else {\n            uploadAction(fileName);\n          }\n        });\n      } else if (true) {\n        control.show();\n        control.addClass("upload-file-btn").css({\n          position: \'absolute\',\n          width: 1000,\n          height: 32,\n          fontSize: \'100px\',\n          top: -2,\n          bottom: 0,\n          right: -2,\n          opacity: 0\n        }).wrap(mobileBtn);\n        var settings = SUI.settings().uploadify({});\n        var winName = "winName_fileUpload" + SUI.Util.getSequence("fileUpload"),\n            formId = \'form_\' + winName; //control.wrap(form);\n\n        control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n        var loadingView = $(\'<div class="upload-loading" /><div style="display:none;"><iframe name="\' + winName + \'" src="about:blank"></iframe></div>\');\n        div.append(loadingView);\n        loadingView = loadingView.first();\n        var form = $(\'<form id="\' + formId + \'" action="#" method="post" enctype ="multipart/form-data" target="\' + winName + \'"></form>\');\n        form.on("submit", function (e) {\n          e.stopPropagation();\n        });\n        var existFile;\n\n        var uploadAction = function uploadAction(fileName) {\n          if (control.hasClass(\'uploading\')) {\n            return layer.alert(\'请稍后，正在上传文件...\');\n          }\n\n          control.addClass(\'uploading\');\n          form.submit();\n          loadingView.html("正在上传……");\n          resetControl(); // 修复ie9及以下 上传相同文件无法触发 change事件的bug\n        };\n\n        form.prop(\'uploadResult\', {\n          call: function call(data) {\n            loadingView.empty();\n            resultData = data;\n\n            if (resultData.error) {\n              var errorInfo = resultData.error;\n\n              if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                if (errorInfo.lastIndexOf("maximum") > 0) {\n                  var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                  maximum = maximum / 1024 / 1024;\n                  errorInfo = "上传文件不得超过" + maximum + "M";\n                } else {\n                  errorInfo = "文件大小超过系统限制";\n                }\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                title: \'提示\',\n                closeBtn: 0\n              });\n            } else {\n              if (!checkFileSize(resultData.fileSize, params.fileSizeLimit, true)) {\n                return layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n                  title: \'提示\',\n                  closeBtn: 0\n                });\n              }\n\n              var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile);\n              items.append(item);\n              onchange();\n              $(dom).trigger("onUploadSuccess", [resultData]);\n            }\n          }\n        });\n        control.after(form);\n        form.append(control);\n        control.on("change", function () {\n          control.attr("name", "Filedata"); //判断是否被修改域，导致iframe跨域\n\n          var domain = window.location.host;\n\n          if (domain.indexOf(":") > -1) {\n            domain = domain.substring(0, domain.indexOf(":"));\n          }\n\n          if (domain != document.domain) {\n            domain = "document.domain=\'" + document.domain + "\';";\n          } else {\n            domain = "";\n          }\n\n          var formScript = domain + " parent.document.getElementById(\'" + formId + "\').uploadResult.call";\n          formScript = stringToHex(formScript);\n          var uploadaddress = settings.uploader;\n\n          if (config.properties.uploadurl == \'false\') {\n            uploadaddress = __basePath + config.properties.uploadAddress;\n          }\n\n          var url = uploadaddress + "?formScript=" + formScript;\n          form.attr("action", url);\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl();\n          }\n\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl();\n          }\n\n          var existFile = checkFileExists(fileName);\n\n          if (existFile) {\n            if (params.coverExistFile) {\n              layer.confirm(\'存在同名文件，是否覆盖原文件？\', {\n                title: \'提示\'\n              }, function (index) {\n                layer.close(index);\n                uploadAction(fileName);\n              }, function () {\n                return resetControl(true);\n              });\n            } else {\n              layer.alert(\'文件已存在\');\n              return resetControl(true);\n            }\n          } else {\n            uploadAction(fileName);\n          }\n        });\n        cloneCtrl = control.clone(true, false);\n      } else {}\n    }\n\n    function stringToHex(str) {\n      if (!str) {\n        return "";\n      }\n\n      var hex = str.charCodeAt(0).toString(16);\n\n      for (var i = 1; i < str.length; i++) {\n        var code = str.charCodeAt(i).toString(16);\n        hex += "," + code;\n      }\n\n      hex = hex.toUpperCase();\n      return hex;\n    }\n\n    function checkFileName(fileName) {\n      if (!config.properties.ext) {\n        return true;\n      }\n\n      var ext = fileName.substring(fileName.lastIndexOf("."));\n      var splits = config.properties.ext.split(";");\n\n      for (var i = 0; i < splits.length; i++) {\n        var filePattern = $.trim(splits[i]);\n        var ext2 = filePattern.substring(filePattern.lastIndexOf("."));\n\n        if (ext.toLowerCase() == ext2.toLowerCase()) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function checkFileExists(fileName) {\n      var check = false;\n      var $items = $(dom).find(\'.file-item\');\n\n      if (!fileName || !$items.length) {\n        return check;\n      }\n\n      $items.each(function (index, el) {\n        var filename = $(el).attr(\'data-filename\');\n        var regFileName = filename || \'\';\n\n        if (regFileName) {\n          regFileName = regFileName.replace(/\\(/g, \'\\\\(\');\n          regFileName = regFileName.replace(/\\)/g, \'\\\\)\');\n          regFileName = regFileName.replace(/\\[/g, \'\\\\[\');\n          regFileName = regFileName.replace(/\\]/g, \'\\\\]\');\n          regFileName = regFileName.replace(/\\{/g, \'\\\\{\');\n          regFileName = regFileName.replace(/\\}/g, \'\\\\{\');\n        }\n\n        var reg = new RegExp(regFileName, "gi");\n\n        if (reg.test(fileName)) {\n          check = el;\n          return false;\n        }\n      });\n      return check;\n    }\n\n    function checkFileSize(el, maxSize, isNum) {\n      if (!isNum) {\n        var file = $(el)[0];\n\n        if (maxSize > 0 && file.files[0].size > maxSize * 1024) {\n          return false;\n        }\n      } else {\n        var size = Number(el);\n\n        if (size && maxSize && size > maxSize * 1024) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    function checkMaxFileSize(el, maxSize) {\n      var file = $(el)[0];\n\n      if (file.files[0].size > 1024 * 1024 * 20) {\n        return false;\n      }\n\n      return true;\n    }\n\n    function checkMaxFileSize(el) {\n      var file = $(el)[0];\n\n      if (file.files[0].size > 1024 * 1024 * 20) {\n        return false;\n      }\n\n      return true;\n    }\n  }\n\n  function checkFormat(format) {\n    if (SUI.Util.browserType() === \'pc\') {\n      return false;\n    } else {\n      format = format || \'\';\n      var imageList = \'*.xbm;*.tif;*.pjp;*.pjpeg;*.jfif;*.ico;*.tiff;*.gif;*.svg;*.bmp;*.png;*.jpeg;*.svgz;*.jpg;*.webp\';\n      var list = format.split(\';\') || \'\';\n\n      if (list) {\n        if (list.length == 1) {\n          if (!list[0]) {\n            return false;\n          } else {\n            if (imageList.indexOf(list[0].toLowerCase()) > -1) {\n              return true;\n            } else {\n              return false;\n            }\n          }\n        } else {\n          var hasImage = true;\n          $.each(list, function (i, v) {\n            if (v) {\n              if (imageList.indexOf(v.toLowerCase()) == -1) {\n                hasImage = false;\n              }\n            }\n          });\n          return hasImage;\n        }\n      } else {\n        return false;\n      }\n    }\n  }\n\n  function onchange() {\n    if (!uploadDo.canUpload) {\n      return;\n    }\n\n    $(dom).trigger(\'change\');\n    var len = value.length;\n    var uploader = $("#" + controlId + \', #\' + btnId);\n    var editer = $("#" + controlId + \', #edit\' + btnId);\n\n    if (config.properties.multi == "true") {\n      if (len < config.properties.max) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    } else {\n      if (len == 0) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    }\n  }\n\n  function deleteFileItem(div, fileKey) {\n    var fileId = fileKey;\n\n    if (div.attr(\'previewid\')) {\n      var pindex = APP.inArrayObj(\'pid\', div.attr(\'previewid\'), photos.data);\n\n      if (pindex !== -1) {\n        var fileId = photos.data[pindex].fileKey;\n        photos.data.splice(pindex, 1);\n      }\n    }\n\n    var fileIndex = $.inArray(fileId, value);\n\n    if (fileIndex !== -1) {\n      value.splice(fileIndex, 1);\n      div.remove();\n      onchange();\n    }\n  } // compress是否压缩\n  // compressUrl预览地址\n  // url 原图地址\n\n\n  function createFileItem(fileKey, fileName, fileSize, init, existFile, extend2, isNowUpload, compress, compressUrl, url) {\n    isNowUpload = isNowUpload || false;\n\n    if (!value) {\n      value = [];\n    }\n\n    if (!init) {\n      if (existFile) {\n        var existFileKey = $(existFile).find(\'input\').val();\n\n        if (config.properties.coverExistFile) {\n          deleteFileItem($(existFile), existFileKey);\n        } else {\n          return layer.alert(\'该文件已存在\');\n        }\n      }\n\n      value.push(fileKey);\n    }\n\n    var filterFileName = fileName.match(/[^/\\\\\\\\]+$/);\n\n    if (filterFileName) {\n      fileName = filterFileName[0];\n    }\n\n    var isMobile = SUI.Util.browserType() === \'phone\';\n    var div = \'\';\n\n    if (isMobile && wf2.isNewInPhone) {\n      div = $(\'<div class="file-item">\' + \'<input class="wf-fileInput" type="hidden"/>\' + \'<div class="upload-show-file">\' + \'<div class="wf-fileView">\' + \'<div class="upload-show-text"><span class="upload-show-icon"></span></div>\' + \'<div class="upload-show-info">\' + \'<div class="upload-show-info-name"></div>\' + \'<div class="upload-show-info-size"></div>\' + \'</div>\' + \'</div>\' + \'<div class="upload-btnlist">\' + \'<span class="wf-delete">删除</span>\' + \'<span class="wf-editBtn">编辑</span>\' + \'<span class="wf-saveBtn">上传</span>\' + \'<span class="wf-lookPhoto">查看原图</span>\' + \'</div>\' + \'</div>\' + \'</div>\');\n    } else {\n      div = $(\'<div class="file-item"><input class="wf-fileInput" type="hidden" /><a class="wf-fileView"></a> \' + \'<span class="btn btn-sm btn-danger wf-delete" style="display:inline-block"><i class="fa fa-close"></i> 删除</span> \' + \'<span class="btn btn-sm btn-success wf-editBtn"  style="display:inline-block"><i class="fa fa-edit"></i> 编辑</span> \' + \'<span class="btn btn-sm btn-primary wf-saveBtn"  style="display:inline-block"><i class="fa fa-upload"></i> 上传</span>\' + \'<span class="btn btn-sm btn-primary wf-lookPhoto"  style="display:inline-block"><i class="fa fa-camera"></i> 查看原图</span>\' + \'</div>\');\n    }\n\n    var view = div.find(".wf-fileView");\n    fileSize = fileSize - 0;\n\n    if (fileSize < 1024) {\n      fileSize = fileSize + "Bit";\n    } else if (fileSize < 1024 * 1024) {\n      fileSize = (fileSize / 1024).toFixed(1) + "KB";\n    } else if (fileSize < 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024)).toFixed(1) + "MB";\n    } else if (fileSize < 1024 * 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024 * 1024)).toFixed(1) + "GB";\n    }\n\n    var input = div.find("input");\n    input.val(fileKey);\n    var isPic = false;\n\n    if (isMobile && wf2.isNewInPhone) {\n      if (config.properties.preview && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n        isPic = true;\n        var $imgView = view.find(\'.upload-show-text\'),\n            alt = fileName.split(".")[0];\n        $imgView.addClass(\'upload-show-pic\');\n        view.find(\'.upload-show-info\').addClass(\'upload-show-pic-info\');\n        var src = \'\';\n\n        if (isNowUpload) {\n          src = compressUrl;\n        } else {\n          src = SUI.settings().uploadify().downloadPath + input.val();\n        }\n\n        if (compress == \'1\' || compress == \'2\') {\n          src += \'?isCompress=true\';\n        } else {\n          src += \'?isCompress=false\';\n        }\n\n        $imgView.html(\'<img src="\' + src + \'" />\');\n        var pid = "img-" + Number(new Date());\n        div.attr("previewid", pid);\n        photos.data.push({\n          "alt": alt,\n          \'fileKey\': fileKey,\n          "pid": pid,\n          //图片id\n          "src": src,\n          //原图地址\n          "thumb": src //缩略图地址\n\n        });\n        $imgView.find(\'img\').on(\'click\', function (event) {\n          event.preventDefault();\n          photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n          if (window.layer) {\n            layer.photos({\n              photos: photos,\n              shift: 5,\n              full: 1,\n              fullscreen: 1,\n              fulltools: 1,\n              shadeClose: config.properties.previewShadeClose\n            });\n          } else {\n            alert(\'图片预览需要加载layer\');\n          }\n        });\n      } else {\n        view.find(\'.upload-show-text\').addClass(\'upload-show-wenben\');\n        view.find(\'.upload-show-info\').addClass(\'upload-show-wenben-info\');\n\n        if (fileName.indexOf(\'.doc\') > -1 || fileName.indexOf(\'.docx\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-word\');\n        } else if (fileName.indexOf(\'.xls\') > -1 || fileName.indexOf(\'.xlsx\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-excel\');\n        } else if (fileName.indexOf(\'.pdf\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-pdf\');\n        } else if (fileName.indexOf(\'.zip\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-zip\');\n        } else {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-default\');\n        }\n      }\n\n      view.find(\'.upload-show-info-name\').text(fileName.replace(\'_temp:\', \'\'));\n      view.find(\'.upload-show-info-size\').text(fileSize);\n    } else {\n      view.html(fileName.replace(\'_temp:\', \'\') + \' (\' + fileSize + \')\');\n\n      if (config.properties.preview && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n        var $imgView = $(\'<div class="file-imageview" />\'),\n            alt = fileName.split(".")[0];\n        var src = \'\';\n\n        if (isNowUpload) {\n          src = compressUrl;\n        } else {\n          src = SUI.settings().uploadify().downloadPath + input.val();\n        }\n\n        if (compress == \'1\' || compress == \'2\') {\n          src += \'?isCompress=true\';\n        } else {\n          src += \'?isCompress=false\';\n        }\n\n        $imgView.html(\'<div class="imageview-box"><img style="\' + config.properties.previewStyle + \'" title="点击预览" src="\' + src + \'" alt="\' + alt + \'" /></div>\');\n        if (config.properties.previewWidth) $("img", $imgView).css("width", config.properties.previewWidth);\n        var showImage = new Image();\n        showImage.src = src;\n\n        showImage.onload = function () {\n          var imageWidth = showImage.width;\n          var imageHeight = showImage.height;\n\n          if (imageHeight > 150) {\n            var showHeight = 150;\n            var scale = imageWidth / imageHeight;\n            var showWidth = showHeight * scale;\n            $("img", $imgView).css(\'width\', showWidth + \'px\');\n            $("img", $imgView).css(\'height\', showHeight + \'px\');\n          }\n        };\n\n        $imgView.prependTo(div);\n        var pid = "img-" + Number(new Date());\n        div.attr("previewid", pid);\n        photos.data.push({\n          "alt": alt,\n          \'fileKey\': fileKey,\n          "pid": pid,\n          //图片id\n          "src": src,\n          //原图地址\n          "thumb": src //缩略图地址\n\n        });\n        $imgView.find(\'img\').on(\'click\', function (event) {\n          event.preventDefault();\n          photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n          if (window.layer) {\n            layer.photos({\n              photos: photos,\n              shift: 5,\n              full: 1,\n              fullscreen: 1,\n              fulltools: 1,\n              shadeClose: config.properties.previewShadeClose\n            });\n          } else {\n            alert(\'图片预览需要加载layer\');\n          }\n        });\n      }\n    }\n\n    div.attr("data-filename", fileName);\n    var save = div.find(".wf-saveBtn");\n    save.hide();\n    save.click(function () {\n      if (editor.get(0).checkEdit() == 1) {\n        editor.get(0).save();\n      } else {\n        alert("未修改");\n      }\n    });\n    tempFileId = input.val() + Math.floor(Math.random() * 1000000);\n    var editBtn = div.find(".wf-editBtn");\n    editBtn.hide();\n    editBtn.click(function () {\n      //var downUrl = __httpHost + __contextPath +"/downloadfile/"+ input.val();\n      //var saveUrl = __httpHost + __basePath + \'workflow/updateFile.jsp?fileName=\' + input.val();\n\n      /*editor.get(0).open(downUrl, saveUrl);\n      save.show();*/\n      var dWidth = document.documentElement.clientWidth;\n      var dHeight = document.documentElement.clientHeight + 20;\n\n      if (dWidth > 1400) {\n        dWidth = 1400;\n      }\n\n      if (dHeight > 650) {\n        dHeight = 650;\n      }\n\n      var url = __basePath + "ioffice/editor.jsp?fileId=" + input.val() + "&mEditType=1,1&tempFileId=" + tempFileId;\n\n      if (window.showModalDialog) {\n        window.showModalDialog(url, window, "dialogWidth=" + dWidth + "px;dialogHeight=" + dHeight + "px;resizable=yes;scroll=no"); //window.open(url, "_blank", \'width=\'+document.documentElement.clientWidth+\'px,height=\'+document.documentElement.clientHeight+20+\'px,top=0,resizable=yes\');\n      } else {\n        window.open(url, "_blank", \'height=1000, width=800, resizable=yes\');\n      }\n    });\n\n    if (!isPic) {\n      view.click(function () {\n        var parame = "";\n\n        if (SUI.Util.browserPlantform() == "ios") {\n          parame = "?filename=uuid";\n        } else if (SUI.Util.browserPlantform() == "android") {\n          parame = "?" + config.appStoreLoginParam;\n        }\n\n        if (!config.onLinePreview) {\n          var p_url = \'\';\n\n          if (isNowUpload) {\n            p_url = url + parame;\n          } else {\n            p_url = SUI.settings().uploadify().downloadPath + input.val() + parame;\n          }\n\n          view.attr({\n            // "href": SUI.settings().uploadify().downloadPath + input.val() + parame,\n            "href": p_url,\n            "target": "_blank"\n          });\n        } // else {\n        //     view.attr({\n        //         "onclick": openOld(fileKey, extend2, fileName,fileKey,photos,config,url,isNowUpload,compress)\n        //     });\n        //\n        // }\n\n\n        view.attr({\n          "onclick": openOld(fileKey, extend2, fileName, fileKey, photos, config, url, isNowUpload, compress)\n        });\n      });\n    }\n\n    var delBtn = div.find(".wf-delete");\n    delBtn.hide();\n    delBtn.click(function () {\n      layer.confirm("是否确认删除？", {\n        icon: 3,\n        title: \'提示\'\n      }, function () {\n        deleteFileItem(div, fileKey);\n        layer.closeAll(\'dialog\');\n      });\n    });\n\n    if (uploadDo.canEdit || uploadDo.canEdit == \'true\') {\n      editBtn.show();\n    }\n\n    if (uploadDo.canDelete || uploadDo.canDelete == \'true\') {\n      delBtn.show();\n    } //查看原图\n\n\n    var lookBtn = div.find(\'.wf-lookPhoto\');\n    lookBtn.hide();\n\n    if (isMobile && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n      lookBtn.show();\n    } else {\n      if (compress == \'1\' || compress == \'2\') {\n        lookBtn.show();\n      }\n    }\n\n    lookBtn.click(function () {\n      event.preventDefault();\n      var pid = "img-" + Number(new Date());\n      var src = \'\';\n\n      if (isNowUpload) {\n        src = url;\n      } else {\n        src = SUI.settings().uploadify().downloadPath + input.val();\n      }\n\n      src += \'?isCompress=false\';\n      photos.data.push({\n        "alt": alt,\n        \'fileKey\': fileKey,\n        "pid": pid,\n        //图片id\n        "src": src,\n        //原图地址\n        "thumb": src //缩略图地址\n\n      });\n      photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n      if (window.layer) {\n        layer.photos({\n          photos: photos,\n          shift: 5,\n          full: 1,\n          fullscreen: 1,\n          fulltools: 1,\n          shadeClose: config.properties.previewShadeClose\n        });\n      } else {\n        alert(\'图片预览需要加载layer\');\n      }\n    });\n    var mode = SUI.Util.getQueryString(\'mode\');\n\n    if (mode == \'print\') {\n      div.find(\'span\').css(\'display\', \'none\');\n    }\n\n    return div;\n  }\n\n  function openOld(fileId, extend2, fileName, fileKey, photos, config, url, isNowUpload, compress) {\n    var type = fileName.substring(fileName.lastIndexOf("."), fileName.length);\n\n    if (extend2) {\n      layer.open({\n        title: \'提示\',\n        content: "是否下载此文件",\n        //        \t\t\tarea: [\'160px\', \'160px\'],\n        btn: [\'打开\', \'下载\', \'取消\'],\n        btn1: function btn1(index, layero) {\n          layer.close(index);\n\n          if (".pdf" == type || ".doc" == type || ".docx" == type) {\n            var myhref = __basePath + "pdf/pdfRead.jsp?key=" + extend2 + "&needBack=1";\n            var index = layer.open({\n              type: 2,\n              title: "在线阅览",\n              shadeClose: false,\n              maxmin: true,\n              shade: 0.6,\n              area: [Number(600) + 50 + "px", 400 + "px"],\n              scrollbar: true,\n              closeBtn: 1,\n              content: myhref + \'&appload=0&f=g\',\n              //iframe的url\n              success: function success(index, layero) {\n                $(index).find(\'.layui-layer-title\').show();\n                $(index).find(\'.layui-layer-setwin\').show();\n                $(".layui-layer-max").trigger("click");\n              }\n            });\n          } else {\n            var src = \'\';\n\n            if (isNowUpload) {\n              src = url;\n            } else {\n              src = SUI.settings().uploadify().downloadPath + fileId;\n            }\n\n            src += \'?isCompress=false\';\n            var alt = fileName.split(".")[0],\n                pid = "img-" + Number(new Date());\n            photos.data.push({\n              "alt": alt,\n              \'fileKey\': fileId,\n              //fileKey,\n              "pid": pid,\n              //图片id\n              "src": src,\n              //原图地址\n              "thumb": src //缩略图地址\n\n            });\n            photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n            if (window.layer) {\n              layer.photos({\n                photos: photos,\n                shift: 5,\n                full: 1,\n                fullscreen: 1,\n                fulltools: 1,\n                shadeClose: config.properties.previewShadeClose\n              });\n            } else {\n              alert(\'图片预览需要加载layer\');\n            } // layer.open({\n            //     type: 2,\n            //     title: "查看图片",\n            //     maxmin: true,\n            //     shade: 0.6,\n            //     area: [800 + "px", 600 + "px"],\n            //     scrollbar: true,\n            //     closeBtn: 1,\n            //     content: __basePath + "pictureviewer/showImg.jsp?key=" + extend2, //iframe的url，替换\n            //     success: function (layero, index) {\n            //         $(".layui-layer-max", layero).trigger("click");\n            //     }\n            // });\n\n          }\n        },\n        btn2: function btn2(index, layero) {\n          // window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n          if (isNowUpload) {\n            url = url;\n          } else {\n            url = SUI.settings().uploadify().downloadPath + fileId;\n          }\n\n          if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n            url += \'?isCompress=false\';\n          }\n\n          window.location.href = url;\n          layer.close(index);\n        }\n      });\n    } else {\n      var isMobile = SUI.Util.browserType() === \'phone\';\n\n      if (isMobile) {\n        layer.open({\n          title: \'提示\',\n          content: "是否下载此文件",\n          btn: [\'取消\', \'下载\'],\n          btn2: function btn2(index, layero) {\n            // window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n            if (isNowUpload) {\n              url = url;\n            } else {\n              url = SUI.settings().uploadify().downloadPath + fileId;\n            }\n\n            if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n              url += \'?isCompress=false\';\n            }\n\n            window.location.href = url;\n            layer.close(index);\n          }\n        });\n      } else {\n        if (isNowUpload) {\n          url = url;\n        } else {\n          url = SUI.settings().uploadify().downloadPath + fileId;\n        }\n\n        if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n          url += \'?isCompress=false\';\n        }\n\n        window.location.href = url;\n      }\n    }\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Fileupload/FileUpload.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Form/Form.js":
/*!*****************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Form/Form.js ***!
  \*****************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Form; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:50 PM\n */\n\n/**\n * form控件\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction Form(bind) {\n  var value, config;\n  var dom = bind || $('<form></form>').get(0);\n  dom.zoo = this;\n\n  function getChildren(element, list) {\n    $(\"[sui='true']\", element).each(function () {\n      if (this.zoo) {\n        list[list.length] = this;\n      }\n    });\n  }\n\n  function getDataValue(data, name) {\n    if (!name) {\n      return;\n    }\n\n    var splits = name.split(\".\");\n    var temp = data;\n\n    for (var i = 0; i < splits.length; i++) {\n      var key = splits[i];\n      temp = temp[key];\n\n      if (!temp) {\n        break;\n      }\n    }\n\n    return temp;\n  }\n\n  function setDataValue(data, name, value) {\n    if (!name) {\n      return;\n    }\n\n    var splits = name.split(\".\");\n    var point = data;\n\n    for (var i = 0; i < splits.length - 1; i++) {\n      var key = splits[i];\n\n      if (!point[key]) {\n        point[key] = {};\n      }\n\n      point = point[key];\n    }\n\n    point[splits[splits.length - 1]] = value;\n  }\n\n  this.setValue = function (data) {\n    value = data;\n    var children = [];\n    getChildren(dom, children);\n    $.each(children, function (i, el) {\n      var zoo = el.zoo;\n      var val = getDataValue(data, zoo.name);\n\n      if (zoo.name2 && val) {\n        val = [val, getDataValue(data, zoo.name2)];\n      }\n\n      if (zoo.notForm || typeof val === \"undefined\" || val === \"undefined\") {\n        return;\n      }\n\n      zoo.setValue(val);\n    });\n  };\n\n  this.getValue = function (tranform) {\n    var temp = {};\n    var extValue = {};\n    var children = [];\n    getChildren(dom, children);\n    $.each(children, function (i, el) {\n      var zoo = el.zoo;\n      var disabled = $(el).attr('form-disabled') == \"true\";\n\n      if (zoo.notForm || disabled) {\n        return;\n      }\n\n      var val = zoo.getValue();\n      setDataValue(temp, zoo.name, val);\n\n      if (zoo.name2) {\n        if (el.className.indexOf('sui-daterange') > -1 || el.className.indexOf('sui-daterangepicker') > -1) {\n          var parseData = zoo.getConfig();\n\n          if (!(/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1)) {\n            setDataValue(temp, zoo.name, SUI.Util.getTimePrecision(JSON.parse(val)[zoo.name]));\n            setDataValue(temp, zoo.name2, SUI.Util.getTimePrecision(JSON.parse(val)[zoo.name2]));\n          }\n        }\n      } else {\n        if (el.className.indexOf('sui-date') > -1 && el.className.indexOf('sui-daterange') === -1 || el.className.indexOf('sui-daterangepicker') > -1) {\n          var parseData = zoo.getConfig();\n\n          if (!(/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1)) {\n            val = SUI.Util.getTimePrecision(val);\n          }\n        } else if (el.className.indexOf('sui-daterange') > -1) {\n          var parseData = zoo.getConfig();\n\n          if (!(/HH/.test(parseData.format) && parseData.format.indexOf('yyyy') == -1 && parseData.format.indexOf('YYYY') == -1 && parseData.format.indexOf('MM') == -1 && parseData.format.indexOf('DD') == -1)) {\n            var val1 = SUI.Util.getTimePrecision(JSON.parse(val)[0]);\n            var val2 = SUI.Util.getTimePrecision(JSON.parse(val)[1]);\n            val = \"[\" + '\\\"' + val1 + '\\\"' + \",\" + '\\\"' + val2 + '\\\"' + \"]\";\n          }\n        }\n\n        setDataValue(temp, zoo.name, val);\n      }\n\n      if (zoo.type == 'select' || zoo.type == 'multiselect') {\n        var sConfig = zoo.getConfig();\n\n        if (zoo.type == 'select') {\n          if (sConfig.properties.custom != 'false' && val != sConfig.properties.customValue) {\n            var customField = sConfig.properties.customField;\n            var customHtml = $('div[name=' + zoo.name + ']').find('div[name=' + customField + ']');\n\n            if (customHtml.length && customHtml.sui().getValue()) {\n              customHtml.sui().setValue('');\n\n              if (extValue[customField]) {\n                extValue[customField] = '';\n              }\n            }\n          }\n        } else if (zoo.type == 'multiselect') {\n          if (sConfig.properties.custom != 'false' && val.indexOf(sConfig.properties.customValue) == -1) {\n            var customField = sConfig.properties.customField;\n            var customHtml = $('div[name=' + zoo.name + ']').find('div[name=' + customField + ']');\n\n            if (customHtml.length && customHtml.sui().getValue()) {\n              customHtml.sui().setValue('');\n\n              if (extValue[customField]) {\n                extValue[customField] = '';\n              }\n            }\n          }\n        }\n      }\n\n      var ext = zoo.getExt();\n\n      if (ext) {\n        extValue[zoo.name] = ext;\n      }\n    });\n    temp._ext = SUI.Util.toJsonString(extValue);\n\n    if (tranform) {\n      tranform(temp);\n    }\n\n    return temp;\n  };\n\n  this.validate = function () {\n    var children = [];\n    getChildren(dom, children);\n    var result = true,\n        error;\n    $.each(children, function (i, el) {\n      var zoo = el.zoo;\n      var con = zoo.getConfig();\n\n      if (!con || con.mode !== \"editable\") {\n        // mode in config\n        return;\n      } // 隐藏控件不做校验\n\n\n      if ($(el).is(':hidden')) {\n        return;\n      }\n\n      if (zoo.type == 'daterange' || zoo.type == 'datatable') {\n        if (!zoo.validate('submit')) {\n          if (!error) error = el;\n          result = false;\n        }\n      } else {\n        if (!zoo.validate()) {\n          if (!error) error = el;\n          result = false;\n        }\n      }\n    });\n\n    if (error && $(error).length) {\n      var top = $(error).offset().top - 52;\n      if (top < 0) top = 0;\n\n      if ($('body').find('.datatable-modal').length && $('.datatable-modal').hasClass('in')) {\n        $('.datatable-modal').stop().animate({\n          scrollTop: top\n        }, 300);\n      } else {\n        $('html,body').stop().animate({\n          scrollTop: top\n        }, 300);\n      }\n\n      if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n        var errorName = $(error).attr('name');\n        var errorContent = $('#tooltip_' + errorName).text();\n        var errorTipsHtml = '<div class=\"coreplus-error-tips\">' + '<div class=\"coreplus-error-cnt\">' + errorContent + '</div>' + '</div>';\n\n        if (!$('body').find('.coreplus-error-tips').length) {\n          $('body').append(errorTipsHtml);\n        }\n\n        setTimeout(function () {\n          $('body').find('.coreplus-error-tips').remove();\n        }, 2000);\n      }\n    }\n\n    return result;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Form/Form.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FormTitle/FormTitle.js":
/*!***************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FormTitle/FormTitle.js ***!
  \***************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FormTitle; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:15 AM\n */\n\n/**\n * 表单标题\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction FormTitle(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FormTitle/FormTitle.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Hide/Hide.js":
/*!*****************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Hide/Hide.js ***!
  \*****************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Hide; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:43 PM\n */\n\n/**\n * 隐藏域控件\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction Hide(bind) {\n  var dom = bind || $('<input type=\"hide\"></input>').get(0);\n  dom.zoo = this;\n  var config;\n\n  this.getValue = function () {\n    return this.value;\n  };\n\n  this.setValue = function (val) {\n    this.value = val === 0 || val === '0' ? 0 : val || \"\";\n    $(dom).trigger('change');\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Hide/Hide.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Input/Input.js":
/*!*******************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Input/Input.js ***!
  \*******************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Input; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 1:37 PM\n */\n\n/***\n *** input组件\n ***/\nfunction Input(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value;\n  dom.zoo = this;\n  var $input, $tpl;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    var settings = SUI.settings().input();\n    var parseData = config;\n\n    var require = parseData.validate && parseData.validate.require ? \'<span class="text-red">*</span>\' : \'\';\n\n    var title = parseData.properties.title || "";\n    var name = parseData.properties.name || "";\n    var type = parseData.inputType;\n    var isMobile = SUI.Util.browserType() === \'phone\';\n    var suffix = \'\';\n    var prefix = \'\';\n\n    if (isMobile && wf2.isNewInPhone) {\n      suffix = parseData.suffix ? type === \'textarea\' && isMobile && wf2.isNewInPhone ? \'<div class="suffix-textarea">\' + parseData.suffix + \'</div>\' : \'<span class="input-group-addon input-group-addon-phone">\' + parseData.suffix + \'</span>\' : "";\n      prefix = parseData.prefix ? type === \'textarea\' && isMobile && wf2.isNewInPhone ? \'<div class="prefix-textarea">\' + parseData.prefix + \'</div>\' : \'<span class="input-group-addon input-group-addon-phone">\' + parseData.prefix + \'</span>\' : "";\n    } else {\n      suffix = parseData.suffix ? type === \'textarea\' && isMobile && wf2.isNewInPhone ? \'<div class="suffix-textarea">\' + parseData.suffix + \'</div>\' : \'<span class="input-group-addon ">\' + parseData.suffix + \'</span>\' : "";\n      prefix = parseData.prefix ? type === \'textarea\' && isMobile && wf2.isNewInPhone ? \'<div class="prefix-textarea">\' + parseData.prefix + \'</div>\' : \'<span class="input-group-addon ">\' + parseData.prefix + \'</span>\' : "";\n    }\n\n    var maxlength = "";\n    var placeholder = parseData.placeholder;\n    var tip = parseData.inputTip;\n\n    var _value = parseData.value ? parseData.value : \'\';\n\n    if (parseData.cny) {\n      _value = SUI.Util.encodeCNY(parseData.value, parseData.cny);\n    }\n\n    var isFix = false;\n\n    if (suffix || prefix) {\n      isFix = true;\n    }\n\n    if (parseData.maxlength) maxlength = \' maxlength="\' + parseData.maxlength + \'"\';\n    var template = \'\';\n\n    if (type === "text") {\n      template = \'<input name="\' + name + \'"\' + maxlength + \' type="text" id="input_\' + name + \'" class="form-control \' + (isFix ? "fix-input" : "") + \'" value="\' + _value + \'" />\';\n    }\n\n    if (type === "textarea") {\n      template = \'<textarea name="\' + name + \'"\' + maxlength + \' rows="\' + parseData.rows + \'" id="input_\' + name + \'" class="form-control">\' + _value + \'</textarea>\';\n    }\n\n    if (parseData.suffix || parseData.prefix) {\n      template = \'<div class="input-group \' + (type == "textarea" ? \'textarea-group\' : \'\') + \'">\' + prefix + template + suffix + \'</div>\';\n    }\n\n    var $html = $(template);\n    $(dom).html($html);\n    $input = $("input, textarea", dom);\n    var mode = config.mode || \'view\';\n    var escape = SUI.settings().input().escape ? true : false;\n\n    if (config.escape) {\n      escape = config.escape == "false" ? false : true;\n    }\n\n    if (mode == "readOnly" || mode == "view") {\n      $html.hide();\n      $tpl = $(\'<div class="value-text" />\');\n      $tpl.html(("undefined" == typeof parseData.prefix ? "" : parseData.prefix + "") + \'<span class="value" id="value_\' + name + \'">\' + (escape ? SUI.Util.escape(_value) : _value) + \'</span>\' + ("undefined" == typeof parseData.suffix ? "" : "" + parseData.suffix));\n      $input.attr("readOnly", "readOnly");\n      $(dom).addClass(\'form-readOnly\').append($tpl);\n    }\n\n    if (mode == "editable") {\n      $input.removeAttr("readOnly");\n      $(dom).removeClass(\'form-readOnly\');\n      SUI.Util.poptip(tip, dom, $input);\n      placeholder && $input.attr(\'placeholder\', placeholder);\n\n      if (config && config.cny) {\n        var tempval = _value;\n        $input.on("focusin", function () {\n          tempval = this.value;\n        }).on(\'keyup\', function (event) {\n          if (event.type == "input") {\n            var pos = SUI.Util.getInputTextPos(this);\n            var seps = this.value.split(\',\').length;\n          }\n\n          this.value = SUI.Util.encodeCNY(this.value, parseData.cny);\n\n          if (event.type == "input") {\n            SUI.Util.setInputTextPos(this, pos - seps + this.value.split(\',\').length);\n          }\n\n          _value = this.value;\n        }).on("blur", function () {\n          if (_value != tempval) $(dom).trigger(\'change\');\n        });\n      }\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    if ($(dom).hasClass(\'disabled\')) {\n      $input.attr(\'readonly\', \'readonly\');\n    }\n  };\n\n  this.getValue = function () {\n    var input_val = $input.val();\n    var val = input_val;\n\n    if (config && config.cny) {\n      val = SUI.Util.decodeCNY(val, config.cny);\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n\n    if (config && config.cny) {\n      val = SUI.Util.encodeCNY(val, config.cny);\n    }\n\n    config.value = val;\n    var specialVal = \'\',\n        isSpecial = false;\n\n    if (!val && val != 0) {\n      isSpecial = true;\n    }\n\n    if (config.maxlength && typeof config.maxlength === \'number\') {\n      val = (val + \'\').substring(0, config.maxlength);\n    }\n\n    if (isValidate) {\n      $input.val(isSpecial ? specialVal : val);\n    } else {\n      $input.val(isSpecial ? specialVal : val).trigger(\'change\');\n    }\n\n    $tpl && $(".value", $tpl).html(SUI.Util.htmlEncode(isSpecial ? specialVal : val));\n  };\n\n  this.getExt = function () {\n    if (config.properties.sequence) {\n      return {\n        type: "sequence",\n        value: config.properties.sequence\n      };\n    }\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr("mode"),\n      validate: SUI.Util.parseJSON($(el).attr("validate"), true),\n      properties: {\n        title: $(el).attr("title"),\n        name: $(el).attr("name"),\n        sequence: $(el).attr("wf-sequence") || \'\',\n        expression: $(el).attr(\'expression\') || \'\',\n        bindExp: $(el).attr(\'bindExp\') || \'\'\n      },\n      value: $(el).attr("value") || "",\n      suffix: $(el).attr("suffix") || "",\n      prefix: $(el).attr("prefix") || "",\n      maxlength: Number($(el).attr("maxlength") || "0"),\n      inputType: $(el).attr("inputType") || "text",\n      rows: Number($(el).attr("rows") || "3"),\n      inputTip: $(el).attr("inputTip") || "",\n      placeholder: $(el).attr("placeholder") || "",\n      escape: $(el).attr("escape") || "",\n      version: $(el).attr("version") || \'V1.0\'\n    };\n\n    if (_data.maxlength && _data.validate) {\n      _data.validate.max = _data.validate.max || _data.maxlength;\n    }\n\n    if (_data.validate && _data.validate.format) {\n      var format = _data.validate.format.split("|");\n\n      if (/cny/i.test(format[1]) && format[2]) {\n        _data.cny = format[2];\n      }\n    }\n\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Input/Input.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Model/Model.js":
/*!*******************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Model/Model.js ***!
  \*******************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Model; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:08 PM\n */\n\n/**\n * 模态框\n * @param bind\n * @returns {*}\n * @constructor\n */\nvar hasLoadMode = false;\nfunction Model(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      modelIndex;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      title: $(dom).attr('title') || '申请须知',\n      // 模态窗标题\n      width: $(dom).attr('width') || '80%',\n      // 模态窗宽\n      height: $(dom).attr('height') || '70%',\n      // 模态窗高\n      url: $(dom).attr('url') || \"\",\n      // url\n      content: $(dom).attr('content') || \"\",\n      // 自定义html代码\n      noticeContent: $(dom).attr('noticeContent') || '',\n      //自定义须知的内容和html代码\n      maxmin: $(dom).attr('maxmin') == 'false' ? false : true,\n      // 是否显示最大化最小化 默认展示\n      shadeClose: $(dom).attr('shadeClose') == 'false' ? false : true,\n      // 点击空白处是否关闭   默认不能关闭\n      isInitShow: $(dom).attr('initShow') == 'false' ? false : true,\n      // 初始化时是否显示  默认不显示\n      closeBtn: $(dom).attr('closebtn') == 'false' ? false : true,\n      // 是否显示右上角关闭按钮 默认不显示\n      modelType: $(dom).attr('modelType') == 'notice' ? 'notice' : 'custom',\n      //模态框的类型\n      noticeType: $(dom).attr('noticeType') == 'custom' ? 'custom' : 'defalut',\n      //须知提示的类型\n      noticeText: $(dom).attr('noticeText') || '',\n      //自定义须知提示文字\n      countdown: $(dom).attr('countdown') || '',\n      //倒计时秒数\n      isBind: $(dom).attr('isBind') == 'false' ? false : true,\n      //是否绑定控件\n      bindComponent: $(dom).attr('bindComponent'),\n      //绑定控件触发模态框\n      buttonText: $(dom).attr('buttonText') || '模态框',\n      //按钮文本\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  };\n\n  if (!hasLoadMode) {\n    loadOneScript(__basePath + '_libs/plugins/layer/layer.js', function () {\n      hasLoadMode = true;\n    });\n  } //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (!config.wfConfig) {\n      return;\n    }\n\n    if (config.isInitShow) {\n      // 只有申请页面才可以打开\n      if (!config.workItem && config.wfConfig.mode != 'preview' && config.wfConfig.mode != 'print' && config.wfConfig.mode != 'modify') {\n        this.showModel();\n      }\n    } else {\n      if (config.isBind) {\n        if (config.bindComponent) {\n          if ($('div[name=' + config.bindComponent + ']').length) {\n            $('div[name=' + config.bindComponent + ']').on('click', function () {\n              dom.zoo.showModel();\n            });\n          } else if ($('#' + config.bindComponent).length) {\n            $('#' + config.bindComponent).on('click', function () {\n              dom.zoo.showModel();\n            });\n          }\n        }\n      } else {\n        $(dom).html('<a class=\"btn btn-primary model-button\">' + config.buttonText + '</a>');\n        $(dom).on('click', function () {\n          dom.zoo.showModel();\n        });\n      }\n    }\n  }; // 展现模态框\n\n\n  this.showModel = function () {\n    var width = config.width;\n    var height = config.height;\n    config.content = config.content.replace(/↵/g, '');\n    var content_modal = '<div class=\"modal-padding\">' + config.content + '</div>';\n    var content_modal_phone = '<div class=\"model-html-phone\">' + config.content + '</div>';\n    config.noticeContent = config.noticeContent.replace(/↵/g, '');\n    var noticeContent_modal = '<div class=\"modal-padding notice-html-phone\">' + config.noticeContent + '</div>';\n    var noticeContent_modal_phone = '<div class=\"notice-html-phone\">' + config.noticeContent + '</div>';\n    config.title = config.title || '';\n\n    if (SUI.Util.browserType() == \"phone\") {\n      if (config.url) {\n        iPortal.openWindow(__basePath + '_libs/plugins/mechanism/modal.jsp?modal_type=iframe&iframe_url=' + config.url + '&title=' + config.title, function (data) {}, {\n          title: config.title || '申请须知'\n        });\n      } else {\n        var modelHtml_phone = $('<div class=\"ui-modal model-phone modal fade ' + name + '\"><div class=\"ui-modal-cnt\"></div></div>');\n        var contentHtml = $('<div class=\"ui-modal-bd model-content-phone\"></div>');\n\n        if (config.modelType == 'notice') {\n          if (config.noticeType == 'custom') {\n            var noticeText = config.noticeText;\n          } else {\n            var noticeText = '我已阅读并同意以上条款';\n          }\n\n          var headerHtml = '<header class=\"ui-modal-hd ui-border-b ui-header model-header\"><div class=\"must-know\">' + (config.title || '申请须知') + '</div></header>';\n          var noticeHtml = '<div class=\"must-read \"><label class=\"model-checkbox\"><input type=\"checkbox\" name=\"read\"/></label><span class=\"noticetext\">' + noticeText + '</span></div>';\n          var buttonHtml = '<div class=\"footer-button\">确定</div>';\n          content_modal = noticeContent_modal_phone;\n          contentHtml.html(content_modal);\n          modelHtml_phone.html(headerHtml);\n          modelHtml_phone.append(contentHtml);\n          modelHtml_phone.append(noticeHtml);\n          modelHtml_phone.append(buttonHtml);\n          modelHtml_phone.find('input[name=\"read\"]').iCheck(SUI.settings().iCheck({}));\n          modelHtml_phone.find('.footer-button').addClass('disable-button');\n\n          if (config.countdown) {\n            modelHtml_phone.find('.must-read').hide();\n            var countHtml = '<div class=\"count-down\"></div>';\n            contentHtml.after(countHtml);\n            var countdown = config.countdown;\n            countdown++;\n            var start = setInterval(function () {\n              if (countdown > 0) {\n                countdown--;\n                modelHtml_phone.find('.count-down').html(countdown + '&nbsp;s');\n                modelHtml_phone.find('.count-down').show();\n                modelHtml_phone.find('.must-read').hide();\n              } else {\n                clearInterval(start);\n                modelHtml_phone.find('.count-down').hide();\n                modelHtml_phone.find('.must-read').show();\n              }\n            }, 1000);\n          }\n\n          $(document).on('ifChanged', 'input[name=\"read\"]', function () {\n            var checked = $(this).prop('checked');\n\n            if (checked) {\n              modelHtml_phone.addClass('model-phone-bg');\n              modelHtml_phone.find('.footer-button').removeClass('disable-button');\n            } else {\n              modelHtml_phone.removeClass('model-phone-bg');\n              modelHtml_phone.find('.footer-button').addClass('disable-button');\n            }\n          });\n        } else {\n          modelHtml_phone.addClass('model-phone-bg');\n          var headerHtml = '<header class=\"ui-modal-hd ui-border-b ui-header model-header\"><div class=\"must-know\">' + (config.title || '申请须知') + '</div></header>';\n          var buttonHtml = '<div class=\"footer-button\">确定</div>';\n          content_modal = content_modal_phone;\n          contentHtml.html(content_modal);\n          modelHtml_phone.html(headerHtml);\n          modelHtml_phone.append(contentHtml);\n          modelHtml_phone.append(buttonHtml);\n        }\n\n        modelHtml_phone.find('.footer-button').on('click', function () {\n          if ($(this).hasClass('disable-button')) {\n            return false;\n          } else {\n            $('body').removeClass('noscroll');\n            $('html').removeClass('html_noscroll');\n            modelHtml_phone.modal('hide');\n          }\n        });\n\n        if ($('body').find('.model-phone').length) {\n          $('body').find('.model-phone').remove();\n        }\n\n        $('body').append(modelHtml_phone);\n        $('html').addClass('html_noscroll');\n        $('body').addClass('noscroll');\n        modelHtml_phone.on('show.bs.modal', function () {\n          setTimeout(function () {\n            var headerHeight = $('.model-header').height();\n            var windowHeight = $(window).height();\n            var maxHeight = windowHeight * 0.6;\n            var totalHeight = '';\n\n            if (config.modelType == 'notice') {\n              var contentHeight = $('.notice-html-phone').height();\n              totalHeight = contentHeight + headerHeight + 115;\n            } else {\n              var contentHeight = $('.model-html-phone').height();\n              totalHeight = contentHeight + headerHeight + 90;\n            }\n\n            if (totalHeight < maxHeight) {\n              $('.model-phone').css('height', totalHeight);\n            } else {\n              $('.model-phone').css('height', maxHeight);\n            }\n\n            var modelHeight = $('.model-phone').height();\n            var trueHeight = null;\n\n            if (modelHtml_phone.find('.must-read').length) {\n              trueHeight = modelHeight - headerHeight - 95 + 5;\n            } else {\n              trueHeight = modelHeight - headerHeight - 50 + 5;\n            }\n\n            $('.model-content-phone').css('height', trueHeight);\n          }, 500);\n        });\n        modelHtml_phone.modal('show');\n      }\n    } else {\n      if (config.modelType == 'notice') {\n        var noticeContent = noticeContent_modal || '暂无内容';\n        var noticeText = '';\n\n        if (config.noticeType == 'custom') {\n          noticeText = config.noticeText;\n        } else {\n          noticeText = '我已阅读并同意以上条款';\n        }\n\n        modelIndex = layer.open({\n          type: 1,\n          title: config.title || '申请须知',\n          // title:false,\n          area: [width.indexOf('%') > 0 ? width : width + 'px', height.indexOf('%') > 0 ? height : height + 'px'],\n          content: '<div class=\"layer-custom-content\">' + noticeContent + '</div>',\n          maxmin: typeof config.maxmin == 'boolean' ? config.maxmin : config.maxmin == 'false' ? false : true,\n          resize: true,\n          anim: 5,\n          closeBtn: 0,\n          success: function success(layero, index) {\n            $(layero).addClass('modal-layer-pc');\n            $('body').addClass('noscroll');\n            var footer = '<div id=\"model_footer\" class=\"col-sm-12\" style=\"width:100%;padding:10px;position:absoulte;bottom:0;height:50px;\">\\\n                                            <div class=\"col-sm-12 countdown\" style=\"text-align:center;color:red;\">' + config.countdown + '&nbsp;s</div>\\\n                                            <div class=\"col-sm-9\" style=\"display:inline-block;vertical-align:middle;line-height:30px;\">\\\n                                                <label class=\"noticeCheck\" style=\"display:none;margin:0\">\\\n                                                    <input type=\"checkbox\" name=\"noticeCheck\" style=\"display: inline-block;margin-right: 5px;vertical-align: text-top;\">\\\n                                                    <span style=\"-moz-user-select: none;-ms-user-select: none;user-select: none;font-weight:700;\">' + noticeText + '</span>\\\n                                                </label>\\\n                                            </div>\\\n                                            <div class=\"col-sm-3\">\\\n                                                <button class=\"btn btn-sm btn-default pull-right model_next_btn\" disabled style=\"display:none;\">下一步</button>\\\n                                            </div>\\\n                                        </div>';\n            $(layero).find('.layui-layer-content').append(footer);\n            $(layero).find('input[name=noticeCheck]').iCheck(SUI.settings().iCheck({}));\n            var mheight = $(layero).find('.layui-layer-content').height() - $(layero).find('#model_footer').outerHeight();\n            $(layero).find('.layui-layer-content .layer-custom-content').css({\n              height: mheight + 'px',\n              overflow: 'auto'\n            });\n\n            if (config.countdown != '' && Number(config.countdown) > 0) {\n              var _int = setInterval(function () {\n                if (config.countdown - 1 > 0) {\n                  config.countdown--;\n                  $(layero).find('.countdown').html(config.countdown + '&nbsp;s');\n                } else {\n                  clearInterval(_int);\n                  $(layero).find('.countdown').hide();\n                  $(layero).find('.noticeCheck').show();\n                  $(layero).find('.model_next_btn').show();\n                }\n              }, 1000);\n            } else {\n              $(layero).find('.countdown').hide();\n              $(layero).find('.noticeCheck').show();\n              $(layero).find('.model_next_btn').show();\n            }\n\n            $(layero).find('.model_next_btn').click(function () {\n              $('body').removeClass('noscroll');\n              layer.close(index);\n            });\n            $(layero).find('input[name=noticeCheck]').on('ifChanged', function () {\n              var checked = $(layero).find('input[name=noticeCheck]').prop('checked');\n\n              if (checked) {\n                $(layero).find('.model_next_btn').attr('disabled', false);\n              } else {\n                $(layero).find('.model_next_btn').attr('disabled', true);\n              }\n            });\n          },\n          cancel: function cancel() {\n            $('body').removeClass('noscroll');\n          }\n        });\n        return;\n      } else {\n        if (config.url) {\n          modelIndex = layer.open({\n            type: 2,\n            title: config.title,\n            area: [width.indexOf('%') > 0 ? width : width + 'px', height.indexOf('%') > 0 ? height : height + 'px'],\n            content: config.url,\n            maxmin: typeof config.maxmin == 'boolean' ? config.maxmin : config.maxmin == 'false' ? false : true,\n            anim: 5,\n            resize: true,\n            shadeClose: typeof config.shadeClose == 'boolean' ? config.shadeClose : config.shadeClose == 'false' ? false : true,\n            closeBtn: typeof config.closeBtn == 'boolean' ? config.closeBtn == false ? 0 : 1 : config.closeBtn == 'false' ? 0 : 1,\n            success: function success(lay, index) {\n              $(lay).addClass('modal-layer-pc');\n              $('body').addClass('noscroll');\n            },\n            cancel: function cancel() {\n              $('body').removeClass('noscroll');\n            }\n          });\n          return;\n        }\n\n        if (content_modal) {\n          modelIndex = layer.open({\n            type: 1,\n            title: config.title,\n            area: [width.indexOf('%') > 0 ? width : width + 'px', height.indexOf('%') > 0 ? height : height + 'px'],\n            content: content_modal,\n            maxmin: typeof config.maxmin == 'boolean' ? config.maxmin : config.maxmin == 'false' ? false : true,\n            resize: true,\n            anim: 5,\n            shadeClose: typeof config.shadeClose == 'boolean' ? config.shadeClose : config.shadeClose == 'false' ? false : true,\n            closeBtn: typeof config.closeBtn == 'boolean' ? config.closeBtn == false ? 0 : 1 : config.closeBtn == 'false' ? 0 : 1,\n            success: function success(lay, index) {\n              $(lay).addClass('modal-layer-pc');\n              $('body').addClass('noscroll');\n            },\n            cancel: function cancel() {\n              $('body').removeClass('noscroll');\n            }\n          });\n          return;\n        }\n\n        if (!content_modal && !config.url) {\n          modelIndex = layer.open({\n            type: 1,\n            title: config.title,\n            area: [width.indexOf('%') > 0 ? width : width + 'px', height.indexOf('%') > 0 ? height : height + 'px'],\n            content: \"暂无内容\",\n            maxmin: typeof config.maxmin == 'boolean' ? config.maxmin : config.maxmin == 'false' ? false : true,\n            resize: true,\n            anim: 5,\n            shadeClose: typeof config.shadeClose == 'boolean' ? config.shadeClose : config.shadeClose == 'false' ? false : true,\n            closeBtn: typeof config.closeBtn == 'boolean' ? config.closeBtn == false ? 0 : 1 : config.closeBtn == 'false' ? 0 : 1,\n            success: function success(lay, index) {\n              $(lay).addClass('modal-layer-pc');\n              $('body').addClass('noscroll');\n            },\n            cancel: function cancel() {\n              $('body').removeClass('noscroll');\n            }\n          });\n        }\n      }\n    }\n  }; // 关闭模态框\n\n\n  this.closeModel = function () {\n    layer.close(modelIndex);\n  };\n\n  function loadOneScript(src, callback) {\n    var script = document.createElement('script'),\n        head = document.getElementsByTagName('head')[0];\n    script.type = 'text/javascript';\n    script.charset = 'UTF-8';\n    script.src = src;\n\n    if (script.addEventListener) {\n      script.addEventListener('load', function () {\n        callback();\n      }, false);\n    } else if (script.attachEvent) {\n      script.attachEvent('onreadystatechange', function () {\n        var target = window.event.srcElement;\n\n        if (target.readyState == 'loaded') {\n          callback();\n        }\n      });\n    }\n\n    head.appendChild(script);\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Model/Model.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/MultiSelect/MultiSelect.js":
/*!*******************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/MultiSelect/MultiSelect.js ***!
  \*******************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MultiSelect; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:17 PM\n */\n\n/**\n ** multiselect组件\n */\nfunction MultiSelect(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value,\n      triggerIndex = 0,\n      isSet = false;\n  dom.zoo = this;\n  $(dom).addClass('form-multiselect');\n  var $select, $checkbox;\n\n  this.init = function (val) {\n    config = val;\n\n    if (val.properties.dataUrl && typeof $.fn.loadSelectRemoteData === 'function' && !val.cascade.linkSource) {\n      this.name = val.properties.name;\n      $(document).on('contextDone', function () {\n        $(dom).loadSelectRemoteData(val);\n      }); // $(dom).loadSelectRemoteData(val)\n    } else if (typeof $.fn.loadStaticCascadeData === 'function' && val.cascade.cascadeData) {\n      this.name = val.properties.name;\n      $(dom).loadStaticCascadeData(val, false);\n    } else {\n      this.setConfig(val);\n    }\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getValue = function (js) {\n    var vals;\n\n    if (this.selectStyle == \"select\") {\n      vals = $select.val() || [];\n    } else if (this.selectStyle == \"checkbox\") {\n      vals = function () {\n        var _val = [];\n        $checkbox.each(function (index, el) {\n          if ($(el).is(\":checked\")) _val.push(el.value);\n        });\n        return _val;\n      }();\n    }\n\n    return js ? vals.join(\",\") : vals;\n  };\n\n  this.setValue = function (val) {\n    if (!val) {\n      return false;\n    }\n\n    if (typeof val === \"string\" && /^\\[.*\\]$/.test(val)) {\n      val = function () {\n        return eval('(function(){return ' + val + '})()');\n      }();\n    }\n\n    if (!$.isArray(val)) {\n      val = (val + \"\").split(/[,|\\||\\&]/);\n    }\n\n    value = val;\n    config.value = value;\n\n    if (this.selectStyle == \"select\") {\n      var dataSource = config.properties.dataSource;\n      var selectedData = [];\n      var isSort = false;\n\n      if (dataSource.length) {\n        var valSort = [];\n        $.each(val, function (i, v) {\n          $.each(dataSource, function (j, d) {\n            if (v == d.value) {\n              valSort.push(j);\n            }\n          });\n        });\n\n        if (valSort.length && valSort.length > 1) {\n          for (var i = 0; i < valSort.length - 1; i++) {\n            if (valSort[i] > valSort[i + 1]) {\n              isSort = true;\n            }\n          }\n        }\n\n        if (isSort && SUI.Util.browserType() == 'pc') {\n          for (var i = dataSource.length - 1; i > -1; i--) {\n            if (val.length) {\n              var isHas = false;\n              $.each(val, function (j, n) {\n                if (dataSource[i].value == n) {\n                  isHas = true;\n                }\n              });\n\n              if (isHas) {\n                selectedData.push(dataSource[i]);\n                dataSource.splice(i, 1);\n              }\n            }\n          }\n\n          if (selectedData.length && val.length) {\n            for (var i = val.length - 1; i > -1; i--) {\n              $.each(selectedData, function (j, n) {\n                if (n.value == val[i]) {\n                  dataSource.unshift(n);\n                }\n              });\n            }\n          }\n\n          config.value = val;\n          config.properties.dataSource = dataSource;\n          this.setConfig(config);\n          return false;\n        }\n      }\n\n      $select.val(val).trigger('change');\n      var mode = config.mode || 'view';\n\n      if (mode === 'readOnly' || mode === 'view') {\n        var _value = getDidaplyValue(val);\n\n        $(dom).find('.value-text .value').html(_value);\n      }\n    } else if (this.selectStyle == \"checkbox\") {\n      isSet = true;\n      $checkbox.iCheck(\"uncheck\");\n      $.each(val, function (index, v) {\n        triggerIndex++;\n        $checkbox.filter(\"[value='\" + v + \"']\").iCheck(\"check\");\n      });\n\n      if (SUI.Util.getQueryString(\"mode\") === 'print') {\n        var _value = getDidaplyValue(val);\n\n        $('.checkbox-group', dom).html(_value);\n      }\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n\n    var _this = this;\n\n    var require = config.validate && config.validate.require ? '<span class=\"text-red\">*</span>' : '';\n\n    var title = config.properties.title || \"\";\n    var name = config.properties.name || \"\";\n\n    var _value = value || config.value;\n\n    this.selectStyle = config.properties.selectStyle;\n    var custom = config.properties.custom;\n    var customName = config.properties.customName || '';\n    var customField = config.properties.customField;\n    var customValue = config.properties.customValue;\n    var muiltLine = config.properties.muiltLine;\n    var validate = config.properties.inputValidate;\n    var maxlength = config.properties.maxlength;\n    var placeholderInput = config.properties.placeholderInput;\n    var otherSelect = {\n      name: config.properties.customName,\n      value: config.properties.customValue\n    };\n    var mode = config.mode || 'view';\n    var isMobile = SUI.Util.browserType() === 'phone';\n\n    if (this.selectStyle == \"select\") {\n      var selectedValue = [];\n      var listOptions = '';\n\n      if (custom !== 'false' && customName != \"\" && customName != null && customName != \"underfined\") {\n        var arr = Array;\n        arr = config.properties.dataSource;\n        var isRepeat = false;\n\n        if (arr && arr.length) {\n          $.each(arr, function (a, data) {\n            if (data.value === otherSelect.value) {\n              isRepeat = true;\n            }\n          });\n        }\n\n        if (!isRepeat) {\n          arr.push(otherSelect);\n        }\n\n        listOptions = render(config.properties.dataSource);\n      } else {\n        listOptions = render(config.properties.dataSource);\n      }\n\n      var template = '<select name=\"' + name + '\" id=\"select_' + name + '\" multiple=\"multiple\" class=\"form-control\" style=\"width: 100%;\">' + listOptions + '</select>';\n\n      if (isMobile && wf2.isNewInPhone) {\n        template += '<span class=\"org-arrow\"></span>';\n      }\n\n      if ($(dom).find('select').length > 0) {\n        $(dom).html(template);\n\n        if (custom == 'otherinput') {\n          var customSelect = \"\";\n\n          if (mode == 'editable') {\n            if (muiltLine === 'true') {\n              customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\"  name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n            } else {\n              customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n            }\n          } else {\n            if (muiltLine === 'true') {\n              customSelect = '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\"></div>';\n            } else {\n              customSelect = '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\"></div>';\n            }\n          }\n\n          $(dom).append(customSelect);\n        }\n      } else {\n        $(dom).prepend(template);\n      }\n\n      SUI.init($.noop, $(dom));\n      $select = $(\"select\", dom);\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        $(dom).find('.org-arrow').remove();\n        $select.attr(\"disabled\", \"disabled\");\n        $(dom).addClass('form-readOnly');\n      }\n\n      if (mode == \"editable\") {\n        $select.removeAttr(\"disabled\");\n        $(dom).removeClass('form-readOnly');\n      }\n\n      if (mode == \"hide\") {\n        $(dom).hide();\n      }\n\n      if ($('.sui-input', dom).length > 0) {\n        var selectInputConfig = $('.sui-input', dom).sui().getConfig();\n      }\n\n      if (custom == 'otherinput') {\n        var sv = $select.val() || [];\n\n        if (sv.indexOf(customValue) > -1) {\n          $(dom).find('.show-custom').css('display', '');\n        } else {\n          $(dom).find('.show-custom').css('display', 'none');\n        }\n\n        $select.on('change', function () {\n          var sv = $select.val() || [];\n          var selectInputConfig;\n          var writeValue = '';\n\n          if ($('.sui-input', dom).length > 0) {\n            writeValue = $('.sui-input', dom).sui().getValue();\n            selectInputConfig = $('.sui-input', dom).sui().getConfig();\n          }\n\n          if (sv.indexOf(customValue) > -1) {\n            $(dom).find('.show-custom').css('display', '');\n            $(dom).find('.show-custom').attr('validate', validate);\n\n            if ((mode === 'readOnly' || mode === 'view') && SUI.Util.getQueryString(\"mode\") === 'print') {\n              $(dom).find('.value-text').css('display', 'none');\n            }\n\n            if ($('.sui-input', dom)) {\n              selectInputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n            }\n          } else {\n            $(dom).find('.show-custom').css('display', 'none');\n            $(dom).find('.show-custom').attr('validate', '{\"require\": false}');\n\n            if ($('.sui-input', dom) > 0) {\n              selectInputConfig.validate = {\n                \"require\": false\n              };\n            }\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            var value = $(dom).find('.show-custom').sui().getValue();\n            selectInputConfig.value = value;\n            $(dom).find('.show-custom').sui().setConfig(selectInputConfig);\n          }\n        });\n      }\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        $select.attr(\"disabled\", \"disabled\").hide();\n        $(dom).addClass('form-readOnly');\n        $(dom).prepend('<div class=\"value-text\"> <span class=\"value\" id=\"value_' + name + '\"></span> </div>');\n      } else {\n        $select.select2($.extend(true, {\n          minimumResultsForSearch: -1,\n          mobile: mode != \"editable\"\n        }, config.select2 || {}));\n      }\n\n      if (_value) {\n        this.setValue(_value);\n      }\n\n      $(dom).on('change', function () {\n        var nowValue = _this.getValue();\n\n        if (selectedValue.length && nowValue.length) {\n          $.each(nowValue, function (i, n) {\n            var isHas = false;\n            $.each(selectedValue, function (j, s) {\n              if (s == n) {\n                isHas = true;\n              }\n            });\n\n            if (!isHas) {\n              selectedValue.push(n);\n            }\n          });\n\n          for (var i = selectedValue.length - 1; i > -1; i--) {\n            var isHas = false;\n            $.each(nowValue, function (j, n) {\n              if (selectedValue[i] == n) {\n                isHas = true;\n              }\n            });\n\n            if (!isHas) {\n              selectedValue.splice(i, 1);\n            }\n          }\n\n          if (JSON.stringify(selectedValue) != JSON.stringify(nowValue) && SUI.Util.browserType() == 'pc') {\n            _this.setValue(selectedValue);\n          }\n        } else {\n          if (nowValue.length && nowValue.length == 1) {\n            selectedValue.push(nowValue[0]);\n          }\n        }\n      });\n    }\n\n    if (this.selectStyle == \"checkbox\") {\n      var listOptions = '';\n\n      if (custom !== 'false' && customName != \"\" && customName != null && customName != \"underfined\") {\n        var arr = Array;\n        arr = config.properties.dataSource;\n        var isRepeat = false;\n\n        if (arr && arr.length) {\n          $.each(arr, function (a, data) {\n            if (data.value === otherSelect.value) {\n              isRepeat = true;\n            }\n          });\n        }\n\n        if (!isRepeat) {\n          arr.push(otherSelect);\n        }\n\n        listOptions = render(config.properties.dataSource, this.selectStyle, this.name);\n      } else {\n        listOptions = render(config.properties.dataSource, this.selectStyle, this.name);\n      }\n\n      var template = '<div class=\"checkbox-group\">' + listOptions + '</div>';\n      $(dom).html(template);\n      SUI.init($.noop, $(dom));\n      $checkbox = $(\"input[name=\" + this.name + \"]\", dom);\n\n      if (_value) {\n        this.setValue(_value);\n      }\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        $checkbox.attr(\"disabled\", \"disabled\");\n      }\n\n      if (mode == \"editable\") {\n        $checkbox.removeAttr(\"disabled\").on('ifChanged', function (event) {\n          event.preventDefault();\n\n          if (!value || !isSet || triggerIndex === value.length) {\n            $(dom).trigger('change');\n            triggerIndex = 0;\n            isSet = false;\n          }\n        });\n        $checkbox.on('ifChanged', function (e) {\n          e.preventDefault();\n        });\n      }\n\n      if (mode == \"hide\") {\n        $(dom).hide();\n      }\n\n      $checkbox.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      })); //如果有输入框 控制输入框\n\n      if ($('.sui-input', dom).length > 0) {\n        var inputConfig = $('.sui-input', dom).sui().getConfig();\n      }\n\n      if (custom == 'otherinput') {\n        var getChecked = function getChecked() {\n          var checkedList = [];\n          $checkbox.each(function (index, el) {\n            if ($(el).is(\":checked\")) checkedList.push(el.value);\n          });\n          return checkedList;\n        };\n\n        // 修改对齐方式\n        if (mode === 'readOnly' || SUI.Util.getQueryString('mode') === 'print') {\n          $(dom).find('.show-custom').css('vertical-align', 'baseline');\n        }\n\n        if (getChecked().indexOf(customValue) > -1) {\n          $(dom).find('.show-custom').css('display', 'inline-block');\n          $(dom).find('.show-custom').attr('validate', validate);\n\n          if (SUI.Util.getQueryString('mode') === 'print' && mode === 'readOnly') {\n            $(dom).find('.checkbox-group label').css('display', 'none');\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            inputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n          }\n        } else {\n          // $('.tooltip').hide();\n          $(dom).find('.show-custom').css('display', 'none');\n          $(dom).find('.show-custom').attr('validate', '{\"require\": false}');\n\n          if (SUI.Util.getQueryString('mode') === 'print' && mode === 'readOnly') {\n            $('.sui-multiselect .checkbox-group').html(this.getValue());\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            inputConfig.validate = {\n              \"require\": false\n            };\n          }\n        }\n\n        $checkbox.on('ifChanged', function () {\n          if (getChecked().indexOf(customValue) > -1) {\n            $(dom).find('.show-custom').css('display', 'inline-block');\n            $(dom).find('.show-custom').attr('validate', validate);\n\n            if ((mode === 'readOnly' || mode === 'view') && SUI.Util.getQueryString('mode') === 'print') {\n              $(dom).find('.checkbox-group label').css('display', 'none');\n            }\n\n            if ($('.sui-input', dom).length > 0) {\n              inputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n            }\n          } else {\n            // $('.tooltip').hide();\n            $(dom).find('.show-custom').css('display', 'none');\n            $(dom).find('.show-custom').attr('validate', '{\"require\": false}');\n\n            if ($('.sui-input', dom).length > 0) {\n              inputConfig.validate = {\n                \"require\": false\n              };\n            }\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            var value = $(dom).find('.show-custom').sui().getValue();\n            inputConfig.value = value;\n            $(dom).find('.show-custom').sui().setConfig(inputConfig);\n          }\n        });\n      }\n    }\n\n    $(dom).on('change', function () {\n      var value = dom.zoo.getValue();\n\n      if (value && config.properties.maxSize && value.length <= config.properties.maxSize) {\n        $(dom).tooltip('hide');\n      }\n\n      if (value && config.properties.minSize && value.length >= config.properties.minSize) {\n        $(dom).tooltip('hide');\n      }\n\n      if (value && config.properties.maxSize && value.length > config.properties.maxSize) {\n        $(dom).attr('errorTip', '最多选择' + config.properties.maxSize + '项');\n        SUI.Util.validate.call(dom, validate, value, true);\n      }\n\n      if (value && config.properties.minSize && value.length < config.properties.minSize) {\n        $(dom).attr('errorTip', '最少选择' + config.properties.minSize + '项');\n        SUI.Util.validate.call(dom, validate, value, true);\n      }\n    });\n  };\n\n  this.validate = function (isBuild) {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n    $(dom).attr('errorTip', '');\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    if (isBuild) {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n\n    if (value && config.properties.maxSize && value.length > config.properties.maxSize) {\n      $(dom).attr('errorTip', '最多选择' + config.properties.maxSize + '项');\n      result = SUI.Util.validate.call(dom, validate, value, true);\n      result = false;\n    }\n\n    if (value && config.properties.minSize && value.length < config.properties.minSize) {\n      $(dom).attr('errorTip', '最少选择' + config.properties.minSize + '项');\n      result = SUI.Util.validate.call(dom, validate, value, true);\n      result = false;\n    }\n\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function getDataSource(element) {\n    var el = element || bind;\n\n    var _source = $(dom).attr(\"dataSource\");\n\n    return SUI.Util.parseJSON(_source || '[]', true);\n  }\n\n  function render(data, selectStyle, name, getValue) {\n    var html = \"\";\n    var custom = config.properties.custom;\n    var customName = config.properties.customName || '';\n    var customField = config.properties.customField;\n    var componentField = config.properties.componentField;\n    var muiltLine = config.properties.muiltLine;\n    var validate = config.properties.inputValidate;\n    var placeholderInput = config.properties.placeholderInput;\n    var mode = config.mode || 'view';\n    var maxlength = '';\n\n    if (config.properties.maxlength) {\n      maxlength = ' maxlength=\"' + config.properties.maxlength + '\"';\n    }\n\n    if (!data) return html;\n    $.each(data, function (i, _v) {\n      var v = $.isPlainObject(_v) ? _v : {\n        value: _v,\n        name: _v\n      };\n\n      if (selectStyle === \"checkbox\") {\n        var id = SUI.Util.getSequence(\"select\");\n        var checked = v.checked ? ' checked=\"checked\"' : '';\n        id = \"sui-multiselect-\" + name + id;\n        var checkbox_index = name + SUI.Util.getSequence(\"select\");\n        html += '<label for=\"' + id + '\" id=\"checkbox_' + checkbox_index + '\"><input id=\"' + id + '\"' + checked + ' type=\"checkbox\" name=\"' + name + '\" value=\"' + v.value + '\" />' + v.name + '</label>';\n\n        if (custom !== 'false') {\n          if (i === data.length - 1) {\n            if (mode == 'editable') {\n              if (muiltLine === 'true') {\n                html += '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" validate = {\"require\":false} ' + maxlength + ' style=\"display: none;\"></div>';\n              } else {\n                html += '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" validate = {\"require\":false} ' + maxlength + ' style=\"display: none;\"></div>';\n              }\n            } else {\n              if (muiltLine === 'true') {\n                html += '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"display: none;\"></div>';\n              } else {\n                html += '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"display: none;\"></div>';\n              }\n            }\n          }\n        }\n      } else {\n        html += '<option value=\"' + v.value + '\">' + v.name + '</option>';\n\n        if (custom !== 'false') {\n          if (i === data.length - 1) {\n            if (mode == 'editable') {\n              if (muiltLine === 'true') {\n                var customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n              } else {\n                var customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n              }\n            } else {\n              if (muiltLine === 'true') {\n                var customSelect = '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\"></div>';\n              } else {\n                var customSelect = '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\"  ' + maxlength + ' style=\"margin-top: 5px;display: none;\"></div>';\n              }\n            }\n\n            if ($(dom).find('select').length < 1) {\n              $(dom).append(customSelect);\n            }\n          }\n        }\n\n        if (getValue && checked) {\n          var _value = v.name;\n          return false;\n        }\n      }\n    });\n    return html;\n  }\n\n  function getDidaplyValue(val) {\n    var data = config.properties.dataSource;\n    var _data = [];\n    var _val = [];\n\n    for (var index = 0; index < data.length; index++) {\n      var _v = data[index];\n      _data[index] = $.isPlainObject(_v) ? _v : {\n        value: _v,\n        name: _v\n      };\n    }\n\n    for (var i = 0; i < val.length; i++) {\n      var idx = SUI.Util.inArrayObj('value', val[i], _data);\n\n      if (idx != -1) {\n        _val[i] = _data[idx].name;\n      } else {\n        _val[i] = val[i];\n      }\n    }\n\n    return _val.join(',');\n  }\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\"),\n        dataSource: getDataSource(el),\n        selectStyle: $(el).attr(\"selectStyle\") || \"select\",\n        //select | checkbox\n        maxSize: Number($(el).attr(\"maxSize\") || \"0\"),\n        minSize: Number($(el).attr(\"minSize\") || \"0\"),\n        checkStyle: $(dom).attr('checkStyle'),\n        checkColor: $(dom).attr('checkColor'),\n        custom: $(el).attr('custom') || 'false',\n        customName: $(el).attr('customName') || '',\n        customValue: $(el).attr('customValue'),\n        customField: $(el).attr('customField'),\n        muiltLine: $(el).attr('muiltline'),\n        inputValidate: $(el).attr('inputValidate'),\n        maxlength: Number($(el).attr(\"maxlength\") || \"0\"),\n        //限制最大字数\n\n        /*ajax*/\n        idField: $(el).attr('idField') || 'id',\n        textField: $(el).attr('textField') || 'text',\n        dataSrc: $(el).attr('dataSrc') || '',\n        dataUrl: $(el).attr('dataUrl') || '',\n        entityType: $(el).attr('entityType') || '',\n        reqParams: $(el).attr('reqParams') ? SUI.Util.parseJSON($(el).attr(\"reqParams\"), true) : '',\n        method: $(el).attr('method') || 'post',\n        placeholderInput: $(el).attr('placeholderinput') || '',\n        keepstyleonphone: $(el).attr('keepstyleonphone') || 'false' //在移动端重构时是否保持设置的样式 默认全部改为select\n\n      },\n      cascade: {\n        linkSource: $(el).attr('linksource'),\n        // linkKey:$(el).attr('linkKey')||'',\n        cascadeData: $(el).attr('cascadeData') ? SUI.Util.parseJSON($(el).attr('cascadeData'), true) : ''\n      },\n      value: $(el).attr(\"value\") || \"\",\n      select2: SUI.Util.parseJSON($(el).attr(\"select2\"), true)\n    };\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/MultiSelect/MultiSelect.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/NewFileUpload/NewFileUpload.js":
/*!***********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/NewFileUpload/NewFileUpload.js ***!
  \***********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FileUpload; });\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:53 PM\n */\n\n/**\n * 文件上传控件\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction FileUpload(bind) {\n  var value, config;\n  var dom = bind || $(\'<div></div>\').get(0);\n  dom.zoo = this;\n  var items, controlId, photos, btnId, uploadDo, editExt, tempFileId;\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    uploadDo = {\n      canEdit: config.properties.canEdit,\n      canUpload: config.properties.canUpload,\n      canDelete: config.properties.canDelete,\n      canCreate: config.properties.canCreate\n    };\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      uploadDo.canEdit = false;\n      uploadDo.canUpload = false;\n      uploadDo.canDelete = false;\n    }\n\n    if (mode == "editable") {\n      uploadDo.canUpload = true;\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    render();\n    this.setValue(config.value);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.getValue = function (js) {\n    if (!value || !value.length) {\n      return \'\';\n    }\n\n    if (config.properties.multi == "true") {\n      return js ? value : value.length ? SUI.Util.toJsonString(value) : "";\n    } else {\n      return value[0];\n    }\n  };\n\n  function lazyLoading() {\n    var tasks = [];\n\n    this.run = function (id, task) {\n      tasks.push(task);\n      setTimeout(function () {\n        var temp = tasks;\n        tasks = [];\n\n        if (temp.length < 1) {\n          return;\n        }\n\n        var ids = [];\n        $.each(temp, function (i, t) {\n          ids.push(t.id);\n        });\n        $.ajax({\n          type: "POST",\n          url: SUI.settings().uploadify().getFile,\n          data: SUI.Util.toJsonString({\n            entity: {\n              __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n              id: key,\n              ids: ids\n            }\n          }),\n          contentType: "text/json",\n          success: function success(data) {\n            $.each(temp, function (i, task) {\n              task.exe(data);\n            });\n          }\n        });\n      }, 200);\n    };\n  }\n\n  function loadOneFile(fileId) {\n    var itemContent = \'<div data-key="\' + fileId + \'"></div>\';\n    items.append(itemContent);\n    $.ajax({\n      type: "POST",\n      url: SUI.settings().uploadify().getFile,\n      data: SUI.Util.toJsonString({\n        entity: {\n          __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n          id: fileId\n        }\n      }),\n      contentType: "text/json",\n      success: function success(data) {\n        var extend2 = data.value.extend2;\n\n        if (data.value.fileType == ".jpg" || data.value.fileType == ".jpeg" || data.value.fileType == ".gif" || data.value.fileType == ".bmp" || data.value.fileType == ".pdf") {\n          extend2 = data.value.id;\n        }\n\n        var item = createFileItem(fileId, data.value.fileName, data.value.fileLength, true, null, extend2, false, data.value.hascompress);\n        var itemContent = items.find(\'[data-key="\' + fileId + \'"]\');\n\n        if (itemContent.length > 0) {\n          itemContent.html(item);\n        }\n\n        onchange();\n      },\n      error: function error() {\n        items.empty();\n      }\n    });\n  }\n\n  this.setValue = function (val) {\n    var mode = config.mode || "view";\n    items.empty();\n    photos.data = [];\n    config.value = val;\n\n    if (val) {\n      var fileKeys;\n\n      if (config.properties.multi == "true") {\n        fileKeys = SUI.Util.parseJSON(val, true);\n      } else {\n        fileKeys = [val];\n\n        try {\n          fileKeys = SUI.Util.parseJSON(val, true);\n        } catch (err) {\n          fileKeys = [val];\n        }\n      }\n\n      value = fileKeys;\n\n      for (var i in value) {\n        loadOneFile(value[i]);\n      }\n    } else {\n      value = val;\n      items.html(mode == "editable" ? config.placeholder : config.emptyText);\n    }\n  };\n\n  this.getExt = function () {\n    var cur = this.getValue(true);\n    var ary = [];\n    var changeName = config.properties.changeName;\n    var name = config.properties.name;\n\n    if (!changeName) {\n      changeName = "";\n    }\n\n    var oldValue = wf2.entity && wf2.entity[name];\n    var nowValue = this.getValue();\n    var isdraft = SUI.Util.getQueryString(\'draftId\');\n\n    if (oldValue == nowValue && !isdraft) {\n      return false;\n    } //多选\n\n\n    if (config.properties.multi == "true") {\n      var srcAry = JSON.parse(config.value || "[]").concat([]);\n      var curAry = (cur || []).concat([]);\n\n      var contains = function contains(item, collect) {\n        var contains = false;\n        $.each(collect, function (i, d) {\n          if (d == item) {\n            contains = true;\n          }\n        });\n        return contains;\n      }; //双向比较\n\n\n      $.each(srcAry, function (i, item) {\n        if (!contains(item, curAry)) {\n          ary[ary.length] = {\n            value: item,\n            op: "delete"\n          };\n        }\n      });\n      $.each(curAry, function (i, item) {\n        if (!contains(item, srcAry)) {\n          ary[ary.length] = {\n            value: item,\n            op: "insert"\n          };\n        }\n      });\n\n      if (!ary.length) {\n        if (cur.length) {\n          $.each(cur, function (i, item) {\n            ary[ary.length] = {\n              value: item,\n              op: "insert"\n            };\n          });\n        }\n      }\n\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName\n      };\n    } else {\n      if (cur) {\n        ary[ary.length] = {\n          value: cur,\n          op: "insert"\n        };\n      } else {\n        if (config.value) {\n          ary[ary.length] = {\n            value: config.value,\n            op: "delete"\n          };\n        }\n      }\n\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName\n      };\n    }\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue(true);\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr("mode");\n    temp.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      canEdit: element.attr("canEdit") == "true" ? true : false,\n      //默认不可编辑\n      canUpload: element.attr("canUpload") !== "false",\n      canDelete: element.attr("canDelete") !== "false",\n      canCreate: element.attr("canCreate") == "true",\n      multi: element.attr("multi"),\n      max: (element.attr("max") || 5) - 0,\n      ext: element.attr("ext"),\n      // \'*.gif; *.jpg; *.png\' 使用分号分割\n      accept: element.attr("accept") || \'image/*\',\n      preview: element.attr("preview") == "false" ? false : true,\n      //默认可以预览\n      previewWidth: Number(element.attr("previewWidth") || "0"),\n      previewShadeClose: element.attr("previewShadeClose") == "true",\n      previewStyle: element.attr("previewStyle") || "",\n      buttonText: element.attr("buttonText") || "上传",\n      buttonWidth: Number(element.attr("buttonWidth") || "60"),\n      fileSizeLimit: Number(element.attr("fileSizeLimit") || "0"),\n      changeName: element.attr("changeName"),\n      existFileAlert: element.attr(\'existFileAlert\') == "false" ? false : true,\n      coverExistFile: element.attr(\'coverExistFile\') == "true",\n      uploadurl: element.attr(\'uploadurl\') == "false" ? "false" : "true",\n      uploadAddress: element.attr(\'uploadAddress\')\n    };\n    temp.placeholder = element.attr("placeholder") || "";\n    temp.emptyText = element.attr("emptyText") || "";\n    temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    temp.value = element.attr("value") || "";\n    return temp;\n  };\n\n  this.getTempFileId = function () {\n    return tempFileId;\n  };\n\n  this.getResultData = function () {\n    return resultData;\n  };\n\n  function render() {\n    var require = config.validate && config.validate.require ? "*" : "";\n\n    var html = \'\';\n    html += \'<div class="file-items"></div>\' + \'<div class="wf-fileQueue"></div>\' + \'<input class="wf-fileControl" type="file"\' + (config.properties && config.properties.accept ? checkFormat(config.properties.ext) ? \' accept="\' + config.properties.accept + \'"\' : \'\' : \'\') + \' multiple="false" style="display:none"/>\';\n    $(dom).html(html);\n    var div = $(dom);\n    var params = config.properties;\n    var control = div.find(".wf-fileControl");\n    var id = "_upload" + SUI.Util.getSequence("fileUpload");\n    btnId = "btn" + id;\n    controlId = id;\n    control.attr("id", id);\n    var queue = div.find(".wf-fileQueue");\n    var queueID = "queue" + id;\n    queue.attr("id", queueID);\n    var resultData;\n    items = div.find(".file-items");\n    photos = {\n      title: params.title,\n      id: Number(new Date()),\n      start: 0,\n      data: []\n    };\n    var cloneCtrl = null;\n\n    var resetControl = function resetControl(formData) {\n      if (formData) {\n        control[0].value = "";\n      } else {\n        var control2 = cloneCtrl.clone(true, false);\n        control.replaceWith(control2);\n        control = control2;\n      }\n\n      control.removeClass(\'uploading\');\n    };\n\n    if (uploadDo.canUpload) {\n      var isMobile = SUI.Util.browserType() == "phone";\n      var mobileBtn = \'\';\n\n      if (isMobile && wf2.isNewInPhone) {\n        mobileBtn = $(\'<div class="upload-add" id="\' + btnId + \'"></div>\');\n      } else {\n        mobileBtn = $(\'<div class="btn btn-sm btn-primary btn-uploadify-mobile" id="\' + btnId + \'" />\').css({\n          "position": "relative",\n          "overflow": "hidden"\n        });\n      }\n\n      control.on(\'click\', function (event) {\n        if (control.hasClass(\'uploading\')) {\n          event.preventDefault();\n          layer.alert(\'请稍后，正在上传文件...\');\n          return false;\n        }\n      });\n      var ajaxUp = window.FormData;\n\n      if (ajaxUp) {\n        control.show();\n\n        if (isMobile && wf2.isNewInPhone) {\n          control.addClass("upload-file-btn").css({\n            position: \'absolute\',\n            width: 45,\n            height: 45,\n            opacity: 0,\n            "z-index": 99\n          }).wrap(mobileBtn);\n          control.after(\'<span class="upload-add-icon"></span>\');\n        } else {\n          control.addClass("upload-file-btn").css({\n            position: \'absolute\',\n            width: 1000,\n            height: 32,\n            fontSize: \'100px\',\n            top: -2,\n            bottom: 0,\n            right: -2,\n            opacity: 0\n          }).wrap(mobileBtn);\n          control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n        }\n\n        var loadingView = $(\'<div class="upload-loading" />\');\n        div.append(loadingView);\n\n        var uploadAction = function uploadAction(fileName, existFile) {\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          } // if ( !checkMaxFileSize(control) ) {\n          //     layer.alert("上传失败，上传文件不得超过20M", {\n          //         title: \'提示\',\n          //         closeBtn: 0\n          //     });\n          //     return resetControl(true);\n          // }\n          //\n          // if ( !checkMaxFileSize(control) ) {\n          //     layer.alert("上传失败，上传文件不得超过20M", {\n          //         title: \'提示\',\n          //         closeBtn: 0\n          //     });\n          //     return resetControl(true);\n          // }\n\n\n          if (!checkFileSize(control, params.fileSizeLimit)) {\n            layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          }\n\n          if (control.hasClass(\'uploading\')) {\n            return layer.alert(\'请稍后，正在上传文件...\');\n          }\n\n          control.addClass(\'uploading\');\n          var formData = new FormData();\n          var settings = SUI.settings().uploadify({}); //formData.append("a", "");\n          //formData.append("","");\n\n          formData.append("Filedata", control.get(0).files[0]);\n          loadingView.html("正在上传……");\n          var uploadaddress = settings.uploaderNew;\n\n          if (config.properties.uploadurl == \'false\') {\n            uploadaddress = __basePath + config.properties.uploadAddress;\n          }\n\n          $.ajax({\n            url: uploadaddress,\n            type: \'POST\',\n            data: formData,\n            xhr: function xhr() {\n              //获取ajaxSettings中的xhr对象，为它的upload属性绑定progress事件的处理函数\n              var myXhr = $.ajaxSettings.xhr();\n\n              if (myXhr.upload) {\n                //检查upload属性是否存在\n                //绑定progress事件的回调函数\n                myXhr.upload.addEventListener(\'progress\', function (e) {\n                  if (e.lengthComputable) {\n                    var percent = e.loaded / e.total * 100;\n                    percent = percent + "";\n                    percent = percent.substring(0, 4);\n                    loadingView.html("正在上传…… " + percent + "%");\n                  }\n                }, false);\n              }\n\n              return myXhr; //xhr对象返回给jQuery使用\n            },\n            processData: false,\n            //必须false才会避开jQuery对 formdata 的默认处理\n            contentType: false,\n            // 必须false才会自动加上正确的Content-Type\n            success: function success(data) {\n              if (config.properties.uploadurl == \'false\') {\n                control.removeClass(\'uploading\');\n                control.parent().next().hide();\n                data = $.parseJSON(data);\n                $(dom).trigger("uploadExcelSuccess", [data]);\n              } else {\n                $(dom).attr("absolutPath", JSON.parse(data).absolutPath);\n                loadingView.empty();\n                resultData = $.parseJSON(data);\n\n                if (resultData.error) {\n                  var errorInfo = resultData.error;\n\n                  if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                    if (errorInfo.lastIndexOf("maximum") > 0) {\n                      var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                      maximum = maximum / 1024 / 1024;\n                      errorInfo = "上传文件不得超过" + maximum + "M";\n                    } else {\n                      errorInfo = "文件大小超过系统限制";\n                    }\n                  }\n\n                  layer.alert("上传失败，" + errorInfo, {\n                    title: \'提示\',\n                    closeBtn: 0\n                  });\n                } else {\n                  if (resultData.hascompress && resultData.hascompress == \'1\') {\n                    // var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile,null,true,resultData.hascompress,resultData.compressUrl,resultData.url);\n                    var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile, null, true, resultData.hascompress, resultData.url, resultData.url);\n                  } else {\n                    var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile, null);\n                  }\n\n                  items.append(item);\n                  onchange();\n                  $(dom).trigger("onUploadSuccess", [resultData]);\n                }\n              }\n            },\n            error: function error(responseStr) {\n              loadingView.empty();\n              var errorInfo = responseStr;\n\n              if (_typeof(errorInfo) == "object") {\n                errorInfo = "请检查网络设置";\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                title: \'提示\',\n                closeBtn: 0\n              });\n            },\n            complete: function complete() {\n              // reset input, 再次上传相同无法触发change事件，导致无法上传已上传过的文件\n              return resetControl(true);\n            }\n          });\n        };\n\n        control.on("change", function () {\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl(true);\n          }\n\n          var existFile = checkFileExists(fileName);\n\n          if (existFile) {\n            if (params.coverExistFile) {\n              layer.confirm(\'存在同名文件，是否覆盖原文件？\', {\n                icon: 0,\n                title: \'提示\'\n              }, function (index) {\n                layer.close(index);\n                uploadAction(fileName, existFile);\n              }, function () {\n                return resetControl(true);\n              });\n            } else {\n              layer.alert(\'文件已存在\');\n              return resetControl(true);\n            }\n          } else {\n            uploadAction(fileName);\n          }\n        });\n      } else if (true) {\n        control.show();\n        control.addClass("upload-file-btn").css({\n          position: \'absolute\',\n          width: 1000,\n          height: 32,\n          fontSize: \'100px\',\n          top: -2,\n          bottom: 0,\n          right: -2,\n          opacity: 0\n        }).wrap(mobileBtn);\n        var settings = SUI.settings().uploadify({});\n        var winName = "winName_fileUpload" + SUI.Util.getSequence("fileUpload"),\n            formId = \'form_\' + winName; //control.wrap(form);\n\n        control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n        var loadingView = $(\'<div class="upload-loading" /><div style="display:none;"><iframe name="\' + winName + \'" src="about:blank"></iframe></div>\');\n        div.append(loadingView);\n        loadingView = loadingView.first();\n        var form = $(\'<form id="\' + formId + \'" action="#" method="post" enctype ="multipart/form-data" target="\' + winName + \'"></form>\');\n        form.on("submit", function (e) {\n          e.stopPropagation();\n        });\n        var existFile;\n\n        var uploadAction = function uploadAction(fileName) {\n          if (control.hasClass(\'uploading\')) {\n            return layer.alert(\'请稍后，正在上传文件...\');\n          }\n\n          control.addClass(\'uploading\');\n          form.submit();\n          loadingView.html("正在上传……");\n          resetControl(); // 修复ie9及以下 上传相同文件无法触发 change事件的bug\n        };\n\n        form.prop(\'uploadResult\', {\n          call: function call(data) {\n            loadingView.empty();\n            resultData = data;\n\n            if (resultData.error) {\n              var errorInfo = resultData.error;\n\n              if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                if (errorInfo.lastIndexOf("maximum") > 0) {\n                  var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                  maximum = maximum / 1024 / 1024;\n                  errorInfo = "上传文件不得超过" + maximum + "M";\n                } else {\n                  errorInfo = "文件大小超过系统限制";\n                }\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                title: \'提示\',\n                closeBtn: 0\n              });\n            } else {\n              if (!checkFileSize(resultData.fileSize, params.fileSizeLimit, true)) {\n                return layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n                  title: \'提示\',\n                  closeBtn: 0\n                });\n              }\n\n              var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, false, existFile);\n              items.append(item);\n              onchange();\n              $(dom).trigger("onUploadSuccess", [resultData]);\n            }\n          }\n        });\n        control.after(form);\n        form.append(control);\n        control.on("change", function () {\n          control.attr("name", "Filedata"); //判断是否被修改域，导致iframe跨域\n\n          var domain = window.location.host;\n\n          if (domain.indexOf(":") > -1) {\n            domain = domain.substring(0, domain.indexOf(":"));\n          }\n\n          if (domain != document.domain) {\n            domain = "document.domain=\'" + document.domain + "\';";\n          } else {\n            domain = "";\n          }\n\n          var formScript = domain + " parent.document.getElementById(\'" + formId + "\').uploadResult.call";\n          formScript = stringToHex(formScript);\n          var uploadaddress = settings.uploaderNew;\n\n          if (config.properties.uploadurl == \'false\') {\n            uploadaddress = __basePath + config.properties.uploadAddress;\n          }\n\n          var url = uploadaddress + "?formScript=" + formScript;\n          form.attr("action", url);\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl();\n          }\n\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl();\n          }\n\n          var existFile = checkFileExists(fileName);\n\n          if (existFile) {\n            if (params.coverExistFile) {\n              layer.confirm(\'存在同名文件，是否覆盖原文件？\', {\n                title: \'提示\'\n              }, function (index) {\n                layer.close(index);\n                uploadAction(fileName);\n              }, function () {\n                return resetControl(true);\n              });\n            } else {\n              layer.alert(\'文件已存在\');\n              return resetControl(true);\n            }\n          } else {\n            uploadAction(fileName);\n          }\n        });\n        cloneCtrl = control.clone(true, false);\n      } else {}\n    }\n\n    function stringToHex(str) {\n      if (!str) {\n        return "";\n      }\n\n      var hex = str.charCodeAt(0).toString(16);\n\n      for (var i = 1; i < str.length; i++) {\n        var code = str.charCodeAt(i).toString(16);\n        hex += "," + code;\n      }\n\n      hex = hex.toUpperCase();\n      return hex;\n    }\n\n    function checkFileName(fileName) {\n      if (!config.properties.ext) {\n        return true;\n      }\n\n      var ext = fileName.substring(fileName.lastIndexOf("."));\n      var splits = config.properties.ext.split(";");\n\n      for (var i = 0; i < splits.length; i++) {\n        var filePattern = $.trim(splits[i]);\n        var ext2 = filePattern.substring(filePattern.lastIndexOf("."));\n\n        if (ext.toLowerCase() == ext2.toLowerCase()) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function checkFileExists(fileName) {\n      var check = false;\n      var $items = $(dom).find(\'.file-item\');\n\n      if (!fileName || !$items.length) {\n        return check;\n      }\n\n      $items.each(function (index, el) {\n        var filename = $(el).attr(\'data-filename\');\n        var regFileName = filename || \'\';\n\n        if (regFileName) {\n          regFileName = regFileName.replace(/\\(/g, \'\\\\(\');\n          regFileName = regFileName.replace(/\\)/g, \'\\\\)\');\n          regFileName = regFileName.replace(/\\[/g, \'\\\\[\');\n          regFileName = regFileName.replace(/\\]/g, \'\\\\]\');\n          regFileName = regFileName.replace(/\\{/g, \'\\\\{\');\n          regFileName = regFileName.replace(/\\}/g, \'\\\\{\');\n        }\n\n        var reg = new RegExp(regFileName, "gi");\n\n        if (reg.test(fileName)) {\n          check = el;\n          return false;\n        }\n      });\n      return check;\n    }\n\n    function checkFileSize(el, maxSize, isNum) {\n      if (!isNum) {\n        var file = $(el)[0];\n\n        if (maxSize > 0 && file.files[0].size > maxSize * 1024) {\n          return false;\n        }\n      } else {\n        var size = Number(el);\n\n        if (size && maxSize && size > maxSize * 1024) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    function checkMaxFileSize(el, maxSize) {\n      var file = $(el)[0];\n\n      if (file.files[0].size > 1024 * 1024 * 20) {\n        return false;\n      }\n\n      return true;\n    }\n\n    function checkMaxFileSize(el) {\n      var file = $(el)[0];\n\n      if (file.files[0].size > 1024 * 1024 * 20) {\n        return false;\n      }\n\n      return true;\n    }\n  }\n\n  function checkFormat(format) {\n    if (SUI.Util.browserType() === \'pc\') {\n      return false;\n    } else {\n      format = format || \'\';\n      var imageList = \'*.xbm;*.tif;*.pjp;*.pjpeg;*.jfif;*.ico;*.tiff;*.gif;*.svg;*.bmp;*.png;*.jpeg;*.svgz;*.jpg;*.webp\';\n      var list = format.split(\';\') || \'\';\n\n      if (list && list.length) {\n        if (list.length == 1) {\n          if (!list[0]) {\n            return false;\n          } else {\n            if (imageList.indexOf(list[0].toLowerCase()) > -1) {\n              return true;\n            } else {\n              return false;\n            }\n          }\n        } else {\n          var hasImage = true;\n          $.each(list, function (i, v) {\n            if (v) {\n              if (imageList.indexOf(v.toLowerCase()) == -1) {\n                hasImage = false;\n              }\n            }\n          });\n          return hasImage;\n        }\n      } else {\n        return false;\n      }\n    }\n  }\n\n  function onchange() {\n    if (!uploadDo.canUpload) {\n      return;\n    }\n\n    $(dom).trigger(\'change\');\n    var len = value.length;\n    var uploader = $("#" + controlId + \', #\' + btnId);\n    var editer = $("#" + controlId + \', #edit\' + btnId);\n\n    if (config.properties.multi == "true") {\n      if (len < config.properties.max) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    } else {\n      if (len == 0) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    }\n  }\n\n  function deleteFileItem(div, fileKey) {\n    var fileId = fileKey;\n\n    if (div.attr(\'previewid\')) {\n      var pindex = APP.inArrayObj(\'pid\', div.attr(\'previewid\'), photos.data);\n\n      if (pindex !== -1) {\n        var fileId = photos.data[pindex].fileKey;\n        photos.data.splice(pindex, 1);\n      }\n    }\n\n    var fileIndex = $.inArray(fileId, value);\n\n    if (fileIndex !== -1) {\n      value.splice(fileIndex, 1);\n      div.remove();\n      onchange();\n    }\n  } // compress是否压缩\n  // compressUrl预览地址\n  // url 原图地址\n\n\n  function createFileItem(fileKey, fileName, fileSize, init, existFile, extend2, isNowUpload, compress, compressUrl, url) {\n    isNowUpload = isNowUpload || false;\n\n    if (!value) {\n      value = [];\n    }\n\n    if (!init) {\n      if (existFile) {\n        var existFileKey = $(existFile).find(\'input\').val();\n\n        if (config.properties.coverExistFile) {\n          deleteFileItem($(existFile), existFileKey);\n        } else {\n          return layer.alert(\'该文件已存在\');\n        }\n      }\n\n      value.push(fileKey);\n    }\n\n    var filterFileName = fileName.match(/[^/\\\\\\\\]+$/);\n\n    if (filterFileName) {\n      fileName = filterFileName[0];\n    }\n\n    var isMobile = SUI.Util.browserType() === \'phone\';\n    var div = \'\';\n\n    if (isMobile && wf2.isNewInPhone) {\n      div = $(\'<div class="file-item">\' + \'<input class="wf-fileInput" type="hidden"/>\' + \'<div class="upload-show-file">\' + \'<div class="wf-fileView">\' + \'<div class="upload-show-text"><span class="upload-show-icon"></span></div>\' + \'<div class="upload-show-info">\' + \'<div class="upload-show-info-name"></div>\' + \'<div class="upload-show-info-size"></div>\' + \'</div>\' + \'</div>\' + \'<div class="upload-btnlist">\' + \'<span class="wf-delete">删除</span>\' + \'<span class="wf-editBtn">编辑</span>\' + \'<span class="wf-saveBtn">上传</span>\' + \'<span class="wf-lookPhoto">查看原图</span>\' + \'</div>\' + \'</div>\' + \'</div>\');\n    } else {\n      div = $(\'<div class="file-item"><input class="wf-fileInput" type="hidden" /><a class="wf-fileView"></a> \' + \'<span class="btn btn-sm btn-danger wf-delete" style="display:inline-block"><i class="fa fa-close"></i> 删除</span> \' + \'<span class="btn btn-sm btn-success wf-editBtn"  style="display:inline-block"><i class="fa fa-edit"></i> 编辑</span> \' + \'<span class="btn btn-sm btn-primary wf-saveBtn"  style="display:inline-block"><i class="fa fa-upload"></i> 上传</span>\' + \'<span class="btn btn-sm btn-primary wf-lookPhoto"  style="display:inline-block"><i class="fa fa-camera"></i> 查看原图</span>\' + \'</div>\');\n    }\n\n    var view = div.find(".wf-fileView");\n    fileSize = fileSize - 0;\n\n    if (fileSize < 1024) {\n      fileSize = fileSize + "Bit";\n    } else if (fileSize < 1024 * 1024) {\n      fileSize = (fileSize / 1024).toFixed(1) + "KB";\n    } else if (fileSize < 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024)).toFixed(1) + "MB";\n    } else if (fileSize < 1024 * 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024 * 1024)).toFixed(1) + "GB";\n    }\n\n    var input = div.find("input");\n    input.val(fileKey);\n    var isPic = false;\n\n    if (isMobile && wf2.isNewInPhone) {\n      if (config.properties.preview && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n        isPic = true;\n        var $imgView = view.find(\'.upload-show-text\'),\n            alt = fileName.split(".")[0];\n        $imgView.addClass(\'upload-show-pic\');\n        view.find(\'.upload-show-info\').addClass(\'upload-show-pic-info\');\n        var src = \'\';\n\n        if (isNowUpload) {\n          src = compressUrl;\n        } else {\n          src = SUI.settings().uploadify().downloadPath + input.val();\n        }\n\n        if (compress == \'1\' || compress == \'2\') {\n          src += \'?isCompress=true\';\n        } else {\n          src += \'?isCompress=false\';\n        }\n\n        $imgView.html(\'<img src="\' + src + \'" />\');\n        var pid = "img-" + Number(new Date());\n        div.attr("previewid", pid);\n        photos.data.push({\n          "alt": alt,\n          \'fileKey\': fileKey,\n          "pid": pid,\n          //图片id\n          "src": src,\n          //原图地址\n          "thumb": src //缩略图地址\n\n        });\n        $imgView.find(\'img\').on(\'click\', function (event) {\n          event.preventDefault();\n          photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n          if (window.layer) {\n            layer.photos({\n              photos: photos,\n              shift: 5,\n              full: 1,\n              fullscreen: 1,\n              fulltools: 1,\n              shadeClose: config.properties.previewShadeClose\n            });\n          } else {\n            alert(\'图片预览需要加载layer\');\n          }\n        });\n      } else {\n        view.find(\'.upload-show-text\').addClass(\'upload-show-wenben\');\n        view.find(\'.upload-show-info\').addClass(\'upload-show-wenben-info\');\n\n        if (fileName.indexOf(\'.doc\') > -1 || fileName.indexOf(\'.docx\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-word\');\n        } else if (fileName.indexOf(\'.xls\') > -1 || fileName.indexOf(\'.xlsx\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-excel\');\n        } else if (fileName.indexOf(\'.pdf\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-pdf\');\n        } else if (fileName.indexOf(\'.zip\') > -1) {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-zip\');\n        } else {\n          view.find(\'.upload-show-icon\').addClass(\'upload-show-default\');\n        }\n      }\n\n      view.find(\'.upload-show-info-name\').text(fileName.replace(\'_temp:\', \'\'));\n      view.find(\'.upload-show-info-size\').text(fileSize);\n    } else {\n      view.html(fileName.replace(\'_temp:\', \'\') + \' (\' + fileSize + \')\');\n\n      if (config.properties.preview && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n        var $imgView = $(\'<div class="file-imageview" />\'),\n            alt = fileName.split(".")[0];\n        var src = \'\';\n\n        if (isNowUpload) {\n          src = compressUrl;\n        } else {\n          src = SUI.settings().uploadify().downloadPath + input.val();\n        }\n\n        if (compress == \'1\' || compress == \'2\') {\n          src += \'?isCompress=true\';\n        } else {\n          src += \'?isCompress=false\';\n        }\n\n        $imgView.html(\'<div class="imageview-box"><img style="\' + config.properties.previewStyle + \'" title="点击预览" src="\' + src + \'" alt="\' + alt + \'" /></div>\');\n        if (config.properties.previewWidth) $("img", $imgView).css("width", config.properties.previewWidth);\n        var showImage = new Image();\n        showImage.src = src;\n\n        showImage.onload = function () {\n          var imageWidth = showImage.width;\n          var imageHeight = showImage.height;\n\n          if (imageHeight > 150) {\n            var showHeight = 150;\n            var scale = imageWidth / imageHeight;\n            var showWidth = showHeight * scale;\n            $("img", $imgView).css(\'width\', showWidth + \'px\');\n            $("img", $imgView).css(\'height\', showHeight + \'px\');\n          }\n        };\n\n        $imgView.prependTo(div);\n        var pid = "img-" + Number(new Date());\n        div.attr("previewid", pid);\n        photos.data.push({\n          "alt": alt,\n          \'fileKey\': fileKey,\n          "pid": pid,\n          //图片id\n          "src": src,\n          //原图地址\n          "thumb": src //缩略图地址\n\n        });\n        $imgView.find(\'img\').on(\'click\', function (event) {\n          event.preventDefault();\n          photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n          if (window.layer) {\n            layer.photos({\n              photos: photos,\n              shift: 5,\n              full: 1,\n              fullscreen: 1,\n              fulltools: 1,\n              shadeClose: config.properties.previewShadeClose\n            });\n          } else {\n            alert(\'图片预览需要加载layer\');\n          }\n        });\n      }\n    }\n\n    div.attr("data-filename", fileName);\n    var save = div.find(".wf-saveBtn");\n    save.hide();\n    save.click(function () {\n      if (editor.get(0).checkEdit() == 1) {\n        editor.get(0).save();\n      } else {\n        alert("未修改");\n      }\n    });\n    tempFileId = input.val() + Math.floor(Math.random() * 1000000);\n    var editBtn = div.find(".wf-editBtn");\n    editBtn.hide();\n    editBtn.click(function () {\n      //var downUrl = __httpHost + __contextPath +"/downloadfile/"+ input.val();\n      //var saveUrl = __httpHost + __basePath + \'workflow/updateFile.jsp?fileName=\' + input.val();\n\n      /*editor.get(0).open(downUrl, saveUrl);\n      save.show();*/\n      var dWidth = document.documentElement.clientWidth;\n      var dHeight = document.documentElement.clientHeight + 20;\n\n      if (dWidth > 1400) {\n        dWidth = 1400;\n      }\n\n      if (dHeight > 650) {\n        dHeight = 650;\n      }\n\n      var url = __basePath + "ioffice/editor.jsp?fileId=" + input.val() + "&mEditType=1,1&tempFileId=" + tempFileId;\n\n      if (window.showModalDialog) {\n        window.showModalDialog(url, window, "dialogWidth=" + dWidth + "px;dialogHeight=" + dHeight + "px;resizable=yes;scroll=no"); //window.open(url, "_blank", \'width=\'+document.documentElement.clientWidth+\'px,height=\'+document.documentElement.clientHeight+20+\'px,top=0,resizable=yes\');\n      } else {\n        window.open(url, "_blank", \'height=1000, width=800, resizable=yes\');\n      }\n    });\n\n    if (!isPic) {\n      view.click(function () {\n        var parame = "";\n\n        if (SUI.Util.browserPlantform() == "ios") {\n          parame = "?filename=uuid";\n        } else if (SUI.Util.browserPlantform() == "android") {\n          parame = "?" + config.appStoreLoginParam;\n        }\n\n        if (!config.onLinePreview) {\n          var p_url = \'\';\n\n          if (isNowUpload) {\n            p_url = url + parame;\n          } else {\n            p_url = SUI.settings().uploadify().downloadPath + input.val() + parame;\n          }\n\n          view.attr({\n            // "href": SUI.settings().uploadify().downloadPath + input.val() + parame,\n            "href": p_url,\n            "target": "_blank"\n          });\n        } // else {\n        //     view.attr({\n        //         "onclick": open(fileKey, extend2, fileName,fileKey,photos,config,url,isNowUpload,compress)\n        //     });\n        //\n        // }\n\n\n        view.attr({\n          "onclick": open(fileKey, extend2, fileName, fileKey, photos, config, url, isNowUpload, compress)\n        });\n      });\n    }\n\n    var delBtn = div.find(".wf-delete");\n    delBtn.hide();\n    delBtn.click(function () {\n      layer.confirm("是否确认删除？", {\n        icon: 3,\n        title: \'提示\'\n      }, function () {\n        deleteFileItem(div, fileKey);\n        layer.closeAll(\'dialog\');\n      });\n    });\n\n    if (uploadDo.canEdit) {\n      editBtn.show();\n    }\n\n    if (uploadDo.canDelete) {\n      delBtn.show();\n    } //查看原图\n\n\n    var lookBtn = div.find(\'.wf-lookPhoto\');\n    lookBtn.hide();\n\n    if (isMobile && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n      lookBtn.show();\n    } else {\n      if (compress == \'1\' || compress == \'2\') {\n        lookBtn.show();\n      }\n    }\n\n    lookBtn.click(function () {\n      event.preventDefault();\n      var pid = "img-" + Number(new Date());\n      var src = \'\';\n\n      if (isNowUpload) {\n        src = url;\n      } else {\n        src = SUI.settings().uploadify().downloadPath + input.val();\n      }\n\n      src += \'?isCompress=false\';\n      photos.data.push({\n        "alt": alt,\n        \'fileKey\': fileKey,\n        "pid": pid,\n        //图片id\n        "src": src,\n        //原图地址\n        "thumb": src //缩略图地址\n\n      });\n      photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n      if (window.layer) {\n        layer.photos({\n          photos: photos,\n          shift: 5,\n          full: 1,\n          fullscreen: 1,\n          fulltools: 1,\n          shadeClose: config.properties.previewShadeClose\n        });\n      } else {\n        alert(\'图片预览需要加载layer\');\n      }\n    });\n    var mode = SUI.Util.getQueryString(\'mode\');\n\n    if (mode == \'print\') {\n      div.find(\'span\').css(\'display\', \'none\');\n    }\n\n    return div;\n  }\n\n  function open(fileId, extend2, fileName, fileKey, photos, config, url, isNowUpload, compress) {\n    var type = fileName.substring(fileName.lastIndexOf("."), fileName.length);\n\n    if (extend2) {\n      layer.open({\n        title: \'提示\',\n        content: "是否下载此文件",\n        //        \t\t\tarea: [\'160px\', \'160px\'],\n        btn: [\'打开\', \'下载\', \'取消\'],\n        btn1: function btn1(index, layero) {\n          layer.close(index);\n\n          if (".pdf" == type || ".doc" == type || ".docx" == type) {\n            var myhref = __basePath + "pdf/pdfRead.jsp?key=" + extend2 + "&needBack=1";\n            index = layer.open({\n              type: 2,\n              title: "在线阅览",\n              shadeClose: false,\n              maxmin: true,\n              shade: 0.6,\n              area: [Number(600) + 50 + "px", 400 + "px"],\n              scrollbar: true,\n              closeBtn: 1,\n              content: myhref + \'&appload=0&f=g\',\n              //iframe的url\n              success: function success(index, layero) {\n                $(index).find(\'.layui-layer-title\').show();\n                $(index).find(\'.layui-layer-setwin\').show();\n                $(".layui-layer-max").trigger("click");\n              }\n            });\n          } else {\n            var src = \'\';\n\n            if (isNowUpload) {\n              src = url;\n            } else {\n              src = SUI.settings().uploadify().downloadPath + fileId;\n            }\n\n            src += \'?isCompress=false\';\n            var alt = fileName.split(".")[0],\n                pid = "img-" + Number(new Date());\n            photos.data.push({\n              "alt": alt,\n              \'fileKey\': fileId,\n              //fileKey,\n              "pid": pid,\n              //图片id\n              "src": src,\n              //原图地址\n              "thumb": src //缩略图地址\n\n            });\n            photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n            if (window.layer) {\n              layer.photos({\n                photos: photos,\n                shift: 5,\n                full: 1,\n                fullscreen: 1,\n                fulltools: 1,\n                shadeClose: config.properties.previewShadeClose\n              });\n            } else {\n              alert(\'图片预览需要加载layer\');\n            } // layer.open({\n            //     type: 2,\n            //     title: "查看图片",\n            //     maxmin: true,\n            //     shade: 0.6,\n            //     area: [800 + "px", 600 + "px"],\n            //     scrollbar: true,\n            //     closeBtn: 1,\n            //     content: __basePath + "pictureviewer/showImg.jsp?key=" + extend2, //iframe的url，替换\n            //     success: function (layero, index) {\n            //         $(".layui-layer-max", layero).trigger("click");\n            //     }\n            // });\n\n\n            layer.close(index);\n          }\n        },\n        btn2: function btn2(index, layero) {\n          // window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n          if (isNowUpload) {\n            url = url;\n          } else {\n            url = SUI.settings().uploadify().downloadPath + fileId;\n          }\n\n          if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n            url += \'?isCompress=false\';\n          }\n\n          window.location.href = url;\n          layer.close(index);\n        }\n      });\n    } else {\n      var isMobile = SUI.Util.browserType() === \'phone\';\n\n      if (isMobile) {\n        layer.open({\n          title: \'提示\',\n          content: "是否下载此文件",\n          btn: [\'下载\', \'取消\'],\n          btn1: function btn1(index, layero) {\n            // window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n            if (isNowUpload) {\n              url = url;\n            } else {\n              url = SUI.settings().uploadify().downloadPath + fileId;\n            }\n\n            if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n              url += \'?isCompress=false\';\n            }\n\n            window.location.href = url;\n            layer.close(index);\n          }\n        });\n      } else {\n        if (isNowUpload) {\n          url = url;\n        } else {\n          url = SUI.settings().uploadify().downloadPath + fileId;\n        }\n\n        if (/\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(type)) {\n          url += \'?isCompress=false\';\n        }\n\n        window.location.href = url;\n      }\n    }\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/NewFileUpload/NewFileUpload.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Number/Number.js":
/*!*********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Number/Number.js ***!
  \*********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return number; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:40 PM\n */\n\n/***\n *** number 数字\n ***/\nfunction number(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value,\n      sep = " - ";\n  dom.zoo = this;\n  var $input, $tpl;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    var that = this;\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    var parseData = config;\n\n    var require = parseData.validate && parseData.validate.require ? \'<span class="text-red">*</span>\' : \'\';\n\n    var title = parseData.properties.title || "";\n    var name = parseData.properties.name || "";\n    value = parseData.value;\n    var template = \'<div class="input-group text-center">\' + \'<span class="input-group-addon sui-number-minus"><i class="fa fa-minus-circle"></i></span>\' + \'<input name="\' + name + \'" type="text" class="form-control text-center value-number" value="\' + value + \'" />\' + \'<span class="input-group-addon sui-number-plus"><i class="fa fa-plus-circle"></i></span>\' + \'</div>\';\n    var template_phone = \'<div class="input-group text-center pos-phone">\' + \'<span class="input-group-addon "><span class="sui-number-minus-phone"></span></span>\' + \'<div class="value-number number_phone">0</div>\' + \'<span class="input-group-addon "><span class="sui-number-plus-phone"></span></span>\' + \'</div>\';\n    var $html = \'\';\n\n    if (SUI.Util.browserType() === \'phone\' && wf2.isNewInPhone) {\n      $html = $(template_phone);\n    } else {\n      $html = $(template);\n    }\n\n    $(dom).html($html);\n    $input = $(".value-number", dom);\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      $html.hide();\n      $tpl = $(\'<div class="value-text" />\');\n      $tpl.html(\'<span class="value">\' + value + \'</span>\');\n      $input.attr("readOnly", "readOnly");\n      $(dom).addClass(\'form-readOnly\').append($tpl);\n    }\n\n    if (mode == "editable") {\n      $input.removeAttr("readOnly");\n      $(dom).removeClass(\'form-readOnly\');\n      $(".sui-number-minus,.sui-number-minus-phone", dom).on(\'click\', function () {\n        that.minus();\n      });\n      $(".sui-number-plus,.sui-number-plus-phone", dom).on(\'click\', function () {\n        that.plus();\n      });\n      SUI.Util.poptip(parseData.inputTip, dom, $input);\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    if (SUI.Util.browserType() === \'phone\' && wf2.isNewInPhone) {\n      return $input.text();\n    } else {\n      return $input.val();\n    }\n  };\n\n  this.fixValue = function (val) {\n    var _value = val || 0;\n\n    var fix = String(config.increment).split(".");\n\n    if (fix[1]) {\n      _value = Number(_value.toFixed(fix[1].length));\n    }\n\n    if (config.validate) {\n      if (typeof config.validate.maxNum === "number" && _value > config.validate.maxNum) return value;\n      if (typeof config.validate.minNum === "number" && _value < config.validate.minNum) return value;\n    }\n\n    return _value;\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n\n    var _val = this.fixValue(val);\n\n    if (_val == value) return;\n    value = val;\n\n    if (SUI.Util.browserType() === \'phone\' && wf2.isNewInPhone) {\n      if (isValidate) {\n        $input.text(value);\n      } else {\n        $input.text(value).trigger(\'change\');\n      }\n    } else {\n      if (isValidate) {\n        $input.val(value);\n      } else {\n        $input.val(value).trigger(\'change\');\n      }\n    }\n\n    $tpl && $(".value", $tpl).html(value);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.minus = function () {\n    value = this.getValue();\n    var val = value - config.increment;\n    this.setValue(val);\n  };\n\n  this.plus = function () {\n    value = this.getValue();\n    var val = (Number(value) || 0) + Number(config.increment);\n    this.setValue(val);\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr("mode"),\n      validate: SUI.Util.parseJSON($(el).attr("validate"), true),\n      properties: {\n        title: $(el).attr("title"),\n        name: $(el).attr("name")\n      },\n      value: Number($(el).attr("value") || "0"),\n      format: $(el).attr("format") || "int",\n      increment: Number($(el).attr("increment") || "1"),\n      inputTip: $(el).attr("inputTip") || ""\n    };\n    _data.validate = _data.validate || {};\n    if (!_data.validate.format) _data.validate.format = _data.format;\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Number/Number.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Primary/Primary.js":
/*!***********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Primary/Primary.js ***!
  \***********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Primary; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:20 AM\n */\n\n/**\n *  文本-重要\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Primary(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Primary/Primary.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Rating/Rating.js":
/*!*********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Rating/Rating.js ***!
  \*********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Rating; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 4:05 PM\n */\n\n/**\n ** Rating 评分控件\n **/\nfunction Rating(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value;\n  dom.zoo = this;\n  var $input, $starsBar;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n\n    var require = config.validate && config.validate.require ? \'<span class="text-red">*</span>\' : \'\';\n\n    var width = config.value * 100 / config.fullScore + "%";\n    $starsBar = $(\'<div class="stars-bar stars-phone stars-\' + config.starStyle + \'"  />\');\n    var $stars = $(\'<div class="stars" />\').css({\n      width: width\n    });\n\n    var _value = config.ratingValue ? config.value : _star(config.value);\n\n    $starsBar.html($stars);\n\n    if (SUI.Util.browserType() === \'phone\' && wf2.isNewInPhone) {\n      var $right = $(\'<div class="pos-right"></div>\');\n      $right.html($starsBar);\n      $(dom).html($right);\n\n      if (config.ratingText) {\n        $(dom).find(\'.pos-right\').append(\'<div class="point-phone"><span class="stars-text" >\' + _value + \'</span><span class="rating-text">(\' + config.ratingText + \')</span></div>\');\n      }\n    } else {\n      $(dom).html($starsBar);\n\n      if (config.ratingText) {\n        $(dom).append(\'<span class="stars-text" >\' + _value + \'</span><span class="rating-text">(\' + config.ratingText + \')</span>\');\n      }\n    }\n\n    $input = $(\'<input type="hidden" name="\' + this.name + \'" value="\' + config.value + \'" />\');\n    $(dom).prepend($input);\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      if (SUI.Util.getQueryString(\'mode\') === \'print\') {\n        $(\'.stars-bar\', dom).css(\'display\', \'none\');\n      } else {\n        $input.attr("readOnly", "readOnly");\n        $(dom).addClass(\'form-readOnly\');\n      }\n    }\n\n    if (mode == "editable") {\n      $input.removeAttr("readOnly");\n      $(dom).removeClass(\'form-readOnly\');\n\n      _rating.call(this, $starsBar[0]);\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    return $input.val();\n  };\n\n  this.setValue = function (val, isValidate) {\n    var isValidate = isValidate || false;\n    value = val || 0;\n\n    if (isValidate) {\n      $input.val(value);\n    } else {\n      $input.val(value).trigger(\'change\');\n    }\n\n    render(value);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function render(value) {\n    $(".stars-bar", dom).children().width(value * 100 / config.fullScore + "%");\n    var val = config.ratingValue ? value : _star(value);\n    $(".stars-text", dom).html(val);\n  }\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr("mode"),\n      validate: SUI.Util.parseJSON($(el).attr("validate"), true),\n      properties: {\n        title: $(el).attr("title"),\n        name: $(el).attr("name")\n      },\n      value: Number($(el).attr("value") || "0"),\n      fullScore: Number($(el).attr("fullScore") || "5"),\n      starStyle: $(el).attr("starStyle") || "lg",\n      ratingText: $(el).attr("ratingText") || "",\n      allowHalf: $(el).attr("allowHalf") === "true",\n      ratingValue: $(el).attr("ratingValue") === "true"\n    };\n    return _data;\n  }\n\n  function _rating(el) {\n    var that = this;\n    $(el).on("click", function (event) {\n      var left = $(this).offset().left;\n      var width = $(this).width();\n      var delta = event.pageX - left;\n\n      if (delta < 0) {\n        delta = 0;\n      }\n\n      if (delta > width) delta = width;\n      var score = 5 * delta / width;\n\n      if (config.allowHalf) {\n        var stars = Math.round(score);\n\n        if (score > stars) {\n          stars += 0.5;\n        }\n      } else {\n        var stars = Math.ceil(score);\n      }\n\n      that.setValue(_value(stars));\n    });\n  }\n\n  function _star(value) {\n    if (!value) return 0;\n    var star = Number(value * 5 / config.fullScore).toFixed(1);\n\n    if (star - Math.round(star) === 0) {\n      star = Math.round(star);\n    }\n\n    return star;\n  }\n\n  function _value(star) {\n    return star * config.fullScore / 5;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Rating/Rating.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Select/Select.js":
/*!*********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Select/Select.js ***!
  \*********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Select; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 3:12 PM\n */\n\n/**\n ** select组件\n */\nfunction Select(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config = {},\n      value;\n  dom.zoo = this;\n  var _Validate = false;\n  $(dom).addClass('form-select');\n  var $select, $radio;\n\n  this.init = function (val) {\n    config = val;\n\n    if (val.properties.dataUrl && typeof $.fn.loadSelectRemoteData === 'function' && !val.cascade.linkSource) {\n      this.name = val.properties.name;\n      $(document).on('contextDone', function () {\n        $(dom).loadSelectRemoteData(val);\n      }); // $(dom).loadSelectRemoteData(val)\n    } else if (typeof $.fn.loadStaticCascadeData === 'function' && val.cascade.cascadeData) {\n      this.name = val.properties.name;\n      $(dom).loadStaticCascadeData(val, false);\n    } else this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getValue = function () {\n    if (this.selectStyle == \"select\") {\n      var _filterValue = $select.val() || '';\n\n      if (_filterValue == '$noValue$') {\n        _filterValue = '';\n      }\n\n      return _filterValue;\n    } else if (this.selectStyle == \"radio\") {\n      return $radio.filter(\":checked\").val();\n    }\n  };\n\n  this.setValue = function (val, isValidate) {\n    value = val;\n    config.value = value;\n    var isValidate = isValidate || false;\n    _Validate = isValidate;\n\n    if (typeof val == \"number\") {\n      val = val + \"\";\n    }\n\n    if (this.selectStyle == \"select\") {\n      if (isValidate) {\n        $select.val(val).trigger('change');\n      } else {\n        $select.val(val).trigger('change');\n      }\n\n      var _value = $select.find('[value=\"' + val + '\"]').text();\n\n      var mode = config.mode || 'view';\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        if (val == '$noValue$') {\n          _value = '';\n        }\n\n        $(dom).find('span.value').html(_value);\n      }\n    } else if (this.selectStyle == \"radio\") {\n      // 修改重置无效的bug，当设置值与所有radio不匹配时，都不选中\n      var $radios = $radio.filter(\"[value='\" + val + \"']\");\n\n      if ($radios.length > 0) {\n        $radios.iCheck(\"check\").trigger('change');\n      } else {\n        $radio.iCheck(\"uncheck\").trigger('change');\n      }\n\n      if (SUI.Util.getQueryString(\"mode\") === 'print') {\n        if (value == config.properties.customValue) {\n          $(dom).find('.radio-group').find('label').each(function (i, v) {\n            if ($(v).text() != config.properties.customName) {\n              $(v).hide();\n            } else {\n              $(v).find('div').hide();\n            }\n          });\n        } else {\n          var _value = $('[value=\"' + val + '\"]', dom).parents('label').text();\n\n          $(dom).find('.radio-group').html(_value);\n        }\n      }\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    value = config.value || value;\n\n    var _this = this;\n\n    var require = config.validate && config.validate.require ? '<span class=\"text-red\">*</span>' : '';\n\n    var title = config.properties.title || \"\";\n    var name = config.properties.name || \"\";\n    var custom = config.properties.custom;\n    var customName = config.properties.customName;\n    var customField = config.properties.customField;\n    var componentField = config.properties.componentField;\n    var customValue = config.properties.customValue;\n    var muiltLine = config.properties.muiltLine;\n    var validate = config.properties.inputValidate;\n    var maxlength = config.properties.maxlength;\n    var placeholderInput = config.properties.placeholderInput;\n    var otherSelect = {\n      name: config.properties.customName,\n      value: config.properties.customValue\n    };\n    var isSearch = config.properties.isSearch;\n    var isSelectOption = config.properties.isSelectOption;\n    var isDefaultFirst = config.properties.isDefaultFirst;\n    var mode = config.mode || 'view';\n    var datamethod = config.datamethod || \"static\";\n    this.selectStyle = config.properties.selectStyle;\n\n    if (this.selectStyle == \"select\") {\n      var listOptions = '';\n\n      if (custom !== 'false' && customName != \"\" && customName != null && customName != \"underfined\") {\n        var arr = Array;\n        arr = $.extend(true, [], config.properties.dataSource);\n        var isRepeat = false;\n\n        if (arr && arr.length) {\n          $.each(arr, function (a, data) {\n            if (data.value === otherSelect.value) {\n              isRepeat = true;\n            }\n          });\n        }\n\n        if (!isRepeat) {\n          arr.push(otherSelect);\n        }\n\n        listOptions = render(arr, this.selectStyle, this.name);\n      } else {\n        listOptions = render(config.properties.dataSource, this.selectStyle, this.name);\n      }\n\n      var template = '<select name=\"' + name + '\" id=\"select_' + name + '\" class=\"form-control\" style=\"width: 100%;\">' + listOptions + '</select>';\n\n      if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n        template += '<span class=\"org-arrow\"></span>';\n      }\n\n      if ($(dom).find('select').length > 0) {\n        $(dom).html(template);\n\n        if (custom == 'otherinput') {\n          var customSelect = \"\";\n\n          if (mode == 'editable') {\n            if (muiltLine === 'true') {\n              customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n            } else {\n              customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n            }\n          } else {\n            if (muiltLine === 'true') {\n              customSelect = '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\"></div>';\n            } else {\n              customSelect = '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" maxlength=\"' + maxlength + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" style=\"margin-top: 5px;display: none;\"></div>';\n            }\n          }\n\n          $(dom).append(customSelect);\n        }\n      } else {\n        $(dom).prepend(template);\n      }\n\n      SUI.init($.noop, $(dom));\n      $select = $(\"select\", dom);\n      var mode = config.mode || 'view';\n\n      if (mode == \"editable\") {\n        $select.removeAttr(\"disabled\");\n        $(dom).removeClass('form-readOnly');\n      }\n\n      if (mode == \"hide\") {\n        $(dom).hide();\n      }\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        $(dom).find('.org-arrow').remove();\n        $select.attr(\"disabled\", \"disabled\").hide();\n        $(dom).addClass('form-readOnly');\n\n        var _value = render(config.properties.dataSource, this.selectStyle, this.name, true);\n\n        if (_value === '$noValue$') {\n          _value = '';\n        }\n\n        $(dom).prepend('<div class=\"value-text\"> <span class=\"value\" id=\"value_' + name + '\">' + _value + '</span> </div>');\n      } else {\n        if (SUI.Util.browserType() != 'phone') {\n          var select2Config = $.extend(true, {\n            minimumResultsForSearch: -1\n          }, config.select2 || {});\n\n          if (isSearch == 'true') {\n            delete select2Config['minimumResultsForSearch'];\n          }\n\n          $select.select2(select2Config); // 如果没有默认选择项 并且配置了不默认选择首个 则置空\n\n          if ((!value || value == '$noValue$') && isDefaultFirst == 'false') {\n            $(dom).sui().setValue('$noValue$', false);\n          }\n        }\n\n        if (isSelectOption != 'true') {\n          $(dom).trigger('change');\n        }\n      }\n\n      if ($('.sui-input', dom).length > 0) {\n        var selectInputConfig = $('.sui-input', dom).sui().getConfig();\n      }\n\n      if (custom == 'otherinput') {\n        var sv = $select.val();\n\n        if (sv == customValue) {\n          $(dom).find('.show-custom').css('display', '');\n        } else {\n          $(dom).find('.show-custom').css('display', 'none');\n        }\n\n        $select.on('change', function () {\n          var sv = $select.val();\n          var selectInputConfig;\n          var writevalue = '';\n\n          if ($('.sui-input', dom).length > 0) {\n            writevalue = $('.sui-input', dom).sui().getValue();\n            selectInputConfig = $('.sui-input', dom).sui().getConfig();\n          }\n\n          if (sv == customValue) {\n            $(dom).find('.show-custom').css('display', '');\n            $(dom).find('.show-custom').attr('validate', validate); // if (mode === 'readOnly' || mode === 'view') {\n            //     $(dom).find('.value-text').css('display', 'none');\n            // }\n            // if ( (mode === 'readOnly' || mode === 'view') && SUI.Util.getQueryString(\"mode\") === 'print' ) {\n            //     $(dom).find('.value-text').css('display', 'none');\n            // }\n\n            if ($('.sui-input', dom)) {\n              selectInputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n            }\n          } else {\n            $(dom).find('.show-custom').css('display', 'none');\n            $(dom).find('.show-custom').attr('validate', '{\"require\": false}');\n\n            if ($('.sui-input', dom) > 0) {\n              selectInputConfig.validate = {\n                \"require\": false\n              };\n            }\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            selectInputConfig.value = writevalue;\n            $(dom).find('.show-custom').sui().setConfig(selectInputConfig);\n          }\n        });\n      } else if (custom == 'othercomponent') {\n        $select.on('change', function () {\n          var sv = $select.val();\n\n          if (sv == customValue) {\n            $(\"div[name=\" + config.properties.componentField + \"]\").show();\n          } else {\n            $(\"div[name=\" + config.properties.componentField + \"]\").hide();\n          }\n        });\n      }\n    }\n\n    if (this.selectStyle == \"radio\") {\n      var listOptions = '';\n\n      if (custom !== 'false' && customName != \"\" && customName != null && customName != \"underfined\") {\n        var arr = [];\n        arr = $.extend(true, [], config.properties.dataSource);\n        var isRepeat = false;\n\n        if (arr && arr.length) {\n          $.each(arr, function (a, data) {\n            if (data.value === otherSelect.value) {\n              isRepeat = true;\n            }\n          });\n        }\n\n        if (!isRepeat) {\n          arr.push(otherSelect);\n        }\n\n        listOptions = render(arr, this.selectStyle, this.name);\n      } else {\n        listOptions = render(config.properties.dataSource, this.selectStyle, this.name);\n      }\n\n      var template = '<div class=\"radio-group\">' + listOptions + '</div>';\n      $(dom).html(template);\n      SUI.init($.noop, $(dom));\n      $radio = $(\"input[name=\" + this.name + \"]\", dom);\n      var mode = config.mode || 'view';\n\n      if (mode == \"readOnly\" || mode == \"view\") {\n        $radio.attr(\"disabled\", \"disabled\");\n        $(dom).addClass('form-readOnly');\n      }\n\n      if (mode == \"editable\") {\n        $radio.removeAttr(\"disabled\").on('ifChecked', function (event) {\n          event.preventDefault();\n          $(dom).trigger('change');\n        });\n        $(dom).removeClass('form-readOnly'); //增加单选按钮小tips\n\n        if (config.properties.optionTip) {\n          if (config.properties.radioTips.length > 0) {\n            if (config.properties.optionTip == 'auto') {\n              // 文本提示\n              setTimeout(function () {\n                if ($('.sui-text').length > 0 && $('#' + config.properties.textId).length > 0) {\n                  $('#' + config.properties.textId).sui().showContent(config.properties.radioTips[0] || \"\");\n                }\n              }, 100);\n              $(dom).on('change', function () {\n                var checkIndex = $('label input:checked', $(dom)).closest('label').index();\n                setTimeout(function () {\n                  if ($('.sui-text').length > 0 && $('#' + config.properties.textId).length > 0) {\n                    $('#' + config.properties.textId).sui().showContent(config.properties.radioTips[checkIndex] || \"\");\n                  }\n                }, 100);\n              });\n            } else {\n              // 气泡提示\n              var index = null;\n              $(dom).find('.radio-group label').on('mouseover', function () {\n                var that = this;\n                var tipshtml = '<span style=\"color:#333;font-size:14px;\">' + (config.properties.radioTips[$(this).index()] || \"\") + '</span>';\n                index = layer.tips(tipshtml, that, {\n                  tips: [3, '#fff']\n                }); // $('.popover').remove();\n                // $(this).popover({\n                //     html: true,\n                //     content: config.properties.radioTips[$(this).index()],\n                //     trigger: \"manual\",\n                //     placement: \"bottom\",\n                //     template: SUI.Util.popTpl.inp\n                // });\n                // $(this).popover(\"show\");\n              }).on('mouseleave', function () {\n                layer.close(index); // $(this).popover(\"hide\");\n              });\n            }\n          }\n        }\n      }\n\n      if (mode == \"hide\") {\n        $(dom).hide();\n      }\n\n      $radio.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      })); //如果有输入框 控制输入框\n\n      var inputConfig = null;\n      var writevalue = '';\n\n      if ($('.sui-input', dom).length > 0) {\n        writevalue = $('.sui-input', dom).sui().getValue();\n        inputConfig = $('.sui-input', dom).sui().getConfig();\n      }\n\n      if (custom == 'otherinput') {\n        // 修改对齐方式\n        if (mode === 'readOnly' || SUI.Util.getQueryString('mode') === 'print') {\n          $(dom).find('.show-custom').css('vertical-align', 'baseline');\n        }\n\n        if ($radio.filter(\":checked\").val() == customValue) {\n          $(dom).find('.show-custom').css('display', 'inline-block');\n          $(dom).find('.show-custom').attr('validate', validate); // if (mode === 'readOnly' || mode === 'view') {\n          //     $(dom).find('.radio-group label').css('display', 'none');\n          // }\n          // if (SUI.Util.getQueryString('mode') === 'print' && mode === 'readOnly') {\n          //     $(dom).find('.radio-group label').css('display', 'none');\n          // }\n\n          if ($('.sui-input', dom).length > 0) {\n            inputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n          }\n        } else {\n          $('.tooltip').hide();\n          $(dom).find('.show-custom').css('display', 'none');\n          $(dom).find('.show-custom').attr('validate', '{\"require\": false}'); // if (SUI.Util.getQueryString('mode') === 'print'  && mode === 'readOnly') {\n          //     $('.sui-select .radio-group').html(this.getValue());\n          // }\n\n          if ($('.sui-input', dom).length > 0) {\n            inputConfig.validate = {\n              \"require\": false\n            };\n          }\n        }\n\n        $radio.on('ifChanged', function () {\n          if ($radio.filter(\":checked\").val() == customValue) {\n            $(dom).find('.show-custom').css('display', 'inline-block');\n            $(dom).find('.show-custom').attr('validate', validate); // if (mode === 'readOnly' || mode === 'view') {\n            //     $(dom).find('.radio-group label').css('display', 'none');\n            // }\n            // if ( (mode === 'readOnly' || mode === 'view') && SUI.Util.getQueryString('mode') === 'print') {\n            //     $(dom).find('.radio-group label').css('display', 'none');\n            // }\n\n            if ($('.sui-input', dom).length > 0) {\n              inputConfig.validate = JSON.parse(validate.replace(/\\'/g, '\"'));\n            }\n          } else {\n            $('.tooltip').hide();\n            $(dom).find('.show-custom').css('display', 'none');\n            $(dom).find('.show-custom').attr('validate', '{\"require\": false}');\n\n            if ($('.sui-input', dom).length > 0) {\n              inputConfig.validate = {\n                \"require\": false\n              };\n            }\n          }\n\n          if ($('.sui-input', dom).length > 0) {\n            inputConfig.value = writevalue;\n            $(dom).find('.show-custom').sui().setConfig(inputConfig);\n          }\n        });\n      } else if (custom == 'othercomponent') {\n        $radio.on('ifChanged', function () {\n          if ($radio.filter(\":checked\").val() == customValue) {\n            $(\"div[name=\" + config.properties.componentField + \"]\").show();\n          } else {\n            $(\"div[name=\" + config.properties.componentField + \"]\").hide();\n          }\n        });\n      }\n    }\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n\n    if (value == '$noValue$') {\n      value = '';\n    }\n\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  function getDataSource(element) {\n    var el = element || bind;\n\n    var _source = $(dom).attr(\"dataSource\");\n\n    return SUI.Util.parseJSON(_source || '[]', true);\n  }\n\n  function render(data, selectStyle, name, getValue) {\n    var html = \"\";\n    var custom = config.properties.custom;\n    var customName = config.properties.customName;\n    var customField = config.properties.customField;\n    var componentField = config.properties.componentField;\n    var muiltLine = config.properties.muiltLine;\n    var validate = config.properties.inputValidate;\n    var mode = config.mode || 'view';\n    var maxlength = '';\n    var isMultValue = config.properties.isMultValue;\n    var isSelectOption = config.properties.isSelectOption;\n    var isDefaultFirst = config.properties.isDefaultFirst;\n    var placeholderInput = config.properties.placeholderInput;\n\n    if (config.properties.maxlength) {\n      maxlength = ' maxlength=\"' + config.properties.maxlength + '\"';\n    }\n\n    if (!data) return html;\n\n    var _value = value || '';\n\n    if (isSelectOption == 'true' && selectStyle == 'select') {\n      html += '<option value=\"$noValue$\" selected>请选择</option>';\n    }\n\n    $.each(data, function (i, _v) {\n      var v = $.isPlainObject(_v) ? _v : {\n        value: _v,\n        name: _v\n      };\n      var checked = v.value == value;\n\n      if (selectStyle === \"radio\") {\n        var id = SUI.Util.getSequence(\"select\");\n        var radio_index = name + SUI.Util.getSequence(\"select\");\n        id = \"sui-select-\" + name + id;\n\n        if (isMultValue == 'true' && v.value instanceof Object) {\n          v.value = JSON.stringify(v.value).replace(/\\\"/g, '\\'');\n        }\n\n        html += '<label for=\"' + id + '\" id=\"radio_' + radio_index + '\"><input id=\"' + id + '\"' + (checked ? \" checked\" : \"\") + ' type=\"radio\" name=\"' + name + '\" value=\"' + v.value + '\" />' + v.name + '</label>';\n\n        if (custom !== 'false') {\n          if (i === data.length - 1) {\n            if (mode == 'editable') {\n              if (muiltLine === 'true') {\n                html += '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" validate = {\"require\":false} ' + maxlength + ' style=\"display: none;\"></div>';\n              } else {\n                html += '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" validate = {\"require\":false} ' + maxlength + ' style=\"display: none;\"></div>';\n              }\n            } else {\n              if (muiltLine === 'true') {\n                html += '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"display: none;\"></div>';\n              } else {\n                html += '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"display: none;\"></div>';\n              }\n            }\n          }\n        }\n      } else {\n        if (isMultValue == 'true' && v.value instanceof Object) {\n          v.value = JSON.stringify(v.value).replace(/\\\"/g, '\\'');\n          checked = v.value == value;\n        }\n\n        if (isSelectOption == 'true') {\n          html += '<option value=\"' + v.value + '\">' + v.name + '</option>';\n        } else {\n          html += '<option' + (checked ? \" selected\" : \"\") + ' value=\"' + v.value + '\">' + v.name + '</option>';\n        }\n\n        if (custom !== 'false') {\n          if (i === data.length - 1) {\n            if (mode == 'editable') {\n              if (muiltLine === 'true') {\n                var customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n              } else {\n                var customSelect = '<div mode=\"editable\" placeholder=\"' + placeholderInput + '\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\" validate = {\"require\":false}></div>';\n              }\n            } else {\n              if (muiltLine === 'true') {\n                var customSelect = '<div mode=\"readOnly\" inputtype=\"textarea\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\" ' + maxlength + ' style=\"margin-top: 5px;display: none;\"></div>';\n              } else {\n                var customSelect = '<div mode=\"readOnly\" inputtype=\"text\" name=\"' + customField + '\" mspplus-field=\"true\" class=\"sui-input show-custom\"  ' + maxlength + ' style=\"margin-top: 5px;display: none;\"></div>';\n              }\n            }\n\n            if ($(dom).find('select').length < 1) {\n              $(dom).append(customSelect);\n            }\n          }\n        }\n\n        if (getValue && checked) {\n          _value = v.name;\n          return false;\n        }\n      }\n    });\n\n    if (selectStyle != 'radio') {\n      // 移动端部分手机会把optgroup默认看成一个选项 导致显示效果不好看所以移动端禁止掉\n      if (SUI.Util.browserType() != 'phone') {\n        html = '<optgroup>' + html + '</optgroup>';\n      }\n    }\n\n    if (getValue) {\n      return _value; // 返回显示的值\n    }\n\n    return html;\n  }\n\n  function _parseData(element) {\n    var el = element || bind; // 属性字符串转换两次（数组字符串如\"'[\\'选项1\\',\\'选项2\\']'\" 转一次还是字符串）\n\n    var radioTips = $(el).attr('radioTips') ? SUI.Util.parseJSON($(el).attr('radioTips'), true) : [];\n\n    try {\n      radioTips = SUI.Util.parseJSON(radioTips, true);\n    } catch (err) {}\n\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\"),\n        dataSource: getDataSource(el),\n        selectStyle: $(el).attr(\"selectStyle\") || \"select\",\n        //select | radio\n        checkStyle: $(dom).attr('checkStyle'),\n        checkColor: $(dom).attr('checkColor'),\n        //add radio tips\n        radioTips: radioTips,\n\n        /*ajax*/\n        idField: $(el).attr('idField') || 'id',\n        textField: $(el).attr('textField') || 'text',\n        dataSrc: $(el).attr('dataSrc') || '',\n        dataUrl: $(el).attr('dataUrl') || '',\n        entityType: $(el).attr('entityType') || '',\n        reqParams: $(el).attr('reqParams') ? SUI.Util.parseJSON($(el).attr(\"reqParams\"), true) : '',\n        method: $(el).attr('method') || 'post',\n        optionTip: $(el).attr('optionTip') || '',\n        custom: $(el).attr('custom') || 'false',\n        textId: $(el).attr('textId') || '',\n        customName: $(el).attr('customName') || '',\n        customValue: $(el).attr('customValue'),\n        customField: $(el).attr('customField'),\n        // 其他组件字段\n        componentField: $(el).attr('componentField'),\n        // 输入框的多行与验证\n        muiltLine: $(el).attr('muiltline'),\n        inputValidate: $(el).attr('inputValidate'),\n        maxlength: Number($(el).attr(\"maxlength\") || \"0\"),\n        //限制最大字数\n        isMultValue: $(el).attr('ismultvalue') || 'false',\n        //是否允许多值\n        isSelectOption: $(el).attr('isselectoption') || 'false',\n        //是否出现请选择下拉\n        isSearch: $(el).attr('issearch') || 'false',\n        //是否可以搜索\n        isDefaultFirst: $(el).attr('isdefaultfirst') == 'false' ? 'false' : 'true',\n        placeholderInput: $(el).attr('placeholderinput') || '',\n        keepstyleonphone: $(el).attr('keepstyleonphone') || 'false' //在移动端重构时是否保持设置的样式 默认全部改为select\n\n      },\n      value: $(el).attr(\"value\") || \"\",\n      select2: SUI.Util.parseJSON($(el).attr(\"select2\"), true),\n      cascade: {\n        linkSource: $(el).attr('linksource'),\n        // linkKey:$(el).attr('linkKey')||'',\n        cascadeData: $(el).attr('cascadeData') ? SUI.Util.parseJSON($(el).attr('cascadeData'), true) : ''\n      },\n      datamethod: $(el).attr('datamethod') || 'static'\n    };\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Select/Select.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Success/Success.js":
/*!***********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Success/Success.js ***!
  \***********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Success; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:21 AM\n */\n\n/**\n * 文本-成功\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Success(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty(); // $(dom).css('display','inline-block');\n    // $(dom).attr('class',$(dom).attr('class')+' '+'coreplus-form-note');\n\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Success/Success.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TableList/TableList.js":
/*!***************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TableList/TableList.js ***!
  \***************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return TableList; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 4:02 PM\n */\n\n/**\n * TableList\n */\nfunction TableList(bind) {\n  var dom = bind || $("<div />")[0],\n      config,\n      value,\n      paramFn,\n      $table,\n      $tableList;\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.extraParam = function (callback) {\n    paramFn = callback;\n  };\n\n  this.getExtraParam = function (params) {\n    if (typeof paramFn === "function") {\n      params = paramFn(params);\n    }\n\n    return params;\n  };\n\n  this.setConfig = function (val) {\n    var that = this;\n    if (!val || !val.source || !val.columns || !val.columns.length) return val;\n    config = $.extend(true, {\n      "columns": [],\n      \'sort\': \'\',\n      "numberCol": false,\n      "selectCol": true,\n      "autoLength": false,\n      "idProp": "id",\n      "tableClass": \'table-hover table-striped\',\n      "search": true,\n      "keyword_param": "keyword",\n      "keyfield_param": "searchfield",\n      "method": "GET",\n      "processing": true,\n      "lengthChange": true,\n      "lengthMenu": [5, 10, 15, 25, 40, 60, 100],\n      "searching": true,\n      "ordering": true,\n      "autoWidth": true,\n      "pageInfo": true,\n      "pageNumbers": 3,\n      "scrollX": true,\n      // 设置允许出现横向滚动条\n      "dataProp": "rows",\n      // 接口返回的数据索引 如responseData.rows\n      "length": 10,\n      // 每页显示多少条，默认10\n      "empty": \'暂无数据\',\n      "actionButtonsNumber": 3,\n      "moreButtonsText": "...",\n      "footButtons": []\n    }, val, {\n      "tableId": \'tablelist\' + Number(new Date())\n    });\n    var ifRefresh = false;\n    var _table = {\n      "dom": "<\'row tablelist-head\'<\'col-sm-6 tablelist-head-left\'><\'col-sm-6 tablelist-head-right\'>>" + "<\'row\'<\'col-sm-12\'tr>>" + "<\'row\'<\'col-sm-5\'li><\'col-sm-7\'p>>" + "<\'row tablelist-foot\'<\'col-sm-12 tablelist-foot-left\'>>",\n      "bServerSide": true,\n      "bProcessing": config.processing === false ? false : true,\n      "lengthChange": config.lengthChange === false ? false : true,\n      "lengthMenu": config.lengthMenu || [5, 10, 15, 25, 40, 60, 100],\n      "searching": config.searching === false ? false : true,\n      "ordering": config.ordering === false ? false : true,\n      "autoWidth": config.autoWidth === false ? false : true,\n      "info": config.pageInfo === false ? false : true,\n      "numbers_length": config.pageNumbers || 3,\n      "sScrollX": config.scrollX === false ? false : true,\n      // 设置允许出现横向滚动条\n      "sAjaxSource": config.source,\n      "sAjaxDataProp": config.dataProp || "rows",\n      // 接口返回的数据索引 如responseData.rows\n      "iDisplayLength": config.length || 10,\n      // 每页显示多少条，默认10\n      "aoColumns": [],\n      "aaSorting": [],\n      "fnRowCallback": function fnRowCallback(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n        // 每行渲染后的回调,一般用于绑定事件\n        var table = this;\n        $(".tablelist-actions", nRow).tableButtons({\n          buttons: config.actionButtons,\n          actionId: aData[config.idProp],\n          callback: function callback(group) {\n            $("[data-delete]", group).on(\'click\', function (event) {\n              event.preventDefault();\n              var id = $(this).data(\'delete\');\n\n              _doAction(\'delete\', [id]);\n            });\n            $("[data-modify]", group).on(\'click\', function (event) {\n              event.preventDefault();\n              var id = $(this).data(\'delete\');\n\n              _doAction(\'modify\', [id]);\n            });\n          }\n        });\n      },\n      "fnDrawCallback": function fnDrawCallback(oSettings) {\n        // 表格渲染完成回调\n        var table = this;\n\n        if (table && !ifRefresh) {\n          ifRefresh = true;\n          return table.api().columns.adjust().draw(false); //重新计算列宽\n        } // 多选\n\n\n        var twrap = oSettings.nTableWrapper;\n        $(".sui-tablelist-checkbox", twrap).iCheck(SUI.settings().iCheck());\n        $(".sui-tablelist-select-all", twrap).iCheck(\'uncheck\');\n        $(".sui-tablelist-select-all", twrap).on(\'ifClicked\', function (event) {\n          _checkAll(twrap, !this.checked);\n        });\n        $(".sui-tablelist-select-one", twrap).on(\'ifClicked\', function (event) {\n          _checkedAll(twrap, !this.checked);\n        }); //监听一下上一页下一页页码的点击事件\n\n        $(".dataTables_paginate").on("click", "a", function () {\n          ifRefresh = false; //点击了页码切换的按钮,则重新设置可以刷新宽度的函数\n        });\n      },\n      "fnServerData": function fnServerData(sSource, aoData, fnCallback, oSettings) {\n        // 数据过滤处理，以符合datatables要求\n        var table = this;\n        var _aoData = {}; // 过滤 dataTables 原始参数\n\n        $.each(aoData, function (index, val) {\n          _aoData[val.name] = val.value;\n        });\n        var sortFiled = _aoData[\'mDataProp_\' + _aoData.iSortCol_0]; // 接口入参\n\n        var params = {\n          rows: _aoData.iDisplayLength,\n          // 接口每页多少条的参数\n          page: Math.ceil(_aoData.iDisplayStart / _aoData.iDisplayLength) + 1\n        };\n\n        if (config.sort) {\n          params.sort = sortFiled;\n          params.order = _aoData.sSortDir_0;\n        }\n\n        if (_aoData.sSearch) {\n          params.keyword = _aoData.sSearch;\n        }\n\n        $(dom).find(\'.sui-tablelist-filter\').each(function (index, el) {\n          if (el.value) {\n            if ($(this).attr(\'dataType\') == \'object\') {\n              params[el.name] = SUI.Util.parseJSON(el.value, true);\n            } else {\n              params[el.name] = el.value;\n            }\n          }\n        });\n        $(dom).find(\'.sui-components[sui="true"]\').each(function (index, el) {\n          if (el.zoo && el.zoo.name) {\n            params[el.zoo.name] = el.zoo.getValue();\n          }\n        }); //管理页面初始化获取默认查询条件\n\n        if ($(\'[msp-condition]\').length) {\n          var conditions = SUI.Util.getConditions();\n          var defaultParams = {\n            data: conditions\n          };\n          $.extend(params, defaultParams);\n        }\n\n        var extraParam = that.getExtraParam(params);\n        $.extend(params, extraParam);\n        var options = {\n          "dataType": \'json\',\n          "type": config.method,\n          "url": sSource,\n          "data": params\n        };\n\n        if (config.paramsJSON) {\n          options.contentType = "text/json";\n          options.data = JSON.stringify(params);\n        }\n\n        options.success = function (data) {\n          // 过滤接口返回的数据，处理成符合datatable格式\n          $.extend(true, data, {\n            iTotalRecords: data.total,\n            // 总数\n            iTotalDisplayRecords: data.total // 过滤后总数\n\n          });\n\n          if (!data[oSettings.sAjaxDataProp] || !data[oSettings.sAjaxDataProp].length) {\n            if (oSettings._iDisplayStart >= oSettings._iDisplayLength) {\n              oSettings._iDisplayStart -= oSettings._iDisplayLength;\n              return table.api().ajax.reload(function () {}, false);\n            }\n          }\n\n          value = data[oSettings.sAjaxDataProp];\n          fnCallback(data);\n        };\n\n        oSettings.jqXHR = $.ajax(options);\n      },\n      oLanguage: {\n        sEmptyTable: config.empty\n      }\n    };\n\n    if (config.selectCol) {\n      _table.aoColumns.push({\n        "mRender": function mRender(value, type, row, full) {\n          return \'<input id="\' + config.tableId + \'-checkbox\' + row[config.idProp] + \'" name="\' + config.tableId + \'-checkbox[]" class="sui-tablelist-checkbox sui-tablelist-select-one" type="checkbox" value="\' + row[config.idProp] + \'" />\';\n        },\n        "title": \'<input type="checkbox" class="sui-tablelist-checkbox sui-tablelist-select-all" value="-1">\',\n        "bSortable": false,\n        "width": 22\n      });\n    }\n\n    if (config.numberCol) {\n      _table.aoColumns.push({\n        "mRender": function mRender(value, type, row, full) {\n          return full.settings._iDisplayStart + full.row + 1;\n        },\n        "title": typeof config.numberCol === "string" ? config.numberCol : "#",\n        "bSortable": false,\n        "width": 24\n      });\n    }\n\n    var columnIndex = _table.aoColumns.length;\n    var sort = config.sort.split(\'.\');\n    var orderby = sort[1] && /desc|asc/.test(sort[1]) ? sort[1].toLowerCase() : \'desc\';\n    var renderFn = typeof config.render === "function" ? config.render : SUI.settings()[\'tableList\'] && typeof config.render === "string" ? SUI.settings().tableList()[config.render] : false;\n\n    for (var i = 0; i < config.columns.length; i++) {\n      var column = config.columns[i];\n\n      if (sort[0] && column.name == sort[0]) {\n        _table.aaSorting = [[columnIndex + i, orderby]];\n        column.sortable = true;\n      }\n\n      var _column = {\n        bSortable: column.sortable ? true : false,\n        sClass: column.textCenter ? \'text-center \' : \'\',\n        mData: column.name,\n        name: column.name,\n        title: column.title,\n        mRender: function (name) {\n          return function (value, type, row, full) {\n            if (typeof renderFn === "function") {\n              return renderFn.call(dom, name, value, type, row, full);\n            }\n\n            return value;\n          };\n        }(column.name)\n      };\n\n      if (column.className) {\n        _column.sClass += \' \' + column.className;\n      }\n\n      if (column.width) {\n        _column.width = column.width;\n      }\n\n      _table.aoColumns.push(_column);\n    }\n\n    if (config.actionButtons !== false) {\n      _table.aoColumns.push({\n        bSortable: false,\n        sClass: \'text-center tablelist-actions\',\n        title: "操作",\n        mRender: function mRender(value, type, row, full) {\n          var html = \'<a href="javascript:;" data-modify="\' + row[config.idProp] + \'" class="btn btn-default btn-xs">编辑</a>\\\n\t        \t\t\t\t\t\t<a href="javascript:;" data-delete="\' + row[config.idProp] + \'" class="btn btn-danger btn-xs">删除</a>\\\n\t        \t\t\t\t\t\t\';\n\n          if (config.actionButtons.length) {\n            html = \'\';\n          }\n\n          return html;\n        }\n      });\n    }\n\n    $table = $(dom).find(\'table\');\n\n    if (!$table.length) {\n      $table = $(\'<table id="\' + config.tableId + \'-table" class="table \' + config.tableClass + \'" />\');\n    }\n\n    $(dom).append($table);\n\n    if (config.autoLength) {\n      var wh = $(window).height();\n      var index = 0;\n\n      if (wh > 400) {\n        index = 1;\n      }\n\n      if (wh > 800) {\n        index = 2;\n      }\n\n      _table.iDisplayLength = _table.lengthMenu[index];\n    }\n\n    $tableList = $table.dataTable(_table);\n\n    if (config.title) {\n      var $title = $(\'<div class="sui-tablelist-title" />\').html(config.title);\n      $(\'.tablelist-head-left\', dom).prepend($title);\n    }\n\n    if (config.search) {\n      var $search = $(\'<div class="input-group sui-tablelist-search">\\\n\t\t\t                    <input type="text" name="\' + config.keyword_param + \'" class="sui-tablelist-search-keyword sui-tablelist-filter form-control">\\\n\t\t\t                    <span class="input-group-btn">\\\n\t\t\t                      <button class="btn btn-primary" type="button" data-filter="search">搜索</button>\\\n\t\t\t                    </span>\\\n\t\t\t                  </div>\');\n      $(\'.tablelist-head-right\', dom).prepend($search);\n\n      if (typeof config.search === "string") {\n        config.search = config.search.split(\',\');\n      }\n\n      if ($.isArray(config.search)) {\n        var searchfilters = [{\n          name: \'\',\n          text: \'全文\'\n        }];\n\n        for (var i = 0; i < config.columns.length; i++) {\n          var _col = config.columns[i];\n\n          if ($.inArray(_col.name, config.search) !== -1) {\n            searchfilters.push({\n              name: _col.name,\n              text: _col.title\n            });\n          }\n        }\n\n        var $searchfilters = $(\'<div class="input-group-btn">\\\n\t        \t\t\t<input type="hidden" name="\' + config.keyfield_param + \'" class="sui-tablelist-filter sui-tablelist-search-field" value="">\\\n\t\t\t                      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="sui-tablelist-search-text">全文</span> <span class="fa fa-caret-down"></span></button>\\\n\t\t\t                      <ul class="dropdown-menu">\\\n\t\t\t                      </ul>\\\n\t\t\t                    </div>\');\n\n        for (var i = 0; i < searchfilters.length; i++) {\n          $(\'.dropdown-menu\', $searchfilters).append(\'<li><a data-search="\' + searchfilters[i].name + \'" href="javascript:;">\' + searchfilters[i].text + \'</a></li>\');\n        }\n\n        $search.prepend($searchfilters);\n        $search.find(\'[data-search]\').on(\'click\', function (event) {\n          event.preventDefault();\n          var text = $(this).text(),\n              name = $(this).data(\'search\');\n          $(\'.sui-tablelist-search-field\', $search).val(name);\n          $(\'.sui-tablelist-search-text\', $search).html(text);\n        });\n      }\n    }\n\n    if (config.addUrl) {\n      var $addBtn = $(\'<a href="javascript:;" data-action="add" class="sui-tablelist-add-btn btn btn-primary btn-sm">新增</a><span>&nbsp;&nbsp;</span>\');\n      $(\'.tablelist-foot-left\', dom).append($addBtn);\n    }\n\n    if (config.deleteUrl && config.selectCol) {\n      var $deleteBtn = $(\'<a href="javascript:;" data-action="delete" class="sui-tablelist-delete-btn btn btn-default btn-sm">删除</a><span>&nbsp;&nbsp;</span>\');\n      $(\'.tablelist-foot-left\', dom).append($deleteBtn);\n    }\n\n    if (config.footButtons && config.footButtons.length) {\n      for (var i = 0; i < config.footButtons.length; i++) {\n        var btn = config.footButtons[i];\n        var $btn = $(\'<a href="\' + (btn.href ? btn.href : \'javascript:;\') + \'" />\').addClass(\'btn btn-sm \' + (btn.className ? btn.className : \'btn-default\')).html(btn.content);\n        $(\'.tablelist-foot-left\', dom).append($btn).append(\'<span>&nbsp;&nbsp;</span>\');\n\n        if (typeof btn.onClick === "function") {\n          $btn.on(\'click\', btn.onClick);\n        }\n\n        typeof btn.onRender == "function" && btn.onRender.call($btn[0], btn, _getSelected(), $tableList);\n      }\n    }\n\n    typeof config.onReady == "function" && config.onReady.call(dom, $tableList);\n    $(\'[data-action]\', dom).on(\'click\', function (event) {\n      event.preventDefault();\n      var action = $(this).data(\'action\');\n\n      var ids = _getSelected().checked;\n\n      _doAction(action, ids);\n    });\n    $("[data-filter]").on(\'click\', function (event) {\n      event.preventDefault();\n      var filter = $(this).data(\'filter\');\n\n      if (filter === "search") {\n        _search();\n      }\n    });\n    /* IE9 bug 鼠标悬浮 */\n\n    $(dom).find(\'.dataTables_scrollBody\').addClass("table_iebug");\n  };\n\n  this.getValue = function () {\n    return value;\n  };\n\n  this.setValue = function () {\n    return value;\n  };\n\n  this.getSelected = function () {\n    return _getSelected().checked;\n  };\n\n  this.getSelectedData = function () {\n    var ids = _getSelected().ids;\n\n    var data = [];\n\n    for (var i = 0; i < ids.length; i++) {\n      data.push(value[ids[i]]);\n    }\n\n    return data;\n  };\n\n  this.tableApi = function () {\n    return $tableList.api();\n  };\n\n  function _paramUrl(url, id) {\n    return url.replace(\'{idProp}\', config.idProp).replace(\'{id}\', id);\n  }\n\n  function _doAction(action, ids) {\n    if (action === "add") {\n      layer.open({\n        type: 2,\n        title: "新建",\n        area: ["500px", "340px"],\n        content: config.addUrl,\n        btn: [\'发送\'],\n        maxmin: true,\n        yes: function yes(index, layero) {\n          var iframeWin = window[layero.find(\'iframe\')[0][\'name\']];\n          iframeWin.save(function (msg) {\n            return layer.msg(msg || \'正在发送...\', {\n              time: 0\n            });\n          }, function (success, loading, data) {\n            layer.close(loading);\n\n            if (!success) {\n              return alert(\'新建失败\');\n            }\n\n            layer.msg(\'新建成功,刷新页面\', {\n              icon: 1\n            });\n            layer.close(index);\n            $tableList.api().ajax.reload(function () {\n              setTimeout(function () {\n                layer.msg(\'刷新成功\');\n              }, 1000);\n            }, true);\n          });\n        }\n      });\n    }\n\n    if (action === "modify") {\n      if (!ids.length) {\n        return alert(\'请选择修改项\');\n      }\n\n      layer.open({\n        type: 2,\n        title: "修改",\n        area: ["500px", "340px"],\n        content: _paramUrl(config.modifyUrl, ids[0]),\n        btn: [\'保存\'],\n        maxmin: true,\n        yes: function yes(index, layero) {\n          var iframeWin = window[layero.find(\'iframe\')[0][\'name\']];\n          iframeWin.save(function (msg) {\n            return layer.msg(msg || \'正在发送...\', {\n              time: 0\n            });\n          }, function (success, loading, data) {\n            layer.close(loading);\n\n            if (!success) {\n              return alert(\'修改失败\');\n            }\n\n            layer.msg(\'修改成功,刷新页面\', {\n              icon: 1\n            });\n            layer.close(index);\n            $tableList.api().ajax.reload(function () {\n              setTimeout(function () {\n                layer.msg(\'刷新成功\');\n              }, 1000);\n            }, true);\n          });\n        }\n      });\n    }\n\n    if (action === "delete") {\n      if (!ids.length) {\n        return alert(\'请选择要删除的项\');\n      }\n\n      layer.confirm(\'确定删除\' + ids.length + \'项\', function (index) {\n        layer.close(index);\n        var loading = layer.msg(\'正在删除\', {\n          time: 0\n        });\n        $.ajax({\n          url: _paramUrl(config.deleteUrl, ids.join(\',\')),\n          type: \'GET\',\n          success: function success() {\n            $tableList.api().ajax.reload(function () {\n              layer.msg(\'删除成功\');\n            }, false);\n          },\n          complete: function complete() {\n            layer.close(loading);\n          }\n        });\n      });\n    }\n  }\n\n  function _checkAll(context, checked) {\n    $(\'.sui-tablelist-checkbox\', context).iCheck(checked ? \'check\' : \'uncheck\');\n  }\n\n  function _checkedAll(context, _checked) {\n    var $checkbox = $(\'.sui-tablelist-select-one\', context);\n    var total = $checkbox.length;\n    var checked = 0;\n    _checked && $checkbox.each(function (index, el) {\n      if (el.checked) {\n        checked++;\n      }\n    });\n    $(\'.sui-tablelist-select-all\', context).iCheck(total && total - 1 === checked ? \'check\' : \'uncheck\');\n  }\n\n  function _getSelected() {\n    var out = {\n      ids: [],\n      checked: []\n    };\n    $(\'.sui-tablelist-select-one\', $table).each(function (index, el) {\n      if (el.checked) {\n        out.ids.push(index);\n        out.checked.push(el.value);\n      }\n    });\n    return out;\n  }\n\n  function _search() {\n    $tableList.api().ajax.reload(function () {}, true);\n  }\n\n  function _parseData(element) {\n    var el = element || bind;\n    var data = {\n      "title": $(el).attr(\'title\'),\n      "columns": SUI.Util.parseJSON($(el).attr(\'columns\') || \'[]\', true),\n      "deleteUrl": $(el).attr(\'deleteUrl\'),\n      "modifyUrl": $(el).attr(\'modifyUrl\'),\n      "addUrl": $(el).attr("addUrl"),\n      "render": $(el).attr(\'render\'),\n      \'sort\': $(el).attr(\'sort\') || \'\',\n      "numberCol": $(el).attr(\'numberCol\') != undefined,\n      "selectCol": ($(el).attr(\'selectCol\') || \'false\') === \'false\' ? false : true,\n      "tableId": el.id ? el.id : \'tablelist\' + Number(new Date()),\n      "autoLength": $(el).attr(\'autoLength\') === "true",\n      "idProp": $(el).attr("idProp") || "id",\n      "tableClass": $(el).attr(\'tableClass\') || \'table-hover table-striped\',\n      "search": $(el).attr(\'search\') === "false" ? false : true,\n      "paramsJSON": $(el).attr(\'paramsJSON\') == "true",\n      "method": $(el).attr(\'method\') || \'GET\',\n      "processing": $(el).attr(\'processing\') === "false" ? false : true,\n      "lengthChange": $(el).attr(\'lengthChange\') === "false" ? false : true,\n      "lengthMenu": SUI.Util.parseJSON($(el).attr(\'lengthMenu\') || \'[5,10,15,25,40,60,100]\', true),\n      "searching": $(el).attr(\'searching\') === "false" ? false : true,\n      "ordering": $(el).attr(\'ordering\') === "false" ? false : true,\n      "autoWidth": $(el).attr(\'autoWidth\') === "false" ? false : true,\n      "pageInfo": $(el).attr(\'pageInfo\') === "false" ? false : true,\n      "pageNumbers": Number($(el).attr(\'pageNumbers\') || \'3\'),\n      "scrollX": $(el).attr(\'scrollX\') === "false" ? false : true,\n      // 设置允许出现横向滚动条\n      "source": $(el).attr(\'source\'),\n      "dataProp": $(el).attr(\'dataProp\') || "rows",\n      // 接口返回的数据索引 如responseData.rows\n      "length": Number($(el).attr(\'length\') || \'10\'),\n      // 每页显示多少条，默认10\n      "empty": $(el).attr(\'empty\'),\n      "actionButtons": $(el).attr(\'actionButtons\') == "false" ? false : SUI.Util.parseJSON($(el).attr(\'actionButtons\'))\n    };\n    return data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TableList/TableList.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Text/Text.js":
/*!*****************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Text/Text.js ***!
  \*****************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Text; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 4:17 PM\n */\n\n/**\n * 文本控件\n */\nfunction Text(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      prefix: $(el).attr('prefix') || '',\n      // style: $(el).attr('style') || '',\n      divexpandClass: $(el).attr('divexpandClass') || '',\n      spanexpandClass: $(el).attr('spanexpandClass') || '',\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    var divexpandClass = config.divexpandClass;\n    var spanexpandClass = config.spanexpandClass;\n    $(dom).empty();\n    $(dom).css('display', 'inline-block');\n    $(dom).attr('class', $(dom).attr('class') + ' ' + divexpandClass);\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span class=\"' + spanexpandClass + '\"></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    } // $(dom).attr('style', config.style)\n\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Text/Text.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Tip/Tip.js":
/*!***************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Tip/Tip.js ***!
  \***************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Tip; });\n/**\n * @author yangshangfei\n * @date 2019/7/25 4:17 PM\n */\n\n/**\n * 提示控件\n */\nfunction Tip(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      content: $(el).attr('content') || '',\n      placement: $(el).attr('placement') || 'top',\n      type: $(el).attr('type') || 'normal',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    var html = '';\n    $(dom).empty();\n    $(dom).css(\"display\", \"inline-block\");\n    html = '<i class=\"glyphicon glyphicon-question-sign \"></i>';\n    $(dom).append(html);\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.type == 'normal') {\n      $(dom).on('mouseover', function () {\n        $('.popover').remove();\n        $(dom).popover({\n          html: true,\n          content: config.content,\n          trigger: \"manual\",\n          placement: config.placement,\n          template: SUI.Util.popTpl.tip\n        });\n        $(dom).popover('show');\n      }).on('mouseleave', function () {\n        $(dom).popover('hide');\n      });\n    }\n\n    if (SUI.Util.getQueryString('mode') && SUI.Util.getQueryString('mode') == 'print') {\n      $(dom).hide();\n      return;\n    }\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Tip/Tip.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TipText/TipText.js":
/*!***********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TipText/TipText.js ***!
  \***********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Tiptext; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:25 AM\n */\n\n/**\n * 文本-提示\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Tiptext(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty(); // $(dom).css('display','inline-block');\n    // $(dom).attr('class',$(dom).attr('class')+' '+'coreplus-form-note');\n\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TipText/TipText.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Warning/Warning.js":
/*!***********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Warning/Warning.js ***!
  \***********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Warning; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:22 AM\n */\n\n/**\n * 文本-警告\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Warning(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      prefix: $(el).attr('prefix') || '',\n      suffix: $(el).attr('suffix') || '',\n      content: $(el).attr('content') || '',\n      dataSource: $(el).attr('dataSource') || false,\n      properties: {\n        name: $(el).attr('name') || '',\n        mspPreview: $(el).attr('msppreview')\n      },\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    $(dom).empty();\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span></span></div>';\n    $(dom).append(html);\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    if (config.dataSource != '') {\n      if (config.properties.mspPreview == 'true') return;\n\n      switch (config.dataSource) {\n        case 'activityName':\n          {\n            if (wf2) {\n              config.content = wf2 && wf2.workflow.activity && wf2.workflow.activity.name || '';\n            }\n\n            break;\n          }\n\n        default:\n          {\n            config.content = Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(config.dataSource) || '';\n          }\n      }\n\n      if (config.content != '') {\n        this.showContent(config.content);\n      }\n    } else {\n      this.showContent(config.content);\n    }\n  };\n\n  this.setValue = function (value) {\n    config.content = value === 0 || value === '0' ? 0 : value || \"\";\n    this.showContent(config.content);\n  };\n\n  this.showContent = function (content) {\n    $(dom).show();\n\n    if ($(dom).attr('hidewrapper') == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).find('span').text(config.prefix + content + config.suffix);\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Warning/Warning.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Deprecated_Components/SelectPersonnel/SelectPersonnel.js":
/*!*******************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Deprecated_Components/SelectPersonnel/SelectPersonnel.js ***!
  \*******************************************************************************************************************************************/
/*! no static exports found */function(module,exports){eval('/**\n * @author yangshangfei\n * @date 2019/7/26 2:23 PM\n */\n\n/**\n * 人员选择器-弃用\n * @param bind\n * @returns {*}\n * @constructor\n */\nvar hasLoadmechanism = false;\n\nfunction SelectPersonnel(bind) {\n  //dom对象\n  var dom = bind || $("<div />")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr(\'mode\'),\n      properties: {\n        mspPreview: $(el).attr(\'mspPreview\'),\n        name: $(el).attr(\'name\')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    var mode = $(dom).attr(\'mode\') || \'editable\';\n    var dataType = $(dom).attr(\'dataType\') || ""; //单选 one 不设置默认多选\n\n    var showOrg = $(dom).attr(\'showOrg\') || true; //人员后面是否显示机构名 默认显示\n\n    var canDelete = $(dom).attr(\'canDelete\') || false; //是否可以保存空值\n\n    var returnFunc = $(dom).attr(\'returnFunc\'); //returnFunc="text()" text可以换名字，点击确定后会运行这个function;\n\n    var mspPreview = $(dom).attr(\'mspPreview\') || false; //coreplus 下预览模式\n\n    var previewHtml = \'<div class="input-group" data-toggle="modal" data-target="#people-selector">\\\n                            <input id="" type="text" class="form-control" readonly="readonly"  value="" style="border-color:#d2d6de;" placeholder="请选择人员">\\\n                            <input type="hidden" value="" >\\\n                            <span class="input-group-addon tree-toggle" dataType="\' + dataType + \'" showOrg="\' + showOrg + \'" canDelete="\' + canDelete + \'" returnFunc="\' + returnFunc + \'">选择</span>\\\n                        </div>\';\n\n    if (mode == \'editable\') {\n      if (mspPreview == \'true\') {\n        $(dom).html(previewHtml);\n      } else {\n        $(dom).html(previewHtml);\n\n        if (!hasLoadmechanism) {\n          loadOneScript(__basePath + \'_libs/plugins/mechanism/mechanism.js\', function () {\n            hasLoadmechanism = true;\n          });\n        }\n      }\n    } else if (mode == \'readonly\') {\n      var viewHtml = \'<div class="input-group" >\\\n                            <input id="" type="text" class="form-control" readonly="readonly"  value="" style="border-color:#d2d6de;" placeholder="请选择人员">\\\n                            <input type="hidden" value="" >\\\n                            <span class="input-group-addon tree-toggle" >选择</span>\\\n                        </div>\';\n      $(dom).html(viewHtml);\n    } else if (mode == \'hide\') {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    var val = $(dom).find(\'input[type=hidden]\').val();\n    return val;\n  };\n\n  this.setValue = function (val) {\n    value = val;\n    var show_rymc = \'\';\n\n    if (typeof value == \'string\') {\n      value = JSON.parse(value);\n    }\n\n    $.each(value, function (index, v) {\n      show_rymc += v.RYMC + \',\';\n    });\n\n    if (show_rymc.length > 0) {\n      show_rymc = show_rymc.substring(0, show_rymc.length - 1);\n    }\n\n    $(dom).find(\'input[type=text]\').val(show_rymc);\n    $(dom).find(\'input[type=hidden]\').val(JSON.stringify(value));\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Deprecated_Components/SelectPersonnel/SelectPersonnel.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Expansion_Components/MeetRoom/MeetRoom.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Expansion_Components/MeetRoom/MeetRoom.js ***!
  \****************************************************************************************************************************/
/*! no static exports found */function(module,exports){eval("/**\n * @author yangshangfei\n * @date 2019/11/5 6:57 PM\n */\n$(function () {\n  SUI.register(\"MeetRoom\", MeetRoom);\n\n  function MeetRoom(bind) {\n    var dom = bind || $(\"<div />\")[0],\n        config;\n    dom.zoo = this; //初始化\n\n    this.init = function (val) {\n      this.setConfig(val);\n    }; //读取元素上的属性\n\n\n    this.parse = function (element) {\n      var el = element || bind;\n      var conf = {\n        mode: $(el).attr('mode') || 'editable',\n        properties: {\n          mspPreview: $(el).attr('mspPreview') || false,\n          name: $(el).attr('name')\n        },\n        title: $(el).attr('title') || '选择会议时间',\n        dateParam: $(el).attr('dateParam') || false\n      };\n      return conf;\n    }; //获取控件配置属性\n\n\n    this.getConfig = function () {\n      return config;\n    }; //给控件设置属性，绑定事件\n\n\n    this.setConfig = function (val) {\n      config = val;\n      this.name = config.properties.name;\n      var editableHtml = '<a class=\"btn btn-primary\">选中会议时间</a><div class=\"\"></div>';\n      var preViewHtml = '<div class=\"value-text\"><div ></div></div>';\n\n      if (config.mode == 'editable') {\n        $(dom).html(editableHtml);\n        var button = $(dom).find('a');\n        button.on('click', function () {\n          var roomInfo = $(dom).sui().getValue();\n          localStorage.setItem('roomInfo', roomInfo);\n          var url = __basePath + '_libs/plugins/root/components/Expansion_Components/MeetRoom/MeetRoom/MeetRoom.jsp';\n          var date = config.dateParam ? SUI.Util.getQueryString(config.dateParam) : '';\n          if (date) url += '?date=' + date;\n          var index = layer.open({\n            type: 2,\n            title: config.title,\n            area: ['100%', '100%'],\n            content: url,\n            success: function success() {},\n            yes: function yes() {}\n          });\n        });\n      } else if (config.mode == 'readOnly' || config.mode == 'view') {\n        $(dom).html(preViewHtml);\n      } else if (config.mode == 'hide') {\n        $(dom).html(preViewHtml);\n        $(dom).hide();\n      }\n    };\n\n    this.getValue = function () {\n      var val;\n\n      if (config.mode == 'editable') {\n        val = $(dom).find('div').data('roominfo') || '';\n      } else if (config.mode == 'readOnly') {\n        val = $(dom).find('div').data('roominfo') || '';\n      } else {\n        val = $(dom).find('span').data('roominfo') || '';\n      }\n\n      return val;\n    };\n\n    this.setValue = function (val) {\n      if (val) {\n        if (typeof val == \"string\") {\n          val = JSON.parse(val);\n        }\n\n        var text = '';\n\n        if (val.meetingRoomName) {\n          text += '<div>' + val.meetingRoomName + ' ——预定时间</div>';\n\n          if (val.useRoomInfo && val.useRoomInfo.length) {\n            $.each(val.useRoomInfo, function (i, v) {\n              text += '<div>' + v.startTime + '-' + v.endTime.split(' ')[1] + '</div>';\n            });\n          }\n        }\n\n        $(dom).find('div').data('roominfo', JSON.stringify(val));\n        $(dom).find('div').html(text);\n      }\n\n      $(dom).trigger('change', [val]);\n    };\n\n    return dom;\n  }\n});\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Expansion_Components/MeetRoom/MeetRoom.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/AddEntity/AddEntity.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/AddEntity/AddEntity.js ***!
  \****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return AddEntity; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:19 PM\n */\n\n/**\n * 普通提交管理-新增\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction AddEntity(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-primary btn-sm\">新增</button>';\n    $(dom).append(html);\n    var btn = $(dom).find('button');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      EM.addEntity();\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/AddEntity/AddEntity.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/CustomBtn/CustomBtn.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/CustomBtn/CustomBtn.js ***!
  \****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CustomBtn; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:21 PM\n */\n\n/**\n * 普通提交管理-自定义\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction CustomBtn(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable',\n      methodName: $(el).attr('methodName') || '',\n      className: $(el).attr('className') || 'btn-primary',\n      btnText: $(el).attr('btnText') || '',\n      properties: {\n        mspPreview: $(el).attr('msppreview') || false\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-sm' + config.className + '\">' + config.btnText + '</button>';\n    $(dom).append(html);\n    var btn = $(dom).find('button');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      EM.customRun(config.methodName);\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/CustomBtn/CustomBtn.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/DelEntity/DelEntity.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/DelEntity/DelEntity.js ***!
  \****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DelEntity; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:18 PM\n */\n\n/**\n * 普通提交管理-删除\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction DelEntity(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-primary btn-sm\">删除</button>';\n    $(dom).append(html);\n    var btn = $(dom).find('button');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      var delData = EM.getSelectedData();\n\n      if (delData.length == 0) {\n        alert('请至少选择一项');\n        return;\n      }\n\n      layer.confirm('确定要删除所选数据吗？', {\n        btn: ['删除', '取消'] //可以无限个按钮\n\n      }, function (index, layero) {\n        //按钮【按钮一】的回调\n        layer.close(index);\n        EM.delEntity();\n      }, function (index) {\n        layer.close(index);\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/DelEntity/DelEntity.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/ImportEntity/ImportEntity.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/ImportEntity/ImportEntity.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ImportEntity; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:22 PM\n */\n\n/**\n * 普通提交管理-批量导入\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction ImportEntity(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      btnText: $(el).attr('btnText') || '导入',\n      uploadUrl: $(el).attr('btnText') || __basePath + 'workflow/upload_base.jsp',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-primary btn-sm download\" style=\"margin: 0 5px\"><i class=\"fa fa-download\"></i>下载模板</button>' + '' + '<button class=\"btn btn-primary btn-sm upload\"><i class=\"fa fa-upload\"></i>' + config.btnText + '</button>' + '<input type=\"file\" class=\"file\" multiple=\"false\" style=\"display: none\">';\n    $(dom).append(html);\n    var downloadBtn = $(dom).find('button.download'),\n        uploadBtn = $(dom).find('button.upload');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    downloadBtn.click(function () {\n      var index = layer.load(1);\n      EM.entityTemplate(function () {\n        layer.close(index);\n      }, function (data) {\n        console.log(data);\n\n        if (data.result.resultCode == 1) {\n          location.href = data.result.path;\n        } else {\n          alert('下载失败');\n        }\n      });\n    });\n    uploadBtn.click(function () {\n      $('.file', $(dom)).trigger('click');\n    });\n\n    function resetFile() {\n      $('.file', $(dom)).val('');\n    }\n\n    function progressHandlingFunction(e) {\n      if (e.lengthComputable) {// $('progress').attr({value: e.loaded, max: e.total});\n      }\n    }\n\n    $('.file', $(dom)).on('change', function (e) {\n      var file = this.files[0],\n          type = file.type;\n      var formData = new FormData();\n      formData.append(\"Filedata\", file);\n      var index = layer.msg('导入中', {\n        icon: 16,\n        shade: 0.01\n      });\n      $.ajax({\n        url: config.uploadUrl,\n        //server script to process data\n        type: 'POST',\n        xhr: function xhr() {\n          // custom xhr\n          var myXhr = $.ajaxSettings.xhr();\n\n          if (myXhr.upload) {\n            // check if upload property exists\n            myXhr.upload.addEventListener('progress', progressHandlingFunction, false); // for handling the progress of the upload\n          }\n\n          return myXhr;\n        },\n        //Ajax事件\n        complete: function complete() {},\n        success: function success(data) {\n          var resultData = $.parseJSON(data);\n\n          if (resultData.error) {\n            layer.alert(\"上传失败\", {\n              icon: 2,\n              title: '提示',\n              closeBtn: 0\n            });\n            return;\n          }\n\n          var path = resultData.absolutPath;\n          EM.importEntity(path, function () {\n            layer.close(index);\n          }, function (data) {\n            if (data.result.resultCode == 1) {\n              alert('导入成功');\n              EM.reloadList();\n            } else {\n              layer.alert(\"导入失败\", {\n                icon: 2,\n                title: '提示',\n                closeBtn: 0\n              });\n            }\n          });\n        },\n        error: function error() {\n          layer.close(index);\n          alert('很抱歉,上传失败');\n        },\n        // Form数据\n        data: formData,\n        //Options to tell JQuery not to process data or worry about content-type\n        cache: false,\n        contentType: false,\n        processData: false\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/ImportEntity/ImportEntity.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/QueryEntity/QueryEntity.js":
/*!********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/QueryEntity/QueryEntity.js ***!
  \********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return QueryEntity; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:16 PM\n */\n\n/**\n * 普通提交管理-查询\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction QueryEntity(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-primary btn-sm\">查询</button>';\n    $(dom).append(html);\n    var btn = $(dom).find('button');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    } // if (!config.entityConfig) {\n    //     return;\n    // }\n\n\n    btn.click(function () {\n      EM.queryEntity();\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/QueryEntity/QueryEntity.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/SubmitEntity/SubmitEntity.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/SubmitEntity/SubmitEntity.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SubmitEntity; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 4:14 PM\n */\n\n/**\n * 普通提交控件\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction SubmitEntity(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<button class=\"btn btn-primary\">保存</button>';\n    $(dom).append(html);\n    var btn = $(dom).find('button');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    if (!config.entityConfig) {\n      return;\n    }\n\n    if ($.inArray(config.entityConfig.mode, ['preview', 'print']) !== -1) {\n      $(dom).hide();\n    }\n\n    btn.click(function () {\n      //验证表单非空\n      var suiForm = $(\".sui-form\").sui();\n\n      if (!$(\".sui-form\")[0].zoo.validate()) {\n        alert(\"验证失败，请检查\");\n        return;\n      }\n\n      btn.attr('disabled', 'true');\n      var entity = suiForm.getValue();\n      entity.__type = config.entityConfig.entityType;\n      $(dom).trigger(\"beforeSubmit\", entity); //todo 传入id修改\n\n      if (config.entityConfig.id && config.entityConfig.id !== '') {\n        entity[config.entityConfig.idProp] = config.entityConfig.id;\n        EM.saveEntity(entity, function (data) {\n          $(dom).trigger(\"afterSubmit\", data);\n          parent.EM.reloadList();\n          var index = parent.layer.getFrameIndex(window.name);\n          parent.layer.close(index);\n\n          if (data.result == 1 || data.result == \"1\") {\n            if (parent && parent.layer) {\n              var p_layer = parent.layer;\n              parent.layer.alert('提交成功', function (index) {\n                p_layer.close(index);\n\n                if (config.entityConfig.closeable == 'false') {\n                  window.location.reload();\n                } else {\n                  SUI.Util.wfCloseWindow();\n                }\n              });\n            } else {\n              layer.alert('提交成功', function (index) {\n                layer.close(index);\n\n                if (config.entityConfig.closeable == 'false') {\n                  window.location.reload();\n                } else {\n                  SUI.Util.wfCloseWindow();\n                }\n              });\n            } // alert('提交成功')\n\n          } else {\n            alert('提交失败');\n          }\n        });\n      } else {\n        EM.saveEntity(entity, function (data) {\n          $(dom).trigger(\"afterSubmit\", data); // btn.removeAttr('disabled')\n\n          if (parent.EM && window !== parent) {\n            parent.EM.reloadList();\n            var index = parent.layer.getFrameIndex(window.name);\n            parent.layer.close(index);\n          }\n\n          if (data.result == 1 || data.result == \"1\") {\n            if (parent && parent.layer) {\n              var p_layer = parent.layer;\n              parent.layer.alert('提交成功', function (index) {\n                p_layer.close(index);\n                SUI.Util.wfCloseWindow();\n              });\n            } else {\n              layer.alert('提交成功', function (index) {\n                layer.close(index);\n                SUI.Util.wfCloseWindow();\n              });\n            } // alert('提交成功')\n\n          } else {\n            alert('提交失败');\n          }\n        });\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/SubmitEntity/SubmitEntity.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ApplicantOrg/ApplicantOrg.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ApplicantOrg/ApplicantOrg.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ApplicantOrg; });\n/**\n*申请人机构控件，用于申请人选择一个机构\n*当申请人属于多个机构时，该控件以下拉列表形式，展示所有机构\n*name属性是机构id字段\n*name2属性是机构名字段，必填\n*\n*/\nfunction ApplicantOrg(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this;\n  var orgId = \"\";\n  var orgName = \"\";\n  this.name;\n  this.name2; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n  //name是orgId字段\n  //name2是orgName字段\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable',\n      properties: {\n        mspPreview: $(el).attr('mspPreview') || false,\n        name: $(el).attr('name'),\n        orgNameField: $(el).attr('name2')\n      }\n    };\n    this.name = $(el).attr('name');\n    this.name2 = $(el).attr('name2');\n    return conf;\n  }; //设置数据源\n\n\n  this.setDataSource = function (datasource) {\n    config.datasource = datasource;\n    this.setConfig(config);\n  }; //获取数据源\n\n\n  this.getDataSource = function () {\n    return config.datasource;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.render(orgId, orgName);\n  };\n\n  this.render = function (id, name) {\n    var mode = config.mode;\n\n    if (config.datasource) {\n      if (!id) {\n        id = config.datasource[0].value;\n      }\n\n      if (!name) {\n        name = config.datasource[0].name;\n      }\n\n      orgId = id;\n      orgName = name;\n    }\n\n    if (mode == 'editable') {\n      //可编辑\n      if (config.datasource) {\n        if (config.datasource.length == 1) {\n          //只有一条记录\n          this.readerReadOnly(id, name);\n        } else {\n          //有多条记录，以下拉框展示\n          this.renderEditable();\n        }\n      }\n    } else if (mode == 'readOnly' || mode == 'view') {\n      this.readerReadOnly(id, name);\n    } else if (mode == \"hide\") {\n      $(dom).hide();\n    }\n  }; //下拉框渲染\n\n\n  this.renderEditable = function () {\n    $(dom).removeClass('form-readOnly');\n\n    var _Select = $('<div class=\"sui-select\" mode=\"editable\"></div>');\n\n    $(dom).html(_Select);\n\n    _Select.on('change', function () {\n      orgId = _Select.sui().getValue();\n      orgName = dom.zoo.getDataFromDatasource(orgId);\n    });\n\n    SUI.init($.noop(), $(dom));\n\n    var selectConfig = _Select.sui().getConfig();\n\n    selectConfig.properties.dataSource = config.datasource;\n\n    _Select.sui().setConfig(selectConfig);\n  }; //只读模式渲染\n\n\n  this.readerReadOnly = function (orgId, orgName) {\n    $(dom).addClass('form-readOnly');\n    var html = '<div class=\"value-text\"><span class=\"value\">' + orgName + '</span></div>';\n    $(dom).html(html);\n  };\n\n  this.getOrgId = function () {\n    return orgId;\n  };\n\n  this.getOrgName = function () {\n    return orgName;\n  };\n  /**\n  *返回值为\n  *{\n  *\tsqrbmid:\"\",\n  *\tsqrbmmc:\"\"\n  *}\n  *根据name和name2属性获取key值\n  */\n\n\n  this.getValue = function () {\n    var value = {};\n    value[config.properties.name] = orgId;\n    value[config.properties.orgNameField] = orgName;\n    return JSON.stringify(value);\n  };\n\n  this.setValue = function (value) {\n    if (typeof value === 'string') {\n      try {\n        value = JSON.parse(value);\n      } catch (err) {\n        console.log(err);\n      }\n    }\n\n    orgId = value[config.properties.name];\n    orgName = value[config.properties.orgNameField];\n    this.render(orgId, orgName);\n  };\n\n  this.getDataFromDatasource = function (dataId) {\n    for (var i in config.datasource) {\n      if (config.datasource[i].value == dataId) {\n        return config.datasource[i].name;\n      }\n    }\n\n    return \"\";\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ApplicantOrg/ApplicantOrg.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CheckSendMsg/CheckSendMsg.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CheckSendMsg/CheckSendMsg.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return CheckSendMsg; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:18 AM\n */\n\n/**\n * 消息通知\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction CheckSendMsg(bind) {\n  var dom = bind || $("<div />")[0],\n      config;\n  dom.zoo = this;\n  var value;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      // isShowSendMsg: $(el).attr(\'isShowSendMsg\') || false,\n      properties: {\n        mspPreview: $(el).attr(\'msppreview\')\n      }\n    };\n    return conf;\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == \'true\') {\n        var checkbox = \'<div class="checkbox-group messageNotic">\' + \'<label>发送短信通知&nbsp;：</label>\' + \'<label><input type="checkbox" class="toParticipant"/>&nbsp;通知后续处理人&nbsp;</label>\' + \'<label><input type="checkbox" class="toCreator"/>&nbsp;通知申请人&nbsp;</label>\' + \'</div>\';\n        $(dom).append(checkbox);\n        $(".messageNotic.checkbox-group input", dom).iCheck(SUI.settings().iCheck({}));\n        $(dom).css("display", "inline-block");\n        $(dom).show();\n        return false;\n      }\n    }\n\n    if (!config.activityExt || !config.activityExt.showSendMessage) {\n      return;\n    }\n\n    var showSendMessage = config.activityExt.showSendMessage;\n    showSendMessage = SUI.Util.parseJSON(showSendMessage, true);\n    var toCreator = false;\n    var toParticipant = false;\n\n    if (showSendMessage.toCreator) {\n      toCreator = true;\n    }\n\n    if (showSendMessage.toParticipant) {\n      toParticipant = true;\n    }\n\n    if (toCreator && toParticipant) {\n      //两个都配置\n      var checkbox = \'<div class="checkbox-group messageNotic">\' + \'<label>发送短信通知&nbsp;：</label>\' + \'<label><input type="checkbox" class="toParticipant"/>&nbsp;通知后续处理人&nbsp;</label>\' + \'<label><input type="checkbox" class="toCreator"/>&nbsp;通知申请人&nbsp;</label>\' + \'</div>\';\n      $(dom).append(checkbox);\n      $(".messageNotic.checkbox-group input", dom).iCheck(SUI.settings().iCheck({}));\n      $(dom).css("display", "inline-block");\n\n      if (showSendMessage.toCreator.checked == "true") {\n        $(".messageNotic.checkbox-group .toCreator", dom).iCheck("check");\n      }\n\n      if (showSendMessage.toParticipant.checked == "true") {\n        $(".messageNotic.checkbox-group .toParticipant", dom).iCheck("check");\n      }\n\n      $(dom).show();\n    } else if (toCreator) {\n      //配置发送申请人消息\n      var checkbox = \'<div class="checkbox-group messageNotic">\' + \'<label><input type="checkbox" />&nbsp;短信通知申请人&nbsp;</label>\' + \'</div>\';\n      $(dom).append(checkbox);\n      $(".messageNotic.checkbox-group input", dom).iCheck(SUI.settings().iCheck({}));\n      $(dom).css("display", "inline-block");\n\n      if (showSendMessage.toCreator.checked == "true") {\n        $(".messageNotic.checkbox-group input", dom).iCheck("check");\n      }\n\n      $(dom).show();\n    } else if (toParticipant) {\n      //配置发送经办人提醒消息\n      var checkbox = \'<div class="checkbox-group messageNotic">\' + \'<label><input type="checkbox" />&nbsp;短信通知后续处理人&nbsp;</label>\' + \'</div>\';\n      $(dom).append(checkbox);\n      $(".messageNotic.checkbox-group input", dom).iCheck(SUI.settings().iCheck({}));\n      $(dom).css("display", "inline-block");\n\n      if (showSendMessage.toParticipant.checked == "true") {\n        $(".messageNotic.checkbox-group input", dom).iCheck("check");\n      }\n\n      $(dom).show();\n    } else {\n      //两个都不发送\n      return;\n    }\n\n    $(\'div.icheckbox_square-green\', dom).css(\'background-color\', \'#fff\');\n  };\n\n  this.getValue = function () {\n    var val = {\n      toParticipant: "",\n      toCreator: ""\n    };\n\n    if (!config.activityExt || !config.activityExt.showSendMessage) {\n      return val;\n    }\n\n    var showSendMessage = config.activityExt.showSendMessage;\n\n    if (!showSendMessage) {\n      return val;\n    }\n\n    showSendMessage = SUI.Util.parseJSON(showSendMessage, true);\n    var toCreator = false;\n    var toParticipant = false;\n\n    if (showSendMessage.toCreator) {\n      toCreator = true;\n    }\n\n    if (showSendMessage.toParticipant) {\n      toParticipant = true;\n    }\n\n    if (toCreator && toParticipant) {\n      //两个都配置\n      val.toCreator = $(".messageNotic.checkbox-group .toCreator", dom).is(\':checked\');\n      val.toParticipant = $(".messageNotic.checkbox-group .toParticipant", dom).is(\':checked\');\n    } else if (toCreator) {\n      //配置发送申请人消息\n      val.toCreator = $(".messageNotic.checkbox-group input", dom).is(\':checked\');\n    } else if (toParticipant) {\n      //配置发送经办人提醒消息\n      val.toParticipant = $(".messageNotic.checkbox-group input", dom).is(\':checked\');\n    } else {//两个都不发送\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val) {\n    if (!config.activityExt || !config.activityExt.showSendMessage) {\n      return;\n    }\n\n    var showSendMessage = config.activityExt.showSendMessage;\n    showSendMessage = SUI.Util.parseJSON(showSendMessage, true);\n    var toCreator = false;\n    var toParticipant = false;\n\n    if (showSendMessage.toCreator) {\n      toCreator = true;\n    }\n\n    if (showSendMessage.toParticipant) {\n      toParticipant = true;\n    }\n\n    if (toCreator && toParticipant) {\n      //两个都配置\n      if (val.toCreator == "checked") {\n        $(".messageNotic.checkbox-group .toCreator", dom).iCheck("check");\n      }\n\n      if (val.toParticipant == "checked") {\n        $(".messageNotic.checkbox-group .toParticipant", dom).iCheck("check");\n      }\n    } else if (toCreator) {\n      //配置发送申请人消息\n      if (val.toCreator == "checked") {\n        $(".messageNotic.checkbox-group input", dom).iCheck("check");\n      }\n    } else if (toParticipant) {\n      //配置发送经办人提醒消息\n      if (val.toParticipant == "checked") {\n        $(".messageNotic.checkbox-group input", dom).iCheck("check");\n      }\n    } else {//两个都不发送\n    }\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CheckSendMsg/CheckSendMsg.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Circulation/Circulation.js":
/*!********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Circulation/Circulation.js ***!
  \********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Circulation; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:41 PM\n */\n\n/**\n * 传阅\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Circulation(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('mspPreview') || false,\n        returnFunc: $(el).attr('canDelete') || '' //returnFunc=\"text()\" text可以换名字，点击确定后会运行这个function;\n\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    var returnFunc = config.properties.returnFunc; //returnFunc=\"text()\" text可以换名字，点击确定后会运行这个function;\n\n    var mspPreview = config.properties.mspPreview; //coreplus 下预览模式\n\n    var previewHtml = '<div class=\"\" id=\"button-cy\" style=\"display: none;\">\\\n                                    <div data-toggle=\"modal\" data-target=\"#emp-selector\">\\\n                                    <a id=\"cybtn\" class=\"btn btn-primary\" returnFunc=\"' + returnFunc + '\">传阅</a>\\\n                                    </div>\\\n                                </div>';\n    var cyHistory = '<div id=\"lccydiv\" class=\"row\" ></div>'; //传阅历史\n\n    $(dom).addClass('isBtn');\n\n    if (mspPreview == \"true\") {\n      $(dom).html(previewHtml);\n\n      if ($('#lccydiv').length < 1) {\n        $('.mspplus-form').append(cyHistory);\n      }\n    } else {\n      config.wf2 = wf2;\n      $(dom).html(previewHtml);\n\n      if ($('#lccydiv').length < 1) {\n        $('.mspplus-form').append(cyHistory);\n      }\n\n      if (wf2 && wf2.entity.processInstId || workItemId) {\n        A.use(__basePath + '_libs/plugins/mechanism/Circulation.js', function () {});\n      } else {\n        $(dom).css('display', 'none');\n      }\n    }\n\n    var mode = SUI.Util.getQueryString('mode');\n\n    if (mode == 'print') {\n      $(dom).hide();\n      $('#lccydiv').hide();\n      return;\n    } //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n\n    if (!config.wfConfig) {\n      return;\n    }\n    /* 修改状态是时 不显示 */\n\n\n    if (config.wfConfig.mode == 'modify') {\n      $(dom).hide();\n    }\n  };\n\n  this.getValue = function () {\n    return false;\n  };\n\n  this.setValue = function (val) {\n    return false;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Circulation/Circulation.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CloseWindow/CloseWindow.js":
/*!********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CloseWindow/CloseWindow.js ***!
  \********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return CloseWindow; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:50 AM\n */\n\n/**\n * 关闭\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction CloseWindow(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    $(dom).addClass('no-print');\n    $(dom).addClass('isBtn');\n    var html = '<a class=\"btn btn-default\">关闭</a>';\n\n    if (SUI.Util.browserType() === 'phone') {\n      $(dom).hide();\n      return false;\n    } // 如果不能关闭就不显示\n\n\n    if (config.wfConfig && config.wfConfig.closeable == 'false') {\n      $(dom).hide();\n    }\n\n    if (config.entityConfig && config.entityConfig.closeable == 'false') {\n      $(dom).hide();\n    }\n\n    if (config.mode == 'hide') {\n      $(dom).hide();\n    }\n\n    $(dom).html(html);\n    var btn = $(dom).find('a');\n    btn.click(function () {\n      if (SUI.Util.browserType() === 'phone') {\n        if (SUI.Util.getQueryString('ismobile') === 'true') {\n          window.history.back();\n        } else {\n          SUI.Util.wfCloseWindow(config.wfConfig);\n        }\n      } else {\n        SUI.Util.wfCloseWindow(config.wfConfig);\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CloseWindow/CloseWindow.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/DeleteWf/DeleteWf.js":
/*!**************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/DeleteWf/DeleteWf.js ***!
  \**************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return DeleteWf; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:22 PM\n */\n\n/**\n * 管理-删除\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction DeleteWf(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      className: $(el).attr('className') || 'btn-primary',\n      recycleEnable: $(el).attr('recycleEnable') || 'false',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<a class=\"btn ' + config.className + ' btn-sm\">删除</a>';\n    $(dom).append(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      var delData = [];\n      $('.sui-tablelist tbody tr td:first-child input[type=\"checkbox\"]:checked').each(function () {\n        delData.push($(this).val());\n      });\n\n      if (delData.length == 0) {\n        // layer.alert('请至少选择一项');\n        SUI.Util.layerAlert({\n          content: '请至少选择一项'\n        });\n        return;\n      }\n\n      layer.confirm('确定要删除所选数据吗？', {\n        btn: ['删&nbsp;除', '取&nbsp;消'] //可以无限个按钮\n\n      }, function (index, layero) {\n        //按钮【按钮一】的回调\n        layer.close(index);\n        var layerIndexCoreplus = layer.load(2, {\n          shade: [\"0.1\", \"#000\"]\n        });\n        var url = config.recycleEnable === 'true' ? 'com.sudytech.portalone.base.workflow.deleteProcessinstTorecycle.biz.ext' : 'com.sudytech.portalone.base.workflow.deleteProcessInst.biz.ext';\n\n        if (delData.length != 0) {\n          var param = {\n            'params': delData\n          };\n          $.ajax({\n            url: url,\n            type: 'post',\n            data: JSON.stringify(param),\n            contentType: 'text/json',\n            success: function success(data) {\n              if (data.result == 1) {\n                layer.close(layerIndexCoreplus); // alert('流程删除成功');\n\n                SUI.Util.layerAlert({\n                  content: '流程删除成功'\n                });\n                $('.sui-tablelist').sui().tableApi().ajax.reload(function () {}, false);\n              }\n            }\n          });\n        }\n      }, function (index) {\n        layer.close(index);\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/DeleteWf/DeleteWf.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Dispatch/Dispatch.js":
/*!**************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Dispatch/Dispatch.js ***!
  \**************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Dispatch; });\n/**\n * @author yangshangfei\n * @date 2019/8/2 2:25 PM\n */\n\n/**\n * 待办急件\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Dispatch(bind) {\n  var dom = bind || $("<div />")[0],\n      config;\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上属性\n\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var _data = {\n      properties: {\n        name: $(el).attr("name"),\n        select: $(el).attr(\'select\'),\n        mode: $(el).attr(\'mode\'),\n        urgent: $(el).attr(\'urgent\') || \'0\'\n      } //        \t\thide : $(el).attr(\'hide\')\n\n    };\n    return _data;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    var div = \'<select name="\' + config.properties.name + \'" class="form-control" style="width: 100%;"><option value="0">无</option><option  value="1">平急</option><option  value="2">加急</option><option  value="3">特急</option><option  value="4">特提</option></select>\';\n    $(dom).html(div);\n    $(dom).find(\'select\').select2({\n      minimumResultsForSearch: -1\n    });\n    $(dom).removeClass(\'form-readOnly\');\n\n    if (config.properties.mode == \'editable\') {\n      $("select", dom).val(config.properties.urgent).trigger(\'change\');\n    }\n\n    if (config.properties.mode == \'readOnly\') {\n      $(dom).addClass(\'form-readOnly\');\n      var urgent = config.properties.urgent;\n      var readOnly_div;\n\n      if (urgent) {\n        switch (urgent) {\n          case "0":\n            readOnly_div = \'<span value="0">无</span>\';\n            break;\n\n          case "1":\n            readOnly_div = \'<span value="1">平急</span>\';\n            break;\n\n          case "2":\n            readOnly_div = \'<span value="2">加急</span>\';\n            break;\n\n          case "3":\n            readOnly_div = \'<span value="3">特急</span>\';\n            break;\n\n          case "4":\n            readOnly_div = \'<span value="4">特提</span>\';\n            break;\n        }\n      } else {\n        readOnly_div = \'<div class="value-text"><span value="0">无</span></div>\';\n      }\n\n      $(dom).html(readOnly_div); //$(dom).find(\'select\').prop("disabled", true);\n    }\n\n    if (config.properties.mode == \'hide\') {\n      $(dom).css(\'display\', \'none\');\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.getValue = function () {\n    if (config.properties.mode == \'readOnly\') {\n      return $(dom).find(\'span\').attr(\'value\');\n    } else {\n      return $(dom).find(\'select\').val();\n    }\n  };\n\n  this.setValue = function (val) {\n    $(dom).val(val); //    \t\t$(dom).sui().setValue(val);\n\n    if (config.properties.mode == \'readOnly\') {\n      if (!val) {\n        $("span", dom).text("无");\n        $("span", dom).attr("value", "0");\n      } else {\n        switch (val) {\n          case "0":\n            $("span", dom).text("无");\n            $("span", dom).attr("value", "0");\n            break;\n\n          case "1":\n            $("span", dom).text("平急");\n            $("span", dom).attr("value", "1");\n            break;\n\n          case "2":\n            $("span", dom).text("加急");\n            $("span", dom).attr("value", "2");\n            break;\n\n          case "3":\n            $("span", dom).text("特急");\n            $("span", dom).attr("value", "3");\n            break;\n\n          case "4":\n            $("span", dom).text("特提");\n            $("span", dom).attr("value", "4");\n            break;\n        }\n      }\n    } else {\n      if (!val) {\n        $("select", dom).val(0);\n        $("select", dom).change();\n      } else {\n        $("select", dom).val(val);\n        $("select", dom).change();\n      }\n    }\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Dispatch/Dispatch.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Draft/Draft.js":
/*!********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Draft/Draft.js ***!
  \********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Draft; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:20 AM\n */\n\n/**\n * 草稿箱\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Draft(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      drafttitle: $(el).attr(\"drafttitle\") || \"\",\n      title: $(el).attr(\"titlefield\"),\n      callback: function callback() {},\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      },\n      useMobile: $(el).attr('useMobile') || 'false'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).addClass('no-print');\n    $(dom).addClass('isBtn');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        $(dom).css('display', 'inline-block');\n        $(dom).html('<a class=\"btn btn-primary\">保存草稿</a>');\n        return false;\n      }\n    }\n\n    if (!(\"\" == config.processInstId && \"\" == config.workItemId)) {\n      $(dom).hide();\n      return;\n    }\n\n    $(dom).attr(\"did\", 0);\n    $(dom).html('<a class=\"btn btn-primary\">保存草稿</a>');\n    $(dom).css('display', 'inline-block');\n    var btn = $(dom).find('a');\n    btn.click(function () {\n      var suiForm = $(\".sui-form\").sui();\n      var entity = suiForm.getValue();\n      var data = {};\n      var did = $(dom).attr('did');\n      data.creatorId = wf2.workflow.userObject.userId;\n      data.creatorName = wf2.workflow.userObject.userName;\n      data.title = entity[config.title] ? entity[config.title] : config.drafttitle;\n      data.process = config.process;\n      data.entity = JSON.stringify(entity);\n\n      if (did != 0) {\n        data.draftId = did;\n      } else {\n        data.draftId = config.draftId;\n      }\n\n      $.ajax({\n        url: \"com.sudytech.portalone.base.draft.draftService.saveDraft.biz.ext\",\n        type: 'post',\n        dataType: 'json',\n        data: data,\n        success: function success(data) {\n          $(dom).attr('did', data.id);\n          did = data.id;\n\n          if (!data.exception) {\n            alert(\"保存草稿成功\", function (index) {\n              $.isFunction(config.callback) && config.callback();\n              layer.close(index);\n            });\n          } else {\n            alert(\"保存草稿失败\");\n          }\n        }\n      });\n    });\n    $(dom).show();\n\n    if (SUI.Util.browserType() == 'phone' && config.useMobile == 'false') {\n      $(dom).hide();\n    }\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Draft/Draft.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExcelExport/ExcelExport.js":
/*!********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExcelExport/ExcelExport.js ***!
  \********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ExcelExport; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:13 PM\n */\n\n/**\n * excel导出\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction ExcelExport(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      className: $(el).attr('className') || 'btn-primary',\n      properties: {\n        name: $(el).attr('name'),\n        mspPreview: $(el).attr('msppreview'),\n        runtimeName: $(el).attr('runtimeName'),\n        displayname: $(el).attr('displayname'),\n        dataRange: $(el).attr('dataRange') //allData导出全部数据 dataForSearch根据搜索条件导出\n\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).addClass('isBtn');\n    $(dom).empty();\n    var runtimeName = config.properties.runtimeName;\n    var displayname = $.parseJSON(config.properties.displayname ? config.properties.displayname.replace(/\\'/g, '\"') : \"[]\") || [];\n    var dataRange = config.properties.dataRange;\n    var html = '<a class=\"btn ' + config.className + '\">导出excel</a>';\n    $(dom).html(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    $(dom).css(\"display\", \"inline-block\"); //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n    btn.click(function () {\n      var conditions = SUI.Util.getConditions();\n      /*查询中的脚本*/\n\n      var code = $('.sui-querywf').attr('beforeQuery');\n      eval('(function(){' + code + '})()');\n      var process = $('input[name=process]').val();\n      var params = {\n        process: process,\n        cols: displayname,\n        data: conditions,\n        order: []\n      };\n\n      if (dataRange === 'allData') {\n        params = {\n          process: process,\n          cols: displayname,\n          data: [],\n          order: []\n        };\n      }\n\n      var order = $('.sui-tablelist').attr('datasort');\n\n      if (order) {\n        params.order = typeof order == \"string\" ? eval('(' + order + ')') : [];\n      }\n\n      $.ajax({\n        url: 'com.sudytech.portalone.base.mspplus.dataManager.saveBizData.exportProcessInExcel.biz.ext',\n        type: 'post',\n        data: JSON.stringify(params),\n        contentType: \"text/json\",\n        success: function success(data) {\n          if (data.resultmap.resultCode === \"1\") {\n            window.location.href = data.resultmap.path;\n          } else if ($.isEmptyObject(data.resultmap)) {\n            // layer.alert(\"暂无数据!\");\n            SUI.Util.layerAlert({\n              content: '暂无数据！'\n            });\n          } else {\n            SUI.Util.layerAlert({\n              content: '导出失败，请联系管理员！'\n            });\n          }\n        },\n        error: function error(err) {\n          SUI.Util.layerAlert({\n            content: '导出失败，请联系管理员！'\n          });\n        }\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExcelExport/ExcelExport.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExportWordPdf/ExportWordPdf.js":
/*!************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExportWordPdf/ExportWordPdf.js ***!
  \************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return ExportWordPdf; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:21 PM\n */\n\n/**\n * 导出word/pdf\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction ExportWordPdf(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      exportType: $(el).attr('exporttype') || 'word',\n      properties: {\n        name: $(el).attr('name'),\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    var type = config.exportType;\n    var html = \"\";\n\n    if (type === 'word') {\n      html = '<a class=\"btn btn-primary\">导出word</a>';\n    }\n\n    if (type === 'pdf') {\n      html = '<a class=\"btn btn-primary\">导出pdf</a>';\n    }\n\n    $(dom).html(html);\n    $(dom).css('display', 'none');\n    $(dom).addClass('isBtn');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    if (config.properties.exportWordPdf) {\n      var word = config.properties.exportWordPdf.exportWord;\n      var pdf = config.properties.exportWordPdf.exportPdf;\n\n      if (word === 'true') {\n        if (SUI.Util.getQueryString(\"mode\") === 'preview') {\n          $(dom).css('display', 'inline-block');\n        }\n      }\n\n      if (pdf === 'true') {\n        if (SUI.Util.getQueryString(\"mode\") === 'preview') {\n          $(dom).css('display', 'inline-block');\n        }\n      }\n    }\n\n    var mode = SUI.Util.getQueryString('mode');\n\n    if (mode == 'print') {\n      $(dom).hide();\n      return;\n    }\n\n    var btn = $(dom).find('a');\n    var url = 'com.sudytech.portalone.base.word.word.exportWord.biz.ext';\n    var params = '';\n    var processInstId = wf2.workflow.entity && wf2.workflow.entity.processInstId ? wf2.workflow.entity.processInstId : '';\n    btn.on('click', function (e) {\n      if (type === 'word') {\n        params = {\n          processinstid: processInstId,\n          type: 'word'\n        };\n      }\n\n      if (type === 'pdf') {\n        params = {\n          processinstid: processInstId,\n          type: 'pdf'\n        };\n      }\n\n      $.ajax({\n        url: url,\n        data: params,\n        success: function success(data) {\n          if (data.result.resultCode == '0') {\n            window.location.href = __contextPath + data.result.path;\n          } else {\n            var errMsg = data.result.resultMsg || '导出失败！'; // layer.alert(errMsg);\n\n            SUI.Util.layerAlert({\n              content: errMsg\n            });\n          }\n        },\n        error: function error() {\n          // layer.alert('请求出错，请联系管理员！')\n          SUI.Util.layerAlert({\n            content: '请求出错，请联系管理员！'\n          });\n        }\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExportWordPdf/ExportWordPdf.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FileEdit/FileEdit.js":
/*!**************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FileEdit/FileEdit.js ***!
  \**************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return FileEdit; });\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/8/6 11:18 AM\n */\n//文件编辑*\nfunction FileEdit(bind) {\n  var value, config;\n  var dom = bind || $(\'<div></div>\').get(0);\n  dom.zoo = this;\n  var items, controlId, photos, btnId, uploadDo, editExt, redChro;\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    uploadDo = {\n      canEdit: config.properties.canEdit,\n      canUpload: config.properties.canUpload,\n      canDelete: config.properties.canDelete,\n      canCreate: config.properties.canCreate,\n      needConvert: config.properties.needConvert,\n      saveAtOnce: config.properties.saveAtOnce\n    };\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      uploadDo.canEdit = false;\n      uploadDo.canUpload = false;\n      uploadDo.canDelete = false;\n      uploadDo.canCreate = false;\n    }\n\n    if (mode == "editable") {\n      uploadDo.canUpload = true;\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == \'true\') {\n        var preview = \'<div class="file-items"></div><div class="wf-fileQueue" id="queue_upload0"></div><div class="btn btn-sm btn-primary btn-uploadify-mobile" id="btn_upload0" style="position: relative; overflow: hidden;"><input class="wf-fileControl upload-file-btn" type="" multiple="false" style="position: absolute; width: 1000px; height: 32px; font-size: 100px; top: -2px; bottom: 0px; right: -2px; opacity: 0;" id="_upload0"><i class="fa fa-upload"></i> 上传</div><div class="upload-loading"></div>\';\n        $(dom).html(preview);\n        return false;\n      }\n    }\n\n    render();\n    this.setValue(value);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.getValue = function () {\n    if (config.properties.multi == "true") {\n      var vals = [];\n      items.find("input").each(function () {\n        if (typeof $(this).val() == "string") {\n          if ("" == $(this).val()) {\n            return "";\n          } else {\n            vals[vals.length] = $(this).val();\n          }\n        } else {\n          vals[vals.length] = SUI.Util.toJsonString($(this).val());\n        }\n      });\n      return vals.length == 0 ? "" : SUI.Util.toJsonString(vals);\n    } else {\n      var arr = [];\n      var fileVal = items.find("input").val();\n\n      if (null == fileVal) {\n        return "";\n      }\n\n      if (typeof fileVal == "string") {\n        arr.push(fileVal);\n      } else {\n        arr.push(SUI.Util.toJsonString(fileVal));\n      }\n\n      return SUI.Util.toJsonString(arr);\n    }\n  };\n\n  function lazyLoading() {\n    var tasks = [];\n\n    this.run = function (id, task) {\n      tasks.push(task);\n      setTimeout(function () {\n        var temp = tasks;\n        tasks = [];\n\n        if (temp.length < 1) {\n          return;\n        }\n\n        var ids = [];\n        $.each(temp, function (i, t) {\n          ids.push(t.id);\n        });\n        $.ajax({\n          type: "POST",\n          url: SUI.settings().uploadify().getFile,\n          data: wf.jsonString({\n            entity: {\n              __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n              id: key,\n              ids: ids\n            }\n          }),\n          contentType: "text/json",\n          success: function success(data) {\n            $.each(temp, function (i, task) {\n              task.exe(data);\n            });\n          }\n        });\n      }, 200);\n    };\n  }\n\n  function loadOneFile(keyval) {\n    // var keyval = val[i];\n    var valObj = keyval;\n\n    if (_typeof(keyval) == "object") {\n      var show = keyval.show;\n      var word = "";\n\n      if (!show || "all" == show || "word" == show) {\n        keyval = keyval.word;\n      } else {\n        word = keyval.word;\n        keyval = keyval[show];\n      }\n\n      if (!keyval || keyval.length < 1) {\n        keyval = word;\n      }\n    }\n\n    var itemContent = \'<div data-key="\' + keyval + \'"></div>\';\n    items.append(itemContent);\n    $.ajax({\n      type: "POST",\n      url: SUI.settings().uploadify().getFile,\n      // async: false, //异步加载会出现重复setvalue的问题，setvalue时还没有加载出数据，所以不会清空之前的数据\n      data: wf.jsonString({\n        entity: {\n          __type: "sdo:com.sudytech.portalone.base.dataset.PoFiles",\n          id: keyval\n        }\n      }),\n      contentType: "text/json",\n      success: function success(data) {\n        var extend2 = data.value.extend2;\n\n        if (data.value.fileType == ".jpg" || data.value.fileType == ".jpeg" || data.value.fileType == ".gif" || data.value.fileType == ".bmp" || data.value.fileType == ".pdf") {\n          extend2 = data.value.id;\n        }\n\n        var item = createFileItem(valObj, data.value.fileName, data.value.fileLength, editExt, redChro, true, extend2);\n        var itemContent = items.find(\'[data-key=\' + keyval + \']\');\n\n        if (itemContent.length > 0) {\n          itemContent.html(item);\n        }\n\n        onchange();\n      }\n    });\n  }\n\n  this.setValue = function (val) {\n    var mode = config.mode || "view";\n    value = val;\n    config.value = val;\n    items.empty();\n    photos.data = [];\n\n    if (val) {\n      var fileids = [];\n      var fileKeys = SUI.Util.parseJSON(val, true);\n      $.each(fileKeys, function (i, key) {\n        var keyJson = {};\n\n        if (typeof key == "string") {\n          keyJson = SUI.Util.parseJSON(key, true);\n        } else {\n          keyJson = key;\n        }\n\n        fileids.push(keyJson);\n      });\n\n      for (var i in fileids) {\n        loadOneFile(fileids[i]);\n      }\n    } else {\n      items.html(mode == "editable" ? config.placeholder : config.emptyText);\n    }\n  };\n\n  this.getExt = function () {\n    var cur = this.getValue();\n    var ary = [];\n    var changeName = config.properties.changeName;\n    var show = config.properties.show;\n\n    if (!changeName) {\n      changeName = "";\n    }\n\n    if (!show) {\n      show = "";\n    }\n\n    var valarr = [];\n    var valstr = [];\n\n    if (null == value || "" == value) {\n      valstr = "";\n    } else {\n      if (typeof value == "string") {\n        valarr = SUI.Util.parseJSON(value);\n      } else {\n        valarr = value;\n      }\n\n      for (var i = 0; i < valarr.length; i++) {\n        if (_typeof(valarr[i]) == "object") {\n          valstr.push(SUI.Util.toJsonString(valarr[i]));\n        } else {\n          valstr.push(valarr[i]);\n        }\n      }\n\n      valstr = SUI.Util.toJsonString(valstr);\n    }\n\n    if (SUI.Util.compare(cur, valstr)) {\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName,\n        show: show\n      };\n    } //多选\n\n\n    if (config.properties.multi == "true") {\n      var srcAry = SUI.Util.parseJSON(value || \'[]\');\n      var curAry = SUI.Util.parseJSON(cur || \'[]\');\n\n      var contains = function contains(item, collect) {\n        var contains = false;\n        var obj1 = {};\n        var obj2 = {};\n        $.each(collect, function (i, d) {\n          if (typeof item == "string") {\n            obj1 = SUI.Util.parseJSON(item);\n          } else {\n            obj1 = item;\n          }\n\n          if (typeof d == "string") {\n            obj2 = SUI.Util.parseJSON(d);\n          } else {\n            obj2 = d;\n          }\n\n          if (obj2.word == obj1.word) {\n            contains = true;\n          }\n        });\n        return contains;\n      }; //双向比较\n\n\n      var temp = "";\n      $.each(srcAry, function (i, item) {\n        if (!contains(item, curAry)) {\n          if (typeof item == "string") {\n            temp = item;\n          } else {\n            temp = SUI.Util.toJsonString(item);\n          }\n\n          ary[ary.length] = {\n            value: temp,\n            op: "delete"\n          };\n        }\n      });\n      $.each(curAry, function (i, item) {\n        if (!contains(item, srcAry)) {\n          if (typeof item == "string") {\n            temp = item;\n          } else {\n            temp = SUI.Util.toJsonString(item);\n          }\n\n          ary[ary.length] = {\n            value: temp,\n            op: "insert"\n          };\n        }\n      });\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName,\n        show: show\n      };\n    } else {\n      var temp = [];\n\n      if (cur) {\n        if (typeof cur == "string") {\n          temp = SUI.Util.parseJSON(cur);\n        } else {\n          temp = cur;\n        }\n\n        ary[ary.length] = {\n          value: temp[0],\n          op: "insert"\n        };\n      }\n\n      if (valstr) {\n        if (typeof valstr == "string") {\n          temp = SUI.Util.parseJSON(valstr);\n        } else {\n          temp = valstr;\n        }\n\n        ary[ary.length] = {\n          value: temp[0],\n          op: "delete"\n        };\n      }\n\n      return {\n        type: "fileUpload",\n        value: ary,\n        nameStyle: changeName,\n        show: show\n      };\n    }\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = this.getValue();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr("mode");\n    temp.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      canEdit: element.attr("canEdit") !== "false",\n      canUpload: element.attr("canUpload") !== "false",\n      canDelete: element.attr("canDelete") !== "false",\n      canCreate: element.attr("canCreate") == "true",\n      needConvert: element.attr("needConvert") == "false" ? false : element.attr("needConvert"),\n      saveAtOnce: element.attr("saveAtOnce") !== "false",\n      multi: element.attr("multi"),\n      max: (element.attr("max") || 5) - 0,\n      ext: element.attr("ext"),\n      // \'*.gif; *.jpg; *.png\' 使用分号分割\n      preview: element.attr("preview"),\n      previewWidth: Number(element.attr("previewWidth") || "0"),\n      previewShadeClose: element.attr("previewShadeClose") == "true",\n      previewStyle: element.attr("previewStyle") || "",\n      buttonText: element.attr("buttonText") || "上传",\n      buttonWidth: Number(element.attr("buttonWidth") || "60"),\n      fileSizeLimit: Number(element.attr("fileSizeLimit") || "0"),\n      editExt: element.attr("editExt"),\n      redChro: element.attr("redChro"),\n      workItemId: element.attr("workItemId"),\n      activityId: element.attr("activityId"),\n      mspPreview: element.attr("msppreview"),\n      changeName: element.attr("changeName"),\n      show: element.attr("show"),\n      releName: element.attr("releName")\n    };\n    temp.placeholder = element.attr("placeholder") || "";\n    temp.emptyText = element.attr("emptyText") || "";\n    temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    temp.value = element.attr("value") || "";\n    return temp;\n  };\n\n  this.getEditExt = function () {\n    return editExt;\n  };\n\n  this.getRedChro = function () {\n    return redChro;\n  };\n\n  this.editClick = function () {\n    editBtnClick();\n  };\n\n  function render() {\n    var require = config.validate && config.validate.require ? "*" : "";\n\n    var html = \'\';\n    html += \'<div class="file-items"></div>\' + \'<div class="wf-fileQueue"></div>\' + \'<input class="wf-fileControl" type="file" multiple="false" style="display:none"/>\';\n    $(dom).html(html);\n    var div = $(dom);\n    var params = config.properties;\n    editExt = params.editExt;\n    redChro = params.redChro;\n    var control = div.find(".wf-fileControl");\n    var id = "_upload" + SUI.Util.getSequence("fileUpload");\n    btnId = "btn" + id;\n    controlId = id;\n    control.attr("id", id);\n    var queue = div.find(".wf-fileQueue");\n    var queueID = "queue" + id;\n    queue.attr("id", queueID);\n    var resultData;\n    items = div.find(".file-items");\n    photos = {\n      title: params.title,\n      id: Number(new Date()),\n      start: 0,\n      data: []\n    };\n    var cloneCtrl = null;\n\n    var resetControl = function resetControl(formData) {\n      if (formData) {\n        control[0].value = "";\n      } else {\n        var control2 = cloneCtrl.clone(true, false);\n        control.replaceWith(control2);\n        control = control2;\n      }\n    };\n\n    if (uploadDo.canUpload) {\n      var isMobile = SUI.Util.browserType() == "phone";\n      var mobileBtn = $(\'<div class="btn btn-sm btn-primary btn-uploadify-mobile" id="\' + btnId + \'" />\').css({\n        "position": "relative",\n        "overflow": "hidden"\n      }); //isMobile = true;\n\n      var ajaxUp = window.FormData;\n\n      if (ajaxUp) {\n        control.show();\n        control.addClass("upload-file-btn").css({\n          position: \'absolute\',\n          width: 1000,\n          height: 32,\n          fontSize: \'100px\',\n          top: -2,\n          bottom: 0,\n          right: -2,\n          opacity: 0\n        }).wrap(mobileBtn);\n        control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n\n        if (uploadDo.canCreate) {\n          var onLineEditBtn = $(\'<div class="btn btn-sm btn-primary btn-uploadify-mobile" id="edit\' + btnId + \'" />\').css({\n            "position": "relative",\n            "overflow": "hidden",\n            "margin-left": "10px"\n          });\n          div.append(onLineEditBtn);\n          $("#edit" + btnId).append(\'<i class="fa fa-file-word-o"></i> 撰写\');\n        }\n\n        var loadingView = $(\'<div class="upload-loading" />\');\n        div.append(loadingView);\n        control.on("change", function () {\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl(true);\n          }\n\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              icon: 2,\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          }\n\n          if (!checkFileSize(control, params.fileSizeLimit)) {\n            layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n              icon: 2,\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl(true);\n          }\n\n          var formData = new FormData();\n          var settings = SUI.settings().uploadify({});\n          var releName = config.properties.releName;\n          var changeName = config.properties.changeName;\n\n          if (releName && changeName) {\n            var fileName = $("div[name=" + releName + "]").sui();\n\n            if (fileName && fileName.getValue().trim()) {\n              settings.uploader = settings.uploader + "?releName=" + encodeURIComponent(fileName.getValue().trim());\n            }\n          } //formData.append("a", "");\n          //formData.append("","");\n\n\n          formData.append("Filedata", control.get(0).files[0]);\n          loadingView.html("正在上传……");\n          $.ajax({\n            url: settings.uploader,\n            type: \'POST\',\n            data: formData,\n            xhr: function xhr() {\n              //获取ajaxSettings中的xhr对象，为它的upload属性绑定progress事件的处理函数\n              var myXhr = $.ajaxSettings.xhr();\n\n              if (myXhr.upload) {\n                //检查upload属性是否存在\n                //绑定progress事件的回调函数\n                myXhr.upload.addEventListener(\'progress\', function (e) {\n                  if (e.lengthComputable) {\n                    var percent = e.loaded / e.total * 100;\n                    percent = percent + "";\n                    percent = percent.substring(0, 4);\n                    loadingView.html("正在上传…… " + percent + "%");\n                  }\n                }, false);\n              }\n\n              return myXhr; //xhr对象返回给jQuery使用\n            },\n            processData: false,\n            //必须false才会避开jQuery对 formdata 的默认处理\n            contentType: false,\n            // 必须false才会自动加上正确的Content-Type\n            success: function success(data) {\n              loadingView.empty();\n              resultData = $.parseJSON(data);\n\n              if (resultData.error) {\n                var errorInfo = resultData.error;\n\n                if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                  if (errorInfo.lastIndexOf("maximum") > 0) {\n                    var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                    maximum = maximum / 1024 / 1024;\n                    errorInfo = "上传文件不得超过" + maximum + "M";\n                  } else {\n                    errorInfo = "文件大小超过系统限制";\n                  }\n                }\n\n                layer.alert("上传失败，" + errorInfo, {\n                  icon: 2,\n                  title: \'提示\',\n                  closeBtn: 0\n                });\n              } else {\n                var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, editExt, redChro, true, null);\n                items.append(item);\n                onchange();\n                $(dom).trigger("onUploadSuccess", [resultData]);\n              }\n            },\n            error: function error(responseStr) {\n              loadingView.empty();\n              var errorInfo = responseStr;\n\n              if (_typeof(errorInfo) == "object") {\n                errorInfo = "请检查网络设置";\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                icon: 2,\n                title: \'提示\',\n                closeBtn: 0\n              });\n            },\n            complete: function complete() {\n              // reset input, 再次上传相同无法触发change事件，导致无法上传已上传过的文件\n              return resetControl(true);\n            }\n          });\n        }); //在线编辑\n\n        $("#edit" + btnId).on("click", function () {\n          onLineEdit(this);\n        }); //在线编辑\n      } else if (true) {\n        control.show();\n        control.addClass("upload-file-btn").css({\n          position: \'absolute\',\n          width: 1000,\n          height: 32,\n          fontSize: \'100px\',\n          top: -2,\n          bottom: 0,\n          right: -2,\n          opacity: 0\n        }).wrap(mobileBtn);\n        var settings = SUI.settings().uploadify({});\n        var winName = "winName_fileUpload" + SUI.Util.getSequence("fileUpload"),\n            formId = \'form_\' + winName; //control.wrap(form);\n\n        control.after(\'<i class="fa fa-upload"></i> \' + params.buttonText);\n\n        if (uploadDo.canCreate) {\n          var onLineEditBtn = $(\'<div class="btn btn-sm btn-primary btn-uploadify-mobile" id="edit\' + btnId + \'" />\').css({\n            "position": "relative",\n            "overflow": "hidden",\n            "margin-left": "10px"\n          });\n          div.append(onLineEditBtn);\n          $("#edit" + btnId).append(\'<i class="fa fa-file-word-o"></i> 撰写\');\n        }\n\n        var loadingView = $(\'<div class="upload-loading" /><div style="display:none;"><iframe name="\' + winName + \'" src="about:blank"></iframe></div>\');\n        div.append(loadingView);\n        loadingView = loadingView.first();\n        var form = $(\'<form id="\' + formId + \'" action="#" method="post" enctype ="multipart/form-data" target="\' + winName + \'"></form>\');\n        form.on("submit", function (e) {\n          e.stopPropagation();\n        });\n        form.prop(\'uploadResult\', {\n          call: function call(data) {\n            loadingView.empty();\n            resultData = data;\n\n            if (resultData.error) {\n              var errorInfo = resultData.error;\n\n              if (errorInfo.lastIndexOf("SizeLimitExceededException") > 0) {\n                if (errorInfo.lastIndexOf("maximum") > 0) {\n                  var maximum = errorInfo.substring(errorInfo.lastIndexOf("(") + 1, errorInfo.lastIndexOf(")"));\n                  maximum = maximum / 1024 / 1024;\n                  errorInfo = "上传文件不得超过" + maximum + "M";\n                } else {\n                  errorInfo = "文件大小超过系统限制";\n                }\n              }\n\n              layer.alert("上传失败，" + errorInfo, {\n                icon: 2,\n                title: \'提示\',\n                closeBtn: 0\n              });\n            } else {\n              if (!checkFileSize(resultData.fileSize, params.fileSizeLimit, true)) {\n                return layer.alert("上传失败，上传文件不得超过" + params.fileSizeLimit + "KB", {\n                  icon: 2,\n                  title: \'提示\',\n                  closeBtn: 0\n                });\n              }\n\n              var item = createFileItem(resultData.fileKey, resultData.fileName, resultData.fileSize, editExt, redChro, true, null);\n              items.append(item);\n              onchange();\n              $(dom).trigger("onUploadSuccess", [resultData]);\n            }\n          }\n        });\n        control.after(form);\n        form.append(control);\n        control.on("change", function () {\n          control.attr("name", "Filedata"); //判断是否被修改域，导致iframe跨域\n\n          var domain = window.location.host;\n\n          if (domain.indexOf(":") > -1) {\n            domain = domain.substring(0, domain.indexOf(":"));\n          }\n\n          if (domain != document.domain) {\n            domain = "document.domain=\'" + document.domain + "\';";\n          } else {\n            domain = "";\n          }\n\n          var formScript = domain + " parent.document.getElementById(\'" + formId + "\').uploadResult.call";\n          formScript = stringToHex(formScript);\n          var url = settings.uploader + "?formScript=" + formScript;\n          form.attr("action", url);\n          var fileName = control.val();\n\n          if (!fileName) {\n            return resetControl();\n          }\n\n          var validate = checkFileName(fileName);\n\n          if (!validate) {\n            layer.alert("上传失败，允许上传文件类型为：" + params.ext, {\n              icon: 2,\n              title: \'提示\',\n              closeBtn: 0\n            });\n            return resetControl();\n          }\n\n          form.submit();\n          loadingView.html("正在上传……");\n          resetControl(); // 修复ie9及以下 上传相同文件无法触发 change事件的bug\n        });\n        cloneCtrl = control.clone(true, false); //在线编辑\n\n        $("#edit" + btnId).on("click", function () {\n          onLineEdit(this);\n        }); //在线编辑\n      } else {}\n    }\n\n    function onLineEdit(el) {\n      var fileDiv = el.parentElement;\n      var sao = config.properties.saveAtOnce == false ? "false" : "true";\n      var url = __basePath + "ioffice/editor.jsp?saveAtOnce=" + sao;\n      var dWidth = document.documentElement.clientWidth;\n      var dHeight = window.screen.availHeight - 70;\n      var paramArr = [];\n      paramArr[0] = window; //编辑状态\n\n      paramArr[1] = config.properties.workItemId; //workItemId\n\n      paramArr[2] = config.properties.activityId; //activityId\n\n      paramArr[3] = "";\n      paramArr[4] = "";\n      paramArr[5] = "";\n      paramArr[6] = "";\n      paramArr[7] = "";\n      paramArr[8] = "";\n      paramArr[9] = [];\n      paramArr[10] = "";\n      paramArr[13] = config.properties.needConvert;\n      var ee = config.properties.editExt;\n\n      if (undefined != ee && ee.length > 2) {\n        var extJson = SUI.Util.parseJSON(ee);\n\n        if (extJson.redTitle) {\n          paramArr[3] = extJson.redTitle;\n        } else {\n          paramArr[3] = "";\n        }\n\n        if (extJson.dicttype) {\n          paramArr[4] = extJson.dicttype;\n        } else {\n          paramArr[4] = "";\n        }\n\n        if (extJson.template) {\n          paramArr[10] = extJson.template;\n        }\n      }\n\n      var redParam = [];\n      var redJson = {};\n      var redVal = "";\n\n      if (undefined != redChro && redChro.length > 0) {\n        var redArr = SUI.Util.parseJSON(redChro);\n\n        for (var i = 0; i < redArr.length; i++) {\n          if ("string" == typeof redArr[i]) {\n            redJson = SUI.Util.parseJSON(redArr[i]);\n          } else {\n            redJson = redArr[i];\n          }\n\n          redVal = redJson.value;\n\n          if ($("div[name=\'" + redVal + "\']").sui()) {\n            redJson.value = $("div[name=\'" + redVal + "\']").sui().getValue();\n          }\n\n          redParam.push(redJson);\n        }\n\n        paramArr[9] = redParam;\n      } //在线撰写修改文件名\n\n\n      var releName = config.properties.releName;\n\n      if (releName) {\n        var fileName = $("div[name=" + releName + "]").sui();\n\n        if (fileName && fileName.getValue().trim()) {\n          url = url + "&releName=" + encodeURIComponent(fileName.getValue().trim());\n        }\n      }\n\n      var pWindow = getParentWindow();\n\n      if (pWindow) {\n        var localHost = window.location.host;\n        url = window.location.protocol + "//" + window.location.hostname + (window.location.port ? \':\' + window.location.port : \'\') + url;\n        pWindow.layer.open({\n          type: 2,\n          maxmin: true,\n          shade: 0.6,\n          area: [dWidth + "px", dHeight + "px"],\n          scrollbar: false,\n          content: url,\n          //iframe的url\n          success: function success(layero, index) {\n            var f = pWindow[layero.find(\'iframe\')[0][\'name\']];\n            f.setOpener(paramArr);\n            $(".layui-layer-title", layero).remove();\n            $(".layui-layer-max", layero).trigger("click");\n          }\n        });\n      } else {\n        layer.open({\n          type: 2,\n          maxmin: true,\n          shade: 0.6,\n          area: [dWidth + "px", dHeight + "px"],\n          scrollbar: false,\n          content: url,\n          //iframe的url\n          success: function success(layero, index) {\n            var f = window[layero.find(\'iframe\')[0][\'name\']];\n            f.setOpener(paramArr);\n            $(".layui-layer-title", layero).remove();\n            $(".layui-layer-max", layero).trigger("click");\n          }\n        });\n      }\n    }\n\n    function stringToHex(str) {\n      if (!str) {\n        return "";\n      }\n\n      var hex = str.charCodeAt(0).toString(16);\n\n      for (var i = 1; i < str.length; i++) {\n        var code = str.charCodeAt(i).toString(16);\n        hex += "," + code;\n      }\n\n      hex = hex.toUpperCase();\n      return hex;\n    }\n\n    function checkFileName(fileName) {\n      if (!config.properties.ext) {\n        return true;\n      }\n\n      var ext = fileName.substring(fileName.lastIndexOf("."));\n      var splits = config.properties.ext.split(";");\n\n      for (var i = 0; i < splits.length; i++) {\n        var filePattern = $.trim(splits[i]);\n        var ext2 = filePattern.substring(filePattern.lastIndexOf("."));\n\n        if (ext.toLowerCase() == ext2.toLowerCase()) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function checkFileSize(el, maxSize, isNum) {\n      if (!isNum) {\n        var file = $(el)[0];\n\n        if (maxSize > 0 && file.files[0].size > maxSize * 1024) {\n          return false;\n        }\n      } else {\n        var size = Number(el);\n\n        if (size && maxSize && size > maxSize * 1024) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    var getResultData = function getResultData() {\n      return resultData;\n    };\n  }\n\n  function onchange() {\n    if (!uploadDo.canUpload) {\n      return;\n    }\n\n    $(dom).trigger(\'change\');\n    var len = items.find(".file-item").length;\n    var uploader = $("#" + controlId + \', #\' + btnId);\n    var editer = $("#" + controlId + \', #edit\' + btnId);\n\n    if (config.properties.multi == "true") {\n      if (len < config.properties.max) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    } else {\n      if (len == 0) {\n        uploader.show();\n\n        if (editer && uploadDo.canCreate) {\n          editer.show();\n        }\n      } else {\n        uploader.hide();\n\n        if (editer) {\n          editer.hide();\n        }\n      }\n    }\n  }\n\n  function convertWordToImage(fileKey, process, needPdf) {\n    var fileKeys = null;\n    $.ajax({\n      url: \'com.sudytech.portalone.base.core.convert.convertWordToImage.biz.ext\',\n      type: \'POST\',\n      data: SUI.Util.toJsonString({\n        fileId: fileKey,\n        isTemp: false,\n        //TODO:等涂大强的附件上传到temp时改成true\n        process: process,\n        needPdf: needPdf\n      }),\n      contentType: \'text/json\',\n      async: false,\n      success: function success(d) {\n        var result = d.result;\n\n        if (result && "fail" != result.result) {\n          fileKeys = result;\n        }\n      }\n    });\n    return fileKeys;\n  }\n\n  function editBtnClick() {\n    var dWidth = document.documentElement.clientWidth;\n    var dHeight = window.screen.availHeight - 70;\n\n    if (!pConfig) {\n      pConfig = config;\n      pEditExt = config.properties.editExt;\n      pStrKey = config.pStrKey;\n    }\n\n    var paramArr = [];\n    paramArr[0] = window; //编辑状态\n\n    paramArr[1] = pConfig.properties.workItemId; //workItemId\n\n    paramArr[2] = pConfig.properties.activityId; //activityId\n\n    paramArr[3] = "";\n    paramArr[4] = "";\n    paramArr[5] = "";\n    paramArr[6] = "";\n    paramArr[7] = "";\n    paramArr[8] = "";\n    paramArr[9] = [];\n    paramArr[11] = "";\n    paramArr[12] = "";\n    paramArr[13] = pConfig.properties.needConvert; //编辑属性扩展\n\n    if (undefined != pEditExt && pEditExt.length > 2) {\n      var extJson = SUI.Util.parseJSON(pEditExt);\n\n      if (extJson.redTitle) {\n        paramArr[3] = extJson.redTitle;\n      }\n\n      if (extJson.dicttype) {\n        paramArr[4] = extJson.dicttype;\n      }\n\n      if (extJson.pdf) {\n        paramArr[5] = extJson.pdf;\n      }\n\n      if (extJson.img) {\n        paramArr[6] = extJson.img;\n      }\n\n      if (extJson.signature) {\n        paramArr[7] = extJson.signature;\n      }\n\n      if (extJson.print) {\n        paramArr[8] = extJson.print;\n      }\n\n      if (extJson.redname) {\n        paramArr[11] = $("div[name=\'" + extJson.redname + "\']").sui().getValue();\n      }\n\n      if (extJson.mark) {\n        paramArr[12] = extJson.mark;\n      }\n    }\n\n    var redParam = [];\n    var redJson = {};\n    var redVal = "";\n\n    if (undefined != redChro && redChro.length > 0) {\n      var redArr = SUI.Util.parseJSON(redChro);\n\n      for (var i = 0; i < redArr.length; i++) {\n        if ("string" == typeof redArr[i]) {\n          redJson = SUI.Util.parseJSON(redArr[i]);\n        } else {\n          redJson = redArr[i];\n        }\n\n        redVal = redJson.value;\n\n        if ($("div[name=\'" + redVal + "\']").sui()) {\n          redJson.value = $("div[name=\'" + redVal + "\']").sui().getValue();\n        }\n\n        redParam.push(redJson);\n      }\n\n      paramArr[9] = redParam;\n    }\n\n    var sao = config.properties.saveAtOnce == false ? "false" : "true";\n    var url = __basePath + "ioffice/editor.jsp?fileId=" + pStrKey + "&saveAtOnce=" + sao;\n    var pWindow = getParentWindow();\n\n    if (pWindow) {\n      var localHost = window.location.host;\n      url = window.location.protocol + "//" + window.location.hostname + (window.location.port ? \':\' + window.location.port : \'\') + url;\n      pWindow.layer.open({\n        type: 2,\n        maxmin: true,\n        shade: 0.6,\n        area: [dWidth + "px", dHeight + "px"],\n        scrollbar: false,\n        content: url,\n        //iframe的url\n        success: function success(layero, index) {\n          var f = pWindow[layero.find(\'iframe\')[0][\'name\']];\n          f.setOpener(paramArr);\n          $(".layui-layer-title", layero).remove();\n          $(".layui-layer-max", layero).trigger("click");\n        }\n      });\n    } else {\n      layer.open({\n        type: 2,\n        maxmin: true,\n        shade: 0.6,\n        area: [dWidth + "px", dHeight + "px"],\n        scrollbar: false,\n        content: url,\n        //iframe的url\n        success: function success(layero, index) {\n          var f = window[layero.find(\'iframe\')[0][\'name\']];\n          f.setOpener(paramArr);\n          $(".layui-layer-title", layero).remove();\n          $(".layui-layer-max", layero).trigger("click");\n        }\n      });\n    }\n  }\n\n  var pConfig;\n  var pEditExt;\n  var pStrKey;\n\n  function createFileItem(fileKey, fileName, fileSize, editExt, redChro, isTemp, extend2) {\n    var div = $(\'<div class="file-item"><input class="wf-fileInput" type="hidden" /><a class="wf-fileView"></a> \' + \'<span class="btn btn-sm btn-danger wf-delete"><i class="fa fa-close"></i> 删除</span> \' + \'<span class="btn btn-sm btn-success wf-editBtn"><i class="fa fa-edit"></i> 编辑</span> \' + \'<span class="btn btn-sm btn-success wf-pdfBtn" style="display:inline"><i class="fa fa-file-pdf-o"></i> 查看pdf</span> \' + \'<span class="btn btn-sm btn-success wf-imgBtn" style="display:inline"><i class="fa fa-file-image-o"></i> 查看正文</span> \' + \'<span class="btn btn-sm btn-primary wf-saveBtn"><i class="fa fa-upload"></i> 上传</span></div>\');\n    var view = div.find(".wf-fileView");\n    fileSize = fileSize - 0;\n\n    if (fileSize < 1024) {\n      fileSize = fileSize + "Bit";\n    } else if (fileSize < 1024 * 1024) {\n      fileSize = (fileSize / 1024).toFixed(1) + "KB";\n    } else if (fileSize < 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024)).toFixed(1) + "MB";\n    } else if (fileSize < 1024 * 1024 * 1024 * 1024) {\n      fileSize = (fileSize / (1024 * 1024 * 1024)).toFixed(1) + "GB";\n    }\n\n    var filterFileName = fileName.match(/[^/\\\\\\\\]+$/);\n\n    if (filterFileName) {\n      fileName = filterFileName[0];\n    }\n\n    view.html(SUI.Util.htmlEncode(fileName) + \' (\' + fileSize + \')\');\n    var save = div.find(".wf-saveBtn");\n    save.hide();\n    save.click(function () {\n      if (editor.get(0).checkEdit() == 1) {\n        editor.get(0).save();\n      } else {\n        alert("未修改");\n      }\n    });\n    var input = div.find("input");\n    var inputVal = {};\n    var strKey = "";\n    var showBtn = true;\n\n    if (typeof fileKey == "string") {\n      inputVal = {\n        "word": fileKey,\n        "pdf": "",\n        "img": ""\n      };\n      strKey = fileKey;\n    } else {\n      inputVal = fileKey;\n      var show = inputVal.show;\n\n      if (!show || "all" == show || "word" == show) {\n        strKey = inputVal.word;\n      } else {\n        strKey = inputVal[show];\n      }\n\n      if (strKey.length < 1) {\n        strKey = inputVal.word;\n      }\n\n      if ("pdf" == show && "" != inputVal[show]) {\n        showBtn = false;\n      }\n\n      if (!show && config.properties.show) {\n        inputVal.tempShow = config.properties.show;\n      }\n    }\n\n    config.pStrKey = strKey;\n\n    if (isTemp && config.properties.needConvert && config.properties.process && !inputVal.img) {\n      isTemp = false; //TODO:等涂大强的附件上传到temp时再去掉\n\n      var convertResult = convertWordToImage(strKey, config.properties.process, true);\n\n      if (null != convertResult) {\n        if (config.properties.needConvert.lastIndexOf("pdf") > -1) {\n          inputVal.pdf = convertResult.pdf;\n        }\n\n        if (config.properties.needConvert.lastIndexOf("img") > -1) {\n          inputVal.img = convertResult.img;\n        }\n      }\n    }\n\n    input.val(SUI.Util.toJsonString(inputVal)); //查看pdf和图片展示和隐藏\n\n    var pdf = div.find(".wf-pdfBtn");\n    var img = div.find(".wf-imgBtn");\n    var keyJson = inputVal;\n\n    if ("" == keyJson.pdf || !showBtn) {\n      pdf.hide();\n    }\n\n    if ("" == keyJson.img) {\n      img.hide();\n    }\n\n    var editBtn = div.find(".wf-editBtn");\n    editBtn.hide();\n    editBtn.click(function () {\n      fileDiv = this.parentElement.parentElement.parentElement;\n      pConfig = config;\n      pEditExt = editExt;\n      pStrKey = strKey;\n      var preFunc = SUI.Util.parseJSON(editExt).preFunc;\n\n      if (preFunc) {\n        var func = eval(preFunc);\n\n        if (func) {\n          func(editBtnClick);\n        }\n      } else {\n        editBtnClick();\n      }\n    });\n    img.click(function () {\n      layer.open({\n        type: 2,\n        title: "查看正文",\n        maxmin: true,\n        shade: 0.6,\n        area: [800 + "px", 600 + "px"],\n        scrollbar: true,\n        closeBtn: 1,\n        content: __basePath + "openImg/showImg.jsp",\n        //iframe的url，替换\n        success: function success(layero, index) {\n          var f = window[layero.find(\'iframe\')[0][\'name\']];\n          f.setData(inputVal.img);\n          $(".layui-layer-max", layero).trigger("click");\n        }\n      });\n    });\n    pdf.click(function () {\n      if ("pdf" == config.properties.show) {\n        var parame = "";\n\n        if (SUI.Util.browserPlantform() == "ios") {\n          parame = "?filename=uuid";\n        }\n\n        location.href = SUI.settings().uploadify().downloadPath + inputVal.pdf + parame;\n        /* pdf.html(\'<a class="pdfHref"><i class="fa fa-file-pdf-o"></i> 查看pdf</a>\');\n         var pdfHref = pdf.find(".pdfHref");\n          pdfHref.attr({\n             "href": SUI.settings().uploadify().downloadPath + inputVal.pdf + parame,\n             "target": "_blank"\n         });*/\n      } else {\n        //参数设置\n        var paramArr = [];\n        paramArr[0] = window; //编辑状态\n\n        paramArr[1] = config.properties.workItemId; //workItemId\n\n        paramArr[2] = config.properties.activityId; //activityId\n\n        paramArr[3] = "";\n\n        if (undefined != editExt && editExt.length > 2) {\n          var extJson = SUI.Util.parseJSON(editExt);\n\n          if (extJson.signature) {\n            paramArr[3] = extJson.signature;\n          }\n        }\n\n        var url = __basePath + "iwebpdf/view.jsp?fileId=" + inputVal.pdf;\n        var dWidth = document.documentElement.clientWidth;\n        var dHeight = window.screen.availHeight - 70;\n        var pWindow = getParentWindow();\n\n        if (pWindow) {\n          var localHost = window.location.host;\n          url = window.location.protocol + "//" + window.location.hostname + (window.location.port ? \':\' + window.location.port : \'\') + url;\n          pWindow.layer.open({\n            type: 2,\n            maxmin: true,\n            shade: 0.6,\n            area: [dWidth + "px", dHeight + "px"],\n            scrollbar: false,\n            content: url,\n            //iframe的url\n            success: function success(layero, index) {\n              var f = pWindow[layero.find(\'iframe\')[0][\'name\']];\n              f.setOpener(paramArr);\n              $(".layui-layer-title", layero).remove();\n              $(".layui-layer-max", layero).trigger("click");\n            }\n          });\n        } else {\n          layer.open({\n            type: 2,\n            maxmin: true,\n            shade: 0.6,\n            area: [dWidth + "px", dHeight + "px"],\n            scrollbar: false,\n            content: url,\n            //iframe的url\n            success: function success(layero, index) {\n              var f = window[layero.find(\'iframe\')[0][\'name\']];\n              f.setOpener(paramArr);\n              $(".layui-layer-title", layero).remove();\n              $(".layui-layer-max", layero).trigger("click");\n            }\n          });\n        }\n      }\n    });\n    view.click(function () {\n      var parame = "";\n\n      if (SUI.Util.browserPlantform() == "ios") {\n        parame = "?filename=uuid";\n      } else if (SUI.Util.browserPlantform() == "android") {\n        parame = "?" + config.appStoreLoginParam;\n      }\n\n      if (!config.onLinePreview) {\n        view.attr({\n          "href": SUI.settings().uploadify().downloadPath + strKey + parame,\n          "target": "_blank"\n        });\n      } else {\n        view.attr({\n          "onclick": open(strKey, extend2, fileName)\n        });\n      }\n    });\n\n    if (config.properties.preview && /\\.(png|gif|jpg|jpeg|bmp|ico)$/i.test(fileName)) {\n      var $imgView = $(\'<div class="file-imageview" />\'),\n          src = SUI.settings().uploadify().downloadPath + strKey,\n          alt = fileName.split(".")[0];\n      $imgView.html(\'<div class="imageview-box"><img style="\' + config.properties.previewStyle + \'" title="点击预览" src="\' + src + \'" alt="\' + alt + \'" /></div>\');\n      if (config.properties.previewWidth) $("img", $imgView).css("width", config.properties.previewWidth);\n      $imgView.prependTo(div);\n      var pid = "img-" + Number(new Date());\n      div.attr("previewid", pid);\n      photos.data.push({\n        "alt": alt,\n        "pid": pid,\n        //图片id\n        "src": src,\n        //原图地址\n        "thumb": src //缩略图地址\n\n      });\n      $imgView.find(\'img\').on(\'click\', function (event) {\n        event.preventDefault();\n        photos.start = APP.inArrayObj(\'pid\', pid, photos.data);\n\n        if (window.layer) {\n          layer.photos({\n            photos: photos,\n            shift: 5,\n            full: 1,\n            fullscreen: 1,\n            fulltools: 1,\n            shadeClose: config.properties.previewShadeClose\n          });\n        } else {\n          alert(\'图片预览需要加载layer\');\n        }\n      });\n    }\n\n    var delBtn = div.find(".wf-delete");\n    delBtn.hide();\n    delBtn.click(function () {\n      var delinfo = config.properties.editExt;\n      var info = "是否确认删除？";\n\n      if (undefined != delinfo && delinfo.length > 2) {\n        var extJson = SUI.Util.parseJSON(delinfo);\n\n        if (extJson.info && extJson.info.length > 0) {\n          info = extJson.info;\n        }\n      }\n\n      layer.confirm(info, {\n        icon: 3,\n        title: \'提示\'\n      }, function () {\n        if (div.attr(\'previewid\')) {\n          var pindex = APP.inArrayObj(\'pid\', div.attr(\'previewid\'), photos.data);\n\n          if (pindex !== -1) {\n            photos.data.splice(pindex, 1);\n          }\n        }\n\n        div.remove();\n        onchange();\n        layer.closeAll(\'dialog\');\n      });\n    });\n\n    if (uploadDo.canEdit) {\n      if (showBtn && SUI.Util.browserPlantform() == "pc") {\n        editBtn.show();\n      }\n    }\n\n    if (uploadDo.canDelete) {\n      delBtn.show();\n    }\n\n    return div;\n  }\n\n  function open(fileId, extend2, fileName) {\n    var type = fileName.substring(fileName.lastIndexOf("."), fileName.length);\n\n    if (extend2) {\n      layer.open({\n        title: \'提示\',\n        content: "是否下载此文件",\n        //        \t\t\tarea: [\'160px\', \'160px\'],\n        btn: [\'取消\', \'打开\', \'下载\'],\n        btn2: function btn2(index, layero) {\n          if (".pdf" == type || ".doc" == type || ".docx" == type) {\n            var myhref = __basePath + "pdf/pdfRead.jsp?key=" + extend2 + "&needBack=1";\n            index = layer.open({\n              type: 2,\n              title: "在线阅览",\n              shadeClose: false,\n              maxmin: true,\n              shade: 0.6,\n              area: [Number(600) + 50 + "px", 400 + "px"],\n              scrollbar: true,\n              closeBtn: 1,\n              content: myhref + \'&appload=0&f=g\',\n              //iframe的url\n              success: function success(index, layero) {\n                $(".layui-layer-max").trigger("click");\n              }\n            });\n          } else {\n            layer.open({\n              type: 2,\n              title: "查看图片",\n              maxmin: true,\n              shade: 0.6,\n              area: [800 + "px", 600 + "px"],\n              scrollbar: true,\n              closeBtn: 1,\n              content: __basePath + "pictureviewer/showImg.jsp?key=" + extend2,\n              //iframe的url，替换\n              success: function success(layero, index) {\n                $(".layui-layer-max", layero).trigger("click");\n              }\n            });\n          }\n        },\n        btn3: function btn3(index, layero) {\n          window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n        }\n      });\n    } else {\n      layer.open({\n        title: \'提示\',\n        content: "是否下载此文件",\n        btn: [\'取消\', \'下载\'],\n        btn2: function btn2(index, layero) {\n          window.location.href = SUI.settings().uploadify().downloadPath + fileId;\n        }\n      });\n    }\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FileEdit/FileEdit.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FlowHistoryGraph/FlowHistoryGraph.js":
/*!******************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FlowHistoryGraph/FlowHistoryGraph.js ***!
  \******************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FlowHistoryGraph; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:38 PM\n */\n\n/**\n * 查看流程（流程进度图）\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction FlowHistoryGraph(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable',\n      className: $(el).attr('className') || 'btn-default',\n      btnText: $(el).attr('btnText') || '查看流程',\n      properties: {\n        mspPreview: $(el).attr('msppreview') || false\n      },\n      hidewrapper: $(el).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n\n    if (\"none\" != $(dom).css(\"display\")) {\n      $(dom).css(\"display\", \"inline-block\");\n    }\n\n    var btn = '';\n    var html = '<a class=\"btn ' + config.className + '\">' + config.btnText + '</a>';\n    var html_phone = '<div class=\"flow-history\">' + '<div class=\"flow-history-title\">流程进度</div>' + '<div class=\"flow-history-watch\">' + '<span class=\"flow-history-watch-text\">查看</span>' + '<span class=\"flow-history-arrow\"></span>' + '</div>' + '</div>';\n\n    if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n      $(dom).html(html_phone);\n      btn = $(dom).find('.flow-history-watch');\n      $(dom).css(\"display\", \"block\");\n    } else {\n      $(dom).html(html);\n      btn = $(dom).find('a');\n    }\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    var mode = SUI.Util.getQueryString('mode');\n\n    if (mode == 'print') {\n      $(dom).hide();\n      return;\n    }\n    /* 修改状态是时 不显示 */\n\n\n    if (config.wfConfig && config.wfConfig.mode == 'modify') {\n      $(dom).hide();\n      return;\n    }\n\n    config.processInstId = wf2.entity.processInstId || '';\n\n    if (!config.processInstId) {\n      $(dom).hide();\n      return;\n    }\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    var isFirst = true;\n    btn.click(function () {\n      if (!isFirst) {\n        return false;\n      }\n\n      isFirst = false;\n      var flowGraphUrl = '';\n\n      if (SUI.Util.browserType() === 'phone') {\n        isFirst = true;\n        flowGraphUrl = __basePath + 'process/flowTable_app.jsp?processprogress=' + config.processprogress + '&id=' + config.processInstId;\n        iPortal.openWindow(flowGraphUrl);\n      } else {\n        if (config.processprogress == 'true') {\n          var params = {\n            processInstId: config.processInstId\n          };\n          var loadIndex = layer.load(2, {\n            shade: [0.1, '#000']\n          });\n          $.ajax({\n            type: 'post',\n            url: 'com.sudytech.portalone.base.coreplus.queryProcessprogress.biz.ext',\n            contentType: 'application/json',\n            data: JSON.stringify(params),\n            success: function success(data) {\n              layer.close(loadIndex);\n              var x2js = new X2JS();\n\n              var _data = x2js.xml_str2json(data.out.processProgress);\n\n              localStorage.setItem('processprogressData', JSON.stringify(data));\n              var area = dom.zoo.getArea(_data.processprogress);\n              var windowWidth = $(window).width() * 0.8;\n              var windowHeigt = $(window).height() * 0.8;\n              var layerArea = '';\n              var xMaxId = '',\n                  yMxaId = '';\n\n              if (area) {\n                var areaWidth = '',\n                    areaHeight = '';\n                var iframeWidth = area.width + 100;\n                var iframeHeight = area.height + 180;\n\n                if (iframeWidth > windowWidth) {\n                  areaWidth = windowWidth;\n                } else if (iframeWidth < 1000) {\n                  areaWidth = 1000;\n                } else {\n                  areaWidth = iframeWidth;\n                }\n\n                if (iframeHeight > windowHeigt) {\n                  areaHeight = windowHeigt;\n                } else if (iframeHeight < 500) {\n                  areaHeight = 500;\n                } else {\n                  areaHeight = iframeHeight;\n                }\n\n                layerArea = [areaWidth + 'px', areaHeight + 'px'];\n                xMaxId = area.xMaxId;\n                yMxaId = area.yMaxId;\n              } else {\n                layerArea = ['1000px', '500px'];\n              }\n\n              flowGraphUrl = __basePath + 'process/process_progress.jsp?processprogress=' + config.processprogress + '&id=' + config.processInstId + '&xMaxId=' + xMaxId + '&yMaxId=' + yMxaId;\n              layer.open({\n                area: layerArea,\n                type: 2,\n                title: '流程图',\n                content: flowGraphUrl,\n                success: function success() {\n                  $('body').addClass('noscroll');\n                },\n                cancel: function cancel() {\n                  $('body').removeClass('noscroll');\n                }\n              });\n              isFirst = true;\n            },\n            error: function error(data) {}\n          });\n        } else {\n          isFirst = true;\n          flowGraphUrl = __basePath + 'process/flowTable.jsp?processprogress=' + config.processprogress + '&id=' + config.processInstId;\n          layer.open({\n            area: ['1000px', '500px'],\n            type: 2,\n            title: '流程图',\n            content: flowGraphUrl,\n            success: function success() {\n              $('body').addClass('noscroll');\n            },\n            cancel: function cancel() {\n              $('body').removeClass('noscroll');\n            }\n          });\n        }\n      }\n    });\n  };\n\n  this.getArea = function (processData) {\n    var nodes = processData[\"flow-chart\"].nodes.node;\n\n    if (nodes && nodes.length) {\n      var x_width_list = [],\n          y_width_list = [];\n      $.each(nodes, function (i, node) {\n        var x_width = {\n          x: node.x,\n          w: node.width || 80,\n          trueX: parseInt(node.x) + parseInt(node.width || 80),\n          id: node.id\n        };\n        var y_width = {\n          y: node.y,\n          h: node.height || 80,\n          trueY: parseInt(node.y) + parseInt(node.height || 80),\n          id: node.id\n        };\n        x_width_list.push(x_width);\n        y_width_list.push(y_width);\n      });\n      var xMin = x_width_list.sort(function (a, b) {\n        return a.x - b.x;\n      })[0].x;\n      var xMax = x_width_list.sort(function (a, b) {\n        return b.trueX - a.trueX;\n      })[0].trueX;\n      var xMaxId = x_width_list.sort(function (a, b) {\n        return b.trueX - a.trueX;\n      })[0].id;\n      var yMin = y_width_list.sort(function (a, b) {\n        return a.y - b.y;\n      })[0].y;\n      var yMax = y_width_list.sort(function (a, b) {\n        return b.trueY - a.trueY;\n      })[0].trueY;\n      var yMaxId = y_width_list.sort(function (a, b) {\n        return b.trueY - a.trueY;\n      })[0].id;\n      var width = parseInt(xMax) - parseInt(xMin);\n      var height = parseInt(yMax) - parseInt(yMin);\n      var area = {\n        width: width,\n        height: height,\n        xMaxId: xMaxId,\n        yMaxId: yMaxId\n      };\n      return area;\n    }\n\n    return false;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FlowHistoryGraph/FlowHistoryGraph.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MoreParticipates/MoreParticipates.js":
/*!******************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MoreParticipates/MoreParticipates.js ***!
  \******************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return MoreParticipates; });\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:42 PM\n */\n\n/**\n * 会签参与者----不建议使用\n * 所有新建流程建议使用新版参与者\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nvar hasMoreParticipatesStyle = false;\nvar oldValue = \'\';\nvar outOldValue = \'\';\nfunction MoreParticipates(bind) {\n  //控件配置参数\n  var config; //lineExt\n  //当前活动节点上的lineExt属性\n\n  var lineExt;\n  var optionExt; //根据机构来差参与者控件的参数\n\n  var status = {}; //绑定的控件id {aid:[node1,node2]}\n\n  var bindwidgetids = {}; //控件dom对象\n\n  var dom = bind || $(\'<div></div>\').get(0);\n  var _reqPartiesArr = [];\n  var ajaxParams = [];\n  var ajaxData = [];\n  var participantDom = {};\n  var displayName = \'\'; //zoo属性\n\n  dom.zoo = this;\n  this.notForm = true;\n  var nodeName = "";\n  var lineName = "";\n  var opinionChange = false; //切换下一步时 如果意见变了则不回填默认意见\n  //获取参与者\n\n  this.getValue = function () {\n    var steps = [];\n    var from_to_1 = "";\n    var from_to_2 = "";\n    var list = $(".wf-parties", dom);\n    var activityType = config.activitytype; //var isSelect = false;\n\n    for (var i = 0; i < list.length; i++) {\n      var item = list[i];\n      var flag = $(item).attr("flag");\n\n      if ("true" == flag) {\n        if ($(item).attr("wf_from_2")) {\n          var step = {};\n          step.from = $(item).attr("wf_from_2");\n          step.to = $(item).attr("wf_to_2");\n          step.who = [];\n          step.optionExt = optionExt;\n          step.rollBack = $(item).attr("wf-rollBack");\n          step.displayName = displayName;\n          step.nodeName = nodeName;\n          step.lineName = lineName;\n\n          if (from_to_2.indexOf(JSON.stringify(step)) < 0) {\n            from_to_2 += "|" + JSON.stringify(step);\n            steps.push(step);\n          }\n        }\n\n        if ($(item).attr("wf_from_1")) {\n          var step = {};\n          step.from = $(item).attr("wf_from_1");\n          step.to = $(item).attr("wf_to_1");\n          step.who = [];\n          step.optionExt = optionExt;\n          step.rollBack = $(item).attr("wf-rollBack");\n          step.displayName = displayName;\n          step.nodeName = nodeName;\n          step.lineName = lineName;\n\n          if (from_to_1.indexOf(JSON.stringify(step)) < 0) {\n            from_to_1 += "|" + JSON.stringify(step);\n            steps.push(step);\n          }\n        }\n\n        if ($(item).find("select").length) {\n          var step = {};\n          step.from = $(item).attr("wf-from");\n          step.to = $(item).attr("wf-to");\n          step.activityType = $(item).attr("activity-type");\n          step.who = [];\n          step.optionExt = optionExt;\n          step.rollBack = $(item).attr("wf-rollBack");\n          step.displayName = displayName;\n          step.nodeName = nodeName;\n          step.lineName = lineName;\n\n          if ($(item).prop("multi")) {\n            var selects = $(item).find("select");\n\n            if (selects.val()) {\n              $.each(selects.val(), function (index, val) {\n                var option = $(\'[value="\' + val + \'"]\', selects);\n                step.who[step.who.length] = {\n                  id: val,\n                  name: option.attr("op_name"),\n                  type: option.attr("op_type")\n                };\n              });\n            }\n          } else {\n            var select = $(item).find("select");\n            var option = select.find("option:selected");\n\n            if (option.length > 1) {\n              for (var j = 0; option.length > j; j++) {\n                var text = {\n                  id: option.eq(j).attr("value"),\n                  name: option.eq(j).attr("op_name"),\n                  type: option.eq(j).attr("op_type")\n                };\n                step.who.push(text);\n              }\n            } else if (option.length == 1) {\n              step.who = [{\n                id: option.attr("value"),\n                name: option.attr("op_name"),\n                type: option.attr("op_type")\n              }];\n            } else {\n              option = select.find("option");\n\n              if (option.length == 1) {\n                step.who = [{\n                  id: option.attr("value"),\n                  name: option.attr("op_name"),\n                  type: option.attr("op_type")\n                }];\n              }\n            }\n          }\n\n          if (step.who.length > 0) {\n            steps.push(step);\n          } else {\n            var falseStesps = [];\n            falseStesps.push(step);\n            return falseStesps;\n          }\n        } else {\n          var step = {};\n          step.from = $(item).attr("wf-from");\n          step.to = $(item).attr("wf-to");\n          step.displayName = displayName;\n          step.optionExt = optionExt;\n          step.rollBack = $(item).attr("wf-rollBack");\n          step.activityType = $(item).attr("activity-type");\n          step.nodeName = nodeName;\n          step.lineName = lineName;\n\n          if ($("#sui-selectparticipates", $(item)).attr("who")) {\n            step.who = JSON.parse($("#sui-selectparticipates", $(item)).attr("who"));\n\n            if (step.who.length > 0) {\n              steps.push(step);\n            } else {\n              var falseStesps = [];\n              falseStesps.push(step);\n              return falseStesps;\n            }\n          } else {\n            step.who = [];\n            steps.push(step);\n          }\n        }\n      }\n    } // if(isSelect){\n    //     steps = [];\n    //     return steps;\n    // }\n\n\n    if (steps.length == 0) {\n      if ("finish" == activityType) {\n        var falseStep = {\n          "from": "none",\n          "to": "none",\n          "displayName": "",\n          "who": [],\n          "activityType": "finish"\n        };\n        steps.push(falseStep);\n      } else if (config.multiWorkItem && "finish" != activityType) {\n        var falseStep = {\n          "from": "none",\n          "to": "none",\n          "displayName": "",\n          "who": []\n        };\n        steps.push(falseStep);\n      } else {\n        var falseStep = {\n          "from": "没有选择步骤",\n          "to": "没有选择步骤",\n          "displayName": "",\n          "who": []\n        };\n        steps.push(falseStep);\n      }\n\n      return steps;\n    } else {\n      return steps;\n    }\n  };\n  /**\n   * setValue\n   */\n\n\n  this.setValue = function (val) {\n    /**\n     * val数据格式:\n     * [\n     *     [\n     *          {\n     *             name:\'\',\n     *             value:\'\',\n     *             type:\'\'\n     *         }\n     *     ],//第一个部门会签\n     * ]\n     */\n    if (!$.isArray(val) && val.length === 0) {\n      return;\n    }\n\n    setTimeout(function () {\n      for (var reqIndex in _reqPartiesArr) {\n        if (_reqPartiesArr[reqIndex].readyState != 4) {\n          _reqPartiesArr[reqIndex].abort();\n        }\n      }\n\n      var $wfParties = $(\'.wf-parties\', dom);\n      $wfParties.each(function (i, value) {\n        if (val[i] && val[i].length > 0) {\n          var _val = val[i];\n          $(this).empty();\n          var $select = $(\'<select class="form-control js-exa select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true"></select>\');\n\n          for (var i in _val) {\n            var v = _val[i];\n            var $option = $(\'<option></option>\');\n            $option.attr(\'value\', v.value);\n            $option.attr(\'op_name\', v.name);\n            $option.attr(\'op_type\', v.type);\n            $option.html(v.name);\n            $select.append($option);\n          }\n\n          $(this).html($select);\n\n          if (_val.length === 1) {\n            $select.hide();\n            $select.after(\'<span>\' + _val[0].name + \'</span>\');\n          } else {\n            $select.select2($.extend(true, {\n              minimumResultsForSearch: -1\n            }, config.select2 || {}));\n          }\n        }\n      }); // $wfParties.empty();\n    }, 10);\n  };\n  /*获取控件机构id值*/\n\n\n  function getOrgId(widgetdom) {\n    var zoo = widgetdom.sui() ? $.isArray(widgetdom.sui()) ? widgetdom.sui()[0] : widgetdom.sui() : \'\';\n    var widgetVal = \'\';\n\n    if (zoo) {\n      var zooVal = SUI.Util.parseJSON(zoo.getValue(), true);\n      widgetVal = zooVal != null && _typeof(zooVal) === \'object\' ? zooVal.id : zooVal;\n    }\n\n    return widgetVal;\n  } // 获取人员选择控件的value\n\n\n  function getPersonInfo(persondom) {\n    var zoo = persondom.sui() ? $.isArray(persondom.sui()) ? persondom.sui()[0] : persondom.sui() : \'\';\n    var personInfo = [];\n\n    if (zoo) {\n      var zooVal = SUI.Util.parseJSON(zoo.getValue(), true);\n\n      if (zooVal.length) {\n        $.each(zooVal, function (_, v) {\n          personInfo.push({\n            positionid: v.id,\n            posiname: v.name,\n            type: v.type\n          });\n        });\n      }\n    }\n\n    return personInfo;\n  } //设置控件配置属性\n\n\n  this.setConfig = function (val) {\n    config = val || {};\n    $(dom).removeClass(\'form-table\');\n\n    if (!hasMoreParticipatesStyle) {\n      var _moreStyle = \'@media screen and (max-width: 767px) {.sui-moreparticipates .item-value table td{width:100% !important;display:block !important;border-bottom:none !important;}\' + \'.sui-moreparticipates .item-value table td:last-child{border-bottom:1px solid #d2d6de !important;}\' + \'.sui-moreparticipates .item-value table td>p{margin:0 !important;}}\';\n\n      var _styleElement = document.createElement(\'style\');\n\n      _styleElement.type = "text/css";\n      _styleElement.innerHTML = _moreStyle;\n      document.getElementsByTagName(\'head\')[0].appendChild(_styleElement);\n      hasMoreParticipatesStyle = true;\n    }\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == \'true\') {\n        var previewHtml = \'<div class="form-table"><div class="form-tr clearfix"><div class="form-td col-xs-12"><div class="form-item"><div class="item-name">下一步活动名：</div><div class="item-value" style="min-height:45px;padding:6px 10px;"><div><table style="width:100%;"><tbody><tr name="hqhd"><td style="width:25%;border:1px solid #d2d6de;">xxx</td><td style="width:75%;border:1px solid #d2d6de;padding:0 10px;"><div class="clearfix"><div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;" wf_from_1="ngrng" wf_to_1="hqhd" wf-to="glcsh" wf-from="hqhd" activity-type="manual"><input id="sui-selectparticipates" type="text" class="form-control" who="[]" backwho="[]" style="display:inline;width:80%;height:35px;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary sui-components" style="width:20%;height:35px;    vertical-align: inherit;">选择</div></div></div></div></td><td></td></tr></tbody></table></div></div></div></div></div></div>\';\n        $(dom).html(previewHtml);\n      }\n    }\n\n    if (!config.tree) {\n      return;\n    }\n\n    if (!config.hides) {\n      config.hides = [];\n    }\n\n    var opiniononeAttach = false;\n\n    if ("true" == config.properties.opiniononeAttach) {\n      var opiniondiv = $(\'.sui-opinionone\');\n\n      if (opiniondiv.length > 0 && opiniondiv.sui().getConfig().mode == "editable") {\n        opiniononeAttach = true;\n      }\n    }\n\n    function handleSteps(realArr) {\n      var steps = [];\n\n      if (realArr.length == 1) {\n        $.each(realArr, function (i, v) {\n          if (v.activity.type == \'route\' && /^\\S*end$/.test(v.activity.id)) {\n            if (v.children) {\n              $.each(v.children, function (j, route) {\n                steps.push(route);\n              });\n            }\n          } else {\n            steps.push(v);\n          }\n        });\n      } else {\n        steps = $.extend(true, [], realArr);\n      }\n\n      return steps;\n    }\n\n    if ("2" == config.properties.showType) {\n      var tree = config.tree;\n      buildLineOptions(tree);\n      var options = $(\'<div class="radio-group"></div>\');\n      var opName = "sui-parties-name-" + SUI.Util.getSequence("parties"); // 下一步分支条件判断\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (targetId) {\n            tree.childrenArr = $.extend(true, [], tree.children);\n            $.each(tree.children, function (key, child) {\n              if (child.children) {\n                id = targetId + \'_start\';\n              } else {\n                id = targetId;\n              }\n\n              if (child.activity.id === id) {\n                childrenArr.push(tree.children[key]);\n              }\n\n              tree.childrenArr = childrenArr;\n            }); // tree.childrenArr = childrenArr;\n          } else {\n            tree.childrenArr = $.extend(true, [], tree.children);\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (outOldValue === value) {\n              return;\n            }\n\n            outOldValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n              $.each(branchConditionConfig.tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(branchConditionConfig.tree.children[key]);\n                }\n\n                branchConditionConfig.tree.childrenArr = childrenArr;\n              }); // branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      var stepList = handleSteps(realArr);\n      $.each(stepList, function (k, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var id = "sui-parties-" + SUI.Util.getSequence("parties");\n              var option = "";\n\n              if ("XOR" == config.tree.activity.splitMode) {\n                option = $(\'<div class="item-value"><label for="\' + id + \'" style="margin:0px;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label></div>\');\n              } else {\n                option = $(\'<div class="item-value"><label for="\' + id + \'" style="margin:0px;"><input id="\' + id + \'" type="checkbox" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label></div>\');\n              }\n\n              option.find("input").prop("node", node);\n              option.find("input").prop("opt", opt);\n              options.append(option);\n\n              if (opt.color) {\n                option.find("label").css("color", opt.color);\n              }\n            });\n          } else {\n            var id = "sui-parties-" + SUI.Util.getSequence("parties");\n            var option = "";\n\n            if ("XOR" == config.tree.activity.splitMode) {\n              option = $(\'<div class="item-value"><label for="\' + id + \'" style="margin:0px;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name || node.activity.name) + \'</label></div>\');\n            } else {\n              option = $(\'<div class="item-value"><label for="\' + id + \'" style="margin:0px;"><input id="\' + id + \'" type="checkbox" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label></div>\');\n            }\n\n            option.find("input").prop("node", node);\n            options.append(option);\n          }\n        }\n      });\n      var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div><div class="m_title"></div></div>\' + \'</div>\' + \'</div>\' + \'</div>\' + \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步活动名：</div>\' + \'<div class="item-value" style="min-height:45px;padding:6px 10px;"><div><table style="width:100%;"><tbody></tbody></table></div></div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n      $(dom).html(html);\n      $(\'.m_title\', dom).append(options);\n      var radios = $(\'.radio-group\', dom);\n      var radiosInput = $("input", radios);\n      radiosInput.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      }));\n\n      if ("XOR" == config.tree.activity.splitMode) {\n        //单路\n        radiosInput.on(\'ifChecked\', function () {\n          var selectRadio = radios.find("input").filter(":checked");\n          var node = $(this).prop("node");\n          displayName = $(this).attr(\'displayName\');\n          nodeName = node.activity.name;\n          lineName = node.displayName;\n          optionExt = selectRadio.prop("opt");\n          var flag = buildLineOptions(node);\n          decision(node, optionExt, config.processExt);\n          $("tbody", dom).empty();\n\n          if (flag) {\n            // 下一步分支条件判断\n            if (node.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n              var branchCondition = JSON.parse(node.exts.attrs.branchCondition);\n\n              if (branchCondition.weidgetName && branchCondition.conditionValue) {\n                var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n                var value, targetFun, targetId, realArr;\n                var childrenArr = [];\n                value = weidget.sui().getValue();\n                targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                if (typeof targetFun(value) === \'string\') {\n                  targetId = JSON.parse(targetFun(value));\n                } else {\n                  targetId = targetFun(value);\n                }\n\n                if (targetId) {\n                  $.each(node.children, function (key, child) {\n                    $.each(targetId, function (index, tid) {\n                      if (child.activity.id === tid) {\n                        childrenArr.push(child);\n                      }\n                    });\n                  });\n                  tree.childrenArr = $.extend(true, [], tree.children);\n                  $.each(tree.childrenArr, function (key, child) {\n                    if (node.activity.id == child.activity.id) {\n                      child.children = childrenArr;\n                    }\n                  });\n                }\n\n                weidget.on(\'change\', function () {\n                  value = weidget.sui().getValue(); // change时避免执行多次\n\n                  if (oldValue === value) {\n                    return;\n                  }\n\n                  oldValue = value;\n                  targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                  if (typeof targetFun(value) === \'string\') {\n                    targetId = JSON.parse(targetFun(value));\n                  } else {\n                    targetId = targetFun(value);\n                  }\n\n                  var branchConditionConfig = $(dom).sui().getConfig();\n                  var childrenArr = [];\n\n                  if (targetId) {\n                    branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                    $.each(branchConditionConfig.tree.children, function (item, itemValue) {\n                      if (itemValue.children) {\n                        $.each(itemValue.children, function (childIndex, allChild) {\n                          $.each(targetId, function (key, childId) {\n                            if (allChild.activity.id === childId) {\n                              childrenArr.push(branchConditionConfig.tree.children[item].children[childIndex]); // branchConditionConfig.tree.childrenArr = childrenArr;\n                            }\n                          });\n                        });\n                      }\n\n                      branchConditionConfig.tree.childrenArr[item].children = childrenArr;\n                    });\n                  } else {\n                    branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                  }\n\n                  $(dom).sui().setConfig(branchConditionConfig);\n                });\n\n                if (tree.childrenArr && tree.childrenArr.length > 0) {\n                  $.each(tree.childrenArr, function (i, v) {\n                    if (v.activity.id == node.activity.id) {\n                      realArr = tree.childrenArr[i].children;\n                    }\n                  }); // realArr = tree.childrenArr;\n                } else {\n                  realArr = node.children;\n                }\n              } else {\n                realArr = node.children;\n              }\n            } else {\n              realArr = node.children;\n            }\n\n            $.each(realArr, function (i, child) {\n              var childFlag = buildLineOptions(child);\n\n              if (childFlag) {\n                var html = \'<tr name = "\' + child.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;"><select style="width:100%;"><option>请选择</option></select></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n                $("tbody", dom).append(html);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_1", node.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_2", child.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_2", child.activity.id);\n                $.each(child.children, function (i, _child) {\n                  var option = $("<option>" + _child.activity.name + "</option>");\n                  option.prop("node", _child);\n                  option.attr("id", _child.activity.id);\n                  $("select", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                });\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").select2();\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").change(function () {\n                  var parties = $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\'));\n                  var selectedNode = $("option:selected", $(this)).prop("node");\n\n                  if ("请选择" == $("option:selected", $(this)).text()) {\n                    parties.html("请选择发送步骤");\n                    parties.attr("flag", false);\n                  } else {\n                    if (ifneedBindFormValue(selectedNode, child.activity)) {\n                      storeNodeStatus(parties, 0, selectedNode, config.processInstId, null);\n                      bindFormValue(selectedNode, child.activity);\n                      initbindFormValue(selectedNode, child.activity);\n                    } else {\n                      render(parties, 0, selectedNode, config.processInstId, null);\n                    }\n\n                    radios.trigger("sendToSelect", [node, parties]);\n                    parties.attr("flag", true);\n                  }\n                });\n\n                if ("all" == node.exts.attrs.splitType) {\n                  $("select option", $(\'tr[name="\' + child.activity.id + \'"]\'))[0].remove();\n                }\n\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").trigger(\'change\');\n              } else {\n                var html = \'<tr name = "\' + child.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="false" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n                $("tbody", dom).append(html);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_1", node.activity.id);\n                var parties = $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\'));\n\n                if ("all" == node.exts.attrs.splitType) {\n                  var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + child.activity.id + \'">\' + child.displayName + \'</label>\');\n                  $("p", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                  parties.attr("flag", true);\n                } else {\n                  var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + child.activity.id + \'"><input id="\' + child.activity.id + \'" type="checkbox"/>\' + child.displayName + \'</label>\');\n                  option.find("input").prop("node", child);\n                  $("p", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                  $("input[type=\'checkbox\']", $(\'tr[name="\' + child.activity.id + \'"]\')).on(\'click\', function () {\n                    if (option.find("input").is(":checked")) {\n                      parties.attr("flag", true);\n                    } else {\n                      parties.attr("flag", false);\n                    }\n                  }); //下一步活动名只有一个的时候，默认选中\n\n                  if (node.children.length == 1) {\n                    option.find("input").attr("checked", true);\n\n                    if (option.find("input").is(":checked")) {\n                      parties.attr("flag", true);\n                    } else {\n                      parties.attr("flag", false);\n                    }\n                  }\n                }\n\n                if (ifneedBindFormValue(child, node.activity)) {\n                  storeNodeStatus(parties, 0, child, config.processInstId, null);\n                  bindFormValue(child, node.activity);\n                  initbindFormValue(child, node.activity);\n                } else {\n                  render(parties, 0, child, config.processInstId, null);\n                }\n\n                radios.trigger("sendToSelect", [node, parties]);\n              }\n            });\n          } else {\n            var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n            $("tbody", dom).append(html);\n            var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + node.activity.id + \'">\' + (node.displayName || node.activity.name) + \'</label>\');\n            option.find("input").prop("node", node);\n            $("p", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n            var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n\n            if (ifneedBindFormValue(node, config.tree.activity)) {\n              storeNodeStatus(parties, 0, node, config.processInstId, null);\n              bindFormValue(node, config.tree.activity);\n              initbindFormValue(node, config.tree.activity);\n            } else {\n              render(parties, 0, node, config.processInstId, null);\n            }\n\n            radios.trigger("sendToSelect", [node, parties]);\n          }\n        });\n        radios.find("input").first().iCheck("check").trigger(\'ifChecked\');\n      } else {\n        //多路\n        radiosInput.on(\'ifClicked\', function () {\n          var selectRadio = radios.find("input").filter(":checked");\n          var node = $(this).prop("node");\n          var flag = buildLineOptions(node);\n          optionExt = selectRadio.prop("opt");\n          displayName = $(this).attr(\'displayName\');\n          nodeName = node.activity.name;\n          lineName = node.displayName;\n          decision(node, optionExt, config.processExt);\n\n          if ($(this).is(\':checked\')) {\n            $("tr[name=\'" + $(this).prop("node").activity.id + "\']", dom).remove();\n          } else {\n            if (flag) {\n              var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;"><select style="width:100%;"></select></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n              $("tbody", dom).append(html);\n              $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n              $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\')).attr("wf_to_1", node.activity.id); // 下一步分支条件判断\n\n              if (node.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n                var branchCondition = JSON.parse(node.exts.attrs.branchCondition);\n\n                if (branchCondition.weidgetName && branchCondition.conditionValue) {\n                  var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n                  var value, targetFun, targetId, realArr;\n                  ;\n                  var childrenArr = [];\n                  value = weidget.sui().getValue();\n                  targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                  if (typeof targetFun(value) === \'string\') {\n                    targetId = JSON.parse(targetFun(value));\n                  } else {\n                    targetId = targetFun(value);\n                  }\n\n                  if (targetId) {\n                    $.each(node.children, function (key, child) {\n                      $.each(targetId, function (index, tid) {\n                        if (child.activity.id === tid) {\n                          childrenArr.push(child);\n                        }\n                      });\n                    });\n                    tree.childrenArr = $.extend(true, [], tree.children);\n                    $.each(tree.childrenArr, function (key, child) {\n                      if (node.activity.id == child.activity.id) {\n                        child.children = childrenArr;\n                      }\n                    });\n                  }\n\n                  weidget.on(\'change\', function () {\n                    value = weidget.sui().getValue(); // change时避免执行多次\n\n                    if (oldValue === value) {\n                      return;\n                    }\n\n                    oldValue = value;\n                    targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                    if (typeof targetFun(value) === \'string\') {\n                      targetId = JSON.parse(targetFun(value));\n                    } else {\n                      targetId = targetFun(value);\n                    }\n\n                    var branchConditionConfig = $(dom).sui().getConfig();\n                    var childrenArr = [];\n\n                    if (targetId) {\n                      branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                      $.each(branchConditionConfig.tree.children, function (item, itemValue) {\n                        $.each(itemValue.children, function (childIndex, allChild) {\n                          $.each(targetId, function (key, childId) {\n                            if (allChild.activity.id === childId) {\n                              childrenArr.push(branchConditionConfig.tree.children[item].children[childIndex]); // branchConditionConfig.tree.childrenArr = childrenArr;\n                            }\n                          });\n                        });\n                        branchConditionConfig.tree.childrenArr[item].children = childrenArr;\n                      });\n                    } else {\n                      branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                    }\n\n                    $(dom).sui().setConfig(branchConditionConfig);\n                  });\n\n                  if (tree.childrenArr && tree.childrenArr.length > 0) {\n                    $.each(tree.childrenArr, function (i, v) {\n                      if (v.activity.id == node.activity.id) {\n                        realArr = tree.childrenArr[i].children;\n                      }\n                    });\n                  } else {\n                    realArr = node.children;\n                  }\n                } else {\n                  realArr = node.children;\n                }\n              } else {\n                realArr = node.children;\n              }\n\n              $.each(realArr, function (i, child) {\n                var option = $("<option>" + child.activity.name + "</option>");\n                option.prop("node", child);\n                option.attr("id", child.activity.id);\n                $("select", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n              });\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").select2();\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").change(function () {\n                var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n                var selectedNode = $("option:selected", $(this)).prop("node");\n\n                if (ifneedBindFormValue(selectedNode, node.activity)) {\n                  storeNodeStatus(parties, 0, selectedNode, config.processInstId, null);\n                  bindFormValue(selectedNode, node.activity);\n                  initbindFormValue(selectedNode, node.activity);\n                } else {\n                  render(parties, 0, selectedNode, config.processInstId, null);\n                }\n\n                radios.trigger("sendToSelect", [node, parties]);\n              });\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").trigger(\'change\');\n            } else {\n              var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n              $("tbody", dom).append(html);\n              var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + node.activity.id + \'">\' + (node.displayName || node.displayName || node.activity.name) + \'</label>\');\n              option.find("input").prop("node", node);\n              $("p", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n              var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n\n              if (ifneedBindFormValue(node, config.tree.activity)) {\n                storeNodeStatus(parties, 0, node, config.processInstId, null);\n                bindFormValue(node, config.tree.activity);\n                initbindFormValue(node, config.tree.activity);\n              } else {\n                render(parties, 0, node, config.processInstId, null);\n              }\n\n              radios.trigger("sendToSelect", [node, parties]);\n            }\n          }\n        });\n\n        if ("all" == config.splitType) {\n          $.each($(\'.radio-group input\', dom), function (i, element) {\n            $(element).trigger(\'ifClicked\');\n            $(element).iCheck("check");\n          });\n          $(".m_title").hide();\n        } else {\n          radios.find("input").first().trigger(\'ifClicked\');\n          radios.find("input").first().iCheck("check");\n        }\n      }\n    } else if ("1" == config.properties.showType && (config.properties.attach || opiniononeAttach) || config.properties.attach || opiniononeAttach) {\n      //嵌套风格或统一意见框\n      var tree = config.tree;\n      buildLineOptions(tree);\n      var options = $(\'<div class="radio-group"></div>\');\n      var attach;\n\n      if (config.properties.attach) {\n        attach = $("#" + config.properties.attach);\n\n        if (attach.length == 0) {\n          attach = $("[name=\'" + config.properties.attach + "\']");\n        }\n      } else {\n        attach = $(\'.sui-opinionone\');\n      }\n\n      var attached = attach.attr("attached") == "true";\n      var opName = "sui-parties-name-" + SUI.Util.getSequence("parties");\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (targetId) {\n            $.each(tree.children, function (key, child) {\n              if (child.children) {\n                id = targetId + \'_start\';\n              } else {\n                id = targetId;\n              }\n\n              if (child.activity.id === id) {\n                childrenArr.push(tree.children[key]);\n              }\n\n              tree.childrenArr = childrenArr;\n            }); // tree.childrenArr = childrenArr;\n          } else {\n            tree.childrenArr = $.extend(true, [], tree.children);\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (outOldValue === value) {\n              return;\n            }\n\n            outOldValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      var stepList = handleSteps(realArr);\n      $.each(stepList, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var id = "sui-parties-" + SUI.Util.getSequence("parties");\n              var option = "";\n\n              if ("XOR" == config.tree.activity.splitMode) {\n                option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label>\');\n              } else {\n                option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="checkbox" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label>\');\n              }\n\n              option.find("input").prop("node", node);\n              option.find("input").prop("opt", opt);\n              options.append(option);\n\n              if (opt.color) {\n                option.css("color", opt.color);\n              }\n            });\n          } else {\n            var id = "sui-parties-" + SUI.Util.getSequence("parties");\n            var option = "";\n\n            if ("XOR" == config.tree.activity.splitMode) {\n              option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label>\');\n            } else {\n              option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="checkbox" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label>\');\n            }\n\n            option.find("input").prop("node", node);\n            options.append(option);\n          }\n        }\n      });\n      var html = "";\n\n      if (config.properties.opinionAtTop == "true") {\n        html += \'<div class="m_body" style="padding-bottom:10px"></div><div class="m_title"></div>\';\n      } else {\n        html += \'<div class="m_title"></div><div class="m_body"></div>\';\n      }\n\n      html += \'<table style="width:100%;"><thead><tr><th style="width:25%;border:1px solid #d2d6de;text-align:center;">下一步</th><th style="width:75%;border:1px solid #d2d6de;text-align:center;">参与者</th></tr</thead><tbody></tbody></table>\'; // if (attached) {\n      //     attach.remove();\n      // }\n\n      if (!$(dom).find(\'.m_body\').length) {\n        $(dom).html(html);\n\n        if (!attached) {\n          //替换并包裹目标控件\n          attach.after(dom); // attach.remove();\n\n          attach.attr("attached", "true");\n        }\n      } // $(dom).html(html);\n\n\n      $(\'.m_title\', dom).html(options); // $(\'.m_title\', dom).append(options);\n      //如果只有一个选项，并且非决断，则不显示\n\n      if (options.children().length == 1) {\n        var opt = $("input", options).prop("opt") || {};\n\n        if (!opt.decision) {\n          options.parent().hide();\n        }\n      } // if (!attached) {\n      //     //替换并包裹目标控件\n      //     attach.after(dom);\n      //     // attach.remove();\n      //     attach.attr("attached", "true");\n      // }\n\n\n      if (!$(".m_body", dom).find(attach).length) {\n        $(".m_body", dom).append(attach);\n      } // $(".m_body", dom).append(attach);\n      //iCheck样式\n\n\n      var radios = $(\'.radio-group\', dom);\n      var radiosInput = $("input", radios);\n      radiosInput.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      }));\n\n      if ("XOR" == config.tree.activity.splitMode) {\n        //单路\n        radiosInput.on(\'ifChecked\', function () {\n          var selectRadio = radios.find("input").filter(":checked");\n          var node = $(this).prop("node");\n          var flag = buildLineOptions(node);\n          displayName = $(this).attr(\'displayName\');\n          nodeName = node.activity.name;\n          lineName = node.displayName;\n          optionExt = selectRadio.prop("opt");\n          decision(node, optionExt, config.processExt);\n          $("tbody", dom).empty();\n\n          if (flag) {\n            // 下一步分支条件判断\n            if (node.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n              var branchCondition = JSON.parse(node.exts.attrs.branchCondition);\n\n              if (branchCondition.weidgetName && branchCondition.conditionValue) {\n                var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n                var value, targetFun, targetId, realArr;\n                ;\n                var childrenArr = [];\n                value = weidget.sui().getValue();\n                targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                if (typeof targetFun(value) === \'string\') {\n                  targetId = JSON.parse(targetFun(value));\n                } else {\n                  targetId = targetFun(value);\n                }\n\n                if (targetId) {\n                  $.each(node.children, function (key, child) {\n                    $.each(targetId, function (index, tid) {\n                      if (child.activity.id === tid) {\n                        childrenArr.push(child);\n                      }\n                    });\n                  });\n                  tree.childrenArr = $.extend(true, [], tree.children);\n                  $.each(tree.childrenArr, function (key, child) {\n                    if (node.activity.id == child.activity.id) {\n                      child.children = childrenArr;\n                    }\n                  });\n                }\n\n                weidget.on(\'change\', function () {\n                  value = weidget.sui().getValue(); // change时避免执行多次\n\n                  if (oldValue === value) {\n                    return;\n                  }\n\n                  oldValue = value;\n                  targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                  if (typeof targetFun(value) === \'string\') {\n                    targetId = JSON.parse(targetFun(value));\n                  } else {\n                    targetId = targetFun(value);\n                  }\n\n                  var branchConditionConfig = $(dom).sui().getConfig();\n                  var childrenArr = [];\n\n                  if (targetId) {\n                    branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                    $.each(branchConditionConfig.tree.children, function (item, itemValue) {\n                      if (itemValue.children) {\n                        $.each(itemValue.children, function (childIndex, allChild) {\n                          $.each(targetId, function (key, childId) {\n                            if (allChild.activity.id === childId) {\n                              childrenArr.push(branchConditionConfig.tree.children[item].children[childIndex]); // branchConditionConfig.tree.childrenArr = childrenArr;\n                            }\n                          });\n                        });\n                      }\n\n                      branchConditionConfig.tree.childrenArr[item].children = childrenArr;\n                    });\n                  } else {\n                    branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                  }\n\n                  $(dom).sui().setConfig(branchConditionConfig);\n                });\n\n                if (tree.childrenArr && tree.childrenArr.length > 0) {\n                  $.each(tree.childrenArr, function (i, v) {\n                    if (v.activity.id == node.activity.id) {\n                      realArr = tree.childrenArr[i].children;\n                    }\n                  });\n                } else {\n                  realArr = node.children;\n                }\n              } else {\n                realArr = node.children;\n              }\n            } else {\n              realArr = node.children;\n            }\n\n            $.each(realArr, function (i, child) {\n              var childFlag = buildLineOptions(child);\n\n              if (childFlag) {\n                var html = \'<tr name = "\' + child.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;"><select style="width:100%;"><option>请选择</option></select></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n                $("tbody", dom).append(html);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_1", node.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_2", child.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_2", child.activity.id);\n                $.each(child.children, function (i, _child) {\n                  var option = $("<option>" + _child.activity.name + "</option>");\n                  option.prop("node", _child);\n                  option.attr("id", _child.activity.id);\n                  $("select", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                });\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").select2();\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").change(function () {\n                  var parties = $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\'));\n                  var selectedNode = $("option:selected", $(this)).prop("node");\n\n                  if ("请选择" == $("option:selected", $(this)).text()) {\n                    parties.html("请选择发送步骤");\n                    parties.attr("flag", false);\n                  } else {\n                    render(parties, 0, selectedNode, config.processInstId, null);\n                    radios.trigger("sendToSelect", [node, parties]);\n                    parties.attr("flag", true);\n                  }\n                });\n\n                if ("all" == node.exts.attrs.splitType) {\n                  $("select option", $(\'tr[name="\' + child.activity.id + \'"]\'))[0].remove();\n                }\n\n                $(\'tr[name="\' + child.activity.id + \'"]\').find("select").trigger(\'change\');\n              } else {\n                var html = \'<tr name = "\' + child.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="false" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n                $("tbody", dom).append(html);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n                $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\')).attr("wf_to_1", node.activity.id);\n                var parties = $(".wf-parties", $(\'tr[name="\' + child.activity.id + \'"]\'));\n\n                if ("all" == node.exts.attrs.splitType) {\n                  var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + child.activity.id + \'">\' + child.displayName + \'</label>\');\n                  $("p", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                  parties.attr("flag", true);\n                } else {\n                  var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + child.activity.id + \'"><input id="\' + child.activity.id + \'" type="checkbox"/>\' + child.displayName + \'</label>\');\n                  option.find("input").prop("node", child);\n                  $("p", $(\'tr[name="\' + child.activity.id + \'"]\')).append(option);\n                  $("input[type=\'checkbox\']", $(\'tr[name="\' + child.activity.id + \'"]\')).on(\'click\', function () {\n                    if (option.find("input").is(":checked")) {\n                      parties.attr("flag", true);\n                    } else {\n                      parties.attr("flag", false);\n                    }\n                  }); //下一步活动名只有一个的时候，默认选中\n\n                  if (node.children.length == 1) {\n                    option.find("input").attr("checked", true);\n\n                    if (option.find("input").is(":checked")) {\n                      parties.attr("flag", true);\n                    } else {\n                      parties.attr("flag", false);\n                    }\n                  }\n                }\n\n                render(parties, 0, child, config.processInstId, null);\n                radios.trigger("sendToSelect", [node, parties]);\n              }\n            });\n          } else {\n            var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0px;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n            $("tbody", dom).append(html);\n            var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + node.activity.id + \'">\' + (node.displayName || node.activity.name) + \'</label>\');\n            option.find("input").prop("node", node);\n            $("p", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n            var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n            render(parties, 0, node, config.processInstId, null);\n            radios.trigger("sendToSelect", [node, parties]);\n          }\n        });\n        radios.find("input").first().iCheck("check").trigger(\'ifChecked\');\n      } else {\n        //多路\n        radiosInput.on(\'ifClicked\', function () {\n          var node = $(this).prop("node");\n          var flag = buildLineOptions(node);\n\n          if ($(this).is(\':checked\')) {\n            $("tr[name=\'" + $(this).prop("node").activity.id + "\']", dom).remove();\n          } else {\n            if (flag) {\n              var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;"><select style="width:100%;"></select></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n              $("tbody", dom).append(html);\n              $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\')).attr("wf_from_1", node.parent.activity.id);\n              $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\')).attr("wf_to_1", node.activity.id); // 下一步分支条件判断\n\n              if (node.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n                var branchCondition = JSON.parse(node.exts.attrs.branchCondition);\n\n                if (branchCondition.weidgetName && branchCondition.conditionValue) {\n                  var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n                  var value, targetFun, targetId, realArr;\n                  ;\n                  var childrenArr = [];\n                  value = weidget.sui().getValue();\n                  targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                  if (typeof targetFun(value) === \'string\') {\n                    targetId = JSON.parse(targetFun(value));\n                  } else {\n                    targetId = targetFun(value);\n                  }\n\n                  if (targetId) {\n                    $.each(node.children, function (key, child) {\n                      $.each(targetId, function (index, tid) {\n                        if (child.activity.id === tid) {\n                          childrenArr.push(child);\n                        }\n                      });\n                    });\n                    tree.childrenArr = $.extend(true, [], tree.children);\n                    $.each(tree.childrenArr, function (key, child) {\n                      if (node.activity.id == child.activity.id) {\n                        child.children = childrenArr;\n                      }\n                    });\n                  }\n\n                  weidget.on(\'change\', function () {\n                    value = weidget.sui().getValue(); // change时避免执行多次\n\n                    if (oldValue === value) {\n                      return;\n                    }\n\n                    oldValue = value;\n                    targetFun = new Function(\'value\', branchCondition.conditionValue);\n\n                    if (typeof targetFun(value) === \'string\') {\n                      targetId = JSON.parse(targetFun(value));\n                    } else {\n                      targetId = targetFun(value);\n                    }\n\n                    var branchConditionConfig = $(dom).sui().getConfig();\n                    var childrenArr = [];\n\n                    if (targetId) {\n                      branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                      $.each(branchConditionConfig.tree.children, function (item, itemValue) {\n                        $.each(itemValue.children, function (childIndex, allChild) {\n                          $.each(targetId, function (key, childId) {\n                            if (allChild.activity.id === childId) {\n                              childrenArr.push(branchConditionConfig.tree.children[item].children[childIndex]);\n                              branchConditionConfig.tree.childrenArr = childrenArr;\n                            }\n                          });\n                        });\n                        branchConditionConfig.tree.childrenArr[item].children = childrenArr;\n                      });\n                    } else {\n                      branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.tree.children);\n                    }\n\n                    $(dom).sui().setConfig(branchConditionConfig);\n                  });\n\n                  if (tree.childrenArr && tree.childrenArr.length > 0) {\n                    $.each(tree.childrenArr, function (i, v) {\n                      if (v.activity.id == node.activity.id) {\n                        realArr = tree.childrenArr[i].children;\n                      }\n                    });\n                  } else {\n                    realArr = node.children;\n                  }\n                } else {\n                  realArr = node.children;\n                }\n              } else {\n                realArr = node.children;\n              }\n\n              if (tree.childrenArr && tree.childrenArr.length > 0) {\n                realArr = tree.childrenArr;\n              } else {\n                realArr = node.children;\n              }\n\n              $.each(realArr, function (i, child) {\n                var option = $("<option>" + child.activity.name + "</option>");\n                option.prop("node", child);\n                option.attr("id", child.activity.id);\n                $("select", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n              });\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").select2();\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").change(function () {\n                var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n                var selectedNode = $("option:selected", $(this)).prop("node");\n                render(parties, 0, selectedNode, config.processInstId, null);\n                radios.trigger("sendToSelect", [node, parties]);\n              });\n              $(\'tr[name="\' + node.activity.id + \'"]\').find("select").trigger(\'change\');\n            } else {\n              var html = \'<tr name = "\' + node.activity.id + \'">\' + \'<td style="width:25%;border:1px solid #d2d6de;vertical-align: top;"><p style="margin:0;"></p></td>\' + \'<td style="width:75%;border:1px solid #d2d6de;padding:0 10px;">\' + \'<div class="clearfix">\' + \'<div class="col-sm-12 col-xs-12" style="padding-left:0px;"><div class="m_parti_title" style="display:inline-block; vertical-align: top; width:25%;">经办人：</div><div class="wf-parties" flag="true" style="display:inline-block; vertical-align: top; width:75%;"></div></div>\' + \'</div>\' + \'<td>\' + \'</tr>\';\n              $("tbody", dom).append(html);\n              var option = $(\'<label style="padding-left:8px;margin-bottom:0px;" for="\' + node.activity.id + \'">\' + (node.displayName || node.activity.name) + \'</label>\');\n              option.find("input").prop("node", node);\n              $("p", $(\'tr[name="\' + node.activity.id + \'"]\')).append(option);\n              var parties = $(".wf-parties", $(\'tr[name="\' + node.activity.id + \'"]\'));\n              render(parties, 0, node, config.processInstId, null);\n              radios.trigger("sendToSelect", [node, parties]);\n            }\n          }\n        });\n\n        if ("all" == config.splitType) {\n          $.each($(\'.radio-group input\', dom), function (i, element) {\n            $(element).trigger(\'ifClicked\');\n            $(element).iCheck("check");\n          });\n          $(".m_title").hide();\n        } else {\n          radios.find("input").first().trigger(\'ifClicked\');\n          radios.find("input").first().iCheck("check");\n        }\n      }\n    } else {\n      //底部风格\n      var tree = config.tree;\n      buildLineOptions(tree);\n      var html = \'<div class="col-xs-12">\' + \'<div class="box">\';\n      var showTitle = "true" == config.properties.showTitle;\n\n      if (showTitle) {\n        html = html + \'<div class="box-header">\' + \'<h3 class="box-title">选择办理</h3>\' + \'</div>\';\n      }\n\n      html = html + \'<div class="box-body no-padding">\' + \'<div class="form-table">\' + \'<div class="form-tr clearfix"><div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">下一步：</div><div class="item-value wf-sendTo"><select class="form-control" style="width: 100%;"></select></div></div></div>\' + \'<div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">经办人：</div><div class="item-value"><div class="wf-parties" flag="true"></div></div></div></div></div>\' + \'</div>\' + \'</div>\' + \'</div></div>\';\n      $(dom).html(html);\n\n      if (config.properties.suiPreview) {\n        if (config.properties.suiPreview == \'true\') {\n          return false;\n        }\n      } //config.partiesFilter = function(parties, from, to){return parties;};\n\n\n      var sendTo = $(".wf-sendTo select", dom);\n      sendTo.attr("from", tree.activity.id);\n      var parties = $(".wf-parties", dom);\n      sendTo.prop("node", tree);\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (targetId) {\n            $.each(tree.children, function (key, child) {\n              if (child.children) {\n                id = targetId + \'_start\';\n              } else {\n                id = targetId;\n              }\n\n              if (child.activity.id === id) {\n                childrenArr.push(tree.children[key]);\n              }\n\n              tree.childrenArr[key] = childrenArr;\n            }); // tree.childrenArr = childrenArr;\n          } else {\n            tree.childrenArr = $.extend(true, [], tree.children);\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (outOldValue === value) {\n              return;\n            }\n\n            outOldValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.treechildren);\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n\n                branchConditionConfig.tree.childrenArr[key].children = childrenArr;\n              }); // branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = $.extend(true, [], branchConditionConfig.treechildren);\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      var stepList = handleSteps(realArr);\n      $.each(realArr, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var option = $(\'<option value="\' + node.activity.id + \'">\' + (opt.name || node.displayName || node.activity.name) + \'</option>\');\n              option.prop("node", node);\n              option.prop("opt", opt);\n              sendTo.append(option);\n            });\n          } else {\n            var option = $(\'<option value="\' + node.activity.id + \'">\' + (node.displayName || node.activity.name) + \'</option>\');\n            option.prop("node", node);\n            sendTo.append(option);\n          }\n        }\n      }); // select2 美化下拉框\n\n      sendTo.select2($.extend(true, {\n        minimumResultsForSearch: -1\n      }, config.select2 || {})); //只有一个选项，隐藏下拉框\n\n      if (sendTo.find("option").length == 1) {\n        //sendTo.close();\n        sendTo.next().hide();\n        sendTo.after(\'<span>\' + sendTo.find("option").first().text() + \'</span>\');\n      }\n\n      sendTo.change(function () {\n        var option = sendTo.find("option:selected");\n\n        if (option.prop("opt")) {\n          var opt = option.prop("opt");\n\n          if (opt.color) {\n            $(".select2-selection__rendered", sendTo.next()).css("color", opt.color);\n          } else {\n            $(".select2-selection__rendered", sendTo.next()).removeAttr("style");\n          }\n        }\n\n        displayName = option.text();\n        var node = option.prop("node");\n        nodeName = node.activity.name;\n        lineName = node.displayName;\n        optionExt = option.prop("opt");\n        decision(node, optionExt, config.processExt); //决断\n\n        parties.parent().parent().show();\n\n        if (node.activity.type == "finish") {\n          parties.parent().parent().hide();\n        }\n\n        render(parties, 0, node, config.processInstId); //bindFormValue(node);\n        //initbindFormValue(node);\n        //nodeBeforeChange = node;\n\n        sendTo.trigger("sendToSelect", [node, parties]);\n      });\n      sendTo.trigger("change");\n    }\n  }; //获取控件配置数型\n\n\n  this.getConfig = function () {\n    return config;\n  }; //获取dom元素上的属性\n\n\n  this.parse = function (element) {\n    element = $(element ? element : bind);\n    var conf = {};\n    conf.mode = element.attr("mode");\n    conf.select = element.attr("select");\n    conf.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      showTitle: element.attr("showTitle"),\n      opiniononeAttach: element.attr("opiniononeAttach"),\n      showType: element.attr("showType"),\n      sortType: element.attr("sortType"),\n      mspPreview: element.attr("msppreview"),\n      showOption: element.attr("showOption") || \'false\'\n    };\n    conf.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    conf.select2 = SUI.Util.parseJSON(element.attr("select2"), true);\n    conf.resetDataSource = element.attr("resetDataSource") || \'false\';\n    return conf;\n  }; //转换参与者选择器配置数型\n\n\n  function parseSelectAttrs(participateSelectType) {\n    var data = {};\n\n    if (!participateSelectType) {\n      return data;\n    }\n\n    var splits = participateSelectType.split(";");\n    $.each(splits, function (i, v) {\n      var exp = v.split("_");\n      data[exp[0]] = JSON.parse(exp[1]);\n    });\n    return data;\n  } //转换参与者控件配置属性\n\n\n  function parseParti(participateFrom) {\n    var data = {};\n\n    if (!participateFrom) {\n      return data;\n    }\n\n    var splits = participateFrom.split(",");\n    $.each(splits, function (i, v) {\n      var exp = v.split(":");\n      var action = {};\n      data[exp[0]] = action;\n      var index = exp[1].indexOf("[");\n\n      if (index > -1) {\n        action.multi = exp[1].substring(index + 1, exp[1].indexOf("]"));\n        action.action = exp[1].substring(0, index);\n      } else {\n        action.action = exp[1];\n      }\n    });\n    return data;\n  } // 会签参与者相关配置转换\n\n\n  function parsePartiConfig(participateFromConfig) {\n    var data = {};\n\n    if (!participateFromConfig) {\n      return data;\n    } // var splits = participateFromConfig.split(",");\n\n\n    var splits = [participateFromConfig];\n    $.each(splits, function (i, v) {\n      // var exp = v.split(":");\n      var index = v.indexOf(":");\n      var action = {};\n\n      if (index > -1) {\n        var key = v.substring(0, index);\n        var val = v.substring(index + 1, v.length);\n\n        if (val) {\n          action = JSON.parse(val);\n        }\n      }\n\n      data[key] = action;\n    });\n    return data;\n  } //获取决断配置属性\n\n\n  function decision(node, linkExt, processExt) {\n    //        \tvar lineExts = ((node.parent.exts || {}).attrs || {}).lineExt || \'{}\';\n    //            var _lineExts = ((node.parent.exts || {}).attrs || {})._lineExt;\n    //            if (_lineExts) {\n    //                lineExts += _lineExts;\n    //            }\n    //\n    //        \tvar linkExt = {};\n    //        \tif(lineExts && lineExts.length > 0){\n    //        \t\tlinkExt = SUI.Util.parseJSON(lineExts,true);\n    //        \t}\n    var linkExt = linkExt || {};\n    var targetactivityid = node.activity.id;\n    var linename = "";\n\n    for (var i = 0; i < node.parent.connectors.length; i++) {\n      if (node.parent.connectors[i].destActID == targetactivityid) {\n        linename = node.parent.connectors[i].displayName;\n\n        if (linename.indexOf(":") > -1 && linename.indexOf(":") < linename.length) {\n          linename = linename.substring(linename.indexOf(":") + 1, linename.length);\n        }\n      }\n    } //配在流程上的属性\n\n\n    if (processExt && processExt.doFill === "false") {\n      return;\n    } //配在活动上的属性\n\n\n    if (node.parent.exts.attrs.doFill === "false") {\n      return;\n    } //配在线上的属性\n\n\n    if (linkExt.doFill === "false") {\n      return;\n    } //填充意见\n\n\n    $(".sui-opinion[mode=editable], .sui-multiopinion[mode=editable], .sui-opinionone").each(function () {\n      //    if (!attach) {\n      //        return;\n      //    }\n      var com = $(this).sui();\n\n      if (!com) {\n        return;\n      }\n\n      if (linkExt.readOnly == "true") {\n        $(\'textarea\', this).attr("readonly", true);\n      } else {\n        $(\'textarea\', this).removeAttr("readonly");\n      }\n\n      com.setOpinion(linkExt.autoFill || linename || "");\n    });\n\n    if (linkExt.decision) {\n      setExt(linkExt.name);\n    } else {\n      setExt(null);\n    }\n\n    function setExt(linkName) {\n      var com = $(".sui-opinion[mode=editable]", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n\n      com = $(".sui-multiopinion[mode=editable]", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n\n      com = $(".sui-opinionone", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n    }\n  } //创建发送连线\n\n\n  function buildLineOptions(node) {\n    if (!node.children) {\n      return false;\n    }\n\n    var lineExts = ((node.exts || {}).attrs || {}).lineExt || \'{}\';\n    var _lineExts = ((node.exts || {}).attrs || {})._lineExt;\n\n    if (_lineExts) {\n      lineExts += _lineExts;\n    }\n\n    lineExts = SUI.Util.parseJSON(lineExts, true);\n    $.each(node.children, function (i, child) {\n      var line = findLine(node, child.activity);\n      var lineExt = lineExts[child.activity.id] || {};\n      child.options = lineExt.options;\n      var displayName = line.displayName;\n      child.sort = 0;\n      child.displayName = displayName;\n      var index = displayName.indexOf(":");\n\n      if (index > -1) {\n        child.sort = displayName.substring(0, index) - 0;\n        child.displayName = displayName.substring(index + 1);\n      }\n    });\n    SUI.Util.sort(node.children, function (n1, n2) {\n      return n1.sort - n2.sort;\n    });\n    return true;\n  } //查找连线名称\n\n\n  function findLine(tree, activity) {\n    var curConn;\n    $.each(tree.connectors, function (i, conn) {\n      if (conn.destActID == activity.id) {\n        curConn = conn;\n      }\n    });\n    return curConn;\n  }\n\n  function storeNodeStatus(div, orgId, node, processInstId, nullable) {\n    var nodeid = node.activity.id;\n    status[nodeid] = {};\n    status[nodeid].div = div;\n    status[nodeid].orgId = orgId;\n    status[nodeid].node = node;\n    status[nodeid].processInstId = processInstId;\n    status[nodeid].nullable = nullable;\n  } //渲染参与者控件样式填充数据\n\n\n  function render(div, orgId, node, processInstId, nullable, personInfo) {\n    //清空经办人 7-18 add\n    div.empty();\n    storeNodeStatus(div, orgId, node, processInstId, nullable); //参与者缓存数据\n\n    var allPartis;\n    var from = node.parent.activity.id;\n    var activity = node.activity.id;\n    var process = node.activity.processDefId;\n    var type = node.activity.type;\n    config.activitytype = type;\n    div = div || $("<div></div>");\n    div.attr("wf-to", activity);\n    div.attr("wf-from", from);\n    div.attr("activity-type", type);\n\n    if (node.activity.type == "finish") {\n      if ("2" == config.properties.showType) {\n        $(div).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().hide();\n      } else {\n        $(div).parent().parent().parent().parent().parent().parent().show();\n      }\n\n      return;\n    } else {\n      if ("2" == config.properties.showType) {\n        $(div).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().show();\n      } else {\n        $(div).parent().parent().parent().parent().parent().parent().show();\n      }\n    } // var key = activity + "-" + process + "-" + orgId;\n\n\n    var key = activity + "-" + process + "-" + orgId + "-" + from + "-" + config.workItemId + "-" + (processInstId || 0);\n    var repeatAjax = false;\n\n    if (ajaxParams.length) {\n      $.each(ajaxParams, function (_, k) {\n        if (k == key) {\n          repeatAjax = true;\n        }\n      });\n\n      if (!repeatAjax) {\n        ajaxParams.push(key);\n      }\n    } else {\n      ajaxParams.push(key);\n    } //缓存\n\n\n    var cache = SUI.Util.getCache("parties");\n    var cacheData = cache[key];\n\n    function cacheData_change(e) {\n      if (typeof e.data === \'string\') {\n        var c_data = JSON.parse(e.data);\n\n        if (c_data.type == \'repeatAjax\') {\n          cacheData = ajaxData[ajaxParams[ajaxParams.length - 1]];\n\n          if (cacheData) {\n            allPartis = cacheData;\n            setTimeout(function () {\n              filterOptions();\n            }, 1);\n          }\n        }\n      }\n    }\n\n    if (config.resetDataSource == \'true\') {\n      _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n        type: "POST",\n        url: "com.sudytech.portalone.base.ui.queryParticipants.biz.ext",\n        data: wf.jsonString({\n          activityDefID: activity,\n          process: process,\n          workItemId: config.workItemId,\n          orgId: orgId,\n          from: from,\n          processInstId: processInstId || 0,\n          thisEntity: $(\'.sui-form\').sui().getValue()\n        }),\n        contentType: "text/json",\n        success: function success(data) {\n          var list = data.list;\n          $(dom).trigger(\'load\', [list]);\n          allPartis = list || [];\n          cache[key] = allPartis;\n          filterOptions();\n        },\n        error: function error() {// $(\'.wf-parties\',dom).empty()\n        }\n      });\n    } else {\n      window.addEventListener(\'message\', cacheData_change, "*");\n\n      if (cacheData) {\n        allPartis = cacheData;\n        setTimeout(function () {\n          filterOptions($(participantDom[key].selector));\n        }, 1);\n      } else {\n        if (!repeatAjax) {\n          participantDom[key] = $.extend(true, {}, div);\n          _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n            type: "POST",\n            url: "com.sudytech.portalone.base.ui.queryParticipants.biz.ext",\n            data: wf.jsonString({\n              activityDefID: activity,\n              process: process,\n              workItemId: config.workItemId,\n              orgId: orgId,\n              from: from,\n              processInstId: processInstId || 0\n            }),\n            contentType: "text/json",\n            success: function success(data) {\n              var list = data.list;\n              $(dom).trigger(\'load\', [list]);\n              allPartis = list || [];\n              cache[key] = allPartis;\n              ajaxData[key] = allPartis;\n              var postType = {\n                type: "repeatAjax",\n                data: allPartis\n              }; // window.postMessage(JSON.stringify(postType),"*");\n\n              filterOptions($(participantDom[key].selector));\n            },\n            error: function error() {// $(\'.wf-parties\',dom).empty()\n            }\n          });\n        }\n      }\n    } //参与者下拉选\n\n\n    var select = "",\n        // 存放option的value值\n    positionidArr = [];\n\n    function filterOptions(div) {\n      // if(config.tree.activity.splitMode == \'XOR\'){\n      //     div = $(document).find("tr[name="+activity+"] .wf-parties",dom);\n      // }else{\n      //     div = $(document).find("tr[name="+from+"] .wf-parties",dom);\n      // }\n      div.empty();\n      var multi = false;\n      var exts = node.exts || {};\n      var attrs = exts.attrs || {};\n      var participateFrom = parseParti(attrs.participateFrom);\n      var participateFromConfig = parsePartiConfig(attrs.participateFromConfig);\n      var participateSelectType = parseSelectAttrs(attrs.participateSelectType);\n\n      if (config.displayName) {\n        if (config.properties.showType == 2) {\n          $(dom).empty();\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(dom).append(html);\n        } else {\n          $(\'.m_title\', dom).hide();\n          $(\'table\', dom).empty();\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(\'table\', dom).append(html);\n        }\n\n        return;\n      }\n\n      if (participateSelectType[from] && "innerOrg" == participateSelectType[from].selectRange) {// div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        // SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        // $(".sui-selectparticipates", div).sui().init();\n        // $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        // $(".sui-selectparticipates", div).attr("selectRange", 2);\n        // $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        // $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        // $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        // return;\n      } else if (participateSelectType[from] && "postSet" == participateSelectType[from].selectRange) {\n        if (participateSelectType[from].showType) {\n          div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n          SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n          $(".sui-selectparticipates", div).sui().init();\n          $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n          $(".sui-selectparticipates", div).attr("selectRange", 1);\n          $(".sui-selectparticipates", div).attr("showType", participateSelectType[from].showType);\n          $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n          $(".sui-selectparticipates", div).attr("process", config.processDefName);\n          $(".sui-selectparticipates", div).attr("activityDefID", activity);\n          return;\n        }\n      } else if (participateSelectType[from] && "all" == participateSelectType[from].selectRange) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n        $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        $(".sui-selectparticipates", div).attr("selectRange", 0);\n        $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      } else if (participateSelectType[from] && "positionSelect" == participateSelectType[from].selectRange) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n        $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        $(".sui-selectparticipates", div).attr("selectRange", 4);\n        $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      }\n\n      if (config.partiSet[activity] && 6 != config.partiSet[activity]["SELECTRANGE"]) {\n        if (config.partiSet[activity]["SELECTRANGE"] != \'1\') {\n          div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n          SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n          $(".sui-selectparticipates", div).sui().init();\n          $(".sui-selectparticipates", div).attr("selectMulti", node.activity.multiWorkItem);\n          $(".sui-selectparticipates", div).attr("selectRange", config.partiSet[activity]["SELECTRANGE"]);\n          $(".sui-selectparticipates", div).attr("dataType", config.partiSet[activity]["DATATYPE"]);\n          $(".sui-selectparticipates", div).attr("process", config.processDefName);\n          $(".sui-selectparticipates", div).attr("activityDefID", activity);\n          return;\n        }\n      } // 任意选择人员\n\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'personnel\') != -1) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n\n        if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat && participateFromConfig[from].selectIdenity) {\n          $(".sui-selectparticipates", div).attr("selectMulti", participateFromConfig[from].selectMult);\n          $(".sui-selectparticipates", div).attr("displayFormat", participateFromConfig[from].displayFormat);\n          $(".sui-selectparticipates", div).attr("isIdentityChoose", participateFromConfig[from].selectIdenity);\n        }\n\n        $(".sui-selectparticipates", div).attr("empType", \'emp\');\n        $(".sui-selectparticipates", div).attr("selectRange", 6);\n        $(".sui-selectparticipates", div).attr("dataType", \'emp\');\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      } // 当前机构下选择任意人员\n\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'personOfOrg\') != -1) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n\n        if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat) {\n          $(".sui-selectparticipates", div).attr("selectMulti", participateFromConfig[from].selectMult);\n          $(".sui-selectparticipates", div).attr("displayFormat", participateFromConfig[from].displayFormat);\n        } // $(".sui-selectparticipates", div).attr("empType", \'emp\');\n\n\n        $(".sui-selectparticipates", div).attr("selectRange", 2);\n        $(".sui-selectparticipates", div).attr("dataType", \'emp\');\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      }\n\n      if (participateFrom[from] && participateFrom[from].multi == "select") {\n        multi = true;\n      }\n\n      div.prop("multi", multi);\n      var list = config.partiesFilter ? config.partiesFilter(allPartis, from, activity) : allPartis;\n\n      if (personInfo && personInfo.length) {\n        list = personInfo;\n      }\n\n      var html = "";\n      var selectConfig = {\n        minimumResultsForSearch: -1,\n        //option 格式，使全选option展示为按钮格式\n        templateResult: function templateResult(data) {\n          if (!data.element) {\n            return data.text;\n          }\n\n          var $element = $(data.element);\n\n          if ($element[0].className == \'allSelect_btn\') {\n            var $wrapper = $(\'<button class="btn btn-primary"></button>\');\n            $wrapper.text(data.text);\n            return $wrapper;\n          } else {\n            return data.text;\n          }\n        }\n      }; // 参与者组下人员 可以搜索\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'group\') != -1) {\n        delete selectConfig[\'minimumResultsForSearch\'];\n      }\n\n      select = $(\'<select class="form-control" style="width: 100%;"></select>\');\n\n      if (multi) {\n        //这是基于select2插件做的多选\n        select.attr("multiple", "multiple");\n      } // 多人办理\n\n\n      if (node.activity.multiWorkItem) {\n        select.attr("multiple", "multiple");\n\n        if (list.length > 1) {\n          html += \'<option value="allSelect" class="allSelect_btn">全选</option>\';\n        }\n      } // if(list.length > 1){\n      //     if(select.attr(\'multiple\') == "multiple"){\n      //     }else{\n      //         if(!nullable){\n      //             html += \'<option value="null">请选择</option>\';\n      //         }\n      //     }\n      // }\n\n\n      for (var i = 0; i < list.length; i++) {\n        var record = list[i];\n        var emps = "";\n\n        if (record.type == "position") {\n          var index = 0;\n\n          for (var key in record.emps) {\n            var emp = record.emps[key];\n\n            if (index > 0) {\n              emps += ",";\n            }\n\n            emps += emp.empname;\n            index++;\n          }\n        }\n\n        positionidArr.push(record.positionid);\n        var id = "sui-participates-" + SUI.Util.getSequence("Participates"); // 在workflow2里拿到接口里的config参数，里面有SHOWCHOOSE和SHOWFORMAT\n\n        if (record.emps && record.emps.type == \'emp\') {\n          if (emps.length > 0) {\n            html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n          }\n        } else {\n          // 0岗位(姓名) 1姓名(岗位) 2姓名\n          if ("1" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + record.posiname + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + "(" + record.posiname + ")" + \'</option>\';\n              }\n            }\n          } else if (\'null\' === config.sysConfig.SHOWFORMAT || null === config.sysConfig.SHOWFORMAT || "0" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                emps = emps.length > 0 ? "(" + emps + ")" : \'\';\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + record.posiname + emps + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                emps = "(" + emps + ")";\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + record.posiname + emps + \'</option>\';\n              }\n            }\n          } else if ("2" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n              }\n            }\n          }\n        }\n      } // 在workflow2里拿到接口里的config参数，里面有SHOWCHOOSE和SHOWFORMAT\n\n\n      if (config.sysConfig.SHOWCHOOSE === \'1\') {\n        if (list.length > 1) {\n          if (multi) {\n            selectConfig.placeholder = "请选择";\n          } else {\n            html = \'<option>请选择</option>\' + html;\n          }\n        }\n      }\n\n      select.html(html);\n      div.append(select);\n      select.select2($.extend(true, selectConfig, config.select2 || {})); // 当默认有显示 请选择 时，值为空，全选时避开  选择全选时，将 全选 避开\n\n      function deleteEmpty(array) {\n        for (var arrrIndex = 0; arrrIndex < array.length; arrrIndex++) {\n          if (array[arrrIndex] === \'\' || array[arrrIndex] === \'allSelect\') {\n            array.splice(arrrIndex, 1);\n          }\n\n          return array;\n        }\n      } // 切换时控制 全选按钮的显示与隐藏\n\n\n      select.on(\'change\', function () {\n        var personVal = $(this).val(); // 值是[]和null\n\n        personVal ? personVal : personVal = \'[]\';\n\n        if (personVal.indexOf(\'allSelect\') > -1) {\n          select.val(deleteEmpty(positionidArr)).trigger(\'change\');\n        }\n      }); //只有一个选项，隐藏下拉框\n\n      if (select && select.find("option").length == 1) {\n        if (select.next(\'span\').length > 0) {\n          select.next(\'span\').hide();\n        } else {\n          select.hide();\n        }\n\n        select.after(\'<span>\' + select.find("option").first().text() + \'</span>\');\n      }\n\n      if (node.exts.attrs && node.exts.attrs.toAllParticipant && node.exts.attrs.toAllParticipant == \'true\') {\n        select.val(deleteEmpty(ids)).trigger(\'change\');\n        select.select2({\n          disabled: true\n        });\n      } // if (0 == list.length) {\n      //     div.append("未查询到参与者");\n      // }\n      //全选按钮 不要鼠标悬浮背景变色事件\n\n\n      $(\'body\').on(\'mouseover\', \'.select2-results__option\', function () {\n        if ($(this).children().length > 0) {\n          $(this).addClass(\'allSelect_bg\');\n        }\n      });\n\n      if (!$(dom).find(\'.clear-both\').length) {\n        $(dom).append(\'<div class="clear-both" style="clear: both;"></div>\');\n      }\n    }\n\n    return div;\n  } //初始化根据机构id查询参与者\n\n\n  function initbindFormValue(node, currActivity) {\n    var participateFrom = getParticipateFrom(node.exts.attrs.participateFrom, currActivity.id);\n\n    if (participateFrom) {\n      if (participateFrom.indexOf("formValue") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var widgetdom = $("#" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $("div[name=" + widgetid + "]");\n        }\n\n        var orgid = getOrgId(widgetdom);\n\n        if (orgid) {\n          var nodeids = bindwidgetids[widgetid];\n\n          for (var i in nodeids) {\n            var nodeid = nodeids[i];\n            render(status[nodeid].div, orgid, status[nodeid].node, status[nodeid].processInstId, status[nodeid].nullable);\n          }\n        }\n      } else if (participateFrom.indexOf("personValue") > -1) {\n        var personid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var persondom = $("#" + personid);\n\n        if (persondom.length == 0) {\n          persondom = $("div[name=" + personid + "]");\n        }\n\n        var personInfo = getPersonInfo(persondom);\n\n        if (personInfo) {\n          var nodeids = bindwidgetids[personid];\n\n          for (var i in nodeids) {\n            var nodeid = nodeids[i];\n            render(status[nodeid].div, \'\', status[nodeid].node, status[nodeid].processInstId, status[nodeid].nullable, personInfo);\n          }\n        }\n      }\n    }\n  }\n\n  function ifneedBindFormValue(node, currActivity) {\n    var participateFrom = getParticipateFrom(node.exts.attrs.participateFrom, currActivity.id);\n\n    if (participateFrom) {\n      if (participateFrom.indexOf("formValue") > -1 || participateFrom.indexOf("personValue") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var widgetdom = $("#" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $("div[name=" + widgetid + "]");\n        }\n\n        if (widgetdom.length) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  } //绑定根据机构id查询参与者事件\n\n\n  function bindFormValue(node, currActivity) {\n    //offBindAllWidgetEvent();\n    var participateFrom = getParticipateFrom(node.exts.attrs.participateFrom, currActivity.id);\n\n    if (participateFrom) {\n      if (participateFrom.indexOf("formValue") > -1 || participateFrom.indexOf("personValue") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var widgetdom = $("#" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $("div[name=" + widgetid + "]");\n        }\n\n        if (widgetdom.length) {\n          // var orgid = getOrgId(widgetdom);\n          if (participateFrom.indexOf("formValue") > -1) {\n            widgetdom.on("change", changeOrgId);\n          } else if (participateFrom.indexOf("personValue") > -1) {\n            widgetdom.on("change", changePersonInfo);\n          }\n\n          if (!bindwidgetids[widgetid]) {\n            bindwidgetids[widgetid] = [];\n          }\n\n          bindwidgetids[widgetid].push(node.activity.id);\n          bindwidgetids[widgetid] = $.unique(bindwidgetids[widgetid]); // if (orgid) {\n          //     widgetdom.on("change", changeOrgId);\n          //     if (!bindwidgetids[widgetid]) {\n          //         bindwidgetids[widgetid] = [];\n          //     }\n          //     bindwidgetids[widgetid].push(node.activity.id);\n          //     bindwidgetids[widgetid] = $.unique(bindwidgetids[widgetid]);\n          // }\n        }\n      }\n    }\n\n    if (node.exts.attrs.fieldBindParticipate) {\n      var bindField = node.exts.attrs.fieldBindParticipate;\n      var widgetDom = $("div[name=" + bindField + "]");\n      var nodeId = node.activity.id;\n\n      if (widgetDom.length > 0) {\n        widgetDom.on(\'change\', function () {\n          config.resetDataSource = \'true\';\n          render(status.div, 0, status.node, status.processInstId, status.nullable);\n        });\n        $(document).on(\'businessDone\', function () {\n          config.resetDataSource = \'true\';\n\n          if (nodeId == status.node.activity.id) {\n            render(status.div, 0, status.node, status.processInstId, status.nullable);\n          }\n        });\n      }\n    }\n  }\n\n  function offBindAllWidgetEvent() {\n    for (var widgetid in bindwidgetids) {\n      var $dom = $("#" + widgetid);\n\n      if ($dom.length == 0) {\n        $dom = $("div[name=" + widgetid + "]");\n      }\n\n      if ($dom.length) {\n        $dom.off("change", changeOrgId);\n        $dom.off("change", changePersonInfo); //delete bindwidgetids[widgetid];\n      }\n    }\n  }\n\n  function getParticipateFrom(allpartis, currNodeId) {\n    var participateFrom = "";\n\n    if (allpartis) {\n      var partis = allpartis.split(",");\n\n      for (var i in partis) {\n        var p = partis[i];\n\n        if (p.substring(0, p.indexOf(":")) == currNodeId) {\n          participateFrom = p.substring(p.indexOf(":") + 1);\n          break;\n        }\n      }\n    }\n\n    return participateFrom;\n  }\n\n  function changeOrgId() {\n    var id = $(this).attr("id");\n    var nodeids = bindwidgetids[id];\n\n    if (!nodeids) {\n      nodeids = bindwidgetids[$(this).attr("name")];\n    }\n\n    var orgid = getOrgId($(this));\n\n    if (!orgid) {\n      return;\n    }\n\n    for (var i in nodeids) {\n      var s = status[nodeids[i]];\n      render(s.div, orgid, s.node, s.processInstId, s.nullable);\n    }\n  }\n\n  function changePersonInfo() {\n    var id = $(this).attr("id");\n    var nodeids = bindwidgetids[id];\n\n    if (!nodeids) {\n      nodeids = bindwidgetids[$(this).attr("name")];\n    }\n\n    var personInfo = getPersonInfo($(this));\n\n    if (!personInfo) {\n      return;\n    }\n\n    for (var i in nodeids) {\n      var s = status[nodeids[i]];\n      render(s.div, \'\', s.node, s.processInstId, s.nullable, personInfo);\n    }\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MoreParticipates/MoreParticipates.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MultiOpinion/MultiOpinion.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MultiOpinion/MultiOpinion.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MultiOpinion; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:31 AM\n */\n\n/**\n * 会签意见\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction MultiOpinion(bind) {\n  var value, config;\n  var dom = bind || $('<div></div>').get(0);\n  dom.zoo = this;\n  var myOpinion;\n  var extAttrs, decision;\n  var opinionChange = false;\n  var defaultOpinion = '';\n\n  this.getValue = function () {\n    var val = value || '{}';\n    val = SUI.Util.parseJSON(val);\n    var myKey = getMyKey();\n\n    if (config.mode != \"editable\") {\n      return value;\n    }\n\n    var op = getMyOpinion();\n    val[myKey] = op;\n    return SUI.Util.toJsonString(val);\n  };\n\n  this.setDecision = function (_decision) {\n    decision = _decision;\n  };\n\n  this.setOpinion = function (op, iscyyj) {\n    if (!opinionChange) {\n      if (config.maxlength && typeof config.maxlength === 'number') {\n        op = (op + '').substring(0, config.maxlength);\n      }\n\n      myOpinion.val(op || '');\n      defaultOpinion = op || '';\n    } else {\n      if (iscyyj && iscyyj == 'cyyj') {\n        var val = myOpinion.val();\n\n        if (config.maxlength && typeof config.maxlength === 'number') {\n          val = (val + op + '').substring(0, config.maxlength);\n        }\n\n        myOpinion.val(val + op || '');\n      }\n    }\n\n    myOpinion.on('change', function () {\n      var changeValue = $(this).val();\n\n      if (changeValue != defaultOpinion) {\n        opinionChange = true;\n      }\n    });\n  };\n\n  this.setExtAttribute = function (key, value) {\n    extAttrs = extAttrs || {};\n    extAttrs[key] = value;\n  };\n\n  this.setValue = function (val) {\n    value = val;\n\n    if (!value) {\n      myOpinion.show();\n      return;\n    }\n\n    var div = $('.m_view', dom);\n\n    if (SUI.Util.getQueryString('mode') == \"print\") {\n      var myKey = \"\";\n    } else {\n      var myKey = getMyKey();\n    }\n\n    var data = SUI.Util.parseJSON(value);\n    var html = \"\";\n    var showDecision = config.properties.showDecision;\n\n    for (var key in data) {\n      if (key == myKey) {\n        myOpinion.val(data[key].opinion);\n        extAttrs = data[key].extAttrs;\n\n        if (config.mode == \"editable\") {\n          continue;\n        }\n      }\n\n      var item = data[key];\n      var dt = new Date();\n      dt.setTime(item.date - 0);\n      dt = SUI.Util.dateFormat(dt, \"yyyy-MM-dd hh:mm\");\n      var signature = item.signature ? item.signature : '';\n      var showUrl = '';\n\n      if (signature) {\n        var wf2_signature = wf2.workflow.signature;\n        var params = {\n          key: wf2_signature.key || '',\n          nonce: wf2_signature.nonce || '',\n          timestamp: wf2_signature.timestamp || '',\n          signature: wf2_signature.signature || ''\n        };\n        showUrl = wf2_signature.appPath + '/downloadSignature/' + signature + '?key=' + params.key + '&nonce=' + params.nonce + '&timestamp=' + params.timestamp + '&signature=' + params.signature;\n      }\n\n      if (showDecision == 'true') {\n        html += '<div class=\"value-text\"><span>' + (item.decision ? \"(\" + item.decision + \")\" : '') + ' ' + item.opinion + '</span><br/>' + '<div style=\"text-align: right;\">——<img class=\"personal-signature\" src=\"' + showUrl + '\"/>' + item.userName + '(' + item.userOrgName + ') ' + dt + ' </div>' + '</div>';\n      } else {\n        html += '<div class=\"value-text\"><span>' + item.opinion + '</span><br/>' + '<div style=\"text-align: right;\">——<img class=\"personal-signature\" src=\"' + showUrl + '\"/>' + item.userName + '(' + item.userOrgName + ') ' + dt + ' </div>' + '</div>';\n      }\n    }\n\n    div.append($(html));\n    $(dom).trigger('change');\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    SUI.Zoo.setConfig.call(this, val);\n    render();\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr(\"mode\");\n    temp.properties = {\n      name: element.attr(\"name\"),\n      title: element.attr(\"title\"),\n      defValue: element.attr(\"defValue\"),\n      mspPreview: element.attr('msppreview'),\n      showDecision: element.attr('showDecision') || 'false'\n    };\n    temp.validate = SUI.Util.parseJSON(element.attr(\"validate\"), true);\n    temp.inputTip = element.attr(\"inputTip\") || \"\";\n    temp.myKey = element.attr(\"myKey\");\n    temp.maxlength = element.attr('maxlength') || '';\n    return temp;\n  };\n\n  function render() {\n    var require = config.validate && config.validate.require ? \"*\" : \"\";\n\n    var html = '';\n    var maxlength = config.maxlength ? config.maxlength : config.validate && config.validate.max ? config.validate.max : 0;\n    maxlength = maxlength ? ' maxlength=\"' + maxlength + '\"' : \"\";\n    html += '<div class=\"m_view\"></div><textarea class=\"form-control\" rows=\"3\" readOnly=\"\"' + maxlength + '></textarea>';\n    $(dom).html(html);\n\n    if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n      $(dom).addClass('opinion-phone');\n    }\n\n    myOpinion = $('textarea', dom);\n\n    if (config.properties.defValue) {\n      myOpinion.val(config.properties.defValue);\n    }\n\n    if (config.mode == \"editable\") {\n      myOpinion.removeAttr(\"readOnly\");\n      $(dom).removeClass('form-readOnly');\n      myOpinion.attr(\"placeholder\", \"请在此输入意见...\");\n      SUI.Util.poptip(config.inputTip, dom, myOpinion);\n      var strategycode = config.strategycode;\n      var opinionSettings = config.opinionSettings ? JSON.parse(config.opinionSettings) : config.opinionSettings;\n\n      if (opinionSettings) {\n        if (opinionSettings.personOpinion != 'true' && opinionSettings.systemOpinion == 'true') {\n          SUI.Util.systemOpinion(dom, opinionSettings.strategycode);\n        } else if (opinionSettings.personOpinion == 'true' && opinionSettings.systemOpinion != 'true') {\n          SUI.Util.personOpinion(dom, '', opinionSettings.strategycode);\n        } else if (opinionSettings.systemOpinion == 'true' && opinionSettings.personOpinion == 'true') {\n          $.ajax({\n            url: \"com.sudytech.portalone.base.strategyOpinion.strategyOpinion.queryCommenOpnionnew.biz.ext\",\n            type: \"post\",\n            dataType: \"json\",\n            data: {\n              strategycode: opinionSettings.strategycode\n            },\n            success: function success(data) {\n              var list = data.results;\n              SUI.Util.personOpinion(dom, list, opinionSettings.strategycode);\n            }\n          });\n        }\n      } else {\n        if (\"\" != strategycode && null != strategycode && !config.count) {\n          config.count = 1;\n          SUI.Util.systemOpinion(dom, strategycode, 'old');\n        }\n      }\n    } else {\n      myOpinion.attr(\"readOnly\", \"readOnly\");\n      $(dom).addClass('form-readOnly');\n      myOpinion.css('border', 'none');\n      myOpinion.removeAttr(\"placeholder\");\n      myOpinion.hide();\n    }\n  }\n\n  function getMyOpinion() {\n    var temp = {};\n    var userObject = SUI.Util.getUser();\n    temp.userId = userObject.userId;\n    temp.userName = userObject.userName;\n    temp.userOrgId = userObject.userOrgId;\n    temp.userOrgName = userObject.userOrgName;\n    temp.opinion = myOpinion.val();\n    temp.date = new Date() - 0;\n    temp.extAttrs = extAttrs;\n    temp.decision = decision;\n    temp.signature = wf2.workflow && wf2.workflow.signature && (wf2.workflow.signature.signatureId ? wf2.workflow.signature.signatureId : '');\n    return temp;\n  }\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = myOpinion.val();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.getExt = function () {\n    return {\n      type: \"multiOpinion\",\n      value: {\n        key: getMyKey(),\n        value: getMyOpinion()\n      }\n    };\n  };\n\n  function getMyKey() {\n    var myKey = config.myKey;\n\n    if (config.myKey == \"_user\") {\n      myKey = \"u_\" + SUI.Util.getUser().userId;\n    } else if (config.myKey == \"_org\") {\n      myKey = \"o_\" + SUI.Util.getUser().userOrgId;\n    } else if (config.myKey == \"_submit\") {\n      myKey = \"wi_\" + config.properties.workItemId;\n    } else {\n      myKey = \"u_\" + SUI.Util.getUser().userId;\n    }\n\n    return myKey;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MultiOpinion/MultiOpinion.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/NewParticipants/NewParticipants.js":
/*!****************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/NewParticipants/NewParticipants.js ***!
  \****************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return NewParticipants; });\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:28 PM\n */\n\n/**\n * 新版参与者（参与者、会签参与者合并重构）\n * @param bind\n * @returns {*}\n * @constructor\n */\nvar trueValue = '';\nfunction NewParticipants(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      _p = this;\n\n  dom.zoo = this; //用于存放请求参与者生成的key\n\n  var ajaxParams = [];\n  var _reqPartiesArr = []; //存储经办人数据\n\n  var lastKey = ''; // 存储经办人请求的数据\n\n  var ajaxData = []; // 是否有并发体\n\n  var hasConcurrent = false;\n  var isSpecial = false; //是否从路由出来 或从并发体出来 且下一步没有并发体\n\n  var isConcurrentOut = true; // 记录调用mangerRender次数\n\n  var managerRenderCount = 0; // 存储经办人所对应的dom容器\n\n  var managerDomList = {}; // 当前活动节点\n\n  var presentActivityNode = '';\n  var _ShutDownSuccess = '';\n  var nodefromchild = {};\n  var participateName = '经办人：';\n  this.notForm = true;\n  var participateCurrentNode = '';\n  var isMobile = SUI.Util.browserType() === 'phone';\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; // splitMode=OR 并发体开始 joinMode=OR并发体结束\n\n\n  this.setConfig = function (val) {\n    config = val || {};\n\n    if (config.tree) {\n      participateCurrentNode = config.tree.activity.id;\n\n      if (!config.hides) {\n        config.hides = [];\n      }\n\n      var participantsTree = config.tree;\n      var options = $('<div class=\"form-table\"></div>'),\n          selectList = $('<select class=\"\"style=\"width: 100%\"></select>'),\n          radios = $('<div class=\"radio-group\"></div>'); // 吸附\n\n      var isAttach = config.properties.attach || config.properties.opiniononeAttach === 'true';\n      this.setBranchCondition(participantsTree); //下一步\n\n      var nextSteps = [];\n\n      if (participantsTree.branchConditionTree && participantsTree.branchConditionTree.children && participantsTree.branchConditionTree.children.length > 0) {\n        nextSteps = participantsTree.branchConditionTree.children;\n      } else {\n        nextSteps = participantsTree.children;\n      }\n\n      _p.handleData.sortForNode(nextSteps);\n\n      _p.handleChildNode(nextSteps);\n\n      var opName = 'participants_' + participantsTree.activity.id;\n      $.each(nextSteps, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == participantsTree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (_p.handleData.isConcurrent(nextSteps)) {\n            if (node.activity.id == 'end' && node.children && node.children.length) {\n              return;\n            } else {\n              if (node.options) {\n                //配置了流程流转业务\n                $.each(node.options, function (i, opt) {\n                  var id = \"participants_\" + node.activity.id + '_' + i;\n\n                  var option = _p.handleData.template(node, opName, opt, i);\n\n                  options.append(option);\n                  options.find('#' + id).prop(\"node\", node);\n                  options.find('#' + id).prop(\"opt\", opt);\n                });\n              } else {\n                var id = \"participants_\" + node.activity.id + '_0';\n\n                var option = _p.handleData.template(node, opName);\n\n                options.append(option);\n                options.find('#' + id).prop(\"node\", node);\n              }\n            }\n          } else {\n            if (isAttach && !_p.handleData.isAttachHide() && !isMobile) {\n              if (node.activity.id == 'end' && node.children && node.children.length) {\n                return;\n              } else {\n                if (node.options) {\n                  $.each(node.options, function (i, opt) {\n                    var id = \"participants_\" + node.activity.id + '_' + i;\n                    var option = $('<div class=\"item-value\"><label for=\"' + id + '\" ><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" value=\"' + node.activity.id + '\" displayName=\"' + (opt.name || node.displayName || node.activity.name) + '\"/>' + (opt.name || node.displayName || node.activity.name) + '</label></div>');\n                    option.find('input').prop(\"node\", node);\n                    option.find('input').prop(\"opt\", opt);\n                    radios.append(option);\n                  });\n                } else {\n                  var id = \"participants_\" + node.activity.id + '_0';\n                  var option = $('<div class=\"item-value\"><label for=\"' + id + '\" ><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" value=\"' + node.activity.id + '\" displayName=\"' + (node.displayName || node.activity.name) + '\" />' + (node.displayName || node.activity.name || node.activity.name) + '</label></div>');\n                  option.find('input').prop(\"node\", node);\n                  radios.append(option);\n                }\n              }\n            } else {\n              if (node.activity.id == 'end' && node.children && node.children.length) {\n                return;\n              } else {\n                if (node.options) {\n                  $.each(node.options, function (i, opt) {\n                    var option = $('<option value=\"' + node.activity.id + '\">' + (opt.name || node.displayName || node.activity.name) + '</option>');\n                    option.prop(\"node\", node);\n                    option.prop(\"opt\", opt);\n                    selectList.append(option);\n                  });\n                } else {\n                  var option = $('<option value=\"' + node.activity.id + '\">' + (node.displayName || node.activity.name) + '</option>');\n                  option.prop(\"node\", node);\n                  selectList.append(option);\n                }\n              }\n            }\n          }\n        }\n      }); //看是否有并发体 有并发体不支持吸附模式\n\n      if (_p.handleData.isConcurrent(nextSteps)) {\n        var html = '<div class=\"col-xs-12\">' + '<div class=\"box\">' + '<div class=\"box-body no-padding \">' + '<div class=\"form-table participants-title\"><div class=\"form-tr clearfix\"><div class=\"form-td form-next col-xs-6\">下一步：</div><div class=\"form-td col-xs-6\"></div></div></div>' + '<div class=\"participants-content\"></div>' + '</div>' + '</div>' + '</div>';\n        $(dom).html(html);\n\n        if (options.find('.form-tr').length == 1) {\n          var cNode = options.find('.form-td:first input[type=\"radio\"]').prop('node'); // 当只有一个并发体时 并发体样式直接上升至与下一步一行并且如果并发体中子节点只有一个的话 直接隐藏并发体\n\n          if (cNode.activity.splitMode === 'OR' || cNode.activity.joinMode === 'OR' || _p.handleData.isRoute(cNode)) {\n            if (cNode.branchConditionTree && cNode.branchConditionTree.children && cNode.branchConditionTree.children.length == 1 || cNode.children.length == 1) {\n              $('.participants-content', dom).html(options);\n              options.find('.form-td:first').hide(); // options.parents('.participants-content').siblings().hide();\n              // 上层隐藏则下层往左移动\n\n              if (isMobile) {\n                options.find('.form-td:first').next().find('.participants-concurrent').css({\n                  \"position\": \"relative\",\n                  \"left\": \"-15px\"\n                });\n              } else {\n                options.find('.form-td:first').next().find('.participants-concurrent').css({\n                  \"position\": \"relative\",\n                  \"left\": \"-25px\"\n                });\n              }\n            } else {\n              // 如果从并发体出去并且有多条连线则将并发体end隐藏\n              if (cNode.children.length > 1) {\n                $('.participants-content', dom).html(options);\n                options.find('.form-td:first').hide();\n\n                if (isMobile) {\n                  options.find('.form-td:first').next().find('.participants-concurrent').css({\n                    \"position\": \"relative\",\n                    \"left\": \"-15px\"\n                  });\n                } else {\n                  options.find('.form-td:first').next().find('.participants-concurrent').css({\n                    \"position\": \"relative\",\n                    \"left\": \"-25px\"\n                  });\n                }\n              } else {\n                $('.participants-content', dom).html(options);\n              }\n            }\n          } else {\n            $('.participants-content', dom).html(options);\n          }\n        } else {\n          $('.participants-content', dom).html(options);\n        }\n\n        var radios = $('.participants-next', dom);\n        var radiosInput = $('input[type=\"radio\"]', radios);\n        radiosInput.iCheck(SUI.settings().iCheck());\n        radiosInput.on('ifChecked', function () {\n          var activityNode = $(this).prop('node');\n          var optionExt = $(this).prop(\"opt\");\n\n          _p.decision(activityNode, optionExt, config.processExt);\n\n          var inputName = $(this).attr('name');\n          $('input[name=\"' + inputName + '\"]').parents('.form-tr').find('.participants-manager').empty();\n          $('input[name=\"' + inputName + '\"]').parents('.form-tr').find('.participants-concurrent').hide();\n          $('input[name=\"' + inputName + '\"]').parents('.form-tr').find('.participants-concurrent').find('.participants-child-manager').empty();\n\n          if ($('input[name=\"' + inputName + '\"]').parents('.form-td').prev().is(':hidden')) {\n            $('input[name=\"' + inputName + '\"]').parents('.form-td').prev().next().find('.participants-concurrent').show();\n          }\n\n          if (activityNode.activity.splitMode === 'OR' || activityNode.activity.joinMode === 'OR' || _p.handleData.isRoute(activityNode)) {\n            $(this).parents('.form-tr').find('.participants-concurrent').show();\n            $(this).parents('.form-tr').find('.participants-concurrent>tbody').empty();\n            var concurrentDom = $(this).parents('.form-td').eq(0).next();\n            var root_length = options.find('.form-tr').length;\n\n            _p.handleConcurrent(activityNode, true, false, false, concurrentDom, _p.handleData.isRoute(activityNode), root_length > 1 ? false : _p.handleData.isHasManyNodes(activityNode) ? false : true);\n          } else {\n            var managerDom = $(this).parents('.form-td').next().find('.participants-manager');\n\n            _p.bindForm(managerDom, activityNode, config.processInstId);\n          }\n        });\n        radios.find(\"input\").first().iCheck(\"check\").trigger('ifChecked');\n        $.each(nextSteps, function (i, node) {\n          if (_p.handleData.isRoute(node) || node.activity.splitMode === 'OR' || node.activity.joinMode === 'OR') {\n            if (!_p.handleData.isHasManyNodes(node)) {\n              if (radios.find(\"input\").first().attr('name') != 'participants_' + node.activity.id) {\n                $('input[name=\"participants_' + node.activity.id + '\"]').iCheck(\"check\").trigger('ifChecked');\n              }\n            }\n          }\n        });\n      } else {\n        if (isAttach && !_p.handleData.isAttachHide() && !isMobile) {\n          var html = '<div class=\"participants-attach-radios\"></div>' + '<div class=\"participants-attach-opinion\"></div>' + '<div class=\"clearfix participants-attach-content\" >' + '<div class=\"col-sm-5 col-xs-12 attach-node-phone\" >' + '<div class=\"attach-phone\"><span class=\"attach-next-phone\">下一步：</span><span class=\"participants-next attach-activity-phone\"></span>' + '</div>' + '</div>' + '<div class=\"col-sm-7 col-xs-12 participants-attach-handle participants-attach-handle-phone\" >' + '<span class=\"participants-title-phone participants-next-name\"></span>' + '<div class=\"participants-attach-manager participants-manager-phone\"></div>' + '</div>' + '</div>';\n\n          if (!$(dom).find('.participants-attach-radios').length) {\n            $(dom).html(html);\n          }\n\n          $('.participants-attach-radios', dom).html(radios); // 如果活动节点只有一个就隐藏radiobutton\n\n          if (radios.children().length < 2) {\n            radios.hide();\n          }\n\n          var attachDom = '';\n\n          if (config.properties.attach) {\n            attachDom = $('div[name=\"' + config.properties.attach + '\"]');\n          } else {\n            attachDom = $('.sui-opinionone');\n          }\n\n          if (!attachDom.parents('.participants-attach-opinion').length) {\n            attachDom.after(dom);\n            $(\".participants-attach-opinion\", dom).append(attachDom);\n          } // 会签意见样式特殊处理，将radiobutton紧贴着意见框\n\n\n          if (attachDom.hasClass('sui-multiopinion') && !attachDom.find('.participants-attach-radios').length) {\n            var multiopinion_record = attachDom.find('.m_view');\n            multiopinion_record.after($('.participants-attach-radios', dom));\n          }\n\n          var radios = $('.radio-group', dom);\n          radiosInput = $(\"input\", radios);\n          radiosInput.iCheck(SUI.settings().iCheck());\n          radiosInput.on('ifChecked', function () {\n            var node = $(this).prop('node');\n            var opt = $(this).prop('opt');\n            var displayName = node.displayName || node.activity.name || $(this).attr('displayname');\n            $('.participants-next', dom).text(displayName);\n\n            _p.decision(node, opt, config.processExt);\n\n            var manager = $('.participants-attach-manager', dom);\n\n            if (node.activity.type == \"finish\") {\n              manager.parents('.participants-attach-handle').hide();\n            } else {\n              manager.parents('.participants-attach-handle').show();\n            }\n\n            _p.bindForm(manager, node, config.processInstId);\n          });\n          radios.find(\"input\").first().iCheck(\"check\").trigger('ifChecked');\n\n          if (isMobile) {\n            if ($(dom).parent('.cm-show-inline-content').length) {\n              $(dom).parent().parent().css({\n                \"padding\": \"0\",\n                \"background\": \"#eaeaea\"\n              });\n              $(dom).parent().parent().find('.cm-show-inline-title').css('padding', '12px 15px');\n            } else if ($(dom).parent('.cm-show-vertical-center').length) {\n              $(dom).parent().css('padding', '0');\n            }\n          }\n        } else {\n          var html = '<div class=\"col-xs-12\">' + '<div class=\"box\">' + '<div class=\"box-body no-padding\">' + '<div class=\"form-table default-modal\">' + '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-sm-6 col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name\">下一步：</div>' + '<div class=\"item-value participants-next\">' + '</div>' + '</div>' + '</div>' + '<div class=\"form-td col-sm-6 col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name participants-next-name\"></div>' + '<div class=\"item-value\">' + '<div class=\"participants-manager\" name=\"activity-' + participantsTree.activity.id + '\">' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>';\n          $(dom).html(html);\n          $('.participants-next', dom).html(selectList);\n          $(selectList).attr(\"activity_from\", participantsTree.activity.id);\n          var manager = $(\".participants-manager\", dom);\n          $(selectList).prop(\"node\", participantsTree); // select2 美化下拉框\n\n          if (!isMobile) {\n            $(selectList).select2($.extend(true, {\n              minimumResultsForSearch: -1\n            }, config.select2 || {}));\n          } else {\n            if (!$('.participants-next', dom).find('.org-arrow').length) {\n              $('.participants-next', dom).append('<span class=\"org-arrow\"></span>');\n            }\n          } //只有一个选项，隐藏下拉框\n\n\n          if ($(selectList).find(\"option\").length == 1) {\n            if (isMobile) {\n              $(selectList).hide();\n            }\n\n            $(selectList).next().hide();\n            $(selectList).after('<span>' + $(selectList).find(\"option\").first().text() + '</span>');\n          }\n\n          $(selectList).change(function () {\n            var option = $(selectList).find(\"option:selected\");\n            var node = option.prop(\"node\");\n            var optionExt = option.prop(\"opt\"); //决断 (填充默认意见)\n\n            _p.decision(node, optionExt, config.processExt);\n\n            manager.parent().parent().show();\n\n            if (node.activity.type == \"finish\") {\n              manager.parent().parent().hide();\n            }\n\n            _p.bindForm(manager, node, config.processInstId);\n\n            $(selectList).trigger(\"sendToSelect\", [node, manager]);\n          });\n          $(selectList).trigger(\"change\");\n          $(selectList).find('option:first').attr('selected', true);\n        }\n      }\n\n      if (!$(dom).find('.clear-float').length) {\n        $(dom).append('<div class=\"clear-float\"></div>');\n      }\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  }; // 处理子流程出来到主流程数据 子流程出来多返回了子流程的结束节点 需要过滤掉，然后提交的时候需要把这个结束节点放到path中\n\n\n  this.handleChildNode = function (nextSteps, type, cNode) {\n    if (!type) {\n      $.each(nextSteps, function (i, node) {\n        if (node.activity.id == 'end' && node.children && node.children.length) {\n          $.each(node.children, function (j, childNode) {\n            if (childNode.activity.joinMode == 'OR' || childNode.activity.splitMode == 'OR') {\n              _p.handleChildNode(nextSteps, 'second', childNode);\n            } else {\n              nextSteps.push(childNode);\n            }\n          });\n        }\n      });\n    } else {\n      if (cNode.children && cNode.children.length) {\n        $.each(cNode.children, function (j, node) {\n          if (node.activity.joinMode == 'OR' || node.activity.splitMode == 'OR') {\n            _p.handleChildNode(nextSteps, 'second', node);\n          } else {\n            nextSteps.push(node);\n          }\n        });\n      }\n    }\n  }; // 分支条件处理\n\n\n  this.setBranchCondition = function (activityTree) {\n    //分支条件\n    if (activityTree.exts.attrs.hasOwnProperty('branchCondition')) {\n      activityTree.branchConditionTree = {\n        children: [],\n        connectors: []\n      };\n      var branchCondition = JSON.parse(activityTree.exts.attrs.branchCondition);\n\n      if (branchCondition.weidgetName && branchCondition.conditionValue) {\n        var weidget = $('div[name=' + branchCondition.weidgetName + ']');\n        var value, targetFun, targetId;\n        var childrenArr = [],\n            connectors = [];\n        var id = '';\n\n        if (!weidget.length) {\n          return false;\n        }\n\n        value = weidget.sui().getValue();\n        targetFun = new Function('value', branchCondition.conditionValue);\n        targetId = targetFun(value);\n        var a_children = [];\n\n        if (typeof activityTree.children === 'number') {\n          a_children = $.extend(true, [], $('input[value=\"' + activityTree.activity.id + '\"]').prop('node').children);\n        } else {\n          a_children = $.extend(true, [], activityTree.children);\n        }\n\n        if (targetId) {\n          $.each(a_children, function (key, child) {\n            if (child.children) {\n              id = targetId + '_start';\n            } else {\n              id = targetId;\n            }\n\n            if (typeof targetId === 'string') {\n              if (child.activity.splitMode == \"OR\") {\n                id = id + '_start';\n\n                if (child.activity.id == id) {\n                  childrenArr.push(a_children[key]);\n                  connectors.push(activityTree.connectors[key]);\n                }\n              } else {\n                if (child.activity.id === id) {\n                  childrenArr.push(a_children[key]);\n                  connectors.push(activityTree.connectors[key]);\n                }\n              }\n            } else {\n              $.each(targetId, function (t, tId) {\n                if (child.activity.splitMode == 'OR') {\n                  tId = tId + '_start';\n\n                  if (child.activity.id == tId) {\n                    childrenArr.push(a_children[key]);\n                    connectors.push(activityTree.connectors[key]);\n                  }\n                } else {\n                  if (child.activity.id === tId) {\n                    childrenArr.push(a_children[key]);\n                    connectors.push(activityTree.connectors[key]);\n                  }\n                }\n              });\n            }\n          });\n          activityTree.branchConditionTree.children = childrenArr;\n          activityTree.branchConditionTree.connectors = connectors;\n        } else {\n          activityTree.branchConditionTree.children = a_children;\n          activityTree.branchConditionTree.connectors = activityTree.connectors;\n        }\n\n        weidget.on('change', function () {\n          value = weidget.sui().getValue();\n\n          if (trueValue === value) {\n            return;\n          }\n\n          trueValue = value;\n          targetFun = new Function('value', branchCondition.conditionValue);\n          targetId = targetFun(value);\n          var branchConditionConfig = $(dom).sui().getConfig();\n          var childrenArr = [],\n              connectors = [];\n          var id = '';\n          var a_children = [];\n\n          if (typeof activityTree.children === 'number') {\n            a_children = $.extend(true, [], $('input[value=\"' + activityTree.activity.id + '\"]').prop('node').children);\n          } else {\n            a_children = $.extend(true, [], activityTree.children);\n          }\n\n          if (targetId) {\n            $.each(a_children, function (key, child) {\n              if (child.children) {\n                id = targetId + '_start';\n              } else {\n                id = targetId;\n              }\n\n              if (typeof id === 'string') {\n                if (child.activity.id === id) {\n                  childrenArr.push(a_children[key]);\n                  connectors.push(activityTree.connectors[key]);\n                }\n              } else {\n                $.each(id, function (t, tId) {\n                  if (child.activity.id === tId) {\n                    childrenArr.push(a_children[key]);\n                    connectors.push(activityTree.connectors[key]);\n                  }\n                });\n              }\n            });\n            branchConditionConfig.tree.branchConditionTree.children = childrenArr;\n            branchConditionConfig.tree.branchConditionTree.connectors = connectors;\n          } else {\n            branchConditionConfig.tree.branchConditionTree.children = a_children;\n            branchConditionConfig.tree.branchConditionTree.connectors = activityTree.connectors;\n          }\n\n          $(dom).sui().setConfig(branchConditionConfig);\n        });\n      }\n    }\n  }; //下一步活动名及并发体处理\n  // root-是否是根节点 childConcurrent-是否是子并发体\n  // childConcurrent-并发体中的并发体 concurrentOut-从并发体出来\n  //rootRoute 初始是否是路由\n  // special 第一层只有一个节点 处理特殊的并发体、路由-控制样式如默认模式\n\n\n  this.handleConcurrent = function (activityNode, root, childConcurrent, concurrentOut, concurrentDom, rootRoute, special) {\n    var childConcurrent = childConcurrent || false; //普通节点进并发体\n\n    if ((activityNode.activity.splitMode == 'OR' || activityNode.activity.joinMode == 'OR') && !childConcurrent || _p.handleData.isRoute(activityNode) && rootRoute) {\n      this.setBranchCondition(activityNode);\n      var nextSteps = [];\n\n      if (activityNode.branchConditionTree && activityNode.branchConditionTree.children && activityNode.branchConditionTree.children.length > 0) {\n        nextSteps = activityNode.branchConditionTree.children;\n      } else {\n        nextSteps = activityNode.children;\n      }\n\n      _p.handleData.sortForNode(nextSteps);\n\n      var le = nextSteps.length;\n      $.each(nextSteps, function (i, childNode) {\n        if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR') {\n          if (special) {\n            _p.handleConcurrent(childNode, root, true, true, concurrentDom, null, le > 1 ? false : true);\n          } else {\n            _p.handleConcurrent(childNode, root, true, true, concurrentDom, null);\n          }\n        } else {\n          var isConcurrent = activityNode.activity.joinMode === 'OR' || _p.handleData.isRoute(activityNode) ? true : false;\n\n          if (special) {\n            if (le > 1) {\n              if (_p.handleData.ishasRouteOrConn(nextSteps)) {\n                _p.handleConcurrent(childNode, root, false, isConcurrent, concurrentDom, nextSteps.length > 1 ? false : rootRoute);\n              } else {\n                _p.handleConcurrent(childNode, root, false, isConcurrent, concurrentDom, nextSteps.length > 1 ? false : rootRoute, true);\n              }\n            } else {\n              _p.handleConcurrent(childNode, root, false, isConcurrent, concurrentDom, nextSteps.length > 1 ? false : rootRoute, true);\n            }\n          } else {\n            _p.handleConcurrent(childNode, root, false, isConcurrent, concurrentDom, nextSteps.length > 1 ? false : _p.handleData.isRoute(childNode) ? false : rootRoute);\n          }\n        }\n      });\n    } else {\n      var specialHtml = '<div class=\"participants-special\">' + '<div class=\"col-xs-12\">' + '<div class=\"box\">' + '<div class=\"box-body no-padding\">' + '<div class=\"form-table\">' + '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-sm-6 col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name\">下一步：</div>' + '<div class=\"item-value participants-next\">' + '<select></select>' + '</div>' + '</div>' + '</div>' + '<div class=\"form-td col-sm-6 col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name\">' + participateName + '</div>' + '<div class=\"item-value\">' + '<div class=\"participants-manager\">' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>' + '</div>'; // 非并发体\n\n      if (activityNode.activity.splitMode !== 'OR' && activityNode.activity.joinMode !== 'OR' && activityNode.activity.type !== 'route') {\n        if (special) {\n          var childHtml = '<tr name=\"' + activityNode.activity.id + '\">' + '<td colspan=\"2\">' + specialHtml + '</td>' + '</tr>';\n        } else {\n          var childHtml = '<tr name=\"' + activityNode.activity.id + '\">' + '<td class=\"participants-child-next col-sm-6 \"></td>' + '<td class=\"participants-child-manager col-sm-6 \">' + '<div class=\"manager-content\"></div>' + '</td>' + '</tr>';\n        } // 路由\n\n      } else if (_p.handleData.isRoute(activityNode)) {\n        var childHtml = '';\n\n        if (_p.handleData.isHasManyNodes(activityNode.parent)) {\n          var isHide = _p.handleData.isHasManyNodes(activityNode) ? '' : 'hid';\n          childHtml = '<tr name=\"' + activityNode.activity.id + '\" class=\"' + isHide + '\">';\n        } else {\n          childHtml = '<tr name=\"' + activityNode.activity.id + '\" class=\"hid\">';\n        }\n\n        childHtml += '<td class=\"participants-child-next col-sm-6 \"></td>' + '</tr>' + '<tr class=\"hid concurrent-child\">' + '<td colspan=\"2\">' + '<table class=\"table participants-child-manager\" name=\"activity-' + activityNode.activity.id + '\"><tbody></tbody></table>' + '</td>' + '</tr>';\n      } else {\n        //并发体\n        var childHtml = '';\n\n        if (_p.handleData.isHasManyNodes(activityNode.parent)) {\n          childHtml += '<tr name=\"' + activityNode.activity.id + '\" >';\n        } else {\n          childHtml += '<tr class=\"hid\" name=\"' + activityNode.activity.id + '\">';\n        }\n\n        childHtml += '<td class=\"participants-child-next col-xs-12 \" colspan=\"2\"></td>' + '</tr>' + '<tr class=\"hid concurrent-child\">' + '<td colspan=\"2\">' + '<table class=\"table participants-child-manager\" name=\"activity-' + activityNode.activity.id + '\"><tbody></tbody></table>' + '</td>' + '</tr>';\n      }\n\n      if (root) {\n        if (activityNode.activity.splitMode !== 'OR' && activityNode.activity.joinMode !== 'OR' && activityNode.activity.type !== 'route') {\n          if ($('.participants-concurrent>tbody', concurrentDom).find('tr[name=\"' + (special ? activityNode.activity.id : activityNode.activity.id) + '\"]').length === 0) {\n            $('.participants-concurrent>tbody', concurrentDom).append(childHtml);\n          }\n        } else {\n          if ($('.participants-concurrent>tbody', concurrentDom).find('tr[name=\"' + activityNode.activity.id + '\"]').length === 0) {\n            $('.participants-concurrent>tbody', concurrentDom).append(childHtml);\n          }\n        }\n      } else {\n        if (activityNode.activity.splitMode !== 'OR' && activityNode.activity.joinMode !== 'OR' && activityNode.activity.type !== 'route') {\n          if ($('[name=\"activity-' + activityNode.parent.activity.id + '\"]>tbody', dom).find('tr[name=\"' + (special ? activityNode.activity.id : activityNode.activity.id) + '\"]').length === 0) {\n            $('[name=\"activity-' + activityNode.parent.activity.id + '\"]>tbody', dom).append(childHtml);\n          }\n        } else {\n          if ($('[name=\"activity-' + activityNode.parent.activity.id + '\"]>tbody', dom).find('tr[name=\"' + activityNode.activity.id + '\"]').length === 0) {\n            $('[name=\"activity-' + activityNode.parent.activity.id + '\"]>tbody', dom).append(childHtml);\n          }\n        }\n      }\n\n      var nextStep = null;\n\n      if (root) {\n        nextStep = $(\".participants-child-next\", $('.participants-concurrent>tbody', concurrentDom).find('tr[name=\"' + activityNode.activity.id + '\"]'));\n      } else {\n        nextStep = $(\".participants-child-next\", $('[name=\"activity-' + activityNode.parent.activity.id + '\"]>tbody', dom).find('tr[name=\"' + activityNode.activity.id + '\"]'));\n      }\n\n      nextStep.attr('activity_from', activityNode.parent.activity.id);\n      nextStep.attr('activity_to', activityNode.activity.id);\n\n      _p.handleData.buildActivityNode(activityNode);\n\n      var opName = _p.handleData.getRadioName(activityNode); // 路由 并发体特殊情况\n\n\n      $(dom).css(\"visibility\", \"visible\");\n\n      if (special && activityNode.activity.splitMode !== 'OR' && activityNode.activity.joinMode !== 'OR' && activityNode.activity.type !== 'route') {\n        isSpecial = true;\n        var special_nextStep = $('.participants-special .participants-next select', $('tr[name=\"' + activityNode.activity.id + '\"]'));\n        var special_managerDom = $('.participants-special .participants-manager', $('tr[name=\"' + activityNode.activity.id + '\"]'));\n\n        if (activityNode.options) {\n          $.each(activityNode.options, function (i, opt) {\n            var option = $('<option value=\"' + activityNode.activity.id + '\">' + (opt.name || activityNode.displayName || activityNode.activity.name) + '</option>');\n            option.prop(\"node\", activityNode);\n            option.prop(\"opt\", opt);\n\n            if (special_nextStep.find('option[value=\"' + activityNode.activity.id + '\"]').length === 0) {\n              special_nextStep.append(option);\n            }\n          });\n        } else {\n          var option = $('<option value=\"' + activityNode.activity.id + '\">' + (activityNode.displayName || activityNode.activity.name) + '</option>');\n          option.prop(\"node\", activityNode);\n\n          if (special_nextStep.find('option[value=\"' + activityNode.activity.id + '\"]').length === 0) {\n            special_nextStep.append(option);\n          }\n        }\n\n        var pWidth = $(dom).width() + 'px';\n        $(dom).css(\"visibility\", \"hidden\");\n        $(dom).find('.participants-title').css('display', 'none');\n        $('.participants-special', $('tr[name=\"' + activityNode.activity.id + '\"]')).css({\n          width: pWidth,\n          visibility: 'visible',\n          position: 'relative',\n          left: '-25px'\n        }); // select2 美化下拉框\n\n        special_nextStep.select2($.extend(true, {\n          minimumResultsForSearch: -1\n        }, config.select2 || {}));\n        special_nextStep.unbind('change').change(function () {\n          var option = special_nextStep.find(\"option:selected\");\n          var node = option.prop(\"node\");\n          var optionExt = option.prop(\"opt\"); //决断 (填充默认意见)\n\n          _p.decision(node, optionExt, config.processExt);\n\n          special_managerDom.parent().parent().show();\n\n          if (node.activity.type == \"finish\") {\n            special_managerDom.parent().parent().hide();\n          }\n\n          _p.bindForm(special_managerDom, node, config.processInstId);\n\n          special_nextStep.trigger(\"sendToSelect\", [node, special_managerDom]);\n        }); //只有一个选项，隐藏下拉框\n\n        if (!_p.handleData.isHasManyNodes(activityNode.parent)) {\n          var default_val = special_nextStep.find('option:first').val();\n          special_nextStep.val(default_val).trigger('change');\n          special_nextStep.next().hide();\n\n          if (special_nextStep.siblings('#show_node').length == 0) {\n            special_nextStep.after('<span id=\"show_node\">' + special_nextStep.find(\"option\").first().text() + '</span>');\n          }\n        }\n      } else {\n        // 强制发送给所有连线 splitType=all\n        if (activityNode.parent.exts.attrs.splitType === \"all\") {\n          var managerOption = null;\n\n          if (_p.handleData.isHasManyNodes(activityNode.parent)) {\n            managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" type=\"checkbox\" name=\"' + opName + '\" splittype=\"all\" checked=\"true\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n          } else {\n            managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" type=\"radio\" name=\"' + opName + '\" splittype=\"all\" checked=\"true\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n          }\n\n          managerOption.find('input').prop('node', activityNode);\n\n          if (activityNode.options && activityNode.options.length) {\n            //默认取第一个 不支持多个\n            managerOption.find('input').prop('opt', activityNode.options[0]);\n          }\n\n          if ($('label[for=\"' + activityNode.activity.id + '\"]', nextStep).length === 0) {\n            nextStep.append(managerOption);\n          }\n        } else {\n          var managerOption = null;\n\n          if (concurrentOut) {\n            if (activityNode.activity.splitMode === 'OR' && activityNode.parent.activity.splitMode === 'OR') {\n              managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"checkbox\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n            } else {\n              managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"radio\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n            }\n          } else {\n            if (activityNode.activity.joinMode === 'OR' && activityNode.parent.activity.joinMode === 'OR') {\n              managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"radio\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n            } else if (_p.handleData.isRoute(activityNode.parent)) {\n              managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"radio\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n            } else {\n              if (_p.handleData.isNotRouteOrcon(activityNode)) {\n                managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"radio\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n              } else {\n                managerOption = $('<label for=\"' + activityNode.activity.id + '\"><input id=\"' + activityNode.activity.id + '\" value=\"' + activityNode.activity.id + '\" name=\"' + opName + '\" type=\"checkbox\" />' + (activityNode.displayName ? activityNode.displayName : activityNode.activity.name) + '</label>');\n              }\n            }\n          }\n\n          managerOption.find('input').prop('node', activityNode);\n\n          if (activityNode.options && activityNode.options.length) {\n            //默认取第一个 不支持多个\n            managerOption.find('input').prop('opt', activityNode.options[0]);\n          }\n\n          if ($('label[for=\"' + activityNode.activity.id + '\"]', nextStep).length === 0) {\n            nextStep.append(managerOption);\n          }\n        }\n\n        var concurrent = $('input[name=\"' + opName + '\"]');\n        var concurrentClick = $('input[name=\"' + opName + '\"][type=\"radio\"]');\n        concurrent.iCheck(SUI.settings().iCheck());\n\n        if (activityNode.parent.activity.splitMode === 'OR' && _p.handleData.isHasManyNodes(activityNode.parent)) {\n          if (activityNode.parent.exts.attrs.splitType === \"all\") {\n            concurrentClick = $('input[name=\"' + opName + '\"][type=\"checkbox\"][value=\"' + activityNode.activity.id + '\"]');\n          } else {\n            concurrentClick = $('input[name=\"' + opName + '\"][type=\"checkbox\"]');\n          } // 并发体中选中\n\n\n          concurrentClick.unbind('ifChecked').on('ifChecked', function () {\n            var node = $(this).prop('node');\n            var opt = $(this).prop('opt');\n\n            if (node.activity.splitMode === 'OR') {\n              $(this).parents('tr').eq(0).next().show();\n              $(this).parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody').empty();\n\n              _p.handleConcurrent(node, false);\n            } else {\n              var manager = $(this).parents('td').eq(0).next().find('.manager-content');\n\n              _p.decision(node, opt, config.processExt);\n\n              _p.bindForm(manager, node, config.processInstId);\n            }\n          }); //并发体中取消选中\n\n          concurrentClick.on('ifUnchecked', function () {\n            var node = $(this).prop('node');\n\n            if (node.activity.splitMode === 'OR') {\n              $(this).parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody').empty();\n            } else {\n              $(this).parents('td').eq(0).next().find('.manager-content').empty();\n            }\n          });\n        } else {\n          // 非并发体选中\n          concurrentClick.unbind('ifChecked').on('ifChecked', function () {\n            var _this = $(this);\n\n            var node = $(this).prop('node');\n            var opt = $(this).prop('opt');\n            var inputName = $(this).attr('name');\n            var isRoot = $(this).attr('root');\n            var inputRadio = $('input[name=\"' + inputName + '\"][root!=\"true\"]');\n            var rootDom = isRoot ? _this.parents('.form-td').eq(0).next() : null;\n\n            _p.decision(node, opt, config.processExt);\n\n            if (node.activity.splitMode === 'OR' || node.activity.joinMode === 'OR') {\n              if (special && !_p.handleData.isChildHasRouteOrConn(node)) {\n                _p.handleConcurrent(node, false, false, true, null, null, true);\n              } else {\n                inputRadio.parents('tr').find('.participants-child-manager>.manager-content').empty();\n                $.each(inputRadio, function (i, radio) {\n                  var node = $(radio).prop('node');\n\n                  if (_p.handleData.isHasManyNodes(node)) {\n                    $(radio).parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody').empty();\n                  }\n                });\n                $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-manager').empty();\n                $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-concurrent>tbody').empty(); //不是并发体结束到并发体结束\n\n                if (!(node.activity.joinMode === 'OR' && node.parent.activity.joinMode === 'OR')) {\n                  $(this).parents('tr').eq(0).next().show();\n\n                  if (isRoot) {\n                    $(this).parents('.form-td').eq(0).next().find('.participants-concurrent:first').show();\n                  } //活动进入并发体\n\n\n                  if (!(node.parent.activity.splitMode === 'OR' || node.parent.activity.joinMode === 'OR')) {\n                    _p.handleConcurrent(node, isRoot ? true : false, false, false, rootDom); // 并发体内部\n\n                  } else {\n                    //并发体中活动到并发体结束\n                    if (node.parent.activity.joinMode === 'OR' && node.activity.splitMode === 'OR') {\n                      _p.handleConcurrent(node, isRoot ? true : false, false, false, rootDom); // 并发体中并发体到并发体结束\n\n                    } else {\n                      _p.handleConcurrent(node, isRoot ? true : false, false, true, rootDom);\n                    }\n                  }\n                } else {\n                  $(this).parents('tr').eq(0).next().show();\n\n                  if (isRoot) {\n                    $(this).parents('.form-td').eq(0).next().find('.participants-concurrent:first').show();\n                  }\n\n                  _p.handleConcurrent(node, isRoot ? true : false, false, true, rootDom);\n                }\n              }\n            } else {\n              //路由\n              if (_p.handleData.isRoute(node)) {\n                if (special && !_p.handleData.isChildHasRouteOrConn(node)) {\n                  _p.handleConcurrent(node, false, false, true, null, null, true);\n                } else {\n                  inputRadio.parents('tr').find('.participants-child-manager>.manager-content').empty();\n                  $.each(inputRadio, function (i, radio) {\n                    var node = $(radio).prop('node');\n\n                    if (_p.handleData.isHasManyNodes(node)) {\n                      $(radio).parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody').empty();\n                    }\n                  });\n                  $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-manager').empty();\n                  $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-concurrent>tbody').empty();\n                  $(this).parents('tr').eq(0).next().show();\n\n                  _p.setBranchCondition(node);\n\n                  var nextSteps = [];\n\n                  if (node.branchConditionTree && node.branchConditionTree.children && node.branchConditionTree.children.length > 0) {\n                    nextSteps = node.branchConditionTree.children;\n                  } else {\n                    nextSteps = node.children;\n                  }\n\n                  _p.handleData.sortForNode(nextSteps);\n\n                  $.each(nextSteps, function (i, childNode) {\n                    if (special) {\n                      if (nextSteps.length > 1) {\n                        if (_p.handleData.isChildHasRouteOrConn(nextSteps)) {\n                          if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR') {\n                            _p.handleConcurrent(childNode, false, true, true, rootDom);\n                          } else {\n                            var isConcurrent = _p.handleData.isRoute(childNode) ? true : false;\n\n                            _p.handleConcurrent(childNode, isRoot ? true : false, false, isConcurrent, rootDom);\n                          }\n                        } else {\n                          if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR' || _p.handleData.isRoute(childNode)) {\n                            _p.handleConcurrent(childNode, isRoot ? true : false, true, false, rootDom, null, true);\n                          } else {\n                            _p.handleConcurrent(childNode, isRoot ? true : false, false, false, rootDom, null, true);\n                          }\n                        }\n                      } else {\n                        var isConcurrent = childNode.activity.joinMode === 'OR' || childNode.activity.splitMode === 'OR' || _p.handleData.isRoute(childNode) ? true : false;\n\n                        _p.handleConcurrent(childNode, false, true, isConcurrent, null, null, true);\n                      }\n                    } else {\n                      if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR') {\n                        _p.handleConcurrent(childNode, isRoot ? true : false, true, true, rootDom);\n                      } else {\n                        _p.handleConcurrent(childNode, isRoot ? true : false, false, true, rootDom);\n                      }\n                    }\n                  });\n                }\n              } else {\n                inputRadio.parents('tr').find('.participants-child-manager>.manager-content').empty();\n                $.each(inputRadio, function (i, radio) {\n                  var node = $(radio).prop('node');\n\n                  if (_p.handleData.isHasManyNodes(node)) {\n                    $(radio).parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody').empty();\n                  }\n                });\n                $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-manager').empty();\n                $('input[name=\"' + inputName + '\"][root=true]').parents('.form-tr').find('.participants-concurrent>tbody').empty();\n\n                if ($(this).parents('td').length) {\n                  var managerDom = $(this).parents('td').eq(0).next().find('.manager-content');\n\n                  _p.decision(node, opt, config.processExt);\n\n                  _p.bindForm(managerDom, node, config.processInstId);\n                } else {\n                  var managerDom = $(this).parents('.form-td').eq(0).next().find('.participants-manager');\n\n                  _p.decision(node, opt, config.processExt);\n\n                  _p.bindForm(managerDom, node, config.processInstId);\n                }\n              }\n            }\n          });\n\n          if (concurrentOut) {\n            concurrent.first().iCheck(\"check\").trigger('ifChecked');\n          }\n        }\n\n        if (activityNode.parent.exts.attrs.splitType === \"all\") {\n          var concurrentChecked = $('input[splittype=\"all\"]').iCheck('check').iCheck('disable').trigger('ifChecked');\n          $('input[splittype=\"all\"][type=\"radio\"]').iCheck('enable');\n        } // 并发体中的活动节点经办人展示\n        // if(activityNode.parent.activity.splitMode === 'OR' && activityNode.activity.type === 'manual'){\n        //     var manager = $('#'+activityNode.activity.id).parents('td').eq(0).next().find('.manager-content');\n        //     _p.managerRender(manager, 0, activityNode, config.processInstId, null);\n        //     _p.bindForm(manager, activityNode, config.processInstId);\n        // }\n        //并发体结束到并发体开始\n\n\n        if ((activityNode.activity.splitMode == 'OR' || activityNode.activity.joinMode == 'OR') && childConcurrent) {\n          this.setBranchCondition(activityNode);\n          var nextSteps = [];\n\n          if (activityNode.branchConditionTree && activityNode.branchConditionTree.children && activityNode.branchConditionTree.children.length > 0) {\n            nextSteps = activityNode.branchConditionTree.children;\n          } else {\n            nextSteps = activityNode.children;\n          }\n\n          $.each(nextSteps, function (i, childNode) {\n            if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR') {\n              $('tr[name=\"' + activityNode.activity.id + '\"]').eq(0).next().show();\n\n              _p.handleConcurrent(childNode, false, true, true);\n            } else {\n              // 并发体如果不是第一个则不加载并发体中的子节点\n              if ($('tr[name=\"' + activityNode.activity.id + '\"]').eq(0).prev().length == 0) {\n                $('tr[name=\"' + activityNode.activity.id + '\"]').eq(0).next().show();\n\n                _p.handleConcurrent(childNode, false, false, activityNode.activity.joinMode === 'OR' ? true : false);\n              }\n            }\n          }); //并发体结束到并发体结束\n        } //如果上面层级隐藏了 则把下面层级样式往前移动\n\n\n        if (_p.handleData.isRoute(activityNode) || activityNode.activity.splitMode == 'OR' || activityNode.activity.joinMode == 'OR') {\n          if ($('[name=\"' + activityNode.activity.id + '\"]').is(':hidden')) {\n            var childDom = $('[name=\"' + activityNode.activity.id + '\"]').next().children().find('.participants-child-manager:first');\n\n            if (isMobile) {\n              childDom.css({\n                \"position\": \"relative\",\n                \"left\": \"-15px\"\n              });\n            } else {\n              childDom.css({\n                \"position\": \"relative\",\n                \"left\": \"-25px\"\n              });\n            }\n          }\n        }\n      }\n    }\n  }; //决断(填充默认意见)\n\n\n  this.decision = function (node, linkExt, processExt) {\n    var linkExt = linkExt || {};\n    var targetactivityid = node.activity.id;\n    var linename = \"\";\n\n    for (var i = 0; i < node.parent.connectors.length; i++) {\n      if (node.parent.connectors[i].destActID == targetactivityid) {\n        linename = node.parent.connectors[i].displayName;\n\n        if (linename.indexOf(\":\") > -1 && linename.indexOf(\":\") < linename.length) {\n          linename = linename.substring(linename.indexOf(\":\") + 1, linename.length);\n        }\n      }\n    } // //配在流程上的属性\n    // if (processExt && processExt.doFill === \"false\") {\n    //     return;\n    // }\n    // //配在活动上的属性\n    // if (node.parent.exts.attrs.doFill === \"false\") {\n    //     return;\n    // }\n    //配在线上的属性\n    // if (linkExt.doFill === \"false\") {\n    //     return;\n    // }\n    //填充意见\n\n\n    $(\".sui-opinion[mode=editable], .sui-multiopinion[mode=editable], .sui-opinionone\").each(function () {\n      var com = $(this).sui();\n\n      if (!com) {\n        return;\n      }\n\n      if (linkExt.readOnly == \"true\") {\n        $('textarea', this).attr(\"readonly\", true);\n      } else {\n        $('textarea', this).removeAttr(\"readonly\");\n      }\n\n      var opinion = '';\n\n      if (linkExt && linkExt.defaultOpinion) {\n        if (linkExt && linkExt.defaultOpinion == 'false') {\n          opinion = linkExt.decision ? linkExt.decision : linename ? linename : node.activity.name || \"\";\n        } else {\n          opinion = linkExt.autoFill ? linkExt.autoFill : '';\n        }\n      } else {\n        opinion = linkExt.autoFill ? linkExt.autoFill : linename ? linename : node.activity.name || \"\";\n      }\n\n      if (!(node && node.parent && node.parent.activity && node.parent.activity.splitMode == 'OR')) {\n        com.setOpinion(opinion);\n      }\n    }); // if(node && node.activity && node.activity.splitMode == 'OR'){\n    //     var firstId = '';\n    //     if(node.children && node.children.length){\n    //         firstId = node.children[0].activity.id;\n    //     }\n    //     if(node.exts && node.exts.attrs && node.exts.attrs.lineExt){\n    //         linkExt = eval('('+node.exts.attrs.lineExt+')')[firstId];\n    //     }\n    // }\n\n    if (linkExt.decision) {\n      setExt(linkExt.name);\n    } else {\n      setExt(linename ? linename : node.activity.name);\n    }\n\n    function setExt(linkName) {\n      var isAttach = config.properties.attach || config.properties.opiniononeAttach === 'true';\n\n      if (hasConcurrent || !isAttach) {\n        var com = $('.sui-opinion[mode=editable]').sui();\n\n        if (com) {\n          if (com.length) {\n            $.each(com, function (i, v) {\n              v.setDecision(linkName);\n            });\n          } else {\n            com.setDecision(linkName);\n          }\n        }\n\n        com = $('.sui-multiopinion[mode=editable]').sui();\n\n        if (com) {\n          if (com.length) {\n            $.each(com, function (i, v) {\n              if (v) {\n                v.setDecision(linkName);\n              }\n            });\n          } else {\n            com.setDecision(linkName);\n          }\n        }\n\n        com = $('.sui-opinionone').sui();\n\n        if (com) {\n          if (com.length) {\n            $.each(com, function (i, v) {\n              if (v) {\n                v.setDecision(linkName);\n              }\n            });\n          } else {\n            com.setDecision(linkName);\n          }\n        }\n      } else {\n        var com = $(dom).find('.participants-attach-opinion').children().sui();\n\n        if (com) {\n          if (com.length) {\n            $.each(com, function (i, v) {\n              if (v) {\n                v.setDecision(linkName);\n              }\n            });\n          } else {\n            com.setDecision(linkName);\n          }\n        }\n      }\n    }\n  }; //创建经办人 managerDom-经办人容器 orgId-部门Id node-当前选中活动节点 processInstId-流程实例Id (linked - orgtrue:关联机构选择器 custom:参与者模式配置自定义)\n\n\n  this.managerRender = function (managerDom, orgId, node, processInstId, personInfo, linked) {\n    //清空经办人信息\n    ++managerRenderCount;\n    managerDom.empty();\n    var allPartis;\n    var from = node.parent.activity.id;\n    var activity = node.activity.id;\n    var rollBack = false;\n    var lineExts = ((node.exts || {}).attrs || {}).lineExt || '{}';\n\n    if (lineExts) {\n      var _lineExts = ((node.exts || {}).attrs || {})._lineExt;\n\n      if (_lineExts) {\n        lineExts += _lineExts;\n      }\n\n      lineExts = SUI.Util.parseJSON(lineExts, true);\n\n      if (lineExts[activity]) {\n        rollBack = lineExts[activity]['options'][0]['rollBack'];\n      }\n    }\n\n    var process = node.activity.processDefId;\n    var type = node.activity.type;\n    managerDom = managerDom || $(\"<div></div>\");\n    managerDom.attr(\"manager_to\", activity);\n    managerDom.attr(\"manager_from\", from);\n    managerDom.attr(\"activity_type\", type);\n\n    if (rollBack) {\n      rollBack = 1;\n    } else {\n      rollBack = 0;\n    }\n\n    managerDom.attr(\"manager_rollBack\", rollBack); // 关联机构选择器多选\n\n    if (orgId && _typeof(orgId) == 'object') {\n      if (orgId.length) {\n        allPartis = [];\n        var params = {\n          activityDefID: activity,\n          process: process,\n          orgId: orgId,\n          from: from,\n          workItemId: config.workItemId,\n          processInstId: processInstId || 0,\n          managerDom: managerDom,\n          node: node,\n          personInfo: personInfo\n        };\n\n        _p.handleData.queryParticipantsByOrgIdList(allPartis, params, orgId.length, 0);\n      } else {\n        _p.filterManager(managerDom, node, [], personInfo);\n      }\n\n      return false;\n    } // 如果关联机构控件并且没有选择机构\n\n\n    if (!orgId && linked == 'orgtrue') {\n      _p.filterManager(managerDom, node, [], personInfo);\n\n      return false;\n    }\n\n    if (node.activity.type == \"finish\") {\n      managerDom.parent().hide();\n      managerDom.parents('.form-td').siblings('.form-td').addClass('par-finish');\n      return;\n    } else {\n      managerDom.parent().show();\n    } // 根据请求参数创建key 用于阻止重复请求;\n\n\n    var key = activity + \"-\" + process + \"-\" + orgId + \"-\" + from + \"-\" + config.workItemId + \"-\" + (processInstId || 0);\n\n    if (linked == 'custom') {\n      key = activity + \"-\" + process + \"-\" + orgId + \"-\" + from + \"-\" + config.workItemId + \"-\" + (processInstId || 0) + JSON.stringify($(\".sui-form\").sui().getValue());\n    }\n\n    managerDomList[key] = managerDom;\n    lastKey = key;\n    var repeatAjax = false;\n\n    if (ajaxParams.length) {\n      $.each(ajaxParams, function (_, k) {\n        if (k == key) {\n          repeatAjax = true;\n        }\n      });\n\n      if (!repeatAjax) {\n        ajaxParams.push(key);\n      }\n    } else {\n      ajaxParams.push(key);\n    }\n\n    if (personInfo && personInfo.length) {\n      _p.filterManager(managerDom, node, allPartis, personInfo);\n\n      return false;\n    } else if (personInfo === null) {\n      _p.filterManager(managerDom, node, allPartis, personInfo);\n\n      return false;\n    } //缓存\n\n\n    var cache = SUI.Util.getCache(\"parties\");\n    var cacheData = cache[key];\n\n    function cacheData_change(e) {\n      if (typeof e.data === 'string') {\n        var c_data = JSON.parse(e.data);\n\n        if (c_data.type == 'repeatAjax') {\n          _p.filterManager(managerDomList[c_data.key], c_data.node, c_data.data, c_data.personInfo);\n        }\n      }\n    }\n\n    var exts = node.exts || {};\n    var attrs = exts.attrs || {};\n\n    var participateFrom = _p.handleData.parseParti(attrs.participateFrom);\n\n    if (participateFrom[from] && participateFrom[from].action.indexOf('group') > -1) {\n      var participants_next_name = _p.handleData.getParticipateNextName(node);\n\n      var participants_next_title = '';\n\n      if (participants_next_name.substring(participants_next_name.length - 1, participants_next_name.length) == '：') {\n        participants_next_title = participants_next_name.substring(0, participants_next_name.length - 1);\n      }\n\n      var tipTitle = '请选择' + participants_next_title;\n\n      if ($('.participants-next-name', dom).length) {\n        $('.participants-next-name', dom).text(participants_next_name);\n      } else {\n        if (!managerDom.find('.current_next_name').length) {\n          managerDom.prepend('<span class=\"current_next_name\">' + participants_next_name + '</span>');\n        }\n      }\n\n      if (isMobile) {\n        managerDom.append('<div class=\"show-multi-participants no-select-multi group_phone\">' + tipTitle + '</div><span class=\"org-arrow group-arrow-phone\"></span>');\n\n        _p.handleData.emptyNextNameforPhone($('.current_next_name'));\n      } else {\n        managerDom.append('<div class=\"show-multi-participants no-select-multi\">' + tipTitle + '</div><div class=\"multi-select-par\">选择</div>');\n        managerDom.addClass('multi-par-pc');\n      }\n\n      var nameWidth = '',\n          isNormal = false;\n\n      if (managerDom.find('.current_next_name').length) {\n        nameWidth = managerDom.find('.current_next_name').width();\n        nameWidth = 54 + (nameWidth ? nameWidth : 0) + 'px';\n        managerDom.find('.show-multi-participants').css('width', 'calc(100% - ' + nameWidth + ')');\n      }\n\n      var isMulti = false;\n\n      if (node.activity.multiWorkItem || participateFrom[from] && participateFrom[from].multi == \"select\" || node.activity.type == 'subflow') {\n        isMulti = true;\n      }\n\n      managerDom.find('.show-multi-participants,.multi-select-par,.org-arrow').unbind('click').on('click', function () {\n        _p.handleData.newSelectParticipateForGroup(managerDom, activity, tipTitle, isMulti);\n      });\n\n      if (!isMobile) {\n        managerDom.unbind('mouseover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n          var content = managerDom.find('.show-multi-participants').attr('showtitle');\n\n          if (content) {\n            $(dom).css('overflow', 'visible');\n            managerDom.find('.show-multi-participants').popover({\n              html: true,\n              content: content,\n              trigger: \"hover\",\n              template: SUI.Util.popTpl.tip,\n              placement: \"auto bottom\"\n            });\n            managerDom.find('.show-multi-participants').popover('show');\n          }\n        }).on('mouseout', '.show-multi-participants', function () {\n          managerDom.find('.show-multi-participants').popover('destroy');\n        });\n      }\n\n      if (isMobile) {\n        managerDom.find('.show-multi-participants').addClass('participants-default-multi-seleted');\n      }\n    } else {\n      if (linked == 'custom') {\n        window.addEventListener('message', cacheData_change, \"*\");\n        _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n          type: \"POST\",\n          url: \"com.sudytech.portalone.base.ui.queryParticipants.biz.ext\",\n          data: wf.jsonString({\n            activityDefID: activity,\n            process: process,\n            orgId: orgId,\n            from: from,\n            workItemId: config.workItemId,\n            processInstId: processInstId || 0,\n            thisEntity: $(\".sui-form\").sui().getValue()\n          }),\n          contentType: \"text/json\",\n          success: function success(data) {\n            var list = data.list;\n            $(dom).trigger('load', [list]);\n            allPartis = list || [];\n            cache[key] = allPartis;\n            ajaxData[key] = allPartis;\n            var postType = {\n              type: \"repeatAjax\",\n              data: allPartis,\n              key: key,\n              node: node,\n              personInfo: personInfo\n            };\n            window.postMessage(JSON.stringify(postType), \"*\");\n\n            _p.filterManager(managerDom, node, allPartis, personInfo);\n          },\n          error: function error() {\n            _ShutDownSuccess = true;\n          }\n        });\n      } else {\n        window.addEventListener('message', cacheData_change, \"*\");\n\n        if (cacheData) {\n          cacheData = ajaxData[lastKey];\n          allPartis = cacheData;\n          setTimeout(function () {\n            _p.filterManager(managerDom, node, allPartis, personInfo);\n          }, 1);\n        } else {\n          if (!repeatAjax) {\n            _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n              type: \"POST\",\n              url: \"com.sudytech.portalone.base.ui.queryParticipants.biz.ext\",\n              data: wf.jsonString({\n                activityDefID: activity,\n                process: process,\n                orgId: orgId,\n                from: from,\n                workItemId: config.workItemId,\n                processInstId: processInstId || 0\n              }),\n              contentType: \"text/json\",\n              success: function success(data) {\n                var list = data.list;\n                $(dom).trigger('load', [list]);\n                allPartis = list || [];\n                cache[key] = allPartis;\n                ajaxData[key] = allPartis;\n                var postType = {\n                  type: \"repeatAjax\",\n                  data: allPartis,\n                  key: key,\n                  node: node,\n                  personInfo: personInfo\n                };\n                window.postMessage(JSON.stringify(postType), \"*\");\n\n                _p.filterManager(managerDom, node, allPartis, personInfo);\n              },\n              error: function error() {\n                _ShutDownSuccess = true;\n              }\n            });\n          }\n        }\n      }\n    }\n  }; // 回填经办人\n\n\n  this.filterManager = function (managerDom, node, allPartis, personInfo) {\n    managerDom.empty(); //参与者下拉选\n\n    var select = \"\";\n    var multi = false;\n    var exts = node.exts || {};\n    var attrs = exts.attrs || {};\n    var from = node.parent.activity.id;\n    var activity = node.activity.id;\n\n    var participateFrom = _p.handleData.parseParti(attrs.participateFrom);\n\n    var participateFromConfig = _p.handleData.parsePartiConfig(attrs.participateFromConfig);\n\n    var participateSelectType = _p.handleData.parseSelectAttrs(attrs.participateSelectType);\n\n    var isChildActivity = node.activity.type == 'subflow' ? true : false;\n    var isFreeSelect = false;\n\n    if (config.displayName) {\n      if ($('.sui-opinionone').length > 0 && $('.sui-opinionone').sui().getConfig().mode == \"editable\" || config.properties.attach) {\n        var body = $(\".participants-opinion\", dom);\n        $(dom).empty();\n        $(dom).append(body);\n        var html = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name\">下一步：</div>' + '<div class=\"item-value\">未办理人：' + config.displayName + '</div>' + '</div>' + '</div>' + '</div>';\n        $(dom).append(html);\n      } else {\n        $(dom).empty();\n        var html = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\">' + '<div class=\"form-item\">' + '<div class=\"item-name\">下一步：</div>' + '<div class=\"item-value\">未办理人：' + config.displayName + '</div>' + '</div>' + '</div>' + '</div>';\n        $(dom).append(html);\n      }\n\n      return;\n    }\n\n    if (participateSelectType[from] && \"postSet\" == participateSelectType[from].selectRange) {\n      if (participateSelectType[from].showType) {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"1\" activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\" dataType=\"' + participateSelectType[from].dataType + '\"  showType=\"' + participateSelectType[from].showType + '\" selectMulti=\"' + participateSelectType[from].selectMulti + '\"></div>');\n        SUI.init($.noop(), managerDom);\n        isFreeSelect = true;\n      }\n    } else if (participateSelectType[from] && \"all\" == participateSelectType[from].selectRange) {\n      managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"0\" activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\" dataType=\"' + participateSelectType[from].dataType + '\"  selectMulti=\"' + participateSelectType[from].selectMulti + '\"></div>');\n      SUI.init($.noop(), managerDom);\n      isFreeSelect = true;\n    } else if (participateSelectType[from] && \"positionSelect\" == participateSelectType[from].selectRange) {\n      managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"4\" activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\" dataType=\"' + participateSelectType[from].dataType + '\"></div>');\n      SUI.init($.noop(), managerDom);\n      isFreeSelect = true;\n    }\n\n    if (config.partiSet[activity] && 6 != config.partiSet[activity][\"SELECTRANGE\"]) {\n      if (config.partiSet[activity][\"SELECTRANGE\"] != '1') {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"' + config.partiSet[activity][\"SELECTRANGE\"] + '\" empType=\"' + config.partiSet[activity][\"PARAMETER\"] + '\" activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\" dataType=\"' + config.partiSet[activity][\"DATATYPE\"] + '\"  selectMulti=\"' + node.activity.multiWorkItem + '\"></div>');\n        SUI.init($.noop(), managerDom);\n        isFreeSelect = true;\n      }\n    } // 任意选择人员\n\n\n    if (participateFrom[from] && participateFrom[from].action.indexOf('personnel') != -1) {\n      if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat && participateFromConfig[from].selectIdenity) {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"6\" datatype=\"emp\"  activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\"  isIdentityChoose=\"' + participateFromConfig[from].selectIdenity + '\"  displayformat=\"' + participateFromConfig[from].displayFormat + '\"  selectMulti=\"' + participateFromConfig[from].selectMult + '\"></div>');\n      } else {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"6\" datatype=\"emp\"  activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\"></div>');\n      }\n\n      SUI.init($.noop(), managerDom);\n      isFreeSelect = true;\n    } // 当前机构下选择任意人员\n\n\n    if (participateFrom[from] && participateFrom[from].action.indexOf('personOfOrg') != -1) {\n      if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat) {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"2\" datatype=\"emp\"  activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\" displayFormat=\"' + participateFromConfig[from].displayFormat + '\" selectmulti=\"' + participateFromConfig[from].selectMult + '\"></div>');\n      } else {\n        managerDom.append('<div class=\"sui-selectpersonneltool\" selectRange=\"2\" datatype=\"emp\"  activityDefID=\"' + activity + '\" process=\"' + config.processDefName + '\"></div>');\n      }\n\n      SUI.init($.noop(), managerDom);\n      isFreeSelect = true;\n    }\n\n    if (!isMobile) {\n      if (isFreeSelect) {\n        var participants_next_name = _p.handleData.getParticipateNextName(node);\n\n        if ($('.participants-next-name', dom).length) {\n          $('.participants-next-name', dom).text(participants_next_name);\n        } else {\n          if (hasConcurrent && !isSpecial && !isMobile) {\n            if (!managerDom.find('.current_next_name').length) {\n              managerDom.prepend('<span class=\"current_next_name\">' + participants_next_name + '</span>');\n            }\n\n            var nameWidth = managerDom.find('.current_next_name').width() + 'px';\n            $('.sui-selectpersonneltool', managerDom).css({\n              'width': 'calc(100% - ' + nameWidth + ')',\n              'line-height': '34px'\n            });\n          }\n        }\n\n        managerDom.unbind('mouseover', '.sui-selectpersonneltool input').on('mouseover', '.sui-selectpersonneltool input', function () {\n          var content = managerDom.find('.sui-selectpersonneltool input').attr('showtitle');\n\n          if (content && !isMobile) {\n            $(dom).css('overflow', 'visible');\n            managerDom.find('.sui-selectpersonneltool input').popover({\n              html: true,\n              content: content,\n              trigger: \"hover\",\n              template: SUI.Util.popTpl.tip,\n              placement: \"auto bottom\"\n            });\n            managerDom.find('.sui-selectpersonneltool input').popover('show');\n          }\n        }).on('mouseout', '.sui-selectpersonneltool input', function () {\n          managerDom.find('.sui-selectpersonneltool input').popover('destroy');\n        });\n        return;\n      }\n    } else {\n      if (isFreeSelect) {\n        var participants_next_name = _p.handleData.getParticipateNextName(node);\n\n        if ($('.participants-next-name', dom).length) {\n          $('.participants-next-name', dom).text(participants_next_name);\n\n          if (wf2.isNewInPhone) {\n            var nameWidth = $(dom).find('.participants-next-name').width() + 'px';\n            managerDom.css({\n              'width': 'calc(100% - ' + nameWidth + ')',\n              'line-height': '34px'\n            });\n          }\n        } else {\n          if (hasConcurrent && !isSpecial && !isMobile) {\n            if (!managerDom.find('.current_next_name').length) {\n              managerDom.prepend('<span class=\"current_next_name\">' + participants_next_name + '</span>');\n            }\n\n            if (wf2.isNewInPhone) {\n              var nameWidth = managerDom.find('.current_next_name').width() + 'px';\n              $('.sui-selectpersonneltool', managerDom).css({\n                'width': 'calc(100% - ' + nameWidth + ')',\n                'line-height': '34px'\n              });\n            }\n          }\n        }\n\n        _p.handleData.emptyNextNameforPhone($('.current_next_name'));\n\n        return;\n      }\n    }\n\n    var isMulti_phone = false;\n\n    if (participateFrom[from] && participateFrom[from].multi == \"select\") {\n      multi = true;\n    }\n\n    managerDom.prop(\"multi\", multi);\n    var list = config.partiesFilter ? config.partiesFilter(allPartis, from, activity) : allPartis || [];\n\n    if (personInfo && personInfo.length) {\n      list = personInfo;\n    } else if (personInfo === null) {\n      list = [];\n    }\n\n    var html = \"\";\n    var selectConfig = {\n      minimumResultsForSearch: -1,\n      //option 格式，使全选option展示为按钮格式\n      templateResult: function templateResult(data) {\n        if (!data.element) {\n          return data.text;\n        }\n\n        var $element = $(data.element);\n\n        if ($element[0].className == 'allSelect_btn') {\n          var $wrapper = $('<button class=\"btn btn-primary\"></button>');\n          $wrapper.text(data.text);\n          return $wrapper;\n        } else {\n          return data.text;\n        }\n      }\n    }; // 参与者组下人员 可以搜索\n\n    if (participateFrom[from] && participateFrom[from].action.indexOf('group') != -1) {\n      delete selectConfig['minimumResultsForSearch'];\n    }\n\n    select = $('<select id=\"' + node.activity.id + '\" class=\"form-control js-exa\" style=\"width: 100%\"></select>');\n\n    if (multi) {\n      isMulti_phone = true; // 这是基于select2插件做的多选\n\n      select.attr(\"multiple\", \"multiple\");\n    } //多工作项配置\n\n\n    if (node.activity.multiWorkItem) {\n      isMulti_phone = true; // 这是基于select2插件做的多选\n\n      select.attr(\"multiple\", \"multiple\");\n\n      if (list.length > 1 && !isMobile) {\n        html += '<option value=\"allSelect\" class=\"allSelect_btn\">全选</option>';\n      }\n    } // 如果是子流程 经办人多选\n\n\n    if (isChildActivity) {\n      isMulti_phone = true;\n      select.attr(\"multiple\", \"multiple\");\n    } //ids 逗号分割 多工作项配置 设置全选用\n\n\n    var ids = [];\n\n    for (var i = 0; i < list.length; i++) {\n      var record = list[i];\n      var emps = \"\";\n      var nameAndCode = '';\n      var empCode = '';\n\n      if (record.type == \"position\") {\n        var index = 0;\n        var newEmpList = [];\n\n        for (var newKey in record.emps) {\n          var emp = record.emps[newKey];\n          newEmpList.push(emp);\n        }\n\n        SUI.Util.sort(newEmpList, function (a, b) {\n          return parseInt(a.sortNo) - parseInt(b.sortNo);\n        });\n\n        if (newEmpList.length) {\n          $.each(newEmpList, function (j, n) {\n            if (j > 0) {\n              emps += \",\";\n              empCode += ',';\n              nameAndCode += ',';\n            }\n\n            emps += n.empname;\n            empCode += n.empcode;\n            nameAndCode += n.empname + \"(\" + n.empcode + \")\";\n          });\n        }\n      }\n\n      var id = \"sui-participates-\" + SUI.Util.getSequence(\"Participates\"); //ids 逗号分割  value 多工作项配置 设置全选用\n\n      ids.push(record.positionid); // 在workflow2里拿到接口里的config参数，里面有SHOWCHOOSE和SHOWFORMAT\n\n      if (record.emps && record.emps.type == 'emp') {\n        if (emps.length > 0) {\n          html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + emps + '</option>';\n        }\n      } else {\n        if (config.sysConfig.SHOWFORMAT == 1 || config.sysConfig.SHOWFORMAT == 2 || config.sysConfig.SHOWFORMAT == 0 || config.sysConfig.SHOWFORMAT == 'null' || config.sysConfig.SHOWFORMAT === null) {\n          // 0岗位(姓名) 1姓名(岗位) 2姓名\n          if (\"1\" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === 'emp') {\n              if (emps.length > 0 || record.posiname) {\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + emps + record.posiname + '</option>';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + emps + \"(\" + record.posiname + \")\" + '</option>';\n              }\n            }\n          } else if ('null' === config.sysConfig.SHOWFORMAT || null === config.sysConfig.SHOWFORMAT || \"0\" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === 'emp') {\n              if (emps.length > 0 || record.posiname) {\n                emps = emps.length > 0 ? \"(\" + emps + \")\" : '';\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + record.posiname + emps + '</option>';\n              }\n            } else {\n              if (emps.length > 0) {\n                emps = \"(\" + emps + \")\";\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + record.posiname + emps + '</option>';\n              }\n            }\n          } else if (\"2\" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === 'emp') {\n              if (emps.length > 0 || record.posiname) {\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + (emps ? emps : record.posiname) + '</option>';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + emps + '</option>';\n              }\n            }\n          }\n        } else {\n          var empInfo = {\n            empName: emps,\n            empCode: empCode,\n            nameAndCode: nameAndCode,\n            posiname: record.posiname\n          };\n\n          var format = _p.handleData.format(config.sysConfig.SHOWFORMAT, empInfo);\n\n          if (record.type === 'emp') {\n            html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + format + '</option>';\n          } else {\n            if (emps.length > 0) {\n              html += '<option id=\"' + id + '\" value=\"' + record.positionid + '\" op_type=\"' + record.type + '\" op_name=\"' + record.posiname + '\">' + format + '</option>';\n            }\n          }\n        }\n      }\n\n      if (list.length == 1) {\n        select.next().hide();\n        select.next().after('<span>' + list[0].posiname + '</span>');\n      }\n    }\n\n    if (config.sysConfig.SHOWCHOOSE == '1') {\n      if (list.length > 1) {\n        if (multi) {// selectConfig.placeholder = \"请选择\"\n        } else {\n          if (select.attr('multiple') != 'multiple') {\n            html = '<option>请选择</option>' + html;\n          }\n        }\n      }\n    }\n\n    select.html(html); // select2\n\n    var participants_next_name = _p.handleData.getParticipateNextName(node);\n\n    var participants_next_title = '';\n\n    if (participants_next_name.substring(participants_next_name.length - 1, participants_next_name.length) == '：') {\n      participants_next_title = participants_next_name.substring(0, participants_next_name.length - 1);\n    }\n\n    if ($('.participants-next-name', dom).length) {\n      $('.participants-next-name', dom).text(participants_next_name);\n\n      if (isMobile) {\n        var pLeft = ($('.participants-next-name', dom).width() || 0) + 5 + 'px';\n        managerDom.css('width', 'calc(100% - ' + pLeft + ')');\n      }\n    } else {\n      if (hasConcurrent && !isSpecial && !isMobile) {\n        if (!managerDom.find('.current_next_name').length) {\n          managerDom.prepend('<span class=\"current_next_name\">' + participants_next_name + '</span>');\n        }\n\n        var nameWidth = managerDom.find('.current_next_name').width() + 'px';\n        select.css('width', 'calc(100% - ' + nameWidth + ')');\n      }\n    }\n\n    managerDom.append(select);\n\n    if (isMobile && select && select.find(\"option\").length > 1) {\n      select.addClass('participants-select-phone');\n\n      if (!select.parent().find('.show-select-phone').length && !isMulti_phone && wf2.isNewInPhone) {\n        select.before('<div class=\"show-select-phone\"></div>');\n      }\n\n      managerDom.append('<span class=\"org-arrow new-par-arrow-phone\"></span>');\n    }\n\n    if (isMobile) {\n      if (isMulti_phone) {\n        select.select2($.extend(true, selectConfig, config.select2 || {}));\n        managerDom.prepend('<div class=\"show-multi-select-phone\"></div>');\n        managerDom.find('select').hide();\n        managerDom.find('span.select2').hide();\n\n        if (isMobile && select.find('option').length < 4) {\n          managerDom.unbind('click', '.show-multi-select-phone,.org-arrow').on('click', '.show-multi-select-phone,.org-arrow', function () {\n            managerDom.find('.select2 .select2-selection').trigger('click');\n          });\n        }\n      }\n    } else {\n      select.select2($.extend(true, selectConfig, config.select2 || {}));\n    } // 多选并且选项大于三个\n\n\n    if (isMulti_phone && select.find('option').length > 3) {\n      managerDom.find('.select2').css('display', 'none');\n\n      if (!isMobile) {\n        managerDom.append('<div class=\"show-multi-participants no-select-multi\">请选择' + participants_next_title + '</div><div class=\"multi-select-par\">选择</div>');\n        managerDom.addClass('multi-par-pc');\n      }\n\n      var nameWidth = '';\n\n      if (managerDom.find('.current_next_name').length) {\n        nameWidth = managerDom.find('.current_next_name').width();\n      } else {\n        nameWidth = managerDom.find('.participants-next-name').width();\n      }\n\n      nameWidth = 54 + (nameWidth ? nameWidth : 0) + 'px';\n      managerDom.find('.show-multi-participants').css('width', 'calc(100% - ' + nameWidth + ')');\n      var selectDataSource = [];\n      var optionList = select.find('option');\n      $.each(optionList, function (i, o) {\n        var optionData = {\n          id: $(o).attr('id'),\n          value: $(o).val(),\n          op_type: $(o).attr('op_type'),\n          op_name: $(o).attr('op_name'),\n          showContent: $(o).text()\n        };\n\n        if (optionData.id) {\n          selectDataSource.push(optionData);\n        }\n      });\n\n      if (!isMobile) {\n        managerDom.find('.show-multi-participants,.multi-select-par').unbind('click').on('click', function () {\n          var selectedList = select.val();\n\n          _p.handleData.selectMultiParticipants(managerDom, selectDataSource, selectedList, participants_next_title);\n        });\n      } else {\n        managerDom.unbind('click', '.show-multi-select-phone,.org-arrow').on('click', '.show-multi-select-phone,.org-arrow', function () {\n          var selectedList = select.val();\n\n          _p.handleData.selectMultiParticipantsForPhone(managerDom, selectDataSource, participants_next_title, selectedList);\n        });\n      }\n    } // 当默认有显示 请选择 时，值为空，全选时避开  选择全选时，将 全选 避开\n\n\n    function deleteEmpty(array) {\n      for (var arrrIndex = 0; arrrIndex < array.length; arrrIndex++) {\n        if (array[arrrIndex] === '' || array[arrrIndex] === 'allSelect') {\n          array.splice(arrrIndex, 1);\n        }\n\n        return array;\n      }\n    }\n\n    if (isMobile) {\n      var selectedText = select.find('option:selected').text() || select.find('option:first').text();\n      managerDom.find('.show-select-phone').text(selectedText);\n\n      if (select.find('option').length > 1) {\n        managerDom.find('.show-select-phone').parent().css('height', '34px');\n      } else {\n        managerDom.find('.show-select-phone').parent().css('height', 'auto');\n      }\n    }\n\n    if (isMulti_phone && isMobile) {\n      select.css('position', 'static');\n    } // 切换时控制 全选按钮的显示与隐藏\n\n\n    select.on('change', function () {\n      if (isMobile) {\n        var seletedVal = $(this).val();\n        var selectedText = $(this).find('option:selected').text();\n        managerDom.find('.show-select-phone').text(selectedText);\n\n        if (isMulti_phone && select.find('option').length < 4) {\n          var selectedText = '';\n          var selectedTextList = [];\n\n          if (seletedVal && seletedVal.length) {\n            $.each(seletedVal, function (i, s) {\n              var text = select.find('option[value=' + s + ']').text();\n\n              if (text) {\n                selectedTextList.push(text);\n              }\n            });\n            selectedText = selectedTextList.join(',');\n            managerDom.find('.show-multi-select-phone').text(selectedText);\n          } else {\n            managerDom.find('.show-multi-select-phone').text('');\n          }\n        } else {}\n      }\n\n      var personVal = $(this).val(); // 值是[]和null\n\n      personVal ? personVal : personVal = '[]';\n\n      if (personVal.indexOf('allSelect') > -1) {\n        select.val(deleteEmpty(ids)).trigger('change');\n      }\n    }); //多工作项配置\n\n    if (node.activity.multiWorkItem) {\n      //只有配置participantChooseMore 为true，多工作项默认全选\n      if (node.exts.attrs.participantChooseMore == \"true\") {\n        // 这是基于select2插件做的多选\n        $(\".js-exa\").val(ids).trigger('change'); //默认全选\n\n        $('.js-exa').prop('disabled', true);\n\n        if (select.find('option').length > 3) {\n          if (!managerDom.find('.show-multi-participants').length) {\n            managerDom.append('<div class=\"show-multi-participants no-select-multi\">请选择' + participants_next_title + '</div>');\n\n            if (!isMobile) {\n              managerDom.addClass('multi-par-pc');\n            }\n\n            var nameWidth = '';\n\n            if (managerDom.find('.current_next_name').length) {\n              nameWidth = managerDom.find('.current_next_name').width();\n            } else {\n              nameWidth = managerDom.find('.participants-next-name').width();\n            }\n\n            nameWidth = 54 + (nameWidth ? nameWidth : 0) + 'px';\n            managerDom.find('.show-multi-participants').css('width', 'calc(100% - ' + nameWidth + ')');\n          }\n\n          var optionList = select.find('option');\n          var contentList = [];\n          $.each(optionList, function (i, o) {\n            if ($(o).attr('id')) {\n              contentList.push($(o).text());\n            }\n          });\n          var content = contentList.join(',');\n          managerDom.find('.show-multi-participants').text(content);\n          managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n          managerDom.find('.show-multi-participants').attr('showtitle', content);\n          managerDom.find('.select2').css('display', 'none');\n          managerDom.find('.show-multi-participants,.multi-select-par').unbind('click');\n          managerDom.unbind('mouseover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n            var showContent = managerDom.find('.show-multi-participants').attr('showtitle');\n\n            if (showContent && !isMobile) {\n              $(dom).css('overflow', 'visible');\n              managerDom.find('.show-multi-participants').popover({\n                html: true,\n                content: showContent,\n                trigger: \"hover\",\n                template: SUI.Util.popTpl.tip,\n                placement: \"auto bottom\"\n              });\n              managerDom.find('.show-multi-participants').popover('show');\n            }\n          }).on('mouseout', '.show-multi-participants', function () {\n            managerDom.find('.show-multi-participants').popover('destroy');\n          });\n\n          if (isMobile) {\n            managerDom.find('.show-multi-participants').addClass('participants-default-multi-seleted');\n          }\n        }\n      }\n    }\n\n    if (node.exts.attrs && node.exts.attrs.toAllParticipant && node.exts.attrs.toAllParticipant == 'true') {\n      select.val(deleteEmpty(ids)).trigger('change');\n\n      if (deleteEmpty(ids)) {\n        select.select2({\n          disabled: true\n        });\n\n        if (!isMobile) {\n          managerDom.find('.select2').hide();\n        }\n      }\n\n      var optionList = select.find('option');\n\n      if (!isMobile && optionList.length > 3) {\n        if (!managerDom.find('.show-multi-participants').length) {\n          managerDom.append('<div class=\"show-multi-participants no-select-multi\">请选择' + participants_next_title + '</div><div class=\"multi-select-par\">选择</div>');\n          managerDom.addClass('multi-par-pc');\n          var nameWidth = 54 + managerDom.find('.current_next_name').width() + 'px';\n          managerDom.find('.show-multi-participants').css({\n            \"width\": 'calc(100% - ' + nameWidth + ')'\n          });\n        }\n\n        var contentList = [];\n        $.each(optionList, function (i, o) {\n          if ($(o).attr('id')) {\n            contentList.push($(o).text());\n          }\n        });\n        var content = contentList.join(',');\n        managerDom.find('.show-multi-participants').text(content);\n        managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n        managerDom.find('.show-multi-participants').attr('showtitle', content);\n        managerDom.find('.select2').css('display', 'none');\n        managerDom.find('.show-multi-participants,.multi-select-par').unbind('click');\n        managerDom.unbind('mouseover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n          var showContent = managerDom.find('.show-multi-participants').attr('showtitle');\n\n          if (showContent && !isMobile) {\n            $(dom).css('overflow', 'visible');\n            managerDom.find('.show-multi-participants').popover({\n              html: true,\n              content: showContent,\n              trigger: \"hover\",\n              template: SUI.Util.popTpl.tip,\n              placement: \"auto bottom\"\n            });\n            managerDom.find('.show-multi-participants').popover('show');\n          }\n        }).on('mouseout', '.show-multi-participants', function () {\n          managerDom.find('.show-multi-participants').popover('destroy');\n        });\n\n        if (isMobile) {\n          managerDom.find('.show-multi-participants').addClass('participants-default-multi-seleted');\n        }\n      }\n    } //只有一个选项，隐藏下拉框\n\n\n    if (select && select.find(\"option\").length == 1) {\n      //sendTo.close();\n      select.find('option:first').attr('selected', true);\n\n      if (select.next('span').length > 0) {\n        select.next('span').hide();\n      } else {\n        select.hide();\n      }\n\n      select.after('<span class=\"partici-readonly\">' + select.find(\"option\").first().text() + '</span>');\n\n      if ($(dom).find('.show-multi-select-phone').length) {\n        $(dom).find('.show-multi-select-phone').hide();\n      }\n    }\n\n    if (select && select.find('option').length == 0) {\n      select.hide();\n      select.next('span').hide();\n      select.after('<span class=\"partici-readonly\">未找到符合条件的' + participants_next_title + '</span>');\n    } //全选按钮 不要鼠标悬浮背景变色事件\n\n\n    $('body').on('mouseover', '.select2-results__option', function () {\n      if ($(this).children().length > 0) {\n        $(this).addClass('allSelect_bg');\n      }\n    });\n  }; //处理、获取、数据的一些方法\n\n\n  this.handleData = {\n    // 格式化显示格式\n\n    /**\n     *\n     *\n     *\n     */\n    format: function format(_format, empInfo) {\n      if (_format.length === 0) {\n        return empInfo.empName;\n      } else {\n        var formatData = '';\n        formatData = _format.replace(/\\${positionName}/g, empInfo.posiname || '');\n        formatData = formatData.replace(/\\${empName}/g, empInfo.empName || '');\n        formatData = formatData.replace(/\\${empCode}/g, empInfo.empCode || '');\n        formatData = formatData.replace(/\\${empNameAndempCode}/g, empInfo.nameAndCode || '');\n        return formatData;\n      }\n    },\n    // 因为组查询接口慢改造之后的 新的组方法\n\n    /**\n     * managerDom - 参与者容器\n     * nodeId - 活动id\n     *\n     */\n    newSelectParticipateForGroup: function newSelectParticipateForGroup(managerDom, nodeId, participantsName, isMulti) {\n      var process = wf2.workflow.processDef.processDefName || SUI.Util.getQueryString('process');\n      var groupUrl = '';\n\n      if (isMobile) {\n        var offsetTop = $(window).scrollTop();\n        groupUrl = __basePath + '_libs/plugins/mechanism/participateGroup/participateGroupForPhone.html?offsetTop=' + offsetTop + '&activityDefID=' + nodeId + '&process=' + process + '&isMulti=' + isMulti;\n\n        try {\n          iPortal.openWindow(groupUrl, function (data) {\n            var selectedVal = JSON.parse(data);\n            var showContent = selectedVal.showContent.join(',');\n            var saveValue = selectedVal.saveValue.join(',');\n            var showData = {\n              showContent: showContent,\n              saveValue: saveValue\n            };\n\n            _p.handleData.newParticipateShow(managerDom, showData, participantsName, isMulti, nodeId, process);\n          }, {\n            title: participantsName\n          });\n        } catch (err) {\n          console.log(err);\n          location.href = groupUrl;\n        }\n      } else {\n        var selected = managerDom.find('.show-multi-participants').attr('saveValue') || '';\n        localStorage.setItem('selectedListForGroup', selected);\n        groupUrl = __basePath + '_libs/plugins/mechanism/participateGroup/participateGroupForPc.jsp?activityDefID=' + nodeId + '&process=' + process + '&isMulti=' + isMulti;\n        var groupIndex = layer.open({\n          title: participantsName,\n          type: 2,\n          content: groupUrl,\n          area: [\"900px\", \"512px\"],\n          btn: ['确定', '取消'],\n          success: function success() {\n            $('body').addClass('noscroll');\n          },\n          yes: function yes() {\n            $('body').removeClass('noscroll');\n            var selected = $($(\"#layui-layer-iframe\" + groupIndex)[0].contentWindow.document.getElementById(\"selectedTree\")).children();\n            var showContent = '';\n            var selectedVal = [];\n\n            if (selected.length) {\n              var contentList = [];\n              var saveValue = [];\n              $(selected).each(function (i, s) {\n                var empId = $(s).attr('empid');\n                var empName = $(s).attr('empname');\n\n                if (empId) {\n                  selectedVal.push(empId);\n                }\n\n                if (empName) {\n                  contentList.push(empName);\n                }\n\n                var val = empId + \"$\" + empName;\n                saveValue.push(val);\n              });\n              showContent = contentList.join(',');\n              saveValue = saveValue.join(',');\n              var showData = {\n                showContent: showContent,\n                saveValue: saveValue\n              };\n\n              _p.handleData.newParticipateShow(managerDom, showData, participantsName);\n            } else {\n              var showData = {\n                showContent: '',\n                saveValue: ''\n              };\n\n              _p.handleData.newParticipateShow(managerDom, showData, participantsName);\n            }\n\n            layer.close(groupIndex);\n          },\n          btn2: function btn2() {\n            $('body').removeClass('noscroll');\n            layer.close(groupIndex);\n          },\n          cancel: function cancel() {\n            $('body').removeClass('noscroll');\n            layer.close(groupIndex);\n          }\n        });\n      }\n    },\n    newParticipateShow: function newParticipateShow(managerDom, data, participantsName, isMulti, nodeId, process) {\n      if (data.showContent) {\n        managerDom.find('.show-multi-participants').text(data.showContent);\n        managerDom.find('.show-multi-participants').attr('showtitle', data.showContent);\n        managerDom.find('.show-multi-participants').attr('saveValue', data.saveValue);\n        managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n\n        if (!isMobile) {\n          managerDom.unbind('mouserover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n            var content = managerDom.find('.show-multi-participants').attr('showtitle');\n\n            if (content) {\n              $(dom).css('overflow', 'visible');\n              managerDom.find('.show-multi-participants').popover({\n                html: true,\n                content: content,\n                trigger: \"hover\",\n                template: SUI.Util.popTpl.tip,\n                placement: \"auto bottom\"\n              });\n              managerDom.find('.show-multi-participants').popover('show');\n            }\n          }).on('mouseout', '.show-multi-participants', function () {\n            managerDom.find('.show-multi-participants').popover('destroy');\n          });\n        } else {\n          managerDom.find('.group-arrow-phone').hide(); // 多人办理，显示全部按钮\n\n          if (isMulti) {\n            managerDom.find('.group-arrow-phone').show(); // managerDom.find('.show-multi-participants').html('<span class=\"emp-info-phone\">' + resultData.showContent[0] + '</span>');\n\n            managerDom.find('.show-multi-participants').addClass('allemp-info-phone');\n            managerDom.find('.show-multi-participants').append('<span class=\"show-allemp-phone\">全部</span>');\n            managerDom.find('.show-allemp-phone').unbind('click').on('click', function (e) {\n              e.stopPropagation(); // 阻止冒泡事件\n\n              var offsetTop = $(window).scrollTop();\n              var url = '';\n              url = __basePath + '_libs/plugins/mechanism/participateGroup/person.jsp?offsetTop=' + offsetTop + '&isMulti=' + isMulti + '&activityDefID=' + nodeId + '&process=' + process + '&selected=' + data.saveValue;\n\n              if (url.length > 2047) {\n                url = __basePath + '_libs/plugins/mechanism/participateGroup/person.jsp?offsetTop=' + offsetTop + '&isMulti=' + isMulti + '&activityDefID=' + nodeId + '&process=' + process;\n                localStorage.setItem('selected', data.saveValue);\n              }\n\n              iPortal.openWindow(url, function (data) {\n                var selectedVal = JSON.parse(data);\n                var showContent = selectedVal.showContent.join(',');\n                var saveValue = selectedVal.saveValue.join(',');\n                var showData = {\n                  showContent: showContent,\n                  saveValue: saveValue\n                };\n\n                _p.handleData.newParticipateShow(managerDom, showData, participantsName, isMulti);\n              });\n            });\n          }\n        }\n      } else {\n        managerDom.find('.show-multi-participants').text(participantsName);\n        managerDom.find('.show-multi-participants').attr('showtitle', data.showContent);\n        managerDom.find('.show-multi-participants').attr('saveValue', '');\n        managerDom.find('.show-multi-participants').addClass('no-select-multi');\n      }\n    },\n    // 经办人配置组的情况下选择\n    selectParticipateForGroup: function selectParticipateForGroup(managerDom, participateData, isMulti, selectedList, pTitle) {\n      localStorage.setItem('participateData', JSON.stringify(participateData));\n\n      if (isMobile) {\n        var offsetTop = $(window).scrollTop();\n        var url = __basePath + '_libs/plugins/mechanism/participateGroup/list.html?offsetTop=' + offsetTop + '&isMulti=' + isMulti;\n\n        _p.handleData.showMobileGroup(url, managerDom, isMulti, pTitle, true);\n      } else {\n        var showVal = '';\n        showVal = managerDom.find('.show-multi-participants').attr('saveVale');\n        var index = layer.open({\n          type: 2,\n          title: '请选择' + (pTitle ? pTitle : '经办人'),\n          area: [\"740px\", \"468px\"],\n          content: __basePath + '_libs/plugins/mechanism/participateGroup/participate_group_pc.jsp?isMulti=' + isMulti + '&selectedList=' + showVal,\n          btn: ['确定', '取消'],\n          success: function success() {\n            $('body').addClass('noscroll');\n          },\n          yes: function yes() {\n            $('body').removeClass('noscroll');\n            var selected = $($(\"#layui-layer-iframe\" + index)[0].contentWindow.document.getElementById(\"selectedTree\")).children();\n            var showContent = '';\n            var selectedVal = [];\n\n            if (selected.length) {\n              var contentList = [];\n              var saveValue = [];\n              $(selected).each(function (i, s) {\n                var posId = $(s).attr('positionid');\n                var name = $(s).attr('title');\n\n                if (posId) {\n                  selectedVal.push(posId);\n                }\n\n                if (name) {\n                  contentList.push(name);\n                }\n\n                var val = posId + \"$\" + name;\n                saveValue.push(val);\n              });\n              showContent = contentList.join(',');\n              saveValue = saveValue.join(',');\n\n              if (!isMulti) {\n                selectedVal = selectedVal.join(',');\n              }\n\n              managerDom.find('.show-multi-participants').text(showContent);\n              managerDom.find('.show-multi-participants').attr('showtitle', showContent);\n              managerDom.find('.show-multi-participants').attr('saveVale', saveValue);\n              managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n              managerDom.find('select').val(selectedVal).trigger('change');\n              managerDom.unbind('mouserover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n                var content = managerDom.find('.show-multi-participants').attr('showtitle');\n\n                if (content && !isMobile) {\n                  $(dom).css('overflow', 'visible');\n                  managerDom.find('.show-multi-participants').popover({\n                    html: true,\n                    content: content,\n                    trigger: \"hover\",\n                    template: SUI.Util.popTpl.tip,\n                    placement: \"auto bottom\"\n                  });\n                  managerDom.find('.show-multi-participants').popover('show');\n                }\n              }).on('mouseout', '.show-multi-participants', function () {\n                managerDom.find('.show-multi-participants').popover('destroy');\n              });\n            } else {\n              managerDom.find('.show-multi-participants').text(showContent);\n              managerDom.find('.show-multi-participants').attr('showtitle', showContent);\n              managerDom.find('.show-multi-participants').attr('saveVale', '');\n              managerDom.find('.show-multi-participants').addClass('no-select-multi');\n              managerDom.find('select').val('').trigger('change');\n            }\n\n            layer.close(index);\n          },\n          btn2: function btn2() {\n            $('body').removeClass('noscroll');\n            layer.close(index);\n          },\n          cancel: function cancel() {\n            $('body').removeClass('noscroll');\n            layer.close(index);\n          }\n        });\n      }\n    },\n    // 经办人选择组多选后全部列表显示\n    showMobileGroup: function showMobileGroup(url, managerDom, isMulti, pTitle, selectGroup) {\n      var offsetTop = $(window).scrollTop();\n\n      try {\n        iPortal.openWindow(url, function (data) {\n          var resultData = JSON.parse(data);\n          var selectedVal = resultData.selectedValue;\n          var showContent = resultData.showContent;\n          var saveValue = resultData.saveValue; // 多人办理，点到选择页面，获取的选中数据和旧数据合并去重\n\n          var oldSelectedVal = managerDom.find('select').val();\n\n          if (isMulti && selectGroup && oldSelectedVal && oldSelectedVal.length) {\n            var oldSaveValue = managerDom.find('.show-multi-participants').attr('saveVale');\n            var oldShowContent = managerDom.find('.show-multi-participants').attr('showtitle');\n            if (oldSaveValue) oldSaveValue = oldSaveValue.split(',');\n            if (oldShowContent) oldShowContent = oldShowContent.split(',');\n            $.each(oldSelectedVal, function (index, value) {\n              if (selectedVal.indexOf(value) === -1) {\n                selectedVal.push(value);\n                saveValue.push(oldSaveValue[index]);\n                showContent.push(oldShowContent[index]);\n              }\n            });\n          }\n\n          if (selectedVal.length) {\n            showContent = showContent.join(',');\n            saveValue = saveValue.join(',');\n\n            if (!isMulti) {\n              selectedVal = selectedVal.join(',');\n            }\n\n            managerDom.find('.show-multi-participants').text(showContent);\n            managerDom.find('.show-multi-participants').attr('showtitle', showContent);\n            managerDom.find('.show-multi-participants').attr('saveVale', saveValue);\n            managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n            managerDom.find('.group-arrow-phone').hide();\n            managerDom.find('select').val(selectedVal).trigger('change'); // 多人办理，显示全部按钮\n\n            if (isMulti) {\n              managerDom.find('.group-arrow-phone').show(); // managerDom.find('.show-multi-participants').html('<span class=\"emp-info-phone\">' + resultData.showContent[0] + '</span>');\n\n              managerDom.find('.show-multi-participants').addClass('allemp-info-phone');\n              managerDom.find('.show-multi-participants').append('<span class=\"show-allemp-phone\">全部</span>');\n              managerDom.find('.show-allemp-phone').unbind('click').on('click', function (e) {\n                e.stopPropagation(); // 阻止冒泡事件\n\n                var url = __basePath + '_libs/plugins/mechanism/participateGroup/person.jsp?offsetTop=' + offsetTop + '&isMulti=' + isMulti + '&selected=' + saveValue;\n\n                if (url.length > 2047) {\n                  var selected = url.substring(url.indexOf('&selected=') + 10);\n                  url = url.substring(0, url.indexOf('&selected='));\n                  localStorage.setItem('selected', selected);\n                }\n\n                _p.handleData.showMobileGroup(url, managerDom, isMulti, pTitle);\n              });\n            }\n          } else {\n            managerDom.find('.show-multi-participants').text('请选择' + pTitle);\n            managerDom.find('.show-multi-participants').attr('showtitle', '');\n            managerDom.find('.show-multi-participants').attr('saveVale', '');\n            managerDom.find('.show-multi-participants').addClass('no-select-multi');\n            managerDom.find('.group-arrow-phone').show();\n            managerDom.find('select').val('').trigger('change');\n          }\n        }, {\n          'title': '请选择' + pTitle\n        });\n      } catch (err) {\n        console.log(err);\n        location.href = url;\n      }\n    },\n    //会签经办人选择移动\n    selectMultiParticipantsForPhone: function selectMultiParticipantsForPhone(managerDom, participateData, pTitle) {\n      var selectedList = managerDom.find('select').val();\n      selectedList = selectedList ? selectedList.join(',') : '';\n      localStorage.setItem('participateDataForPhone', JSON.stringify(participateData));\n      var offsetTop = $(window).scrollTop();\n      var url = __basePath + '_libs/plugins/mechanism/participateGroup/multiForPhone.html?offsetTop=' + offsetTop + '&isMulti=true&selectedList=' + selectedList;\n\n      try {\n        iPortal.openWindow(url, function (data) {\n          var backData = JSON.parse(data);\n          var selectedVal = backData.selectedValue;\n          var showContent = backData.showContent || [];\n          showContent = showContent.join(',');\n          managerDom.find('.show-multi-select-phone').text(showContent);\n          managerDom.find('.org-arrow').hide();\n          managerDom.find('select').val(selectedVal).trigger('change');\n        }, {\n          'title': '请选择' + pTitle\n        });\n      } catch (err) {\n        console.log(err);\n        location.href = url;\n      }\n    },\n    //会签经办人选择pc\n    selectMultiParticipants: function selectMultiParticipants(managerDom, dataSource, selectedList, participants_next_name) {\n      selectedList = selectedList || [];\n      var optionsHtml = '';\n      var notSelectHtml = '<div class=\"not-select-list\">';\n      var selectedOptionHtml = '';\n      var selectedHtml = '<div class=\"selected-list\">';\n\n      if (dataSource.length) {\n        $.each(dataSource, function (i, d) {\n          if (selectedList.indexOf(d.value) > -1) {\n            selectedOptionHtml += '<button class=\"btn btn-default selected-button\" title=\"' + d.showContent + '\" id=\"' + d.id + '\" value=\"' + d.value + '\" op_type=\"' + d.op_type + '\" op_name=\"' + d.op_name + '\">' + d.showContent + '</button>';\n          } else {\n            optionsHtml += '<button class=\"btn btn-default not-select-button\" title=\"' + d.showContent + '\" id=\"' + d.id + '\" value=\"' + d.value + '\" op_type=\"' + d.op_type + '\" op_name=\"' + d.op_name + '\">' + d.showContent + '</button>';\n          }\n        });\n        notSelectHtml += optionsHtml + '</div>';\n        selectedHtml += selectedOptionHtml + '</div>';\n        var showHtml = '<div class=\"row participants-modal\">' + '<div class=\"col-md-5\">' + '<div class=\"not-select-title\">待选</div>' + '<input type=\"text\" placeholder=\"搜索(回车键确认)\" class=\"form-control multi-search-par\"/>' + notSelectHtml + '</div>' + '<div class=\"col-md-2 \">' + '<button class=\"btn selected-all\"> >> </button><br><br>' + '<button class=\"btn cancel-all\"> << </button>' + '</div>' + '<div class=\"col-md-5\">' + '<div class=\"selected-title\">已选</div>' + selectedHtml + '</div>' + '</div>';\n        layer.open({\n          type: 1,\n          title: '请选择' + participants_next_name,\n          content: showHtml,\n          area: ['640px', '480px'],\n          btn: ['确定', '取消'],\n          success: function success(layhtml, index) {\n            // 搜索\n            $('.participants-modal').unbind('keyup', '.multi-search-par').on('keyup', '.multi-search-par', function (e) {\n              var keyWord = $(this).val();\n\n              if (e.keyCode === 13) {\n                var buttonList = '';\n                var sList = [];\n                var selectedButton = $('.selected-button');\n\n                if (selectedButton.length) {\n                  $.each(selectedButton, function (i, s) {\n                    var value = $(s).attr('value');\n                    sList.push(value);\n                  });\n                }\n\n                $.each(dataSource, function (i, d) {\n                  if (sList.indexOf(d.value) == -1) {\n                    var sValue = d.value;\n                    var sName = d.op_name;\n                    var sContent = d.showContent;\n\n                    if (keyWord) {\n                      if (sValue == keyWord || sName.indexOf(keyWord) > -1 || sContent.indexOf(keyWord) > -1) {\n                        buttonList += '<button class=\"btn btn-default not-select-button\" title=\"' + d.showContent + '\" id=\"' + d.id + '\" value=\"' + d.value + '\" op_type=\"' + d.op_type + '\" op_name=\"' + d.op_name + '\">' + d.showContent + '</button>';\n                      }\n                    } else {\n                      buttonList += '<button class=\"btn btn-default not-select-button\" title=\"' + d.showContent + '\" id=\"' + d.id + '\" value=\"' + d.value + '\" op_type=\"' + d.op_type + '\" op_name=\"' + d.op_name + '\">' + d.showContent + '</button>';\n                    }\n                  }\n                });\n\n                if (buttonList) {\n                  $('.not-select-list').html(buttonList);\n                } else if (keyWord && !buttonList) {\n                  $('.not-select-list').html('未找到符合条件的数据');\n                }\n              }\n            });\n            $('.participants-modal').unbind('click', '.not-select-button').on('click', '.not-select-button', function () {\n              var optionsData = {\n                id: $(this).attr('id'),\n                value: $(this).attr('value'),\n                op_type: $(this).attr('op_type'),\n                op_name: $(this).attr('op_name'),\n                showContent: $(this).text()\n              };\n              var newHtml = '<button class=\"btn btn-default selected-button\" title=\"' + optionsData.showContent + '\" id=\"' + optionsData.id + '\" value=\"' + optionsData.value + '\" op_type=\"' + optionsData.op_type + '\" op_name=\"' + optionsData.op_name + '\">' + optionsData.showContent + '</button>';\n              $(this).remove();\n              $(layhtml).find('.selected-list').append(newHtml);\n            });\n            $('.participants-modal').unbind('click', '.selected-button').on('click', '.selected-button', function () {\n              var optionsData = {\n                id: $(this).attr('id'),\n                value: $(this).attr('value'),\n                op_type: $(this).attr('op_type'),\n                op_name: $(this).attr('op_name'),\n                showContent: $(this).text()\n              };\n              var newHtml = '<button class=\"btn btn-default not-select-button\" title=\"' + optionsData.showContent + '\" id=\"' + optionsData.id + '\" value=\"' + optionsData.value + '\" op_type=\"' + optionsData.op_type + '\" op_name=\"' + optionsData.op_name + '\">' + optionsData.showContent + '</button>';\n              $(this).remove();\n              $(layhtml).find('.not-select-list').append(newHtml);\n            }); // 全选\n\n            $('.participants-modal').find('.selected-all').unbind('click').on('click', function () {\n              var leftOptions = $('.not-select-button');\n              var rHtml = '';\n\n              if (leftOptions.length) {\n                $.each(leftOptions, function (i, l) {\n                  var optionsData = {\n                    id: $(l).attr('id'),\n                    value: $(l).attr('value'),\n                    op_type: $(l).attr('op_type'),\n                    op_name: $(l).attr('op_name'),\n                    showContent: $(l).text()\n                  };\n                  rHtml += '<button class=\"btn btn-default selected-button\" title=\"' + optionsData.showContent + '\" id=\"' + optionsData.id + '\" value=\"' + optionsData.value + '\" op_type=\"' + optionsData.op_type + '\" op_name=\"' + optionsData.op_name + '\">' + optionsData.showContent + '</button>';\n                });\n                $(layhtml).find('.not-select-list').empty();\n                $(layhtml).find('.selected-list').append(rHtml);\n              }\n            }); // 全不选\n\n            $('.participants-modal').find('.cancel-all').unbind('click').on('click', function () {\n              var rightOptions = $('.selected-button');\n              var lHtml = '';\n\n              if (rightOptions.length) {\n                $.each(rightOptions, function (i, r) {\n                  var optionsData = {\n                    id: $(r).attr('id'),\n                    value: $(r).attr('value'),\n                    op_type: $(r).attr('op_type'),\n                    op_name: $(r).attr('op_name'),\n                    showContent: $(r).text()\n                  };\n                  lHtml += '<button class=\"btn btn-default not-select-button\" title=\"' + optionsData.showContent + '\" id=\"' + optionsData.id + '\" value=\"' + optionsData.value + '\" op_type=\"' + optionsData.op_type + '\" op_name=\"' + optionsData.op_name + '\">' + optionsData.showContent + '</button>';\n                });\n                $(layhtml).find('.selected-list').empty();\n                $(layhtml).find('.not-select-list').append(lHtml);\n              }\n            });\n          },\n          yes: function yes(index) {\n            var selectedList = [];\n            var contentList = [];\n            var selectedButton = $('.selected-button');\n\n            if (selectedButton.length) {\n              $.each(selectedButton, function (i, s) {\n                var value = $(s).attr('value');\n                var content = $(s).text();\n                selectedList.push(value);\n                contentList.push(content);\n              });\n              var content = contentList.join(',');\n              managerDom.find('.show-multi-participants').text(content);\n              managerDom.find('.show-multi-participants').removeClass('no-select-multi');\n              managerDom.find('.show-multi-participants').attr('showtitle', content);\n              managerDom.find('select').val(selectedList).trigger('change');\n              managerDom.unbind('mouseover', '.show-multi-participants').on('mouseover', '.show-multi-participants', function () {\n                var shwocontent = managerDom.find('.show-multi-participants').attr('showtitle');\n\n                if (shwocontent) {\n                  managerDom.find('.show-multi-participants').popover({\n                    html: true,\n                    content: shwocontent,\n                    trigger: \"click\",\n                    template: SUI.Util.popTpl.tip,\n                    placement: \"auto bottom\"\n                  });\n                  managerDom.find('.show-multi-participants').popover('show');\n                }\n              }).on('mouseout', '.show-multi-participants', function () {\n                managerDom.find('.show-multi-participants').popover('destroy');\n              });\n              layer.close(index);\n            } else {\n              managerDom.find('.show-multi-participants').text('请选择' + participants_next_name);\n              managerDom.find('.show-multi-participants').addClass('no-select-multi');\n              managerDom.find('.show-multi-participants').attr('showtitle', '');\n              managerDom.find('select').val('').trigger('change');\n              layer.close(index);\n            }\n          },\n          btn2: function btn2(index) {},\n          cancel: function cancel(index) {}\n        });\n      }\n    },\n    // 获取经办人文本配置\n    getParticipateNextName: function getParticipateNextName(node) {\n      var parNextName = '经办人：';\n\n      if (node.exts && node.exts.attrs && node.exts.attrs.participateSettings) {\n        var participateSettings = JSON.parse(node.exts.attrs.participateSettings);\n\n        if (participateSettings.length) {\n          $.each(participateSettings, function (i, p) {\n            if (node.parent.activity.splitMode == 'OR' || node.parent.activity.joinMode == 'OR') {\n              parNextName = p.participateName ? p.participateName + '：' : '经办人：';\n            } else {\n              if (p.from === participateCurrentNode) {\n                parNextName = p.participateName ? p.participateName + '：' : '经办人：';\n              }\n            }\n          });\n        }\n      }\n\n      return parNextName;\n    },\n    // 判断路由或者并发体只有一个子 且子也只有一个子\n    isTrueOne: function isTrueOne(node) {\n      var isTrue = false;\n\n      if (!_p.handleData.isHasManyNodes(node)) {\n        if (node.children && node.children.length) {\n          return _p.handleData.isTrueOne(node.children[0]);\n        } else {\n          isTrue = true;\n          return isTrue;\n        }\n      } else {\n        return false;\n      }\n    },\n    // 如果是路由或者并发体并且子节点只有一个 获得最内部节点input radio的name\n    getRadioName: function getRadioName(activityNode, isParent) {\n      isParent = isParent || false;\n      var opName = '';\n\n      if ((_p.handleData.isRoute(activityNode) || activityNode.activity.splitMode === 'OR' || activityNode.activity.joinMode === 'OR') && !isParent) {\n        //下层只有一个\n        if (!_p.handleData.isHasManyNodes(activityNode.parent)) {\n          opName = 'participants_' + activityNode.parent.activity.id + '_0';\n          return opName;\n        } else {\n          if (!_p.handleData.isHasManyNodes(activityNode)) {\n            opName = 'participants_' + activityNode.activity.id;\n            return opName;\n          } else {\n            opName = 'participants_' + activityNode.parent.activity.id;\n            return opName;\n          }\n        }\n      } else {\n        if (_p.handleData.isRoute(activityNode.parent) || activityNode.parent.activity.splitMode === 'OR' || activityNode.parent.activity.joinMode === 'OR') {\n          if (!_p.handleData.isHasManyNodes(activityNode.parent)) {\n            var node = $('input[value=' + activityNode.parent.activity.id + ']').prop('node');\n            return _p.handleData.getRadioName(node, true);\n          } else {\n            opName = 'participants_' + activityNode.parent.activity.id;\n            return opName;\n          }\n        } else {\n          opName = 'participants_' + activityNode.parent.activity.id;\n          return opName;\n        }\n      }\n    },\n    //判断如果节点是路由，或者并发体 那么他的下一步是否有有路由或并发体\n    isChildHasRouteOrConn: function isChildHasRouteOrConn(node) {\n      var isChildHas = false;\n\n      _p.setBranchCondition(node);\n\n      var nextSteps = [];\n\n      if (node.branchConditionTree && node.branchConditionTree.children && node.branchConditionTree.children.length > 0) {\n        nextSteps = node.branchConditionTree.children;\n      } else {\n        nextSteps = node.children;\n      }\n\n      if (nextSteps && nextSteps.length > 1) {\n        if (_p.handleData.ishasRouteOrConn(nextSteps)) {\n          isChildHas = true;\n        }\n      } else {\n        if (_p.handleData.ishasRouteOrConn(nextSteps)) {\n          isChildHas = true;\n        }\n      }\n\n      return isChildHas;\n    },\n    //判断所有节点中是否有路由或者并发体\n    ishasRouteOrConn: function ishasRouteOrConn(nextSteps) {\n      var isHas = false;\n\n      if (nextSteps && nextSteps.length) {\n        $.each(nextSteps, function (i, v) {\n          if (v.activity.splitMode === 'OR' || v.activity.joinMode === 'OR' || _p.handleData.isRoute(v)) {\n            isHas = true;\n          }\n        });\n      }\n\n      return isHas;\n    },\n    // 判断父级是路由或并发体，自己不是路由并发体，且是唯一的子节点\n    isNotRouteOrcon: function isNotRouteOrcon(node) {\n      var isNot = false;\n\n      if (_p.handleData.isRoute(node.parent) || node.parent.activity.splitMode === 'OR' || node.parent.activity.joinMode === 'OR') {\n        if (!_p.handleData.isHasManyNodes(node.parent)) {\n          if (node.activity.type === 'manual') {\n            isNot = true;\n          }\n        }\n      }\n\n      return isNot;\n    },\n    // 是并发体或者路由 并且只有一个子节点\n    onlyOneChild: function onlyOneChild(node) {\n      var isOnly = false;\n\n      if (_p.handleData.isRoute(node) || node.activity.splitMode === 'OR' || node.activity.joinMode === 'OR') {\n        if (!_p.handleData.isHasManyNodes(node)) {\n          isOnly = true;\n        }\n      }\n\n      return isOnly;\n    },\n    // 判断吸附模式时 意见是否隐藏\n    isAttachHide: function isAttachHide() {\n      var isHide = false;\n      var attachDom = '';\n\n      if (config.properties.attach) {\n        attachDom = $('div[name=\"' + config.properties.attach + '\"]');\n      } else {\n        attachDom = $('.sui-opinionone');\n      }\n\n      if (attachDom.length) {\n        if (attachDom.is(':hidden')) {\n          isHide = true;\n        }\n      } else {\n        isHide = true;\n      }\n\n      return isHide;\n    },\n    //对活动节点排序\n    sortForNode: function sortForNode(nextSteps) {\n      $.each(nextSteps, function (i, node) {\n        _p.handleData.buildActivityNode(node);\n      });\n      SUI.Util.sort(nextSteps, function (n1, n2) {\n        return n1.sort - n2.sort;\n      });\n    },\n    // getValue path加上当前活动节点 加上to 和who兼容\n    handleSteps: function handleSteps(steps) {\n      presentActivityNode = config.tree ? config.tree.activity.id : wf2.workflow.workItem && wf2.workflow.workItem.activityDefID;\n\n      if (steps.length > 0) {\n        $.each(steps, function (i, step) {\n          if (step.assignment.length == 1) {\n            if (step.assignment[0].id === '请选择') {\n              step.assignment = [];\n            }\n          }\n\n          step.path = presentActivityNode + ',' + step.path;\n          step.to = step.path.substring(step.path.lastIndexOf(',') + 1, step.path.length);\n          step.who = step.assignment;\n          var displayName = $('input[value=' + step.to + ']').attr('displayname') || $('input[value=' + step.to + ']').parents('label').text() || $('option[value=' + step.to + ']').text() || \"\";\n          step.decision = step.optionExt && step.optionExt.name ? step.optionExt.name : displayName;\n          delete step.optionExt;\n        });\n      }\n    },\n    //判断该节点下 是否有多个子节点\n    isHasManyNodes: function isHasManyNodes(activityNode) {\n      _p.setBranchCondition(activityNode);\n\n      var nextSteps = [];\n\n      if (activityNode.branchConditionTree && activityNode.branchConditionTree.children && activityNode.branchConditionTree.children.length > 0) {\n        nextSteps = activityNode.branchConditionTree.children.length;\n      } else {\n        nextSteps = activityNode.children;\n\n        if (activityNode.children) {\n          nextSteps = _typeof(activityNode.children) === 'object' ? activityNode.children.length : activityNode.children;\n        }\n      }\n\n      return nextSteps ? nextSteps > 1 ? true : false : false;\n    },\n    // 判断是否是路由\n    isRoute: function isRoute(node) {\n      var isRoute = false;\n\n      if (node.activity.type === 'route' && node.activity.splitMode === 'XOR' && node.activity.joinMode === 'XOR') {\n        isRoute = true;\n      }\n\n      return isRoute;\n    },\n    // 获取下一步\n    getConncurrentStep: function getConncurrentStep(childStep, conncurrentDom, steps) {\n      var childNext = conncurrentDom.val();\n      var childNext_node = conncurrentDom.prop('node') || {};\n\n      if (childNext_node.parent && childNext_node.parent.activity.id == 'end') {\n        childNext = 'end,' + childNext;\n      }\n\n      var path = childStep.path + ',' + childNext;\n      var child_checkboxList = conncurrentDom.parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody>tr>.participants-child-next input');\n\n      if (child_checkboxList && child_checkboxList.length) {\n        $.each(child_checkboxList, function () {\n          if ($(this).prop('checked')) {\n            var concurrent_childNode = $(this).prop('node');\n            var child_child_Step = {\n              assignment: [],\n              path: '',\n              optionExt: {}\n            };\n            var childNext = $(this).val();\n            var optionExt = $(this).prop('opt') || {};\n            var next_node = $(this).prop('node') || {};\n\n            if (concurrent_childNode.activity.splitMode === 'OR' || concurrent_childNode.activity.joinMode === 'OR' || _p.handleData.isRoute(concurrent_childNode)) {\n              child_child_Step.path = path;\n\n              _p.handleData.getConncurrentStep(child_child_Step, $(this), steps);\n            } else {\n              if (next_node.parent && next_node.parent.activity.id == 'end') {\n                childNext = 'end,' + childNext;\n              }\n\n              child_child_Step.path = path + ',' + childNext;\n              var manager = $(this).parents('td').eq(0).next().find('.manager-content');\n\n              _p.handleData.getManager(manager, child_child_Step);\n\n              child_child_Step.optionExt = optionExt;\n              steps.push(child_child_Step);\n            }\n          }\n        });\n      } else {\n        var special_child = conncurrentDom.parents('tr').eq(0).next().children().find('.participants-child-manager:first>tbody>tr>td>.participants-special');\n\n        if (special_child.length > 0) {\n          var step = {\n            assignment: [],\n            path: '',\n            optionExt: {}\n          };\n          var special_nextDom = special_child.find('.participants-next>select');\n          var special_next = path + ',' + special_nextDom.val();\n          var optionExt = special_nextDom.find('option[value=\"' + special_nextDom.val() + '\"]').prop('opt');\n          var special_managerDom = special_child.find('.participants-manager');\n\n          _p.handleData.getManager(special_managerDom, step);\n\n          step.path = special_next;\n          step.optionExt = optionExt;\n          steps.push(step);\n        }\n      }\n    },\n    // 获取机构 或人员选择器信息\n    getOrgIdOrPerson: function getOrgIdOrPerson(widgetdom, type) {\n      var zoo = widgetdom.sui() ? $.isArray(widgetdom.sui()) ? widgetdom.sui()[0] : widgetdom.sui() : '';\n\n      if (type === 'orgId') {\n        var orgId = '';\n\n        if (zoo) {\n          if (zoo.getOrgId && typeof zoo.getOrgId === \"function\") {\n            //如果控件中提供了getOrgId方法，则根据该方法获取值\n            orgId = zoo.getOrgId();\n          } else {\n            var zooVal = SUI.Util.parseJSON(zoo.getValue(), true);\n\n            if ($.isArray(zooVal)) {\n              //多选机构\n              if (zooVal.length) {\n                orgId = [];\n                $.each(zooVal, function (i, v) {\n                  if (v && v.orgid) {\n                    orgId.push(v.orgid);\n                  }\n                });\n              }\n            } else {\n              //单选机构\n              orgId = zooVal != null && _typeof(zooVal) === 'object' ? zooVal.id : zooVal;\n            }\n          }\n        }\n\n        return orgId;\n      } else if (type === 'person') {\n        var personInfo = [];\n\n        if (zoo) {\n          var zooVal = SUI.Util.parseJSON(zoo.getValue() || \"[]\", true);\n\n          if (zooVal.length) {\n            $.each(zooVal, function (_, v) {\n              personInfo.push({\n                positionid: v.id,\n                posiname: v.name,\n                type: v.type\n              });\n            });\n          }\n        }\n\n        return personInfo;\n      }\n    },\n    // 获取关联 机构、人员选择器配置\n    getParticipateFrom: function getParticipateFrom(allpartis, node) {\n      var participateFrom = \"\";\n\n      if (allpartis) {\n        var currActId = node.parent.activity.id;\n        var partis = allpartis.split(\",\");\n\n        for (var i in partis) {\n          var p = partis[i];\n\n          if (p.substring(0, p.indexOf(\":\")) == currActId) {\n            participateFrom = p.substring(p.indexOf(\":\") + 1);\n            break;\n          }\n        }\n      }\n\n      return participateFrom;\n    },\n    //getvalue 取已选中的经办人\n    getManager: function getManager(managerDom, step) {\n      var managerVal = [];\n\n      if (managerDom.find('select').length > 0) {\n        var selectedVal = managerDom.find('select').val();\n\n        if (typeof selectedVal == 'string') {\n          managerVal.push(selectedVal);\n        } else {\n          managerVal.push.apply(managerVal, selectedVal);\n        }\n\n        if (managerVal.length) {\n          $.each(managerVal, function (index, val) {\n            var option = $('[value=\"' + val + '\"]', managerDom);\n            step.assignment[step.assignment.length] = {\n              id: val,\n              name: option.attr(\"op_name\"),\n              type: option.attr(\"op_type\")\n            };\n          });\n        }\n      } else if (managerDom.find('.sui-selectpersonneltool').length > 0) {\n        var selectedVal = JSON.parse(managerDom.find('.sui-selectpersonneltool input').attr('who') || \"[]\");\n        managerVal.push.apply(managerVal, selectedVal);\n        step.assignment.push.apply(step.assignment, managerVal);\n      } else if (managerDom.find('.show-multi-participants').length > 0) {\n        var selectedVal = managerDom.find('.show-multi-participants').attr('saveValue') || '';\n\n        if (selectedVal) {\n          selectedVal = selectedVal.split(',');\n\n          if (selectedVal.length) {\n            $.each(selectedVal, function (i, v) {\n              var val = v.split('$');\n              var empInfo = {\n                id: val[0],\n                name: val[1],\n                type: 'emp'\n              };\n              managerVal.push(empInfo);\n            });\n          }\n        }\n\n        step.assignment.push.apply(step.assignment, managerVal);\n      }\n    },\n    // 样式模板\n    template: function template(node, opName, opt, i) {\n      i = i || 0;\n      var id = \"participants_\" + node.activity.id + '_' + i;\n      var templateHtml = '';\n\n      if (node.activity.splitMode === 'OR' || node.activity.joinMode === 'OR' || _p.handleData.isRoute(node)) {\n        //如果路由或者并发体下面只有一个节点就隐藏路由或并发体 并且子节点样式往左移动 并且 name也是自己节点的name否则是父节点name\n        var isHide = _p.handleData.isTrueOne(node) ? 'hid' : '';\n        var isleft = _p.handleData.isTrueOne(node) ? 'node-left' : '';\n\n        if (node.parent && node.parent.activity.id == 'end') {\n          opName = opName;\n          isHide = '';\n          isleft = '';\n        } else {\n          opName = _p.handleData.isTrueOne(node) ? 'participants_' + node.activity.id : opName;\n        }\n\n        if (node.options) {\n          templateHtml = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td form-concurrent col-xs-12 ' + isHide + '\">' + '<div class=\"item-value participants-next\">' + '<label for=\"' + id + '\"><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" root=\"true\" value=\"' + node.activity.id + '\" displayName=\"' + (opt.name || node.displayName || node.activity.name) + '\"/>' + (opt.name || node.displayName || node.activity.name) + '</label>' + '</div>' + '</div>' + '<div class=\"form-td form-concurrent col-xs-12\">' + '<table class=\"table participants-concurrent ' + isleft + '\" ><tbody></tbody></table>' + '</div>' + '</div>';\n        } else {\n          templateHtml = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td form-concurrent col-xs-12 ' + isHide + '\">' + '<div class=\"item-value participants-next\">' + '<label for=\"' + id + '\"><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" root=\"true\" value=\"' + node.activity.id + '\" displayName=\"' + (node.displayName || node.activity.name) + '\"/>' + (node.displayName || node.activity.name) + '</label>' + '</div>' + '</div>' + '<div class=\"form-td form-concurrent col-xs-12\">' + '<table class=\"table participants-concurrent ' + isleft + '\" ><tbody></tbody></table>' + '</div>' + '</div>';\n        }\n      } else {\n        if (node.options) {\n          templateHtml = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td form-normal col-sm-6 col-xs-12\">' + '<div class=\"item-value participants-next\">' + '<label for=\"' + id + '\"><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" root=\"true\" value=\"' + node.activity.id + '\" displayName=\"' + (opt.name || node.displayName || node.activity.name) + '\"/>' + (opt.name || node.displayName || node.activity.name) + '</label>' + '</div>' + '</div>' + '<div class=\"form-td form-normal col-sm-6 col-xs-12\">' + '<div class=\"item-value participants-manager\">' + '</div>' + '</div>' + '</div>';\n        } else {\n          templateHtml = '<div class=\"form-tr clearfix\">' + '<div class=\"form-td form-normal col-sm-6 col-xs-12\">' + '<div class=\"item-value participants-next\">' + '<label for=\"' + id + '\"><input id=\"' + id + '\" type=\"radio\" name=\"' + opName + '\" root=\"true\" value=\"' + node.activity.id + '\" displayName=\"' + (node.displayName || node.activity.name) + '\"/>' + (node.displayName || node.activity.name) + '</label>' + '</div>' + '</div>' + '<div class=\"form-td form-normal col-sm-6 col-xs-12\">' + '<div class=\"item-value participants-manager\">' + '</div>' + '</div>' + '</div>';\n        }\n      }\n\n      return templateHtml;\n    },\n    // 判断是否有并发体\n    isConcurrent: function isConcurrent(stepsList) {\n      var isConcurrent = false;\n      $.each(stepsList, function (j, step) {\n        if (step.activity.splitMode === 'OR' || step.activity.joinMode === 'OR' || _p.handleData.isRoute(step)) {\n          isConcurrent = true;\n          hasConcurrent = true;\n        }\n      });\n      return isConcurrent;\n    },\n    //转换参与者选择器配置数型\n    parseSelectAttrs: function parseSelectAttrs(participateSelectType) {\n      var data = {};\n\n      if (!participateSelectType) {\n        return data;\n      }\n\n      var splits = participateSelectType.split(\";\");\n      $.each(splits, function (i, v) {\n        var exp = v.split(\"_\");\n        data[exp[0]] = JSON.parse(exp[1]);\n      });\n      return data;\n    },\n    //转换参与者控件配置属性\n    parseParti: function parseParti(participateFrom) {\n      var data = {};\n\n      if (!participateFrom) {\n        return data;\n      }\n\n      var splits = participateFrom.split(\",\");\n      $.each(splits, function (i, v) {\n        var exp = v.split(\":\");\n        var action = {};\n        data[exp[0]] = action;\n        var index = exp[1].indexOf(\"[\");\n\n        if (index > -1) {\n          action.multi = exp[1].substring(index + 1, exp[1].indexOf(\"]\"));\n          action.action = exp[1].substring(0, index);\n        } else {\n          action.action = exp[1];\n        }\n      });\n      return data;\n    },\n    // 会签参与者相关配置转换\n    parsePartiConfig: function parsePartiConfig(participateFromConfig) {\n      var data = {};\n\n      if (!participateFromConfig) {\n        return data;\n      }\n\n      data = eval('(' + \"{\" + participateFromConfig + \"}\" + ')');\n      return data;\n    },\n    // 构建节点数据\n    buildActivityNode: function buildActivityNode(activityNode) {\n      var isConcurrent = activityNode.activity.splitMode === 'OR' ? true : false;\n      var lineExts = ((isConcurrent ? activityNode.exts || {} : activityNode.parent.exts || {}).attrs || {}).lineExt || '{}';\n      var _lineExts = ((isConcurrent ? activityNode.exts || {} : activityNode.parent.exts || {}).attrs || {})._lineExt;\n\n      if (_lineExts) {\n        lineExts += _lineExts;\n      }\n\n      lineExts = SUI.Util.parseJSON(lineExts, true);\n      var parentNode = activityNode.parent;\n\n      if (parentNode) {\n        if (parentNode.connectors && parentNode.connectors.length) {\n          $.each(parentNode.connectors, function (i, child) {\n            if (child.destActID === activityNode.activity.id) {\n              var lineExt = lineExts[activityNode.activity.id] || {};\n              activityNode.options = lineExt.options;\n              activityNode.sort = 0;\n              activityNode.displayName = child.displayName;\n              var displayName = child.displayName;\n\n              if (displayName.indexOf(':') > -1) {\n                var index = displayName.indexOf(':');\n                activityNode.sort = displayName.substring(0, index) - 0;\n                activityNode.displayName = displayName.substring(index + 1);\n              }\n            }\n          });\n        }\n      }\n    },\n    // 关联多选机构选择器 队列查询\n    queryParticipantsByOrgIdList: function queryParticipantsByOrgIdList(allPartis, params, length, i) {\n      if (i > length - 1) {\n        _p.filterManager(params.managerDom, params.node, allPartis, params.personInfo);\n\n        return false;\n      }\n\n      $.ajax({\n        type: \"POST\",\n        url: \"com.sudytech.portalone.base.ui.queryParticipants.biz.ext\",\n        data: wf.jsonString({\n          activityDefID: params.activityDefID,\n          process: params.process,\n          orgId: params.orgId[i],\n          from: params.from,\n          workItemId: params.workItemId,\n          processInstId: params.processInstId\n        }),\n        contentType: \"text/json\",\n        success: function success(data) {\n          var list = data.list;\n          allPartis = allPartis.concat(list);\n          allPartis.sort();\n          var result = [];\n\n          if (allPartis.length) {\n            result = [allPartis[0]];\n\n            for (var j = 1; j < allPartis.length; j++) {\n              allPartis[j].positionid !== allPartis[j - 1].positionid && result.push(allPartis[j]);\n            }\n          }\n\n          if (i == length - 1) {\n            $(dom).trigger('load', [result]);\n          }\n\n          _p.handleData.queryParticipantsByOrgIdList(result, params, length, ++i);\n        },\n        error: function error() {\n          _ShutDownSuccess = true;\n        }\n      });\n    },\n    childNodeGetPath: function childNodeGetPath(node, path) {\n      if (node && node.parent && node.parent.activity.id == 'end') {\n        path = node.parent.activity.id + ',' + path;\n        return path;\n      } else if (node && node.parent && (node.parent.activity.splitMode == 'OR' || node.parent.activity.joinMode == 'OR')) {\n        path = node.parent.activity.id + ',' + path;\n\n        var childNode = _p.handleData.getNodeFromTree(null, node.parent.activity.id);\n\n        return _p.handleData.childNodeGetPath(childNode, path);\n      } else {\n        return path;\n      }\n    },\n    getNodeFromTree: function getNodeFromTree(sNone, id) {\n      var children = sNone && sNone.children || config.tree.children;\n\n      if (children && children.length) {\n        $.each(children, function (i, node) {\n          if (node.activity.id == id) {\n            nodefromchild = $.extend(true, {}, node);\n            return false;\n          } else if (node.children) {\n            return _p.handleData.getNodeFromTree(node, id);\n          }\n        });\n        return nodefromchild;\n      } else {\n        return nodefromchild;\n      }\n    },\n    emptyNextNameforPhone: function emptyNextNameforPhone($next_name) {\n      if ($next_name instanceof jQuery) {\n        $next_name.empty(); // 清除经办人文本内容\n        // 如果后面有箭头，将箭头居中\n\n        var $org_arrow = $next_name.parent().find('.org-arrow');\n\n        if ($org_arrow.length) {\n          var top = ($next_name.parent().height() - $org_arrow.get(0).offsetHeight) / 2;\n          $org_arrow.css('top', top + 'px');\n        }\n      }\n    }\n  }; //关联表单机构控件 、人员选择控件,自定义\n\n  this.bindForm = function (manager, node, processInstId, parNextName) {\n    var participateFrom = _p.handleData.getParticipateFrom(node.exts.attrs.participateFrom, node);\n\n    if (participateFrom && participateFrom != 'customparticipate') {\n      if (participateFrom.indexOf(\"formValue\") > -1 || participateFrom.indexOf(\"personValue\") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf(\"[\") + 1, participateFrom.indexOf(\"]\"));\n        var widgetdom = $(\"#\" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $(\"div[name=\" + widgetid + \"]\");\n        } // 初始化\n\n\n        if (participateFrom.indexOf(\"formValue\") > -1) {\n          var param = _p.handleData.getOrgIdOrPerson(widgetdom, 'orgId');\n\n          _p.managerRender(manager, param, node, processInstId, '', 'orgtrue');\n\n          $(document).on('businessDone', function () {\n            var param = _p.handleData.getOrgIdOrPerson(widgetdom, 'orgId');\n\n            _p.managerRender(manager, param, node, processInstId, '', 'orgtrue');\n          });\n        } else if (participateFrom.indexOf(\"personValue\") > -1) {\n          var param = _p.handleData.getOrgIdOrPerson(widgetdom, 'person');\n\n          if (param && param.length) {\n            _p.managerRender(manager, '', node, processInstId, param);\n          } else {\n            _p.managerRender(manager, '', node, processInstId, null);\n          }\n\n          $(document).on('businessDone', function () {\n            var param = _p.handleData.getOrgIdOrPerson(widgetdom, 'person');\n\n            if (param && param.length) {\n              _p.managerRender(manager, '', node, processInstId, param);\n            } else {\n              _p.managerRender(manager, '', node, processInstId, null);\n            }\n          });\n        } //绑定change事件\n\n\n        if (widgetdom.length) {\n          if (participateFrom.indexOf(\"formValue\") > -1) {\n            widgetdom.on(\"change\", function () {\n              var orgid = _p.handleData.getOrgIdOrPerson($(this), 'orgId');\n\n              _p.managerRender(manager, orgid, node, processInstId, '', 'orgtrue');\n            });\n          } else if (participateFrom.indexOf(\"personValue\") > -1) {\n            widgetdom.on(\"change\", function () {\n              var personInfo = _p.handleData.getOrgIdOrPerson($(this), 'person');\n\n              if (personInfo && personInfo.length) {\n                _p.managerRender(manager, '', node, processInstId, personInfo);\n              } else {\n                _p.managerRender(manager, '', node, processInstId, null);\n              }\n            });\n          }\n        }\n      } else {\n        _p.managerRender(manager, 0, node, processInstId);\n      }\n    } else if (participateFrom == 'customparticipate' && node.exts.attrs.fieldBindParticipate) {\n      var bindField = node.exts.attrs.fieldBindParticipate;\n      var widgetDom = $(\"div[name=\" + bindField + \"]\");\n\n      if (widgetDom.length > 0) {\n        _p.managerRender(manager, 0, node, processInstId, '', 'custom');\n\n        widgetDom.on('change', function () {\n          _p.managerRender(manager, 0, node, processInstId, '', 'custom');\n        });\n        $(document).on('businessDone', function () {\n          _p.managerRender(manager, 0, node, processInstId, '', 'custom');\n        });\n      } else {\n        _p.managerRender(manager, 0, node, processInstId, '', 'custom');\n      }\n    } else {\n      _p.managerRender(manager, 0, node, processInstId);\n    }\n  };\n\n  this.setValue = function (val) {};\n\n  this.getValue = function () {\n    var steps = [];\n\n    if (hasConcurrent) {\n      var radios = $(dom).find('.participants-content .form-td .participants-next').find('input[type=\"radio\"]');\n\n      if (radios && radios.length) {\n        $.each(radios, function () {\n          var checked = $(this).prop('checked');\n\n          if (checked) {\n            var node = $(this).prop('node');\n            var next = $(this).val();\n\n            if (node.parent && node.parent.activity.id == 'end') {\n              next = 'end,' + next;\n            } // 如果是并发体或者路由则查询子节点\n\n\n            if (node.activity.splitMode === 'OR' || node.activity.joinMode === 'OR' || _p.handleData.isRoute(node)) {\n              if ($(this).parents('.form-td').eq(0).next().find('.participants-concurrent>tbody>tr>td>.participants-special').length > 0) {\n                var step = {\n                  assignment: [],\n                  path: '',\n                  optionExt: {}\n                };\n                var specialDom = $(this).parents('.form-td').eq(0).next().find('.participants-concurrent>tbody>tr>td>.participants-special');\n                var special_nextDom = specialDom.find('.participants-next>select');\n                var special_nextDomVal = special_nextDom.val() || special_nextDom.find('option:first').val();\n                var special_defaultVal = special_nextDom.val() || special_nextDom.find('option:first').val();\n                var special_nextDom_node = specialDom.find('.participants-next>select').find('option[value=\"' + special_nextDomVal + '\"]:selected').prop('node') || {};\n\n                if (special_nextDom_node.parent && special_nextDom_node.parent.activity.id == 'end') {\n                  special_nextDomVal = 'end,' + special_nextDomVal;\n                }\n\n                var special_next = next + ',' + special_nextDomVal;\n                var optionExt = special_nextDom.find('option[value=\"' + special_defaultVal + '\"]').prop('opt') || {};\n                var special_managerDom = specialDom.find('.participants-manager');\n\n                _p.handleData.getManager(special_managerDom, step);\n\n                step.path = special_next;\n                step.optionExt = optionExt;\n                steps.push(step);\n              } else {\n                var checkboxList = $(this).parents('.form-td').eq(0).next().find('.participants-concurrent>tbody>tr>.participants-child-next input');\n\n                if (checkboxList && checkboxList.length) {\n                  $.each(checkboxList, function () {\n                    if ($(this).prop('checked')) {\n                      var step = {\n                        assignment: [],\n                        path: ''\n                      };\n                      step.path = next;\n                      var childNode = $(this).prop('node');\n\n                      if (childNode.activity.splitMode === 'OR' || childNode.activity.joinMode === 'OR' || _p.handleData.isRoute(childNode)) {\n                        var childStep = {\n                          assignment: [],\n                          path: '',\n                          optionExt: {}\n                        };\n                        var childNext = $(this).val();\n                        var optionExt = $(this).prop('opt') || {};\n                        childStep.path = next;\n                        childStep.optionExt = optionExt;\n\n                        _p.handleData.getConncurrentStep(childStep, $(this), steps);\n                      } else {\n                        var childNext = $(this).val();\n                        var optionExt = $(this).prop('opt') || {};\n                        var childNext_node = $(this).prop('node') || {};\n\n                        if (childNext_node.parent && childNext_node.parent.activity.id == 'end') {\n                          childNext = 'end,' + childNext;\n                        }\n\n                        step.path += ',' + childNext;\n                        step.optionExt = optionExt;\n                        var manager = $(this).parents('td').eq(0).next().find('.manager-content');\n\n                        _p.handleData.getManager(manager, step);\n\n                        steps.push(step);\n                      }\n                    }\n                  });\n                }\n              }\n            } else {\n              var step = {\n                assignment: [],\n                path: '',\n                optionExt: {}\n              };\n              var optionExt = $(this).prop('opt') || {};\n              step.path = next;\n              step.optionExt = optionExt;\n              var manager = $(this).parents('.form-td').eq(0).next().find('.participants-manager');\n\n              _p.handleData.getManager(manager, step);\n\n              steps.push(step);\n            }\n          }\n        });\n      }\n    } else {\n      //吸附\n      var isAttach = config.properties.attach || config.properties.opiniononeAttach === 'true';\n      var step = {\n        assignment: [],\n        path: '',\n        optionExt: {}\n      };\n      var next = '';\n      var manager = null;\n      var optionExt = {};\n\n      if (isAttach && !_p.handleData.isAttachHide() && !isMobile) {\n        next = $(dom).find('.participants-attach-radios input:checked').val();\n        optionExt = $(dom).find('.participants-attach-radios input:checked').prop('opt') || {};\n        manager = $(dom).find('.participants-attach-manager');\n        var node = $(dom).find('.participants-attach-radios input:checked').prop('node') || {};\n        next = _p.handleData.childNodeGetPath(node, next);\n      } else {\n        next = $(dom).find('.participants-next>select').val() || $(dom).find('.participants-next>select>option:first').val();\n        optionExt = $(dom).find('.participants-next>select').find('option[value=\"' + next + '\"]:selected').prop('opt') || {};\n        manager = $(dom).find('.participants-manager');\n        var node = $(dom).find('.participants-next>select').find('option[value=\"' + next + '\"]:selected').prop('node') || {};\n        next = _p.handleData.childNodeGetPath(node, next);\n      }\n\n      _p.handleData.getManager(manager, step);\n\n      step.path = next;\n      step.optionExt = optionExt;\n      steps.push(step);\n    }\n\n    _p.handleData.handleSteps(steps);\n\n    return steps;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr(\"mode\");\n    temp.select = element.attr(\"select\");\n    temp.properties = {\n      name: element.attr(\"name\"),\n      title: element.attr(\"title\"),\n      opiniononeAttach: element.attr(\"opiniononeAttach\"),\n      showType: element.attr(\"showType\"),\n      mspPreview: element.attr(\"msppreview\"),\n      defaultSelectall: element.attr(\"defaultSelectall\")\n    };\n    temp.validate = SUI.Util.parseJSON(element.attr(\"validate\"), true);\n    temp.select2 = SUI.Util.parseJSON(element.attr(\"select2\"), true);\n    temp.resetDataSource = element.attr(\"resetDataSource\") || 'false';\n    return temp;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/NewParticipants/NewParticipants.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Opinion/Opinion.js":
/*!************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Opinion/Opinion.js ***!
  \************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Opinion; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:28 AM\n */\n\n/**\n * 普通意见\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction Opinion(bind) {\n  var value, config;\n  var dom = bind || $('<div></div>').get(0);\n  dom.zoo = this;\n  var opinion;\n  var label;\n  var extAttrs, decision;\n  var opinionChange = false;\n  var defaultOpinion = '';\n\n  this.getValue = function (js) {\n    if (config.mode != \"editable\") {\n      return value;\n    }\n\n    if (config.properties.mspPreview == 'true') {\n      var temp = {};\n    } else {\n      var temp = getMyOpinion();\n    }\n\n    return js ? temp : SUI.Util.toJsonString(temp);\n  };\n\n  this.setExtAttribute = function (key, value) {\n    extAttrs = extAttrs || {};\n    extAttrs[key] = value;\n  };\n\n  this.setDecision = function (_decision) {\n    decision = _decision;\n  };\n\n  this.setOpinion = function (op, iscyyj) {\n    if (!opinionChange) {\n      if (config.maxlength && typeof config.maxlength === 'number') {\n        op = (op + '').substring(0, config.maxlength);\n      }\n\n      opinion.val(op || '');\n      defaultOpinion = op || '';\n    } else {\n      if (iscyyj && iscyyj == 'cyyj') {\n        var val = opinion.val();\n\n        if (config.maxlength && typeof config.maxlength === 'number') {\n          val = (val + op + '').substring(0, config.maxlength);\n        }\n\n        opinion.val(val || '');\n      }\n    }\n\n    opinion.on('change', function () {\n      var changeValue = $(this).val();\n\n      if (changeValue != defaultOpinion) {\n        opinionChange = true;\n      }\n    });\n  };\n\n  function getMyOpinion() {\n    var temp = {};\n    var user = SUI.Util.getUser();\n    temp.userId = user.userId;\n    temp.userName = user.userName;\n    temp.userOrgId = user.userOrgId;\n    temp.userOrgName = user.userOrgName;\n    temp.opinion = opinion.val();\n    temp.date = new Date() - 0;\n    temp.extAttrs = extAttrs;\n    temp.decision = decision;\n    temp.signature = wf2.workflow && wf2.workflow.signature && (wf2.workflow.signature.signatureId ? wf2.workflow.signature.signatureId : '');\n    var steps;\n\n    if ($(\".sui-participates\").length > 0) {\n      steps = $(\".sui-participates\").sui().getValue();\n    }\n\n    if ($(\".sui-moreparticipates\").sui()) {\n      steps = $(\".sui-moreparticipates\").sui().getValue();\n    }\n\n    if ($(\".sui-newparticipants\").length > 0) {\n      steps = $(\".sui-newparticipants\").sui().getValue();\n    }\n\n    if (steps && steps.length == 1) {\n      temp.activityId = steps[0].to;\n    } else {\n      temp.activityId = \"\";\n    }\n\n    return temp;\n  }\n\n  this.getExt = function () {\n    return {\n      type: \"opinion\",\n      value: getMyOpinion()\n    };\n  };\n\n  this.setValue = function (val) {\n    value = val;\n\n    if (!value) {\n      opinion.show();\n      return;\n    }\n\n    var _value = SUI.Util.parseJSON(value, true);\n\n    extAttrs = _value.extAttrs;\n    var item = _value;\n    var signature = item.signature ? item.signature : '';\n    var html = \"\";\n    var dt = new Date();\n    dt.setTime(item.date - 0);\n    dt = SUI.Util.dateFormat(dt, \"yyyy-MM-dd hh:mm\");\n    var showDecision = config.properties.showDecision || 'false';\n\n    if (showDecision == 'true') {\n      html += '<span>' + (item.decision ? \"(\" + item.decision + \")\" : '') + ' ' + item.opinion + '</span><br/>' + '<div class=\"show-opinion-info\" style=\"text-align: right;\">——<img class=\"personal-signature\"  src=\"\"/>' + item.userName + ' ' + dt + '</div>';\n    } else {\n      html += '<span>' + ' ' + item.opinion + '</span><br/>' + '<div style=\"text-align: right;\">——<img class=\"personal-signature\"  src=\"\"/>' + item.userName + ' ' + dt + '</div>';\n    }\n\n    label.html(html);\n    var emptyOpinion = $(dom).attr('emptyopinion') || 'true';\n\n    if (emptyOpinion == 'true') {\n      opinion.val(_value.opinion).trigger('change');\n    }\n\n    if (_value.activityId && config.mode == \"editable\" && $(\".sui-participates\").length > 0) {\n      var partiConfig = $(\".sui-participates\").sui().getConfig();\n\n      if (!partiConfig.properties.attach) {\n        //嵌套风格\n        $(\".sui-participates\").find(\"select\").val(_value.activityId); //.trigger(\"change\");\n      }\n    }\n\n    if (signature) {\n      var wf2_signature = wf2.workflow.signature;\n      var params = {\n        key: wf2_signature.key || '',\n        nonce: wf2_signature.nonce || '',\n        timestamp: wf2_signature.timestamp || '',\n        signature: wf2_signature.signature || ''\n      };\n      var showUrl = wf2_signature.appPath + '/downloadSignature/' + signature + '?key=' + params.key + '&nonce=' + params.nonce + '&timestamp=' + params.timestamp + '&signature=' + params.signature;\n      $(dom).find('.personal-signature').attr('src', showUrl);\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n\n    var require = config.validate && config.validate.require ? \"*\" : \"\";\n\n    var html = '';\n    var maxlength = config.maxlength ? ' maxlength=\"' + config.maxlength + '\"' : \"\";\n    html += '<div class=\"value-text\"></div><textarea class=\"form-control\" rows=\"3\"' + maxlength + '></textarea>';\n    $(dom).html(html);\n\n    if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n      $(dom).addClass('opinion-phone');\n    }\n\n    var template = $(dom);\n    opinion = template.find(\"textarea\");\n    label = template.find(\"div\");\n\n    if (config.properties.defValue) {\n      opinion.val(config.properties.defValue);\n    }\n\n    var mode = config.mode || 'view';\n\n    if (mode == \"readOnly\" || mode == \"view\") {\n      $(dom).addClass('form-readOnly');\n      opinion.attr(\"readOnly\", \"readOnly\");\n      opinion.css('border', 'none');\n      opinion.hide();\n    }\n\n    if (mode == \"editable\") {\n      opinion.removeAttr(\"readOnly\");\n      $(dom).removeClass('form-readOnly');\n      opinion.attr(\"placeholder\", \"请在此输入意见...\");\n      SUI.Util.poptip(config.inputTip, dom, opinion);\n      label.hide();\n      var strategycode = config.strategycode;\n      var opinionSettings = config.opinionSettings ? JSON.parse(config.opinionSettings) : config.opinionSettings;\n\n      if (opinionSettings) {\n        if (opinionSettings.personOpinion != 'true' && opinionSettings.systemOpinion == 'true') {\n          SUI.Util.systemOpinion(dom, opinionSettings.strategycode);\n        } else if (opinionSettings.personOpinion == 'true' && opinionSettings.systemOpinion != 'true') {\n          SUI.Util.personOpinion(dom, '', opinionSettings.strategycode);\n        } else if (opinionSettings.systemOpinion == 'true' && opinionSettings.personOpinion == 'true') {\n          $.ajax({\n            url: \"com.sudytech.portalone.base.strategyOpinion.strategyOpinion.queryCommenOpnionnew.biz.ext\",\n            type: \"post\",\n            dataType: \"json\",\n            data: {\n              strategycode: opinionSettings.strategycode\n            },\n            success: function success(data) {\n              var list = data.results;\n              SUI.Util.personOpinion(dom, list, opinionSettings.strategycode);\n            }\n          });\n        }\n      } else {\n        if (\"\" != strategycode && null != strategycode && !config.count) {\n          config.count = 1; //下拉选方案\n\n          if (config.properties.suiPreview) {\n            if (config.properties.suiPreview == 'true') {\n              return false;\n            }\n          }\n\n          SUI.Util.systemOpinion(dom, strategycode, 'old');\n        }\n      }\n    }\n\n    if (mode == \"hide\") {\n      $(dom).hide();\n    }\n\n    if (config.wfConfig && config.wfConfig.mode == 'print') {// $(dom).hide();\n      //return;\n    }\n\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = opinion.val();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr(\"mode\");\n    temp.properties = {\n      name: element.attr(\"name\"),\n      title: element.attr(\"title\"),\n      defValue: element.attr(\"defValue\"),\n      suiPreview: element.attr('suiprevie'),\n      mspPreview: element.attr('msppreview'),\n      showDecision: element.attr('showDecision') //是否展示decision默认不展示\n\n    };\n    temp.maxlength = Number(element.attr(\"maxlength\") || \"0\");\n    temp.validate = SUI.Util.parseJSON(element.attr(\"validate\"), true);\n    temp.inputTip = element.attr(\"inputTip\") || \"\";\n    temp.emptyOpinion = element.attr('emptyopinion') || 'true';\n    return temp;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Opinion/Opinion.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionHistory/OpinionHistory.js":
/*!**************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionHistory/OpinionHistory.js ***!
  \**************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return OpinionHistory; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:06 AM\n */\n\n/**\n * 流转历史\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction OpinionHistory(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value;\n  dom.zoo = this;\n  this.notForm = true;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        // 预览模式\n        var previewHtml = '<div class=\"box-body no-padding\"><div class=\"layout-2-flowhistory\" style=\"max-height:500px;overflow: auto;\"><div class=\"flow-list\"><div class=\"flow-item\"><div class=\"flow-header\"><i class=\"fa fa-dot-circle-o\"></i> <span class=\"flow-meta meta-time\">08-25 13:14</span></div><div class=\"flow-body\"><div class=\"flow-content\"><div class=\"flow-content-title\">苏迪&nbsp;测试 <a class=\"flow-arrow\"><i class=\"fa fa-angle-down\" style=\"line-height: 40px;\"></i></a></div> <div class=\"flow-content-text\">填写申请</div> <div class=\"uploadFileLog\"><div class=\"flow-content-text\" style=\"border-top:1px solid #dddede;\">历史操作：<p style=\"display:inline;\"><a class=\"wf-fileView\" target=\"_blank\" href=\"/default/downloadfile/1503638075433RDXl2PR\">苏迪corePlus.txt</a><span>(苏迪上传)</span></p></div></div></div></div></div></div></div></div>';\n        $(dom).html(previewHtml);\n        return false;\n      }\n    }\n\n    if (!config.properties.processInstId) {\n      return;\n    }\n\n    if (config.properties.suiPreview) {\n      if (config.properties.suiPreview == 'true') {\n        return false;\n      }\n    }\n\n    $.ajax({\n      type: 'POST',\n      url: \"com.sudytech.portalone.base.workflow.queryOpinionHis.biz.ext\",\n      data: SUI.Util.toJsonString({\n        processInstId: config.properties.processInstId,\n        sort: config.properties.sort\n      }),\n      contentType: \"text/json\",\n      success: function success(data) {\n        var list = data.list;\n        var userConfig = wf2.workflow.userconfig;\n\n        if (userConfig && userConfig.configType && userConfig.configType == 'foldOpinionHistory') {\n          if (userConfig.configValue && userConfig.configValue == 'true') {\n            var newConfig = {\n              properties: {\n                skin: config.properties.skin,\n                alwaysExpand: 'false',\n                expand: 'false'\n              }\n            };\n            $.extend(true, config, newConfig);\n            $(dom).attr('skin', config.properties.skin);\n            $(dom).attr('alwaysExpand', 'false');\n            $(dom).attr('expand', 'false');\n          } else if (userConfig.configValue && userConfig.configValue == 'false') {\n            var newConfig = {\n              properties: {\n                skin: config.properties.skin,\n                alwaysExpand: 'false',\n                expand: 'true'\n              }\n            };\n            $.extend(true, config, newConfig);\n            $(dom).attr('skin', config.properties.skin);\n            $(dom).attr('alwaysExpand', 'false');\n            $(dom).attr('expand', 'true');\n          }\n        }\n\n        if (list.length > 0) {\n          var showdefault = function showdefault(i, item) {\n            if (i == 0) {\n              return '填写申请';\n            } else {\n              if (config.properties.skin == \"flow\") {\n                return '处理意见：' + item.WORKITEMNAME;\n              } else {\n                return item.WORKITEMNAME;\n              }\n            }\n          };\n\n          var showOrg;\n\n          if (config.properties.showOrg == 'true') {\n            showOrg = true;\n          }\n\n          var showLineName = config.properties.showLineName;\n\n          if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n            var html = '';\n            var activityIdList = [];\n            $.each(list, function (i, item) {\n              if (item.WORKITEMTYPE == \"M\" && item.ASSISTANTNAME) {\n                var getUploadLog = function getUploadLog(item) {\n                  var uploadFileLog = \"\";\n\n                  for (var j = 0; j < item.uploadFileLog.length; j++) {\n                    uploadFileLog += '<div>历史操作：<a class=\"wf-fileView\" target=\"_blank\" href=\"' + '/default/downloadfile/' + item.uploadFileLog[j].MODIFYFILE + '\">' + item.uploadFileLog[j].FILE_NAME + '</a><span>(' + item.uploadFileLog[j].EMPNAME + item.uploadFileLog[j].MODIFYTYPE + ')</span></div>';\n                  }\n\n                  return uploadFileLog;\n                };\n\n                if (!item.END_TIME) {\n                  return true;\n                }\n\n                if (\"0\" == config.properties.showType) {\n                  if (!item.DEALOPINION) {\n                    return true;\n                  }\n                }\n\n                if (item.ASSISTANTNAME === null) {\n                  item.ASSISTANTNAME = \"\";\n                }\n\n                var index = $.inArray(item.ACTIVITYINSTID, activityIdList);\n\n                if (index > -1) {\n                  return true;\n                }\n\n                activityIdList.push(item.ACTIVITYINSTID);\n                var activityinstid = item.ACTIVITYINSTID;\n                var itemList = [];\n                itemList.push(item);\n                var itemIndex = 1;\n                $.each(list, function (h, hq) {\n                  if (hq.ACTIVITYINSTID === activityinstid) {\n                    if (itemIndex > 1) {\n                      if (\"0\" == config.properties.showType) {\n                        if (hq.DEALOPINION && hq.END_TIME) {\n                          itemList.push(hq);\n                        }\n                      } else {\n                        if (hq.END_TIME) {\n                          itemList.push(hq);\n                        }\n                      }\n                    }\n\n                    itemIndex++;\n                  }\n                });\n                html += '<div>' + '<div class=\"opinion-history-title\">' + item.WORKITEMNAME + '</div>' + '<div class=\"opinion-history-content\">';\n\n                for (var h = 0; h < itemList.length; h++) {\n                  var orgText = '';\n\n                  if (showOrg == true) {\n                    if (itemList[h].mainOrgName) {\n                      orgText = itemList[h].mainOrgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                    } else if (itemList[h].orgName) {\n                      orgText = itemList[h].orgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                    } else {\n                      orgText = itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                    }\n                  } else {\n                    orgText = itemList[h].ASSISTANTNAME;\n                  }\n\n                  if (itemList[h].END_TIME && itemList[h].END_TIME.length > 3) {\n                    itemList[h].END_TIME = itemList[h].END_TIME.substring(0, itemList[h].END_TIME.length - 3);\n                  }\n\n                  html += '<div class=\"opinion-history-yj\">' + '<div class=\"opinion-history-deal\">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div>' + (SUI.Util.htmlEncode(itemList[h].DEALOPINION) || showdefault(i, itemList[h])) + '</div>';\n\n                  if (config.properties.uploadFileLog == 'true') {\n                    html += '<div class=\"opinion-history-uploadlog\">' + getUploadLog(itemList[h]) + '</div>';\n                  }\n\n                  html += '</div >' + '<div class=\"opinion-history-time\">' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                }\n\n                html += '</div>' + '</div>';\n              }\n            });\n            html = '<div class=\"opinion-body\">' + html + '</div>';\n            var titleHtml = '<div class=\"opinion-history-header\">' + '<div class=\"opinion-history-header-title\">流转历史</div>' + '<div class=\"opinion-content-button\"></div>' + '</div>';\n            $(dom).html(titleHtml + html);\n\n            if (!$(dom).parents('.tr-mark').length) {\n              $('.opinion-body', dom).css('padding', '0 15px 10px 15px');\n            }\n\n            if (config.properties.alwaysExpand === 'false') {\n              $('.opinion-content-button', dom).hide();\n            } else {\n              if (config.properties.expand === 'false') {\n                $('.opinion-content-button', dom).html('<span class=\"content-title-toggle\">查看</span><span class=\"opinion-icon content-hide\"></span>');\n                $('.opinion-body', dom).hide();\n              } else {\n                $('.opinion-content-button', dom).html('<span class=\"content-title-toggle\">收起</span><span class=\"opinion-icon content-show\"></span>');\n              }\n\n              $('.opinion-content-button', dom).on('click', function () {\n                if ($('.opinion-icon').hasClass('content-show')) {\n                  $('.content-title-toggle').text('查看');\n                  $('.opinion-icon').removeClass('content-show').addClass('content-hide');\n                  $('.opinion-body', dom).hide();\n                } else {\n                  $('.content-title-toggle').text('收起');\n                  $('.opinion-icon').removeClass('content-hide').addClass('content-show');\n                  $('.opinion-body', dom).show();\n                }\n              });\n            }\n          } else {\n            var isexpand = function isexpand(tr) {\n              if (config.properties.alwaysExpand == \"false\") {\n                $(dom).html('<div class=\"form-table\">' + tr + '</div>');\n              } else {\n                if (config.wfConfig && config.wfConfig.mode == 'print') {\n                  config.properties.expand = 'true';\n                }\n\n                $(dom).html('<div style=\"text-align:center;\" class=\"lookOpinionHistory\"><a  class=\"btn btn-primary lookOpinionHistoryBtn\" title=\"点击查看流转历史\" href=\"javascript:void(0);\">点击查看</a></div>' + '<div class=\"form-table\">' + tr + \"</div>\" + '<div style=\"text-align:center;\" class=\"hideOpinionHistory\"><a  class=\"btn btn-primary hideOpinionHistoryBtn\" title=\"点击隐藏流转历史\" href=\"javascript:void(0);\">点击隐藏</a></div>');\n\n                if (config.properties.expand == \"true\") {\n                  $('.lookOpinionHistory', dom).hide();\n                  $('.form-table', dom).show();\n                  $('.hideOpinionHistory', dom).show();\n                } else {\n                  $('.lookOpinionHistory', dom).show();\n                  $('.form-table', dom).hide();\n                  $('.hideOpinionHistory', dom).hide();\n                }\n\n                if (config.wfConfig && config.wfConfig.mode == 'print') {\n                  $('.lookOpinionHistory', dom).hide();\n                  $('.hideOpinionHistory', dom).hide();\n                }\n\n                $('.lookOpinionHistoryBtn', dom).click(function () {\n                  $('.lookOpinionHistory', dom).hide();\n                  $('.form-table', dom).show();\n                  $('.hideOpinionHistory', dom).show();\n                });\n                $('.hideOpinionHistoryBtn', dom).click(function () {\n                  $('.lookOpinionHistory', dom).show();\n                  $('.form-table', dom).hide();\n                  $('.hideOpinionHistory', dom).hide();\n                });\n              }\n\n              if (\"true\" == config.properties.uploadFileLog) {\n                $(\".uploadFileLog\", dom).show();\n              } else {\n                $(\".uploadFileLog\", dom).remove();\n              }\n\n              if (($(dom).prev().length && $(dom).prev()[0].nodeName === 'TABLE' || $(dom).parent()[0].nodeName === 'TD') && config.properties.skin === 'default') {\n                var isIn = $(dom).parent()[0].nodeName == 'TD' ? true : false;\n                $('.mspplus-form > table').css('cssText', 'margin-bottom:0!important');\n                $(dom).css('cssText', 'padding:0!important');\n\n                if (isIn) {\n                  $(dom).parent().css('cssText', 'padding:0;');\n                }\n\n                if (SUI.Util.browserType() != 'phone') {\n                  var td_odd = $('.mspplus-form > table >tbody>tr>th:first');\n                  var td_even = $('.mspplus-form > table td:nth-child(2)');\n                  var bg_even = td_even.css('background-color');\n                  var d_wodth = td_odd[0].offsetWidth - 1;\n                  var h_width = $(dom).find('.opinion-history-item').eq(0).width();\n                  var v_width = h_width - d_wodth - 2 + 'px';\n                  var border = td_even.css('border');\n                  var bg = $('.mspplus-form > table td:nth-child(1)').css('background-color');\n                  var text_align = $('.mspplus-form > table td:nth-child(1)').css('text-align');\n                  var item = $(dom).find('.opinion-history-item');\n                  var trlist = '';\n                  var colspan = 4;\n\n                  if ($(dom).parent().is('td')) {\n                    colspan = $(dom).parents('table').find('tbody>tr:first>th').length - 1;\n                  } else {\n                    colspan = $(dom).prev('table').find('tbody>tr:first>th').length - 1;\n                  }\n\n                  var name = $(dom).attr('name') || '';\n                  var mark_name = 'opinionhistory_' + name;\n\n                  if (item.length) {\n                    $.each(item, function (i, h) {\n                      var opinion_name = $(h).find('.opinion-history-name-width').text();\n                      var opinion_value = $(h).find('.opinion-history-value').html();\n                      trlist += '<tr name=\"' + mark_name + '\">' + '<td style=\"text-align: ' + text_align + '\">' + opinion_name + '</td>' + '<td colspan=\"' + colspan + '\">' + opinion_value + '</td>' + '</tr>';\n                      var i_height = $(h).height() + 'px';\n                      var i_name_height = $(h).height() - 1 + 'px';\n\n                      if (isIn) {\n                        $(h).css('cssText', 'border-bottom:' + border + ';height:' + i_height + ';');\n                      } else {\n                        $(h).css('cssText', 'border:' + border + ';border-top:none;height:' + i_height + ';');\n                      }\n\n                      $(h).find('.opinion-history-name-width').css('cssText', 'width:' + d_wodth + 'px;background-color:' + bg + '!important;height:' + i_name_height + ';');\n                      $(h).find('.opinion-history-value').css('cssText', 'width:' + v_width + ' !important;border-left:' + border + ';background-color:' + bg_even + '!important;');\n                    });\n                  }\n\n                  $(dom).hide();\n\n                  if ($(dom).parent().is('td')) {\n                    if (!$(dom).parents('table').find('tbody>tr[name=\"' + mark_name + '\"]').length) {\n                      $(dom).parents('tr').hide();\n                      $(dom).parents('tr').after(trlist);\n                    }\n                  } else {\n                    if (!$(dom).prev('table').find('tbody>tr[name=\"' + mark_name + '\"]').length) {\n                      $(dom).prev('table').children('tbody').append(trlist);\n                    }\n                  }\n                }\n              }\n            };\n\n            if (config.properties.skin == \"flow\") {\n              var loadHistoryHtml = function loadHistoryHtml(i, orgText, item, list) {\n                var activityinstid = item.ACTIVITYINSTID;\n                var itemList = [];\n                itemList.push(item);\n                var itemIndex = 1;\n                $.each(list, function (h, hq) {\n                  if (hq.ACTIVITYINSTID === activityinstid) {\n                    if (itemIndex > 1) {\n                      itemList.push(hq);\n                    }\n\n                    itemIndex++;\n                  }\n                });\n\n                function uploadLog(item) {\n                  var uploadFileLog = \"\";\n\n                  for (var j = 0; j < item.uploadFileLog.length; j++) {\n                    //                                        uploadFileLog += '<p style=\"display:block;\"><font color=\"#CC0000\">' + item.uploadFileLog[i].FILE_NAME + '</font><span>(' + item.uploadFileLog[i].EMPNAME + item.uploadFileLog[i].MODIFYTYPE + ')</span></p>';\n                    uploadFileLog += '<p style=\"display:inline;\"><a class=\"wf-fileView\" target=\"_blank\" href=\"' + '/default/downloadfile/' + item.uploadFileLog[j].MODIFYFILE + '\">' + item.uploadFileLog[j].FILE_NAME + '</a><span>(' + item.uploadFileLog[j].EMPNAME + item.uploadFileLog[j].MODIFYTYPE + ')</span></p>';\n                  }\n\n                  if (\"\" != uploadFileLog) {\n                    uploadFileLog = '<div class=\"flow-content-text\" style=\"border-top:1px solid #dddede;\">历史操作：' + uploadFileLog + '</div>';\n                  }\n\n                  return uploadFileLog;\n                }\n\n                var deresult = showLineName == 'true' ? item.DEALRESULT ? item.DEALOPINION ? item.DEALRESULT + '——' : item.DEALRESULT : '' : '';\n\n                if (\"1\" == config.properties.showType) {\n                  tr += '<div class=\"flow-item\">' + '<div class=\"flow-header clearfix\">' + '<i class=\"fa fa-dot-circle-o\"></i>' + '<div class=\"flow-content-title\">' + orgText + '<a class=\"flow-arrow\"><i class=\"fa fa-angle-down\" style=\"line-height: 40px;\"></i></a></div>' + '</div>';\n\n                  for (var h = 0; h < itemList.length; h++) {\n                    deresult = showLineName == 'true' ? itemList[h].DEALRESULT ? itemList[h].DEALOPINION ? itemList[h].DEALRESULT + '——' : itemList[h].DEALRESULT : '' : '';\n\n                    if (itemList[h].END_TIME && itemList[h].END_TIME.length > 8) {\n                      itemList[h].END_TIME = itemList[h].END_TIME.substring(5, itemList[h].END_TIME.length - 3);\n                    }\n\n                    tr += '<div class=\"flow-body\">' + '<div class=\"flow-content\">' + '<div class=\"flow-content-text\">处理意见：' + (deresult + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : showdefault(i, itemList[h]))) + '<span class=\"opinion-history-fr\">' + (itemList[h].ASSISTANTNAME ? itemList[h].ASSISTANTNAME : '') + '&nbsp;' + (itemList[h].END_TIME ? itemList[h].END_TIME : '') + '</span></div>' + '<div class=\"uploadFileLog\">' + uploadLog(itemList[h]) + '</div>' + '</div>' + '</div>';\n                  }\n\n                  tr += '</div>';\n                } else if (\"0\" == config.properties.showType) {\n                  tr += '<div class=\"flow-item\">' + '<div class=\"flow-header clearfix\">' + '<i class=\"fa fa-dot-circle-o\"></i>' + '<div class=\"flow-content-title\">' + orgText + ' <a class=\"flow-arrow\"><i class=\"fa fa-angle-down\" style=\"line-height: 40px;\"></i></a></div>' + '</div>';\n\n                  for (var h = 0; h < itemList.length; h++) {\n                    if (itemList[h].DEALOPINION) {\n                      deresult = showLineName == 'true' ? itemList[h].DEALRESULT ? itemList[h].DEALOPINION ? itemList[h].DEALRESULT + '——' : itemList[h].DEALRESULT : '' : '';\n\n                      if (itemList[h].END_TIME && itemList[h].END_TIME.length > 8) {\n                        itemList[h].END_TIME = itemList[h].END_TIME.substring(5, itemList[h].END_TIME.length - 3);\n                      }\n\n                      tr += '<div class=\"flow-body\">' + '<div class=\"flow-content\">' + '<div class=\"flow-content-text\">处理意见：' + (deresult + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : '')) + '<span class=\"opinion-history-fr\">' + (itemList[h].ASSISTANTNAME ? itemList[h].ASSISTANTNAME : \"\") + '&nbsp;' + (itemList[h].END_TIME ? itemList[h].END_TIME : \"\") + '</span></div>' + '<div class=\"uploadFileLog\">' + uploadLog(itemList[h]) + '</div>' + '</div>' + '</div>';\n                    } else if (\"true\" == config.properties.uploadFileLog && \"\" != uploadLog(itemList[h])) {\n                      tr += '<div class=\"flow-body\">' + '<div class=\"flow-content\">' + '<div class=\"uploadFileLog\">' + uploadLog(itemList[h]) + '</div>' + '</div>' + '</div>';\n                    }\n                  }\n\n                  tr += '</div>';\n                } else if (\"2\" == config.properties.showType) {\n                  tr += '<div class=\"flow-item\">' + '<div class=\"flow-header clearfix\">' + '<i class=\"fa fa-dot-circle-o\"></i>' + '<div class=\"flow-content-title\">' + orgText + ' <a class=\"flow-arrow\"><i class=\"fa fa-angle-down\" style=\"line-height: 40px;\"></i></a></div>' + '</div>';\n\n                  for (var h = 0; h < itemList.length; h++) {\n                    deresult = showLineName == 'true' ? itemList[h].DEALRESULT ? itemList[h].DEALOPINION ? itemList[h].DEALRESULT + '——' : itemList[h].DEALRESULT : '' : '';\n\n                    if (itemList[h].END_TIME.length > 8) {\n                      itemList[h].END_TIME = itemList[h].END_TIME.substring(5, itemList[h].END_TIME.length - 3);\n                    }\n\n                    tr += '<div class=\"flow-body\">' + '<div class=\"flow-content\">' + '<div class=\"flow-content-text\">处理意见：' + (deresult + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : '')) + '<span class=\"opinion-history-fr\">' + (itemList[h].ASSISTANTNAME ? itemList[h].ASSISTANTNAME : '') + '&nbsp;' + (itemList[h].END_TIME ? itemList[h].END_TIME : '') + '</span></div>' + '<div class=\"uploadFileLog\">' + uploadLog(itemList[h]) + '</div>' + '</div>' + '</div>';\n                  }\n\n                  tr += '</div>';\n                } else {\n                  tr += '<div class=\"flow-item\">' + '<div class=\"flow-header clearfix\">' + '<i class=\"fa fa-dot-circle-o\"></i>' + '<div class=\"flow-content-title\">' + orgText + ' <a class=\"flow-arrow\"><i class=\"fa fa-angle-down\" style=\"line-height: 40px;\"></i></a></div>' + '</div>';\n\n                  for (var h = 0; h < itemList.length; h++) {\n                    deresult = showLineName == 'true' ? itemList[h].DEALRESULT ? itemList[h].DEALOPINION ? itemList[h].DEALRESULT + '——' : itemList[h].DEALRESULT : '' : '';\n\n                    if (itemList[h].END_TIME && itemList[h].END_TIME.length > 8) {\n                      itemList[h].END_TIME = itemList[h].END_TIME.substring(5, itemList[h].END_TIME.length - 3);\n                    }\n\n                    tr += '<div class=\"flow-body\">' + '<div class=\"flow-content\">' + '<div class=\"flow-content-text\">处理意见：' + (deresult + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : itemList[h].WORKITEMNAME)) + '<span class=\"opinion-history-fr\">' + (itemList[h].ASSISTANTNAME ? itemList[h].ASSISTANTNAME : '') + '&nbsp;' + (itemList[h].END_TIME ? itemList[h].END_TIME : '') + '</span></div>' + '<div class=\"uploadFileLog\">' + uploadLog(itemList[h]) + '</div>' + '</div>' + '</div>';\n                  }\n\n                  tr += '</div>';\n                }\n              };\n\n              //流水外观\n              var tr = '';\n              var activityIdList = [];\n              $.each(list, function (i, item) {\n                var orgText;\n\n                if (showOrg == true) {\n                  if (item.mainOrgName) {\n                    orgText = item.mainOrgName + \"&nbsp;\" + item.WORKITEMNAME;\n                  } else if (item.orgName) {\n                    orgText = item.orgName + \"&nbsp;\" + item.WORKITEMNAME;\n                  } else {\n                    orgText = item.WORKITEMNAME;\n                  }\n                } else {\n                  orgText = item.WORKITEMNAME;\n                }\n\n                if (item.ASSISTANTNAME === null) {\n                  item.ASSISTANTNAME = \"\";\n                }\n\n                if (item.WORKITEMTYPE == \"M\" && item.ASSISTANTNAME) {\n                  var index = $.inArray(item.ACTIVITYINSTID, activityIdList);\n\n                  if (index == -1) {\n                    activityIdList.push(item.ACTIVITYINSTID);\n                    loadHistoryHtml(i, orgText, item, list);\n                  }\n                }\n              });\n              var domhtml = '<div class=\"box-body no-padding\">' + '<div class=\"layout-2-flowhistory\" >' + '<div class=\"flow-list\">' + tr + '</div></div></div>';\n              isexpand(domhtml);\n            } else {\n              //默认外观\n              var tr = '';\n              var activityIdList = []; // var hasHis = false;\n\n              $.each(list, function (i, item) {\n                if (item.WORKITEMTYPE == \"M\" && item.ASSISTANTNAME) {\n                  var getUploadLog = function getUploadLog(item) {\n                    var uploadFileLog = \"\";\n\n                    for (var j = 0; j < item.uploadFileLog.length; j++) {\n                      uploadFileLog += '<p style=\"display:inline;\"><a class=\"wf-fileView\" target=\"_blank\" href=\"' + '/default/downloadfile/' + item.uploadFileLog[j].MODIFYFILE + '\">' + item.uploadFileLog[j].FILE_NAME + '</a><span>(' + item.uploadFileLog[j].EMPNAME + item.uploadFileLog[j].MODIFYTYPE + ')</span></p>';\n                    }\n\n                    if (\"\" != uploadFileLog) {\n                      uploadFileLog = '<div class=\"flow-content-text\" style=\"border-top:1px solid #dddede;\">历史操作：' + uploadFileLog + '</div>';\n                    }\n\n                    return uploadFileLog;\n                  };\n\n                  if (!item.END_TIME) {\n                    return true;\n                  }\n\n                  if (\"0\" == config.properties.showType) {\n                    if (!item.DEALOPINION) {\n                      return true;\n                    }\n                  }\n\n                  if (item.ASSISTANTNAME === null) {\n                    item.ASSISTANTNAME = \"\";\n                  }\n\n                  var index = $.inArray(item.ACTIVITYINSTID, activityIdList);\n\n                  if (index > -1) {\n                    return true;\n                  }\n\n                  activityIdList.push(item.ACTIVITYINSTID);\n                  var activityinstid = item.ACTIVITYINSTID;\n                  var itemList = [];\n                  itemList.push(item);\n                  var itemIndex = 1;\n                  $.each(list, function (h, hq) {\n                    if (hq.ACTIVITYINSTID === activityinstid) {\n                      if (itemIndex > 1) {\n                        if (\"0\" == config.properties.showType) {\n                          if (hq.DEALOPINION && hq.END_TIME) {\n                            itemList.push(hq);\n                          }\n                        } else {\n                          if (hq.END_TIME) {\n                            itemList.push(hq);\n                          }\n                        }\n                      }\n\n                      itemIndex++;\n                    }\n                  });\n\n                  if (\"1\" == config.properties.showType) {\n                    tr += '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\" style=\"overflow: paged-x;\">' + '<div class=\"form-item opinion-history-item\">' + '<div class=\"item-name opinion-history-name-width\">' + item.WORKITEMNAME + '：</div>' + '<div class=\"item-value  opinion-history-value\">';\n\n                    for (var h = 0; h < itemList.length; h++) {\n                      var orgText = \"\";\n\n                      if (showOrg == true) {\n                        if (itemList[h].mainOrgName) {\n                          orgText = itemList[h].mainOrgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else if (itemList[h].orgName) {\n                          orgText = itemList[h].orgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else {\n                          orgText = itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        }\n                      } else {\n                        orgText = itemList[h].ASSISTANTNAME;\n                      }\n\n                      if (itemList[h].END_TIME && itemList[h].END_TIME.length > 3) {\n                        itemList[h].END_TIME = itemList[h].END_TIME.substring(0, itemList[h].END_TIME.length - 3);\n                      }\n\n                      tr += '<div class=\"item-opinion \">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div>' + (SUI.Util.htmlEncode(itemList[h].DEALOPINION) || showdefault(i, itemList[h])) + '</div>' + '<div class=\"uploadFileLog\">' + getUploadLog(itemList[h]) + '</div>' + '<div style=\"text-align:right;\">——' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                    }\n\n                    tr += '</div>' + '</div>' + '</div>' + '</div>';\n                  } else if (\"2\" == config.properties.showType) {\n                    tr += '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\" style=\"overflow: paged-x;\">' + '<div class=\"form-item opinion-history-item\">' + '<div class=\"item-name opinion-history-name-width\">' + item.WORKITEMNAME + '：</div>' + '<div class=\"item-value  opinion-history-value\">';\n\n                    for (var h = 0; h < itemList.length; h++) {\n                      var orgText = \"\";\n\n                      if (showOrg == true) {\n                        if (itemList[h].mainOrgName) {\n                          orgText = itemList[h].mainOrgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else if (itemList[h].orgName) {\n                          orgText = itemList[h].orgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else {\n                          orgText = itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        }\n                      } else {\n                        orgText = itemList[h].ASSISTANTNAME;\n                      }\n\n                      if (itemList[h].END_TIME && itemList[h].END_TIME.length > 3) {\n                        itemList[h].END_TIME = itemList[h].END_TIME.substring(0, itemList[h].END_TIME.length - 3);\n                      }\n\n                      tr += '<div class=\"item-opinion  \">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div>' + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : \"\") + '</div>' + '<div class=\"uploadFileLog\">' + getUploadLog(itemList[h]) + '</div>' + '<div style=\"text-align:right;\">——' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                    }\n\n                    tr += '</div>' + '</div>' + '</div>' + '</div>';\n                  } else if (\"0\" == config.properties.showType) {\n                    tr += '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\" style=\"overflow: paged-x;\">' + '<div class=\"form-item opinion-history-item\">' + '<div class=\"item-name opinion-history-name-width\">' + item.WORKITEMNAME + '：</div>' + '<div class=\"item-value  opinion-history-value\">';\n\n                    for (var h = 0; h < itemList.length; h++) {\n                      var orgText = \"\";\n\n                      if (showOrg == true) {\n                        if (itemList[h].mainOrgName) {\n                          orgText = itemList[h].mainOrgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else if (itemList[h].orgName) {\n                          orgText = itemList[h].orgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else {\n                          orgText = itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        }\n                      } else {\n                        orgText = itemList[h].ASSISTANTNAME;\n                      }\n\n                      if (itemList[h].END_TIME && itemList[h].END_TIME.length > 3) {\n                        itemList[h].END_TIME = itemList[h].END_TIME.substring(0, itemList[h].END_TIME.length - 3);\n                      }\n\n                      if (itemList[h].DEALOPINION) {\n                        tr += '<div class=\"item-opinion  \">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div>' + (itemList[h].DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : \"\") + '</div>' + '<div class=\"uploadFileLog\">' + getUploadLog(itemList[h]) + '</div>' + '<div style=\"text-align:right;\">——' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                      } else if (\"true\" == config.properties.uploadFileLog && \"\" != getUploadLog(itemList[h])) {\n                        tr += '<div class=\"item-opinion  \">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div class=\"uploadFileLog\">' + getUploadLog(itemList[h]) + '</div>' + '<div style=\"text-align:right;\">——' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                      }\n                    }\n\n                    tr += '</div>' + '</div>' + '</div>' + '</div>';\n                  } else {\n                    tr += '<div class=\"form-tr clearfix\">' + '<div class=\"form-td col-xs-12\" style=\"overflow: paged-x;\">' + '<div class=\"form-item opinion-history-item\">' + '<div class=\"item-name opinion-history-name-width\">' + item.WORKITEMNAME + '：</div>' + '<div class=\"item-value  opinion-history-value\">';\n\n                    for (var h = 0; h < itemList.length; h++) {\n                      var orgText = \"\";\n\n                      if (showOrg == true) {\n                        if (itemList[h].mainOrgName) {\n                          orgText = itemList[h].mainOrgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else if (itemList[h].orgName) {\n                          orgText = itemList[h].orgName + \"&nbsp;\" + itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        } else {\n                          orgText = itemList[h].WORKITEMNAME + \"&nbsp;\" + itemList[h].ASSISTANTNAME;\n                        }\n                      } else {\n                        orgText = itemList[h].ASSISTANTNAME;\n                      }\n\n                      if (itemList[h].END_TIME.length > 3) {\n                        itemList[h].END_TIME = itemList[h].END_TIME.substring(0, itemList[h].END_TIME.length - 3);\n                      }\n\n                      tr += '<div class=\"item-opinion \">' + '<div>' + (showLineName == 'true' ? itemList[h].DEALRESULT || '' : '') + '</div>' + '<div>' + (item.DEALOPINION ? SUI.Util.htmlEncode(itemList[h].DEALOPINION) : itemList[h].WORKITEMNAME) + '</div>' + '<div class=\"uploadFileLog\">' + getUploadLog(itemList[h]) + '</div>' + '<div style=\"text-align:right;\">——' + (orgText ? orgText : itemList[h].ASSISTANTNAME) + ' ' + itemList[h].END_TIME + '</div>' + '</div>';\n                    }\n\n                    tr += '</div>' + '</div>' + '</div>' + '</div>';\n                  }\n                }\n              });\n              isexpand(tr);\n            }\n\n            if (config.wfConfig && config.wfConfig.mode !== 'print') {\n              if (($(dom).prev().length && $(dom).prev()[0].nodeName === 'TABLE' || $(dom).parent()[0].nodeName === 'TD') && config.properties.skin === 'default') {\n                config.properties.showHeader = 'false';\n                config.properties.alwaysExpand = 'true';\n              }\n\n              if (config.properties.showHeader === 'true') {\n                var cyHtml = '<div class=\"box\">' + '<div class=\"box-header\">' + '<h4>流转历史</h4>' + '</div>' + '</div>';\n                $(dom).prepend(cyHtml);\n              }\n            }\n          }\n        } else {\n          if (config.wrapper) {\n            $(config.wrapper).remove();\n          } else {\n            $(dom).remove();\n          }\n        }\n\n        wf2.addHeaderTab(); // if (config.wfConfig.mode == 'print') {\n        //     $(dom).hide();\n        //     return;\n        // }\n      },\n      error: function error(msg) {}\n    });\n  };\n\n  this.getValue = function () {\n    return value;\n  };\n\n  this.setValue = function (val) {\n    value = val;\n  };\n\n  this.validate = function () {\n    return true;\n  };\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\"),\n        processInstId: $(el).attr(\"processInstId\"),\n        sort: $(el).attr(\"sort\"),\n        expand: $(el).attr(\"expand\"),\n        skin: $(el).attr(\"skin\") || 'default',\n        showType: $(el).attr(\"showType\"),\n        uploadFileLog: $(el).attr(\"uploadFileLog\"),\n        alwaysExpand: $(el).attr(\"alwaysExpand\") || 'true',\n        height: $(el).attr(\"height\") || 'none',\n        mspPreview: $(el).attr(\"msppreview\"),\n        showOrg: $(el).attr(\"showOrg\"),\n        showLineName: $(el).attr('showLineName') || 'false',\n        isPrint: $(el).attr('isPrint') || 'false',\n        showHeader: $(el).attr('showHeader') || 'true'\n      },\n      value: $(el).attr(\"value\") || \"\"\n    };\n    return _data;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionHistory/OpinionHistory.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionOne/OpinionOne.js":
/*!******************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionOne/OpinionOne.js ***!
  \******************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return OpinionOne; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 9:33 AM\n */\n\n/**\n * 统一意见\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction OpinionOne(bind) {\n  var value, config;\n  var dom = bind || $(\'<div></div>\').get(0);\n  dom.zoo = this;\n  var opinion;\n  var label, decision, extAttrs;\n  var reqCommonOpinion = null;\n  var opinionChange = false;\n  var defaultOpinion = \'\';\n\n  this.getValue = function (js) {\n    var _value = value || \'{}\';\n\n    if (config.mode == \'hide\') {\n      return _value;\n    }\n\n    if (config.properties.mspPreview == "true") {\n      var temp = {};\n    } else {\n      var temp = getMyOpinion();\n\n      if (config.properties.multi === \'true\' || config.properties.multi == true) {\n        temp = {};\n        temp[getMyKey()] = getMyOpinion();\n      }\n    }\n\n    return js ? temp : SUI.Util.toJsonString(temp);\n  };\n\n  this.setDecision = function (_decision) {\n    decision = _decision;\n  };\n\n  this.setExtAttribute = function (key, value) {\n    extAttrs = extAttrs || {};\n    extAttrs[key] = value;\n  };\n\n  this.setOpinion = function (op, iscyyj) {\n    if (!opinionChange) {\n      if (config.maxlength && typeof config.maxlength === \'number\') {\n        op = (op + \'\').substring(0, config.maxlength);\n      }\n\n      opinion.val(op || \'\');\n      defaultOpinion = op || \'\';\n    } else {\n      if (iscyyj && iscyyj == \'cyyj\') {\n        var val = opinion.val();\n\n        if (config.maxlength && typeof config.maxlength === \'number\') {\n          val = (val + op + \'\').substring(0, config.maxlength);\n        }\n\n        opinion.val(val || \'\');\n      }\n    }\n\n    opinion.on(\'change\', function () {\n      var changeValue = $(this).val();\n\n      if (changeValue != defaultOpinion) {\n        opinionChange = true;\n      }\n    });\n  };\n\n  function getMyOpinion() {\n    var temp = {};\n    var user = SUI.Util.getUser();\n    temp.userId = user.userId;\n    temp.userName = user.userName;\n    temp.userOrgId = user.userOrgId;\n    temp.userOrgName = user.userOrgName;\n    temp.opinion = opinion.val();\n    temp.date = new Date() - 0;\n    temp.extAttrs = extAttrs;\n    temp.decision = decision;\n    temp.signature = wf2.workflow && wf2.workflow.signature && (wf2.workflow.signature.signatureId ? wf2.workflow.signature.signatureId : \'\');\n    var steps;\n\n    if ($(".sui-participates").length > 0) {\n      steps = $(".sui-participates").sui().getValue();\n    }\n\n    if ($(".sui-moreparticipates").sui()) {\n      steps = $(".sui-moreparticipates").sui().getValue();\n    }\n\n    if ($(".sui-newparticipants").length > 0) {\n      steps = $(".sui-newparticipants").sui() ? $(".sui-newparticipants").sui().getValue() : \'\';\n    }\n\n    if (steps && steps.length == 1) {\n      temp.activityId = steps[0].to;\n    } else {\n      temp.activityId = "";\n    }\n\n    return temp;\n  }\n\n  this.getExt = function () {\n    return {\n      type: "opinion",\n      value: {\n        key: getMyKey(),\n        value: getMyOpinion()\n      }\n    };\n  };\n\n  this.setValue = function (val) {\n    if (config.forbidSetValue == "true") {\n      return;\n    }\n\n    value = val;\n\n    if (!value) {\n      return;\n    }\n\n    value = SUI.Util.parseJSON(value, true);\n    var _value = value;\n\n    if (config.properties.multi == \'true\' || config.properties.multi == true) {\n      _value = value[getMyKey()];\n    }\n\n    if (!_value) {\n      return;\n    }\n\n    var emptyOpinion = $(dom).attr(\'emptyopinion\') || \'true\';\n\n    if (emptyOpinion == \'true\') {\n      opinion.val(_value.opinion).trigger(\'change\');\n    }\n\n    $(dom).trigger(\'change\'); //移至workflow2\n    // if (_value.activityId && config.mode == "editable" && $(".sui-participates").length > 0) {\n    //     var partiConfig = $(".sui-participates").sui().getConfig();\n    //     var attachone = $(".sui-participates").attr("opiniononeattach");\n    //     if (partiConfig.properties.attach || "true" == attachone) { //嵌套风格\n    //         // $(".sui-participates").find("input[type=radio][value=" + _value.activityId + "]").iCheck("check");\n    //     } else {\n    //         $(".sui-participates").find("select").val(_value.activityId); //.trigger("change");\n    //     }\n    // } else if (_value.activityId && config.mode == "editable" && $(".sui-moreparticipates").length > 0) {\n    //     var partiConfig = $(".sui-moreparticipates").sui().getConfig();\n    //     var attachone = $(".sui-moreparticipates").attr("opiniononeattach");\n    //     if (partiConfig.properties.attach || "true" == attachone) { //嵌套风格\n    //         // $(".sui-moreparticipates").find("input[type=radio][value=" + _value.activityId + "]").iCheck("check");\n    //     } else {\n    //         $(".sui-moreparticipates").find("select").val(_value.activityId); //.trigger("change");\n    //     }\n    // }\n  };\n\n  function getMyKey() {\n    var myKey = config.properties.mykey;\n\n    if (myKey == "_user") {\n      myKey = "u_" + SUI.Util.getUser().userId;\n    } else if (myKey == "_org") {\n      myKey = "o_" + SUI.Util.getUser().userOrgId;\n    } else if (myKey == "_submit") {\n      myKey = "wi_" + config.properties.workItemId;\n    }\n\n    return myKey;\n  }\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    var preTemplate = $(dom);\n    opinion = preTemplate.find("textarea");\n\n    var require = config.validate && config.validate.require ? "*" : "";\n\n    var html = \'\';\n    var maxlength = config.maxlength ? \' maxlength="\' + config.maxlength + \'"\' : "";\n    html += \'<textarea class="form-control" rows="3"\' + maxlength + \'></textarea>\';\n    $(dom).html(html);\n\n    if (SUI.Util.browserType() === \'phone\' && wf2.isNewInPhone) {\n      $(dom).addClass(\'opinion-phone\');\n    }\n\n    var template = $(dom);\n    opinion = template.find("textarea");\n    label = template.find("div");\n    label.iCheck(SUI.settings().iCheck({\n      iCheckStyle: config.properties.checkStyle,\n      iCheckColor: config.properties.checkColor\n    }));\n    var mode = config.mode || \'view\';\n\n    if (mode == "readOnly" || mode == "view") {\n      opinion.attr("readOnly", "readOnly");\n      opinion.css(\'border\', \'none\');\n    }\n\n    if (config.properties.required && config.properties.required == \'true\') {\n      config.validate = {\n        require: true\n      };\n    }\n\n    if (mode == "editable") {\n      opinion.removeAttr("readOnly");\n      opinion.attr("placeholder", "请在此输入意见...");\n      var strategycode = config.strategycode;\n      var opinionSettings = config.opinionSettings ? JSON.parse(config.opinionSettings) : config.opinionSettings;\n\n      if (opinionSettings) {\n        if (opinionSettings.personOpinion != \'true\' && opinionSettings.systemOpinion == \'true\') {\n          SUI.Util.systemOpinion(dom, opinionSettings.strategycode);\n        } else if (opinionSettings.personOpinion == \'true\' && opinionSettings.systemOpinion != \'true\') {\n          SUI.Util.personOpinion(dom, \'\', opinionSettings.strategycode);\n        } else if (opinionSettings.systemOpinion == \'true\' && opinionSettings.personOpinion == \'true\') {\n          $.ajax({\n            url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.queryCommenOpnionnew.biz.ext",\n            type: "post",\n            dataType: "json",\n            data: {\n              strategycode: opinionSettings.strategycode\n            },\n            success: function success(data) {\n              var list = data.results;\n              SUI.Util.personOpinion(dom, list, opinionSettings.strategycode);\n            }\n          });\n        }\n      } else {\n        if ("" != strategycode && null != strategycode && !config.count) {\n          if (reqCommonOpinion) {\n            reqCommonOpinion.abort();\n          }\n\n          config.count = 1;\n\n          if ("1" == config.showType) {\n            //双击弹窗方案\n            opinion.attr("title", "双击鼠标可进入快速意见界面");\n\n            if (config.properties.suiPreview) {\n              if (config.properties.suiPreview == \'true\') {\n                return false;\n              }\n            }\n\n            dom.ondblclick = function () {\n              var preOpinion = opinion.val(); //打开快速意见页\n\n              var index = layer.open({\n                type: 2,\n                title: "快速意见",\n                area: ["950px", "580px"],\n                content: __basePath + \'/strategyOpinion/strategyOpinion.jsp?strategycode=\' + strategycode + \'&preOpinion=\' + preOpinion,\n                btn: [\'确定\', \'保存为常用意见\', \'取消\'],\n                yes: function yes() {\n                  var opinion = $($("#layui-layer-iframe" + index)[0].contentWindow.document.getElementById("option_content")).val();\n                  $(dom).sui().setOpinion(opinion, \'cyyj\');\n                  layer.close(index);\n                },\n                btn2: function btn2() {\n                  var opinion = $($("#layui-layer-iframe" + index)[0].contentWindow.document.getElementById("option_content")).val();\n\n                  if ("" == opinion || null == opinion) {\n                    alert("请输入要保存的常用意见");\n                    return false;\n                  }\n\n                  $.ajax({\n                    url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.savePersonalOpinion.biz.ext",\n                    type: "post",\n                    dataType: "json",\n                    data: {\n                      value: opinion\n                    },\n                    success: function success(data) {\n                      if (!data.exception) {\n                        //改为保存后局部刷新\n                        alert("保存为常用意见成功");\n                      } else {\n                        alert("保存为常用意见失败");\n                      }\n                    }\n                  });\n                  return false;\n                },\n                btn3: function btn3() {}\n              });\n            };\n          } else if ("2" == config.showType) {\n            if (config.properties.suiPreview) {\n              if (config.properties.suiPreview == \'true\') {\n                return false;\n              }\n            }\n\n            SUI.Util.personOpinion(dom, \'\', strategycode);\n          } else {\n            if (config.properties.suiPreview) {\n              if (config.properties.suiPreview == \'true\') {\n                return false;\n              }\n            }\n\n            SUI.Util.systemOpinion(dom, strategycode, \'old\');\n          }\n        }\n      } // var defaultVal = $(dom).sui().getValue();\n      // if (typeof (defaultVal) == "string" &&  defaultVal == \'\') {\n      //     $(dom).sui().setValue(defaultVal);\n      // }\n\n    }\n\n    if (mode == "hide") {\n      $(dom).hide();\n    }\n\n    if (config.wfConfig && config.wfConfig.mode == \'print\') {// $(dom).hide();\n      //return;\n    }\n\n    this.name = config.properties.name;\n    this.title = config.properties.title;\n    opinion.click(function () {\n      $(dom).trigger(\'change\');\n    });\n  };\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || \'view\';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != "editable") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = opinion.val();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr("mode");\n    temp.showType = element.attr("showType");\n    temp.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      suiPreview: element.attr(\'suiPreview\'),\n      mspPreview: element.attr(\'mspPreview\')\n    };\n    temp.maxlength = Number($(element).attr("maxlength") || "0");\n    temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    temp.forbidSetValue = element.attr("forbidSetValue");\n    var properties = element.attr("properties");\n\n    if (properties) {\n      /*\n          {\n              name:"bmld", //表示实体字段名称\n              multi:true, //表示是否是会签意见\n              myKey:"_user", //表示会签的key\n              title:"审批意见" //标题\n          }\n      */\n      temp.properties = SUI.Util.parseJSON(properties, true);\n    }\n\n    temp.closeDefaultOpinion = element.attr("closeDefaultOpinion");\n    temp.emptyOpinion = element.attr(\'emptyopinion\') || \'true\';\n    return temp;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionOne/OpinionOne.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OrgSelect/OrgSelect.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OrgSelect/OrgSelect.js ***!
  \****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return OrgSelect; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:15 PM\n */\n\n/**\n * 机构选择器-多选\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction OrgSelect(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode') || 'editable',\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      properties: {\n        name: $(el).attr('name'),\n        mspPreview: $(el).attr('msppreview'),\n        selectMulti: $(el).attr('selectMulti') || 'true',\n        orgSelected: $(el).attr('orgSelected') || '[]',\n        headerTitle: $(el).attr('headerTitle') || '请选择部门'\n      }\n    };\n    return conf;\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    var mode = config.mode;\n    var mspPreview = config.properties.mspPreview;\n    var orgSelected = config.properties.orgSelected;\n    var viewHtml = '<div class=\"input-group \">\\\n                                <input  type=\"text\" class=\"form-control\" orgSelected=\"' + orgSelected + '\" placeholder=\"请选择机构\" readonly=\"readonly\">\\\n                                <span class=\"input-group-addon orgbtn\" >选择</span>\\\n                            </div>';\n    var viewHtml_phone = '<div class=\"input-group input-group-phone\">' + '<input type=\"text\" class=\"org-info input_phone input-hide\"  orgSelected=\"' + orgSelected + '\" readonly>' + '<div class=\"show-org-phone\"></div>' + '<span class=\"org-tips\">请选择</span>' + '<span class=\"org-arrow\"></span>' + '</div>';\n    var viewReadonlyHtml = '<div class=\"value-text\">\\\n                                <span class=\"displayinfo\"></span>\\\n                            </div>';\n    $(dom).removeClass('form-readOnly');\n\n    if (mode == 'editable') {\n      if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n        $(dom).html(viewHtml_phone);\n        $(dom).find('.show-org-phone').hide();\n      } else {\n        $(dom).html(viewHtml);\n      }\n\n      if (mspPreview == 'true') {\n        $(dom).html(viewHtml);\n      }\n    } else if (mode == 'readOnly' || mode == 'view') {\n      $(dom).addClass('form-readOnly');\n      $(dom).html(viewReadonlyHtml);\n    } else if (mode == 'hide') {\n      $(dom).hide();\n    }\n\n    var btn = $(dom).find('.input-group');\n    btn.unbind('click').on('click', function (e) {\n      e.stopPropagation();\n      var selectMulti = $(dom).attr('selectMulti') || \"true\";\n      var orgSelected = $.parseJSON($(dom).find('input').attr('orgSelected').replace(/\\'/g, '\"')) || []; //$.parseJSON($(dom).attr('orgSelected').replace(/\\'/g, '\"')) || [];\n\n      var title = $(dom).attr('headerTitle') || '请选择部门';\n      var input = $(dom).find('input');\n      var orgSelected2 = \"\";\n\n      if (orgSelected.length) {\n        $.each(orgSelected, function (_, v) {\n          orgSelected2 += \";\" + v.orgid + '-' + v.orgname + '-' + v.orgcode + '-' + v.sortno;\n        });\n        orgSelected2 = orgSelected2.substring(1);\n      }\n\n      if (SUI.Util.browserType() === 'phone') {\n        var offsetTop = $(window).scrollTop(); // var url = __basePath + \"_libs/plugins/mechanism/orgSelect/orgSelect_app.jsp?selectMulti=\" + selectMulti + \"&orgSelected=\" + orgSelected2 + \"&offsetTop=\" + offsetTop ;\n\n        var url = __basePath + \"_libs/plugins/mechanism/orgSelect/list.html?selectMulti=\" + selectMulti + \"&offsetTop=\" + offsetTop;\n\n        try {\n          iPortal.openWindow(url, function (data) {\n            dom.zoo.showOrgForPhone(data);\n          }, {\n            'title': title\n          });\n        } catch (err) {\n          console.log(err);\n        }\n      } else {\n        var url = __basePath + \"_libs/plugins/mechanism/orgSelect/orgSelect_pc.jsp?selectMulti=\" + selectMulti + \"&orgSelected=\" + orgSelected2;\n        var area = [\"740px\", \"468px\"];\n        var index = layer.open({\n          type: 2,\n          title: title,\n          area: area,\n          content: url,\n          btn: ['确定', '取消'],\n          yes: function yes() {\n            var selected = $($(\"#layui-layer-iframe\" + index)[0].contentWindow.document.getElementById(\"selectedTree\")).children();\n            var orgSelected = [];\n            var orgNameList = '';\n            $(selected).each(function (index, element) {\n              var opt = {};\n              opt.orgid = $(element).attr(\"orgid\");\n              opt.orgname = $(element).attr(\"orgname\");\n              opt.orgcode = $(element).attr(\"orgcode\");\n              opt.sortno = $(element).attr(\"sortno\");\n              orgNameList += $(element).attr(\"orgname\") + ',';\n              orgSelected.push(opt);\n            });\n\n            if (orgNameList.length > 0) {\n              orgNameList = orgNameList.substring(0, orgNameList.length - 1);\n            }\n\n            $(input).attr('value', orgNameList);\n            $(input).attr('title', orgNameList);\n            $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n            $(dom).trigger(\"change\", [orgSelected]);\n            layer.close(index);\n          },\n          btn2: function btn2() {}\n        });\n      }\n    });\n  };\n\n  this.selectedData = {};\n\n  this.showOrgForPhone = function (data, fromType) {\n    fromType = fromType || false;\n    var selectMulti = $(dom).attr('selectMulti') || \"true\";\n    var input = $(dom).find('input');\n    var title = $(dom).attr('headerTitle') || '请选择部门';\n    var orgSelected = JSON.parse(data.replace(/\\'/g, '\"')).list;\n\n    if (fromType) {\n      dom.zoo.selectedData = $.merge([], orgSelected);\n    } else {\n      if ($.isEmptyObject(dom.zoo.selectedData)) {\n        dom.zoo.selectedData = $.merge([], orgSelected);\n      } else {\n        orgSelected = $.unique($.merge(dom.zoo.selectedData, orgSelected));\n        dom.zoo.selectedData = $.merge([], orgSelected);\n      }\n    }\n\n    var offsetTop = $(window).scrollTop();\n\n    if (orgSelected.length) {\n      $('.org-tips', dom).hide();\n      $('.input_phone', dom).show();\n    } else {\n      $('.org-tips', dom).show();\n      $('.input_phone', dom).hide();\n    }\n\n    var orgNameList = \"\";\n    $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n    $.each(orgSelected, function (index, value) {\n      orgNameList += value.orgname + ',';\n    });\n\n    if (orgNameList.length > 0) {\n      orgNameList = orgNameList.substring(0, orgNameList.length - 1);\n    }\n\n    $(dom).find('.show-org-phone').hide();\n    var showList_phone = orgNameList.split(',');\n\n    if (showList_phone.length > 0) {\n      var showHtml = '<span class=\"allorg-name-phone\">' + orgNameList + '</span>';\n      showHtml += '<span class=\"show-allorg-phone\">全部</span>';\n      $(dom).find('.show-org-phone').html(showHtml);\n      $(dom).find('.input_phone').hide();\n      $(dom).find('.show-org-phone').show().css('display', 'inline-block');\n      var allInfoClick = $(dom).find('.show-allorg-phone');\n      allInfoClick.unbind('click').on('click', function (e) {\n        e.stopPropagation();\n\n        try {\n          var orgSelected = $.parseJSON($(dom).find('input').attr('orgSelected').replace(/\\'/g, '\"')) || [];\n          var orgSelected2 = \"\";\n\n          if (orgSelected.length) {\n            $.each(orgSelected, function (_, v) {\n              orgSelected2 += \";\" + v.orgid + '-' + v.orgname + '-' + v.orgcode + '-' + v.sortno;\n            });\n            orgSelected2 = orgSelected2.substring(1);\n          }\n\n          var detailUrl = __basePath + \"_libs/plugins/mechanism/orgSelect/orgSelect_app.jsp?selectMulti=\" + selectMulti + \"&orgSelected=\" + orgSelected2 + \"&offsetTop=\" + offsetTop;\n          iPortal.openWindow(detailUrl, function (data) {\n            dom.zoo.showOrgForPhone(data, true);\n          }, {\n            'title': title\n          });\n        } catch (err) {\n          console.log(err);\n        }\n      });\n    }\n\n    $(input).val(orgNameList);\n    $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n    $(dom).trigger(\"change\", [orgSelected]);\n  };\n\n  this.getValue = function () {\n    var mode = config.mode;\n    var val = \"\";\n\n    if (mode == 'editable') {\n      val = $(dom).find('input').attr('orgselected');\n    } else {\n      val = $(dom).find('span').attr('orgselected');\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val) {\n    var orgSelected = val;\n    var mode = config.mode || 'view';\n    this.name = config.properties.name;\n\n    if (typeof orgSelected == 'string') {\n      orgSelected = JSON.parse(orgSelected);\n    }\n\n    var orgNameList = \"\";\n\n    if (orgSelected.length) {\n      $.each(orgSelected, function (_, v) {\n        orgNameList += v.orgname + ',';\n      });\n\n      if (orgNameList.length > 0) {\n        orgNameList = orgNameList.substring(0, orgNameList.length - 1);\n      }\n    }\n\n    ;\n\n    if (mode == 'editable') {\n      var input = $(dom).find('input');\n      $(input).attr('value', orgNameList);\n      $(input).attr('title', orgNameList);\n      $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n    } else {\n      var span = $(dom).find('span');\n      $(span).text(orgNameList);\n      $(span).attr('orgSelected', JSON.stringify(orgSelected));\n    }\n\n    $('.org-tips', dom).hide();\n    $('.input_phone', dom).show();\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = $(dom).find('input').val();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OrgSelect/OrgSelect.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Participates/Participates.js":
/*!**********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Participates/Participates.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Participates; });\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:31 PM\n */\n\n/**\n * 旧版参与者----不建议使用\n * 所有新建流程建议使用新参与者\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nvar trueValue = \'\';\nfunction Participates(bind) {\n  var value, config, callback;\n  var nodeBeforeChange; //change事件触发之前的value值，即旧值\n\n  var dom = bind || $(\'<div></div>\').get(0);\n  dom.zoo = this;\n  var sendTo, parties, first;\n  var rendCount = 0;\n  var displayName = "";\n  var nodeName = "";\n  var lineName = "";\n  var optionExt; //当前活动节点上的lineExt属性\n\n  var lineExt; //参与者请求返回xhttpRequest对象数组\n\n  var _reqPartiesArr = [];\n  var _ShutDownSuccess = false;\n  var ajaxParams = [];\n  var ajaxData = [];\n  var lastKey = \'\';\n\n  this.setCallback = function (fun) {\n    callback = fun;\n  };\n\n  this.notForm = true;\n\n  this.getValue = function () {\n    var steps = []; // var isSelect = false;\n\n    if ($(".wf-parties .sui-selectparticipates")[0]) {\n      var to = parties.attr("wf-to");\n      var from = parties.attr("wf-from");\n      var rollBack = parties.attr("wf-rollBack");\n      var step = {};\n      var activityType = config.activityType;\n      step.from = from;\n      step.to = to;\n      step.activityType = parties.attr("activity-type");\n      step.who = [];\n      step.displayName = displayName;\n      step.nodeName = nodeName;\n      step.lineName = lineName;\n      step.optionExt = optionExt;\n      step.who = JSON.parse($(".wf-parties #sui-selectparticipates").attr("who"));\n      step.rollBack = rollBack;\n\n      if (0 == step.who.length) {\n        if (config.multiWorkItem && "finish" != activityType) {\n          step.from = "none";\n          step.to = "none";\n        }\n      }\n\n      steps[steps.length] = step;\n      return steps;\n    }\n\n    if (!parties) {\n      return steps;\n    }\n\n    if (parties.prop("multi")) {\n      var to = parties.attr("wf-to");\n      var from = parties.attr("wf-from");\n      var rollBack = parties.attr("wf-rollBack");\n      var step = {};\n      step.from = from;\n      step.to = to;\n      step.activityType = parties.attr("activity-type");\n      step.who = [];\n      step.displayName = displayName;\n      step.nodeName = nodeName;\n      step.lineName = lineName;\n      step.optionExt = optionExt;\n      step.rollBack = rollBack; // 基于select2插件的获取参与者方法\n\n      var selects = parties.find("select");\n\n      if (selects.val()) {\n        $.each(selects.val(), function (index, val) {\n          var option = $(\'[value="\' + val + \'"]\', selects);\n          step.who[step.who.length] = {\n            id: val,\n            name: option.attr("op_name"),\n            type: option.attr("op_type")\n          };\n        });\n      }\n\n      if (0 == step.who.length) {\n        if (config.multiWorkItem && "finish" != activityType) {\n          step.from = "none";\n          step.to = "none";\n        }\n      }\n\n      steps[steps.length] = step;\n      return steps;\n    } else {\n      var step = {};\n      var select = parties.find("select");\n      var rollBack = parties.attr("wf-rollBack");\n      step.to = parties.attr("wf-to");\n      step.from = parties.attr("wf-from");\n      step.activityType = parties.attr("activity-type");\n      step.displayName = displayName;\n      step.nodeName = nodeName;\n      step.lineName = lineName;\n      step.optionExt = optionExt;\n      step.rollBack = rollBack;\n      var option = select.find("option:selected");\n\n      if (option.length > 1) {\n        step.who = [];\n\n        for (var i = 0; option.length > i; i++) {\n          if (!select.val()) {\n            return;\n          }\n\n          var text = {\n            id: option.eq(i).attr("value"),\n            name: option.eq(i).attr("op_name"),\n            type: option.eq(i).attr("op_type")\n          };\n          step.who.push(text);\n        }\n      } else if (option.length == 1) {\n        if (!select.val()) {\n          return;\n        }\n\n        if (!option.attr(\'value\')) {\n          return;\n        }\n\n        step.who = [{\n          id: option.attr("value"),\n          name: option.attr("op_name"),\n          type: option.attr("op_type")\n        }];\n      } else {\n        option = select.find("option");\n\n        if (option.length == 1) {\n          step.who = [{\n            id: option.attr("value"),\n            name: option.attr("op_name"),\n            type: option.attr("op_type")\n          }];\n        }\n      } // if(isSelect){\n      //     steps = [];\n      //     return steps;\n      // }\n      //\n\n\n      if (!step.who) {\n        step.who = [];\n\n        if (0 == step.who.length) {\n          if (config.multiWorkItem && "finish" != activityType) {\n            step.from = "none";\n            step.to = "none";\n          }\n        }\n      }\n\n      steps[steps.length] = step;\n      return steps;\n    }\n  };\n\n  this.setValue = function (val) {\n    /**\n     * val数据格式:\n     * [\n     *     {\n     *         name:\'\',\n     *         value:\'\',\n     *         type:\'\'\n     *     }\n     * ]\n     */\n    if (!$.isArray(val) && val.length === 0) {\n      return;\n    }\n\n    setTimeout(function () {\n      for (var reqIndex in _reqPartiesArr) {\n        if (_reqPartiesArr[reqIndex].readyState != 4) {\n          _reqPartiesArr[reqIndex].abort();\n        }\n      }\n\n      var $wfParties = $(\'.wf-parties\', dom);\n      $wfParties.empty();\n      var $select = $(\'<select class="form-control js-exa select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true"></select>\');\n\n      for (var i in val) {\n        var v = val[i];\n        var $option = $(\'<option></option>\');\n        $option.attr(\'value\', v.value);\n        $option.attr(\'op_name\', v.name);\n        $option.attr(\'op_type\', v.type);\n        $option.html(v.name);\n        $select.append($option);\n      }\n\n      $wfParties.html($select);\n\n      if (val.length === 1) {\n        $select.hide();\n        $select.after(\'<span>\' + val[0].name + \'</span>\');\n      } else {\n        $select.select2($.extend(true, {\n          minimumResultsForSearch: -1\n        }, config.select2 || {}));\n      }\n    }, 10);\n  };\n  /*获取控件机构id值*/\n\n\n  function getOrgId(widgetdom) {\n    var zoo = widgetdom.sui() ? $.isArray(widgetdom.sui()) ? widgetdom.sui()[0] : widgetdom.sui() : \'\';\n    var widgetVal = \'\';\n\n    if (zoo) {\n      var zooVal = SUI.Util.parseJSON(zoo.getValue(), true);\n      widgetVal = zooVal != null && _typeof(zooVal) === \'object\' ? zooVal.id : zooVal;\n    }\n\n    return widgetVal;\n  }\n\n  function getPersonInfo(persondom) {\n    var zoo = persondom.sui() ? $.isArray(persondom.sui()) ? persondom.sui()[0] : persondom.sui() : \'\';\n    var personInfo = [];\n\n    if (zoo) {\n      var zooVal = SUI.Util.parseJSON(zoo.getValue(), true);\n\n      if (zooVal.length) {\n        $.each(zooVal, function (_, v) {\n          personInfo.push({\n            positionid: v.id,\n            posiname: v.name,\n            type: v.type\n          });\n        });\n      }\n    }\n\n    return personInfo;\n  }\n\n  this.setConfig = function (val) {\n    config = val || {};\n    $(dom).removeClass(\'form-table\'); // $(dom).css(\'cssText\',\'overflow:hidden;\');//清除浮动，对于流转历史样式的影响;\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == \'true\') {\n        var previewHtml = \'<div class="col-xs-12"><div class="box"><div class="box-body no-padding"><div class="form-table"><div class="form-tr clearfix"><div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">下一步：</div><div class="item-value wf-sendTo"><select class="form-control select2-hidden-accessible" style="width: 100%;" from="ngrsq" tabindex="-1" aria-hidden="true"><option value="bmmscl">xxxxx</option></select><span>xxxx</span><span class="select2 select2-container select2-container--default" dir="ltr" style="width: 100%; display: none;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-dt8f-container"><span class="select2-selection__rendered" id="select2-dt8f-container" title=""></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span></div></div></div><div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">经办人：</div><div class="item-value">xxxx</div></div></div></div></div></div></div></div></div>\';\n        $(dom).html(previewHtml);\n      }\n    }\n\n    if (!config.tree) {\n      return;\n    }\n\n    if (!config.hides) {\n      config.hides = [];\n    }\n\n    first = true;\n    var opiniononeAttach = false;\n\n    if ("true" == config.properties.opiniononeAttach) {\n      var opiniondiv = $(\'.sui-opinionone\');\n\n      if (opiniondiv.length > 0 && opiniondiv.sui().getConfig().mode == "editable" && !opiniondiv.is(\':hidden\')) {\n        opiniononeAttach = true;\n      }\n    }\n\n    if ("2" == config.properties.showType) {\n      var tree = config.tree;\n      buildLineOptions(tree);\n      $(dom).removeClass(\'row\');\n      var options = $(\'<div class="radio-group"></div>\');\n      var opName = "sui-parties-name-" + SUI.Util.getSequence("parties");\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (tree.hasOwnProperty(\'childrenArr\') && childrenArr.length > 0) {\n            tree.childrenArr = childrenArr;\n          } else {\n            if (targetId) {\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              tree.childrenArr = childrenArr;\n            } else {\n              tree.childrenArr = tree.children;\n            }\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (trueValue === value) {\n              return;\n            }\n\n            trueValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = tree.children;\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      $.each(realArr, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var id = SUI.Util.getSequence("parties");\n              id = "sui-parties-" + id;\n              var option = $(\'<div class="item-value"><label for="\' + id + \'" style="display:inline-block;margin:0px;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label></div>\');\n              option.find("input").prop("node", node);\n              option.find("input").prop("opt", opt);\n              options.append(option);\n\n              if (opt.color) {\n                option.find("label").css("color", opt.color);\n              }\n            });\n          } else {\n            var id = SUI.Util.getSequence("parties");\n            id = "sui-parties-" + id;\n            var option = $(\'<div class="item-value"><label for="\' + id + \'" style="display:inline-block;margin:0px;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label></div>\');\n            option.find("input").prop("node", node);\n            options.append(option);\n          }\n        }\n      });\n      var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div><div class="m_title"></div></div>\' + \'</div>\' + \'</div>\' + \'</div>\' + \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">经办人：</div>\' + \'<div class="item-value" style="min-height:45px;padding:6px 10px;"><div class="col-sm-12"><div class="wf-parties" style="display:inline-block;vertical-align:top;min-width:270px;max-width:100%;clear:both;"></div></div></div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n      $(dom).html(html);\n      $(\'.m_title\', dom).append(options);\n      var radios = $(\'.radio-group\', dom),\n          radiosInput = $("input", radios);\n      radiosInput.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      }));\n      parties = $(\'.wf-parties\', dom);\n      radiosInput.on(\'ifChecked\', function () {\n        var selectRadio = radios.find("input").filter(":checked");\n        var node = selectRadio.prop("node");\n        optionExt = selectRadio.prop("opt");\n        displayName = selectRadio.attr("displayName");\n        nodeName = node.activity.name;\n        lineName = node.displayName;\n        decision(node, optionExt, config.processExt, attach); //决断\n\n        parties.show();\n        parties.parent().find(".m_parti_title").show();\n\n        if (node.activity.type == "finish") {\n          parties.hide();\n          parties.parent().find(".m_parti_title").hide();\n        }\n\n        render(parties, 0, node, config.processInstId);\n        bindFormValue(node);\n        initbindFormValue(node);\n        radios.trigger("sendToSelect", [node, parties]);\n      });\n      radios.find("input").first().iCheck("check").trigger(\'ifChecked\');\n    } else if ("1" == config.properties.showType && (config.properties.attach || opiniononeAttach)) {\n      var tree = config.tree;\n      buildLineOptions(tree);\n      $(dom).removeClass(\'row\');\n      var options = $(\'<div class="radio-group"></div>\');\n      var attach;\n\n      if (config.properties.attach) {\n        attach = $("#" + config.properties.attach);\n\n        if (attach.length == 0) {\n          attach = $("[name=\'" + config.properties.attach + "\']");\n        }\n      } else {\n        attach = $(\'.sui-opinionone\');\n      }\n\n      var attached = attach.attr("attached") == "true";\n      var opName = "sui-parties-name-" + SUI.Util.getSequence("parties");\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (tree.hasOwnProperty(\'childrenArr\') && childrenArr.length > 0) {\n            tree.childrenArr = childrenArr;\n          } else {\n            if (targetId) {\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              tree.childrenArr = childrenArr;\n            } else {\n              tree.childrenArr = tree.children;\n            }\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (trueValue === value) {\n              return;\n            }\n\n            trueValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = tree.children;\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      $.each(realArr, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var id = SUI.Util.getSequence("parties");\n              id = "sui-parties-" + id;\n              var option = $(\'<label for="\' + id + \'" class style="display: block;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label>\');\n              option.find("input").prop("node", node);\n              option.find("input").prop("opt", opt);\n              options.append(option);\n\n              if (opt.color) {\n                option.css("color", opt.color);\n              }\n            });\n          } else {\n            var id = SUI.Util.getSequence("parties");\n            id = "sui-parties-" + id;\n            var option = $(\'<label for="\' + id + \'" class style="display: block;"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label>\');\n            option.find("input").prop("node", node);\n            options.append(option);\n          }\n        }\n      });\n      var html = \'\';\n\n      if (config.properties.opinionAtTop == "true") {\n        //\thtml += \'<div class="m_body" style="padding-bottom:10px"></div><div class="m_title"></div>\';\n        html += \'<div class="m_body"></div>\';\n      } else {\n        //\thtml += \'<div class="m_title"></div><div class="m_body"></div>\';\n        html += \'<div class="m_body"></div>\';\n      }\n\n      html += \'<div class="clearfix" style="margin-top:7px; clear:both;" >\' + \'<div class="col-sm-5 col-xs-12" style="padding-left:0px; clear:both;"><div class="col-sm-3">下一步：</div>\' + \'<div class="col-sm-9"><span class="m_title"></span></div></div>\' + \'<br/><br/>\' + \'<div class="col-sm-5 col-xs-12" style="padding-left:0px; clear:both;"><span class="m_parti_title"><div class="col-sm-3">经办人：</div></span><div class="col-sm-9"><div class="wf-parties" style="display:inline-block; vertical-align: top; min-width:270px; max-width:100%; clear:both;"></div></div></div>\' + \'</div>\'; // if (attached) {\n      //     attach.remove();\n      // }\n\n      if (!$(dom).find(\'.m_body\').length) {\n        $(dom).html(html);\n\n        if (!attached) {\n          //替换并包裹目标控件\n          attach.after(dom); // attach.remove();\n\n          attach.attr("attached", "true");\n        }\n      } // $(dom).html(html);\n\n\n      $(\'.m_title\', dom).html(options); // $(\'.m_title\', dom).append(options);\n      //如果只有一个选项，并且非决断，则不显示\n\n      if (options.children().length == 1) {\n        var opt = $("input", options).prop("opt") || {};\n\n        if (!opt.decision) {\n          options.parent().hide();\n        }\n      } // if (!attached) {\n      //     //替换并包裹目标控件\n      //     attach.after(dom);\n      //     // attach.remove();\n      //     attach.attr("attached", "true");\n      // }\n\n\n      if (!$(".m_body", dom).find(attach).length) {\n        $(".m_body", dom).append(attach);\n      } // $(".m_body", dom).append(attach);\n\n\n      var radios = $(\'.radio-group\', dom),\n          radiosInput = $("input", radios);\n      radiosInput.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      }));\n      var stepView = $(\'.m_step\', dom);\n      parties = $(\'.wf-parties\', dom);\n      radiosInput.on(\'ifChecked\', function () {\n        var selectRadio = radios.find("input").filter(":checked");\n        var node = selectRadio.prop("node");\n        optionExt = selectRadio.prop("opt");\n        displayName = selectRadio.attr("displayName");\n        nodeName = node.activity.name;\n        lineName = node.displayName;\n        stepView.html(node.activity.name);\n        decision(node, optionExt, config.processExt, attach); //决断\n\n        parties.show();\n        parties.parent().find(".m_parti_title").show();\n\n        if (node.activity.type == "finish") {\n          parties.hide();\n          parties.parent().find(".m_parti_title").hide();\n        }\n\n        render(parties, 0, node, config.processInstId);\n        bindFormValue(node);\n        initbindFormValue(node);\n        radios.trigger("sendToSelect", [node, parties]);\n      });\n      radios.find("input").first().iCheck("check").trigger(\'ifChecked\');\n    } else if (config.properties.attach || opiniononeAttach) {\n      //嵌套风格或统一意见框\n      var tree = config.tree;\n      buildLineOptions(tree);\n      $(dom).removeClass(\'row\');\n      var options = $(\'<div class="radio-group"></div>\');\n      var attach;\n\n      if (config.properties.attach) {\n        attach = $("#" + config.properties.attach);\n\n        if (attach.length == 0) {\n          attach = $("div[name=\'" + config.properties.attach + "\']");\n        }\n      } else {\n        attach = $(\'.sui-opinionone\');\n      }\n\n      var attached = attach.attr("attached") == "true";\n      var opName = "sui-parties-name-" + SUI.Util.getSequence("parties");\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (tree.hasOwnProperty(\'childrenArr\') && childrenArr.length > 0) {\n            tree.childrenArr = childrenArr;\n          } else {\n            if (targetId) {\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              tree.childrenArr = childrenArr;\n            } else {\n              tree.childrenArr = tree.children;\n            }\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (trueValue === value) {\n              return;\n            }\n\n            trueValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n\n            if (targetId) {\n              var id = \'\';\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = tree.children;\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      }\n\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      $.each(realArr, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var id = SUI.Util.getSequence("parties");\n              id = "sui-parties-" + id;\n              var option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (opt.name || node.displayName || node.activity.name) + \'"/>\' + (opt.name || node.displayName || node.activity.name) + \'</label>\');\n              option.find("input").prop("node", node);\n              option.find("input").prop("opt", opt);\n              options.append(option);\n\n              if (opt.color) {\n                option.css("color", opt.color);\n              }\n            });\n          } else {\n            var id = SUI.Util.getSequence("parties");\n            id = "sui-parties-" + id;\n            var option = $(\'<label for="\' + id + \'"><input id="\' + id + \'" type="radio" name="\' + opName + \'" value="\' + node.activity.id + \'" displayName="\' + (node.displayName || node.activity.name) + \'" />\' + (node.displayName || node.activity.name) + \'</label>\');\n            option.find("input").prop("node", node);\n            options.append(option);\n          }\n        }\n      });\n      var html = \'\';\n\n      if (config.properties.opinionAtTop == "true") {\n        html += \'<div class="m_body" style="padding-bottom:10px"></div><div class="m_title"></div>\';\n      } else {\n        html += \'<div class="m_title"></div><div class="m_body"></div>\';\n      }\n\n      html += \'<div class="clearfix" style="margin-top:7px;">\' + \'<div class="col-sm-5 col-xs-12" style="padding-left:0px;min-height: 34px;line-height: 34px;"><div class="form-item">下一步：<span class="m_step"></span></div></div>\' + \'<div class="col-sm-7 col-xs-12" style="padding-left:0px;min-height: 34px;line-height: 34px;"><div class="form-item"><span class="m_parti_title">经办人：</span><div class="wf-parties" style="display:inline-block; vertical-align: top; min-width:270px; max-width:100%;"></div></div></div>\' + \'</div>\'; // if (attached) {\n      //     attach.remove();\n      // }\n\n      if (!$(dom).find(\'.m_body\').length) {\n        $(dom).html(html);\n\n        if (!attached) {\n          //替换并包裹目标控件\n          attach.after(dom); // attach.remove();\n\n          attach.attr("attached", "true");\n        }\n      } // $(dom).html(html);\n\n\n      $(\'.m_title\', dom).html(options); // $(\'.m_title\', dom).append(options);\n      //如果只有一个选项，并且非决断，则不显示\n\n      if (options.children().length == 1) {\n        var opt = $("input", options).prop("opt") || {};\n\n        if (!opt.decision) {\n          options.parent().hide();\n        }\n      } // if (!attached) {\n      //     //替换并包裹目标控件\n      //     attach.after(dom);\n      //     // attach.remove();\n      //     attach.attr("attached", "true");\n      // }\n\n\n      if (!$(".m_body", dom).find(attach).length) {\n        $(".m_body", dom).append(attach);\n      } // $(".m_body", dom).append(attach);\n\n\n      var radios = $(\'.radio-group\', dom),\n          radiosInput = $("input", radios);\n      radiosInput.iCheck(SUI.settings().iCheck({\n        iCheckStyle: config.properties.checkStyle,\n        iCheckColor: config.properties.checkColor\n      }));\n      var stepView = $(\'.m_step\', dom);\n      parties = $(\'.wf-parties\', dom);\n      radiosInput.on(\'ifChecked\', function () {\n        $(\'.tooltip\').hide();\n        $(dom).find(\'[attached="true"]\').removeClass(\'form-item-error\');\n        var selectRadio = radios.find("input").filter(":checked");\n        var node = selectRadio.prop("node");\n        optionExt = selectRadio.prop("opt");\n        displayName = selectRadio.attr("displayName");\n        nodeName = node.activity.name;\n        lineName = node.displayName;\n        stepView.html(node.activity.name);\n        decision(node, optionExt, config.processExt, attach); //决断\n\n        parties.show();\n        parties.parent().find(".m_parti_title").show();\n\n        if (node.activity.type == "finish") {\n          parties.hide();\n          parties.parent().find(".m_parti_title").hide();\n        }\n\n        render(parties, 0, node, config.processInstId);\n        bindFormValue(node);\n        initbindFormValue(node);\n        radios.trigger("sendToSelect", [node, parties]);\n      });\n      radios.find("input").first().iCheck("check").trigger(\'ifChecked\');\n    } else {\n      //底部风格\n      var tree = config.tree;\n      buildLineOptions(tree);\n      var html = \'<div class="col-xs-12">\' + \'<div class="box">\';\n      var showTitle = "true" == config.properties.showTitle;\n\n      if (showTitle) {\n        html = html + \'<div class="box-header">\' + \'<h3 class="box-title">选择办理</h3>\' + \'</div>\';\n      }\n\n      html = html + \'<div class="box-body no-padding">\' + \'<div class="form-table">\' + \'<div class="form-tr clearfix"><div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">下一步：</div><div class="item-value wf-sendTo"><select class="form-control" style="width: 100%;"></select></div></div></div>\' + \'<div class="form-td col-sm-6 col-xs-12"><div class="form-item"><div class="item-name">经办人：</div><div class="item-value"><div class="wf-parties"></div></div></div></div></div>\' + \'</div>\' + \'</div>\' + \'</div></div>\';\n      $(dom).html(html);\n\n      if (config.properties.suiPreview) {\n        if (config.properties.suiPreview == \'true\') {\n          return false;\n        }\n      }\n\n      if (tree.exts.attrs.hasOwnProperty(\'branchCondition\')) {\n        var branchCondition = JSON.parse(tree.exts.attrs.branchCondition);\n\n        if (branchCondition.weidgetName && branchCondition.conditionValue) {\n          var weidget = $(\'div[name=\' + branchCondition.weidgetName + \']\');\n          var value, targetFun, targetId;\n          var childrenArr = [];\n          var id = \'\';\n          value = weidget.sui().getValue();\n          targetFun = new Function(\'value\', branchCondition.conditionValue);\n          targetId = targetFun(value);\n\n          if (tree.hasOwnProperty(\'childrenArr\') && childrenArr.length > 0) {\n            tree.childrenArr = childrenArr;\n          } else {\n            if (targetId) {\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              tree.childrenArr = childrenArr;\n            } else {\n              tree.childrenArr = tree.children;\n            }\n          }\n\n          weidget.on(\'change\', function () {\n            value = weidget.sui().getValue();\n\n            if (trueValue === value) {\n              return;\n            }\n\n            trueValue = value;\n            targetFun = new Function(\'value\', branchCondition.conditionValue);\n            targetId = targetFun(value);\n            var branchConditionConfig = $(dom).sui().getConfig();\n            var childrenArr = [];\n            var id = \'\';\n\n            if (targetId) {\n              $.each(tree.children, function (key, child) {\n                if (child.children) {\n                  id = targetId + \'_start\';\n                } else {\n                  id = targetId;\n                }\n\n                if (child.activity.id === id) {\n                  childrenArr.push(tree.children[key]);\n                }\n              });\n              branchConditionConfig.tree.childrenArr = childrenArr;\n            } else {\n              branchConditionConfig.tree.childrenArr = tree.children;\n            }\n\n            $(dom).sui().setConfig(branchConditionConfig);\n          });\n        }\n      } //config.partiesFilter = function(parties, from, to){return parties;};\n\n\n      sendTo = $(".wf-sendTo select", dom);\n      sendTo.attr("from", tree.activity.id);\n      parties = $(".wf-parties", dom);\n      sendTo.prop("node", tree);\n      var realArr;\n\n      if (tree.childrenArr && tree.childrenArr.length > 0) {\n        realArr = tree.childrenArr;\n      } else {\n        realArr = tree.children;\n      }\n\n      $.each(realArr, function (i, node) {\n        var hasHide = false;\n\n        if (config.hides.length > 0) {\n          for (var h = 0; h < config.hides.length; h++) {\n            var hide = config.hides[h];\n\n            if (hide.from == tree.activity.id && hide.to == node.activity.id) {\n              hasHide = true;\n              break;\n            }\n          }\n        }\n\n        if (!hasHide) {\n          if (node.options) {\n            $.each(node.options, function (i, opt) {\n              var option = $(\'<option value="\' + node.activity.id + \'">\' + (opt.name || node.displayName || node.activity.name) + \'</option>\');\n              option.prop("node", node);\n              option.prop("opt", opt);\n              sendTo.append(option);\n            });\n          } else {\n            var option = $(\'<option value="\' + node.activity.id + \'">\' + (node.displayName || node.activity.name) + \'</option>\');\n            option.prop("node", node);\n            sendTo.append(option);\n          }\n        }\n      }); // select2 美化下拉框\n\n      sendTo.select2($.extend(true, {\n        minimumResultsForSearch: -1\n      }, config.select2 || {})); //只有一个选项，隐藏下拉框\n\n      if (sendTo.find("option").length == 1) {\n        //sendTo.close();\n        if (sendTo.next().length > 0) {\n          sendTo.next().hide();\n        } else {\n          sendTo.hide();\n        } //sendTo.next().hide();\n\n\n        sendTo.after(\'<span>\' + sendTo.find("option").first().text() + \'</span>\');\n      }\n\n      sendTo.change(function () {\n        var option = sendTo.find("option:selected");\n\n        if (option.prop("opt")) {\n          var opt = option.prop("opt");\n\n          if (opt.color) {\n            $(".select2-selection__rendered", sendTo.next()).css("color", opt.color);\n          } else {\n            $(".select2-selection__rendered", sendTo.next()).removeAttr("style");\n          }\n        }\n\n        displayName = option.text();\n        var node = option.prop("node");\n        nodeName = node.activity.name;\n        lineName = node.displayName;\n        optionExt = option.prop("opt");\n        decision(node, optionExt, config.processExt); //决断\n\n        parties.parent().parent().show();\n\n        if (node.activity.type == "finish") {\n          parties.parent().parent().hide();\n        }\n\n        render(parties, 0, node, config.processInstId);\n        bindFormValue(node);\n        initbindFormValue(node);\n        nodeBeforeChange = node;\n        sendTo.trigger("sendToSelect", [node, parties]);\n      });\n      sendTo.trigger("change");\n    }\n\n    if (callback && callback.length > 0) {\n      eval(callback); //            \tcallback();\n    }\n  }; //决断\n\n\n  function decision(node, linkExt, processExt, attach) {\n    linkExt = linkExt || {};\n    var targetactivityid = node.activity.id;\n    var linename;\n\n    for (var i = 0; i < node.parent.connectors.length; i++) {\n      if (node.parent.connectors[i].destActID == targetactivityid) {\n        linename = node.parent.connectors[i].displayName;\n\n        if (linename.indexOf(":") > -1 && linename.indexOf(":") < linename.length) {\n          linename = linename.substring(linename.indexOf(":") + 1, linename.length);\n        }\n      }\n    }\n\n    if (processExt && processExt.doFill === "false") {\n      return;\n    }\n\n    if (node.parent.exts.attrs.doFill === "false") {\n      return;\n    }\n\n    if (linkExt.doFill === "false") {\n      return;\n    } //填写意见\n\n\n    $(".sui-opinion[mode=editable], .sui-multiopinion[mode=editable], .sui-opinionone").each(function () {\n      /*if(first){\n          first = false;\n          return;\n      }*/\n\n      /*if (!attach) {\n          return;\n      }*/\n      var com = $(this).sui();\n\n      if (!com) {\n        return;\n      }\n\n      if (linkExt.readOnly == "true") {\n        $(\'textarea\', this).attr("readonly", true);\n      } else {\n        $(\'textarea\', this).removeAttr("readonly");\n      }\n\n      com.setOpinion(linkExt.autoFill || linename || "");\n    });\n\n    if (linkExt.decision) {\n      setExt(linkExt.name);\n    } else {\n      setExt(null);\n    }\n\n    function setExt(linkName) {\n      var com = $(".sui-opinion[mode=editable]", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n\n      com = $(".sui-multiopinion[mode=editable]", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n\n      com = $(".sui-opinionone", dom).sui();\n\n      if (com) {\n        com.setDecision(linkName);\n      }\n    }\n  }\n\n  function buildLineOptions(node) {\n    var lineExts = ((node.exts || {}).attrs || {}).lineExt || \'{}\';\n    var _lineExts = ((node.exts || {}).attrs || {})._lineExt;\n\n    if (_lineExts) {\n      lineExts += _lineExts;\n    }\n\n    lineExts = SUI.Util.parseJSON(lineExts, true);\n    lineExt = lineExts;\n    $.each(node.children, function (i, child) {\n      var line = findLine(node, child.activity);\n      var lineExt = lineExts[child.activity.id] || {};\n      child.options = lineExt.options;\n      var displayName = line.displayName;\n      child.sort = 0;\n      child.displayName = displayName;\n      var index = displayName.indexOf(":");\n\n      if (index > -1) {\n        child.sort = displayName.substring(0, index) - 0;\n        child.displayName = displayName.substring(index + 1);\n      }\n    });\n    SUI.Util.sort(node.children, function (n1, n2) {\n      return n1.sort - n2.sort;\n    });\n  } //查找连线名称\n\n\n  function findLine(tree, activity) {\n    var curConn;\n    $.each(tree.connectors, function (i, conn) {\n      if (conn.destActID == activity.id) {\n        curConn = conn;\n      }\n    });\n    return curConn;\n  }\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.parse = function (element) {\n    element = element || bind;\n    element = $(element);\n    var temp = {};\n    temp.mode = element.attr("mode");\n    temp.select = element.attr("select");\n    temp.properties = {\n      name: element.attr("name"),\n      title: element.attr("title"),\n      showTitle: element.attr("showTitle"),\n      opiniononeAttach: element.attr("opiniononeAttach"),\n      sortType: element.attr("sortType"),\n      showType: element.attr("showType"),\n      mspPreview: element.attr("msppreview"),\n      defaultSelectall: element.attr("defaultSelectall"),\n      showOption: element.attr("showOption") || \'false\'\n    };\n    temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n    temp.select2 = SUI.Util.parseJSON(element.attr("select2"), true);\n    temp.resetDataSource = element.attr("resetDataSource") || \'false\';\n    callback = element.attr("callback");\n    return temp;\n  };\n\n  function parseSelectAttrs(selectAttrs) {\n    var data = {};\n\n    if (!selectAttrs) {\n      return data;\n    }\n\n    var splits = selectAttrs.split(";");\n    $.each(splits, function (i, v) {\n      var exp = v.split("_");\n      data[exp[0]] = JSON.parse(exp[1]);\n    });\n    return data;\n  } //{"activity": {action:"",multi:true}}\n  //{"activty":{dataType:"",multi:true,selectType:"commenSelect"}}\n\n\n  function parseParti(participateFrom) {\n    var data = {};\n\n    if (!participateFrom) {\n      return data;\n    }\n\n    var splits = participateFrom.split(",");\n    $.each(splits, function (i, v) {\n      var exp = v.split(":");\n      var action = {};\n      data[exp[0]] = action;\n      var index = exp[1].indexOf("[");\n\n      if (index > -1) {\n        action.multi = exp[1].substring(index + 1, exp[1].indexOf("]"));\n        action.action = exp[1].substring(0, index);\n      } else {\n        action.action = exp[1];\n      }\n    });\n    return data;\n  } //{"activity": {xx:xxx}}\n  // 参与者相关配置转换\n\n\n  function parsePartiConfig(participateFromConfig) {\n    var data = {};\n\n    if (!participateFromConfig) {\n      return data;\n    } // var splits = participateFromConfig.split(",");\n\n\n    var splits = [participateFromConfig];\n    $.each(splits, function (i, v) {\n      // var exp = v.split(":");\n      var index = v.indexOf(":");\n      var action = {};\n\n      if (index > -1) {\n        var key = v.substring(0, index);\n        var val = v.substring(index + 1, v.length);\n\n        if (val) {\n          action = JSON.parse(val);\n        }\n      }\n\n      data[key] = action;\n    });\n    return data;\n  }\n\n  var status = {}; //构造参与者下拉框\n\n  function render(div, orgId, node, processInstId, nullable, personInfo) {\n    //清空经办人信息 7-18 add\n    div.empty();\n    status.div = div;\n    status.orgId = orgId;\n    status.node = node;\n    status.processInstId = processInstId;\n    status.nullable = nullable;\n    var allPartis;\n    var from = node.parent.activity.id;\n    var activity = node.activity.id;\n    config.activitytype = type;\n    var rollBack = false;\n    var lineExts = ((node.exts || {}).attrs || {}).lineExt || \'{}\';\n\n    if (lineExts) {\n      var _lineExts = ((node.exts || {}).attrs || {})._lineExt;\n\n      if (_lineExts) {\n        lineExts += _lineExts;\n      }\n\n      lineExts = SUI.Util.parseJSON(lineExts, true);\n\n      if (lineExts[activity]) {\n        rollBack = lineExts[activity][\'options\'][0][\'rollBack\'];\n      }\n    }\n\n    var process = node.activity.processDefId;\n    var type = node.activity.type;\n    var mCount;\n    div = div || $("<div></div>");\n    div.attr("wf-to", activity);\n    div.attr("wf-from", from);\n    div.attr("activity-type", type);\n\n    if (rollBack) {\n      rollBack = 1;\n    } else {\n      rollBack = 0;\n    }\n\n    div.attr("wf-rollBack", rollBack); //\t\t\treturn;//测试断点\n\n    if (node.activity.type == "finish") {\n      if ("2" == config.properties.showType) {\n        $(".wf-parties").parent().parent().parent().hide();\n      } else if ("1" == config.properties.showType) {} else {\n        $(div).parent().parent().hide();\n      }\n\n      return;\n    } else {\n      if ("2" == config.properties.showType) {\n        $(".wf-parties").parent().parent().parent().show();\n      } else if ("1" == config.properties.showType) {} else {\n        $(div).parent().parent().show();\n      }\n    }\n\n    if (div === parties) {\n      mCount = ++rendCount;\n    }\n\n    var select;\n\n    function filterOptions() {\n      div = $(document).find(\'.wf-parties\', dom);\n      div.empty();\n      var multi = false;\n      var exts = node.exts || {};\n      var attrs = exts.attrs || {};\n      var participateFrom = parseParti(attrs.participateFrom);\n      var participateFromConfig = parsePartiConfig(attrs.participateFromConfig);\n      var participateSelectType = parseSelectAttrs(attrs.participateSelectType); // console.log(\'config:\',config,\'participateFrom:\',participateFrom,\'node:\',node,\'participateSelectType:\',participateSelectType,\'from\',from);\n\n      if (config.displayName) {\n        if (config.properties.showType == 2) {\n          $(dom).empty();\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(dom).append(html);\n        } else if (config.properties.showType == 1) {\n          var body = $(".m_body", dom);\n          $(dom).empty();\n          $(dom).append(body);\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(dom).append(html);\n        } else if ($(\'.sui-opinionone\').length > 0 && $(\'.sui-opinionone\').sui().getConfig().mode == "editable" || config.properties.attach) {\n          var body = $(".m_body", dom);\n          $(dom).empty();\n          $(dom).append(body);\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(dom).append(html);\n        } else {\n          $(dom).empty();\n          var html = \'<div class="form-tr clearfix">\' + \'<div class="form-td col-xs-12">\' + \'<div class="form-item">\' + \'<div class="item-name">下一步：</div>\' + \'<div class="item-value">未办理人：\' + config.displayName + \'</div>\' + \'</div>\' + \'</div>\' + \'</div>\';\n          $(dom).append(html);\n        }\n\n        return;\n      }\n\n      if (participateSelectType[from] && "innerOrg" == participateSelectType[from].selectRange) {// div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        // SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        // $(".sui-selectparticipates", div).sui().init();\n        // $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        // $(".sui-selectparticipates", div).attr("selectRange", 2);\n        // $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        // $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        // $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        // return;\n      } else if (participateSelectType[from] && "postSet" == participateSelectType[from].selectRange) {\n        if (participateSelectType[from].showType) {\n          div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n          SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n          $(".sui-selectparticipates", div).sui().init();\n          $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n          $(".sui-selectparticipates", div).attr("selectRange", 1);\n          $(".sui-selectparticipates", div).attr("showType", participateSelectType[from].showType);\n          $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n          $(".sui-selectparticipates", div).attr("process", config.processDefName);\n          $(".sui-selectparticipates", div).attr("activityDefID", activity);\n          return;\n        }\n      } else if (participateSelectType[from] && "all" == participateSelectType[from].selectRange) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n        $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        $(".sui-selectparticipates", div).attr("selectRange", 0);\n        $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      } else if (participateSelectType[from] && "positionSelect" == participateSelectType[from].selectRange) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n        $(".sui-selectparticipates", div).attr("selectMulti", participateSelectType[from].selectMulti);\n        $(".sui-selectparticipates", div).attr("selectRange", 4);\n        $(".sui-selectparticipates", div).attr("dataType", participateSelectType[from].dataType);\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      }\n\n      if (config.partiSet[activity] && 6 != config.partiSet[activity]["SELECTRANGE"]) {\n        if (config.partiSet[activity]["SELECTRANGE"] != \'1\') {\n          div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n          SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n          $(".sui-selectparticipates", div).sui().init();\n          $(".sui-selectparticipates", div).attr("selectMulti", node.activity.multiWorkItem);\n          $(".sui-selectparticipates", div).attr("selectRange", config.partiSet[activity]["SELECTRANGE"]);\n          $(".sui-selectparticipates", div).attr("dataType", config.partiSet[activity]["DATATYPE"]);\n          $(".sui-selectparticipates", div).attr("empType", config.partiSet[activity]["PARAMETER"]);\n          $(".sui-selectparticipates", div).attr("process", config.processDefName);\n          $(".sui-selectparticipates", div).attr("activityDefID", activity);\n          return;\n        }\n      } // 任意选择人员\n\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'personnel\') != -1) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n\n        if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat && participateFromConfig[from].selectIdenity) {\n          $(".sui-selectparticipates", div).attr("selectMulti", participateFromConfig[from].selectMult);\n          $(".sui-selectparticipates", div).attr("displayFormat", participateFromConfig[from].displayFormat);\n          $(".sui-selectparticipates", div).attr("isIdentityChoose", participateFromConfig[from].selectIdenity);\n        }\n\n        $(".sui-selectparticipates", div).attr("empType", \'emp\');\n        $(".sui-selectparticipates", div).attr("selectRange", 6);\n        $(".sui-selectparticipates", div).attr("dataType", \'emp\');\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      } // 当前机构下选择任意人员\n\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'personOfOrg\') != -1) {\n        div.append(\'<input id="sui-selectparticipates" type="text" class="form-control" who="[]" backWho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;border-bottom-right-radius: 0;border-top-right-radius: 0;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary" style="width:20%;border-bottom-left-radius: 0;border-top-left-radius: 0;" >选择</div>\');\n        SUI.create("selectparticipates", $(".sui-selectparticipates", div)[0]);\n        $(".sui-selectparticipates", div).sui().init();\n\n        if (participateFromConfig && participateFromConfig[from] && participateFromConfig[from].selectMult && participateFromConfig[from].displayFormat) {\n          $(".sui-selectparticipates", div).attr("selectMulti", participateFromConfig[from].selectMult);\n          $(".sui-selectparticipates", div).attr("displayFormat", participateFromConfig[from].displayFormat);\n        } // $(".sui-selectparticipates", div).attr("empType", \'emp\');\n\n\n        $(".sui-selectparticipates", div).attr("selectRange", 2);\n        $(".sui-selectparticipates", div).attr("dataType", \'emp\');\n        $(".sui-selectparticipates", div).attr("process", config.processDefName);\n        $(".sui-selectparticipates", div).attr("activityDefID", activity);\n        return;\n      }\n\n      if (participateFrom[from] && participateFrom[from].multi == "select") {\n        multi = true;\n      }\n\n      div.prop("multi", multi);\n      var list = config.partiesFilter ? config.partiesFilter(allPartis, from, activity) : allPartis;\n\n      if (personInfo && personInfo.length) {\n        list = personInfo;\n      }\n\n      var html = "";\n      var selectConfig = {\n        minimumResultsForSearch: -1,\n        //option 格式，使全选option展示为按钮格式\n        templateResult: function templateResult(data) {\n          if (!data.element) {\n            return data.text;\n          }\n\n          var $element = $(data.element);\n\n          if ($element[0].className == \'allSelect_btn\') {\n            var $wrapper = $(\'<button class="btn btn-primary"></button>\');\n            $wrapper.text(data.text);\n            return $wrapper;\n          } else {\n            return data.text;\n          }\n        }\n      }; // 参与者组下人员 可以搜索\n\n      if (participateFrom[from] && participateFrom[from].action.indexOf(\'group\') != -1) {\n        delete selectConfig[\'minimumResultsForSearch\'];\n      }\n\n      select = $(\'<select class="form-control js-exa" style="width: 100%;"></select>\');\n\n      if (multi) {\n        // 这是基于select2插件做的多选\n        select.attr("multiple", "multiple");\n      } //多工作项配置\n\n\n      if (node.activity.multiWorkItem) {\n        // 这是基于select2插件做的多选\n        select.attr("multiple", "multiple");\n\n        if (list.length > 1) {\n          html += \'<option value="allSelect" class="allSelect_btn">全选</option>\';\n        }\n      } //ids 逗号分割 多工作项配置 设置全选用\n\n\n      var ids = [];\n\n      for (var i = 0; i < list.length; i++) {\n        var record = list[i];\n        var emps = "";\n\n        if (record.type == "position") {\n          var index = 0;\n\n          for (var key in record.emps) {\n            var emp = record.emps[key];\n\n            if (index > 0) {\n              emps += ",";\n            }\n\n            emps += emp.empname;\n            index++;\n          }\n        } //\t\t\t\t\tif(emps.length > 0){\n        //\t\t\t\t\t\temps = "(" + emps + ")";\n        //\t\t\t\t\t}\n\n\n        var id = "sui-participates-" + SUI.Util.getSequence("Participates"); //ids 逗号分割  value 多工作项配置 设置全选用\n\n        ids.push(record.positionid); // 在workflow2里拿到接口里的config参数，里面有SHOWCHOOSE和SHOWFORMAT\n\n        if (record.emps && record.emps.type == \'emp\') {\n          if (emps.length > 0) {\n            html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n          }\n        } else {\n          // 0岗位(姓名) 1姓名(岗位) 2姓名\n          if ("1" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + record.posiname + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + "(" + record.posiname + ")" + \'</option>\';\n              }\n            }\n          } else if (\'null\' === config.sysConfig.SHOWFORMAT || null === config.sysConfig.SHOWFORMAT || "0" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                emps = emps.length > 0 ? "(" + emps + ")" : \'\';\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + record.posiname + emps + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                emps = "(" + emps + ")";\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + record.posiname + emps + \'</option>\';\n              }\n            }\n          } else if ("2" === config.sysConfig.SHOWFORMAT) {\n            if (record.type === \'emp\') {\n              if (emps.length > 0 || record.posiname) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n              }\n            } else {\n              if (emps.length > 0) {\n                html += \'<option id="\' + id + \'" value="\' + record.positionid + \'" op_type="\' + record.type + \'" op_name="\' + record.posiname + \'">\' + emps + \'</option>\';\n              }\n            }\n          }\n        }\n\n        if (list.length == 1) {\n          select.next().hide();\n          select.next().length ? select.next().after(\'<span>\' + list[0].posiname + \'</span>\') : select.after(\'<span>\' + list[0].posiname + \'</span>\');\n        }\n      }\n\n      if (config.sysConfig.SHOWCHOOSE == \'1\') {\n        if (list.length > 1) {\n          if (multi) {\n            selectConfig.placeholder = "请选择";\n          } else {\n            html = \'<option>请选择</option>\' + html;\n          }\n        }\n      }\n\n      select.html(html); // select2\n\n      div.append(select);\n      select.select2($.extend(true, selectConfig, config.select2 || {})); // 当默认有显示 请选择 时，值为空，全选时避开  选择全选时，将 全选 避开\n\n      function deleteEmpty(array) {\n        for (var arrrIndex = 0; arrrIndex < array.length; arrrIndex++) {\n          if (array[arrrIndex] === \'\' || array[arrrIndex] === \'allSelect\') {\n            array.splice(arrrIndex, 1);\n          }\n\n          return array;\n        }\n      } // 切换时控制 全选按钮的显示与隐藏\n\n\n      select.on(\'change\', function () {\n        var personVal = $(this).val(); // 值是[]和null\n\n        personVal ? personVal : personVal = \'[]\';\n\n        if (personVal.indexOf(\'allSelect\') > -1) {\n          select.val(deleteEmpty(ids)).trigger(\'change\');\n        }\n      }); //只有一个选项，隐藏下拉框\n\n      if (select && select.find("option").length == 1) {\n        //sendTo.close();\n        if (select.next(\'span\').length > 0) {\n          select.next(\'span\').hide();\n        } else {\n          select.hide();\n        }\n\n        select.after(\'<span>\' + select.find("option").first().text() + \'</span>\');\n      } // var defaultSelectall = config.properties.defaultSelectall;\n      // if(select && select.find("option").length > 1){\n      //     if(defaultSelectall == \'true\'){\n      //         $(".js-exa").val(ids).trigger(\'change\');//默认全选\n      //         $(\'.js-exa\').prop(\'disabled\',true);\n      //     }\n      // }\n      //多工作项配置\n\n\n      if (node.activity.multiWorkItem) {\n        //只有配置participantChooseMore 为true，多工作项默认全选\n        if (node.exts.attrs.participantChooseMore == "true") {\n          // 这是基于select2插件做的多选\n          $(".js-exa").val(ids).trigger(\'change\'); //默认全选\n\n          $(\'.js-exa\').prop(\'disabled\', true);\n        }\n      }\n\n      if (node.exts.attrs && node.exts.attrs.toAllParticipant && node.exts.attrs.toAllParticipant == \'true\') {\n        select.val(deleteEmpty(ids)).trigger(\'change\');\n        select.select2({\n          disabled: true\n        });\n      } //全选按钮 不要鼠标悬浮背景变色事件\n\n\n      $(\'body\').on(\'mouseover\', \'.select2-results__option\', function () {\n        if ($(this).children().length > 0) {\n          $(this).addClass(\'allSelect_bg\');\n        }\n      });\n\n      if (!$(dom).find(\'.clear-both\').length) {\n        $(dom).append(\'<div class="clear-both" style="clear: both;"></div>\');\n      }\n    }\n\n    var key = activity + "-" + process + "-" + orgId + "-" + from + "-" + config.workItemId + "-" + (processInstId || 0);\n\n    if (config.resetDataSource == \'true\') {\n      key = activity + "-" + process + "-" + orgId + "-" + from + "-" + config.workItemId + "-" + (processInstId || 0) + JSON.stringify($(".sui-form").sui().getValue());\n    }\n\n    lastKey = key;\n    var repeatAjax = false;\n\n    if (ajaxParams.length) {\n      $.each(ajaxParams, function (_, k) {\n        if (k == key) {\n          repeatAjax = true;\n        }\n      });\n\n      if (!repeatAjax) {\n        ajaxParams.push(key);\n      }\n    } else {\n      ajaxParams.push(key);\n    } //缓存\n\n\n    var cache = SUI.Util.getCache("parties");\n    var cacheData = cache[key];\n\n    function cacheData_change(e) {\n      if (typeof e.data === \'string\') {\n        var c_data = JSON.parse(e.data);\n\n        if (c_data.type == \'repeatAjax\') {\n          cacheData = ajaxData[lastKey];\n\n          if (cacheData) {\n            allPartis = cacheData;\n            setTimeout(function () {\n              filterOptions();\n            }, 1);\n          }\n        }\n      }\n    }\n\n    if (config.resetDataSource == \'true\') {\n      window.addEventListener(\'message\', cacheData_change, "*");\n      _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n        type: "POST",\n        url: "com.sudytech.portalone.base.ui.queryParticipants.biz.ext",\n        data: wf.jsonString({\n          activityDefID: activity,\n          process: process,\n          orgId: orgId,\n          from: from,\n          workItemId: config.workItemId,\n          processInstId: processInstId || 0,\n          thisEntity: $(".sui-form").sui().getValue()\n        }),\n        contentType: "text/json",\n        success: function success(data) {\n          var list = data.list;\n          $(dom).trigger(\'load\', [list]);\n          allPartis = list || [];\n          cache[key] = allPartis;\n          ajaxData[key] = allPartis;\n          var postType = {\n            type: "repeatAjax",\n            data: allPartis\n          };\n          window.postMessage(JSON.stringify(postType), "*");\n\n          if (div === parties) {\n            if (mCount == rendCount) {\n              filterOptions();\n            }\n          } else {\n            filterOptions();\n          }\n        },\n        error: function error() {\n          _ShutDownSuccess = true;\n          $(\'.wf-parties\', dom).empty();\n        }\n      });\n    } else {\n      window.addEventListener(\'message\', cacheData_change, "*");\n\n      if (cacheData) {\n        cacheData = ajaxData[lastKey];\n        allPartis = cacheData;\n        setTimeout(function () {\n          filterOptions();\n        }, 1);\n      } else {\n        if (!repeatAjax) {\n          _reqPartiesArr[_reqPartiesArr.length] = $.ajax({\n            type: "POST",\n            url: "com.sudytech.portalone.base.ui.queryParticipants.biz.ext",\n            data: wf.jsonString({\n              activityDefID: activity,\n              process: process,\n              orgId: orgId,\n              from: from,\n              workItemId: config.workItemId,\n              processInstId: processInstId || 0\n            }),\n            contentType: "text/json",\n            success: function success(data) {\n              var list = data.list;\n              $(dom).trigger(\'load\', [list]);\n              allPartis = list || [];\n              cache[key] = allPartis;\n              ajaxData[key] = allPartis;\n              var postType = {\n                type: "repeatAjax",\n                data: allPartis\n              };\n\n              if (div === parties) {\n                if (mCount == rendCount) {\n                  filterOptions();\n                }\n              } else {\n                filterOptions();\n              }\n\n              window.postMessage(JSON.stringify(postType), "*");\n            },\n            error: function error() {\n              _ShutDownSuccess = true;\n              $(\'.wf-parties\', dom).empty();\n            }\n          });\n        }\n      }\n    } // return div;\n\n  }\n\n  var bindwidgetids = [];\n\n  function initbindFormValue(node) {\n    var participateFrom = getParticipateFrom(node.exts.attrs.participateFrom);\n\n    if (participateFrom) {\n      if (participateFrom.indexOf("formValue") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var widgetdom = $("#" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $("div[name=" + widgetid + "]");\n        }\n\n        var orgid = getOrgId(widgetdom);\n\n        if (orgid) {\n          render(status.div, orgid, status.node, status.processInstId, status.nullable);\n        }\n      } else if (participateFrom.indexOf("personValue") > -1) {\n        var personid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var persondom = $("#" + personid);\n\n        if (persondom.length == 0) {\n          persondom = $("div[name=" + personid + "]");\n        }\n\n        var personInfo = getPersonInfo(persondom);\n\n        if (personInfo) {\n          render(status.div, \'\', status.node, status.processInstId, status.nullable, personInfo);\n        }\n      }\n    }\n  }\n\n  function bindFormValue(node) {\n    var participateFrom = getParticipateFrom(node.exts.attrs.participateFrom);\n\n    if (participateFrom) {\n      if (participateFrom.indexOf("formValue") > -1) {\n        var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]")); //widgetid= "org2";\n\n        var widgetdom = $("#" + widgetid);\n\n        if (widgetdom.length == 0) {\n          widgetdom = $("div[name=" + widgetid + "]");\n        }\n\n        if (widgetdom.length) {\n          // var orgid = getOrgId(widgetdom);\n          widgetdom.on("change", changeOrgId);\n          bindwidgetids.push(widgetid); // if (orgid) {\n          //     widgetdom.on("change", changeOrgId);\n          //     bindwidgetids.push(widgetid);\n          // }\n        }\n      } else if (participateFrom.indexOf("personValue") > -1) {\n        var personid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n        var persondom = $("#" + personid);\n\n        if (persondom.length == 0) {\n          persondom = $("div[name=" + personid + "]");\n        }\n\n        if (persondom.length) {\n          persondom.on("change", changePersonInfo);\n          bindwidgetids.push(personid); // if (orgid) {\n          //     widgetdom.on("change", changeOrgId);\n          //     bindwidgetids.push(widgetid);\n          // }\n        }\n      } else {\n        if (nodeBeforeChange) {\n          var participateFrom = nodeBeforeChange.exts.attrs.participateFrom;\n\n          if (participateFrom && participateFrom.indexOf("formValue") > -1) {\n            var widgetid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n            var $dom = $("#" + widgetid);\n\n            if ($dom.length == 0) {\n              $dom = $("div[name=" + widgetid + "]");\n            }\n\n            if ($dom.length) {\n              $dom.off("change", changeOrgId);\n\n              for (var i = 0; i < bindwidgetids.length; i++) {\n                if (bindwidgetids[i] == widgetid) {\n                  bindwidgetids.splice(i, 1);\n                  break;\n                }\n              }\n            }\n          } else if (participateFrom && participateFrom.indexOf("personValue") > -1) {\n            var personid = participateFrom.substring(participateFrom.indexOf("[") + 1, participateFrom.indexOf("]"));\n            var $dom = $("#" + personid);\n\n            if ($dom.length == 0) {\n              $dom = $("div[name=" + personid + "]");\n            }\n\n            if ($dom.length) {\n              $dom.off("change", changePersonInfo);\n\n              for (var i = 0; i < bindwidgetids.length; i++) {\n                if (bindwidgetids[i] == personid) {\n                  bindwidgetids.splice(i, 1);\n                  break;\n                }\n              }\n            }\n          }\n        }\n      }\n    } else {\n      for (var i = 0; i < bindwidgetids.length; i++) {\n        var widgetid = bindwidgetids[i];\n        var $dom = $("#" + widgetid);\n\n        if ($dom.length == 0) {\n          $dom = $("div[name=" + widgetid + "]");\n        }\n\n        if ($dom.length) {\n          $dom.off("change", changeOrgId);\n        }\n      }\n    }\n\n    if (node.exts.attrs.fieldBindParticipate) {\n      var bindField = node.exts.attrs.fieldBindParticipate;\n      var widgetDom = $("div[name=" + bindField + "]");\n      var nodeId = node.activity.id;\n\n      if (widgetDom.length > 0) {\n        widgetDom.on(\'change\', function () {\n          config.resetDataSource = \'true\';\n          render(status.div, 0, status.node, status.processInstId, status.nullable);\n        });\n        $(document).on(\'businessDone\', function () {\n          config.resetDataSource = \'true\';\n\n          if (nodeId == status.node.activity.id) {\n            render(status.div, 0, status.node, status.processInstId, status.nullable);\n          }\n        });\n      }\n    }\n  }\n\n  function getParticipateFrom(allpartis) {\n    var participateFrom = "";\n\n    if (allpartis) {\n      var currActId = config.tree.activity.id;\n      var partis = allpartis.split(",");\n\n      for (var i in partis) {\n        var p = partis[i];\n\n        if (p.substring(0, p.indexOf(":")) == currActId) {\n          participateFrom = p.substring(p.indexOf(":") + 1);\n          break;\n        }\n      }\n    }\n\n    return participateFrom;\n  }\n\n  function changeOrgId() {\n    var orgid = getOrgId($(this));\n\n    if (!orgid) {\n      return;\n    }\n\n    render(status.div, orgid, status.node, status.processInstId, status.nullable);\n  }\n\n  function changePersonInfo() {\n    var personInfo = getPersonInfo($(this));\n\n    if (!personInfo) {\n      return;\n    }\n\n    render(status.div, \'\', status.node, status.processInstId, status.nullable, personInfo);\n  } //开放构造参与者选项的接口\n\n\n  this.buildPartiesSelect = render;\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Participates/Participates.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Print/Print.js":
/*!********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Print/Print.js ***!
  \********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Print; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:27 AM\n */\n\n/**\n * 打印\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction Print(bind) {\n  var dom = bind || $('<div />').get(0),\n      config,\n      pid,\n      printUrl;\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    return _parseData(element);\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).addClass('isBtn');\n    var head = document.getElementsByTagName('head')[0],\n        stylebtn,\n        styleHeadAndFoot;\n    var btnHtml = '<a class=\"btn btn-primary \" id=\"s-print\">打印</a>';\n    var cssComponents = {\n      hide_button: '@media print {\\\n                    .noprint{\\\n                        visibility:hidden\\\n                    }\\\n                }',\n      hide_headAndFoot: '@media print {\\\n                    @page {\\\n                        size: A4 landscape;   \\\n                        margin: 0mm; \\\n                    }\\\n                }'\n    };\n    $(dom).html(btnHtml);\n    $(dom).css('display', 'none');\n\n    if (SUI.Util.browserType() === 'phone') {\n      return false;\n    }\n\n    if (config.properties.processDefExt) {\n      if (wf2.workflow.entity) {\n        if (config.properties.processDefExt.attrs.isPrint) {\n          if (config.properties.processDefExt.attrs.isPrint === 'alwaysPrint') {\n            $(dom).css('display', 'inline-block');\n          } else {\n            var printMode = SUI.Util.getQueryString('mode');\n\n            if (printMode === 'preview') {\n              // var url = 'com.sudytech.portalone.base.workflow.queryWorkItem.biz.ext';\n              var url = 'com.sudytech.portalone.base.workflow.queryProcessDetail.biz.ext';\n              var processInstId = wf2.entity && wf2.entity.processInstId || '';\n              $.ajax({\n                url: url,\n                type: 'get',\n                data: {\n                  processInstId: processInstId\n                },\n                success: function success(data) {\n                  if (data.processInstState == '7' || data.processInstState == 7) {\n                    $(dom).css('display', 'inline-block');\n                  } else {\n                    $(dom).css('display', 'none');\n                  }\n                }\n              });\n            }\n          }\n        }\n      }\n    }\n\n    if (SUI.Util.getQueryString('mode') === 'print') {\n      $('body').addClass('form-print-style');\n      this.setPrintStyle();\n    }\n    /* 修改状态是时 不显示 */\n\n\n    if (config.wfConfig && config.wfConfig.mode == 'modify') {\n      $(dom).hide();\n      return;\n    } // 是否显示打印按钮（通过在头部插入CSS样式）\n\n\n    if (config.properties.hideBtn == 'true') {\n      head = document.getElementsByTagName('head')[0];\n      stylebtn = document.createElement('style');\n      stylebtn.type = 'text/css';\n      stylebtn.innerHTML = cssComponents.hide_button;\n      head.appendChild(stylebtn); //dom增加 noprint样式\n\n      $(dom).addClass('noprint');\n    } // 是否显示页头和页脚（通过在头部插入CSS样式，IE可能存在兼容性问题）\n\n\n    if (config.properties.hideHeadAndFoot == 'true') {\n      styleHeadAndFoot = document.createElement('style');\n      styleHeadAndFoot.type = 'text/css';\n      styleHeadAndFoot.innerHTML = cssComponents.hide_headAndFoot;\n      head.appendChild(styleHeadAndFoot);\n    }\n\n    if (config.properties.processDefExt) {\n      printUrl = config.properties.processDefExt.attrs.printUrl;\n    }\n\n    if (config.properties.entity) {\n      pid = config.properties.entity.processInstId;\n    }\n\n    if (config.properties.suiPreview) {\n      if (config.properties.suiPreview == 'true') {// return false;\n      }\n    }\n\n    _domEvent();\n  };\n\n  this.setPrintStyle = function () {\n    // 浏览器窗口视口高度\n    var screenHeight = window.screen.height;\n    var screenWidth = window.screen.width;\n    var innerHeight = window.innerHeight;\n    var innerWidth = window.innerWidth;\n    var scaleForA4 = 210 / 297;\n    var maxWidth = 1000;\n    var minWidth = 700;\n    var printWidth = '';\n\n    if (screenHeight == 900 && screenWidth == 1440 || screenHeight == 900 && screenWidth == 1600) {\n      printWidth = Math.floor(screenHeight * scaleForA4) + 67 + 'px!important';\n    } else if (screenHeight == 768 && screenWidth == 1366 || screenHeight == 768 && screenWidth == 1360 || screenHeight == 800 && screenWidth == 1280 || screenHeight == 768 && screenWidth == 1280 || screenHeight == 720 && screenWidth == 1280 || screenHeight == 768 && screenWidth == 1024) {\n      printWidth = Math.floor(screenHeight * scaleForA4) + 57 + 'px!important';\n    } else {\n      printWidth = Math.floor(screenHeight * scaleForA4) + 77 + 'px!important';\n    }\n\n    var printWidth2 = Math.floor(innerHeight * scaleForA4) + 200;\n\n    if (printWidth2 > printWidth) {\n      printWidth = printWidth2;\n    }\n\n    if (minWidth > printWidth) {\n      printWidth = minWidth;\n    }\n\n    if (printWidth > maxWidth) {\n      printWidth = maxWidth;\n    }\n\n    var printScale = '@media (min-width:768px){\\\n                    .mspplus-form {\\\n                        width:' + printWidth + ';\\\n                }\\\n            }';\n    var head = document.getElementsByTagName('head')[0];\n    var printStyle = document.createElement('style');\n    printStyle.type = 'text/css';\n    printStyle.innerHTML = printScale;\n    head.appendChild(printStyle);\n  };\n\n  this.getValue = function () {};\n\n  this.setValue = function () {};\n\n  function _parseData(element) {\n    var el = element || bind;\n    var _data = {\n      mode: $(el).attr(\"mode\"),\n      properties: {\n        title: $(el).attr(\"title\"),\n        name: $(el).attr(\"name\"),\n        hideBtn: $(el).attr('hideBtn') || 'true',\n        hideHeadAndFoot: $(el).attr('hideHeadAndFoot'),\n        suiPreview: $(el).attr('suipreview')\n      }\n    };\n    return _data;\n  }\n\n  function _domEvent(element) {\n    var el = element || bind,\n        btn = $(el).find('a');\n    $(btn).on('click', function () {\n      var printMode = SUI.Util.getQueryString('mode');\n\n      if (printMode === 'print') {\n        window.print();\n      } else {\n        if (pid && printUrl) {\n          if (SUI.Util.browserType() === 'phone') {\n            window.location.href = printUrl + \"?mode=print&ismobile=true&processInstId=\" + pid;\n          } else {\n            window.open(encodeURI(printUrl + \"?mode=print&processInstId=\" + pid));\n          }\n        } else {\n          if (pid) {\n            if (SUI.Util.browserType() === 'phone') {\n              window.location.href = 'preview.jsp?mode=print&ismobile=true&processInstId=' + pid;\n            } else {\n              window.open(encodeURI('preview.jsp?mode=print&processInstId=' + pid));\n            }\n          } else {\n            window.print();\n          }\n        }\n      }\n    });\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Print/Print.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Qrcode/Qrcode.js":
/*!**********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Qrcode/Qrcode.js ***!
  \**********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Qrcode; });\n/**\n * Qrcode 二维码\n * @param bind\n * @returns {*|jQuery}\n * @constructor\n */\nfunction Qrcode(bind) {\n  var config;\n  var dom = bind || $('<div></div>').get(0);\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var conf = {\n      render: $(dom).attr('render') || 'canvas',\n      // 渲染方式\n      width: $(dom).attr('size') || '150',\n      // 宽度\n      height: $(dom).attr('size') || '150',\n      // 高度\n      text: $(dom).attr('url') || location.href,\n      tip: $(dom).attr(\"tip\") || ''\n    };\n    return conf;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n\n    if (SUI.Util.getQueryString('mode') == 'print') {\n      $(dom).html('');\n      A.use(__basePath + '_libs/plugins/jQuery/jquery.qrcode.min.js', function () {\n        var processInstId = SUI.Util.getQueryString('processInstId');\n\n        if (processInstId) {\n          var host = location.host;\n          config.text = host + __basePath + 'workflow' + '/preview.jsp?mode=preview&processInstId=' + processInstId;\n        }\n\n        $(dom).qrcode({\n          render: config.render,\n          //table方式\n          width: config.width,\n          //宽度\n          height: config.height,\n          //高度\n          text: toUtf8(config.text),\n          //任意内容\n          correctLevel: 3 // 纠错级别\n\n        });\n\n        if (config.tip != null && config.tip != 'undefined') {\n          $(dom).append(\"<div  style='width: \" + config.width + \"px;text-align:center'   >\" + config.tip + \"</div>\");\n        }\n      });\n    }\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.getValue = function () {\n    return config.text;\n  };\n\n  this.setValue = function (val) {\n    config.text = val;\n  };\n\n  function toUtf8(str) {\n    var out, i, len, c;\n    out = \"\";\n    len = str.length;\n\n    for (i = 0; i < len; i++) {\n      c = str.charCodeAt(i);\n\n      if (c >= 0x0001 && c <= 0x007F) {\n        out += str.charAt(i);\n      } else if (c > 0x07FF) {\n        out += String.fromCharCode(0xE0 | c >> 12 & 0x0F);\n        out += String.fromCharCode(0x80 | c >> 6 & 0x3F);\n        out += String.fromCharCode(0x80 | c >> 0 & 0x3F);\n      } else {\n        out += String.fromCharCode(0xC0 | c >> 6 & 0x1F);\n        out += String.fromCharCode(0x80 | c >> 0 & 0x3F);\n      }\n    }\n\n    return out;\n  }\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Qrcode/Qrcode.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/QueryWf/QueryWf.js":
/*!************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/QueryWf/QueryWf.js ***!
  \************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return QueryWf; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 11:00 AM\n */\n\n/**\n * 管理-查询\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction QueryWf(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      beforeQuery: $(el).attr('beforeQuery') || '',\n      className: $(el).attr('className') || 'btn-primary',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<a class=\"btn ' + config.className + ' btn-sm\">查询</a>';\n    $(dom).append(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    } //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n\n    btn.click(function () {\n      var conditions = SUI.Util.getConditions();\n      /*查询前方法*/\n\n      var code = config.beforeQuery;\n      eval('(function(){' + code + '})()');\n      $('.sui-tablelist').sui().extraParam(function (params) {\n        params = {\n          data: conditions\n        };\n        return params;\n      });\n      $('.sui-tablelist').sui().tableApi().ajax.reload(function () {\n        $('.sui-tablelist').sui().tableApi().columns.adjust().draw(false);\n      }, false);\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/QueryWf/QueryWf.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Reset/Reset.js":
/*!********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Reset/Reset.js ***!
  \********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Reset; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:32 PM\n */\n\n/**\n * 管理-重置\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Reset(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      className: $(el).attr('className') || 'btn-primary',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<a class=\"btn ' + config.className + ' btn-sm\">重置</a>';\n    $(dom).append(html);\n    var btn = $(dom).find('a');\n    btn.click(function () {\n      $('.mspplus-form').find('div[msp-condition]').each(function () {\n        if ($(this).hasClass('sui-select') && $(this).find('option:first').val() == '$noValue$') {\n          $(this).sui().setValue('$noValue$', true);\n        } else {\n          if ($(this).hasClass('sui-select') && $(this).find('option[value=\"[{\\'newValue\\':\\'\\'}]\"]').length) {\n            $(this).sui().setValue(\"[{'newValue':''}]\", true);\n          } else {\n            $(this).sui().setValue('', true);\n          }\n        }\n      });\n      /* 以下是查询控件的点击事件，可以考虑是否应该手动触发查询click */\n\n      var conditions = SUI.Util.getConditions();\n      $('.sui-tablelist').sui().extraParam(function (params) {\n        params = {\n          data: conditions\n        };\n        return params;\n      });\n      $('.sui-tablelist').sui().tableApi().ajax.reload(function () {\n        $('.sui-tablelist').sui().tableApi().columns.adjust().draw(false);\n      }, false);\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Reset/Reset.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Rollback/Rollback.js":
/*!**************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Rollback/Rollback.js ***!
  \**************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Rollback; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:13 AM\n */\n\n/**\n * 收回控件\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Rollback(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).addClass('isBtn');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        $(dom).css('display', 'inline-block');\n        $(dom).html('<a class=\"btn btn-primary\">收回</a>');\n        return false;\n      }\n    }\n\n    if (!config.processInstId && !config.currworkItemID) {\n      $(dom).hide();\n      return;\n    }\n\n    var mode = SUI.Util.getQueryString('mode');\n\n    if (mode == 'print') {\n      $(dom).hide();\n      return;\n    } //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n\n    if (!config.wfConfig) {\n      return;\n    }\n    /* 修改状态是时 不显示 */\n\n\n    if (config.wfConfig && config.wfConfig.mode == 'modify') {\n      $(dom).hide();\n      return;\n    }\n\n    $.ajax({\n      type: \"POST\",\n      url: \"com.sudytech.portalone.base.ui.showDrawbackWorkItemBtn.biz.ext\",\n      data: wf.jsonString({\n        currworkItemID: config.currworkItemID,\n        processInstId: config.processInstId\n      }),\n      contentType: \"text/json\",\n      success: function success(data) {\n        if (data.allow == \"true\") {\n          $(dom).css('display', 'inline-block');\n          $(dom).html('<a class=\"btn btn-primary\">收回</a>');\n          wf2.buildBtnForPhone();\n          var btn = $(dom).find('a');\n          var isdone = false;\n          btn.click(function () {\n            if (isdone) {\n              layer.alert(\"已收回成功\", function (index) {\n                layer.close(index);\n                SUI.Util.wfCloseWindow();\n              });\n              return;\n            }\n\n            $.ajax({\n              type: \"POST\",\n              url: \"com.sudytech.portalone.base.workflow.drawbackWorkItem.biz.ext\",\n              async: false,\n              data: wf.jsonString({\n                workItemId: config.currworkItemID,\n                processInstId: config.processInstId\n              }),\n              contentType: \"text/json\",\n              success: function success(data) {\n                if (data.msg == \"success\") {\n                  isdone = true;\n\n                  if (config.callback) {\n                    config.callback();\n                  } else {\n                    layer.alert('收回成功', function (index) {\n                      layer.close(index);\n                      SUI.Util.wfCloseWindow();\n                    });\n                  }\n                } else {\n                  layer.alert(data.msg || '收回失败', function (index) {\n                    layer.close(index);\n                    SUI.Util.wfCloseWindow();\n                  });\n                }\n              }\n            });\n          });\n          $(dom).show();\n        }\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Rollback/Rollback.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectMechanismTool/SelectMechanismTool.js":
/*!************************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectMechanismTool/SelectMechanismTool.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SelectMechanismTool; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 2:01 PM\n */\n\n/**\n * 机构选择器-单选\n * @param bind\n * @returns {*}\n * @constructor\n */\nvar group_id_index = 0;\nfunction SelectMechanismTool(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      value;\n  dom.zoo = this;\n  var search_ztree = null;\n  var default_ztree = null; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr(\"mode\") || 'editable',\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      isUserMechanism: $(el).attr(\"isUserMechanism\"),\n      properties: {\n        name: $(el).attr('name'),\n        mspPreview: $(el).attr('mspPreview') || false,\n        orgSelected: $(el).attr('orgSelected') || '[]'\n      },\n      hidewrapper: $(el).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    var head = document.getElementsByTagName('head')[0];\n    config = val;\n    this.name = config.properties.name;\n    var mode = config.mode;\n    var mspPreview = $(dom).attr('mspPreview') || false;\n    var orgSelected = config.properties.orgSelected;\n    var valueProp = $(dom).attr('valueProp') || '';\n    var isUserMechanism = config.isUserMechanism;\n    var viewCss = \".input-dropdown-tree {}\\\n            .dropdown-tree {height: 325px;}\\\n            .dropdown-tree .tree-wrap {height: 250px;margin: 0 5px;margin-bottom: 5px;overflow: auto}\\\n            .dropdown-tree .tree-close {float: right;margin-right: 5px;}\\\n            .menuContent {display:none; position: absolute;}\";\n    var styleorg = document.createElement('style');\n    styleorg.type = 'text/css';\n    styleorg.innerHTML = viewCss;\n    head.appendChild(styleorg);\n    var styleTree = document.createElement('link');\n    styleTree.rel = \"stylesheet\";\n    styleTree.href = __basePath + '_libs/plugins/zTree/css/metroStyle/metroStyle.css';\n    head.appendChild(styleTree);\n    var viewHtml = '<div class=\"input-group input-dropdown-tree\">\\\n            <input type=\"text\" class=\"form-control org-info\" treeNodeData=\"\" orgSelected=\"' + orgSelected + '\" readonly placeholder=\"请选择机构\">\\\n            <span class=\"input-group-addon tree-toggle\">选择</span>\\\n            <div class=\"input-group hide-div\" hide></div>\\\n            </div>';\n    var viewHtml_phone = '<div class=\"input-dropdown-tree\">' + '<input type=\"text\" class=\"org-info input_phone input-hide\" treeNodeDat=\"\"  orgSelected=\"' + orgSelected + '\" readonly>' + '<span class=\"org-tips\">请选择</span>' + '<span class=\"org-arrow\"></span>' + '</div>';\n\n    var treeHtml = function (id) {\n      return '<div class=\"dropdown-menu dropdown-tree menuContent\">\\\n                                <div class=\"input-group input-group-sm\">\\\n                                    <span class=\"input-group-addon\" style=\"cursor: pointer;\"  id=\"search\">\\\n                                        <i id=\"search\" class=\"fa fa-search\"></i>\\\n                                    </span>\\\n                                    <input name=\"search-input\" type=\"text\" class=\"form-control org-info\" style=\"border-top-right-radius:0!important;border-bottom-right-radius:0!important\" placeholder=\"请输入部门名称\">\\\n                                    <span class=\"input-group-addon\" style=\"cursor: pointer;\"  id=\"del\">\\\n                                        <i class=\"fa fa-close\"></i>\\\n                                    </span>\\\n                                </div>\\\n                                <ul class=\"tree-wrap ztree\" id=\"group_tree_' + id + '\" style=\"overflow: auto\"></ul>\\\n                            </div>';\n    }(group_id_index++);\n\n    var previewHtml = '<div class=\"input-group input-dropdown-tree\">\\\n            <input type=\"text\" treeNodeData=\"\" class=\"form-control org-info\" placeholder=\"请选择\" readonly >\\\n            <span class=\"input-group-addon tree-toggle\">选择</span>\\\n            </div>';\n    var readonlyHtml = '<div class=\"input-group value-text input-dropdown-tree\">\\\n            <input type=\"text\" id=\"value_' + this.name + '\" class=\" org-info\" treeNodeData=\"\" readonly style=\"border: none;padding-left:10px;padding-right:10px;outline:none;\">\\\n            <span></span>\\\n            </div>';\n\n    function getSetting(dom, isSearch) {\n      var setting1 = {\n        async: {\n          enable: true,\n          url: \"com.sudytech.portalone.base.db.queryOrganization.biz.ext\",\n          autoParam: [\"id\"],\n          otherParam: {\n            orgName: function orgName() {\n              return $(dom).find(\"input[name=search-input]\").val();\n            }\n          },\n          dataFilter: function dataFilter(treeId, parentNode, responseData) {\n            return responseData.lis;\n          }\n        },\n        callback: {\n          onAsyncSuccess: function onAsyncSuccess(event, treeId, treeNode, msg) {\n            var default_ztree_nodes = default_ztree.getNodes();\n\n            if (default_ztree_nodes.length === 1) {\n              default_ztree.expandNode(default_ztree_nodes[0], true);\n            }\n\n            if (isSearch) {\n              search_ztree ? search_ztree.expandAll(true) : '';\n            } // 获取当前登录人机构节点信息\n\n\n            var orgId = '';\n\n            if (isUserMechanism == 'orgId' || isUserMechanism == 'true') {\n              orgId = SUI.Util.context.user.userOrgId;\n\n              if (!orgId) {\n                orgId = Coreplus.getUserContext() && Coreplus.getUserContext().userOrgId;\n              }\n            } else if (isUserMechanism == 'mainOrgId') {\n              orgId = SUI.Util.context.user.EXTEND_ORG2_ID;\n\n              if (!orgId) {\n                orgId = Coreplus.getUserContext() && Coreplus.getUserContext().EXTEND_ORG2_ID;\n              }\n            } // var userOrgNameNormal =  Coreplus.getUserContext() && Coreplus.getUserContext().userOrgName;// 没有流程时获取登录人机构使用（如普通提交表单）\n\n\n            if (isUserMechanism && orgId && !isSearch) {\n              // $(dom).hide();\n              getUserInfo();\n            }\n          },\n          onClick: function onClick(event, treeId, treeNode, clickFlag) {\n            event.stopPropagation();\n            $('.hide-div', dom).attr(\"treeNodeData\", JSON.stringify(treeNode));\n          }\n        }\n      };\n      return setting1;\n    }\n\n    $(dom).removeClass('form-readOnly');\n\n    if (mode == 'editable') {\n      if (mspPreview == 'true') {\n        $(dom).html(previewHtml);\n      } else {\n        if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n          $(dom).html(viewHtml_phone).append(treeHtml);\n        } else {\n          $(dom).html(viewHtml).append(treeHtml);\n        }\n\n        $(dom).css({\n          position: 'relative'\n        });\n        dropdownTree($(\".input-dropdown-tree\", dom)[0]);\n        A.use(__basePath + '_libs/plugins/zTree/js/jquery.ztree.all.js', function () {\n          default_ztree = $.fn.zTree.init($(dom).find(\"ul.ztree\"), getSetting(dom));\n        });\n      }\n    } else if (mode == 'readOnly') {\n      $(dom).addClass('form-readOnly');\n      $(dom).html(readonlyHtml); // 获取当前登录人机构节点信息\n\n      var orgId = '';\n\n      if (isUserMechanism == 'orgId' || isUserMechanism == 'true') {\n        orgId = SUI.Util.context.user.userOrgId;\n\n        if (!orgId) {\n          orgId = Coreplus.getUserContext() && Coreplus.getUserContext().userOrgId;\n        }\n      } else if (isUserMechanism == 'mainOrgId') {\n        orgId = SUI.Util.context.user.EXTEND_ORG2_ID;\n\n        if (!orgId) {\n          orgId = Coreplus.getUserContext() && Coreplus.getUserContext().EXTEND_ORG2_ID;\n        }\n      } // var userOrgNameNormal =  Coreplus.getUserContext() && Coreplus.getUserContext().userOrgName;// 没有流程时获取登录人机构使用（如普通提交表单）\n\n\n      if (isUserMechanism && orgId) {\n        getUserInfo();\n      }\n    } else if (mode == 'hide') {\n      $(dom).html(viewHtml).append(treeHtml).hide();\n    } // 获取当前登录人机构节点信息\n\n\n    function getUserInfo() {\n      var orgId = '';\n\n      if (isUserMechanism == 'orgId' || isUserMechanism == 'true') {\n        orgId = SUI.Util.context.user.userOrgId;\n\n        if (!orgId) {\n          orgId = Coreplus.getUserContext() && Coreplus.getUserContext().userOrgId;\n        }\n      } else if (isUserMechanism == 'mainOrgId') {\n        orgId = SUI.Util.context.user.EXTEND_ORG2_ID;\n\n        if (!orgId) {\n          orgId = Coreplus.getUserContext() && Coreplus.getUserContext().EXTEND_ORG2_ID;\n        }\n      } // var userOrgNameNormal =  Coreplus.getUserContext() && Coreplus.getUserContext().userOrgName;\n\n\n      $.ajax({\n        type: \"post\",\n        url: \"com.sudytech.portalone.base.db.queryOrganizationById.biz.ext\",\n        // url: \"com.sudytech.portalone.base.db.queryOrganization.biz.ext\",\n        // data: wf.jsonString({\n        //     // id:SUI.Util.context.user.userOrgId,\n        //     orgName: SUI.Util.context.user.userOrgName || userOrgNameNormal,\n        // }),\n        data: wf.jsonString({\n          orgId: orgId\n        }),\n        contentType: \"text/json\",\n        success: function success(data) {\n          var treeNodeData = $('.org-info:eq(0)', dom).attr(\"treeNodeData\");\n\n          if (treeNodeData) {\n            $('.org-tips', dom).hide();\n            $('.input_phone', dom).show();\n            var treeNodeData2 = filterData(JSON.parse(treeNodeData)); // $(dom).sui().setValue(treeNodeData2);\n\n            $('.org-info:eq(0)', dom).val(treeNodeData2.name);\n            $('.org-info:eq(0)', dom).attr(\"treeNodeData\", JSON.stringify(treeNodeData2));\n            $(dom).find('.input-dropdown-tree').trigger(\"change\", [treeNodeData2]);\n          } else {\n            if (isUserMechanism) {\n              if (data.out.length > 0) {\n                $('.org-tips', dom).hide();\n                $('.input_phone', dom).show(); // var returnData = recurGetMechanism(data.lis,0);\n                // returnData = returnData?returnData:data.lis[0];\n\n                var returnData = data.out[0];\n                returnData.level = level;\n                var treeNodeData2 = filterData(returnData);\n                $('.org-info:eq(0)', dom).val(treeNodeData2.name);\n                $('.org-info:eq(0)', dom).attr(\"treeNodeData\", JSON.stringify(treeNodeData2));\n                $(dom).find('.input-dropdown-tree').trigger(\"change\", [treeNodeData2]);\n              }\n            }\n          }\n\n          if ($(dom).attr('hidewrapper') == 'hide') {\n            $(dom).hide();\n          } else {\n            $(dom).show();\n          }\n        },\n        error: function error() {}\n      });\n    } // 过滤数据\n\n\n    function filterData(data) {\n      var returnObj = {\n        id: data.ORGID || data.id,\n        isParent: data.isParent || data.isParent,\n        name: data.ORGNAME || data.name,\n        sort: data.SORTNO || data.sort,\n        level: data.level || data.level || 0\n      };\n      return returnObj;\n    }\n\n    var level = 0;\n\n    function recurGetMechanism(data, i) {\n      if (data[0] && data[0].children.length != 0) {\n        level = i;\n        return recurGetMechanism(data[0].children, i + 1);\n      } else {\n        level = i;\n        return data[0];\n      }\n    }\n\n    function dropdownTree(el) {\n      $(el).click(function (event) {\n        if (SUI.Util.browserType() === 'phone') {\n          var offsetTop = $(window).scrollTop();\n          var orgSelected = $.parseJSON($(dom).find('input').attr('orgSelected').replace(/\\'/g, '\"')) || [];\n          var orgSelected2 = \"\";\n\n          if (orgSelected.length) {\n            $.each(orgSelected, function (_, v) {\n              orgSelected2 += \";\" + v.orgid + '-' + v.orgname + '-' + v.orgcode + '-' + v.sortno;\n            });\n            orgSelected2 = orgSelected2.substring(1);\n          }\n\n          var selectMulti = false;\n          var input = $(dom).find('input');\n          var url = __basePath + \"_libs/plugins/mechanism/orgSelect/list.html?selectMulti=\" + selectMulti + \"&orgSelected=\" + orgSelected2 + \"&offsetTop=\" + offsetTop;\n\n          try {\n            iPortal.openWindow(url, function (data) {\n              var orgSelected = JSON.parse(data.replace(/\\'/g, '\"')).list;\n\n              if (orgSelected.length) {\n                $('.org-tips', dom).hide();\n                $('.input_phone', dom).show();\n              } else {\n                $('.org-tips', dom).show();\n                $('.input_phone', dom).hide();\n              }\n\n              var orgNameList = \"\";\n              $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n              $.each(orgSelected, function (index, value) {\n                orgNameList += value.orgname + ',';\n              });\n\n              if (orgNameList.length > 0) {\n                orgNameList = orgNameList.substring(0, orgNameList.length - 1);\n              }\n\n              $(input).val(orgNameList);\n              $(input).attr(\"orgSelected\", JSON.stringify(orgSelected));\n              $(dom).find('.input-dropdown-tree').trigger(\"change\", [orgSelected]);\n            }, {\n              'title': '机构选择'\n            });\n          } catch (err) {}\n        } else {\n          /* PC端 展开zTree */\n          event.stopPropagation(); // 管理页面重置按钮点击时，也要将模糊搜索重置一下，这个reset是从setValue处传过来的\n\n          if (config.reset && $(dom).find(\"input[name=search-input]\").val() === '') {\n            // 设为false是为了防止重置后，再点击节点不高亮显示\n            config.reset = false;\n            $.fn.zTree.init($(dom).find(\"ul.ztree\"), getSetting(dom));\n          }\n\n          var treeObj = $('.org-info:eq(0)', dom);\n          var treeObjOffset = $('.org-info:eq(0)', dom).offset();\n\n          if (event.target.tagName.toLowerCase() === 'input' || event.target.tagName.toLowerCase() === 'span') {\n            $('.menuContent').fadeOut(\"fast\");\n          }\n\n          $(dom).css({\n            position: 'static'\n          });\n          $(\".menuContent\", dom).css({\n            left: treeObjOffset.left + 'px',\n            top: treeObjOffset.top + treeObj.outerHeight() + 'px',\n            width: treeObj.outerWidth() + 'px'\n          }).slideDown(\"fast\"); // $(\".menuContent\", dom).css({width: treeObj.outerWidth() + 'px'}).slideDown(\"fast\");\n        }\n      }); // 清空搜索框重载树\n\n      $(dom).find('#del').click(function () {\n        $(dom).find(\"input[name=search-input]\").val('');\n        $.fn.zTree.init($(dom).find(\"ul.ztree\"), getSetting(dom));\n      }); // 搜索按钮提示\n\n      $(dom).find('#search').on('click', function () {\n        var ztreeSearch = $.fn.zTree.init($('.ztree', dom), getSetting(dom, true), null);\n        search_ztree = ztreeSearch;\n      }); // 回车搜索\n\n      $(dom).find(\"input[name=search-input]\").on('keyup', function (e) {\n        if (e.keyCode === 13) {\n          var ztree = $.fn.zTree.init($('.ztree', dom), getSetting(dom, true), null);\n          search_ztree = ztree;\n        }\n      });\n      var $dropdown = $(dom).find('.dropdown-tree');\n      if (!$dropdown.length) return;\n      var $close = $(dom).find('.tree-close');\n      if (!$close.length) $close = $('<a class=\"btn btn-primary btn-sm tree-close\">确定</a>', dom).appendTo($dropdown); // 点击确定按钮，将节点信息保存起来\n\n      $close.click(function (event) {\n        event.stopPropagation();\n        $(dom).css({\n          position: 'relative'\n        });\n        var treeNodeInfo = $('.hide-div', dom).attr(\"treeNodeData\");\n        $('.org-info:eq(0)', dom).attr(\"treeNodeData\", treeNodeInfo);\n        $('.hide-div', dom).attr(\"treeNodeData\", '');\n\n        if (treeNodeInfo) {\n          treeNodeInfo = JSON.parse(treeNodeInfo);\n          $('.org-info:eq(0)', dom).val(treeNodeInfo.name);\n          $(dom).find('.input-dropdown-tree').trigger('change', [treeNodeInfo]);\n\n          if ($(dom).find('.tooltip').length) {\n            $(dom).find('.tooltip').remove();\n          }\n        }\n\n        $(dom).find(\".menuContent\").fadeOut(\"fast\");\n      });\n      $(\"body\").click(function (event) {\n        $(dom).find(\".menuContent\").fadeOut(\"fast\");\n        $(dom).css({\n          position: 'relative'\n        });\n      });\n      $('.dropdown-menu', dom).on('click', function (e) {\n        e.stopPropagation();\n      });\n    }\n  };\n\n  this.getValue = function (js) {\n    if (SUI.Util.browserType() === 'phone') {\n      var orgselected = $('.org-info:eq(0)', dom).attr(\"orgselected\") || \"[]\";\n      var treeNodeMsg = $('.org-info:eq(0)', dom).attr(\"treeNodeData\");\n\n      if (JSON.parse(orgselected) && JSON.parse(orgselected).length) {\n        orgselected = JSON.parse(orgselected)[0];\n        var obj = {};\n        obj.id = Number(orgselected.orgid) ? Number(orgselected.orgid) : '';\n        obj.isParent = orgselected.isParent == 'true' ? true : false;\n        obj.name = orgselected.orgname;\n        obj.sort = Number(orgselected.sortno);\n        obj.level = Number(orgselected.level);\n\n        if (js) {\n          return obj;\n        } else {\n          return JSON.stringify(obj);\n        }\n      } else if (treeNodeMsg) {\n        treeNodeMsg = JSON.parse(treeNodeMsg);\n        var obj = {};\n        obj.id = treeNodeMsg.id;\n        obj.isParent = treeNodeMsg.isParent;\n        obj.name = treeNodeMsg.name;\n        obj.sort = treeNodeMsg.sort;\n        obj.level = treeNodeMsg.level;\n\n        if (js) {\n          return obj;\n        } else {\n          return JSON.stringify(obj);\n        }\n      } else {\n        return '';\n      }\n    } else {\n      var treeNodeMsg = $('.org-info:eq(0)', dom).attr(\"treeNodeData\");\n\n      if (treeNodeMsg) {\n        treeNodeMsg = JSON.parse(treeNodeMsg);\n        var obj = {};\n        obj.id = treeNodeMsg.id;\n        obj.isParent = treeNodeMsg.isParent;\n        obj.name = treeNodeMsg.name;\n        obj.sort = treeNodeMsg.sort;\n        obj.level = treeNodeMsg.level;\n\n        if (js) {\n          return obj;\n        } else {\n          return JSON.stringify(obj);\n        }\n      } else {\n        return '';\n      }\n    }\n  };\n\n  this.setValue = function (val) {\n    // 这里是为了处理管理页面重置按钮点击时将模糊搜索也重置一下，思路是给一个标识reset。在setConfig的时候通过reset来判断\n    var config = this.getConfig();\n    var configs = $.extend(false, config, {\n      reset: true\n    });\n    this.setConfig(configs);\n\n    if (!val) {\n      $('.org-info:eq(0)', dom).attr(\"treeNodeData\", '');\n      $('.org-info:eq(0)', dom).val('');\n      $(dom).find(\"input[name=search-input]\").val('');\n      return;\n    }\n\n    var value = val;\n\n    if (typeof value === 'string') {\n      value = JSON.parse(value);\n    }\n\n    if (!value.id) {\n      return;\n    }\n\n    if (config.mode == 'readOnly') {\n      $('span', dom).text(value.name);\n      $('.org-info:eq(0)', dom).hide();\n    } else {\n      $('.org-info:eq(0)', dom).val(value.name);\n\n      if (SUI.Util.browserType() == 'phone') {\n        $('.org-info:eq(0)', dom).show();\n        $('.org-tips', dom).hide();\n      }\n    }\n\n    $('.org-info:eq(0)', dom).attr(\"treeNodeData\", JSON.stringify(value));\n    $(dom).find('.input-dropdown-tree').trigger('change', [value]);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = $('.org-info:eq(0)', dom).val();\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectMechanismTool/SelectMechanismTool.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectParticipates/SelectParticipates.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectParticipates/SelectParticipates.js ***!
  \**********************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return SelectParticipates; });\n/**\n * @author yangshangfei\n * @date 2019/8/6 11:15 AM\n */\n\n/**\n * 选择人员\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction SelectParticipates(bind) {\n  //dom对象\n  var dom = bind || $("<div />")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr(\'mode\'),\n      properties: {\n        mspPreview: $(el).attr(\'msppreview\')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.selectedData = {};\n  this.oldSelectedData = {};\n\n  this.handleData = function (isMulti) {\n    if (this.selectedData && this.selectedData.who) {\n      dom.zoo.oldSelectedData = $.extend(true, {}, dom.zoo.selectedData);\n      return this.selectedData;\n    }\n\n    var list = this.selectedData.list;\n    var kind = this.selectedData.kind;\n    var result = {};\n    var who = [],\n        backwho = [];\n    var obj1, obj2;\n\n    if (kind == 1 || kind == 3) {\n      $.each(list, function (index, value) {\n        obj1 = {};\n        obj2 = {};\n        obj1.id = value.EMPID;\n        obj1.name = value.EMPNAME;\n        obj1.type = value.type;\n        obj1.orginfo = value.orginfo;\n        obj2.id = value.EMPID;\n        obj2.name = value.EMPNAME;\n        obj2.type = value.type;\n        obj2.title = value.EMPNAME + \'(\' + value.EMPCODE + \')\';\n        who.push(obj1);\n        backwho.push(obj2);\n      });\n    } else {\n      $.each(list, function (index, value) {\n        obj1 = {};\n        obj2 = {};\n        obj1.id = value.POSITIONID;\n        obj1.name = value.POSINAME;\n        obj1.type = \'position\';\n        obj2.id = value.POSITIONID;\n        obj2.name = value.POSINAME;\n        obj2.type = \'position\';\n        obj2.title = value.type;\n        who.push(obj1);\n        backwho.push(obj2);\n      });\n    }\n\n    if ($.isEmptyObject(this.oldSelectedData)) {\n      this.oldSelectedData[\'who\'] = who;\n      this.oldSelectedData[\'backwho\'] = backwho;\n      this.oldSelectedData[\'offsetTop\'] = $(window).scrollTop();\n      result.who = who;\n      result.backwho = backwho;\n      result.offsetTop = $(window).scrollTop();\n    } else {\n      if (isMulti == \'true\') {\n        result.who = who.concat(dom.zoo.oldSelectedData[\'who\'].filter(function (item) {\n          return who.indexOf(item) < 0;\n        }));\n        result.backwho = backwho.concat(dom.zoo.oldSelectedData[\'backwho\'].filter(function (item) {\n          return backwho.indexOf(item) < 0;\n        }));\n      } else {\n        result.who = who;\n        result.backwho = backwho;\n      }\n\n      result.offsetTop = $(window).scrollTop();\n      dom.zoo.oldSelectedData = $.extend(true, {}, result);\n    }\n\n    return result;\n  };\n\n  this.showPersonForPhone = function () {\n    var offsetTop = $(window).scrollTop();\n    var type;\n    var selectRange = $(dom).attr("selectRange");\n    var selectMulti = $(dom).attr("selectMulti");\n    var dataType = $(dom).attr("dataType");\n    var process = $(dom).attr("process");\n    var showType = $(dom).attr("showType");\n    var activityDefID = $(dom).attr("activityDefID");\n    var headerTitle = $(dom).attr("headertitle") || $(dom).attr("title");\n    var alert = $(dom).attr("alert");\n    var isIdentityChoose = $(dom).attr(\'isIdentityChoose\');\n    var input = $(dom).parent().find(\'input\');\n    var callback = $(dom).attr("callback");\n    var displayformat = $(dom).attr(\'displayformat\');\n    var familyOrg = $(dom).attr(\'familyOrg\') == \'1\' ? \'1\' : \'0\';\n    var gwHide = \'\';\n    var showTab = $(dom).attr(\'showTab\') || "jigou,qunzu,gerenzu,gangwei";\n\n    if (dataType == \'position\') {\n      selectRange = 1;\n      showType = 2;\n    }\n\n    if ("" == headerTitle || null == headerTitle) {\n      headerTitle = "选择参与者";\n    }\n\n    if (selectRange == \'undefined\') {\n      dataType == \'emp\';\n      type = 3;\n      gwHide = false;\n    }\n\n    if (selectRange == 0) {\n      //机构、群组、个人组 和 岗位\n      if (dataType == \'emp\') {\n        type = 3;\n        gwHide = false;\n      } else if (dataType == \'position\') {\n        type = 3;\n        gwHide = false;\n      }\n    } else if (selectRange == 6) {\n      //机构、群组和个人组\n      showTab = "jigou,qunzu,gerenzu,gangwei";\n\n      if (dataType == \'emp\') {\n        type = 3;\n        gwHide = true;\n      } else if (dataType == \'position\') {\n        type = 3;\n        gwHide = true;\n      }\n    } else if (selectRange == 1) {\n      if (dataType == \'position\' && showType && showType == 2) {\n        type = 5;\n      } else {\n        type = 2;\n      }\n    } else if (selectRange == 2) {\n      if (dataType == \'position\') {\n        type = 2;\n      } else if (dataType == \'emp\') {\n        type = 1;\n      }\n    } else if (selectRange == 4) {\n      type = 4;\n    }\n\n    var lookName = "";\n    var showName = "";\n    var newData = this.handleData(selectMulti);\n    var who = newData.who;\n    var backwho = newData.backwho;\n\n    if (who.length <= 0) {\n      lookName = "请选择参与者";\n      $(\'.org-tips\', $(dom).parent()).show();\n      $(\'.input_phone\', $(dom).parent()).hide();\n    } else {\n      $(\'.org-tips\', $(dom).parent()).hide();\n      $(\'.input_phone\', $(dom).parent()).show();\n    }\n\n    $(input).attr("who", JSON.stringify(who));\n    $(input).attr("backWho", JSON.stringify(backwho));\n    var lookName_phone = \'\';\n    var showName_phone = "";\n    $.each(backwho, function (index, value) {\n      if (type == 4 || type == 2) {\n        lookName += \',\' + value.title;\n        showName += \',\' + value.name;\n        lookName_phone = backwho[0].title;\n        showName_phone = backwho[0].name;\n      } else if (type == 3 || type == 1) {\n        lookName += \',\' + value.title;\n        showName += \',\' + value.name;\n        lookName_phone = backwho[0].title;\n        showName_phone = backwho[0].name;\n      } else if (type == 5) {\n        lookName += \',\' + value.title;\n        showName += \',\' + value.name;\n        lookName_phone = backwho[0].title;\n        showName_phone = backwho[0].name;\n      }\n    });\n    lookName = lookName.substring(1);\n    showName = showName.substring(1);\n    $(dom).parent().find(\'.show-person-phone\').hide(); // $(dom).parent().find(\'.show-participate\').show();\n\n    if (wf2.isNewInPhone) {\n      if (backwho.length > 0 && selectMulti == \'true\') {\n        $(dom).parent().find(\'.show-person-phone\').show().css(\'display\', \'inline-flex\');\n        $(dom).parent().find(\'.show-participate\').hide();\n        var showHtml = \'\';\n\n        if (dataType == \'position\') {\n          showHtml = \'<span class="allperson-info-phone">\' + lookName + \'</span>\' + \'<span class="show-allperson-phone">全部</span>\';\n          $(dom).parent().find(\'.show-person-phone\').html(showHtml);\n        } else {\n          if (displayformat == \'onlyName\') {\n            showHtml = \'<span class="allperson-info-phone">\' + showName + \'</span>\' + \'<span class="show-allperson-phone">全部</span>\';\n            $(dom).parent().find(\'.show-person-phone\').html(showHtml);\n          } else {\n            showHtml = \'<span class="allperson-info-phone">\' + lookName + \'</span>\' + \'<span class="show-allperson-phone">全部</span>\';\n            $(dom).parent().find(\'.show-person-phone\').html(showHtml);\n          }\n        }\n\n        var allPersonClick = $(dom).parent().find(\'.show-allperson-phone\');\n        allPersonClick.unbind(\'click\').on(\'click\', function (e) {\n          e.stopPropagation();\n          var selected = "";\n          var input = $(dom).parent().find(\'input\');\n          var backWho = JSON.parse($(input).attr("backWho"));\n          var who = JSON.parse($(input).attr("who"));\n\n          for (var i = 0; i < backWho.length; i++) {\n            selected += ";" + backWho[i].id + ":" + backWho[i].name + ":" + backWho[i].type + ":" + backWho[i].title + \':\' + who[i].orginfo;\n          }\n\n          selected = selected.substring(1);\n          var detailUrl = __basePath + "_libs/plugins/mechanism/dist/demo/person.jsp?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n\n          if (detailUrl.length > 2047) {\n            detailUrl = __basePath + "_libs/plugins/mechanism/dist/demo/person.jsp?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n          }\n\n          localStorage.setItem(\'selected\', selected);\n\n          try {\n            iPortal.openWindow(detailUrl, function (data) {\n              dom.zoo.selectedData = JSON.parse(data);\n              dom.zoo.showPersonForPhone();\n            }, {\n              \'title\': headerTitle\n            });\n          } catch (err) {\n            console.log(err);\n          }\n        });\n      }\n    }\n\n    $(input).attr("showtitle", lookName); //根据参数displayformat 展示相应的格式\n\n    if (dataType == \'position\') {\n      $(input).val(lookName);\n    } else {\n      if (displayformat == \'onlyName\') {\n        $(input).val(showName);\n      } else {\n        $(input).val(lookName);\n      }\n    }\n\n    if ($(dom).parent().parent().hasClass(\'sui-selectpersonneltool\')) {\n      $(dom).parent().parent().trigger(\'change\', [who]);\n    }\n\n    if (callback && callback.length > 0) {\n      eval(callback);\n    }\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    var previewHtml = \'<div class="wf-parties" wf-to="ldsh" wf-from="jzgsq" activity-type="manual" wf-rollback="0"><input id="sui-selectparticipates" type="text" class="form-control" who="[]" backwho="[]" style="display:inline;width:80%;height:34px;vertical-align:middle;" placeholder="请选择参与者" readonly=""><div class="sui-selectparticipates btn btn-primary sui-component" style="width:20%;">选择</div></div>\';\n\n    if ($(dom).attr(\'mspPreview\')) {\n      if ($(dom).attr(\'mspPreview\') == \'true\') {\n        $(dom).html(previewHtml);\n        return false;\n      }\n    }\n\n    var clickDom = null;\n\n    if (SUI.Util.browserType() === \'phone\' && $(dom).parent().parent().hasClass(\'sui-selectpersonneltool\')) {\n      clickDom = $(dom).parents(\'.sui-selectpersonneltool\');\n    } else {\n      clickDom = $(dom);\n    }\n\n    clickDom.unbind(\'click\').on(\'click\', function (e) {\n      e.stopPropagation();\n\n      if (SUI.Util.browserType() === \'phone\') {\n        var offsetTop = $(window).scrollTop();\n        var type;\n        var selectRange = $(dom).attr("selectRange");\n        var selectMulti = $(dom).attr("selectMulti");\n        var dataType = $(dom).attr("dataType");\n        var process = $(dom).attr("process");\n        var showType = $(dom).attr("showType");\n        var activityDefID = $(dom).attr("activityDefID");\n        var headerTitle = $(dom).attr("headertitle") || $(dom).attr("title");\n        var alert = $(dom).attr("alert");\n        var isIdentityChoose = $(dom).attr(\'isIdentityChoose\');\n        var input = $(dom).parent().find(\'input\');\n        var callback = $(dom).attr("callback");\n        var displayformat = $(dom).attr(\'displayformat\');\n        var familyOrg = $(dom).attr(\'familyOrg\') == \'1\' ? \'1\' : \'0\';\n        var gwHide = \'\';\n        var empType = $(dom).attr("empType");\n        var personalHide = $(dom).attr("personalHide");\n        var orgId = $(dom).attr("orgId") || SUI.Util.context.user.userOrgId;\n\n        if (!orgId) {\n          try {\n            orgId = Coreplus.getUserContext() && Coreplus.getUserContext().userOrgId;\n          } catch (err) {\n            console.log(err);\n          }\n        }\n\n        var showTab = $(dom).attr(\'showTab\') || "jigou,qunzu,gerenzu,gangwei";\n\n        if (dataType == \'position\') {\n          selectRange = 1;\n          showType = 2;\n        }\n\n        if ("" == headerTitle || null == headerTitle) {\n          headerTitle = "选择参与者";\n        }\n\n        if (selectRange == \'undefined\') {\n          dataType == \'emp\';\n          type = 3;\n          gwHide = false;\n        }\n\n        if (selectRange == 0) {\n          //机构、群组、个人组 和 岗位\n          if (dataType == \'emp\') {\n            type = 3;\n            gwHide = false;\n          } else if (dataType == \'position\') {\n            type = 3;\n            gwHide = false;\n          }\n        } else if (selectRange == 6) {\n          //机构、群组和个人组\n          showTab = "jigou,qunzu,gerenzu,gangwei";\n\n          if (dataType == \'emp\') {\n            type = 3;\n            gwHide = true;\n          } else if (dataType == \'position\') {\n            type = 3;\n            gwHide = true;\n          }\n        } else if (selectRange == 1) {\n          if (dataType == \'position\' && showType && showType == 2) {\n            type = 5;\n          } else {\n            type = 2;\n          }\n        } else if (selectRange == 2) {\n          if (dataType == \'position\') {\n            type = 2;\n          } else if (dataType == \'emp\') {\n            type = 1;\n          }\n        } else if (selectRange == 4) {\n          type = 4;\n        }\n\n        var selected = \'\';\n        var who = JSON.parse($(input).attr("who"));\n        var backWho = JSON.parse($(input).attr("backWho"));\n\n        for (var i = 0; i < backWho.length; i++) {\n          selected += ";" + backWho[i].id + ":" + backWho[i].name + ":" + backWho[i].type + ":" + backWho[i].title + \':\' + who[i].orginfo;\n        }\n\n        selected = selected.substring(1);\n\n        if (alert) {\n          layer.confirm(alert, {\n            closeBtn: 0,\n            btn: [\'确定\', \'关闭\'] //可以无限个按钮\n\n          }, function (index) {\n            layer.close(index);\n            var url = __basePath + "_libs/plugins/mechanism/dist/demo/list.html?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=\'\'&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n\n            if (url.length > 2047) {\n              url = __basePath + "_libs/plugins/mechanism/dist/demo/list.html?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n            }\n\n            if (selectRange == 2 || "1" == selectRange && !showType) {\n              url = __basePath + "_libs/plugins/mechanism/dist/demo/listForOrg.html?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n            }\n\n            try {\n              iPortal.openWindow(url, function (data) {\n                dom.zoo.selectedData = JSON.parse(data);\n                dom.zoo.showPersonForPhone();\n              }, {\n                \'title\': headerTitle\n              });\n            } catch (err) {\n              location.href = url;\n            }\n          }, function (index) {\n            layer.close(index);\n          });\n        } else {\n          var url = __basePath + "_libs/plugins/mechanism/dist/demo/list.html?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=\'\'&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n\n          if (url.length > 2047) {\n            url = __basePath + "_libs/plugins/mechanism/dist/demo/list.html?process=" + process + "&title=" + headerTitle + "&activityDefID=" + activityDefID + "&type=" + type + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selectRange=" + selectRange + "&isIdentityChoose=" + isIdentityChoose + "&displayformat=" + displayformat + \'&gwHide=\' + gwHide + \'&offsetTop=\' + offsetTop + \'&familyOrg=\' + familyOrg + "&showTab=" + showTab;\n          }\n\n          if (selectRange == 2 || "1" == selectRange && !showType) {\n            url = __basePath + "_libs/plugins/mechanism/dist/demo/listForOrg.html?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n          }\n\n          try {\n            iPortal.openWindow(url, function (data) {\n              dom.zoo.selectedData = JSON.parse(data);\n              dom.zoo.showPersonForPhone();\n            }, {\n              \'title\': headerTitle\n            });\n          } catch (err) {\n            location.href = url;\n          }\n        }\n      } else {\n        var isIdentityChoose = $(dom).attr(\'isIdentityChoose\');\n        var personalHide = $(dom).attr("personalHide"); //selectRange取值 0 \'所有\' 2 \'当前登录人所在机构\' 6\'机构、群组和个人组\'，其他(1\'多人会签\'、3\'指定机构\'、4代表岗位（主要机构）)coreplus已弃用\n\n        var selectRange = $(dom).attr("selectRange");\n        var selectMulti = $(dom).attr("selectMulti");\n        var dataType = $(dom).attr("dataType"); //emp 人  position机构\n\n        var process = $(dom).attr("process");\n        var showType = $(dom).attr("showType");\n        var activityDefID = $(dom).attr("activityDefID");\n        var empType = $(dom).attr("empType");\n        var headerTitle = $(dom).attr("headertitle") || $(dom).attr("title");\n        var alert = $(dom).attr("alert");\n        var callback = $(dom).attr("callback");\n        var orgId = $(dom).attr("orgId");\n        var displayFormat = $(dom).attr(\'displayFormat\') || ""; //onlyName人名 nameId人名加工号\n\n        var familyOrg = $(dom).attr(\'familyOrg\') == \'1\' ? \'1\' : \'0\';\n        var showTab = $(dom).attr(\'showTab\') || "jigou,qunzu,gerenzu,gangwei";\n        var gwHide = \'\';\n\n        if ("" == headerTitle || null == headerTitle) {\n          headerTitle = "选择参与者";\n        }\n\n        if (dataType == \'position\') {\n          displayFormat = \'nameId\';\n        }\n\n        if (selectRange == \'6\') {\n          //机构、群组和个人组\n          selectRange = 0;\n          showTab = "jigou,qunzu,gerenzu,gangwei";\n          gwHide = true; //隐藏机构\n        } else {\n          gwHide = false;\n        }\n\n        var selected = "";\n        var input = $(this).siblings(\'input\');\n\n        var _this = this;\n\n        var orginfo = "";\n        var who = JSON.parse($(input).attr("who"));\n\n        for (var i = 0; i < who.length; i++) {\n          orginfo += ";" + who[i].orginfo;\n        }\n\n        var backWho = JSON.parse($(input).attr("backWho"));\n\n        for (var i = 0; i < backWho.length; i++) {\n          selected += ";" + backWho[i].id + ":" + backWho[i].name + ":" + backWho[i].type + ":" + backWho[i].title + \':\' + who[i].orginfo;\n        }\n\n        selected = selected.substring(1);\n        orginfo = orginfo.substring(1);\n        var selectInfo = {\n          type: "seletPerson",\n          selected: selected,\n          orginfo: orginfo\n        };\n        layer.selectInfo = selectInfo;\n        var isGoSelect = true; //IE不支持url中文传参\n\n        selected = encodeURIComponent(selected);\n        orginfo = encodeURIComponent(orginfo); //此处alert是获取选择器上配置元素的值\n\n        if (alert) {\n          layer.confirm(alert, {\n            closeBtn: 0,\n            icon: 0,\n            btn: [\'确定\', \'关闭\'],\n            //可以无限个按钮\n            success: function success() {\n              $(\'body\').addClass(\'noscroll\');\n            },\n            cancel: function cancel() {\n              $(\'body\').removeClass(\'noscroll\');\n            }\n          }, function (index, layero) {\n            $(\'body\').removeClass(\'noscroll\');\n            layer.close(index);\n            var url = __basePath + "_libs/plugins/mechanism/posiselect/select.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orginfo=" + orginfo + "&personalHide=" + personalHide + "&isIdentityChoose=" + isIdentityChoose + \'&gwHide=\' + gwHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n            var area = ["900px", "512px"];\n\n            if ("2" == selectRange || "1" == selectRange && !showType) {\n              isGoSelect = false;\n              url = __basePath + "_libs/plugins/mechanism/posiselect/select2.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n              area = ["670px", "512px"];\n            }\n\n            if (url.length > 2047) {\n              url = __basePath + "_libs/plugins/mechanism/posiselect/select.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&empType=" + empType + "&orginfo=" + orginfo + "&personalHide=" + personalHide + "&isIdentityChoose=" + isIdentityChoose + \'&gwHide=\' + gwHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n\n              if ("2" == selectRange || "1" == selectRange && !showType) {\n                isGoSelect = false;\n                url = __basePath + "_libs/plugins/mechanism/posiselect/select2.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n              }\n\n              localStorage.setItem(\'selected\', selected);\n            }\n\n            var index = layer.open({\n              type: 2,\n              title: headerTitle,\n              area: area,\n              content: url,\n              btn: [\'确定\', \'取消\'],\n              success: function success() {\n                $(\'body\').addClass(\'noscroll\');\n              },\n              yes: function yes() {\n                $(\'body\').removeClass(\'noscroll\');\n                var selected = $($("#layui-layer-iframe" + index)[0].contentWindow.document.getElementById("selectedTree")).children();\n                var who = [];\n                var backWho = [];\n                var lookName = "";\n                var lookOnlyName = \'\';\n                $(selected).each(function (index, element) {\n                  var opt = {};\n                  var opt1 = {};\n                  opt.id = $(element).attr("id");\n                  opt.name = $(element).attr("name");\n                  opt.type = $(element).attr("dataType");\n                  opt.orginfo = $(element).attr("orginfo");\n\n                  if (isGoSelect) {\n                    lookName += "," + $(element).attr("s_title");\n                    opt1.title = $(element).attr("s_title");\n                  } else {\n                    lookName += "," + $(element).attr("showtitle");\n                    opt1.title = $(element).attr("showtitle");\n                  }\n\n                  opt1.id = $(element).attr("id");\n                  opt1.name = $(element).attr("name");\n                  opt1.type = $(element).attr("dataType");\n                  who.push(opt);\n                  backWho.push(opt1);\n                });\n\n                for (var k = 0; k < who.length; k++) {\n                  lookOnlyName += \',\' + who[k].name;\n                }\n\n                lookName = lookName.substring(1);\n                lookOnlyName = lookOnlyName.substring(1);\n\n                if (who.length <= 0) {\n                  lookName = "";\n                }\n\n                $(input).attr("who", JSON.stringify(who));\n                $(input).attr("backWho", JSON.stringify(backWho));\n                $(input).attr("title", lookName);\n                $(input).attr("value", lookName);\n\n                if ($(dom).parent().parent().hasClass(\'sui-selectpersonneltool\')) {\n                  $(dom).parent().parent().trigger(\'change\', [who]);\n                }\n\n                $(\'body\').removeClass(\'noscroll\');\n                layer.close(index);\n\n                if (callback && callback.length > 0) {\n                  eval(callback);\n                }\n              },\n              btn2: function btn2() {\n                $(\'body\').removeClass(\'noscroll\');\n              }\n            });\n          }, function (index) {\n            $(\'body\').removeClass(\'noscroll\');\n            layer.close(index);\n          });\n        } else {\n          var url = __basePath + "_libs/plugins/mechanism/posiselect/select.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orginfo=" + orginfo + "&personalHide=" + personalHide + "&isIdentityChoose=" + isIdentityChoose + \'&gwHide=\' + gwHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n          var area = ["900px", "512px"];\n\n          if ("2" == selectRange || "1" == selectRange && !showType) {\n            isGoSelect = false;\n            url = __basePath + "_libs/plugins/mechanism/posiselect/select2.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&selected=" + selected + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n            area = ["670px", "512px"];\n          }\n\n          if (url.length > 2047) {\n            url = __basePath + "_libs/plugins/mechanism/posiselect/select.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&empType=" + empType + "&orginfo=" + orginfo + "&personalHide=" + personalHide + "&isIdentityChoose=" + isIdentityChoose + \'&gwHide=\' + gwHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n\n            if ("2" == selectRange || "1" == selectRange && !showType) {\n              isGoSelect = false;\n              url = __basePath + "_libs/plugins/mechanism/posiselect/select2.jsp?process=" + process + "&activityDefID=" + activityDefID + "&type=" + selectRange + "&selectMulti=" + selectMulti + "&dataType=" + dataType + "&empType=" + empType + "&orgId=" + orgId + "&personalHide=" + personalHide + "&familyOrg=" + familyOrg + "&showTab=" + showTab;\n            }\n\n            localStorage.setItem(\'selected\', selected);\n          }\n\n          var index = layer.open({\n            type: 2,\n            title: headerTitle,\n            area: area,\n            content: url,\n            btn: [\'确定\', \'取消\'],\n            success: function success() {\n              $(\'body\').addClass(\'noscroll\');\n            },\n            cancel: function cancel() {\n              $(\'body\').removeClass(\'noscroll\');\n              layer.close(index);\n            },\n            yes: function yes() {\n              var selected = $($("#layui-layer-iframe" + index)[0].contentWindow.document.getElementById("selectedTree")).children();\n              var who = [];\n              var backWho = [];\n              var lookName = "";\n              var lookOnlyName = \'\';\n              $(selected).each(function (i, element) {\n                var opt = {};\n                var opt1 = {};\n                opt.id = $(element).attr("id");\n                opt.name = $(element).attr("name");\n                opt.type = $(element).attr("dataType");\n                opt.orginfo = $(element).attr("orginfo");\n\n                if (isGoSelect) {\n                  lookName += "," + $(element).attr("s_title");\n                  opt1.title = $(element).attr("s_title");\n                } else {\n                  lookName += "," + $(element).attr("showtitle");\n                  opt1.title = $(element).attr("showtitle");\n                }\n\n                opt1.id = $(element).attr("id");\n                opt1.name = $(element).attr("name");\n                opt1.type = $(element).attr("dataType");\n                who.push(opt);\n                backWho.push(opt1);\n              });\n\n              for (var k = 0; k < who.length; k++) {\n                lookOnlyName += \',\' + who[k].name;\n              }\n\n              lookName = lookName.substring(1);\n              lookOnlyName = lookOnlyName.substring(1);\n\n              if (who.length <= 0) {\n                lookName = "";\n              }\n\n              $(input).attr("who", JSON.stringify(who));\n              $(input).attr("backWho", JSON.stringify(backWho));\n              $(input).attr("title", lookName);\n\n              if (displayFormat === \'onlyName\') {\n                $(input).attr("value", lookOnlyName);\n              } else {\n                $(input).attr("value", lookName);\n              }\n\n              if ($(dom).parent().parent().hasClass(\'sui-selectpersonneltool\')) {\n                $(dom).parent().parent().trigger(\'change\', [who]);\n              }\n\n              $(\'body\').removeClass(\'noscroll\');\n              layer.close(index);\n\n              if (callback && callback.length > 0) {\n                eval(callback); //                        \tcallback();\n              }\n            },\n            btn2: function btn2(index) {\n              $(\'body\').removeClass(\'noscroll\');\n              layer.close(index);\n            }\n          });\n        }\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectParticipates/SelectParticipates.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectPersonnelTool/SelectPersonnelTool.js":
/*!************************************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectPersonnelTool/SelectPersonnelTool.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return SelectPersonnelTool; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:57 PM\n */\n\n/**\n * 人员选择器\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction SelectPersonnelTool(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var showTab = $(el).attr('showTab');\n\n    if (showTab && typeof showTab == 'string') {\n      showTab = showTab.replace(/\\'/g, \"\\\"\");\n\n      try {\n        showTab = JSON.parse(showTab);\n        showTab = showTab.join(',');\n      } catch (error) {\n        showTab = showTab.split(',');\n        showTab = showTab.join(',');\n      }\n    }\n\n    var conf = {\n      mode: $(el).attr('mode'),\n      validate: SUI.Util.parseJSON($(el).attr(\"validate\"), true),\n      hidewrapper: $(el).attr('hidewrapper') || 'show',\n      properties: {\n        mspPreview: $(el).attr('mspPreview') || false,\n        name: $(el).attr('name'),\n        mode: $(el).attr('mode') || 'editable',\n        selectRange: $(el).attr('selectRange'),\n        dataType: $(el).attr('dataType') || 'emp',\n        selectMulti: $(el).attr('selectMulti') || true,\n        callback: $(el).attr('callback'),\n        alert: $(el).attr('alert') || '',\n        orgId: $(el).attr('orgId') || '',\n        process: $(el).attr('process'),\n        activityDefID: $(el).attr('activityDefID'),\n        headerTitle: $(el).attr('headertitle') || $(el).attr('title'),\n        displayFormat: $(el).attr('displayFormat') || 'onlyName',\n        isIdentityChoose: $(el).attr('isIdentityChoose') || 'false',\n        //是否人员身份筛选\n        initValueType: $(el).attr('initValueType') == 'undefined' ? 'userInfo' : $(el).attr('initValueType'),\n        //默认值类型\n        initValue: $(el).attr('initValue') == 'undefined' ? '' : $(el).attr('initValue'),\n        //类型为userInfo时的值，默认为无\n        empNo: $(el).attr('empNo') == 'undefined' ? '' : $(el).attr('empNo'),\n        showTab: showTab ? showTab : \"jigou,qunzu,gerenzu,gangwei\",\n        //选择展示的Tab\n        emptype: $(el).attr('emptype')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    this.name = config.properties.name;\n    var mode = config.properties.mode || 'view';\n    var mspPreview = config.properties.mspPreview;\n    var selectRange = config.properties.selectRange;\n    var dataType = config.properties.dataType;\n    var selectMulti = config.properties.selectMulti;\n    var callback = config.properties.callback;\n    var alert = config.properties.alert;\n    var orgId = config.properties.orgId;\n    var process = config.properties.process;\n    var emptype = config.properties.emptype;\n    var activityDefID = config.properties.activityDefID;\n    var set_title = config.properties.headerTitle;\n    var headerTitle = set_title ? set_title : dataType === 'emp' ? '请选择人员' : '请选择岗位';\n    var displayFormat = config.properties.displayFormat;\n    var isIdentityChoose = config.properties.isIdentityChoose; // 递归查询配置\n\n    var familyOrg = config.sysConfig && config.sysConfig.FAMILYORG == '1' ? '1' : '0';\n    var showTab = config.properties.showTab; //  如果是dataTable中的控件\n\n    if (showTab && typeof showTab == 'string') {\n      showTab = showTab.replace(/\\\"/g, \"'\");\n    }\n\n    var viewHtml = '<div class=\"input-group\">\\\n                <input  type=\"text\" class=\"form-control show-participate\" who=\"[]\" backWho=\"[]\"  placeholder=\"请选择\" readonly=\"\">\\\n                <span class=\"sui-selectparticipates show-participate-info input-group-addon\"  selectRange=\"' + selectRange + '\" displayFormat=\"' + displayFormat + '\"isIdentityChoose=\"' + isIdentityChoose + '\" dataType=\"' + dataType + '\" selectMulti=\"' + selectMulti + '\" callback=\"' + callback + '\" headertitle=\"' + headerTitle + '\" alert=\"' + alert + '\" orgId=\"' + orgId + '\" process=\"' + process + '\" activityDefID=\"' + activityDefID + '\" familyOrg=\"' + familyOrg + '\" emptype=\"' + emptype + '\" showTab=\"' + showTab + '\">选择</span>\\\n                </div>';\n    var viewHtml_phone = '<div class=\"input-group input-group-phone\">' + '<input type=\"text\"  class=\"input_phone input-hide show-participate\" who=\"[]\" backWho=\"[]\" readonly>' + '<span class=\"sui-selectparticipates show-participate-info  org-tips\"  selectRange=\"' + selectRange + '\" displayFormat=\"' + displayFormat + '\"isIdentityChoose=\"' + isIdentityChoose + '\" dataType=\"' + dataType + '\" selectMulti=\"' + selectMulti + '\" callback=\"' + callback + '\" headertitle=\"' + headerTitle + '\" alert=\"' + alert + '\" orgId=\"' + orgId + '\" process=\"' + process + '\" activityDefID=\"' + activityDefID + '\" familyOrg=\"' + familyOrg + '\" showTab=\"' + showTab + '\" emptype=\"' + emptype + '\">请选择</span>' + '<div class=\"show-person-phone\"></div>' + '<span class=\"org-arrow\"></span>' + '</div>';\n    var viewReadonlyHtml = '<div class=\"input-group value-text\">\\\n                <span class=\"\" id=\"value_' + this.name + '\" backwho=\"\" ></span>\\\n                </div>';\n    var initValueType = config.properties.initValueType;\n    var initValue = config.properties.initValue;\n    var empNo = config.properties.empNo;\n    var isUserPersonnel = false;\n    var params = {\n      empType: 'emp'\n    };\n\n    if (initValueType == 'userInfo' && initValue) {\n      isUserPersonnel = true;\n\n      switch (initValue) {\n        case 'USER':\n          // 当前登录人\n          params.keyword = SUI.Util.context.user.attributes ? SUI.Util.context.user.attributes.EXTEND_USER_ID : ''; // params.orgId = SUI.Util.context.user.userOrgId;\n          // 普通提交表单通过Coreplus.getUserContext()取得登录人信息\n\n          if (!params.keyword) params.keyword = Coreplus.getUserContext() ? Coreplus.getUserContext().EXTEND_USER_ID : '';\n          break;\n\n        case 'BZRGH':\n          //当前登录人班主任\n          params.keyword = SUI.Util.context.user.attributes ? SUI.Util.context.user.attributes.BZRGH ? SUI.Util.context.user.attributes.BZRGH : '' : ''; // params.orgId = SUI.Util.context.user.userOrgId;\n\n          if (!params.keyword) params.keyword = Coreplus.getUserContext() ? Coreplus.getUserContext().BZRGH : '';\n          break;\n\n        case 'FDYGH':\n          //当前登录人辅导员\n          params.keyword = SUI.Util.context.user.attributes ? SUI.Util.context.user.attributes.FDYGH ? SUI.Util.context.user.attributes.FDYGH : '' : ''; // params.orgId = SUI.Util.context.user.userOrgId;\n\n          if (!params.keyword) params.keyword = Coreplus.getUserContext() ? Coreplus.getUserContext().FDYGH : '';\n          break;\n\n        default:\n          params.keyword = SUI.Util.context.user.attributes ? SUI.Util.context.user.attributes.EXTEND_USER_ID : '';\n          if (!params.keyword) params.keyword = Coreplus.getUserContext() ? Coreplus.getUserContext().EXTEND_USER_ID : '';\n          break;\n      }\n    }\n\n    if (initValueType == 'empNo' && empNo) {\n      isUserPersonnel = true;\n      params.keyword = empNo;\n    }\n\n    if (mode === 'editable') {\n      $(dom).removeClass('form-readOnly');\n\n      if (SUI.Util.browserType() === 'phone' && wf2.isNewInPhone) {\n        $(dom).html(viewHtml_phone);\n        $(dom).find('.show-person-phone').hide();\n      } else {\n        $(dom).html(viewHtml);\n      }\n\n      SUI.init($.noop(), $(dom));\n\n      if (mspPreview === 'true') {\n        $(dom).html(viewHtml);\n      }\n\n      if (isUserPersonnel) {\n        var that = this;\n        $(dom).hide();\n        $.ajax({\n          type: \"POST\",\n          url: \"com.sudytech.portalone.base.role.role.queryEnableUserByCode.biz.ext\",\n          data: wf.jsonString({\n            pagecond: {\n              isCount: false,\n              length: 1000\n            },\n            empCode: params.keyword,\n            querySqlId: 2\n          }),\n          contentType: \"text/json\",\n          success: function success(data) {\n            if (data.out && data.out.length > 0) {\n              var res = data.out[0];\n              var who = JSON.parse($(dom).find('input.show-participate').attr('who'));\n              var backWho = JSON.parse($(dom).find('input.show-participate').attr('backWho'));\n\n              if (who.length == 0 && backWho.length == 0) {\n                var val_str = JSON.stringify([{\n                  id: res.EMPID,\n                  name: res.EMPNAME,\n                  type: 'emp',\n                  orginfo: res.ORGID + ',' + res.POSINAMES,\n                  title: res.EMPNAME + '(' + res.EMPCODE + ')'\n                }]);\n                that.setValue(val_str);\n              }\n            }\n\n            if ($(dom).attr('hidewrapper') == 'hide') {\n              $(dom).hide();\n            } else {\n              $(dom).show();\n            }\n          },\n          error: function error() {}\n        });\n      }\n      /* 点击input框触发选择按钮事件 */\n\n\n      $(dom).find('input').on('click', function () {\n        $(this).parent().find('span.sui-selectparticipates').trigger('click');\n      });\n    } else if (mode === 'readOnly' || mode === 'view') {\n      $(dom).addClass('form-readOnly');\n      $(dom).html(viewReadonlyHtml);\n      SUI.init($.noop(), $(dom));\n\n      if (isUserPersonnel) {\n        $.ajax({\n          type: \"POST\",\n          url: \"com.sudytech.portalone.base.role.role.queryEnableUserByCode.biz.ext\",\n          data: wf.jsonString({\n            pagecond: {\n              isCount: false,\n              length: 1000\n            },\n            empCode: params.keyword,\n            querySqlId: 2\n          }),\n          contentType: \"text/json\",\n          success: function success(data) {\n            if (data.out && data.out.length > 0) {\n              var res = data.out[0]; //如果是空字符串表示第一次进入页面 默认显示当前登录人 []表示用户没有选择任何人员\n\n              if (!$(dom).find(\"span\").attr('backwho')) {\n                var who = [{\n                  id: res.EMPID,\n                  name: res.EMPNAME,\n                  type: 'emp',\n                  orginfo: res.ORGID + ',' + res.POSINAMES\n                }];\n                var backWho = [{\n                  id: res.EMPID,\n                  name: res.EMPNAME,\n                  type: 'emp',\n                  title: res.EMPNAME + '(' + res.EMPCODE + ')'\n                }];\n                $(dom).find('.input-group span').attr('who', JSON.stringify(who));\n                $(dom).find('.input-group span').attr('backWho', JSON.stringify(backWho));\n                $(dom).find('.input-group span').attr('title', backWho[0].title);\n                $(dom).find('.input-group span').text(backWho[0].name);\n              }\n            }\n          },\n          error: function error() {}\n        });\n      }\n    } else if (mode == 'hide') {\n      $(dom).html(viewReadonlyHtml).hide();\n    }\n  };\n\n  this.getValue = function () {\n    var mode = config.properties.mode;\n    var val = \"\",\n        val_backwho,\n        val_who;\n\n    if (mode === 'editable') {\n      val_backwho = JSON.parse($(dom).find('input').attr('backwho') || \"[]\");\n      val_who = JSON.parse($(dom).find('input').attr('who') || \"[]\");\n      $.each(val_who, function (_, v) {\n        $.each(val_backwho, function (_, v2) {\n          if (v.id == v2.id) {\n            v.title = v2.title;\n          }\n        });\n      });\n      val = JSON.stringify(val_who);\n    } else {\n      val_backwho = JSON.parse($(dom).find('span').attr('backwho') || \"[]\");\n      val_who = JSON.parse($(dom).find('span').attr('who') || \"[]\");\n      $.each(val_who, function (_, v) {\n        $.each(val_backwho, function (_, v2) {\n          if (v.id == v2.id) {\n            v.title = v2.title;\n          }\n        });\n      });\n      val = JSON.stringify(val_who);\n    }\n\n    return val;\n  };\n\n  this.setValue = function (val) {\n    var value = val;\n    var mode = config.properties.mode;\n    var displayFormat = config.properties.displayFormat; // 解决塞入空值时报错问题\n\n    if (!val) {\n      return;\n    }\n\n    if (typeof value == 'string') {\n      if (value.indexOf('[{') > -1) {\n        value = JSON.parse(value);\n      } else {\n        return;\n      }\n    }\n\n    var showList = '';\n    var showName = '';\n    var who = [],\n        backwho = [];\n\n    for (var i = 0; i < value.length; i++) {\n      showList += value[i].title;\n      showName += \",\" + value[i].name;\n      var json = {},\n          json2 = {};\n      json.id = value[i].id;\n      json.name = value[i].name;\n      json.type = value[i].type;\n\n      if (value[i].orginfo) {\n        json.orginfo = value[i].orginfo;\n      }\n\n      who.push(json);\n      json2.id = value[i].id;\n      json2.name = value[i].name;\n      json2.type = value[i].type;\n      json2.title = value[i].title;\n      backwho.push(json2);\n    }\n\n    if (mode === 'editable') {\n      if (displayFormat === 'onlyName') {\n        $(dom).find('input').attr('value', showName.substring(1));\n      } else {\n        $(dom).find('input').attr('value', showList);\n      }\n\n      $(dom).find('input').attr('title', showList);\n      $(dom).find('input').attr(\"who\", JSON.stringify(who));\n      $(dom).find('input').attr('backWho', JSON.stringify(backwho));\n      $('.org-tips', dom).hide();\n      $('.input_phone', dom).show();\n    } else {\n      if (displayFormat === 'onlyName') {\n        $(dom).find('span').text(showName.substring(1));\n      } else {\n        $(dom).find('span').text(showList);\n      }\n\n      $(dom).find('span').attr('backWho', JSON.stringify(backwho));\n      $(dom).find('span').attr('who', JSON.stringify(who));\n    }\n\n    $(dom).trigger('change', [who]);\n  };\n\n  this.validate = function () {\n    var mode = config.mode || 'view';\n    $(dom).removeClass(SUI.Util.validateClass());\n\n    if (mode != \"editable\") {\n      return true;\n    }\n\n    var validate = config.validate;\n    var value = JSON.parse($(dom).find('input').attr('who'));\n    var result = SUI.Util.validate.call(dom, validate, value);\n    $(dom).addClass(SUI.Util.validateClass(result));\n    return result;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectPersonnelTool/SelectPersonnelTool.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/StopWf/StopWf.js":
/*!**********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/StopWf/StopWf.js ***!
  \**********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return StopWf; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:31 PM\n */\n\n/**\n * 管理-终止\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction StopWf(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      className: $(el).attr('className') || 'btn-primary',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<a class=\"btn ' + config.className + ' btn-sm\">终止</a>';\n    $(dom).append(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      var delData = [];\n      $('.sui-tablelist tbody tr td:first-child input[type=\"checkbox\"]:checked').each(function () {\n        delData.push($(this).val());\n      });\n      var rowData = $('.sui-tablelist').sui().getSelectedData();\n      var isEnd = false;\n      $.each(rowData, function (_, v) {\n        $.each(delData, function (_, v2) {\n          if (v.processInstId && v.processInstId == v2) {\n            if (v.lczt == '3' || v.lczt == '2' || v.lczt == '已完结' || v.lczt == '已终止') {\n              isEnd = true; //    layer.alert('您所选流程中包含已完结或已终止的流程，该流程不可进行终止操作！');\n\n              SUI.Util.layerAlert({\n                content: '您所选流程中包含已完结或已终止的流程，该流程不可进行终止操作！'\n              });\n              return false;\n            }\n          }\n        });\n      });\n\n      if (isEnd) {\n        return false;\n      }\n\n      if (delData.length == 0) {\n        // layer.alert('请至少选择一项');\n        SUI.Util.layerAlert({\n          content: '请至少选择一项'\n        });\n        return;\n      }\n\n      layer.confirm('确定要终止所选流程吗？', {\n        btn: ['终&nbsp;止', '取&nbsp;消'] //可以无限个按钮\n\n      }, function (index, layero) {\n        //按钮【按钮一】的回调\n        layer.close(index);\n\n        if (delData.length != 0) {\n          var param = {\n            'param': delData // 'lczt':{'lczt':3}\n\n          };\n          $.ajax({\n            url: 'com.sudytech.portalone.base.workflow.terminationProcessInst.biz.ext',\n            type: 'post',\n            data: JSON.stringify(param),\n            contentType: 'text/json',\n            success: function success(data) {\n              if (data.result == 1) {\n                // alert('流程终止成功');\n                SUI.Util.layerAlert({\n                  content: '流程终止成功'\n                });\n                $('.sui-tablelist').sui().tableApi().ajax.reload(function () {}, false);\n              } else {\n                // alert('流程终止失败，请联系管理员！');\n                SUI.Util.layerAlert({\n                  content: '流程终止失败，请联系管理员！'\n                });\n              }\n            }\n          });\n        }\n      }, function (index) {\n        layer.close(index);\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/StopWf/StopWf.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Submit/Submit.js":
/*!**********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Submit/Submit.js ***!
  \**********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Submit; });\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:24 AM\n */\n\n/**\n * 流程提交控件\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Submit(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      },\n      successInfo: $(el).attr('successinfo') || '提交成功',\n      confirmSubmit: $(el).attr('confirmsubmit') || 'false',\n      confirmInfo: $(el).attr('confirmInfo') || '',\n      hidewrapper: $(dom).attr('hidewrapper') || 'show'\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    var processinstname = config.processDef == null ? \"流程\" : config.processDef.processChName;\n    $(dom).addClass('no-print isBtn');\n    $(dom).empty();\n    var html = '<a class=\"btn btn-primary\">提交</a>';\n    $(dom).html(html);\n    var btn = $(dom).find('a');\n    var finished;\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        $(dom).css(\"display\", \"inline-block\");\n        return false;\n      }\n    } //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n\n    if (!config.wfConfig) {\n      $(dom).hide();\n      return;\n    }\n\n    if (config.wfConfig.mode == 'preview' || config.wfConfig.mode == 'print') {\n      $(dom).hide();\n      return;\n    }\n\n    if (!config.wfConfig.workItemId && !config.wfConfig.process && config.wfConfig.mode != 'modify') {\n      $(dom).hide();\n      return;\n    }\n\n    if (config.wfConfig.mode == 'modify') {\n      $(dom).find('a').text('保存');\n    }\n\n    $(dom).css(\"display\", \"inline-block\");\n\n    if (config.hidewrapper == 'hide') {\n      $(dom).hide();\n    }\n\n    btn.click(function () {\n      var layerTool = layer;\n      var coreplusLoad = layerTool.load(2, {\n        shade: [0.1, '#000']\n      });\n\n      if (finished) {\n        //关闭loading\n        layerTool.close(coreplusLoad); // layerTool.alert(\"已经成功提交, 无需重复提交\");\n\n        SUI.Util.layerAlert({\n          content: '已经成功提交, 无需重复提交'\n        });\n        return;\n      }\n\n      var wfConfig = config.wfConfig;\n\n      if (wfConfig.mode == 'modify') {\n        layer.close(coreplusLoad);\n        var entityData = $(\".sui-form\").sui().getValue();\n        entityData = $.extend(wf2.entity, entityData, true);\n        entityData.__type = 'sdo:' + wf2.workflow.processDefExt.entity;\n        wf2.modifyProcessData(entityData, config.processDef.processDefName); //关闭loading\n\n        layerTool.close(coreplusLoad);\n        return;\n      } //验证表单非空\n\n\n      var suiForm = $(\".sui-form\").sui();\n\n      if (!$(\".sui-form\")[0].zoo.validate()) {\n        //关闭loading\n        layerTool.close(coreplusLoad); // layerTool.alert(\"验证失败，请检查\");\n\n        if (SUI.Util.browserType() === 'pc') {\n          SUI.Util.layerAlert({\n            content: '验证失败，请检查'\n          });\n        }\n\n        return;\n      }\n\n      var entity = suiForm.getValue();\n      var steps;\n\n      if ($(\".sui-participates\").length > 0) {\n        steps = $(\".sui-participates\").sui().getValue();\n      } else if ($(\".sui-moreparticipates\").length > 0) {\n        steps = $(\".sui-moreparticipates\").sui().getValue();\n      } else if ($(\".sui-newparticipants\").length > 0) {\n        steps = $(\".sui-newparticipants\").sui().getValue();\n      }\n\n      if (!steps.length) {\n        layerTool.close(coreplusLoad);\n        var p_title = SUI.Util.getParticipateTitle();\n        SUI.Util.layerAlert({\n          content: p_title\n        });\n        return;\n      }\n\n      var sendMessage = \"\";\n\n      if ($(\".sui-checksendmsg\").length > 0) {\n        sendMessage = $(\".sui-checksendmsg\").sui().getValue();\n      }\n\n      var relativeData = {\n        sudyKeys: {\n          steps: steps\n        }\n      }; //判断是否存在变量\n\n      if (\"undefined\" != typeof customData) {\n        var submitData = customData ? customData : '';\n\n        if (submitData && submitData['sui-submit']) {\n          var customValidate = submitData['sui-submit'];\n          customValidate = customValidate.replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\r\\n').replace(/&semicolon;/g, \"\\;\");\n          var ValidateFun = new Function(customValidate);\n\n          try {\n            var issubmit = ValidateFun(); //如果校验不通过\n\n            if (issubmit == false) {\n              //关闭loading\n              layerTool.close(coreplusLoad);\n              return;\n            }\n          } catch (error) {\n            //关闭loading\n            layerTool.close(coreplusLoad); // layer.alert('自定义校验代码编写错误，请检查！'+ \"<br>\" + '错误原因：' + error.message);\n\n            SUI.Util.layerAlert({\n              content: '自定义校验代码编写错误，请检查！' + \"<br>\" + '错误原因：' + error.message\n            });\n            return;\n          }\n        }\n      }\n\n      if (config.confirmSubmit && config.confirmSubmit === 'true') {\n        var confirmCode = config.confirmInfo;\n        confirmCode = confirmCode.replace(/&#39;/g, \"\\'\").replace(/&#34;/g, \"\\\"\").replace(/&#8629;/g, '\\r\\n').replace(/&semicolon;/g, \"\\;\").replace(/↵/g, '');\n        var confirmInfo = '';\n\n        try {\n          // var confirmInfoFun = new Function(confirmCode);\n          confirmInfo = eval('(function(){' + confirmCode + '})()');\n        } catch (error) {\n          console.log('确认提示信息代码有误');\n        }\n\n        layer.open({\n          content: confirmInfo || '信息无误，确认提交？',\n          btn: ['确认', '取消'],\n          yes: function yes(index) {\n            layer.close(index);\n            $(dom).trigger(\"beforeSumbit\", [entity, relativeData]);\n            $(dom).trigger(\"beforeSubmit\", [entity, relativeData]);\n            var draftDom = $('.sui-draft');\n\n            if (draftDom) {\n              var draftId = draftDom.attr('did') || '';\n            }\n\n            if (wfConfig.workItemId) {\n              //完成工作项\n              entity = wf2.merge(entity); //合并\n\n              wf2.finishWorkItem({\n                draftId: draftId ? draftId : 0,\n                entity: entity,\n                relativeData: relativeData,\n                sendMessage: sendMessage\n              }, function (data) {\n                if (data.exception) {\n                  //关闭loading\n                  layerTool.close(coreplusLoad);\n                  SUI.Util.layerAlert({\n                    content: data.exception ? _typeof(data.exception) === 'object' ? JSON.stringify(data.exception) : data.exception : '提交失败,请联系管理员！'\n                  });\n                } else {\n                  finished = true;\n                  btn.attr('disabled', true);\n                  $(dom).trigger(\"afterSumbit\", data);\n                  $(dom).trigger(\"afterSubmit\", data); //关闭loading\n\n                  layerTool.close(coreplusLoad);\n                  config.successInfo = $(dom).attr('successinfo') || '提交成功';\n\n                  if (data && data.resultMap) {\n                    if (!data.resultMap.cancommit) {\n                      config.successInfo = data.resultMap.result;\n                    }\n                  }\n\n                  layerTool.alert(config.successInfo, function (index) {\n                    $.isFunction(config.callback) && config.callback();\n                    layerTool.close(index);\n\n                    if (config.wfConfig.closeable == 'false') {\n                      window.location.reload();\n                    } else {\n                      SUI.Util.wfCloseWindow(wfConfig);\n                    }\n                  });\n                }\n              });\n            } else if (wfConfig.process) {\n              //启动流程\n              wf2.startWorkFlow({\n                draftId: draftId ? draftId : 0,\n                entity: entity,\n                relativeData: {\n                  sudyKeys: {\n                    steps: steps\n                  }\n                },\n                sendMessage: sendMessage\n              }, function (data) {\n                $(dom).trigger(\"afterSumbit\", data);\n                $(dom).trigger(\"afterSubmit\", data);\n\n                if (data.exception) {\n                  //关闭loading\n                  layerTool.close(coreplusLoad); // layerTool.alert(\"提交申请失败\");\n\n                  SUI.Util.layerAlert({\n                    content: data.exception ? _typeof(data.exception) === 'object' ? JSON.stringify(data.exception) : data.exception : '提交失败,请联系管理员！'\n                  });\n                } else {\n                  finished = true;\n                  btn.attr('disabled', true); //关闭loading\n\n                  layerTool.close(coreplusLoad);\n                  config.successInfo = $(dom).attr('successinfo') || '提交成功';\n\n                  if (data && data.resultMap) {\n                    if (!data.resultMap.cancommit) {\n                      config.successInfo = data.resultMap.result;\n                    }\n                  }\n\n                  layerTool.alert(config.successInfo, function (index) {\n                    $.isFunction(config.callback) && config.callback();\n                    layerTool.close(index);\n\n                    if (config.wfConfig.closeable == 'false') {\n                      window.location.reload();\n                    } else {\n                      SUI.Util.wfCloseWindow(wfConfig);\n                    }\n                  });\n                }\n              });\n            }\n          },\n          btn2: function btn2(index) {\n            layerTool.close(coreplusLoad);\n          },\n          cancel: function cancel(index) {\n            layerTool.close(coreplusLoad);\n          }\n        });\n        return false;\n      }\n\n      $(dom).trigger(\"beforeSumbit\", [entity, relativeData]);\n      $(dom).trigger(\"beforeSubmit\", [entity, relativeData]);\n      var draftDom = $('.sui-draft');\n\n      if (draftDom) {\n        var draftId = draftDom.attr('did') || '';\n      }\n\n      if (wfConfig.workItemId) {\n        //完成工作项\n        entity = wf2.merge(entity); //合并\n\n        wf2.finishWorkItem({\n          draftId: draftId ? draftId : 0,\n          entity: entity,\n          relativeData: relativeData,\n          sendMessage: sendMessage\n        }, function (data) {\n          if (data.exception) {\n            //关闭loading\n            layerTool.close(coreplusLoad);\n            SUI.Util.layerAlert({\n              content: data.exception ? _typeof(data.exception) === 'object' ? JSON.stringify(data.exception) : data.exception : '提交失败,请联系管理员！'\n            });\n          } else {\n            finished = true;\n            btn.attr('disabled', true);\n            $(dom).trigger(\"afterSumbit\", data);\n            $(dom).trigger(\"afterSubmit\", data); //关闭loading\n\n            layerTool.close(coreplusLoad);\n            config.successInfo = $(dom).attr('successinfo') || '提交成功';\n\n            if (data && data.resultMap) {\n              if (!data.resultMap.cancommit) {\n                config.successInfo = data.resultMap.result;\n              }\n            }\n\n            layerTool.alert(config.successInfo, function (index) {\n              $.isFunction(config.callback) && config.callback();\n              layerTool.close(index);\n\n              if (config.wfConfig.closeable == 'false') {\n                window.location.reload();\n              } else {\n                SUI.Util.wfCloseWindow(wfConfig);\n              }\n            });\n          }\n        });\n      } else if (wfConfig.process) {\n        //启动流程\n        wf2.startWorkFlow({\n          draftId: draftId ? draftId : 0,\n          entity: entity,\n          relativeData: {\n            sudyKeys: {\n              steps: steps\n            }\n          },\n          sendMessage: sendMessage\n        }, function (data) {\n          $(dom).trigger(\"afterSumbit\", data);\n          $(dom).trigger(\"afterSubmit\", data);\n\n          if (data.exception) {\n            //关闭loading\n            layerTool.close(coreplusLoad); // layerTool.alert(\"提交申请失败\");\n\n            SUI.Util.layerAlert({\n              content: data.exception ? _typeof(data.exception) === 'object' ? JSON.stringify(data.exception) : data.exception : '提交失败,请联系管理员！'\n            });\n          } else {\n            finished = true;\n            btn.attr('disabled', true); //关闭loading\n\n            layerTool.close(coreplusLoad);\n            config.successInfo = $(dom).attr('successinfo') || '提交成功';\n\n            if (data && data.resultMap) {\n              if (!data.resultMap.cancommit) {\n                config.successInfo = data.resultMap.result;\n              }\n            }\n\n            layerTool.alert(config.successInfo, function (index) {\n              $.isFunction(config.callback) && config.callback();\n              layerTool.close(index);\n\n              if (config.wfConfig.closeable == 'false') {\n                window.location.reload();\n              } else {\n                SUI.Util.wfCloseWindow(wfConfig);\n              }\n            });\n          }\n        });\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Submit/Submit.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Terminate/Terminate.js":
/*!****************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Terminate/Terminate.js ***!
  \****************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Terminate; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:14 AM\n */\n\n/**\n * 取消申请\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Terminate(bind) {\n  var dom = bind || $("<div />")[0],\n      config;\n  dom.zoo = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  };\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      lcztName: {\n        name: "lczt",\n        value: "3"\n      },\n      properties: {\n        mspPreview: $(el).attr(\'msppreview\')\n      },\n      txt: $(el).attr(\'txt\') || \'取消申请\'\n    };\n    return conf;\n  };\n\n  this.getConfig = function () {\n    return config;\n  };\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).addClass(\'isBtn\');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == \'true\') {\n        $(dom).css("display", "inline-block");\n        $(dom).html(\'<a class="btn btn-primary">\' + config.txt + \'</a>\');\n        return false;\n      }\n    }\n\n    if (!config.workItemId && !config.processInstId) {\n      $(dom).hide();\n      return;\n    }\n\n    var printmode = SUI.Util.getQueryString(\'mode\');\n\n    if (printmode != \'print\') {\n      $(dom).css("display", "inline-block");\n    }\n\n    $.ajax({\n      type: "POST",\n      url: "com.sudytech.portalone.base.ui.showTerminateBtn.biz.ext",\n      data: wf.jsonString({\n        workItemId: config.workItemId,\n        processInstId: config.processInstId\n      }),\n      contentType: "text/json",\n      success: function success(data) {\n        if (data.allow == "true") {\n          $(dom).html(\'<a class="btn btn-primary">取消申请</a>\');\n          var btn = $(dom).find(\'a\');\n          var isdone = false;\n          wf2.buildBtnForPhone();\n          btn.click(function () {\n            if (isdone) {\n              layer.alert("已取消成功", function (index) {\n                layer.close(index);\n                SUI.Util.wfCloseWindow();\n              });\n              return;\n            }\n\n            layer.confirm(\'确定取消申请？\', {\n              closeBtn: 0,\n              icon: 0,\n              btn: [\'确定\', \'关闭\'] //可以无限个按钮\n\n            }, function (index) {\n              layer.close(index);\n              $.ajax({\n                type: "POST",\n                url: "com.sudytech.portalone.base.workflow.terminateProcess.biz.ext",\n                async: false,\n                data: wf2.jsonString({\n                  workItemID: config.workItemId,\n                  processInstId: config.processInstId,\n                  lcztValue: config.lcztName.value,\n                  lcztName: config.lcztName.name\n                }),\n                contentType: "text/json",\n                success: function success(data) {\n                  if (data.msg == "success") {\n                    isdone = true;\n\n                    if (config.callback) {\n                      config.callback();\n                    } else {\n                      layer.alert("取消成功", function (index) {\n                        layer.close(index);\n                        SUI.Util.wfCloseWindow();\n                      });\n                    }\n                  } else {\n                    layer.alert(data.msg, function (index) {\n                      layer.close(index);\n                      SUI.Util.wfCloseWindow();\n                    });\n                  }\n                }\n              });\n            }, function (index) {\n              layer.close(index);\n            });\n          });\n\n          if (printmode != \'print\') {\n            $(dom).show();\n          }\n        } else {\n          $(dom).hide();\n        }\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Terminate/Terminate.js?')},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/TurnWf/TurnWf.js":
/*!**********************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/TurnWf/TurnWf.js ***!
  \**********************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return TurnWf; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:25 PM\n */\n\n/**\n * 管理-转办\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction TurnWf(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      className: $(el).attr('className') || 'btn-primary',\n      properties: {\n        mspPreview: $(el).attr('msppreview')\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n    $(dom).empty();\n    var html = '<a class=\"btn ' + config.className + ' btn-sm\">转办</a>';\n    $(dom).append(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        return false;\n      }\n    }\n\n    btn.click(function () {\n      var delData = [];\n      $('.sui-tablelist tbody tr td:first-child input[type=\"checkbox\"]:checked').each(function () {\n        delData.push($(this).val());\n      });\n\n      if (delData.length == 0) {\n        // layer.alert('请至少选择一项');\n        SUI.Util.layerAlert({\n          content: '请至少选择一项'\n        });\n        return;\n      }\n\n      layer.confirm('确定要转办所选流程吗？', {\n        btn: ['转&nbsp;办', '取&nbsp;消'] //可以无限个按钮\n\n      }, function (index, layero) {\n        //按钮【按钮一】的回调\n        layer.close(index);\n\n        if (delData.length != 0) {\n          layer.open({\n            type: 2,\n            title: '流程转办',\n            area: ['80%', '90%'],\n            content: __basePath + 'plugins/initReassign.jsp?processinstids=' + delData.toString()\n          });\n        }\n      }, function (index) {\n        layer.close(index);\n      });\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/TurnWf/TurnWf.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Untreat/Untreat.js":
/*!************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Untreat/Untreat.js ***!
  \************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Untreat; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 1:48 PM\n */\n\n/**\n * 退回\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction Untreat(bind) {\n  var dom = bind || $(\"<div />\")[0],\n      config;\n  dom.zoo = this; //初始化\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mode: $(el).attr('mode'),\n      properties: {\n        mspPreview: $(el).attr('mspPreview') || false\n      }\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    var processinstname = config.processDef == null ? \"流程\" : config.processDef.processChName;\n    $(dom).addClass('no-print');\n    $(dom).addClass('isBtn');\n    $(dom).empty();\n    var html = '<a class=\"btn btn-primary\">退回</a>';\n    $(dom).html(html);\n    var btn = $(dom).find('a');\n\n    if (config.properties.mspPreview) {\n      if (config.properties.mspPreview == 'true') {\n        $(dom).css(\"display\", \"inline-block\");\n        return false;\n      }\n    } //coreplus 预览无wfconfig,直接执行sui.init,不能在顶部根据wfconfig直接return\n\n\n    if (!config.wfConfig) {\n      $(dom).hide();\n      return;\n    }\n\n    if (config.wfConfig.mode == 'preview' || config.wfConfig.mode == 'print') {\n      $(dom).hide();\n      return;\n    }\n\n    if (config.wfConfig.mode == 'modify') {\n      $(dom).hide();\n      return;\n    } // 待办页面才允许展示\n\n\n    var url = __basePath + '_libs/plugins/unTreat/untreat.jsp';\n\n    if (config.workItem) {\n      if (config.workItem.currentState != 4 && config.workItem.currentState != 10) {\n        $(dom).hide();\n        return;\n      } else {\n        var workItemID = config.workItem.workItemID;\n        var processDefId = config.processDef.processDefID;\n        url = __basePath + '_libs/plugins/unTreat/untreat.jsp?workItemId=' + workItemID + '&processDefId=' + processDefId;\n      }\n    } else {\n      $(dom).hide();\n      return;\n    }\n\n    $(dom).css(\"display\", \"inline-block\");\n    $.ajax({\n      url: 'com.sudytech.portalone.base.processmgr.processMgr.checkbyview.biz.ext',\n      type: 'post',\n      data: JSON.stringify({\n        workItemId: workItemID\n      }),\n      contentType: 'text/json',\n      success: function success(data) {\n        if (data && data.out && data.out == 'false') {\n          $(dom).hide();\n          wf2.buildBtnForPhone();\n        }\n      }\n    });\n    btn.click(function () {\n      var index = layer.open({\n        type: 2,\n        title: '退回',\n        area: [\"350px\", \"480px\"],\n        content: url,\n        btn: ['确定', '取消'],\n        yes: function yes() {\n          var iradio = $($(\"#layui-layer-iframe\" + index)[0].contentWindow.document.getElementById(\"untreat_table\")).find('.iradio_square-green');\n          var selected = '';\n\n          for (var i = 0; i < iradio.length; i++) {\n            if ($(iradio[i]).hasClass('checked')) {\n              selected = $(iradio[i]).find('input.untreated_ck');\n            }\n          }\n\n          if (selected && selected.length) {\n            var id = selected.attr('data-activityDefID');\n            var processInstId = selected.attr('data-processInstId'); // var who = JSON.parse( selected.attr('data-who') );\n\n            var participant = selected.attr('data-participant');\n            var partictName = selected.attr('data-partictName');\n            var type = selected.attr('data-type');\n            var param = {\n              activityDefID: id,\n              processInstId: processInstId,\n              workItemId: workItemID,\n              steps: {\n                steps: [{\n                  from: '',\n                  to: id,\n                  who: [{\n                    id: participant,\n                    name: partictName,\n                    type: type\n                  }]\n                }]\n              }\n            };\n            $.ajax({\n              url: 'com.sudytech.portalone.base.processmgr.processMgr.rollbackToActivity.biz.ext',\n              type: 'post',\n              data: JSON.stringify(param),\n              contentType: 'text/json',\n              success: function success(data) {\n                if (data.result == 'success') {\n                  layer.close(index); // layer.alert(\"退回成功！\");\n\n                  SUI.Util.layerAlert({\n                    content: '退回成功！'\n                  });\n                } else {\n                  // layer.alert(\"退回失败，请重新选择或联系管理员！\");\n                  SUI.Util.layerAlert({\n                    content: '退回失败，请重新选择或联系管理员！'\n                  });\n                }\n              }\n            });\n          } else {\n            // layer.alert('请选择要退回的活动！');\n            SUI.Util.layerAlert({\n              content: '请选择要退回的活动！'\n            });\n          }\n        },\n        btn2: function btn2() {}\n      });\n    });\n  };\n\n  this.getValue = function () {\n    return false;\n  };\n\n  this.setValue = function (val) {\n    return false;\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Untreat/Untreat.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/WorkStorage/WorkStorage.js":
/*!********************************************************************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/WorkStorage/WorkStorage.js ***!
  \********************************************************************************************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return WorkStorage; });\n/**\n * @author yangshangfei\n * @date 2019/7/26 10:47 AM\n */\n\n/**\n * 暂存\n * @param bind\n * @returns {*}\n * @constructor\n */\nfunction WorkStorage(bind) {\n  //dom对象\n  var dom = bind || $(\"<div />\")[0],\n      config,\n      saveId,\n      storageKey,\n      _this;\n\n  dom.zoo = this; //初始化\n\n  _this = this;\n\n  this.init = function (val) {\n    this.setConfig(val);\n  }; //读取元素上的属性\n\n\n  this.parse = function (element) {\n    var el = element || bind;\n    var conf = {\n      mspPreview: $(el).attr('msppreview') || false\n    };\n    return conf;\n  }; //获取控件配置属性\n\n\n  this.getConfig = function () {\n    return config;\n  }; //提供清除方法\n\n\n  this.clearStorage = function () {\n    localStorage.removeItem(storageKey);\n  }; //给控件设置属性，绑定事件\n\n\n  this.setConfig = function (val) {\n    config = val;\n    $(dom).css(\"display\", \"inline-block\");\n\n    if (config.mspPreview) {\n      return;\n    }\n\n    if (!config.userId) {\n      return;\n    }\n\n    if (config.entity) {\n      return;\n    }\n\n    storageKey = window.location.href + '_' + config.userId;\n    var html = '<div class=\"save-tip\" style=\"display: none;border-top-right-radius: 3px;opacity:0.8;width: 30%;height:20px;position: fixed;bottom: 0;left: 0;font-size:10px;padding:0 10px;line-height:20px;background-color: #3f3f3f;color: #ffffff\">' + '        已保存…' + '    </div>';\n    $(dom).html(html);\n    var $saveTip = $(dom).find('.save-tip'); //加载缓存数据\n\n    var saveStorage = function saveStorage() {\n      if (saveId) {\n        clearTimeout(saveId);\n      }\n\n      var suiForm = $(\".sui-form\").sui();\n      var entity = suiForm.getValue(false, true); //                entity.suiOverdue = Date.parse(new Date())\n\n      var storageData = JSON.stringify(entity);\n      localStorage.setItem(storageKey, storageData);\n      $saveTip.show();\n      setTimeout(function () {\n        $saveTip.hide();\n      }, 1000);\n    };\n\n    setTimeout(function () {\n      if (localStorage.getItem(storageKey)) {\n        var suiForm = $(\".sui-form\").sui();\n        var storageData = SUI.Util.parseJSON(localStorage.getItem(storageKey), true);\n        suiForm.setValue(storageData);\n      }\n    }, 300);\n    $('.sui-form').on('change', function () {\n      saveId = setTimeout(function () {\n        saveStorage();\n      }, 1000);\n    });\n    $('.sui-submit').on('afterSumbit', function (e, data) {\n      if (!data.exception) {\n        _this.clearStorage();\n      }\n    });\n  };\n\n  return dom;\n}\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/WorkStorage/WorkStorage.js?")},"./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/sui.js":
/*!******************************************************************************!*\
  !*** ./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/sui.js ***!
  \******************************************************************************/
/*! no exports provided */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _components_Common_Components_Button_Button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./components/Common_Components/Button/Button */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Button/Button.js");\n/* harmony import */ var _components_Common_Components_ChildTitle_ChildTitle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./components/Common_Components/ChildTitle/ChildTitle */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/ChildTitle/ChildTitle.js");\n/* harmony import */ var _components_Common_Components_FieldTitle_FieldTitle__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./components/Common_Components/FieldTitle/FieldTitle */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FieldTitle/FieldTitle.js");\n/* harmony import */ var _components_Common_Components_FormTitle_FormTitle__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/Common_Components/FormTitle/FormTitle */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/FormTitle/FormTitle.js");\n/* harmony import */ var _components_Common_Components_Tip_Tip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./components/Common_Components/Tip/Tip */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Tip/Tip.js");\n/* harmony import */ var _components_Common_Components_TipText_TipText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./components/Common_Components/TipText/TipText */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TipText/TipText.js");\n/* harmony import */ var _components_Common_Components_Text_Text__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/Common_Components/Text/Text */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Text/Text.js");\n/* harmony import */ var _components_Common_Components_Primary_Primary__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./components/Common_Components/Primary/Primary */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Primary/Primary.js");\n/* harmony import */ var _components_Common_Components_Success_Success__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./components/Common_Components/Success/Success */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Success/Success.js");\n/* harmony import */ var _components_Common_Components_Warning_Warning__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./components/Common_Components/Warning/Warning */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Warning/Warning.js");\n/* harmony import */ var _components_Common_Components_Error_Error__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./components/Common_Components/Error/Error */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Error/Error.js");\n/* harmony import */ var _components_Common_Components_Form_Form__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./components/Common_Components/Form/Form */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Form/Form.js");\n/* harmony import */ var _components_Common_Components_Hide_Hide__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./components/Common_Components/Hide/Hide */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Hide/Hide.js");\n/* harmony import */ var _components_Common_Components_Input_Input__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./components/Common_Components/Input/Input */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Input/Input.js");\n/* harmony import */ var _components_Common_Components_Select_Select__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./components/Common_Components/Select/Select */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Select/Select.js");\n/* harmony import */ var _components_Common_Components_MultiSelect_MultiSelect__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./components/Common_Components/MultiSelect/MultiSelect */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/MultiSelect/MultiSelect.js");\n/* harmony import */ var _components_Common_Components_Date_Date__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./components/Common_Components/Date/Date */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Date/Date.js");\n/* harmony import */ var _components_Common_Components_DateRange_DateRange__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./components/Common_Components/DateRange/DateRange */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRange/DateRange.js");\n/* harmony import */ var _components_Common_Components_DateRangePicker_DateRangePicker__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./components/Common_Components/DateRangePicker/DateRangePicker */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DateRangePicker/DateRangePicker.js");\n/* harmony import */ var _components_Common_Components_DataTable_DataTable__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./components/Common_Components/DataTable/DataTable */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/DataTable/DataTable.js");\n/* harmony import */ var _components_Common_Components_TableList_TableList__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./components/Common_Components/TableList/TableList */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/TableList/TableList.js");\n/* harmony import */ var _components_Common_Components_Fileupload_FileUpload__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./components/Common_Components/Fileupload/FileUpload */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Fileupload/FileUpload.js");\n/* harmony import */ var _components_Common_Components_NewFileUpload_NewFileUpload__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./components/Common_Components/NewFileUpload/NewFileUpload */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/NewFileUpload/NewFileUpload.js");\n/* harmony import */ var _components_Common_Components_Number_Number__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./components/Common_Components/Number/Number */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Number/Number.js");\n/* harmony import */ var _components_Common_Components_Rating_Rating__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./components/Common_Components/Rating/Rating */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Rating/Rating.js");\n/* harmony import */ var _components_Common_Components_Model_Model__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./components/Common_Components/Model/Model */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Model/Model.js");\n/* harmony import */ var _components_Common_Components_Editor_Editor__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./components/Common_Components/Editor/Editor */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Common_Components/Editor/Editor.js");\n/* harmony import */ var _components_Process_Components_CheckSendMsg_CheckSendMsg__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./components/Process_Components/CheckSendMsg/CheckSendMsg */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CheckSendMsg/CheckSendMsg.js");\n/* harmony import */ var _components_Process_Components_Circulation_Circulation__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./components/Process_Components/Circulation/Circulation */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Circulation/Circulation.js");\n/* harmony import */ var _components_Process_Components_CloseWindow_CloseWindow__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./components/Process_Components/CloseWindow/CloseWindow */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/CloseWindow/CloseWindow.js");\n/* harmony import */ var _components_Process_Components_DeleteWf_DeleteWf__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./components/Process_Components/DeleteWf/DeleteWf */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/DeleteWf/DeleteWf.js");\n/* harmony import */ var _components_Process_Components_Draft_Draft__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./components/Process_Components/Draft/Draft */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Draft/Draft.js");\n/* harmony import */ var _components_Process_Components_ExcelExport_ExcelExport__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./components/Process_Components/ExcelExport/ExcelExport */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExcelExport/ExcelExport.js");\n/* harmony import */ var _components_Process_Components_ExportWordPdf_ExportWordPdf__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./components/Process_Components/ExportWordPdf/ExportWordPdf */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ExportWordPdf/ExportWordPdf.js");\n/* harmony import */ var _components_Process_Components_FlowHistoryGraph_FlowHistoryGraph__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./components/Process_Components/FlowHistoryGraph/FlowHistoryGraph */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FlowHistoryGraph/FlowHistoryGraph.js");\n/* harmony import */ var _components_Process_Components_MoreParticipates_MoreParticipates__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./components/Process_Components/MoreParticipates/MoreParticipates */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MoreParticipates/MoreParticipates.js");\n/* harmony import */ var _components_Process_Components_MultiOpinion_MultiOpinion__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./components/Process_Components/MultiOpinion/MultiOpinion */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/MultiOpinion/MultiOpinion.js");\n/* harmony import */ var _components_Process_Components_NewParticipants_NewParticipants__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./components/Process_Components/NewParticipants/NewParticipants */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/NewParticipants/NewParticipants.js");\n/* harmony import */ var _components_Process_Components_Opinion_Opinion__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./components/Process_Components/Opinion/Opinion */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Opinion/Opinion.js");\n/* harmony import */ var _components_Process_Components_OpinionHistory_OpinionHistory__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./components/Process_Components/OpinionHistory/OpinionHistory */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionHistory/OpinionHistory.js");\n/* harmony import */ var _components_Process_Components_OpinionOne_OpinionOne__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./components/Process_Components/OpinionOne/OpinionOne */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OpinionOne/OpinionOne.js");\n/* harmony import */ var _components_Process_Components_OrgSelect_OrgSelect__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./components/Process_Components/OrgSelect/OrgSelect */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/OrgSelect/OrgSelect.js");\n/* harmony import */ var _components_Process_Components_Participates_Participates__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./components/Process_Components/Participates/Participates */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Participates/Participates.js");\n/* harmony import */ var _components_Process_Components_Print_Print__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./components/Process_Components/Print/Print */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Print/Print.js");\n/* harmony import */ var _components_Process_Components_Reset_Reset__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./components/Process_Components/Reset/Reset */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Reset/Reset.js");\n/* harmony import */ var _components_Process_Components_Rollback_Rollback__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./components/Process_Components/Rollback/Rollback */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Rollback/Rollback.js");\n/* harmony import */ var _components_Process_Components_SelectMechanismTool_SelectMechanismTool__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./components/Process_Components/SelectMechanismTool/SelectMechanismTool */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectMechanismTool/SelectMechanismTool.js");\n/* harmony import */ var _components_Process_Components_SelectPersonnelTool_SelectPersonnelTool__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./components/Process_Components/SelectPersonnelTool/SelectPersonnelTool */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectPersonnelTool/SelectPersonnelTool.js");\n/* harmony import */ var _components_Process_Components_Submit_Submit__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./components/Process_Components/Submit/Submit */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Submit/Submit.js");\n/* harmony import */ var _components_Process_Components_Terminate_Terminate__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./components/Process_Components/Terminate/Terminate */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Terminate/Terminate.js");\n/* harmony import */ var _components_Process_Components_Untreat_Untreat__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./components/Process_Components/Untreat/Untreat */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Untreat/Untreat.js");\n/* harmony import */ var _components_Process_Components_WorkStorage_WorkStorage__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./components/Process_Components/WorkStorage/WorkStorage */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/WorkStorage/WorkStorage.js");\n/* harmony import */ var _components_Process_Components_Dispatch_Dispatch__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./components/Process_Components/Dispatch/Dispatch */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Dispatch/Dispatch.js");\n/* harmony import */ var _components_Process_Components_SelectParticipates_SelectParticipates__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./components/Process_Components/SelectParticipates/SelectParticipates */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/SelectParticipates/SelectParticipates.js");\n/* harmony import */ var _components_Process_Components_FileEdit_FileEdit__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./components/Process_Components/FileEdit/FileEdit */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/FileEdit/FileEdit.js");\n/* harmony import */ var _components_Process_Components_ApplicantOrg_ApplicantOrg__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./components/Process_Components/ApplicantOrg/ApplicantOrg */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/ApplicantOrg/ApplicantOrg.js");\n/* harmony import */ var _components_Process_Components_QueryWf_QueryWf__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./components/Process_Components/QueryWf/QueryWf */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/QueryWf/QueryWf.js");\n/* harmony import */ var _components_Process_Components_StopWf_StopWf__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./components/Process_Components/StopWf/StopWf */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/StopWf/StopWf.js");\n/* harmony import */ var _components_Process_Components_TurnWf_TurnWf__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ./components/Process_Components/TurnWf/TurnWf */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/TurnWf/TurnWf.js");\n/* harmony import */ var _components_Expansion_Components_MeetRoom_MeetRoom__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ./components/Expansion_Components/MeetRoom/MeetRoom */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Expansion_Components/MeetRoom/MeetRoom.js");\n/* harmony import */ var _components_Expansion_Components_MeetRoom_MeetRoom__WEBPACK_IMPORTED_MODULE_59___default = /*#__PURE__*/__webpack_require__.n(_components_Expansion_Components_MeetRoom_MeetRoom__WEBPACK_IMPORTED_MODULE_59__);\n/* harmony import */ var _components_General_Components_AddEntity_AddEntity__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ./components/General_Components/AddEntity/AddEntity */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/AddEntity/AddEntity.js");\n/* harmony import */ var _components_General_Components_CustomBtn_CustomBtn__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ./components/General_Components/CustomBtn/CustomBtn */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/CustomBtn/CustomBtn.js");\n/* harmony import */ var _components_General_Components_DelEntity_DelEntity__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ./components/General_Components/DelEntity/DelEntity */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/DelEntity/DelEntity.js");\n/* harmony import */ var _components_General_Components_ImportEntity_ImportEntity__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ./components/General_Components/ImportEntity/ImportEntity */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/ImportEntity/ImportEntity.js");\n/* harmony import */ var _components_General_Components_QueryEntity_QueryEntity__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ./components/General_Components/QueryEntity/QueryEntity */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/QueryEntity/QueryEntity.js");\n/* harmony import */ var _components_General_Components_SubmitEntity_SubmitEntity__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ./components/General_Components/SubmitEntity/SubmitEntity */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/General_Components/SubmitEntity/SubmitEntity.js");\n/* harmony import */ var _components_Deprecated_Components_SelectPersonnel_SelectPersonnel__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ./components/Deprecated_Components/SelectPersonnel/SelectPersonnel */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Deprecated_Components/SelectPersonnel/SelectPersonnel.js");\n/* harmony import */ var _components_Deprecated_Components_SelectPersonnel_SelectPersonnel__WEBPACK_IMPORTED_MODULE_66___default = /*#__PURE__*/__webpack_require__.n(_components_Deprecated_Components_SelectPersonnel_SelectPersonnel__WEBPACK_IMPORTED_MODULE_66__);\n/* harmony import */ var _components_Process_Components_Qrcode_Qrcode__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ./components/Process_Components/Qrcode/Qrcode */ "./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/components/Process_Components/Qrcode/Qrcode.js");\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\n// import \'./../../bootstrap/css/bootstrap.min.css\';\n// import \'./../fontawesome/css/font-awesome.min.css\';\n// import \'./../ionicons/css/ionicons.min.css\';\n// import \'./../datatables/dataTables.bootstrap.css\';\n// import \'./../daterangepicker/daterangepicker.css\';\n// import \'./../datepicker/datepicker3.css\';\n// import \'./../timepicker/bootstrap-timepicker.min.css\';\n// import \'./../select2/select2.min.css\';\n// import \'./../iCheck/all.css\';\n// import \'./../../dist/css/skins/skin-blue.min.css\';\n// import \'./../uploadify/uploadify.css\';\n// import \'./../../dist/css/sdm.css\';\n// import \'./../../../_public/css/style.css\';\n// import \'./../../../_public/css/layout-2.css\';\n// import \'./../../coreplus/mspplus_form.css\';\n// import \'./../../coreplus/coreplus-form.css\';\n// import \'./../../coreplus/coreplus-form-mobile.css\';\n// import \'./../wangEditor/css/wangEditor.min.css\';\n// import \'./../../coreplus/coreplus-form-normal.css\';\n// import \'jquery\';\n// import \'./../../bootstrap/js/bootstrap.min\';\n// import \'./../datatables/jquery.dataTables\';\n// import \'./../tablebuttons/jquery.tablebuttons\';\n// import \'./../datatables/dataTables.bootstrap\';\n// // import \'./../moment/moment-with-locales\';\n// import \'./../daterangepicker/daterangepicker\';\n// import \'./../datepicker/bootstrap-datepicker\';\n// import \'./../input-mask/jquery.inputmask\';\n// import \'./../input-mask/jquery.inputmask.date.extensions\';\n// import \'./../input-mask/jquery.inputmask.extensions\';\n// import \'./../colorpicker/bootstrap-colorpicker.min\';\n// import \'./../timepicker/bootstrap-timepicker.min\';\n// import \'./../select2/select2.full\';\n// import \'./../slimScroll/jquery.slimscroll.min\';\n// import \'./../fastclick/fastclick.min\';\n// import \'./../iCheck/icheck\';\n// import \'./../../coreplus/math.min\';\n// import \'./../../dist/js/app\';\n// import \'./../../workflow/workflow2\';\n// import \'./../../entity/entityManage\';\n// import \'./../../workflow/adjustheight\';\n// import \'./../uploadify/jquery.uploadify.min\';\n// import \'./../../../_public/js/iPortalInit\';\n// import \'./../../../_public/js/iportal-ex\';\n// // import \'./../wangEditor/js/wangEditor\';\n// import \'./../../coreplus/coreplus-form-mobile\';\n// import less from \'./../../coreplus/css/coreplus-PC.less\';\n// 基本控件\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n // 流程控件\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n // 流程管理控件\n\n\n\n //选择会议室控件\n\n // 普通提交表单控件\n\n\n\n\n\n\n // 弃用\n\n\n\n\nif (typeof jQuery === "undefined") {\n  throw new _components_Common_Components_Error_Error__WEBPACK_IMPORTED_MODULE_10__["default"]("SUI requires jQuery");\n}\n\nvar __basePath = window.__basePath || "",\n    __contextPath = window.__contextPath || "";\n\n(function () {\n  var RegExps = {\n    number: /^-?((([1-9]\\d*)|0)|([1-9]\\d*\\.\\d+)|(0\\.\\d*[1-9]\\d*))$/,\n    // 数字，整型或浮点型\n    "int": /^((-?[1-9]\\d*)|0)$/,\n    // 数字，整形\n    plusInt: /^[1-9]\\d*$/,\n    //正整数 不包括零\n    // plusNumber: /^\\d+(\\.\\d+)?$/, //正整数或正浮点数 包括零\n    plusNumber: /^(([1-9]\\d*(\\.\\d+)?)|(0\\.\\d+))$/,\n    //正整数或正浮点数 不包括零\n    "float": /^-?(([1-9]\\d*\\.\\d+)|(0\\.\\d*[1-9]\\d*))$/,\n    // 数字，浮点型\n    id: /^(\\d{15}$|^\\d{18}$|^\\d{17}(\\d|X|x))$/,\n    // 身份证号\n    zipcode: /^[0-9]\\d{5}(?!\\d)$/,\n    // 邮政编码\n    qq: /^[1-9][0-9]{4,}$/,\n    // qq号\n    tel: /^(0\\d{2,3}-)?\\d{7,8}$/,\n    // 固定电话 (允许不输入区号)\n    mobile: /^0?(13|14|15|16|17|18|19)[0-9]{9}$/,\n    // 手机号\n    phone: /^(((0\\d{2,3}-)?\\d{7,8})|(0?(13|14|15|16|17|18|19)[0-9]{9}))$/,\n    // 固定电话(允许不输入区号) 或 手机\n    url: /^((https|http|ftp|rtsp|mms)?:\\/\\/)[^\\s]+$/,\n    // URL地址\n    email: /^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/,\n    // email地址\n    ip: /^(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)$/,\n    // ip地址\n    chinese: /^[\\u4e00-\\u9fa5]*$/,\n    // 中文字符,\n    shuzi: /^[0-9]*$/,\n    //纯数字\n    hghtje: /^(\\d{1,4}|\\d{1,4}\\.\\d{1,6})$/,\n    //海关合同审批金额\n    mac: /^([0-9a-fA-F]{2})(([\\/\\s:-][0-9a-fA-F]{2}){5})$/,\n    //Mac地址\n    // password: /^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{8,}$/ ,  //密码长度验证6-15位   /^[\\@A-Za-z0-9\\!\\#\\$\\%\\^\\&\\*\\.\\~\\_]{8,}$/\n    password: /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d!@#$]{6,15}$/\n  }; // 如果有新增 RegExps format，请在errorCodes 中增加相应的校验错误提示 format_xxxx\n\n  var errorCodes = {\n    empty: \'{title}不能为空\',\n    max: \'最多不能超过{value}个{slug}\',\n    min: \'最少不能小于{value}个{slug}\',\n    regx: \'{title}格式不正确\',\n    format_id: \'身份证号应为15或18位数字\',\n    format_zipcode: \'邮政编码应为1-9开头的6位数字\',\n    format_qq: \'QQ号不合法\',\n    format_tel: \'固定电话格式不正确\',\n    format_mobile: \'手机号格式不正确，如13888888888\',\n    format_phone: \'固定电话或手机号格式不正确\',\n    format_url: \'无效的URL地址\',\n    format_email: \'无效的邮件地址\',\n    format_ip: \'无效的IP地址\',\n    format_chinese: \'输入内容为中文字符\',\n    format_shuzi: \'不是纯数字\',\n    format_hghtje: \'审批金额无效\',\n    format_mac: \'无效的Mac地址\',\n    format_password: \'数字字母组合密码长度须为6-15位\',\n    format_int: \'无效的整数\',\n    format_float: \'无效的浮点型数字\',\n    format_number: \'无效的整数或浮点型数字\',\n    format_intLen: \'整数位数最大不超过{value}位\',\n    format_floatLen: \'小数位数最大不超过{value}位\',\n    format_minus: \'无效的负数\',\n    format_plus: \'无效的正数\',\n    format_maxNum: \'数值不应大于{value}\',\n    format_minNum: \'数值不应小于{value}\',\n    format_plusInt: \'无效的正整数\',\n    format_plusNumber: \'无效的正数（含小数）\'\n  };\n  var popTplDef = \'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>\';\n  var popTpl = {\n    inp: popTplDef,\n    tip: popTplDef\n  };\n  var Util = {\n    context: {},\n    compare: function compare(v1, v2) {\n      v1 = v1 || 0;\n      v2 = v2 || 0;\n      return v1 == v2;\n    },\n    empty: function empty() {// coming...\n    },\n    toJsonString: function toJsonString(value) {\n      return JSON.stringify(value);\n    },\n    parseJSON: function parseJSON(str, jsStyle) {\n      if (!jsStyle) {\n        return $.parseJSON(str);\n      } else {\n        return eval(\'(function(){return \' + str + \'})()\');\n      }\n    },\n    inArray: function inArray(elem, arr, i, checkType) {\n      var len,\n          checkType = true;\n\n      if (i === false) {\n        checkType = false;\n        i = 0;\n      }\n\n      if (arr) {\n        len = arr.length;\n        i = i ? i < 0 ? Math.max(0, len + i) : i : 0;\n\n        for (; i < len; i++) {\n          // Skip accessing in sparse arrays\n          if (i in arr && (checkType && arr[i] === elem || arr[i] == elem)) {\n            return i;\n          }\n        }\n      }\n\n      return -1;\n    },\n    inArrayObj: function inArrayObj(key, val, array, force) {\n      var index = -1;\n\n      var _array = $.isArray(array) ? array.slice(0) : [];\n\n      if (!_array.length) return index;\n\n      for (var i = 0; i < _array.length; i++) {\n        if (_array[i][key] == val) {\n          if (!force || _typeof(_array[i][key]) == _typeof(val)) {\n            return i;\n          }\n        }\n      }\n\n      return index;\n    },\n    objectKeys: function objectKeys(obj) {\n      var keys = [],\n          key;\n\n      for (key in obj) {\n        keys.push(key);\n      }\n\n      return keys;\n    },\n    validateError: function validateError(result, dom, value, errorCode, errorValue) {\n      if (result || !dom) {\n        if ($(dom).data(\'bs.tooltip\')) {\n          $(dom).data(\'bs.tooltip\').hide();\n        }\n\n        return true;\n      }\n\n      var hideTip = $(dom).attr(\'hideTip\') != undefined;\n\n      if (hideTip) {\n        return false;\n      }\n\n      var tip = \'\',\n          title = $(dom).attr(\'class\').indexOf(\'sui-selectpersonneltool\') > -1 ? \'此项\' : $(dom).attr(\'data-original-title\') || \'此项\',\n          _tip = $(dom).attr("inputTip") || \'请检查\' + title + \'是否正确\',\n          slug = typeof value === "string" ? "字符" : "项目",\n          errorValue = typeof errorValue == "undefined" ? "" : errorValue;\n\n      if (errorCode && errorCodes[errorCode]) {\n        tip += errorCodes[errorCode].replace(\'{value}\', errorValue).replace(\'{title}\', title).replace(\'{slug}\', slug);\n      } else {\n        tip += _tip;\n      }\n\n      if (SUI.Util.browserType() === \'pc\') {\n        tip = \'<i class="fa fa-warning"></i>  \' + ($(dom).attr(\'errorTip\') || tip);\n      } else {\n        if (errorCode == \'empty\') {\n          var componentTitle = \'\';\n\n          if ($(dom).parents(\'.cm-show-row\').length) {\n            if ($(dom).parents(\'.cm-show-row\').find(\'.cm-show-inline-title\').length) {\n              var titleHtml = $(dom).parents(\'.cm-show-row\').find(\'.cm-show-inline-title\');\n              componentTitle = titleHtml.find(\'.sui-fieldtitle span\').text() || (titleHtml.find(\'span:last\').text() == \'*\' ? titleHtml.find(\'div\').text() : \'\') || \'\';\n            } else if ($(dom).parents(\'.cm-show-row\').prev(\'.cm-show-row\').length) {\n              var titleHtml = $(dom).parents(\'.cm-show-row\').prev(\'.cm-show-row\');\n              componentTitle = titleHtml.find(\'.sui-fieldtitle span\').text() || (titleHtml.find(\'span:last\').text() == \'*\' ? titleHtml.find(\'div\').text() : \'\') || \'\';\n            }\n          }\n\n          tip = $(dom).attr(\'errorTip\') || (componentTitle ? componentTitle + \'不能为空\' : tip);\n        } else {\n          tip = $(dom).attr(\'errorTip\') || tip;\n        }\n      }\n\n      var pos = $(dom).attr("tipplace") || \'top\',\n          color = \'#dd4b39\';\n\n      if ($(dom).data(\'bs.tooltip\')) {\n        $(dom).tooltip(\'hide\');\n        $(dom).data(\'bs.tooltip\', "");\n      }\n\n      var toolName = $(dom).attr(\'name\');\n\n      if (SUI.Util.browserType() === \'pc\' || !wf2.isNewInPhone) {\n        var container = null;\n\n        if ($(dom).parent(\'td\').length) {\n          container = $(dom).parent(\'td\');\n        } else {\n          container = $(dom).parent();\n        }\n\n        $(dom).tooltip({\n          placement: \'top\',\n          trigger: \'manual\',\n          content: tip,\n          // container: container,\n          container: $(dom),\n          html: true,\n          inDataTable: true,\n          template: \'<div class="tooltip" role="tooltip" style="margin-top:0px;">\' + \'<div class="tooltip-arrow" style="border-\' + pos + \'-color:\' + color + \';">\' + \'</div><div class="tooltip-inner" id="tooltip_\' + toolName + \'" style="background:\' + color + \';max-width: 300px; line-height: 16px; padding: 5px 7px;"></div>\' + \'</div>\'\n        });\n      } else {\n        var container = null;\n\n        if ($(dom).parents(\'.cm-show-row\').length) {\n          container = $(dom).parents(\'.cm-show-row\');\n        }\n\n        if (container.find(\'.tooltip-phone\').length) {\n          container.find(\'.tooltip-phone\').remove();\n        }\n\n        $(dom).tooltip({\n          placement: \'bottom\',\n          trigger: \'manual\',\n          content: tip,\n          container: container,\n          html: true,\n          template: \'<div class="tooltip tooltip-phone" role="tooltip" >\' + \'<div class="tooltip-inner" id="tooltip_\' + toolName + \'" ></div>\' + \'</div>\'\n        });\n      }\n\n      if ($(dom).is(\':visible\')) $(dom).tooltip(\'show\');\n\n      if (!dom.tooltip) {\n        dom.tooltip = true;\n        $(dom).on(\'click\', function (event) {\n          setTimeout(function () {\n            $(this).tooltip(\'hide\');\n          }.call(this), 300);\n        });\n      }\n\n      return false;\n    },\n    validate: function validate(_validate, value, isHaveErrorTip) {\n      var dom = this;\n\n      if (!_validate) {\n        return Util.validateError(true, dom, value);\n      }\n\n      var style = typeof _validate !== \'undefined\' ? typeof _validate.style !== "undefined" ? _validate.style : 2 : 2;\n      $(dom).addClass(\'form-validate-\' + style);\n\n      if (isHaveErrorTip) {\n        return Util.validateError(false, dom, value);\n      }\n\n      if (!value || !$.trim(value).length) {\n        return Util.validateError(_validate.require ? false : true, dom, value, \'empty\');\n      }\n\n      var length = value ? value.length : 0;\n\n      if (length > _validate.max) {\n        return Util.validateError(false, dom, value, \'max\', _validate.max);\n      }\n\n      if (length < _validate.min) {\n        return Util.validateError(false, dom, value, \'min\', _validate.min);\n      }\n\n      var regx = _validate.regx;\n\n      if (regx && !new RegExp("^" + regx + "$").test(value)) {\n        return Util.validateError(false, dom, value, \'regx\');\n      }\n\n      if (!regx && _validate.format) {\n        var format = _validate.format.split("|");\n\n        var f = format[0],\n            l = format[1];\n        if (!RegExps[f].test(value)) return Util.validateError(false, dom, value, \'format_\' + f);\n\n        if (/float|number|int/.test(f)) {\n          var _value = Number(value);\n\n          if (l) {\n            var len = l.replace(/[-+]/, "").split(".");\n            var val = value.replace("-", "").split(".");\n\n            if (/cny/i.test(l)) {\n              len[1] = "2";\n            }\n\n            if (len[0] && val[0].length > Number(len[0])) return Util.validateError(false, dom, value, \'format_intLen\', Number(len[0]));\n            if (/float|number/.test(f) && len[1] && val[1] && val[1].length > Number(len[1])) return Util.validateError(false, dom, value, \'format_floatLen\', Number(len[1]));\n            if (/^[-]/.test(l) && _value >= 0) return Util.validateError(false, dom, value, \'format_minus\');\n            if (/^[+]/i.test(l) && _value <= 0) return Util.validateError(false, dom, value, \'format_plus\');\n          }\n\n          if (typeof _validate.maxNum === "number" && _value > _validate.maxNum) return Util.validateError(false, dom, value, \'format_maxNum\', _validate.maxNum);\n          if (typeof _validate.minNum === "number" && _value < _validate.minNum) return Util.validateError(false, dom, value, \'format_minNum\', _validate.minNum);\n        }\n      }\n\n      return Util.validateError(true, dom, value);\n    },\n    getUser: function getUser() {\n      //获取当前用户\n      return this.context.user;\n    },\n    getServerEnv: function getServerEnv() {\n      return this.context.serverEnv; //获取服务器环境\n    },\n    // 获取网址上的某个参数\n    getQueryString: function getQueryString(name) {\n      var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");\n      var r = window.location.search.substr(1).match(reg);\n      if (r != null) return unescape(r[2]);\n      return null;\n    },\n    getSequence: function () {\n      var index = 0;\n      return function (name) {\n        return index++;\n      };\n    }(),\n    getCache: function () {\n      var cache = {};\n      return function (name) {\n        var value = cache[name];\n\n        if (value) {\n          return value;\n        }\n\n        value = {};\n        cache[name] = value;\n        return value;\n      };\n    }(),\n    validDateStr: function validDateStr(dateStr, format) {\n      if (typeof dateStr == "string") {\n        var strs = dateStr.split(/\\s/);\n\n        if (strs.length == 1 && /:/.test(dateStr)) {\n          dateStr = moment().format(\'YYYY-MM-DD\') + \' \' + dateStr;\n        }\n      }\n\n      var _date = moment(dateStr),\n          date = moment(),\n          out = "";\n\n      if (_date.isValid()) {\n        date = _date;\n        out = date.format(format);\n      }\n\n      return {\n        date: date,\n        validate: out\n      };\n    },\n    // 该方法主要用于给日期型控件getValue()时精确到秒\n    accurateToZore: function accurateToZore(str) {\n      if (str) {\n        // YYYY-MM 与 YYYY-MM-DD不做处理\n        if (str.split(\'-\').length === 2 || str.split(\'-\').length === 3 && str.split(\'-\')[2].split(\' \').length === 1) {\n          return str;\n        } else {\n          // 其他格式补0\n          if (moment(str)._d == \'Invalid Date\') {\n            return str;\n          } else {\n            return moment(str).format(\'YYYY-MM-DD HH:mm:ss\');\n          }\n        }\n      } else {\n        return \'\';\n      }\n    },\n    getTimePrecision: function getTimePrecision(val) {\n      if (typeof timeprecision != \'undefined\') {\n        if (timeprecision === \'true\' || timeprecision === true) {\n          if (val.split(\' - \').length === 2) {\n            var val1 = SUI.Util.accurateToZore(val.split(\' - \')[0]);\n            var val2 = SUI.Util.accurateToZore(val.split(\' - \')[1]);\n            return val1 + \' - \' + val2;\n          } else {\n            return SUI.Util.accurateToZore(val);\n          }\n        } else {\n          return val;\n        }\n      } else {\n        return val;\n      }\n    },\n    toCNY: function toCNY(currencyDigits) {\n      if (typeof currencyDigits === "string") {\n        if (currencyDigits.match(/^-?((\\d{1,3}(,\\d{3})*(.((\\d{3},)*\\d{1,3}))?)|(\\d+(.\\d+)?))$/) == null) {\n          alert("无效数字!");\n          return "";\n        }\n\n        currencyDigits = currencyDigits.replace(/,/g, "");\n        currencyDigits = currencyDigits.replace(/^0+/, "");\n      }\n\n      currencyDigits = Number(currencyDigits || 0);\n      var MAXIMUM_NUMBER = 99999999999.99;\n\n      if (currencyDigits > MAXIMUM_NUMBER) {\n        alert("数值须不大于" + MAXIMUM_NUMBER);\n        return "";\n      }\n\n      var CN_FU = "",\n          CN_ZERO = "零",\n          CN_ONE = "壹",\n          CN_TWO = "贰",\n          CN_THREE = "叁",\n          CN_FOUR = "肆",\n          CN_FIVE = "伍",\n          CN_SIX = "陆",\n          CN_SEVEN = "柒",\n          CN_EIGHT = "捌",\n          CN_NINE = "玖",\n          CN_TEN = "拾",\n          CN_HUNDRED = "佰",\n          CN_THOUSAND = "仟",\n          CN_TEN_THOUSAND = "万",\n          CN_HUNDRED_MILLION = "亿",\n          CN_SYMBOL = "",\n          CN_DOLLAR = "元",\n          CN_TEN_CENT = "角",\n          CN_CENT = "分",\n          CN_INTEGER = "整";\n      var integral, decimal, outputCharacters, parts, digits, radices, bigRadices, decimals, zeroCount, i, p, d, quotient, modulus;\n      currencyDigits = currencyDigits.toString();\n\n      if (/^[-]/.test(currencyDigits)) {\n        currencyDigits = currencyDigits.replace("-", "");\n        CN_FU = "负";\n      }\n\n      parts = currencyDigits.split(".");\n\n      if (parts.length > 1) {\n        integral = parts[0];\n        decimal = parts[1];\n        decimal = decimal.substr(0, 2);\n      } else {\n        integral = parts[0];\n        decimal = "";\n      }\n\n      digits = new Array(CN_ZERO, CN_ONE, CN_TWO, CN_THREE, CN_FOUR, CN_FIVE, CN_SIX, CN_SEVEN, CN_EIGHT, CN_NINE);\n      radices = new Array("", CN_TEN, CN_HUNDRED, CN_THOUSAND);\n      bigRadices = new Array("", CN_TEN_THOUSAND, CN_HUNDRED_MILLION);\n      decimals = new Array(CN_TEN_CENT, CN_CENT);\n      outputCharacters = "";\n\n      if (Number(integral) > 0) {\n        zeroCount = 0;\n\n        for (i = 0; i < integral.length; i++) {\n          p = integral.length - i - 1;\n          d = integral.substr(i, 1);\n          quotient = p / 4;\n          modulus = p % 4;\n\n          if (d == "0") {\n            zeroCount++;\n          } else {\n            if (zeroCount > 0) {\n              outputCharacters += digits[0];\n            }\n\n            zeroCount = 0;\n            outputCharacters += digits[Number(d)] + radices[modulus];\n          }\n\n          if (modulus == 0 && zeroCount < 4) {\n            outputCharacters += bigRadices[quotient];\n          }\n        }\n\n        outputCharacters += CN_DOLLAR;\n      }\n\n      if (decimal != "") {\n        for (i = 0; i < decimal.length; i++) {\n          d = decimal.substr(i, 1);\n\n          if (d != "0") {\n            outputCharacters += digits[Number(d)] + decimals[i];\n          } else {\n            outputCharacters += CN_ZERO;\n          }\n        }\n      }\n\n      if (outputCharacters == "") {\n        outputCharacters = CN_ZERO + CN_DOLLAR;\n      }\n\n      if (decimal == "" || decimal.length == 1 || decimal.substr(1, 1) == "0") {\n        outputCharacters += CN_INTEGER;\n      }\n\n      outputCharacters = CN_FU + CN_SYMBOL + outputCharacters;\n      return outputCharacters;\n    },\n    encodeCNY: function encodeCNY(value, sep) {\n      var reg = new RegExp(sep, "ig");\n      var vals = $.trim(value).replace(reg, "").split(".");\n      var val = vals[0].split("");\n      var arr = [],\n          end = false,\n          j = 0;\n\n      for (var i = val.length - 1; i >= 0; i--) {\n        j++;\n\n        if (!/\\d/.test(val[i])) {\n          end = true;\n        }\n\n        if (j > 3 && !end && (j - 1) % 3 == 0) {\n          arr.push(sep);\n        }\n\n        arr.push(val[i]);\n      }\n\n      vals[0] = arr.reverse().join("");\n      return vals.join(".");\n    },\n    decodeCNY: function decodeCNY(value, sep) {\n      var reg = new RegExp(sep, "ig");\n      return $.trim(value).replace(reg, "");\n    },\n    popTpl: popTpl,\n    dateFormat: function dateFormat(date, fmt) {\n      //author: meizz\n      var o = {\n        "M+": date.getMonth() + 1,\n        //月份\n        "d+": date.getDate(),\n        //日\n        "h+": date.getHours(),\n        //小时\n        "m+": date.getMinutes(),\n        //分\n        "s+": date.getSeconds(),\n        //秒\n        "q+": Math.floor((date.getMonth() + 3) / 3),\n        //季度\n        "S": date.getMilliseconds() //毫秒\n\n      };\n      if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));\n\n      for (var k in o) {\n        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));\n      }\n\n      return fmt;\n    },\n    validateClass: function validateClass(state) {\n      var classes = ["form-item-error", "formError", "form-item-success"];\n\n      if (state) {\n        return classes[2];\n      }\n\n      if (arguments.length) classes.pop();\n      return classes.join(" ");\n    },\n    poptip: function poptip(text, dom, trigger, tpl) {\n      if (text && dom && trigger) {\n        $(dom).popover({\n          html: true,\n          content: text,\n          trigger: "manual",\n          placement: "top",\n          template: tpl || SUI.Util.popTpl.inp\n        });\n        trigger.on(\'focusin\', function (event) {\n          $(dom).popover("show");\n        }).on(\'focusout\', function (event) {\n          $(dom).popover("hide");\n        });\n      }\n    },\n    sort: function sort(ary, func) {\n      if (!ary || ary.length < 1) {\n        return;\n      }\n\n      for (var i = 0; i < ary.length; i++) {\n        for (var j = i + 1; j < ary.length; j++) {\n          if (func) {\n            if (func(ary[i], ary[j]) > 0) {\n              var max = ary[i];\n              ary[i] = ary[j];\n              ary[j] = max;\n            }\n          } else {\n            if (ary[i] > ary[j]) {\n              var max = ary[i];\n              ary[i] = ary[j];\n              ary[j] = max;\n            }\n          }\n        }\n      }\n    },\n    browserType: function browserType() {\n      var sUserAgent = navigator.userAgent.toLowerCase();\n      var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";\n      var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";\n      var bIsMidp = sUserAgent.match(/midp/i) == "midp";\n      var bIsUc7 = sUserAgent.match(/rv:1.2.3.4/i) == "rv:1.2.3.4";\n      var bIsUc = sUserAgent.match(/ucweb/i) == "ucweb";\n      var bIsAndroid = sUserAgent.match(/android/i) == "android";\n      var bIsCE = sUserAgent.match(/windows ce/i) == "windows ce";\n      var bIsWM = sUserAgent.match(/windows mobile/i) == "windows mobile";\n\n      if (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE || bIsWM) {\n        return "phone";\n      } else {\n        return "pc";\n      }\n    },\n    browserPlantform: function browserPlantform() {\n      var sUserAgent = navigator.userAgent.toLowerCase();\n      var bIsIpad = sUserAgent.match(/ipad/i) == "ipad";\n      var bIsIphoneOs = sUserAgent.match(/iphone os/i) == "iphone os";\n      var bIsMidp = sUserAgent.match(/midp/i) == "midp";\n      var bIsUc7 = sUserAgent.match(/rv:1.2.3.4/i) == "rv:1.2.3.4";\n      var bIsUc = sUserAgent.match(/ucweb/i) == "ucweb";\n      var bIsAndroid = sUserAgent.match(/android/i) == "android";\n      var bIsCE = sUserAgent.match(/windows ce/i) == "windows ce";\n      var bIsWM = sUserAgent.match(/windows mobile/i) == "windows mobile";\n\n      if (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE || bIsWM) {\n        if (bIsIpad || bIsIphoneOs) {\n          return "ios";\n        } else {\n          return "android";\n        }\n      } else {\n        return "pc";\n      }\n    },\n    propString: function propString(obj, copy) {\n      var prop,\n          out = {};\n\n      for (prop in obj) {\n        if (_typeof(obj[prop]) == "object") {\n          obj[prop] = SUI.Util.toJsonString(obj[prop]);\n        }\n\n        out[prop] = obj[prop];\n      }\n\n      return copy ? out : obj;\n    },\n    setInputTextPos: function setInputTextPos(input, spos) {\n      input = $(input)[0];\n      if (!input) return;\n\n      if (typeof spos != "number") {\n        spos = input.value.length;\n      } else {\n        if (spos < 0) spos += input.value.length;\n      }\n\n      if (input.setSelectionRange) {\n        //兼容火狐,谷歌\n        setTimeout(function () {\n          input.setSelectionRange(spos, spos);\n          input.focus();\n        }, 0);\n      } else if (input.createTextRange) {\n        //兼容IE\n        var rng = input.createTextRange();\n        rng.move(\'character\', spos);\n        rng.select();\n      }\n    },\n    getInputTextPos: function getInputTextPos(input) {\n      input = $(input)[0];\n      if (!input) return;\n\n      if (!input.setSelectionRange) {\n        // IE\n        var range = document.selection.createRange();\n        range.text = \'\';\n        range.setEndPoint(\'StartToStart\', input.createTextRange());\n        return range.text.length;\n      } else {\n        return input.selectionStart;\n      }\n    },\n    htmlEncode: function htmlEncode(str) {\n      if (typeof str != "string" || str.length == 0) return str;\n      str = str.replace(/</g, "&lt;");\n      str = str.replace(/>/g, "&gt;");\n      str = str.replace(/ /g, "&nbsp;");\n      str = str.replace(/\\\'/g, "&#39;");\n      str = str.replace(/\\"/g, "&quot;");\n      str = str.replace(/\\n/g, "<br>");\n      return str;\n    },\n    getFunctionBody: function getFunctionBody(fn, force) {\n      var bodyStr = $.trim(fn.toString());\n      var reg = /^function[\\s]*([_\\$a-zA-Z][_\\$a-zA-Z0-9]+)?[\\s]*\\(([^\\)]+)?\\)[^\\{]*\\{([\\s\\S]+)?\\}$/;\n      var matches = bodyStr.match(reg);\n      var body = matches != null && matches[3] ? matches[3] : \'\';\n\n      if (force && matches != null) {\n        return {\n          body: body,\n          name: matches[1],\n          params: $.trim(matches[2])\n        };\n      }\n\n      return body;\n    },\n    getObjectPropVal: function getObjectPropVal(key, obj) {\n      var keys = key.split(\'.\');\n      var val;\n\n      if (!key || !keys || !keys.length) {\n        return val;\n      }\n\n      for (var i = 0; i < keys.length; i++) {\n        val = obj[keys[i]];\n\n        if (typeof val == \'string\') {\n          try {\n            val = SUI.Util.parseJSON(val) || val;\n\n            if ($.isArray(val)) {\n              val = val[0];\n            }\n          } catch (e) {}\n        }\n\n        if ((_typeof(val) !== "object" || !val) && i < keys.length - 1) {\n          return;\n        }\n\n        obj = val;\n      }\n\n      return val;\n    },\n    escape: function escape(val) {\n      return String(val || \'\').replace(/&(?!#?[a-zA-Z0-9]+;)/g, \'&amp;\').replace(/</g, \'&lt;\').replace(/>/g, \'&gt;\').replace(/\'/g, \'&#39;\').replace(/"/g, \'&quot;\');\n    },\n    // 获取弹框大小\n    getLayerArea: function getLayerArea(type) {\n      var area = [\'260px\', \'150px\'];\n\n      switch (type) {\n        case \'small\':\n          area = [\'260px\', \'150px\'];\n          break;\n\n        case \'middle\':\n          area = [\'480px\', \'300px\'];\n          break;\n\n        case \'large\':\n          area = [\'600px\', \'360px\'];\n          break;\n\n        default:\n          area = [\'260px\', \'150px\'];\n          break;\n      }\n\n      return area;\n    },\n    // 弹框大小 参数 ：option对象\n    // {\n    //      size(string):\'small\',\'middle\',\'large\', 弹框大小\n    //      btnAlign(string):\'left\',\'right\',\'center\' , 按钮位置\n    // }\n    layerAlert: function layerAlert(option) {\n      if (!layer) {\n        alert(\'依赖layer！\');\n        return;\n      }\n\n      var config = {\n        content: \'\'\n      };\n      config = $.extend(true, config, option);\n      var area = [\'260px\', \'150px\'];\n\n      switch (config.size) {\n        case \'small\':\n          area = [\'260px\', \'150px\'];\n          break;\n\n        case \'middle\':\n          area = [\'480px\', \'300px\'];\n          break;\n\n        case \'large\':\n          area = [\'600px\', \'360px\'];\n          break;\n\n        default:\n          area = [\'260px\', \'150px\'];\n          break;\n      }\n\n      var layerConfig = {\n        content: config.content,\n        btn: [\'确&nbsp;定\'],\n        btn1: function btn1(index) {\n          $(\'body\').removeClass(\'noscroll\');\n          layer.close(index);\n        },\n        success: function success(index) {\n          $(\'body\').addClass(\'noscroll\');\n          $(index).find(\'.layui-layer-btn\').css(\'text-align\', config.btnAlign || \'center\');\n        },\n        cancel: function cancel(index) {\n          $(\'body\').removeClass(\'noscroll\');\n          layer.close(index);\n        }\n      };\n\n      if (config.size) {\n        layerConfig.area = area;\n      }\n\n      layer.open(layerConfig);\n    },\n    wfCloseWindow: function wfCloseWindow(wfConfig) {\n      if (typeof from != "undefined" && typeof appload != "undefined" && from && appload && typeof SUI.Util._closeBtn != "undefined" && $.isFunction(SUI.Util._closeBtn)) {\n        SUI.Util._closeBtn(from, appload, wfConfig);\n      } else {\n        if (window.opener != null) {\n          window.close();\n        } else {\n          parent.layer.close(parent.layer.getFrameIndex(window.name));\n        }\n      }\n    },\n    _closeBtn: function _closeBtn(from, appload, wfConfig) {\n      if (appload == "0" && from == "null" && wfConfig) {\n        if (wfConfig.workItemId || wfConfig.processInstId) {\n          history.go(-1);\n        }\n      } else if (appload == "null" && from == "null") {\n        //直接关闭\n        closeWindow(true);\n      } else if (appload == "0" && from == "m") {\n        //首页关闭layer\n        closeWindow();\n      } else if (appload == "0" && from == "g") {\n        //关闭弹窗\n        closeWindow(-1);\n      } else if (appload == "0" && from == "app") {\n        //关闭弹窗\n        iPortal.closeWindow();\n      } else if (appload == "0" && from == "wechat") {\n        //关闭微信\n        history.go(-1);\n      } else {\n        closeWindow(true);\n      }\n    },\n    getParticipateTitle: function getParticipateTitle() {\n      var p_title = \'经办人\';\n\n      try {\n        p_title = $(\'.sui-newparticipants .participants-next-name\').eq(0).text() || $(\'.sui-newparticipants .current_next_name\').eq(0).text() || \'经办人\';\n\n        if (p_title && (p_title.substring(p_title.length - 1, p_title.length) == \':\' || p_title.substring(p_title.length - 1, p_title.length) == \'：\')) {\n          p_title = p_title.substring(0, p_title.length - 1);\n        }\n      } catch (err) {\n        p_title = \'经办人\';\n      }\n\n      p_title = \'请选择\' + p_title;\n      return p_title;\n    },\n    // 意见控件公共方法\n    //常用意见\n    systemOpinion: function systemOpinion(dom, strategycode, vType) {\n      var url = \'com.sudytech.portalone.base.strategyOpinion.strategyOpinion.queryCommenOpnionnew.biz.ext\';\n\n      if (vType == \'old\') {\n        url = \'com.sudytech.portalone.base.strategyOpinion.strategyOpinion.queryCommenOpnion.biz.ext\';\n      }\n\n      $.ajax({\n        url: url,\n        type: "post",\n        dataType: "json",\n        data: {\n          strategycode: strategycode\n        },\n        success: function success(data) {\n          var list = data.results;\n\n          if (!$(dom).find(\'.strategyOpinion\').length) {\n            $(dom).append(\'<div class = "strategyOpinion"><div class="strategy-opinion-title">常用意见:</div><select id="strategyOpinion" class="strategy-opinion-select"><option>常用意见</option></select></div>\');\n          }\n\n          var html = \'<option>请选择</option>\';\n\n          for (var i = 0; i < list.length; i++) {\n            html += \'<option>\' + list[i].VALUE + \'</option>\';\n          }\n\n          $(dom).find("select").html(html);\n          $(dom).find("select").select2();\n          $(".strategyOpinion .select2").css("vertical-align", "middle");\n          $(dom).find("select").change(function () {\n            if ("请选择" != $(this).val()) {\n              $(dom).sui().setOpinion($(this).val(), \'cyyj\');\n            }\n          });\n        }\n      });\n    },\n    //个人意见\n    personOpinion: function personOpinion(dom, systemOpinion, strategycode) {\n      if (SUI.Util.browserType() === \'phone\') {\n        // 保存意见\n        var saveOpinion = function saveOpinion(personalOpinion) {\n          $.ajax({\n            url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.savePersonalOpinion.biz.ext",\n            type: \'post\',\n            dataType: "json",\n            data: {\n              value: personalOpinion\n            },\n            success: function success(data) {\n              if (!data.exception) {\n                layer.msg(\'保存成功\');\n              } else {\n                SUI.Util.layerAlert({\n                  content: \'保存失败！\'\n                });\n              }\n            }\n          });\n        };\n\n        var opinionHtml = \'<div class="strategyOpinion person-opinion-mar">\' + \'<span class="person-opinion-title">常用意见:</span>\' + \'<div class="selectPersonalOpinion person-opinion-content" style="position: absolute;display: inline-block;">\' + \'<input value="" class="form-control showOpinion" type="text" readonly="true">\' + \'<div class="person-opinion-show"><span style="position:absolute;"><b class="person-opinion-arrow"></b></span></div>\' + \'</div><span class="btn btn-primary savePersonalOpinion person-opinion-save">保存意见</span></div>\';\n\n        if (!$(dom).find(\'.strategyOpinion\').length) {\n          $(dom).append(opinionHtml);\n          var opinionWidth = $(dom).find(\'.strategyOpinion\').width() - 162;\n          $(dom).find(\'.strategyOpinion\').find(\'.selectPersonalOpinion\').css(\'width\', opinionWidth + \'px\');\n        }\n\n        $.ajax({\n          url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.qureyPersonalOpinions.biz.ext",\n          type: "post",\n          dataType: "json",\n          data: {},\n          success: function success(data) {\n            var list = data.personalOpinions;\n\n            if (list && list.length) {\n              $.each(list, function (i, v) {\n                if (v.extend1 == \'y\') {\n                  $(dom).sui().setOpinion(v.value, \'cyyj\');\n                  $(dom).find(\'.showOpinion\').val(v.value);\n                }\n              });\n            }\n          }\n        });\n        $(dom).find(\'.selectPersonalOpinion\').unbind(\'click\').on(\'click\', function () {\n          var offsetTop = $(window).scrollTop();\n          var opinionUrl = \'\';\n\n          if (systemOpinion && systemOpinion.length) {\n            opinionUrl = __basePath + "_libs/plugins/mechanism/opinion.html?hasSystem=true&strategycode=" + strategycode + "&offsetTop=" + offsetTop;\n          } else {\n            opinionUrl = __basePath + "_libs/plugins/mechanism/opinion.html?hasSystem=false&strategycode=" + strategycode + "&offsetTop=" + offsetTop;\n          }\n\n          iPortal.openWindow(opinionUrl, function (data) {\n            var opinion = JSON.parse(data).opinion;\n            $(dom).find(\'.showOpinion\').val(opinion);\n            $(dom).sui().setOpinion(opinion, \'cyyj\');\n          });\n        });\n        $(dom).find(\'.savePersonalOpinion\').unbind(\'click\').on(\'click\', function () {\n          var personalOpinion = $(dom).find("textarea").val();\n\n          if (personalOpinion) {\n            saveOpinion(personalOpinion);\n          } else {\n            SUI.Util.layerAlert({\n              content: \'不能保存空的常用意见！\'\n            });\n          }\n        });\n      } else {\n        var opinion = $(dom).find("textarea");\n        $.ajax({\n          url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.qureyPersonalOpinions.biz.ext",\n          type: "post",\n          dataType: "json",\n          data: {},\n          success: function success(data) {\n            var list = data.personalOpinions;\n            var opinionHtml = \'<div class="strategyOpinion person-opinion-mar" style="overflow:hidden;">\' + \'<span class="person-opinion-title">常用意见:</span>\' + \'<div class="selectPersonalOpinion person-opinion-content" style="position: absolute;display: inline-block;">\' + \'<input value="" class="form-control showOpinion" type="text" readonly="true" />\' + \'<div class="person-opinion-show" >\' + \'<span style="position:absolute;"><b class="person-opinion-arrow"></b></span>\' + \'</div>\' + \'<div class="person-opinion-handle">\' + \'<div><input class="form-control opinion-search-input" /><div class="btn btn-primary opinion-search">搜索</div></div>\' + \'<table class="table table-hover table-striped person-opinion-table" >\' + \'<thead><tr><th style="width:75%;">处理意见</th><th style="width:15%;">设为默认</th><th style="width:10%;">删除意见</th></tr></thead>\' + \'<tbody></tbody>\' + \'</table>\' + \'</div>\' + \'</div>\' + \'<span class="btn btn-primary savePersonalOpinion person-opinion-save" style="float: right;">保存意见</span>\' + \'</div>\';\n\n            if (!$(dom).find(\'.strategyOpinion\').length) {\n              $(dom).append(opinionHtml);\n              var opinionWidth = $(dom).find(\'.strategyOpinion\').width() - 162;\n              $(dom).find(\'.strategyOpinion\').find(\'.selectPersonalOpinion\').css(\'width\', opinionWidth + \'px\');\n            } // 如果有系统意见 则和个人意见合并\n\n\n            if (systemOpinion && systemOpinion.length) {\n              var le = list.length - 1;\n\n              for (var i = le; i > -1; i--) {\n                var isCommon = false;\n                $.each(systemOpinion, function (j, s) {\n                  if (!isCommon) {\n                    if (list[i].value === s.VALUE) {\n                      list.splice(i, 1);\n                      isCommon = true;\n                    }\n                  }\n                });\n              }\n\n              list.push.apply(list, systemOpinion);\n            }\n\n            renderOpinion(list);\n            $(dom).on(\'click\', \'.opinion-search\', function () {\n              var searchVal = $(dom).find(\'.opinion-search-input\').val();\n              var searchList = [];\n\n              if (list.length) {\n                $.each(list, function (i, v) {\n                  if (v.value && v.value.indexOf(searchVal) > -1 || v.VALUE && v.VALUE.indexOf(searchVal) > -1) {\n                    searchList.push(v);\n                  }\n                });\n              }\n\n              renderOpinion(searchList);\n            }); // 回车事件的监听\n\n            $(dom).bind(\'keyup\', \'.opinion-search-input\', function (e) {\n              if (e.keyCode === 13) {\n                var searchVal = $(dom).find(\'.opinion-search-input\').val();\n                var searchList = [];\n\n                if (list.length) {\n                  $.each(list, function (i, v) {\n                    if (v.value && v.value.indexOf(searchVal) > -1 || v.VALUE && v.VALUE.indexOf(searchVal) > -1) {\n                      searchList.push(v);\n                    }\n                  });\n                }\n\n                renderOpinion(searchList);\n              }\n            });\n\n            function renderOpinion(list) {\n              var html = "";\n              var defaultOpinion;\n\n              if (!list.length) {\n                var html = \'<tr><td colspan="3">未找到符合条件的意见</td></tr>\';\n                $(dom).find("tbody").html(html);\n              }\n\n              for (var i = 0; i < list.length; i++) {\n                if (list[i].id) {\n                  if ("y" == list[i].extend1) {\n                    html += \'<tr><td class="person-opinion-table-td"><p class="person-opinion-table-p" >\' + list[i].value + \'</p><td style="vertical-align:middle;"><input type="radio" name="personalOpinion" value="\' + list[i].id + \'" opinion="\' + list[i].value + \'" checked="true"/></td><td><span class="btn btn-sm btn-danger wf-delete" id="\' + list[i].id + \'"><i class="fa fa-close"></i> 删除</span></td></td><tr>\';\n                    defaultOpinion = list[i].value;\n                  } else {\n                    html += \'<tr><td class="person-opinion-table-td"><p class="person-opinion-table-p">\' + list[i].value + \'</p><td style="vertical-align:middle;"><input type="radio" name="personalOpinion" value="\' + list[i].id + \'" opinion="\' + list[i].value + \'" /></td><td><span class="btn btn-sm btn-danger wf-delete" id="\' + list[i].id + \'"><i class="fa fa-close"></i> 删除</span></td></td><tr>\';\n                  }\n                } else {\n                  html += \'<tr><td class="person-opinion-table-td" colspan="3"><p class="person-opinion-table-p">\' + list[i].VALUE + \'</p></td></tr>\';\n                }\n              }\n\n              if (defaultOpinion) {\n                $(dom).sui().setOpinion(defaultOpinion, \'cyyj\');\n                $(".showOpinion", dom).val(defaultOpinion);\n              }\n\n              $(dom).find("tbody").html(html);\n              $("input[name=\'personalOpinion\']", dom).iCheck(SUI.settings().iCheck());\n              $(dom).find(\'.selectPersonalOpinion\').unbind(\'click\').on(\'click\', function () {\n                if ($(this).find("table").parent().is(":hidden")) {\n                  $(this).find("table").parent().show();\n                } else {\n                  $(this).find("table").parent().hide();\n                }\n              });\n              $(document).mouseup(function (e) {\n                //点击空白处隐藏\n                var _con = $("#selectPersonalOpinion"); // 设置目标区域\n\n\n                if (!_con.is(e.target) && _con.has(e.target).length === 0) {\n                  // Mark 1\n                  $(dom).find("table").parent().hide();\n                }\n              });\n              $("input[name=\'personalOpinion\']", dom).on(\'ifClicked\', function () {\n                var id = $(this).val();\n                var selectedOpinion = $(this).attr(\'opinion\');\n                $(dom).sui().setOpinion(selectedOpinion, \'cyyj\');\n                $("#showOpinion").val(selectedOpinion);\n\n                if ($(this).is(":checked")) {\n                  $.ajax({\n                    url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.cancleDefualtOpinion.biz.ext",\n                    type: "post",\n                    dataType: "json",\n                    data: {\n                      ids: id\n                    },\n                    success: function success(data) {\n                      $("input[name=\'personalOpinion\']", dom).iCheck(\'uncheck\');\n                      layer.msg("设置成功");\n                    }\n                  });\n                  return;\n                }\n\n                $.ajax({\n                  url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.updatePersonalOpinion.biz.ext",\n                  type: "post",\n                  dataType: "json",\n                  data: {\n                    ids: id\n                  },\n                  success: function success(data) {\n                    layer.msg("设置成功");\n                  }\n                });\n              });\n              $(dom).find(\'.savePersonalOpinion\').unbind(\'click\').on(\'click\', function () {\n                var personalOpinion = opinion.val();\n\n                if ($.trim(personalOpinion) == "" || $.trim(personalOpinion) == undefined || $.trim(personalOpinion) == null) {\n                  // layer.alert("不能保存空的常用意见！");\n                  SUI.Util.layerAlert({\n                    content: \'不能保存空的常用意见！\'\n                  });\n                } else {\n                  $.ajax({\n                    url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.savePersonalOpinion.biz.ext",\n                    type: \'post\',\n                    dataType: "json",\n                    data: {\n                      value: personalOpinion\n                    },\n                    success: function success(data) {\n                      if (!data.exception) {\n                        //改为保存后局部刷新\n                        layer.msg("保存为常用意见成功"); //保存完成后完成一次刷新数据\n\n                        $.ajax({\n                          url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.qureyPersonalOpinions.biz.ext",\n                          type: "post",\n                          dataType: "json",\n                          data: {\n                            strategycode: strategycode\n                          },\n                          success: function success(data) {\n                            var list = data.personalOpinions;\n                            var html1 = "";\n                            var defaultOpinion;\n\n                            if (systemOpinion && systemOpinion.length) {\n                              var le = list.length - 1;\n\n                              for (var i = le; i > -1; i--) {\n                                var isCommon = false;\n                                $.each(systemOpinion, function (j, s) {\n                                  if (!isCommon) {\n                                    if (list[i].value === s.VALUE) {\n                                      list.splice(i, 1);\n                                      isCommon = true;\n                                    }\n                                  }\n                                });\n                              }\n\n                              list.push.apply(list, systemOpinion);\n                            }\n\n                            for (var i = 0; i < list.length; i++) {\n                              if (list[i].id) {\n                                if ("y" == list[i].extend1) {\n                                  html1 += \'<tr><td class="person-opinion-table-td"><p class="person-opinion-table-p" >\' + list[i].value + \'</p><td style="vertical-align:middle;"><input type="radio" name="personalOpinion" value="\' + list[i].id + \'" opinion="\' + list[i].value + \'" checked="true"/></td><td><span class="btn btn-sm btn-danger wf-delete" id="\' + list[i].id + \'"><i class="fa fa-close"></i> 删除</span></td></td><tr>\';\n                                  defaultOpinion = list[i].value;\n                                } else {\n                                  html1 += \'<tr><td class="person-opinion-table-td"><p class="person-opinion-table-p">\' + list[i].value + \'</p><td style="vertical-align:middle;"><input type="radio" name="personalOpinion" value="\' + list[i].id + \'" opinion="\' + list[i].value + \'" /></td><td><span class="btn btn-sm btn-danger wf-delete" id="\' + list[i].id + \'"><i class="fa fa-close"></i> 删除</span></td></td><tr>\';\n                                }\n                              } else {\n                                html1 += \'<tr><td class="person-opinion-table-td" colspan="3"><p class="person-opinion-table-p">\' + list[i].VALUE + \'</p></td></tr>\';\n                              }\n                            }\n\n                            $(dom).find("tbody").empty();\n                            $(dom).find("tbody").html(html1);\n                            $("input[name=\'personalOpinion\']", dom).iCheck(SUI.settings().iCheck());\n                            $("input[name=\'personalOpinion\']", dom).on(\'ifClicked\', function () {\n                              var id = $(this).val();\n                              var selectedOpinion = $(this).attr(\'opinion\');\n                              $(dom).sui().setOpinion(selectedOpinion, \'cyyj\');\n                              $("#showOpinion").val(selectedOpinion);\n\n                              if ($(this).is(":checked")) {\n                                return;\n                              }\n\n                              $.ajax({\n                                url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.updatePersonalOpinion.biz.ext",\n                                type: "post",\n                                dataType: "json",\n                                data: {\n                                  ids: id\n                                },\n                                success: function success(data) {\n                                  layer.msg("设置成功");\n                                }\n                              });\n                            });\n                            $("table tr span", dom).unbind(\'click\').on(\'click\', function (event) {\n                              event.stopPropagation();\n                              var id = $(this).attr("id");\n                              $.ajax({\n                                url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.deletePersonalOpinion.biz.ext",\n                                type: "post",\n                                dataType: "json",\n                                data: {\n                                  ids: id\n                                },\n                                success: function success(data) {\n                                  if (!data.exception) {\n                                    layer.msg("删除常用意见成功");\n                                    $(\'input[value="\' + id + \'"]\', dom).parent().parent().parent().remove();\n                                  } else {\n                                    layer.msg("删除常用意见失败");\n                                  }\n                                }\n                              });\n                            });\n                            $("table tr p", dom).unbind(\'click\').on(\'click\', function (e) {\n                              e.stopPropagation();\n                              $(dom).sui().setOpinion($(this).text(), \'cyyj\');\n                              $("#showOpinion").val($(this).text());\n                              $(dom).find("table").parent().hide();\n                            });\n                          }\n                        });\n                      } else {\n                        // layer.alert("保存为常用意见失败");\n                        SUI.Util.layerAlert({\n                          content: \'保存为常用意见失败\'\n                        });\n                      }\n                    }\n                  });\n                }\n              });\n              $("table tr span", dom).unbind(\'click\').on(\'click\', function (event) {\n                event.stopPropagation();\n                var id = $(this).attr("id");\n                $.ajax({\n                  url: "com.sudytech.portalone.base.strategyOpinion.strategyOpinion.deletePersonalOpinion.biz.ext",\n                  type: "post",\n                  dataType: "json",\n                  data: {\n                    ids: id\n                  },\n                  success: function success(data) {\n                    if (!data.exception) {\n                      layer.msg("删除常用意见成功");\n                      $(\'input[value="\' + id + \'"]\', dom).parent().parent().parent().remove();\n                    } else {\n                      // layer.alert("删除常用意见失败");\n                      SUI.Util.layerAlert({\n                        content: \'删除常用意见失败\'\n                      });\n                    }\n                  }\n                });\n              });\n              $("table tr .person-opinion-table-td", dom).unbind(\'click\').on(\'click\', function (e) {\n                e.stopPropagation();\n                $(dom).sui().setOpinion($(this).text(), \'cyyj\');\n                $(".showOpinion", dom).val($(this).text());\n                $(dom).find("table").parent().hide();\n              });\n            }\n          }\n        });\n      }\n    },\n    //管理页面获取查询条件\n    getConditions: function getConditions() {\n      var conditions = [];\n      $(\'[msp-condition]\').each(function () {\n        var obj = {};\n        /*处理多字段查询条件*/\n\n        var attrName = $(this).attr(\'name\') || \'\',\n            nameArr = attrName.split(\',\');\n        obj.propertyName = JSON.stringify(nameArr);\n        obj.propertyValue = $(this).sui() && $(this).sui().getValue() ? $(this).sui().getValue() : "";\n        obj.operate = $(this).attr(\'msp-condition\');\n\n        if ($(this).hasClass(\'sui-selectmechanismtool\')) {\n          obj.type = \'org\';\n        } // 如果是单选框 并且 配置了允许多个值\n\n\n        if ($(this).hasClass(\'sui-select\') && $(this).attr(\'ismultvalue\') == \'true\') {\n          obj.type = \'select\';\n\n          if (obj.propertyValue == \'$noValue$\') {\n            obj.propertyValue = \'\';\n          }\n        }\n\n        conditions.push(obj);\n      });\n      return conditions;\n    }\n  };\n\n  var _fn = function _fn(fn) {\n    var Fn = function Fn(args, val) {\n      return new Fn.prototype.init(args, val);\n    };\n\n    Fn.pt = Fn.prototype = {\n      constructor: Fn\n    };\n\n    var FnClass = Fn.pt.init = function (args, val) {\n      if ($.type(args) === "number" || $.type(args) === "string") {\n        if ($.type(val) === "undefined") {\n          this.value = fn[args];\n          return this;\n        }\n\n        fn[args] = val;\n      }\n\n      if ($.isPlainObject(args)) {\n        $.extend(true, fn, args);\n      }\n\n      this.value = fn;\n      return this;\n    };\n\n    FnClass.prototype = Fn.pt;\n    return Fn;\n  };\n\n  var Store = {\n    dataSource: {},\n    formFields: {},\n    dataSourceMap: {}\n  };\n  var Correlations = [];\n  var _correlationActionsMap = [{\n    name: \'切换值域\',\n    value: "toggleDataSource",\n    tip: \'<p>返回值域数组，例如return [{"name":"南京", "value":"025"}, {"name":"上海","value":"021"}]<p>\'\n  }, {\n    name: "显示/隐藏",\n    value: "toggle",\n    tip: "返回布尔型, true 显示, false 隐藏"\n  }, {\n    name: \'修改值\',\n    value: \'changeValue\',\n    tip: "返回目标控件的新值，如果没有返回值或返回值为undefined, 则目标控件值等于源控件"\n  }, {\n    name: \'自定义\',\n    value: "custom",\n    tip: "自定义，则控件之间的逻辑关系完全自定义处理"\n  }];\n  var _correlationActions = {\n    _toggleDataSource: function _toggleDataSource(comp1, comp2) {\n      var val2 = $(comp2).sui().getValue();\n      var obj = this;\n      var sourceKey = this.dataSourceMap.origion;\n      SUI.store().dataSourceMap().getDataSource(this.dataSourceMap.origion, val2, function (data) {\n        if (!data || !data.length) {\n          return;\n        }\n\n        var _data = [];\n        $.each(data, function (index, d) {\n          _data.push({\n            name: SUI.Util.getObjectPropVal(obj.dataSourceMap.nameKey, d[sourceKey]),\n            value: SUI.Util.getObjectPropVal(obj.dataSourceMap.valueKey, d[sourceKey])\n          });\n        });\n        var conf = $(comp1).sui().getConfig();\n        conf.properties.dataSource = _data;\n        conf.value = _data[0][\'value\'];\n        $(comp1).sui().setConfig(conf);\n      });\n    },\n    toggleDataSource: function toggleDataSource(comp1, comp2, event, argsFn) {\n      if (this.dataSourceMap && this.dataSourceMap.origion) {\n        return _correlationActions._toggleDataSource.call(this, comp1, comp2);\n      }\n\n      var val2 = $(comp2).sui().getValue();\n      var args = argsFn(val2); // if (!args || (typeof args == "object" && $.isEmptyObject(args))) {\n      //     return;\n      // }\n\n      if (event.type === "change") {\n        if (typeof args == "function") {\n          var _argsFn = Util.getFunctionBody(args, true);\n\n          if (_argsFn && /callback/.test(_argsFn.params)) {\n            return args(function (_data) {\n              if (!_data || !_data.length) {\n                return;\n              }\n\n              var conf = $(comp1).sui().getConfig();\n              conf.properties.dataSource = _data;\n              conf.value = _data[0][\'value\'];\n              $(comp1).sui().setConfig(conf);\n            });\n          } else {\n            var args = args();\n          }\n        }\n\n        if (typeof args !== "undefined") {\n          var conf = $(comp1).sui().getConfig();\n          conf.properties.dataSource = args;\n          conf.value = args[0][\'value\'];\n          $(comp1).sui().setConfig(conf);\n        } else {\n          var classList = [\'sui-select\', \'sui-multiselect\'];\n\n          if (_correlationActions.classIndexOf($(comp1).attr(\'class\'), classList)) {\n            _correlationActions.defaultToggleDataSource(comp1);\n          }\n        }\n      }\n    },\n    toggle: function toggle(comp1, comp2, event, argsFn) {\n      var val2 = $(comp2).sui().getValue();\n      var args = argsFn(val2);\n\n      if (event.type == "change") {\n        var show = true;\n\n        if (typeof args === "boolean") {\n          show = args;\n        } else if (typeof args === "function") {\n          var _argsFn = Util.getFunctionBody(args, true);\n\n          if (/callback/.test(_argsFn.params)) {\n            return args(function (_data) {\n              typeof _data !== "undefined" && $(comp1).toggle(_data ? true : false);\n            });\n          } else {\n            show = args();\n          }\n        }\n\n        $(comp1).toggle(show);\n      }\n    },\n    changeValue: function changeValue(comp1, comp2, event, argsFn) {\n      var val2 = $(comp2).sui().getValue();\n      var args = argsFn(val2);\n\n      if (event.type == "change") {\n        if (typeof args == "function") {\n          var _argsFn = Util.getFunctionBody(args, true);\n\n          if (/callback/.test(_argsFn.params)) {\n            return args(function (_data) {\n              if (typeof _data !== "undefined") {\n                $(comp1).sui().setValue(_data);\n              } else {\n                $(comp1).sui().setValue(val2);\n              }\n            });\n          } else {\n            var args = args();\n          }\n        }\n\n        if (typeof args !== "undefined") {\n          $(comp1).sui().setValue(args);\n        } else {\n          _correlationActions.defaultChange(comp1, val2); // $(comp1).sui().setValue(val2);\n\n        }\n\n        $(comp1).trigger("change");\n      }\n    },\n    referenceValue: function referenceValue(comp1, comp2, event, argsFn) {\n      var val2 = $(comp2).sui().getValue();\n\n      if (event.type == "change") {\n        $(comp1).sui().setValue(val2);\n        $(comp1).trigger(\'change\');\n      }\n    },\n    classIndexOf: function classIndexOf(compClass, classList) {\n      var isHave = false;\n\n      if (classList.length) {\n        $.each(classList, function (i, v) {\n          if (compClass.indexOf(v) > -1) {\n            isHave = true;\n          }\n        });\n      }\n\n      return true;\n    },\n    defaultChange: function defaultChange(comp, val2) {\n      var compClass = $(comp).attr(\'class\');\n      var textList = [\'sui-text\', \'sui-formtitle\', \'sui-fieldtitle\', \'sui-childtitle\', \'sui-primary\', \'sui-success\', \'sui-warning\', \'sui-error\'];\n\n      if (compClass.indexOf(\'sui-input\') > -1) {\n        if ($(comp).attr(\'initvaluetype\')) {\n          _correlationActions.inputChange(comp, $(comp).attr(\'initvaluetype\'), val2);\n        }\n      } else if (_correlationActions.classIndexOf(compClass, textList)) {\n        var dataSource = $(comp).attr(\'dataSource\') || "";\n\n        _correlationActions.textChange(comp, dataSource, val2);\n      }\n    },\n    //input控件被触发重新获取数据源\n    inputChange: function inputChange(comp, initvaluetype, val2) {\n      if (initvaluetype == \'userInfo\') {\n        if (SUI.Util.getQueryString(\'mode\') == \'print\') {\n          var initvalue = $(comp).attr(\'initvalue\');\n          $(comp).sui().setValue(Coreplus.getContext(initvalue));\n        }\n      } else if (initvaluetype == \'serviceTable\') {\n        if (Coreplus && Coreplus.businessDone()) {\n          var initvalue = $(comp).attr(\'initvalue\');\n          var initdisplayname = $(comp).attr(\'initdisplayname\');\n          Coreplus.processServiceTableData({}, true, initdisplayname, initvalue, true);\n        } else {\n          $(document).on(\'businessDone\', function () {\n            _correlationActions.inputChange(comp, initvaluetype, val2);\n          });\n        }\n      } else if (initvaluetype == \'customCode\') {\n        var customCode = $(comp).attr(\'customCode\') || \'\',\n            val = eval(\'(function(){\' + customCode + \'})()\');\n        $(comp).sui().setValue(val);\n      } else if ($(comp).attr(\'inputtype\') == \'textarea\') {\n        //文本域控件\n        if (SUI.Util.getQueryString(\'mode\') == \'print\') {\n          var initvalue = $(comp).attr(\'initvalue\');\n          $(comp).sui().setValue(Coreplus.getContext(initvalue));\n        }\n      } else {\n        $(comp).sui().setValue(val2);\n      }\n    },\n    // 所有文本控件被触发重新获取数据源\n    textChange: function textChange(comp, dataSource, val2) {\n      if (dataSource != "") {\n        if (dataSouce == \'activityName\') {\n          $(comp).sui().setValue(wf2 && wf2.workflow.activity && wf2.workflow.activity.name || "");\n        } else {\n          $(comp).sui().setValue(Coreplus && Coreplus.getInitValue && Coreplus.getInitValue(dataSource) || "");\n        }\n      } else if ($(comp).attr(\'initvalue\')) {\n        if (Coreplus && Coreplus.businessDone()) {\n          var initvalue = $(comp).attr(\'initvalue\');\n          var initdisplayname = $(comp).attr(\'initdisplayname\');\n          Coreplus.processServiceTableData({}, true, initdisplayname, initvalue, true);\n        } else {\n          $(document).on(\'businessDone\', function () {\n            _correlationActions.textChange(comp, dataSource, val2);\n          });\n        }\n      } else {\n        $(comp).sui().setValue(val2);\n      }\n    },\n    //触发修改值域默认方法\n    defaultToggleDataSource: function defaultToggleDataSource(comp) {\n      var isHasDataSource = $(comp).attr(\'isHasDataSource\');\n\n      if (isHasDataSource == \'true\') {\n        if (Coreplus && Coreplus.businessDone()) {\n          var initdisplayname = $(comp).attr(\'initDisplayName\');\n          var name = $(\'comp\').attr(\'name\');\n          Coreplus.processServiceTableData({}, true, initdisplayname, name, false, true);\n        } else {\n          $(document).on(\'businessDone\', function () {\n            _correlationActions.defaultToggleDataSource(comp);\n          });\n        }\n      } else if ($(comp).indexOf(\'wf-dict\')) {\n        _correlationActions.dictDataSource(comp);\n      } else if ($(comp).attr(\'datamethod\') == \'remote\') {\n        var val = $(comp).sui().parse();\n        $(comp).sui().init(val);\n      }\n    },\n    dictDataSource: function dictDataSource(comp) {\n      var dictTypes = [];\n      var wf_ype = $(comp).attr(\'wf-type\');\n      dictTypes.push(wf_ype);\n\n      if (dictTypes.length) {\n        $.ajax({\n          type: \'POST\',\n          url: "com.sudytech.portalone.base.ui.queryDict.biz.ext",\n          data: jsonString({\n            dictTypes: dictTypes\n          }),\n          contentType: "text/json",\n          success: function success(data) {\n            var options = data.options;\n            var e = $(comp);\n            var dataSource = [];\n            var type = e.attr("wf-type");\n\n            for (var i = 0; i < options.length; i++) {\n              if (options[i].type == type) {\n                dataSource[dataSource.length] = {\n                  value: options[i].value,\n                  name: options[i].name\n                };\n                continue;\n              }\n\n              if (options[i].TYPE == type) {\n                //oracle字段为大写\n                dataSource[dataSource.length] = {\n                  value: options[i].VALUE,\n                  name: options[i].NAME\n                };\n              }\n            }\n\n            if ($(comp).zoo) {\n              var config = $(comp).zoo.getConfig();\n              config.properties.dataSource = dataSource;\n              $(comp).zoo.setConfig(config);\n            }\n          }\n        });\n      }\n    }\n  };\n\n  function _correlationItem(Corr) {\n    var callbackName = Corr.builtin ? Corr.callback : \'custom\';\n    var callbackIndex = Util.inArrayObj(\'value\', callbackName, _correlationActionsMap);\n\n    if (callbackIndex == -1) {\n      layer.msg(\'回调函数不存在\', {\n        icon: 0\n      });\n      return \'\';\n    }\n\n    var callback = _correlationActionsMap[callbackIndex];\n    var actionAttr = Corr.builtin ? \' correlation-builtin="\' + Corr.__corrkey + \'"\' : \' correlation-custom="\' + Corr.__corrkey + \'"\';\n    var tip = \' <a correlation-tip="\' + callbackIndex + \'" style="color:#9e9e9e" class="fa fa-question-circle"></a>\';\n    return \'<div class="correlation-row clearfix">\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-2"><a title="\' + Corr.name2 + \'">\' + Corr.name2 + \'</a></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-3"><a title="\' + Corr.event + \'">\' + Corr.event + \'</a></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-1"> <a title="\' + Corr.name1 + \'">\' + Corr.name1 + \'</a></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-4"><span title="\' + callback.value + \'">\' + callback.name + \'</span> \' + tip + \'</div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-5"><a style="color:#666;" \' + actionAttr + \' class="correlation-builtin fa fa-pencil"></a> <a correlation-remove="\' + Corr.__corrkey + \'" class="correlation-remove fa fa-minus-circle"></a></div>\\\n\t\t\t\t\t</div>\';\n  }\n\n  function _listCorrelations() {\n    var list = "";\n\n    for (var index = 0; index < Correlations.length; index++) {\n      var Corr = Correlations[index];\n      list += _correlationItem(Corr);\n    }\n\n    var html = \'<div class="correlation">\\\n\t\t\t\t\t\t\t<div class="correlation-wrapper" >\\\n\t\t\t\t\t\t\t\t<div class="correlation-head clearfix">\\\n\t\t\t\t\t\t\t\t\t<div class="correlation-col correlation-col-2">源控件</div>\\\n\t\t\t\t\t\t\t\t\t<div class="correlation-col correlation-col-3">触发事件</div>\\\n\t\t\t\t\t\t\t\t\t<div class="correlation-col correlation-col-1">目标控件</div>\\\n\t\t\t\t\t\t\t\t\t<div class="correlation-col correlation-col-4">触发动作</div>\\\n\t\t\t\t\t\t\t\t\t<div class="correlation-col correlation-col-5">操作</div>\\\n\t\t\t\t\t\t\t\t</div>\\\n\t\t\t\t\t\t\t\t<div class="correlation-body">\' + list + "</div>\\\n\t\t\t\t\t\t   </div>\\\n\t\t\t\t\t</div>";\n    return html;\n  }\n\n  var _correlationAdd = function _correlationAdd(layero) {\n    var $layer = $(layero);\n\n    if ($layer.find(\'.correlation-addrow\').length) {\n      return layer.msg(\'当前关联尚未配置完成\', {\n        icon: 0\n      });\n    }\n\n    var html = $(\'<div class="correlation-row correlation-addrow clearfix">\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-2"><div class="correlation-add-comp2"></div></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-3"><div class="correlation-add-event"></div></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-1"><div class="correlation-add-comp1"></div></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-4"><div class="correlation-add-callback"></div></div>\\\n\t\t\t\t\t\t\t<div class="correlation-col correlation-col-5"><a title="确定添加" class="correlation-add fa fa-check-circle"></a> <a title="删除" class="correlation-remove fa fa-minus-circle"></a></div>\\\n\t\t\t\t\t</div>\');\n    $layer.find(\'.correlation-body\').append(html);\n    html.find(\'.correlation-remove\').on(\'click\', function () {\n      html.remove();\n    });\n    var events = [\'change\'];\n    var callbacks = _correlationActionsMap;\n    var data = SUI.store().formFields().components;\n    var comp1 = SUI.create(\'select\', html.find(\'.correlation-add-comp1\'));\n    comp1.zoo.setConfig({\n      mode: \'editable\',\n      properties: {\n        selectStyle: \'select\',\n        dataSource: [{\n          name: "目标控件",\n          value: ""\n        }].concat(data)\n      }\n    });\n    var comp2 = SUI.create(\'select\', html.find(\'.correlation-add-comp2\'));\n    comp2.zoo.setConfig({\n      mode: \'editable\',\n      properties: {\n        selectStyle: \'select\',\n        dataSource: [{\n          name: "源控件",\n          value: ""\n        }].concat(data)\n      }\n    });\n    var event = SUI.create(\'select\', html.find(\'.correlation-add-event\'));\n    event.zoo.setConfig({\n      mode: \'editable\',\n      properties: {\n        selectStyle: \'select\',\n        dataSource: [{\n          name: "触发事件",\n          value: ""\n        }].concat(events)\n      }\n    });\n    var callback = SUI.create(\'select\', html.find(\'.correlation-add-callback\'));\n    callback.zoo.setConfig({\n      mode: \'editable\',\n      properties: {\n        selectStyle: \'select\',\n        dataSource: [{\n          name: "触发动作",\n          value: ""\n        }].concat(callbacks)\n      }\n    });\n    html.find(\'.correlation-add\').on(\'click\', function () {\n      var obj = {};\n      var comp1Val = comp1.zoo.getValue();\n      var comp2Val = comp2.zoo.getValue();\n      var eventVal = event.zoo.getValue();\n      var callbackVal = callback.zoo.getValue();\n      var error = "";\n\n      switch (true) {\n        case !comp1Val.length:\n          error = "未设置控件";\n          break;\n\n        case !comp2Val.length:\n          error = "未设置关联控件";\n          break;\n\n        case comp2Val == comp1Val:\n          error = "不能关联自己";\n          break;\n\n        case !eventVal.length:\n          error = "未设置关联事件";\n          break;\n\n        case !callbackVal.length:\n          error = "未设置回调函数";\n          break;\n\n        default:\n          break;\n      }\n\n      if (error.length) {\n        return layer.msg(error, {\n          icon: 0\n        });\n      }\n\n      if (callbackVal == \'custom\') {\n        callbackVal = function callbackVal() {};\n      }\n\n      var item = SUI.correlation.get(comp1Val, comp2Val, eventVal, callbackVal);\n\n      if (item == false) {\n        var _html = _correlationItem(SUI.correlation.add(comp1Val, comp2Val, eventVal, callbackVal));\n\n        $layer.find(\'.correlation-body\').append(_html);\n        html.remove();\n        layer.msg(\'创建成功\', {\n          icon: 1\n        });\n      } else {\n        layer.msg(\'关联已存在\', {\n          icon: 0\n        });\n      }\n    });\n  };\n\n  var _correlationDataSourcePanel = function _correlationDataSourcePanel(layero, obj) {\n    if (!obj.dataSourceMap) {\n      obj.dataSourceMap = {};\n    }\n\n    var dataSourceMap = obj.dataSourceMap;\n    var dataSource = SUI.create(\'select\', $(layero).find(\'.correlation-datasource-origin\')[0]);\n    var origion = typeof SUI.store().dataSourceMap().origion == "function" ? SUI.store().dataSourceMap().origion() : SUI.store().dataSourceMap().origion;\n    dataSource.zoo.setConfig({\n      mode: \'editable\',\n      value: dataSourceMap.origion ? dataSourceMap.origion : \'\',\n      properties: {\n        selectStyle: \'select\',\n        dataSource: [{\n          name: "选择值域源",\n          value: ""\n        }].concat(origion)\n      }\n    });\n    var dataSourceName = SUI.create(\'input\', $(layero).find(\'.correlation-datasource-name\')[0]);\n    dataSourceName.zoo.setConfig({\n      mode: \'editable\',\n      inputType: \'text\',\n      value: dataSourceMap.nameKey ? dataSourceMap.nameKey : \'\',\n      prefix: \'显示值KEY：\',\n      placeholder: \'如 group.name.text\',\n      properties: {}\n    });\n    var dataSourceValue = SUI.create(\'input\', $(layero).find(\'.correlation-datasource-value\')[0]);\n    dataSourceValue.zoo.setConfig({\n      mode: \'editable\',\n      inputType: \'text\',\n      value: dataSourceMap.valueKey ? dataSourceMap.valueKey : \'\',\n      prefix: \'实际值KEY：\',\n      placeholder: \'如 id\',\n      properties: {}\n    });\n  };\n\n  var _correlationBuiltin = function _correlationBuiltin(key) {\n    var objIndex = Util.inArrayObj(\'__corrkey\', key, Correlations);\n    if (objIndex == -1) return;\n    var obj = Correlations[objIndex];\n    var isDataSource = obj.callback == \'toggleDataSource\';\n\n    if (!obj.argsBody.length) {\n      var bodyStr = Util.getFunctionBody(obj.args);\n      obj.argsBody = bodyStr || \'// 关联代码\';\n    }\n\n    var argsBody = $.trim(obj.argsBody);\n    var tip = \'value为源控件值，根据判断value值，来计算并确定触发动作的相应的返回值。\\\n<p>如切换值域：</p>\\\n<p>switch(value){\\\n<p style="text-indent:2em;">case "1":</p>\\\n<p style="text-indent:4em;">return [{"name":"南京", "value":"025"},{"name":"上海","value":"021"}];</p>\\\n<p style="text-indent:2em;">default:</p>\\\n<p style="text-indent:4em;">return function(callback){</p>// 可以是ajax获取，或其他方式，最终以调用回调callback返回\\\n<p style="text-indent:6em;">$.ajax({</p>\\\n<p style="text-indent:8em;">success:function(data){</p>\\\n<p style="text-indent:10em;">callback(data); // 通过callback返回值域数组 </p>\\\n<p style="text-indent:8em;">}</p>\\\n<p style="text-indent:6em;">})</p>\\\n<p style="text-indent:4em;">}</p>\\\n<p>}</p>\';\n    var title = \'（参数：[value] 组件的值）<i style="font-size:16px; color:#FF9800;" class="correlation-builtn-tip fa fa-question-circle"></i>\';\n    var content = \'<div class="correlation-editor"><textarea>\' + argsBody + \'</textarea></div>\';\n\n    if (isDataSource) {\n      var dataSourcePanel = \'<div class="correlation-datasource-origin"></div>\\\n\t\t\t<div class="correlation-form-item"><div class="correlation-datasource-name"></div></div>\\\n\t\t\t<div class="correlation-form-item"><div class="correlation-datasource-value"></div></div>\'; // var tab = \'<div class="correlation-tab"><a class="tab-item cur">配置值域</a><a class="tab-item">自定义\' + title + \'</a></div>\';\n\n      var tab = \'<div class="correlation-tab"><a class="tab-item">自定义\' + title + \'</a></div>\';\n      var tabContent = \'<div class="correlation-tabcontent"><div class="tab-content correlation-datasource-pannel">\' + dataSourcePanel + \'</div><div class="tab-content">\' + content + \'</div></div>\';\n      content = tab + tabContent;\n    }\n\n    layer.open({\n      type: 1,\n      title: isDataSource ? false : \'内置关联函数\' + title,\n      content: content,\n      btn: ["保存", "取消"],\n      area: ["480px", "300px"],\n      success: function success(layero, index) {\n        $(layero).find(\'.correlation-builtn-tip\').on("mousedown", function (e) {\n          layer.alert(tip, {\n            icon: 3,\n            title: \'内置函数提示\'\n          });\n        });\n\n        if (isDataSource) {\n          $(layero).find(\'.tab-item\').on("click", function () {\n            var index = $(this).index();\n            $(this).addClass(\'cur\').siblings().removeClass(\'cur\');\n            $(\'.correlation-tabcontent\', layero).find(\'.tab-content\').hide().eq(index).show();\n          }).eq(0).trigger(\'click\');\n\n          _correlationDataSourcePanel(layero, obj);\n        }\n      },\n      yes: function yes(index, layero) {\n        var tabText = isDataSource ? \'内容已修改，将替换原有的配置，是否保存？\' : \'内容已修改，将替换原有关联方法，是否保存？\';\n        var val = $(layero).find(\'textarea\').val() || \'{}\';\n\n        if (isDataSource) {\n          var origion = $(layero).find(\'.correlation-datasource-origin\').sui().getValue();\n          var name = $(layero).find(\'.correlation-datasource-name\').sui().getValue();\n          var value = $(layero).find(\'.correlation-datasource-value\').sui().getValue();\n\n          if (origion) {\n            if (!name || !value) {\n              return layer.msg(\'显示值KEY和实际值KEY不能为空！\', {\n                icon: 0\n              });\n            }\n          }\n\n          obj.dataSourceMap = {\n            origion: origion,\n            nameKey: name,\n            valueKey: value\n          };\n        }\n\n        if (val != argsBody) {\n          layer.confirm(tabText, {\n            title: "提示",\n            icon: 3\n          }, function (idx) {\n            obj.argsBody = val;\n            layer.msg(\'已保存修改\', {\n              icon: 1\n            });\n            layer.close(index);\n          });\n        } else {\n          layer.msg(\'保存成功\', {\n            icon: 1\n          });\n          layer.close(index);\n        }\n      }\n    });\n  };\n\n  var _correlationCustom = function _correlationCustom(key) {\n    var objIndex = Util.inArrayObj(\'__corrkey\', key, Correlations);\n    if (objIndex == -1) return;\n    var obj = Correlations[objIndex];\n\n    if (!obj.callbackBody) {\n      var bodyStr = Util.getFunctionBody(obj.callback);\n      obj.callbackBody = bodyStr || \'// 关联代码\';\n    }\n\n    var callbackBody = $.trim(obj.callbackBody);\n    layer.open({\n      type: 1,\n      title: \'自定义回调函数(参数：[comp1, comp2, event, args])\',\n      content: \'<div class="correlation-editor"><textarea>\' + callbackBody + \'</textarea></div>\',\n      btn: ["保存", "取消"],\n      area: ["480px", "300px"],\n      yes: function yes(index, layero) {\n        var val = $(layero).find(\'textarea\').val();\n\n        if (val !== callbackBody) {\n          layer.confirm(\'内容已修改，将替换原有函数，是否保存？\', {\n            title: "提示",\n            icon: 3\n          }, function (idx) {\n            obj.callbackBody = val;\n            layer.msg(\'已保存修改\');\n            layer.close(index);\n          });\n        } else {\n          layer.msg(\'未修改\');\n          layer.close(index);\n        }\n      }\n    });\n  };\n\n  var _correlationRemove = function _correlationRemove(key) {\n    var objIndex = Util.inArrayObj(\'__corrkey\', key, Correlations);\n\n    if (objIndex == -1) {\n      layer.alert(\'关系不存在\');\n    } else {\n      return _correlation.remove(key);\n    }\n\n    return true;\n  };\n\n  var _correlation = {\n    _parse: function _parse(name1, name2, event, callback, args) {\n      var objKey = name1 + name2 + event;\n      var builtin = typeof callback === "string" && typeof _correlationActions[callback] == "function";\n\n      if (builtin) {\n        objKey += callback;\n      } else {\n        objKey += new Date().getTime() + 1;\n      }\n\n      var obj = {\n        name1: name1,\n        name2: name2,\n        event: event,\n        __corrkey: objKey,\n        __event: event + \'.\' + objKey,\n        binded: false,\n        __initRun: /change/.test(event),\n        callback: callback || function () {},\n        builtin: builtin,\n        callbackBody: "",\n        args: typeof args == "function" ? args : function () {// 关联逻辑代码\n        },\n        argsBody: ""\n      };\n      return obj;\n    },\n    get: function get(name1, name2, event, callback) {\n      var obj = _correlation._parse.apply(this, arguments);\n\n      var index = SUI.Util.inArrayObj("__corrkey", obj.__corrkey, Correlations);\n\n      if (index != -1) {\n        return Correlations[index];\n      }\n\n      return false;\n    },\n    getAll: function getAll() {\n      return Correlations;\n    },\n    showList: function showList() {\n      layer.open({\n        type: 1,\n        title: \'关联列表\',\n        area: ["740px", "400px"],\n        content: _listCorrelations(),\n        btn: ["新建关联"],\n        yes: function yes(index, layero) {\n          _correlationAdd(layero);\n        }\n      });\n    },\n    add: function add(name1, name2, event, callback, args) {\n      var obj = _correlation._parse.apply(this, arguments);\n\n      var index = SUI.Util.inArrayObj("__corrkey", obj.__corrkey, Correlations);\n\n      if (index == -1) {\n        Correlations.push(obj);\n\n        _correlation._bind(obj);\n      }\n\n      return obj;\n    },\n    setAll: function setAll(arr) {\n      if (!arr || !arr.length) {\n        return;\n      }\n\n      Correlations = [];\n      var i;\n\n      for (i = 0; i < arr.length; i++) {\n        var obj = arr[i];\n        Correlations.push(obj);\n\n        _correlation._bind(obj);\n      }\n    },\n    remove: function remove(objKey) {\n      var index = SUI.Util.inArrayObj("__corrkey", objKey, Correlations);\n\n      if (index != -1) {\n        _correlation._unbind(Correlations[index]);\n\n        Correlations.splice(index, 1);\n        return true;\n      }\n\n      return false;\n    },\n    _bind: function _bind(obj) {\n      var $component1 = $(\'[sui="true"][name="\' + obj.name1 + \'"]\');\n      var $component2 = $(\'[sui="true"][name="\' + obj.name2 + \'"]\');\n      $component2.on(obj.__event, function (event) {\n        var args = obj.args;\n\n        if (obj.argsBody.length) {\n          args = new Function(\'value\', obj.argsBody);\n        } else {\n          args = new Function(\'value\', "");\n        }\n\n        if (obj.callbackBody.length) {\n          var callback = new Function(\'comp1\', \'comp2\', \'event\', \'args\', obj.callbackBody);\n          callback.call(obj, $component1[0], $component2[0], event, args);\n        } else if (typeof obj.callback === "function") {\n          obj.callback.call(obj, $component1[0], $component2[0], event, args);\n        } else if (typeof obj.callback === "string" && _correlationActions[obj.callback]) {\n          _correlationActions[obj.callback].call(obj, $component1[0], $component2[0], event, args);\n        }\n      });\n\n      if (obj.__initRun) {\n        $component2.trigger(obj.__event);\n      }\n\n      obj.binded = true;\n      return obj;\n    },\n    _unbind: function _unbind(obj) {\n      var $component2 = $(\'[sui="true"][name="\' + obj.name2 + \'"]\');\n      $component2.off(obj.__event);\n      obj.binded = false;\n      return obj;\n    }\n  };\n\n  function doCall(action) {\n    switch (action) {\n      case "showCorrelations":\n        _correlation.showList();\n\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  $(document).on("click", \'button,a,i\', function (event) {\n    var action = $(event.target).attr("sui-call");\n\n    if (action && action.length) {\n      doCall(action);\n    }\n\n    var cor_custom = $(event.target).attr(\'correlation-custom\');\n\n    if (cor_custom && cor_custom.length) {\n      _correlationCustom(cor_custom);\n    }\n\n    var cor_builtin = $(event.target).attr(\'correlation-builtin\');\n\n    if (cor_builtin && cor_builtin.length) {\n      _correlationBuiltin(cor_builtin);\n    }\n\n    var cor_remove = $(event.target).attr(\'correlation-remove\');\n\n    if (cor_remove && cor_remove.length) {\n      layer.confirm(\'是否确定删除该关联关系？\', {\n        title: \'提示\',\n        icon: 3\n      }, function (index) {\n        if (_correlationRemove(cor_remove)) {\n          $(event.target).parents(\'.correlation-row\').remove();\n        } else {\n          layer.msg(\'删除失败\');\n        }\n\n        layer.close(index);\n      });\n    }\n\n    var correlation_tip = $(event.target).attr("correlation-tip");\n\n    if (correlation_tip && _correlationActionsMap[correlation_tip]) {\n      layer.alert(_correlationActionsMap[correlation_tip][\'tip\'], {\n        icon: 3,\n        title: _correlationActionsMap[correlation_tip][\'name\'] + \'提示\'\n      });\n    }\n  });\n  var Settings = {\n    iCheck: {\n      checkStyle: \'square\',\n      // icheck 风格：minimal, square, flat\n      styleColor: \'green\',\n      // icheck 颜色：black , red , green , blue , aero , grey , orange , yellow , pink , purple\n      cursor: true\n    },\n    uploadify: {\n      formData: {\n        timestamp: \'111\'\n      },\n      swf: __basePath + \'_libs/plugins/uploadify/uploadify.swf\',\n      uploaderNew: __basePath + \'workflow/uploadNew.jsp\',\n      uploader: __basePath + \'workflow/upload.jsp\',\n      buttonClass: "btn btn-primary btn-sm btn-uploadify",\n      height: 30,\n      auto: true,\n      multi: false,\n      getFile: \'com.sudytech.portalone.base.db.getById.biz.ext\',\n      downloadPath: __contextPath + "/downloadfile/",\n      downloadCompressPath: __contextPath + \'/downloadCompressFile/\'\n    },\n    wangEditor: {\n      menus: [\'fontfamily\', \'fontsize\', \'head\', \'bold\', \'underline\', \'italic\', \'forecolor\', \'bgcolor\', \'eraser\', \'|\', \'lineheight\', \'strikethrough\', \'quote\', \'indent\', \'unorderlist\', \'orderlist\', \'alignleft\', \'aligncenter\', \'alignright\', \'|\', \'link\', \'unlink\', \'table\', \'emotion\', \'|\', \'img\', // \'video\',\n      \'location\', \'insertcode\', \'|\', \'undo\', \'redo\', \'|\'],\n      uploadImgUrl: __basePath + \'workflow/upload.jsp\'\n    },\n    tableList: {},\n    input: {\n      escape: true\n    }\n  };\n  var dataTables = {};\n  var Config = {\n    mode: "",\n    validate: {},\n    //\n    properties: {}\n  };\n  var Zoo = {\n    name: "",\n    title: "",\n    init: function init(conf) {\n      this.setConfig(conf);\n    },\n    getValue: Util.empty,\n    setValue: Util.empty,\n    setConfig: function setConfig(config) {\n      this.name = config.properties.name;\n      this.title = config.properties.title;\n      this.value = config.properties.value;\n    },\n    getConfig: Util.empty,\n    validate: function validate() {\n      return true;\n    },\n    parse: function parse(element) {\n      element = $(element);\n      var temp = {};\n      temp.mode = element.attr("mode");\n      temp.properties = {\n        name: element.attr("name"),\n        title: element.attr("title"),\n        value: element.attr("value")\n      };\n      temp.validate = SUI.Util.parseJSON(element.attr("validate"), true);\n      return temp;\n    },\n    getExt: Util.empty\n  }; //初始化SUI\n\n  (function () {\n    var zoos = {};\n\n    function register(name, com) {\n      com.prototype = Zoo;\n\n      if (!zoos[name.toLowerCase()]) {\n        zoos[name.toLowerCase()] = {};\n      }\n\n      zoos[name.toLowerCase()] = com;\n    }\n\n    function create(type, dom) {\n      type = type.toLowerCase();\n      var element = new zoos[type](dom);\n      element.zoo.type = type;\n      $(element).addClass(\'sui-component sui-\' + type);\n      return element;\n    }\n\n    function build(element, type) {\n      if (element.zoo) {\n        return element;\n      }\n\n      if (!type) {\n        var suitype = element.className.match(/sui-(\\S+)/i);\n\n        if (suitype && suitype[1]) {\n          type = suitype[1];\n        } else {\n          return element;\n        }\n      }\n\n      var el = create(type, element);\n      var isui = $(el).attr("isui");\n\n      if (!isui) {\n        $(el).attr("sui", true);\n      }\n\n      var conf = el.zoo.parse(element);\n      el.zoo.init(conf);\n\n      if ($(el).hasClass(\'sui-selectmechanismtool\')) {\n        $(el).on(\'change\', \'.input-dropdown-tree\', function () {\n          try {\n            var _conf = el.zoo.getConfig();\n\n            if (_conf && _conf.mode == "editable" && _conf.validate) {\n              //增加param:表示change触发的validate\n              el.zoo.validate(true);\n            }\n          } catch (e) {}\n        });\n      } else {\n        $(el).on(\'change\', function () {\n          try {\n            var _conf = el.zoo.getConfig();\n\n            if (_conf && _conf.mode == "editable" && _conf.validate) {\n              //增加param:表示change触发的validate\n              el.zoo.validate(true);\n            }\n          } catch (e) {\n            console.log(e);\n          }\n        });\n      }\n\n      return el;\n    }\n\n    function init(callback, context) {\n      for (var type in zoos) {\n        var zooDefine = $(".sui-" + type, context);\n        zooDefine.each(function () {\n          // var version = $(this).attr(\'version\') || \'\';\n          build(this);\n        });\n      }\n      /*绑定级联*/\n\n\n      $.isFunction($.fn.initCascade) ? $(\'.sui-form\', context).initCascade() : \'\';\n      $.type(callback) === "function" && callback();\n    }\n\n    var SUI = {\n      create: create,\n      init: init,\n      build: build,\n      register: register,\n      Util: Util,\n      Zoo: Zoo,\n      settings: _fn(Settings),\n      dataTable: _fn(dataTables),\n      store: _fn(Store),\n      correlation: _correlation\n    };\n    $.each(Settings, function (key, val) {\n      SUI.settings.pt[key] = function (opt) {\n        return $.extend(true, {}, val, opt || {});\n      };\n    });\n    $.each(Store, function (key, val) {\n      SUI.store.pt[key] = function (opt) {\n        return $.extend(true, {}, val, opt || {});\n      };\n    });\n    $.extend(true, SUI.settings.pt, {\n      iCheck: function iCheck(opt) {\n        var style = opt && opt.iCheckStyle ? opt.iCheckStyle : Settings.iCheck.checkStyle,\n            color = opt && opt.iCheckColor ? opt.iCheckColor : Settings.iCheck.styleColor,\n            skin = style + \'-\' + color;\n        return $.extend(true, {}, {\n          checkboxClass: \'icheckbox_\' + skin,\n          radioClass: \'iradio_\' + skin\n        }, opt || {});\n      }\n    });\n    $.fn.extend({\n      sui: function sui() {\n        var arry = [];\n        this.each(function () {\n          arry[arry.length] = this.zoo;\n        });\n\n        if (arry.length == 1) {\n          return arry[0];\n        }\n\n        if (arry.length == 0) {\n          return null;\n        }\n\n        return arry;\n      }\n    });\n    window.SUI = SUI;\n  })();\n})();\n\n(function () {\n  // 注册组件\n  // 基本控件\n  SUI.register("Form", _components_Common_Components_Form_Form__WEBPACK_IMPORTED_MODULE_11__["default"]);\n  SUI.register("Hide", _components_Common_Components_Hide_Hide__WEBPACK_IMPORTED_MODULE_12__["default"]);\n  SUI.register("Select", _components_Common_Components_Select_Select__WEBPACK_IMPORTED_MODULE_14__["default"]);\n  SUI.register("Input", _components_Common_Components_Input_Input__WEBPACK_IMPORTED_MODULE_13__["default"]);\n  SUI.register("Number", _components_Common_Components_Number_Number__WEBPACK_IMPORTED_MODULE_23__["default"]);\n  SUI.register("Date", _components_Common_Components_Date_Date__WEBPACK_IMPORTED_MODULE_16__["default"]);\n  SUI.register("DateRange", _components_Common_Components_DateRange_DateRange__WEBPACK_IMPORTED_MODULE_17__["default"]);\n  SUI.register("DateRangePicker", _components_Common_Components_DateRangePicker_DateRangePicker__WEBPACK_IMPORTED_MODULE_18__["default"]);\n  SUI.register("NewFileUpload", _components_Common_Components_NewFileUpload_NewFileUpload__WEBPACK_IMPORTED_MODULE_22__["default"]);\n  SUI.register("FileUpload", _components_Common_Components_Fileupload_FileUpload__WEBPACK_IMPORTED_MODULE_21__["default"]);\n  SUI.register("MultiSelect", _components_Common_Components_MultiSelect_MultiSelect__WEBPACK_IMPORTED_MODULE_15__["default"]);\n  SUI.register("DataTable", _components_Common_Components_DataTable_DataTable__WEBPACK_IMPORTED_MODULE_19__["default"]);\n  SUI.register("TableList", _components_Common_Components_TableList_TableList__WEBPACK_IMPORTED_MODULE_20__["default"]);\n  SUI.register("Rating", _components_Common_Components_Rating_Rating__WEBPACK_IMPORTED_MODULE_24__["default"]);\n  SUI.register("Editor", _components_Common_Components_Editor_Editor__WEBPACK_IMPORTED_MODULE_26__["default"]);\n  SUI.register("Tip", _components_Common_Components_Tip_Tip__WEBPACK_IMPORTED_MODULE_4__["default"]);\n  SUI.register("Text", _components_Common_Components_Text_Text__WEBPACK_IMPORTED_MODULE_6__["default"]);\n  SUI.register("Button", _components_Common_Components_Button_Button__WEBPACK_IMPORTED_MODULE_0__["default"]);\n  SUI.register("FormTitle", _components_Common_Components_FormTitle_FormTitle__WEBPACK_IMPORTED_MODULE_3__["default"]);\n  SUI.register(\'ChildTitle\', _components_Common_Components_ChildTitle_ChildTitle__WEBPACK_IMPORTED_MODULE_1__["default"]);\n  SUI.register(\'FieldTitle\', _components_Common_Components_FieldTitle_FieldTitle__WEBPACK_IMPORTED_MODULE_2__["default"]);\n  SUI.register(\'Primary\', _components_Common_Components_Primary_Primary__WEBPACK_IMPORTED_MODULE_7__["default"]);\n  SUI.register(\'Success\', _components_Common_Components_Success_Success__WEBPACK_IMPORTED_MODULE_8__["default"]);\n  SUI.register(\'Warning\', _components_Common_Components_Warning_Warning__WEBPACK_IMPORTED_MODULE_9__["default"]);\n  SUI.register(\'Error\', _components_Common_Components_Error_Error__WEBPACK_IMPORTED_MODULE_10__["default"]);\n  SUI.register(\'Tiptext\', _components_Common_Components_TipText_TipText__WEBPACK_IMPORTED_MODULE_5__["default"]); //流程控件\n\n  SUI.register("Opinion", _components_Process_Components_Opinion_Opinion__WEBPACK_IMPORTED_MODULE_38__["default"]);\n  SUI.register("MultiOpinion", _components_Process_Components_MultiOpinion_MultiOpinion__WEBPACK_IMPORTED_MODULE_36__["default"]);\n  SUI.register("Participates", _components_Process_Components_Participates_Participates__WEBPACK_IMPORTED_MODULE_42__["default"]);\n  SUI.register("OpinionOne", _components_Process_Components_OpinionOne_OpinionOne__WEBPACK_IMPORTED_MODULE_40__["default"]);\n  SUI.register("OpinionHistory", _components_Process_Components_OpinionHistory_OpinionHistory__WEBPACK_IMPORTED_MODULE_39__["default"]);\n  SUI.register("Rollback", _components_Process_Components_Rollback_Rollback__WEBPACK_IMPORTED_MODULE_45__["default"]);\n  SUI.register("Terminate", _components_Process_Components_Terminate_Terminate__WEBPACK_IMPORTED_MODULE_49__["default"]);\n  SUI.register("CheckSendMsg", _components_Process_Components_CheckSendMsg_CheckSendMsg__WEBPACK_IMPORTED_MODULE_27__["default"]);\n  SUI.register("Draft", _components_Process_Components_Draft_Draft__WEBPACK_IMPORTED_MODULE_31__["default"]);\n  SUI.register("SelectParticipates", _components_Process_Components_SelectParticipates_SelectParticipates__WEBPACK_IMPORTED_MODULE_53__["default"]);\n  SUI.register("FileEdit", _components_Process_Components_FileEdit_FileEdit__WEBPACK_IMPORTED_MODULE_54__["default"]);\n  SUI.register("Submit", _components_Process_Components_Submit_Submit__WEBPACK_IMPORTED_MODULE_48__["default"]);\n  SUI.register("MoreParticipates", _components_Process_Components_MoreParticipates_MoreParticipates__WEBPACK_IMPORTED_MODULE_35__["default"]);\n  SUI.register("Print", _components_Process_Components_Print_Print__WEBPACK_IMPORTED_MODULE_43__["default"]);\n  SUI.register("Dispatch", _components_Process_Components_Dispatch_Dispatch__WEBPACK_IMPORTED_MODULE_52__["default"]);\n  SUI.register("WorkStorage", _components_Process_Components_WorkStorage_WorkStorage__WEBPACK_IMPORTED_MODULE_51__["default"]);\n  SUI.register("CloseWindow", _components_Process_Components_CloseWindow_CloseWindow__WEBPACK_IMPORTED_MODULE_29__["default"]);\n  SUI.register("QueryWf", _components_Process_Components_QueryWf_QueryWf__WEBPACK_IMPORTED_MODULE_56__["default"]);\n  SUI.register("DeleteWf", _components_Process_Components_DeleteWf_DeleteWf__WEBPACK_IMPORTED_MODULE_30__["default"]);\n  SUI.register("TurnWf", _components_Process_Components_TurnWf_TurnWf__WEBPACK_IMPORTED_MODULE_58__["default"]);\n  SUI.register("StopWf", _components_Process_Components_StopWf_StopWf__WEBPACK_IMPORTED_MODULE_57__["default"]);\n  SUI.register("Reset", _components_Process_Components_Reset_Reset__WEBPACK_IMPORTED_MODULE_44__["default"]);\n  SUI.register("FlowHistoryGraph", _components_Process_Components_FlowHistoryGraph_FlowHistoryGraph__WEBPACK_IMPORTED_MODULE_34__["default"]);\n  SUI.register("SelectPersonnel", _components_Deprecated_Components_SelectPersonnel_SelectPersonnel__WEBPACK_IMPORTED_MODULE_66___default.a);\n  SUI.register("Circulation", _components_Process_Components_Circulation_Circulation__WEBPACK_IMPORTED_MODULE_28__["default"]);\n  SUI.register("Untreat", _components_Process_Components_Untreat_Untreat__WEBPACK_IMPORTED_MODULE_50__["default"]);\n  SUI.register("SelectPersonnelTool", _components_Process_Components_SelectPersonnelTool_SelectPersonnelTool__WEBPACK_IMPORTED_MODULE_47__["default"]);\n  SUI.register("SelectMechanismTool", _components_Process_Components_SelectMechanismTool_SelectMechanismTool__WEBPACK_IMPORTED_MODULE_46__["default"]);\n  SUI.register("Model", _components_Common_Components_Model_Model__WEBPACK_IMPORTED_MODULE_25__["default"]);\n  SUI.register("ExcelExport", _components_Process_Components_ExcelExport_ExcelExport__WEBPACK_IMPORTED_MODULE_32__["default"]);\n  SUI.register(\'OrgSelect\', _components_Process_Components_OrgSelect_OrgSelect__WEBPACK_IMPORTED_MODULE_41__["default"]);\n  SUI.register(\'ExportWordPdf\', _components_Process_Components_ExportWordPdf_ExportWordPdf__WEBPACK_IMPORTED_MODULE_33__["default"]);\n  SUI.register(\'NewParticipants\', _components_Process_Components_NewParticipants_NewParticipants__WEBPACK_IMPORTED_MODULE_37__["default"]); // 普通表单控件\n\n  SUI.register("submitEntity", _components_General_Components_SubmitEntity_SubmitEntity__WEBPACK_IMPORTED_MODULE_65__["default"]);\n  SUI.register("queryEntity", _components_General_Components_QueryEntity_QueryEntity__WEBPACK_IMPORTED_MODULE_64__["default"]);\n  SUI.register("delEntity", _components_General_Components_DelEntity_DelEntity__WEBPACK_IMPORTED_MODULE_62__["default"]);\n  SUI.register("addEntity", _components_General_Components_AddEntity_AddEntity__WEBPACK_IMPORTED_MODULE_60__["default"]);\n  SUI.register("customBtn", _components_General_Components_CustomBtn_CustomBtn__WEBPACK_IMPORTED_MODULE_61__["default"]);\n  SUI.register("importEntity", _components_General_Components_ImportEntity_ImportEntity__WEBPACK_IMPORTED_MODULE_63__["default"]);\n  SUI.register("MeetRoom", _components_Expansion_Components_MeetRoom_MeetRoom__WEBPACK_IMPORTED_MODULE_59___default.a);\n  SUI.register("ApplicantOrg", _components_Process_Components_ApplicantOrg_ApplicantOrg__WEBPACK_IMPORTED_MODULE_55__["default"]);\n  SUI.register("Qrcode", _components_Process_Components_Qrcode_Qrcode__WEBPACK_IMPORTED_MODULE_67__["default"]);\n})();\n\n//# sourceURL=webpack:///./com.sudytech.portalone.base/src/webcontent/_libs/plugins/root/sui.js?')}});